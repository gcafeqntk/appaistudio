(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();function Wx(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var xg={exports:{}},vc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rb;function i2(){if(rb)return vc;rb=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,a,l){var u=null;if(l!==void 0&&(u=""+l),a.key!==void 0&&(u=""+a.key),"key"in a){l={};for(var d in a)d!=="key"&&(l[d]=a[d])}else l=a;return a=l.ref,{$$typeof:n,type:i,key:u,ref:a!==void 0?a:null,props:l}}return vc.Fragment=e,vc.jsx=t,vc.jsxs=t,vc}var ab;function r2(){return ab||(ab=1,xg.exports=i2()),xg.exports}var p=r2(),Tg={exports:{}},ke={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ob;function a2(){if(ob)return ke;ob=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),u=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),w=Symbol.for("react.activity"),T=Symbol.iterator;function S(B){return B===null||typeof B!="object"?null:(B=T&&B[T]||B["@@iterator"],typeof B=="function"?B:null)}var N={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},M=Object.assign,k={};function V(B,ne,ue){this.props=B,this.context=ne,this.refs=k,this.updater=ue||N}V.prototype.isReactComponent={},V.prototype.setState=function(B,ne){if(typeof B!="object"&&typeof B!="function"&&B!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,B,ne,"setState")},V.prototype.forceUpdate=function(B){this.updater.enqueueForceUpdate(this,B,"forceUpdate")};function F(){}F.prototype=V.prototype;function $(B,ne,ue){this.props=B,this.context=ne,this.refs=k,this.updater=ue||N}var D=$.prototype=new F;D.constructor=$,M(D,V.prototype),D.isPureReactComponent=!0;var q=Array.isArray;function J(){}var R={H:null,A:null,T:null,S:null},A=Object.prototype.hasOwnProperty;function I(B,ne,ue){var fe=ue.ref;return{$$typeof:n,type:B,key:ne,ref:fe!==void 0?fe:null,props:ue}}function L(B,ne){return I(B.type,ne,B.props)}function U(B){return typeof B=="object"&&B!==null&&B.$$typeof===n}function G(B){var ne={"=":"=0",":":"=2"};return"$"+B.replace(/[=:]/g,function(ue){return ne[ue]})}var j=/\/+/g;function H(B,ne){return typeof B=="object"&&B!==null&&B.key!=null?G(""+B.key):ne.toString(36)}function Z(B){switch(B.status){case"fulfilled":return B.value;case"rejected":throw B.reason;default:switch(typeof B.status=="string"?B.then(J,J):(B.status="pending",B.then(function(ne){B.status==="pending"&&(B.status="fulfilled",B.value=ne)},function(ne){B.status==="pending"&&(B.status="rejected",B.reason=ne)})),B.status){case"fulfilled":return B.value;case"rejected":throw B.reason}}throw B}function O(B,ne,ue,fe,Ee){var Ne=typeof B;(Ne==="undefined"||Ne==="boolean")&&(B=null);var Pe=!1;if(B===null)Pe=!0;else switch(Ne){case"bigint":case"string":case"number":Pe=!0;break;case"object":switch(B.$$typeof){case n:case e:Pe=!0;break;case _:return Pe=B._init,O(Pe(B._payload),ne,ue,fe,Ee)}}if(Pe)return Ee=Ee(B),Pe=fe===""?"."+H(B,0):fe,q(Ee)?(ue="",Pe!=null&&(ue=Pe.replace(j,"$&/")+"/"),O(Ee,ne,ue,"",function(Vn){return Vn})):Ee!=null&&(U(Ee)&&(Ee=L(Ee,ue+(Ee.key==null||B&&B.key===Ee.key?"":(""+Ee.key).replace(j,"$&/")+"/")+Pe)),ne.push(Ee)),1;Pe=0;var Et=fe===""?".":fe+":";if(q(B))for(var rt=0;rt<B.length;rt++)fe=B[rt],Ne=Et+H(fe,rt),Pe+=O(fe,ne,ue,Ne,Ee);else if(rt=S(B),typeof rt=="function")for(B=rt.call(B),rt=0;!(fe=B.next()).done;)fe=fe.value,Ne=Et+H(fe,rt++),Pe+=O(fe,ne,ue,Ne,Ee);else if(Ne==="object"){if(typeof B.then=="function")return O(Z(B),ne,ue,fe,Ee);throw ne=String(B),Error("Objects are not valid as a React child (found: "+(ne==="[object Object]"?"object with keys {"+Object.keys(B).join(", ")+"}":ne)+"). If you meant to render a collection of children, use an array instead.")}return Pe}function se(B,ne,ue){if(B==null)return B;var fe=[],Ee=0;return O(B,fe,"","",function(Ne){return ne.call(ue,Ne,Ee++)}),fe}function de(B){if(B._status===-1){var ne=B._result;ne=ne(),ne.then(function(ue){(B._status===0||B._status===-1)&&(B._status=1,B._result=ue)},function(ue){(B._status===0||B._status===-1)&&(B._status=2,B._result=ue)}),B._status===-1&&(B._status=0,B._result=ne)}if(B._status===1)return B._result.default;throw B._result}var me=typeof reportError=="function"?reportError:function(B){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ne=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof B=="object"&&B!==null&&typeof B.message=="string"?String(B.message):String(B),error:B});if(!window.dispatchEvent(ne))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",B);return}console.error(B)},qe={map:se,forEach:function(B,ne,ue){se(B,function(){ne.apply(this,arguments)},ue)},count:function(B){var ne=0;return se(B,function(){ne++}),ne},toArray:function(B){return se(B,function(ne){return ne})||[]},only:function(B){if(!U(B))throw Error("React.Children.only expected to receive a single React element child.");return B}};return ke.Activity=w,ke.Children=qe,ke.Component=V,ke.Fragment=t,ke.Profiler=a,ke.PureComponent=$,ke.StrictMode=i,ke.Suspense=g,ke.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,ke.__COMPILER_RUNTIME={__proto__:null,c:function(B){return R.H.useMemoCache(B)}},ke.cache=function(B){return function(){return B.apply(null,arguments)}},ke.cacheSignal=function(){return null},ke.cloneElement=function(B,ne,ue){if(B==null)throw Error("The argument must be a React element, but you passed "+B+".");var fe=M({},B.props),Ee=B.key;if(ne!=null)for(Ne in ne.key!==void 0&&(Ee=""+ne.key),ne)!A.call(ne,Ne)||Ne==="key"||Ne==="__self"||Ne==="__source"||Ne==="ref"&&ne.ref===void 0||(fe[Ne]=ne[Ne]);var Ne=arguments.length-2;if(Ne===1)fe.children=ue;else if(1<Ne){for(var Pe=Array(Ne),Et=0;Et<Ne;Et++)Pe[Et]=arguments[Et+2];fe.children=Pe}return I(B.type,Ee,fe)},ke.createContext=function(B){return B={$$typeof:u,_currentValue:B,_currentValue2:B,_threadCount:0,Provider:null,Consumer:null},B.Provider=B,B.Consumer={$$typeof:l,_context:B},B},ke.createElement=function(B,ne,ue){var fe,Ee={},Ne=null;if(ne!=null)for(fe in ne.key!==void 0&&(Ne=""+ne.key),ne)A.call(ne,fe)&&fe!=="key"&&fe!=="__self"&&fe!=="__source"&&(Ee[fe]=ne[fe]);var Pe=arguments.length-2;if(Pe===1)Ee.children=ue;else if(1<Pe){for(var Et=Array(Pe),rt=0;rt<Pe;rt++)Et[rt]=arguments[rt+2];Ee.children=Et}if(B&&B.defaultProps)for(fe in Pe=B.defaultProps,Pe)Ee[fe]===void 0&&(Ee[fe]=Pe[fe]);return I(B,Ne,Ee)},ke.createRef=function(){return{current:null}},ke.forwardRef=function(B){return{$$typeof:d,render:B}},ke.isValidElement=U,ke.lazy=function(B){return{$$typeof:_,_payload:{_status:-1,_result:B},_init:de}},ke.memo=function(B,ne){return{$$typeof:m,type:B,compare:ne===void 0?null:ne}},ke.startTransition=function(B){var ne=R.T,ue={};R.T=ue;try{var fe=B(),Ee=R.S;Ee!==null&&Ee(ue,fe),typeof fe=="object"&&fe!==null&&typeof fe.then=="function"&&fe.then(J,me)}catch(Ne){me(Ne)}finally{ne!==null&&ue.types!==null&&(ne.types=ue.types),R.T=ne}},ke.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},ke.use=function(B){return R.H.use(B)},ke.useActionState=function(B,ne,ue){return R.H.useActionState(B,ne,ue)},ke.useCallback=function(B,ne){return R.H.useCallback(B,ne)},ke.useContext=function(B){return R.H.useContext(B)},ke.useDebugValue=function(){},ke.useDeferredValue=function(B,ne){return R.H.useDeferredValue(B,ne)},ke.useEffect=function(B,ne){return R.H.useEffect(B,ne)},ke.useEffectEvent=function(B){return R.H.useEffectEvent(B)},ke.useId=function(){return R.H.useId()},ke.useImperativeHandle=function(B,ne,ue){return R.H.useImperativeHandle(B,ne,ue)},ke.useInsertionEffect=function(B,ne){return R.H.useInsertionEffect(B,ne)},ke.useLayoutEffect=function(B,ne){return R.H.useLayoutEffect(B,ne)},ke.useMemo=function(B,ne){return R.H.useMemo(B,ne)},ke.useOptimistic=function(B,ne){return R.H.useOptimistic(B,ne)},ke.useReducer=function(B,ne,ue){return R.H.useReducer(B,ne,ue)},ke.useRef=function(B){return R.H.useRef(B)},ke.useState=function(B){return R.H.useState(B)},ke.useSyncExternalStore=function(B,ne,ue){return R.H.useSyncExternalStore(B,ne,ue)},ke.useTransition=function(){return R.H.useTransition()},ke.version="19.2.3",ke}var lb;function zm(){return lb||(lb=1,Tg.exports=a2()),Tg.exports}var le=zm();const Bc=Wx(le);var Eg={exports:{}},_c={},Sg={exports:{}},Ag={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cb;function o2(){return cb||(cb=1,(function(n){function e(O,se){var de=O.length;O.push(se);e:for(;0<de;){var me=de-1>>>1,qe=O[me];if(0<a(qe,se))O[me]=se,O[de]=qe,de=me;else break e}}function t(O){return O.length===0?null:O[0]}function i(O){if(O.length===0)return null;var se=O[0],de=O.pop();if(de!==se){O[0]=de;e:for(var me=0,qe=O.length,B=qe>>>1;me<B;){var ne=2*(me+1)-1,ue=O[ne],fe=ne+1,Ee=O[fe];if(0>a(ue,de))fe<qe&&0>a(Ee,ue)?(O[me]=Ee,O[fe]=de,me=fe):(O[me]=ue,O[ne]=de,me=ne);else if(fe<qe&&0>a(Ee,de))O[me]=Ee,O[fe]=de,me=fe;else break e}}return se}function a(O,se){var de=O.sortIndex-se.sortIndex;return de!==0?de:O.id-se.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var u=Date,d=u.now();n.unstable_now=function(){return u.now()-d}}var g=[],m=[],_=1,w=null,T=3,S=!1,N=!1,M=!1,k=!1,V=typeof setTimeout=="function"?setTimeout:null,F=typeof clearTimeout=="function"?clearTimeout:null,$=typeof setImmediate<"u"?setImmediate:null;function D(O){for(var se=t(m);se!==null;){if(se.callback===null)i(m);else if(se.startTime<=O)i(m),se.sortIndex=se.expirationTime,e(g,se);else break;se=t(m)}}function q(O){if(M=!1,D(O),!N)if(t(g)!==null)N=!0,J||(J=!0,G());else{var se=t(m);se!==null&&Z(q,se.startTime-O)}}var J=!1,R=-1,A=5,I=-1;function L(){return k?!0:!(n.unstable_now()-I<A)}function U(){if(k=!1,J){var O=n.unstable_now();I=O;var se=!0;try{e:{N=!1,M&&(M=!1,F(R),R=-1),S=!0;var de=T;try{t:{for(D(O),w=t(g);w!==null&&!(w.expirationTime>O&&L());){var me=w.callback;if(typeof me=="function"){w.callback=null,T=w.priorityLevel;var qe=me(w.expirationTime<=O);if(O=n.unstable_now(),typeof qe=="function"){w.callback=qe,D(O),se=!0;break t}w===t(g)&&i(g),D(O)}else i(g);w=t(g)}if(w!==null)se=!0;else{var B=t(m);B!==null&&Z(q,B.startTime-O),se=!1}}break e}finally{w=null,T=de,S=!1}se=void 0}}finally{se?G():J=!1}}}var G;if(typeof $=="function")G=function(){$(U)};else if(typeof MessageChannel<"u"){var j=new MessageChannel,H=j.port2;j.port1.onmessage=U,G=function(){H.postMessage(null)}}else G=function(){V(U,0)};function Z(O,se){R=V(function(){O(n.unstable_now())},se)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(O){O.callback=null},n.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<O?Math.floor(1e3/O):5},n.unstable_getCurrentPriorityLevel=function(){return T},n.unstable_next=function(O){switch(T){case 1:case 2:case 3:var se=3;break;default:se=T}var de=T;T=se;try{return O()}finally{T=de}},n.unstable_requestPaint=function(){k=!0},n.unstable_runWithPriority=function(O,se){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var de=T;T=O;try{return se()}finally{T=de}},n.unstable_scheduleCallback=function(O,se,de){var me=n.unstable_now();switch(typeof de=="object"&&de!==null?(de=de.delay,de=typeof de=="number"&&0<de?me+de:me):de=me,O){case 1:var qe=-1;break;case 2:qe=250;break;case 5:qe=1073741823;break;case 4:qe=1e4;break;default:qe=5e3}return qe=de+qe,O={id:_++,callback:se,priorityLevel:O,startTime:de,expirationTime:qe,sortIndex:-1},de>me?(O.sortIndex=de,e(m,O),t(g)===null&&O===t(m)&&(M?(F(R),R=-1):M=!0,Z(q,de-me))):(O.sortIndex=qe,e(g,O),N||S||(N=!0,J||(J=!0,G()))),O},n.unstable_shouldYield=L,n.unstable_wrapCallback=function(O){var se=T;return function(){var de=T;T=se;try{return O.apply(this,arguments)}finally{T=de}}}})(Ag)),Ag}var ub;function l2(){return ub||(ub=1,Sg.exports=o2()),Sg.exports}var Cg={exports:{}},rn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hb;function c2(){if(hb)return rn;hb=1;var n=zm();function e(g){var m="https://react.dev/errors/"+g;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)m+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+g+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(g,m,_){var w=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:w==null?null:""+w,children:g,containerInfo:m,implementation:_}}var u=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(g,m){if(g==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return rn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,rn.createPortal=function(g,m){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(e(299));return l(g,m,null,_)},rn.flushSync=function(g){var m=u.T,_=i.p;try{if(u.T=null,i.p=2,g)return g()}finally{u.T=m,i.p=_,i.d.f()}},rn.preconnect=function(g,m){typeof g=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,i.d.C(g,m))},rn.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},rn.preinit=function(g,m){if(typeof g=="string"&&m&&typeof m.as=="string"){var _=m.as,w=d(_,m.crossOrigin),T=typeof m.integrity=="string"?m.integrity:void 0,S=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;_==="style"?i.d.S(g,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:w,integrity:T,fetchPriority:S}):_==="script"&&i.d.X(g,{crossOrigin:w,integrity:T,fetchPriority:S,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},rn.preinitModule=function(g,m){if(typeof g=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var _=d(m.as,m.crossOrigin);i.d.M(g,{crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&i.d.M(g)},rn.preload=function(g,m){if(typeof g=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var _=m.as,w=d(_,m.crossOrigin);i.d.L(g,_,{crossOrigin:w,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},rn.preloadModule=function(g,m){if(typeof g=="string")if(m){var _=d(m.as,m.crossOrigin);i.d.m(g,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else i.d.m(g)},rn.requestFormReset=function(g){i.d.r(g)},rn.unstable_batchedUpdates=function(g,m){return g(m)},rn.useFormState=function(g,m,_){return u.H.useFormState(g,m,_)},rn.useFormStatus=function(){return u.H.useHostTransitionStatus()},rn.version="19.2.3",rn}var db;function u2(){if(db)return Cg.exports;db=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Cg.exports=c2(),Cg.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fb;function h2(){if(fb)return _c;fb=1;var n=l2(),e=zm(),t=u2();function i(s){var r="https://react.dev/errors/"+s;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)r+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+s+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function l(s){var r=s,o=s;if(s.alternate)for(;r.return;)r=r.return;else{s=r;do r=s,(r.flags&4098)!==0&&(o=r.return),s=r.return;while(s)}return r.tag===3?o:null}function u(s){if(s.tag===13){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function d(s){if(s.tag===31){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function g(s){if(l(s)!==s)throw Error(i(188))}function m(s){var r=s.alternate;if(!r){if(r=l(s),r===null)throw Error(i(188));return r!==s?null:s}for(var o=s,c=r;;){var f=o.return;if(f===null)break;var y=f.alternate;if(y===null){if(c=f.return,c!==null){o=c;continue}break}if(f.child===y.child){for(y=f.child;y;){if(y===o)return g(f),s;if(y===c)return g(f),r;y=y.sibling}throw Error(i(188))}if(o.return!==c.return)o=f,c=y;else{for(var b=!1,E=f.child;E;){if(E===o){b=!0,o=f,c=y;break}if(E===c){b=!0,c=f,o=y;break}E=E.sibling}if(!b){for(E=y.child;E;){if(E===o){b=!0,o=y,c=f;break}if(E===c){b=!0,c=y,o=f;break}E=E.sibling}if(!b)throw Error(i(189))}}if(o.alternate!==c)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?s:r}function _(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s;for(s=s.child;s!==null;){if(r=_(s),r!==null)return r;s=s.sibling}return null}var w=Object.assign,T=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),N=Symbol.for("react.portal"),M=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),V=Symbol.for("react.profiler"),F=Symbol.for("react.consumer"),$=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),q=Symbol.for("react.suspense"),J=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),I=Symbol.for("react.activity"),L=Symbol.for("react.memo_cache_sentinel"),U=Symbol.iterator;function G(s){return s===null||typeof s!="object"?null:(s=U&&s[U]||s["@@iterator"],typeof s=="function"?s:null)}var j=Symbol.for("react.client.reference");function H(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===j?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case M:return"Fragment";case V:return"Profiler";case k:return"StrictMode";case q:return"Suspense";case J:return"SuspenseList";case I:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case N:return"Portal";case $:return s.displayName||"Context";case F:return(s._context.displayName||"Context")+".Consumer";case D:var r=s.render;return s=s.displayName,s||(s=r.displayName||r.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case R:return r=s.displayName||null,r!==null?r:H(s.type)||"Memo";case A:r=s._payload,s=s._init;try{return H(s(r))}catch{}}return null}var Z=Array.isArray,O=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,se=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,de={pending:!1,data:null,method:null,action:null},me=[],qe=-1;function B(s){return{current:s}}function ne(s){0>qe||(s.current=me[qe],me[qe]=null,qe--)}function ue(s,r){qe++,me[qe]=s.current,s.current=r}var fe=B(null),Ee=B(null),Ne=B(null),Pe=B(null);function Et(s,r){switch(ue(Ne,r),ue(Ee,s),ue(fe,null),r.nodeType){case 9:case 11:s=(s=r.documentElement)&&(s=s.namespaceURI)?N_(s):0;break;default:if(s=r.tagName,r=r.namespaceURI)r=N_(r),s=R_(r,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}ne(fe),ue(fe,s)}function rt(){ne(fe),ne(Ee),ne(Ne)}function Vn(s){s.memoizedState!==null&&ue(Pe,s);var r=fe.current,o=R_(r,s.type);r!==o&&(ue(Ee,s),ue(fe,o))}function Ua(s){Ee.current===s&&(ne(fe),ne(Ee)),Pe.current===s&&(ne(Pe),pc._currentValue=de)}var Va,Ba;function ws(s){if(Va===void 0)try{throw Error()}catch(o){var r=o.stack.trim().match(/\n( *(at )?)/);Va=r&&r[1]||"",Ba=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Va+s+Ba}var pl=!1;function Mr(s,r){if(!s||pl)return"";pl=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(r){var ae=function(){throw Error()};if(Object.defineProperty(ae.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ae,[])}catch(te){var X=te}Reflect.construct(s,[],ae)}else{try{ae.call()}catch(te){X=te}s.call(ae.prototype)}}else{try{throw Error()}catch(te){X=te}(ae=s())&&typeof ae.catch=="function"&&ae.catch(function(){})}}catch(te){if(te&&X&&typeof te.stack=="string")return[te.stack,X.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=c.DetermineComponentFrameRoot(),b=y[0],E=y[1];if(b&&E){var P=b.split(`
`),Q=E.split(`
`);for(f=c=0;c<P.length&&!P[c].includes("DetermineComponentFrameRoot");)c++;for(;f<Q.length&&!Q[f].includes("DetermineComponentFrameRoot");)f++;if(c===P.length||f===Q.length)for(c=P.length-1,f=Q.length-1;1<=c&&0<=f&&P[c]!==Q[f];)f--;for(;1<=c&&0<=f;c--,f--)if(P[c]!==Q[f]){if(c!==1||f!==1)do if(c--,f--,0>f||P[c]!==Q[f]){var ie=`
`+P[c].replace(" at new "," at ");return s.displayName&&ie.includes("<anonymous>")&&(ie=ie.replace("<anonymous>",s.displayName)),ie}while(1<=c&&0<=f);break}}}finally{pl=!1,Error.prepareStackTrace=o}return(o=s?s.displayName||s.name:"")?ws(o):""}function gl(s,r){switch(s.tag){case 26:case 27:case 5:return ws(s.type);case 16:return ws("Lazy");case 13:return s.child!==r&&r!==null?ws("Suspense Fallback"):ws("Suspense");case 19:return ws("SuspenseList");case 0:case 15:return Mr(s.type,!1);case 11:return Mr(s.type.render,!1);case 1:return Mr(s.type,!0);case 31:return ws("Activity");default:return""}}function ml(s){try{var r="",o=null;do r+=gl(s,o),o=s,s=s.return;while(s);return r}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var St=Object.prototype.hasOwnProperty,Ut=n.unstable_scheduleCallback,Ii=n.unstable_cancelCallback,Ef=n.unstable_shouldYield,vu=n.unstable_requestPaint,hn=n.unstable_now,Lr=n.unstable_getCurrentPriorityLevel,yl=n.unstable_ImmediatePriority,vl=n.unstable_UserBlockingPriority,Oi=n.unstable_NormalPriority,Sf=n.unstable_LowPriority,_u=n.unstable_IdlePriority,bu=n.log,wu=n.unstable_setDisableYieldValue,ns=null,Kt=null;function Bn(s){if(typeof bu=="function"&&wu(s),Kt&&typeof Kt.setStrictMode=="function")try{Kt.setStrictMode(ns,s)}catch{}}var _t=Math.clz32?Math.clz32:Tu,xu=Math.log,za=Math.LN2;function Tu(s){return s>>>=0,s===0?32:31-(xu(s)/za|0)|0}var xs=256,Ur=262144,At=4194304;function Ts(s){var r=s&42;if(r!==0)return r;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Es(s,r,o){var c=s.pendingLanes;if(c===0)return 0;var f=0,y=s.suspendedLanes,b=s.pingedLanes;s=s.warmLanes;var E=c&134217727;return E!==0?(c=E&~y,c!==0?f=Ts(c):(b&=E,b!==0?f=Ts(b):o||(o=E&~s,o!==0&&(f=Ts(o))))):(E=c&~y,E!==0?f=Ts(E):b!==0?f=Ts(b):o||(o=c&~s,o!==0&&(f=Ts(o)))),f===0?0:r!==0&&r!==f&&(r&y)===0&&(y=f&-f,o=r&-r,y>=o||y===32&&(o&4194048)!==0)?r:f}function ss(s,r){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&r)===0}function Af(s,r){switch(s){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Eu(){var s=At;return At<<=1,(At&62914560)===0&&(At=4194304),s}function Ss(s){for(var r=[],o=0;31>o;o++)r.push(s);return r}function Vr(s,r){s.pendingLanes|=r,r!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Cf(s,r,o,c,f,y){var b=s.pendingLanes;s.pendingLanes=o,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=o,s.entangledLanes&=o,s.errorRecoveryDisabledLanes&=o,s.shellSuspendCounter=0;var E=s.entanglements,P=s.expirationTimes,Q=s.hiddenUpdates;for(o=b&~o;0<o;){var ie=31-_t(o),ae=1<<ie;E[ie]=0,P[ie]=-1;var X=Q[ie];if(X!==null)for(Q[ie]=null,ie=0;ie<X.length;ie++){var te=X[ie];te!==null&&(te.lane&=-536870913)}o&=~ae}c!==0&&Br(s,c,0),y!==0&&f===0&&s.tag!==0&&(s.suspendedLanes|=y&~(b&~r))}function Br(s,r,o){s.pendingLanes|=r,s.suspendedLanes&=~r;var c=31-_t(r);s.entangledLanes|=r,s.entanglements[c]=s.entanglements[c]|1073741824|o&261930}function _l(s,r){var o=s.entangledLanes|=r;for(s=s.entanglements;o;){var c=31-_t(o),f=1<<c;f&r|s[c]&r&&(s[c]|=r),o&=~f}}function bl(s,r){var o=r&-r;return o=(o&42)!==0?1:zr(o),(o&(s.suspendedLanes|r))!==0?0:o}function zr(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function ei(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Su(){var s=se.p;return s!==0?s:(s=window.event,s===void 0?32:X_(s.type))}function is(s,r){var o=se.p;try{return se.p=s,r()}finally{se.p=o}}var rs=Math.random().toString(36).slice(2),Ct="__reactFiber$"+rs,$t="__reactProps$"+rs,As="__reactContainer$"+rs,Ha="__reactEvents$"+rs,Nf="__reactListeners$"+rs,Au="__reactHandles$"+rs,Cu="__reactResources$"+rs,Cs="__reactMarker$"+rs;function $a(s){delete s[Ct],delete s[$t],delete s[Ha],delete s[Nf],delete s[Au]}function Ns(s){var r=s[Ct];if(r)return r;for(var o=s.parentNode;o;){if(r=o[As]||o[Ct]){if(o=r.alternate,r.child!==null||o!==null&&o.child!==null)for(s=M_(s);s!==null;){if(o=s[Ct])return o;s=M_(s)}return r}s=o,o=s.parentNode}return null}function zn(s){if(s=s[Ct]||s[As]){var r=s.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return s}return null}function An(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s.stateNode;throw Error(i(33))}function Rs(s){var r=s[Cu];return r||(r=s[Cu]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function Nt(s){s[Cs]=!0}var wl=new Set,xl={};function ks(s,r){Is(s,r),Is(s+"Capture",r)}function Is(s,r){for(xl[s]=r,s=0;s<r.length;s++)wl.add(r[s])}var Tl=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),El={},Sl={};function Nu(s){return St.call(Sl,s)?!0:St.call(El,s)?!1:Tl.test(s)?Sl[s]=!0:(El[s]=!0,!1)}function qa(s,r,o){if(Nu(r))if(o===null)s.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":s.removeAttribute(r);return;case"boolean":var c=r.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){s.removeAttribute(r);return}}s.setAttribute(r,""+o)}}function Cn(s,r,o){if(o===null)s.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(r);return}s.setAttribute(r,""+o)}}function Rt(s,r,o,c){if(c===null)s.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttributeNS(r,o,""+c)}}function qt(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function ji(s){var r=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function Al(s,r,o){var c=Object.getOwnPropertyDescriptor(s.constructor.prototype,r);if(!s.hasOwnProperty(r)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var f=c.get,y=c.set;return Object.defineProperty(s,r,{configurable:!0,get:function(){return f.call(this)},set:function(b){o=""+b,y.call(this,b)}}),Object.defineProperty(s,r,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(b){o=""+b},stopTracking:function(){s._valueTracker=null,delete s[r]}}}}function Je(s){if(!s._valueTracker){var r=ji(s)?"checked":"value";s._valueTracker=Al(s,r,""+s[r])}}function Hr(s){if(!s)return!1;var r=s._valueTracker;if(!r)return!0;var o=r.getValue(),c="";return s&&(c=ji(s)?s.checked?"true":"false":s.value),s=c,s!==o?(r.setValue(s),!0):!1}function Os(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var $r=/[\n"\\]/g;function gn(s){return s.replace($r,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function Fa(s,r,o,c,f,y,b,E){s.name="",b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?s.type=b:s.removeAttribute("type"),r!=null?b==="number"?(r===0&&s.value===""||s.value!=r)&&(s.value=""+qt(r)):s.value!==""+qt(r)&&(s.value=""+qt(r)):b!=="submit"&&b!=="reset"||s.removeAttribute("value"),r!=null?Cl(s,b,qt(r)):o!=null?Cl(s,b,qt(o)):c!=null&&s.removeAttribute("value"),f==null&&y!=null&&(s.defaultChecked=!!y),f!=null&&(s.checked=f&&typeof f!="function"&&typeof f!="symbol"),E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?s.name=""+qt(E):s.removeAttribute("name")}function Ru(s,r,o,c,f,y,b,E){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(s.type=y),r!=null||o!=null){if(!(y!=="submit"&&y!=="reset"||r!=null)){Je(s);return}o=o!=null?""+qt(o):"",r=r!=null?""+qt(r):o,E||r===s.value||(s.value=r),s.defaultValue=r}c=c??f,c=typeof c!="function"&&typeof c!="symbol"&&!!c,s.checked=E?s.checked:!!c,s.defaultChecked=!!c,b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(s.name=b),Je(s)}function Cl(s,r,o){r==="number"&&Os(s.ownerDocument)===s||s.defaultValue===""+o||(s.defaultValue=""+o)}function Di(s,r,o,c){if(s=s.options,r){r={};for(var f=0;f<o.length;f++)r["$"+o[f]]=!0;for(o=0;o<s.length;o++)f=r.hasOwnProperty("$"+s[o].value),s[o].selected!==f&&(s[o].selected=f),f&&c&&(s[o].defaultSelected=!0)}else{for(o=""+qt(o),r=null,f=0;f<s.length;f++){if(s[f].value===o){s[f].selected=!0,c&&(s[f].defaultSelected=!0);return}r!==null||s[f].disabled||(r=s[f])}r!==null&&(r.selected=!0)}}function ku(s,r,o){if(r!=null&&(r=""+qt(r),r!==s.value&&(s.value=r),o==null)){s.defaultValue!==r&&(s.defaultValue=r);return}s.defaultValue=o!=null?""+qt(o):""}function Pi(s,r,o,c){if(r==null){if(c!=null){if(o!=null)throw Error(i(92));if(Z(c)){if(1<c.length)throw Error(i(93));c=c[0]}o=c}o==null&&(o=""),r=o}o=qt(r),s.defaultValue=o,c=s.textContent,c===o&&c!==""&&c!==null&&(s.value=c),Je(s)}function mn(s,r){if(r){var o=s.firstChild;if(o&&o===s.lastChild&&o.nodeType===3){o.nodeValue=r;return}}s.textContent=r}var Iu=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Nl(s,r,o){var c=r.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?s.setProperty(r,""):r==="float"?s.cssFloat="":s[r]="":c?s.setProperty(r,o):typeof o!="number"||o===0||Iu.has(r)?r==="float"?s.cssFloat=o:s[r]=(""+o).trim():s[r]=o+"px"}function Rl(s,r,o){if(r!=null&&typeof r!="object")throw Error(i(62));if(s=s.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||r!=null&&r.hasOwnProperty(c)||(c.indexOf("--")===0?s.setProperty(c,""):c==="float"?s.cssFloat="":s[c]="");for(var f in r)c=r[f],r.hasOwnProperty(f)&&o[f]!==c&&Nl(s,f,c)}else for(var y in r)r.hasOwnProperty(y)&&Nl(s,y,r[y])}function Ga(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ou=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Mi=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ka(s){return Mi.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function as(){}var kl=null;function Hn(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Li=null,js=null;function qr(s){var r=zn(s);if(r&&(s=r.stateNode)){var o=s[$t]||null;e:switch(s=r.stateNode,r.type){case"input":if(Fa(s,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),r=o.name,o.type==="radio"&&r!=null){for(o=s;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+gn(""+r)+'"][type="radio"]'),r=0;r<o.length;r++){var c=o[r];if(c!==s&&c.form===s.form){var f=c[$t]||null;if(!f)throw Error(i(90));Fa(c,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(r=0;r<o.length;r++)c=o[r],c.form===s.form&&Hr(c)}break e;case"textarea":ku(s,o.value,o.defaultValue);break e;case"select":r=o.value,r!=null&&Di(s,!!o.multiple,r,!1)}}}var Ya=!1;function Ui(s,r,o){if(Ya)return s(r,o);Ya=!0;try{var c=s(r);return c}finally{if(Ya=!1,(Li!==null||js!==null)&&(Sh(),Li&&(r=Li,s=js,js=Li=null,qr(r),s)))for(r=0;r<s.length;r++)qr(s[r])}}function os(s,r){var o=s.stateNode;if(o===null)return null;var c=o[$t]||null;if(c===null)return null;o=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(s=s.type,c=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!c;break e;default:s=!1}if(s)return null;if(o&&typeof o!="function")throw Error(i(231,r,typeof o));return o}var $n=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Fr=!1;if($n)try{var et={};Object.defineProperty(et,"passive",{get:function(){Fr=!0}}),window.addEventListener("test",et,et),window.removeEventListener("test",et,et)}catch{Fr=!1}var Ds=null,Il=null,Gr=null;function Ol(){if(Gr)return Gr;var s,r=Il,o=r.length,c,f="value"in Ds?Ds.value:Ds.textContent,y=f.length;for(s=0;s<o&&r[s]===f[s];s++);var b=o-s;for(c=1;c<=b&&r[o-c]===f[y-c];c++);return Gr=f.slice(s,1<c?1-c:void 0)}function Kr(s){var r=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&r===13&&(s=13)):s=r,s===10&&(s=13),32<=s||s===13?s:0}function ti(){return!0}function ls(){return!1}function Yt(s){function r(o,c,f,y,b){this._reactName=o,this._targetInst=f,this.type=c,this.nativeEvent=y,this.target=b,this.currentTarget=null;for(var E in s)s.hasOwnProperty(E)&&(o=s[E],this[E]=o?o(y):y[E]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?ti:ls,this.isPropagationStopped=ls,this}return w(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=ti)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=ti)},persist:function(){},isPersistent:ti}),r}var ni={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ps=Yt(ni),Vi=w({},ni,{view:0,detail:0}),jl=Yt(Vi),Bi,Wa,Ms,Qa=w({},Vi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zi,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Ms&&(Ms&&s.type==="mousemove"?(Bi=s.screenX-Ms.screenX,Wa=s.screenY-Ms.screenY):Wa=Bi=0,Ms=s),Bi)},movementY:function(s){return"movementY"in s?s.movementY:Wa}}),Dl=Yt(Qa),Yr=w({},Qa,{dataTransfer:0}),ju=Yt(Yr),Du=w({},Vi,{relatedTarget:0}),Wr=Yt(Du),Pl=w({},ni,{animationName:0,elapsedTime:0,pseudoElement:0}),Pu=Yt(Pl),Ja=w({},ni,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Mu=Yt(Ja),Lu=w({},ni,{data:0}),Ls=Yt(Lu),Uu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Vu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Bu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function zu(s){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(s):(s=Bu[s])?!!r[s]:!1}function zi(){return zu}var dn=w({},Vi,{key:function(s){if(s.key){var r=Uu[s.key]||s.key;if(r!=="Unidentified")return r}return s.type==="keypress"?(s=Kr(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Vu[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zi,charCode:function(s){return s.type==="keypress"?Kr(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Kr(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Hu=Yt(dn),$u=w({},Qa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),si=Yt($u),h=w({},Vi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zi}),v=Yt(h),x=w({},ni,{propertyName:0,elapsedTime:0,pseudoElement:0}),C=Yt(x),Y=w({},Qa,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),ee=Yt(Y),he=w({},ni,{newState:0,oldState:0}),Oe=Yt(he),bt=[9,13,27,32],Ye=$n&&"CompositionEvent"in window,ht=null;$n&&"documentMode"in document&&(ht=document.documentMode);var qn=$n&&"TextEvent"in window&&!ht,Us=$n&&(!Ye||ht&&8<ht&&11>=ht),cs=" ",us=!1;function Qr(s,r){switch(s){case"keyup":return bt.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Xa(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Za=!1;function NS(s,r){switch(s){case"compositionend":return Xa(r);case"keypress":return r.which!==32?null:(us=!0,cs);case"textInput":return s=r.data,s===cs&&us?null:s;default:return null}}function RS(s,r){if(Za)return s==="compositionend"||!Ye&&Qr(s,r)?(s=Ol(),Gr=Il=Ds=null,Za=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return Us&&r.locale!=="ko"?null:r.data;default:return null}}var kS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function V0(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r==="input"?!!kS[s.type]:r==="textarea"}function B0(s,r,o,c){Li?js?js.push(c):js=[c]:Li=c,r=Oh(r,"onChange"),0<r.length&&(o=new Ps("onChange","change",null,o,c),s.push({event:o,listeners:r}))}var Ml=null,Ll=null;function IS(s){x_(s,0)}function qu(s){var r=An(s);if(Hr(r))return s}function z0(s,r){if(s==="change")return r}var H0=!1;if($n){var Rf;if($n){var kf="oninput"in document;if(!kf){var $0=document.createElement("div");$0.setAttribute("oninput","return;"),kf=typeof $0.oninput=="function"}Rf=kf}else Rf=!1;H0=Rf&&(!document.documentMode||9<document.documentMode)}function q0(){Ml&&(Ml.detachEvent("onpropertychange",F0),Ll=Ml=null)}function F0(s){if(s.propertyName==="value"&&qu(Ll)){var r=[];B0(r,Ll,s,Hn(s)),Ui(IS,r)}}function OS(s,r,o){s==="focusin"?(q0(),Ml=r,Ll=o,Ml.attachEvent("onpropertychange",F0)):s==="focusout"&&q0()}function jS(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return qu(Ll)}function DS(s,r){if(s==="click")return qu(r)}function PS(s,r){if(s==="input"||s==="change")return qu(r)}function MS(s,r){return s===r&&(s!==0||1/s===1/r)||s!==s&&r!==r}var Nn=typeof Object.is=="function"?Object.is:MS;function Ul(s,r){if(Nn(s,r))return!0;if(typeof s!="object"||s===null||typeof r!="object"||r===null)return!1;var o=Object.keys(s),c=Object.keys(r);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var f=o[c];if(!St.call(r,f)||!Nn(s[f],r[f]))return!1}return!0}function G0(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function K0(s,r){var o=G0(s);s=0;for(var c;o;){if(o.nodeType===3){if(c=s+o.textContent.length,s<=r&&c>=r)return{node:o,offset:r-s};s=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=G0(o)}}function Y0(s,r){return s&&r?s===r?!0:s&&s.nodeType===3?!1:r&&r.nodeType===3?Y0(s,r.parentNode):"contains"in s?s.contains(r):s.compareDocumentPosition?!!(s.compareDocumentPosition(r)&16):!1:!1}function W0(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var r=Os(s.document);r instanceof s.HTMLIFrameElement;){try{var o=typeof r.contentWindow.location.href=="string"}catch{o=!1}if(o)s=r.contentWindow;else break;r=Os(s.document)}return r}function If(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r&&(r==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||r==="textarea"||s.contentEditable==="true")}var LS=$n&&"documentMode"in document&&11>=document.documentMode,eo=null,Of=null,Vl=null,jf=!1;function Q0(s,r,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;jf||eo==null||eo!==Os(c)||(c=eo,"selectionStart"in c&&If(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Vl&&Ul(Vl,c)||(Vl=c,c=Oh(Of,"onSelect"),0<c.length&&(r=new Ps("onSelect","select",null,r,o),s.push({event:r,listeners:c}),r.target=eo)))}function Jr(s,r){var o={};return o[s.toLowerCase()]=r.toLowerCase(),o["Webkit"+s]="webkit"+r,o["Moz"+s]="moz"+r,o}var to={animationend:Jr("Animation","AnimationEnd"),animationiteration:Jr("Animation","AnimationIteration"),animationstart:Jr("Animation","AnimationStart"),transitionrun:Jr("Transition","TransitionRun"),transitionstart:Jr("Transition","TransitionStart"),transitioncancel:Jr("Transition","TransitionCancel"),transitionend:Jr("Transition","TransitionEnd")},Df={},J0={};$n&&(J0=document.createElement("div").style,"AnimationEvent"in window||(delete to.animationend.animation,delete to.animationiteration.animation,delete to.animationstart.animation),"TransitionEvent"in window||delete to.transitionend.transition);function Xr(s){if(Df[s])return Df[s];if(!to[s])return s;var r=to[s],o;for(o in r)if(r.hasOwnProperty(o)&&o in J0)return Df[s]=r[o];return s}var X0=Xr("animationend"),Z0=Xr("animationiteration"),ey=Xr("animationstart"),US=Xr("transitionrun"),VS=Xr("transitionstart"),BS=Xr("transitioncancel"),ty=Xr("transitionend"),ny=new Map,Pf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Pf.push("scrollEnd");function hs(s,r){ny.set(s,r),ks(r,[s])}var Fu=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Fn=[],no=0,Mf=0;function Gu(){for(var s=no,r=Mf=no=0;r<s;){var o=Fn[r];Fn[r++]=null;var c=Fn[r];Fn[r++]=null;var f=Fn[r];Fn[r++]=null;var y=Fn[r];if(Fn[r++]=null,c!==null&&f!==null){var b=c.pending;b===null?f.next=f:(f.next=b.next,b.next=f),c.pending=f}y!==0&&sy(o,f,y)}}function Ku(s,r,o,c){Fn[no++]=s,Fn[no++]=r,Fn[no++]=o,Fn[no++]=c,Mf|=c,s.lanes|=c,s=s.alternate,s!==null&&(s.lanes|=c)}function Lf(s,r,o,c){return Ku(s,r,o,c),Yu(s)}function Zr(s,r){return Ku(s,null,null,r),Yu(s)}function sy(s,r,o){s.lanes|=o;var c=s.alternate;c!==null&&(c.lanes|=o);for(var f=!1,y=s.return;y!==null;)y.childLanes|=o,c=y.alternate,c!==null&&(c.childLanes|=o),y.tag===22&&(s=y.stateNode,s===null||s._visibility&1||(f=!0)),s=y,y=y.return;return s.tag===3?(y=s.stateNode,f&&r!==null&&(f=31-_t(o),s=y.hiddenUpdates,c=s[f],c===null?s[f]=[r]:c.push(r),r.lane=o|536870912),y):null}function Yu(s){if(50<oc)throw oc=0,Gp=null,Error(i(185));for(var r=s.return;r!==null;)s=r,r=s.return;return s.tag===3?s.stateNode:null}var so={};function zS(s,r,o,c){this.tag=s,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rn(s,r,o,c){return new zS(s,r,o,c)}function Uf(s){return s=s.prototype,!(!s||!s.isReactComponent)}function ii(s,r){var o=s.alternate;return o===null?(o=Rn(s.tag,r,s.key,s.mode),o.elementType=s.elementType,o.type=s.type,o.stateNode=s.stateNode,o.alternate=s,s.alternate=o):(o.pendingProps=r,o.type=s.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=s.flags&65011712,o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,r=s.dependencies,o.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},o.sibling=s.sibling,o.index=s.index,o.ref=s.ref,o.refCleanup=s.refCleanup,o}function iy(s,r){s.flags&=65011714;var o=s.alternate;return o===null?(s.childLanes=0,s.lanes=r,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,r=o.dependencies,s.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),s}function Wu(s,r,o,c,f,y){var b=0;if(c=s,typeof s=="function")Uf(s)&&(b=1);else if(typeof s=="string")b=GA(s,o,fe.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case I:return s=Rn(31,o,r,f),s.elementType=I,s.lanes=y,s;case M:return ea(o.children,f,y,r);case k:b=8,f|=24;break;case V:return s=Rn(12,o,r,f|2),s.elementType=V,s.lanes=y,s;case q:return s=Rn(13,o,r,f),s.elementType=q,s.lanes=y,s;case J:return s=Rn(19,o,r,f),s.elementType=J,s.lanes=y,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case $:b=10;break e;case F:b=9;break e;case D:b=11;break e;case R:b=14;break e;case A:b=16,c=null;break e}b=29,o=Error(i(130,s===null?"null":typeof s,"")),c=null}return r=Rn(b,o,r,f),r.elementType=s,r.type=c,r.lanes=y,r}function ea(s,r,o,c){return s=Rn(7,s,c,r),s.lanes=o,s}function Vf(s,r,o){return s=Rn(6,s,null,r),s.lanes=o,s}function ry(s){var r=Rn(18,null,null,0);return r.stateNode=s,r}function Bf(s,r,o){return r=Rn(4,s.children!==null?s.children:[],s.key,r),r.lanes=o,r.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},r}var ay=new WeakMap;function Gn(s,r){if(typeof s=="object"&&s!==null){var o=ay.get(s);return o!==void 0?o:(r={value:s,source:r,stack:ml(r)},ay.set(s,r),r)}return{value:s,source:r,stack:ml(r)}}var io=[],ro=0,Qu=null,Bl=0,Kn=[],Yn=0,Hi=null,Vs=1,Bs="";function ri(s,r){io[ro++]=Bl,io[ro++]=Qu,Qu=s,Bl=r}function oy(s,r,o){Kn[Yn++]=Vs,Kn[Yn++]=Bs,Kn[Yn++]=Hi,Hi=s;var c=Vs;s=Bs;var f=32-_t(c)-1;c&=~(1<<f),o+=1;var y=32-_t(r)+f;if(30<y){var b=f-f%5;y=(c&(1<<b)-1).toString(32),c>>=b,f-=b,Vs=1<<32-_t(r)+f|o<<f|c,Bs=y+s}else Vs=1<<y|o<<f|c,Bs=s}function zf(s){s.return!==null&&(ri(s,1),oy(s,1,0))}function Hf(s){for(;s===Qu;)Qu=io[--ro],io[ro]=null,Bl=io[--ro],io[ro]=null;for(;s===Hi;)Hi=Kn[--Yn],Kn[Yn]=null,Bs=Kn[--Yn],Kn[Yn]=null,Vs=Kn[--Yn],Kn[Yn]=null}function ly(s,r){Kn[Yn++]=Vs,Kn[Yn++]=Bs,Kn[Yn++]=Hi,Vs=r.id,Bs=r.overflow,Hi=s}var Wt=null,ot=null,$e=!1,$i=null,Wn=!1,$f=Error(i(519));function qi(s){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw zl(Gn(r,s)),$f}function cy(s){var r=s.stateNode,o=s.type,c=s.memoizedProps;switch(r[Ct]=s,r[$t]=c,o){case"dialog":Le("cancel",r),Le("close",r);break;case"iframe":case"object":case"embed":Le("load",r);break;case"video":case"audio":for(o=0;o<cc.length;o++)Le(cc[o],r);break;case"source":Le("error",r);break;case"img":case"image":case"link":Le("error",r),Le("load",r);break;case"details":Le("toggle",r);break;case"input":Le("invalid",r),Ru(r,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":Le("invalid",r);break;case"textarea":Le("invalid",r),Pi(r,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||r.textContent===""+o||c.suppressHydrationWarning===!0||A_(r.textContent,o)?(c.popover!=null&&(Le("beforetoggle",r),Le("toggle",r)),c.onScroll!=null&&Le("scroll",r),c.onScrollEnd!=null&&Le("scrollend",r),c.onClick!=null&&(r.onclick=as),r=!0):r=!1,r||qi(s,!0)}function uy(s){for(Wt=s.return;Wt;)switch(Wt.tag){case 5:case 31:case 13:Wn=!1;return;case 27:case 3:Wn=!0;return;default:Wt=Wt.return}}function ao(s){if(s!==Wt)return!1;if(!$e)return uy(s),$e=!0,!1;var r=s.tag,o;if((o=r!==3&&r!==27)&&((o=r===5)&&(o=s.type,o=!(o!=="form"&&o!=="button")||og(s.type,s.memoizedProps)),o=!o),o&&ot&&qi(s),uy(s),r===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));ot=P_(s)}else if(r===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));ot=P_(s)}else r===27?(r=ot,ir(s.type)?(s=dg,dg=null,ot=s):ot=r):ot=Wt?Jn(s.stateNode.nextSibling):null;return!0}function ta(){ot=Wt=null,$e=!1}function qf(){var s=$i;return s!==null&&(bn===null?bn=s:bn.push.apply(bn,s),$i=null),s}function zl(s){$i===null?$i=[s]:$i.push(s)}var Ff=B(null),na=null,ai=null;function Fi(s,r,o){ue(Ff,r._currentValue),r._currentValue=o}function oi(s){s._currentValue=Ff.current,ne(Ff)}function Gf(s,r,o){for(;s!==null;){var c=s.alternate;if((s.childLanes&r)!==r?(s.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),s===o)break;s=s.return}}function Kf(s,r,o,c){var f=s.child;for(f!==null&&(f.return=s);f!==null;){var y=f.dependencies;if(y!==null){var b=f.child;y=y.firstContext;e:for(;y!==null;){var E=y;y=f;for(var P=0;P<r.length;P++)if(E.context===r[P]){y.lanes|=o,E=y.alternate,E!==null&&(E.lanes|=o),Gf(y.return,o,s),c||(b=null);break e}y=E.next}}else if(f.tag===18){if(b=f.return,b===null)throw Error(i(341));b.lanes|=o,y=b.alternate,y!==null&&(y.lanes|=o),Gf(b,o,s),b=null}else b=f.child;if(b!==null)b.return=f;else for(b=f;b!==null;){if(b===s){b=null;break}if(f=b.sibling,f!==null){f.return=b.return,b=f;break}b=b.return}f=b}}function oo(s,r,o,c){s=null;for(var f=r,y=!1;f!==null;){if(!y){if((f.flags&524288)!==0)y=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var b=f.alternate;if(b===null)throw Error(i(387));if(b=b.memoizedProps,b!==null){var E=f.type;Nn(f.pendingProps.value,b.value)||(s!==null?s.push(E):s=[E])}}else if(f===Pe.current){if(b=f.alternate,b===null)throw Error(i(387));b.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(s!==null?s.push(pc):s=[pc])}f=f.return}s!==null&&Kf(r,s,o,c),r.flags|=262144}function Ju(s){for(s=s.firstContext;s!==null;){if(!Nn(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function sa(s){na=s,ai=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Qt(s){return hy(na,s)}function Xu(s,r){return na===null&&sa(s),hy(s,r)}function hy(s,r){var o=r._currentValue;if(r={context:r,memoizedValue:o,next:null},ai===null){if(s===null)throw Error(i(308));ai=r,s.dependencies={lanes:0,firstContext:r},s.flags|=524288}else ai=ai.next=r;return o}var HS=typeof AbortController<"u"?AbortController:function(){var s=[],r=this.signal={aborted:!1,addEventListener:function(o,c){s.push(c)}};this.abort=function(){r.aborted=!0,s.forEach(function(o){return o()})}},$S=n.unstable_scheduleCallback,qS=n.unstable_NormalPriority,kt={$$typeof:$,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Yf(){return{controller:new HS,data:new Map,refCount:0}}function Hl(s){s.refCount--,s.refCount===0&&$S(qS,function(){s.controller.abort()})}var $l=null,Wf=0,lo=0,co=null;function FS(s,r){if($l===null){var o=$l=[];Wf=0,lo=Xp(),co={status:"pending",value:void 0,then:function(c){o.push(c)}}}return Wf++,r.then(dy,dy),r}function dy(){if(--Wf===0&&$l!==null){co!==null&&(co.status="fulfilled");var s=$l;$l=null,lo=0,co=null;for(var r=0;r<s.length;r++)(0,s[r])()}}function GS(s,r){var o=[],c={status:"pending",value:null,reason:null,then:function(f){o.push(f)}};return s.then(function(){c.status="fulfilled",c.value=r;for(var f=0;f<o.length;f++)(0,o[f])(r)},function(f){for(c.status="rejected",c.reason=f,f=0;f<o.length;f++)(0,o[f])(void 0)}),c}var fy=O.S;O.S=function(s,r){Qv=hn(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&FS(s,r),fy!==null&&fy(s,r)};var ia=B(null);function Qf(){var s=ia.current;return s!==null?s:it.pooledCache}function Zu(s,r){r===null?ue(ia,ia.current):ue(ia,r.pool)}function py(){var s=Qf();return s===null?null:{parent:kt._currentValue,pool:s}}var uo=Error(i(460)),Jf=Error(i(474)),eh=Error(i(542)),th={then:function(){}};function gy(s){return s=s.status,s==="fulfilled"||s==="rejected"}function my(s,r,o){switch(o=s[o],o===void 0?s.push(r):o!==r&&(r.then(as,as),r=o),r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,vy(s),s;default:if(typeof r.status=="string")r.then(as,as);else{if(s=it,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=r,s.status="pending",s.then(function(c){if(r.status==="pending"){var f=r;f.status="fulfilled",f.value=c}},function(c){if(r.status==="pending"){var f=r;f.status="rejected",f.reason=c}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,vy(s),s}throw aa=r,uo}}function ra(s){try{var r=s._init;return r(s._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(aa=o,uo):o}}var aa=null;function yy(){if(aa===null)throw Error(i(459));var s=aa;return aa=null,s}function vy(s){if(s===uo||s===eh)throw Error(i(483))}var ho=null,ql=0;function nh(s){var r=ql;return ql+=1,ho===null&&(ho=[]),my(ho,s,r)}function Fl(s,r){r=r.props.ref,s.ref=r!==void 0?r:null}function sh(s,r){throw r.$$typeof===T?Error(i(525)):(s=Object.prototype.toString.call(r),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":s)))}function _y(s){function r(K,z){if(s){var W=K.deletions;W===null?(K.deletions=[z],K.flags|=16):W.push(z)}}function o(K,z){if(!s)return null;for(;z!==null;)r(K,z),z=z.sibling;return null}function c(K){for(var z=new Map;K!==null;)K.key!==null?z.set(K.key,K):z.set(K.index,K),K=K.sibling;return z}function f(K,z){return K=ii(K,z),K.index=0,K.sibling=null,K}function y(K,z,W){return K.index=W,s?(W=K.alternate,W!==null?(W=W.index,W<z?(K.flags|=67108866,z):W):(K.flags|=67108866,z)):(K.flags|=1048576,z)}function b(K){return s&&K.alternate===null&&(K.flags|=67108866),K}function E(K,z,W,re){return z===null||z.tag!==6?(z=Vf(W,K.mode,re),z.return=K,z):(z=f(z,W),z.return=K,z)}function P(K,z,W,re){var be=W.type;return be===M?ie(K,z,W.props.children,re,W.key):z!==null&&(z.elementType===be||typeof be=="object"&&be!==null&&be.$$typeof===A&&ra(be)===z.type)?(z=f(z,W.props),Fl(z,W),z.return=K,z):(z=Wu(W.type,W.key,W.props,null,K.mode,re),Fl(z,W),z.return=K,z)}function Q(K,z,W,re){return z===null||z.tag!==4||z.stateNode.containerInfo!==W.containerInfo||z.stateNode.implementation!==W.implementation?(z=Bf(W,K.mode,re),z.return=K,z):(z=f(z,W.children||[]),z.return=K,z)}function ie(K,z,W,re,be){return z===null||z.tag!==7?(z=ea(W,K.mode,re,be),z.return=K,z):(z=f(z,W),z.return=K,z)}function ae(K,z,W){if(typeof z=="string"&&z!==""||typeof z=="number"||typeof z=="bigint")return z=Vf(""+z,K.mode,W),z.return=K,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case S:return W=Wu(z.type,z.key,z.props,null,K.mode,W),Fl(W,z),W.return=K,W;case N:return z=Bf(z,K.mode,W),z.return=K,z;case A:return z=ra(z),ae(K,z,W)}if(Z(z)||G(z))return z=ea(z,K.mode,W,null),z.return=K,z;if(typeof z.then=="function")return ae(K,nh(z),W);if(z.$$typeof===$)return ae(K,Xu(K,z),W);sh(K,z)}return null}function X(K,z,W,re){var be=z!==null?z.key:null;if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return be!==null?null:E(K,z,""+W,re);if(typeof W=="object"&&W!==null){switch(W.$$typeof){case S:return W.key===be?P(K,z,W,re):null;case N:return W.key===be?Q(K,z,W,re):null;case A:return W=ra(W),X(K,z,W,re)}if(Z(W)||G(W))return be!==null?null:ie(K,z,W,re,null);if(typeof W.then=="function")return X(K,z,nh(W),re);if(W.$$typeof===$)return X(K,z,Xu(K,W),re);sh(K,W)}return null}function te(K,z,W,re,be){if(typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint")return K=K.get(W)||null,E(z,K,""+re,be);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case S:return K=K.get(re.key===null?W:re.key)||null,P(z,K,re,be);case N:return K=K.get(re.key===null?W:re.key)||null,Q(z,K,re,be);case A:return re=ra(re),te(K,z,W,re,be)}if(Z(re)||G(re))return K=K.get(W)||null,ie(z,K,re,be,null);if(typeof re.then=="function")return te(K,z,W,nh(re),be);if(re.$$typeof===$)return te(K,z,W,Xu(z,re),be);sh(z,re)}return null}function ge(K,z,W,re){for(var be=null,Ge=null,ve=z,De=z=0,Ve=null;ve!==null&&De<W.length;De++){ve.index>De?(Ve=ve,ve=null):Ve=ve.sibling;var Ke=X(K,ve,W[De],re);if(Ke===null){ve===null&&(ve=Ve);break}s&&ve&&Ke.alternate===null&&r(K,ve),z=y(Ke,z,De),Ge===null?be=Ke:Ge.sibling=Ke,Ge=Ke,ve=Ve}if(De===W.length)return o(K,ve),$e&&ri(K,De),be;if(ve===null){for(;De<W.length;De++)ve=ae(K,W[De],re),ve!==null&&(z=y(ve,z,De),Ge===null?be=ve:Ge.sibling=ve,Ge=ve);return $e&&ri(K,De),be}for(ve=c(ve);De<W.length;De++)Ve=te(ve,K,De,W[De],re),Ve!==null&&(s&&Ve.alternate!==null&&ve.delete(Ve.key===null?De:Ve.key),z=y(Ve,z,De),Ge===null?be=Ve:Ge.sibling=Ve,Ge=Ve);return s&&ve.forEach(function(cr){return r(K,cr)}),$e&&ri(K,De),be}function xe(K,z,W,re){if(W==null)throw Error(i(151));for(var be=null,Ge=null,ve=z,De=z=0,Ve=null,Ke=W.next();ve!==null&&!Ke.done;De++,Ke=W.next()){ve.index>De?(Ve=ve,ve=null):Ve=ve.sibling;var cr=X(K,ve,Ke.value,re);if(cr===null){ve===null&&(ve=Ve);break}s&&ve&&cr.alternate===null&&r(K,ve),z=y(cr,z,De),Ge===null?be=cr:Ge.sibling=cr,Ge=cr,ve=Ve}if(Ke.done)return o(K,ve),$e&&ri(K,De),be;if(ve===null){for(;!Ke.done;De++,Ke=W.next())Ke=ae(K,Ke.value,re),Ke!==null&&(z=y(Ke,z,De),Ge===null?be=Ke:Ge.sibling=Ke,Ge=Ke);return $e&&ri(K,De),be}for(ve=c(ve);!Ke.done;De++,Ke=W.next())Ke=te(ve,K,De,Ke.value,re),Ke!==null&&(s&&Ke.alternate!==null&&ve.delete(Ke.key===null?De:Ke.key),z=y(Ke,z,De),Ge===null?be=Ke:Ge.sibling=Ke,Ge=Ke);return s&&ve.forEach(function(s2){return r(K,s2)}),$e&&ri(K,De),be}function st(K,z,W,re){if(typeof W=="object"&&W!==null&&W.type===M&&W.key===null&&(W=W.props.children),typeof W=="object"&&W!==null){switch(W.$$typeof){case S:e:{for(var be=W.key;z!==null;){if(z.key===be){if(be=W.type,be===M){if(z.tag===7){o(K,z.sibling),re=f(z,W.props.children),re.return=K,K=re;break e}}else if(z.elementType===be||typeof be=="object"&&be!==null&&be.$$typeof===A&&ra(be)===z.type){o(K,z.sibling),re=f(z,W.props),Fl(re,W),re.return=K,K=re;break e}o(K,z);break}else r(K,z);z=z.sibling}W.type===M?(re=ea(W.props.children,K.mode,re,W.key),re.return=K,K=re):(re=Wu(W.type,W.key,W.props,null,K.mode,re),Fl(re,W),re.return=K,K=re)}return b(K);case N:e:{for(be=W.key;z!==null;){if(z.key===be)if(z.tag===4&&z.stateNode.containerInfo===W.containerInfo&&z.stateNode.implementation===W.implementation){o(K,z.sibling),re=f(z,W.children||[]),re.return=K,K=re;break e}else{o(K,z);break}else r(K,z);z=z.sibling}re=Bf(W,K.mode,re),re.return=K,K=re}return b(K);case A:return W=ra(W),st(K,z,W,re)}if(Z(W))return ge(K,z,W,re);if(G(W)){if(be=G(W),typeof be!="function")throw Error(i(150));return W=be.call(W),xe(K,z,W,re)}if(typeof W.then=="function")return st(K,z,nh(W),re);if(W.$$typeof===$)return st(K,z,Xu(K,W),re);sh(K,W)}return typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint"?(W=""+W,z!==null&&z.tag===6?(o(K,z.sibling),re=f(z,W),re.return=K,K=re):(o(K,z),re=Vf(W,K.mode,re),re.return=K,K=re),b(K)):o(K,z)}return function(K,z,W,re){try{ql=0;var be=st(K,z,W,re);return ho=null,be}catch(ve){if(ve===uo||ve===eh)throw ve;var Ge=Rn(29,ve,null,K.mode);return Ge.lanes=re,Ge.return=K,Ge}finally{}}}var oa=_y(!0),by=_y(!1),Gi=!1;function Xf(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Zf(s,r){s=s.updateQueue,r.updateQueue===s&&(r.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Ki(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Yi(s,r,o){var c=s.updateQueue;if(c===null)return null;if(c=c.shared,(We&2)!==0){var f=c.pending;return f===null?r.next=r:(r.next=f.next,f.next=r),c.pending=r,r=Yu(s),sy(s,null,o),r}return Ku(s,c,r,o),Yu(s)}function Gl(s,r,o){if(r=r.updateQueue,r!==null&&(r=r.shared,(o&4194048)!==0)){var c=r.lanes;c&=s.pendingLanes,o|=c,r.lanes=o,_l(s,o)}}function ep(s,r){var o=s.updateQueue,c=s.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var f=null,y=null;if(o=o.firstBaseUpdate,o!==null){do{var b={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};y===null?f=y=b:y=y.next=b,o=o.next}while(o!==null);y===null?f=y=r:y=y.next=r}else f=y=r;o={baseState:c.baseState,firstBaseUpdate:f,lastBaseUpdate:y,shared:c.shared,callbacks:c.callbacks},s.updateQueue=o;return}s=o.lastBaseUpdate,s===null?o.firstBaseUpdate=r:s.next=r,o.lastBaseUpdate=r}var tp=!1;function Kl(){if(tp){var s=co;if(s!==null)throw s}}function Yl(s,r,o,c){tp=!1;var f=s.updateQueue;Gi=!1;var y=f.firstBaseUpdate,b=f.lastBaseUpdate,E=f.shared.pending;if(E!==null){f.shared.pending=null;var P=E,Q=P.next;P.next=null,b===null?y=Q:b.next=Q,b=P;var ie=s.alternate;ie!==null&&(ie=ie.updateQueue,E=ie.lastBaseUpdate,E!==b&&(E===null?ie.firstBaseUpdate=Q:E.next=Q,ie.lastBaseUpdate=P))}if(y!==null){var ae=f.baseState;b=0,ie=Q=P=null,E=y;do{var X=E.lane&-536870913,te=X!==E.lane;if(te?(Ue&X)===X:(c&X)===X){X!==0&&X===lo&&(tp=!0),ie!==null&&(ie=ie.next={lane:0,tag:E.tag,payload:E.payload,callback:null,next:null});e:{var ge=s,xe=E;X=r;var st=o;switch(xe.tag){case 1:if(ge=xe.payload,typeof ge=="function"){ae=ge.call(st,ae,X);break e}ae=ge;break e;case 3:ge.flags=ge.flags&-65537|128;case 0:if(ge=xe.payload,X=typeof ge=="function"?ge.call(st,ae,X):ge,X==null)break e;ae=w({},ae,X);break e;case 2:Gi=!0}}X=E.callback,X!==null&&(s.flags|=64,te&&(s.flags|=8192),te=f.callbacks,te===null?f.callbacks=[X]:te.push(X))}else te={lane:X,tag:E.tag,payload:E.payload,callback:E.callback,next:null},ie===null?(Q=ie=te,P=ae):ie=ie.next=te,b|=X;if(E=E.next,E===null){if(E=f.shared.pending,E===null)break;te=E,E=te.next,te.next=null,f.lastBaseUpdate=te,f.shared.pending=null}}while(!0);ie===null&&(P=ae),f.baseState=P,f.firstBaseUpdate=Q,f.lastBaseUpdate=ie,y===null&&(f.shared.lanes=0),Zi|=b,s.lanes=b,s.memoizedState=ae}}function wy(s,r){if(typeof s!="function")throw Error(i(191,s));s.call(r)}function xy(s,r){var o=s.callbacks;if(o!==null)for(s.callbacks=null,s=0;s<o.length;s++)wy(o[s],r)}var fo=B(null),ih=B(0);function Ty(s,r){s=mi,ue(ih,s),ue(fo,r),mi=s|r.baseLanes}function np(){ue(ih,mi),ue(fo,fo.current)}function sp(){mi=ih.current,ne(fo),ne(ih)}var kn=B(null),Qn=null;function Wi(s){var r=s.alternate;ue(wt,wt.current&1),ue(kn,s),Qn===null&&(r===null||fo.current!==null||r.memoizedState!==null)&&(Qn=s)}function ip(s){ue(wt,wt.current),ue(kn,s),Qn===null&&(Qn=s)}function Ey(s){s.tag===22?(ue(wt,wt.current),ue(kn,s),Qn===null&&(Qn=s)):Qi()}function Qi(){ue(wt,wt.current),ue(kn,kn.current)}function In(s){ne(kn),Qn===s&&(Qn=null),ne(wt)}var wt=B(0);function rh(s){for(var r=s;r!==null;){if(r.tag===13){var o=r.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||ug(o)||hg(o)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var li=0,je=null,tt=null,It=null,ah=!1,po=!1,la=!1,oh=0,Wl=0,go=null,KS=0;function gt(){throw Error(i(321))}function rp(s,r){if(r===null)return!1;for(var o=0;o<r.length&&o<s.length;o++)if(!Nn(s[o],r[o]))return!1;return!0}function ap(s,r,o,c,f,y){return li=y,je=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,O.H=s===null||s.memoizedState===null?ov:wp,la=!1,y=o(c,f),la=!1,po&&(y=Ay(r,o,c,f)),Sy(s),y}function Sy(s){O.H=Xl;var r=tt!==null&&tt.next!==null;if(li=0,It=tt=je=null,ah=!1,Wl=0,go=null,r)throw Error(i(300));s===null||Ot||(s=s.dependencies,s!==null&&Ju(s)&&(Ot=!0))}function Ay(s,r,o,c){je=s;var f=0;do{if(po&&(go=null),Wl=0,po=!1,25<=f)throw Error(i(301));if(f+=1,It=tt=null,s.updateQueue!=null){var y=s.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}O.H=lv,y=r(o,c)}while(po);return y}function YS(){var s=O.H,r=s.useState()[0];return r=typeof r.then=="function"?Ql(r):r,s=s.useState()[0],(tt!==null?tt.memoizedState:null)!==s&&(je.flags|=1024),r}function op(){var s=oh!==0;return oh=0,s}function lp(s,r,o){r.updateQueue=s.updateQueue,r.flags&=-2053,s.lanes&=~o}function cp(s){if(ah){for(s=s.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}ah=!1}li=0,It=tt=je=null,po=!1,Wl=oh=0,go=null}function fn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return It===null?je.memoizedState=It=s:It=It.next=s,It}function xt(){if(tt===null){var s=je.alternate;s=s!==null?s.memoizedState:null}else s=tt.next;var r=It===null?je.memoizedState:It.next;if(r!==null)It=r,tt=s;else{if(s===null)throw je.alternate===null?Error(i(467)):Error(i(310));tt=s,s={memoizedState:tt.memoizedState,baseState:tt.baseState,baseQueue:tt.baseQueue,queue:tt.queue,next:null},It===null?je.memoizedState=It=s:It=It.next=s}return It}function lh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ql(s){var r=Wl;return Wl+=1,go===null&&(go=[]),s=my(go,s,r),r=je,(It===null?r.memoizedState:It.next)===null&&(r=r.alternate,O.H=r===null||r.memoizedState===null?ov:wp),s}function ch(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Ql(s);if(s.$$typeof===$)return Qt(s)}throw Error(i(438,String(s)))}function up(s){var r=null,o=je.updateQueue;if(o!==null&&(r=o.memoCache),r==null){var c=je.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(r={data:c.data.map(function(f){return f.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),o===null&&(o=lh(),je.updateQueue=o),o.memoCache=r,o=r.data[r.index],o===void 0)for(o=r.data[r.index]=Array(s),c=0;c<s;c++)o[c]=L;return r.index++,o}function ci(s,r){return typeof r=="function"?r(s):r}function uh(s){var r=xt();return hp(r,tt,s)}function hp(s,r,o){var c=s.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=o;var f=s.baseQueue,y=c.pending;if(y!==null){if(f!==null){var b=f.next;f.next=y.next,y.next=b}r.baseQueue=f=y,c.pending=null}if(y=s.baseState,f===null)s.memoizedState=y;else{r=f.next;var E=b=null,P=null,Q=r,ie=!1;do{var ae=Q.lane&-536870913;if(ae!==Q.lane?(Ue&ae)===ae:(li&ae)===ae){var X=Q.revertLane;if(X===0)P!==null&&(P=P.next={lane:0,revertLane:0,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null}),ae===lo&&(ie=!0);else if((li&X)===X){Q=Q.next,X===lo&&(ie=!0);continue}else ae={lane:0,revertLane:Q.revertLane,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},P===null?(E=P=ae,b=y):P=P.next=ae,je.lanes|=X,Zi|=X;ae=Q.action,la&&o(y,ae),y=Q.hasEagerState?Q.eagerState:o(y,ae)}else X={lane:ae,revertLane:Q.revertLane,gesture:Q.gesture,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},P===null?(E=P=X,b=y):P=P.next=X,je.lanes|=ae,Zi|=ae;Q=Q.next}while(Q!==null&&Q!==r);if(P===null?b=y:P.next=E,!Nn(y,s.memoizedState)&&(Ot=!0,ie&&(o=co,o!==null)))throw o;s.memoizedState=y,s.baseState=b,s.baseQueue=P,c.lastRenderedState=y}return f===null&&(c.lanes=0),[s.memoizedState,c.dispatch]}function dp(s){var r=xt(),o=r.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=s;var c=o.dispatch,f=o.pending,y=r.memoizedState;if(f!==null){o.pending=null;var b=f=f.next;do y=s(y,b.action),b=b.next;while(b!==f);Nn(y,r.memoizedState)||(Ot=!0),r.memoizedState=y,r.baseQueue===null&&(r.baseState=y),o.lastRenderedState=y}return[y,c]}function Cy(s,r,o){var c=je,f=xt(),y=$e;if(y){if(o===void 0)throw Error(i(407));o=o()}else o=r();var b=!Nn((tt||f).memoizedState,o);if(b&&(f.memoizedState=o,Ot=!0),f=f.queue,gp(ky.bind(null,c,f,s),[s]),f.getSnapshot!==r||b||It!==null&&It.memoizedState.tag&1){if(c.flags|=2048,mo(9,{destroy:void 0},Ry.bind(null,c,f,o,r),null),it===null)throw Error(i(349));y||(li&127)!==0||Ny(c,r,o)}return o}function Ny(s,r,o){s.flags|=16384,s={getSnapshot:r,value:o},r=je.updateQueue,r===null?(r=lh(),je.updateQueue=r,r.stores=[s]):(o=r.stores,o===null?r.stores=[s]:o.push(s))}function Ry(s,r,o,c){r.value=o,r.getSnapshot=c,Iy(r)&&Oy(s)}function ky(s,r,o){return o(function(){Iy(r)&&Oy(s)})}function Iy(s){var r=s.getSnapshot;s=s.value;try{var o=r();return!Nn(s,o)}catch{return!0}}function Oy(s){var r=Zr(s,2);r!==null&&wn(r,s,2)}function fp(s){var r=fn();if(typeof s=="function"){var o=s;if(s=o(),la){Bn(!0);try{o()}finally{Bn(!1)}}}return r.memoizedState=r.baseState=s,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ci,lastRenderedState:s},r}function jy(s,r,o,c){return s.baseState=o,hp(s,tt,typeof c=="function"?c:ci)}function WS(s,r,o,c,f){if(fh(s))throw Error(i(485));if(s=r.action,s!==null){var y={payload:f,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(b){y.listeners.push(b)}};O.T!==null?o(!0):y.isTransition=!1,c(y),o=r.pending,o===null?(y.next=r.pending=y,Dy(r,y)):(y.next=o.next,r.pending=o.next=y)}}function Dy(s,r){var o=r.action,c=r.payload,f=s.state;if(r.isTransition){var y=O.T,b={};O.T=b;try{var E=o(f,c),P=O.S;P!==null&&P(b,E),Py(s,r,E)}catch(Q){pp(s,r,Q)}finally{y!==null&&b.types!==null&&(y.types=b.types),O.T=y}}else try{y=o(f,c),Py(s,r,y)}catch(Q){pp(s,r,Q)}}function Py(s,r,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){My(s,r,c)},function(c){return pp(s,r,c)}):My(s,r,o)}function My(s,r,o){r.status="fulfilled",r.value=o,Ly(r),s.state=o,r=s.pending,r!==null&&(o=r.next,o===r?s.pending=null:(o=o.next,r.next=o,Dy(s,o)))}function pp(s,r,o){var c=s.pending;if(s.pending=null,c!==null){c=c.next;do r.status="rejected",r.reason=o,Ly(r),r=r.next;while(r!==c)}s.action=null}function Ly(s){s=s.listeners;for(var r=0;r<s.length;r++)(0,s[r])()}function Uy(s,r){return r}function Vy(s,r){if($e){var o=it.formState;if(o!==null){e:{var c=je;if($e){if(ot){t:{for(var f=ot,y=Wn;f.nodeType!==8;){if(!y){f=null;break t}if(f=Jn(f.nextSibling),f===null){f=null;break t}}y=f.data,f=y==="F!"||y==="F"?f:null}if(f){ot=Jn(f.nextSibling),c=f.data==="F!";break e}}qi(c)}c=!1}c&&(r=o[0])}}return o=fn(),o.memoizedState=o.baseState=r,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Uy,lastRenderedState:r},o.queue=c,o=iv.bind(null,je,c),c.dispatch=o,c=fp(!1),y=bp.bind(null,je,!1,c.queue),c=fn(),f={state:r,dispatch:null,action:s,pending:null},c.queue=f,o=WS.bind(null,je,f,y,o),f.dispatch=o,c.memoizedState=s,[r,o,!1]}function By(s){var r=xt();return zy(r,tt,s)}function zy(s,r,o){if(r=hp(s,r,Uy)[0],s=uh(ci)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var c=Ql(r)}catch(b){throw b===uo?eh:b}else c=r;r=xt();var f=r.queue,y=f.dispatch;return o!==r.memoizedState&&(je.flags|=2048,mo(9,{destroy:void 0},QS.bind(null,f,o),null)),[c,y,s]}function QS(s,r){s.action=r}function Hy(s){var r=xt(),o=tt;if(o!==null)return zy(r,o,s);xt(),r=r.memoizedState,o=xt();var c=o.queue.dispatch;return o.memoizedState=s,[r,c,!1]}function mo(s,r,o,c){return s={tag:s,create:o,deps:c,inst:r,next:null},r=je.updateQueue,r===null&&(r=lh(),je.updateQueue=r),o=r.lastEffect,o===null?r.lastEffect=s.next=s:(c=o.next,o.next=s,s.next=c,r.lastEffect=s),s}function $y(){return xt().memoizedState}function hh(s,r,o,c){var f=fn();je.flags|=s,f.memoizedState=mo(1|r,{destroy:void 0},o,c===void 0?null:c)}function dh(s,r,o,c){var f=xt();c=c===void 0?null:c;var y=f.memoizedState.inst;tt!==null&&c!==null&&rp(c,tt.memoizedState.deps)?f.memoizedState=mo(r,y,o,c):(je.flags|=s,f.memoizedState=mo(1|r,y,o,c))}function qy(s,r){hh(8390656,8,s,r)}function gp(s,r){dh(2048,8,s,r)}function JS(s){je.flags|=4;var r=je.updateQueue;if(r===null)r=lh(),je.updateQueue=r,r.events=[s];else{var o=r.events;o===null?r.events=[s]:o.push(s)}}function Fy(s){var r=xt().memoizedState;return JS({ref:r,nextImpl:s}),function(){if((We&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function Gy(s,r){return dh(4,2,s,r)}function Ky(s,r){return dh(4,4,s,r)}function Yy(s,r){if(typeof r=="function"){s=s();var o=r(s);return function(){typeof o=="function"?o():r(null)}}if(r!=null)return s=s(),r.current=s,function(){r.current=null}}function Wy(s,r,o){o=o!=null?o.concat([s]):null,dh(4,4,Yy.bind(null,r,s),o)}function mp(){}function Qy(s,r){var o=xt();r=r===void 0?null:r;var c=o.memoizedState;return r!==null&&rp(r,c[1])?c[0]:(o.memoizedState=[s,r],s)}function Jy(s,r){var o=xt();r=r===void 0?null:r;var c=o.memoizedState;if(r!==null&&rp(r,c[1]))return c[0];if(c=s(),la){Bn(!0);try{s()}finally{Bn(!1)}}return o.memoizedState=[c,r],c}function yp(s,r,o){return o===void 0||(li&1073741824)!==0&&(Ue&261930)===0?s.memoizedState=r:(s.memoizedState=o,s=Xv(),je.lanes|=s,Zi|=s,o)}function Xy(s,r,o,c){return Nn(o,r)?o:fo.current!==null?(s=yp(s,o,c),Nn(s,r)||(Ot=!0),s):(li&42)===0||(li&1073741824)!==0&&(Ue&261930)===0?(Ot=!0,s.memoizedState=o):(s=Xv(),je.lanes|=s,Zi|=s,r)}function Zy(s,r,o,c,f){var y=se.p;se.p=y!==0&&8>y?y:8;var b=O.T,E={};O.T=E,bp(s,!1,r,o);try{var P=f(),Q=O.S;if(Q!==null&&Q(E,P),P!==null&&typeof P=="object"&&typeof P.then=="function"){var ie=GS(P,c);Jl(s,r,ie,Dn(s))}else Jl(s,r,c,Dn(s))}catch(ae){Jl(s,r,{then:function(){},status:"rejected",reason:ae},Dn())}finally{se.p=y,b!==null&&E.types!==null&&(b.types=E.types),O.T=b}}function XS(){}function vp(s,r,o,c){if(s.tag!==5)throw Error(i(476));var f=ev(s).queue;Zy(s,f,r,de,o===null?XS:function(){return tv(s),o(c)})}function ev(s){var r=s.memoizedState;if(r!==null)return r;r={memoizedState:de,baseState:de,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ci,lastRenderedState:de},next:null};var o={};return r.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ci,lastRenderedState:o},next:null},s.memoizedState=r,s=s.alternate,s!==null&&(s.memoizedState=r),r}function tv(s){var r=ev(s);r.next===null&&(r=s.alternate.memoizedState),Jl(s,r.next.queue,{},Dn())}function _p(){return Qt(pc)}function nv(){return xt().memoizedState}function sv(){return xt().memoizedState}function ZS(s){for(var r=s.return;r!==null;){switch(r.tag){case 24:case 3:var o=Dn();s=Ki(o);var c=Yi(r,s,o);c!==null&&(wn(c,r,o),Gl(c,r,o)),r={cache:Yf()},s.payload=r;return}r=r.return}}function eA(s,r,o){var c=Dn();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},fh(s)?rv(r,o):(o=Lf(s,r,o,c),o!==null&&(wn(o,s,c),av(o,r,c)))}function iv(s,r,o){var c=Dn();Jl(s,r,o,c)}function Jl(s,r,o,c){var f={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(fh(s))rv(r,f);else{var y=s.alternate;if(s.lanes===0&&(y===null||y.lanes===0)&&(y=r.lastRenderedReducer,y!==null))try{var b=r.lastRenderedState,E=y(b,o);if(f.hasEagerState=!0,f.eagerState=E,Nn(E,b))return Ku(s,r,f,0),it===null&&Gu(),!1}catch{}finally{}if(o=Lf(s,r,f,c),o!==null)return wn(o,s,c),av(o,r,c),!0}return!1}function bp(s,r,o,c){if(c={lane:2,revertLane:Xp(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},fh(s)){if(r)throw Error(i(479))}else r=Lf(s,o,c,2),r!==null&&wn(r,s,2)}function fh(s){var r=s.alternate;return s===je||r!==null&&r===je}function rv(s,r){po=ah=!0;var o=s.pending;o===null?r.next=r:(r.next=o.next,o.next=r),s.pending=r}function av(s,r,o){if((o&4194048)!==0){var c=r.lanes;c&=s.pendingLanes,o|=c,r.lanes=o,_l(s,o)}}var Xl={readContext:Qt,use:ch,useCallback:gt,useContext:gt,useEffect:gt,useImperativeHandle:gt,useLayoutEffect:gt,useInsertionEffect:gt,useMemo:gt,useReducer:gt,useRef:gt,useState:gt,useDebugValue:gt,useDeferredValue:gt,useTransition:gt,useSyncExternalStore:gt,useId:gt,useHostTransitionStatus:gt,useFormState:gt,useActionState:gt,useOptimistic:gt,useMemoCache:gt,useCacheRefresh:gt};Xl.useEffectEvent=gt;var ov={readContext:Qt,use:ch,useCallback:function(s,r){return fn().memoizedState=[s,r===void 0?null:r],s},useContext:Qt,useEffect:qy,useImperativeHandle:function(s,r,o){o=o!=null?o.concat([s]):null,hh(4194308,4,Yy.bind(null,r,s),o)},useLayoutEffect:function(s,r){return hh(4194308,4,s,r)},useInsertionEffect:function(s,r){hh(4,2,s,r)},useMemo:function(s,r){var o=fn();r=r===void 0?null:r;var c=s();if(la){Bn(!0);try{s()}finally{Bn(!1)}}return o.memoizedState=[c,r],c},useReducer:function(s,r,o){var c=fn();if(o!==void 0){var f=o(r);if(la){Bn(!0);try{o(r)}finally{Bn(!1)}}}else f=r;return c.memoizedState=c.baseState=f,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:f},c.queue=s,s=s.dispatch=eA.bind(null,je,s),[c.memoizedState,s]},useRef:function(s){var r=fn();return s={current:s},r.memoizedState=s},useState:function(s){s=fp(s);var r=s.queue,o=iv.bind(null,je,r);return r.dispatch=o,[s.memoizedState,o]},useDebugValue:mp,useDeferredValue:function(s,r){var o=fn();return yp(o,s,r)},useTransition:function(){var s=fp(!1);return s=Zy.bind(null,je,s.queue,!0,!1),fn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,r,o){var c=je,f=fn();if($e){if(o===void 0)throw Error(i(407));o=o()}else{if(o=r(),it===null)throw Error(i(349));(Ue&127)!==0||Ny(c,r,o)}f.memoizedState=o;var y={value:o,getSnapshot:r};return f.queue=y,qy(ky.bind(null,c,y,s),[s]),c.flags|=2048,mo(9,{destroy:void 0},Ry.bind(null,c,y,o,r),null),o},useId:function(){var s=fn(),r=it.identifierPrefix;if($e){var o=Bs,c=Vs;o=(c&~(1<<32-_t(c)-1)).toString(32)+o,r="_"+r+"R_"+o,o=oh++,0<o&&(r+="H"+o.toString(32)),r+="_"}else o=KS++,r="_"+r+"r_"+o.toString(32)+"_";return s.memoizedState=r},useHostTransitionStatus:_p,useFormState:Vy,useActionState:Vy,useOptimistic:function(s){var r=fn();r.memoizedState=r.baseState=s;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=o,r=bp.bind(null,je,!0,o),o.dispatch=r,[s,r]},useMemoCache:up,useCacheRefresh:function(){return fn().memoizedState=ZS.bind(null,je)},useEffectEvent:function(s){var r=fn(),o={impl:s};return r.memoizedState=o,function(){if((We&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},wp={readContext:Qt,use:ch,useCallback:Qy,useContext:Qt,useEffect:gp,useImperativeHandle:Wy,useInsertionEffect:Gy,useLayoutEffect:Ky,useMemo:Jy,useReducer:uh,useRef:$y,useState:function(){return uh(ci)},useDebugValue:mp,useDeferredValue:function(s,r){var o=xt();return Xy(o,tt.memoizedState,s,r)},useTransition:function(){var s=uh(ci)[0],r=xt().memoizedState;return[typeof s=="boolean"?s:Ql(s),r]},useSyncExternalStore:Cy,useId:nv,useHostTransitionStatus:_p,useFormState:By,useActionState:By,useOptimistic:function(s,r){var o=xt();return jy(o,tt,s,r)},useMemoCache:up,useCacheRefresh:sv};wp.useEffectEvent=Fy;var lv={readContext:Qt,use:ch,useCallback:Qy,useContext:Qt,useEffect:gp,useImperativeHandle:Wy,useInsertionEffect:Gy,useLayoutEffect:Ky,useMemo:Jy,useReducer:dp,useRef:$y,useState:function(){return dp(ci)},useDebugValue:mp,useDeferredValue:function(s,r){var o=xt();return tt===null?yp(o,s,r):Xy(o,tt.memoizedState,s,r)},useTransition:function(){var s=dp(ci)[0],r=xt().memoizedState;return[typeof s=="boolean"?s:Ql(s),r]},useSyncExternalStore:Cy,useId:nv,useHostTransitionStatus:_p,useFormState:Hy,useActionState:Hy,useOptimistic:function(s,r){var o=xt();return tt!==null?jy(o,tt,s,r):(o.baseState=s,[s,o.queue.dispatch])},useMemoCache:up,useCacheRefresh:sv};lv.useEffectEvent=Fy;function xp(s,r,o,c){r=s.memoizedState,o=o(c,r),o=o==null?r:w({},r,o),s.memoizedState=o,s.lanes===0&&(s.updateQueue.baseState=o)}var Tp={enqueueSetState:function(s,r,o){s=s._reactInternals;var c=Dn(),f=Ki(c);f.payload=r,o!=null&&(f.callback=o),r=Yi(s,f,c),r!==null&&(wn(r,s,c),Gl(r,s,c))},enqueueReplaceState:function(s,r,o){s=s._reactInternals;var c=Dn(),f=Ki(c);f.tag=1,f.payload=r,o!=null&&(f.callback=o),r=Yi(s,f,c),r!==null&&(wn(r,s,c),Gl(r,s,c))},enqueueForceUpdate:function(s,r){s=s._reactInternals;var o=Dn(),c=Ki(o);c.tag=2,r!=null&&(c.callback=r),r=Yi(s,c,o),r!==null&&(wn(r,s,o),Gl(r,s,o))}};function cv(s,r,o,c,f,y,b){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(c,y,b):r.prototype&&r.prototype.isPureReactComponent?!Ul(o,c)||!Ul(f,y):!0}function uv(s,r,o,c){s=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(o,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(o,c),r.state!==s&&Tp.enqueueReplaceState(r,r.state,null)}function ca(s,r){var o=r;if("ref"in r){o={};for(var c in r)c!=="ref"&&(o[c]=r[c])}if(s=s.defaultProps){o===r&&(o=w({},o));for(var f in s)o[f]===void 0&&(o[f]=s[f])}return o}function hv(s){Fu(s)}function dv(s){console.error(s)}function fv(s){Fu(s)}function ph(s,r){try{var o=s.onUncaughtError;o(r.value,{componentStack:r.stack})}catch(c){setTimeout(function(){throw c})}}function pv(s,r,o){try{var c=s.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function Ep(s,r,o){return o=Ki(o),o.tag=3,o.payload={element:null},o.callback=function(){ph(s,r)},o}function gv(s){return s=Ki(s),s.tag=3,s}function mv(s,r,o,c){var f=o.type.getDerivedStateFromError;if(typeof f=="function"){var y=c.value;s.payload=function(){return f(y)},s.callback=function(){pv(r,o,c)}}var b=o.stateNode;b!==null&&typeof b.componentDidCatch=="function"&&(s.callback=function(){pv(r,o,c),typeof f!="function"&&(er===null?er=new Set([this]):er.add(this));var E=c.stack;this.componentDidCatch(c.value,{componentStack:E!==null?E:""})})}function tA(s,r,o,c,f){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(r=o.alternate,r!==null&&oo(r,o,f,!0),o=kn.current,o!==null){switch(o.tag){case 31:case 13:return Qn===null?Ah():o.alternate===null&&mt===0&&(mt=3),o.flags&=-257,o.flags|=65536,o.lanes=f,c===th?o.flags|=16384:(r=o.updateQueue,r===null?o.updateQueue=new Set([c]):r.add(c),Wp(s,c,f)),!1;case 22:return o.flags|=65536,c===th?o.flags|=16384:(r=o.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=r):(o=r.retryQueue,o===null?r.retryQueue=new Set([c]):o.add(c)),Wp(s,c,f)),!1}throw Error(i(435,o.tag))}return Wp(s,c,f),Ah(),!1}if($e)return r=kn.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=f,c!==$f&&(s=Error(i(422),{cause:c}),zl(Gn(s,o)))):(c!==$f&&(r=Error(i(423),{cause:c}),zl(Gn(r,o))),s=s.current.alternate,s.flags|=65536,f&=-f,s.lanes|=f,c=Gn(c,o),f=Ep(s.stateNode,c,f),ep(s,f),mt!==4&&(mt=2)),!1;var y=Error(i(520),{cause:c});if(y=Gn(y,o),ac===null?ac=[y]:ac.push(y),mt!==4&&(mt=2),r===null)return!0;c=Gn(c,o),o=r;do{switch(o.tag){case 3:return o.flags|=65536,s=f&-f,o.lanes|=s,s=Ep(o.stateNode,c,s),ep(o,s),!1;case 1:if(r=o.type,y=o.stateNode,(o.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(er===null||!er.has(y))))return o.flags|=65536,f&=-f,o.lanes|=f,f=gv(f),mv(f,s,o,c),ep(o,f),!1}o=o.return}while(o!==null);return!1}var Sp=Error(i(461)),Ot=!1;function Jt(s,r,o,c){r.child=s===null?by(r,null,o,c):oa(r,s.child,o,c)}function yv(s,r,o,c,f){o=o.render;var y=r.ref;if("ref"in c){var b={};for(var E in c)E!=="ref"&&(b[E]=c[E])}else b=c;return sa(r),c=ap(s,r,o,b,y,f),E=op(),s!==null&&!Ot?(lp(s,r,f),ui(s,r,f)):($e&&E&&zf(r),r.flags|=1,Jt(s,r,c,f),r.child)}function vv(s,r,o,c,f){if(s===null){var y=o.type;return typeof y=="function"&&!Uf(y)&&y.defaultProps===void 0&&o.compare===null?(r.tag=15,r.type=y,_v(s,r,y,c,f)):(s=Wu(o.type,null,c,r,r.mode,f),s.ref=r.ref,s.return=r,r.child=s)}if(y=s.child,!jp(s,f)){var b=y.memoizedProps;if(o=o.compare,o=o!==null?o:Ul,o(b,c)&&s.ref===r.ref)return ui(s,r,f)}return r.flags|=1,s=ii(y,c),s.ref=r.ref,s.return=r,r.child=s}function _v(s,r,o,c,f){if(s!==null){var y=s.memoizedProps;if(Ul(y,c)&&s.ref===r.ref)if(Ot=!1,r.pendingProps=c=y,jp(s,f))(s.flags&131072)!==0&&(Ot=!0);else return r.lanes=s.lanes,ui(s,r,f)}return Ap(s,r,o,c,f)}function bv(s,r,o,c){var f=c.children,y=s!==null?s.memoizedState:null;if(s===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((r.flags&128)!==0){if(y=y!==null?y.baseLanes|o:o,s!==null){for(c=r.child=s.child,f=0;c!==null;)f=f|c.lanes|c.childLanes,c=c.sibling;c=f&~y}else c=0,r.child=null;return wv(s,r,y,o,c)}if((o&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},s!==null&&Zu(r,y!==null?y.cachePool:null),y!==null?Ty(r,y):np(),Ey(r);else return c=r.lanes=536870912,wv(s,r,y!==null?y.baseLanes|o:o,o,c)}else y!==null?(Zu(r,y.cachePool),Ty(r,y),Qi(),r.memoizedState=null):(s!==null&&Zu(r,null),np(),Qi());return Jt(s,r,f,o),r.child}function Zl(s,r){return s!==null&&s.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function wv(s,r,o,c,f){var y=Qf();return y=y===null?null:{parent:kt._currentValue,pool:y},r.memoizedState={baseLanes:o,cachePool:y},s!==null&&Zu(r,null),np(),Ey(r),s!==null&&oo(s,r,c,!0),r.childLanes=f,null}function gh(s,r){return r=yh({mode:r.mode,children:r.children},s.mode),r.ref=s.ref,s.child=r,r.return=s,r}function xv(s,r,o){return oa(r,s.child,null,o),s=gh(r,r.pendingProps),s.flags|=2,In(r),r.memoizedState=null,s}function nA(s,r,o){var c=r.pendingProps,f=(r.flags&128)!==0;if(r.flags&=-129,s===null){if($e){if(c.mode==="hidden")return s=gh(r,c),r.lanes=536870912,Zl(null,s);if(ip(r),(s=ot)?(s=D_(s,Wn),s=s!==null&&s.data==="&"?s:null,s!==null&&(r.memoizedState={dehydrated:s,treeContext:Hi!==null?{id:Vs,overflow:Bs}:null,retryLane:536870912,hydrationErrors:null},o=ry(s),o.return=r,r.child=o,Wt=r,ot=null)):s=null,s===null)throw qi(r);return r.lanes=536870912,null}return gh(r,c)}var y=s.memoizedState;if(y!==null){var b=y.dehydrated;if(ip(r),f)if(r.flags&256)r.flags&=-257,r=xv(s,r,o);else if(r.memoizedState!==null)r.child=s.child,r.flags|=128,r=null;else throw Error(i(558));else if(Ot||oo(s,r,o,!1),f=(o&s.childLanes)!==0,Ot||f){if(c=it,c!==null&&(b=bl(c,o),b!==0&&b!==y.retryLane))throw y.retryLane=b,Zr(s,b),wn(c,s,b),Sp;Ah(),r=xv(s,r,o)}else s=y.treeContext,ot=Jn(b.nextSibling),Wt=r,$e=!0,$i=null,Wn=!1,s!==null&&ly(r,s),r=gh(r,c),r.flags|=4096;return r}return s=ii(s.child,{mode:c.mode,children:c.children}),s.ref=r.ref,r.child=s,s.return=r,s}function mh(s,r){var o=r.ref;if(o===null)s!==null&&s.ref!==null&&(r.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(s===null||s.ref!==o)&&(r.flags|=4194816)}}function Ap(s,r,o,c,f){return sa(r),o=ap(s,r,o,c,void 0,f),c=op(),s!==null&&!Ot?(lp(s,r,f),ui(s,r,f)):($e&&c&&zf(r),r.flags|=1,Jt(s,r,o,f),r.child)}function Tv(s,r,o,c,f,y){return sa(r),r.updateQueue=null,o=Ay(r,c,o,f),Sy(s),c=op(),s!==null&&!Ot?(lp(s,r,y),ui(s,r,y)):($e&&c&&zf(r),r.flags|=1,Jt(s,r,o,y),r.child)}function Ev(s,r,o,c,f){if(sa(r),r.stateNode===null){var y=so,b=o.contextType;typeof b=="object"&&b!==null&&(y=Qt(b)),y=new o(c,y),r.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=Tp,r.stateNode=y,y._reactInternals=r,y=r.stateNode,y.props=c,y.state=r.memoizedState,y.refs={},Xf(r),b=o.contextType,y.context=typeof b=="object"&&b!==null?Qt(b):so,y.state=r.memoizedState,b=o.getDerivedStateFromProps,typeof b=="function"&&(xp(r,o,b,c),y.state=r.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(b=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),b!==y.state&&Tp.enqueueReplaceState(y,y.state,null),Yl(r,c,y,f),Kl(),y.state=r.memoizedState),typeof y.componentDidMount=="function"&&(r.flags|=4194308),c=!0}else if(s===null){y=r.stateNode;var E=r.memoizedProps,P=ca(o,E);y.props=P;var Q=y.context,ie=o.contextType;b=so,typeof ie=="object"&&ie!==null&&(b=Qt(ie));var ae=o.getDerivedStateFromProps;ie=typeof ae=="function"||typeof y.getSnapshotBeforeUpdate=="function",E=r.pendingProps!==E,ie||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(E||Q!==b)&&uv(r,y,c,b),Gi=!1;var X=r.memoizedState;y.state=X,Yl(r,c,y,f),Kl(),Q=r.memoizedState,E||X!==Q||Gi?(typeof ae=="function"&&(xp(r,o,ae,c),Q=r.memoizedState),(P=Gi||cv(r,o,P,c,X,Q,b))?(ie||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(r.flags|=4194308)):(typeof y.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=Q),y.props=c,y.state=Q,y.context=b,c=P):(typeof y.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{y=r.stateNode,Zf(s,r),b=r.memoizedProps,ie=ca(o,b),y.props=ie,ae=r.pendingProps,X=y.context,Q=o.contextType,P=so,typeof Q=="object"&&Q!==null&&(P=Qt(Q)),E=o.getDerivedStateFromProps,(Q=typeof E=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(b!==ae||X!==P)&&uv(r,y,c,P),Gi=!1,X=r.memoizedState,y.state=X,Yl(r,c,y,f),Kl();var te=r.memoizedState;b!==ae||X!==te||Gi||s!==null&&s.dependencies!==null&&Ju(s.dependencies)?(typeof E=="function"&&(xp(r,o,E,c),te=r.memoizedState),(ie=Gi||cv(r,o,ie,c,X,te,P)||s!==null&&s.dependencies!==null&&Ju(s.dependencies))?(Q||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(c,te,P),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(c,te,P)),typeof y.componentDidUpdate=="function"&&(r.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof y.componentDidUpdate!="function"||b===s.memoizedProps&&X===s.memoizedState||(r.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||b===s.memoizedProps&&X===s.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=te),y.props=c,y.state=te,y.context=P,c=ie):(typeof y.componentDidUpdate!="function"||b===s.memoizedProps&&X===s.memoizedState||(r.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||b===s.memoizedProps&&X===s.memoizedState||(r.flags|=1024),c=!1)}return y=c,mh(s,r),c=(r.flags&128)!==0,y||c?(y=r.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:y.render(),r.flags|=1,s!==null&&c?(r.child=oa(r,s.child,null,f),r.child=oa(r,null,o,f)):Jt(s,r,o,f),r.memoizedState=y.state,s=r.child):s=ui(s,r,f),s}function Sv(s,r,o,c){return ta(),r.flags|=256,Jt(s,r,o,c),r.child}var Cp={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Np(s){return{baseLanes:s,cachePool:py()}}function Rp(s,r,o){return s=s!==null?s.childLanes&~o:0,r&&(s|=jn),s}function Av(s,r,o){var c=r.pendingProps,f=!1,y=(r.flags&128)!==0,b;if((b=y)||(b=s!==null&&s.memoizedState===null?!1:(wt.current&2)!==0),b&&(f=!0,r.flags&=-129),b=(r.flags&32)!==0,r.flags&=-33,s===null){if($e){if(f?Wi(r):Qi(),(s=ot)?(s=D_(s,Wn),s=s!==null&&s.data!=="&"?s:null,s!==null&&(r.memoizedState={dehydrated:s,treeContext:Hi!==null?{id:Vs,overflow:Bs}:null,retryLane:536870912,hydrationErrors:null},o=ry(s),o.return=r,r.child=o,Wt=r,ot=null)):s=null,s===null)throw qi(r);return hg(s)?r.lanes=32:r.lanes=536870912,null}var E=c.children;return c=c.fallback,f?(Qi(),f=r.mode,E=yh({mode:"hidden",children:E},f),c=ea(c,f,o,null),E.return=r,c.return=r,E.sibling=c,r.child=E,c=r.child,c.memoizedState=Np(o),c.childLanes=Rp(s,b,o),r.memoizedState=Cp,Zl(null,c)):(Wi(r),kp(r,E))}var P=s.memoizedState;if(P!==null&&(E=P.dehydrated,E!==null)){if(y)r.flags&256?(Wi(r),r.flags&=-257,r=Ip(s,r,o)):r.memoizedState!==null?(Qi(),r.child=s.child,r.flags|=128,r=null):(Qi(),E=c.fallback,f=r.mode,c=yh({mode:"visible",children:c.children},f),E=ea(E,f,o,null),E.flags|=2,c.return=r,E.return=r,c.sibling=E,r.child=c,oa(r,s.child,null,o),c=r.child,c.memoizedState=Np(o),c.childLanes=Rp(s,b,o),r.memoizedState=Cp,r=Zl(null,c));else if(Wi(r),hg(E)){if(b=E.nextSibling&&E.nextSibling.dataset,b)var Q=b.dgst;b=Q,c=Error(i(419)),c.stack="",c.digest=b,zl({value:c,source:null,stack:null}),r=Ip(s,r,o)}else if(Ot||oo(s,r,o,!1),b=(o&s.childLanes)!==0,Ot||b){if(b=it,b!==null&&(c=bl(b,o),c!==0&&c!==P.retryLane))throw P.retryLane=c,Zr(s,c),wn(b,s,c),Sp;ug(E)||Ah(),r=Ip(s,r,o)}else ug(E)?(r.flags|=192,r.child=s.child,r=null):(s=P.treeContext,ot=Jn(E.nextSibling),Wt=r,$e=!0,$i=null,Wn=!1,s!==null&&ly(r,s),r=kp(r,c.children),r.flags|=4096);return r}return f?(Qi(),E=c.fallback,f=r.mode,P=s.child,Q=P.sibling,c=ii(P,{mode:"hidden",children:c.children}),c.subtreeFlags=P.subtreeFlags&65011712,Q!==null?E=ii(Q,E):(E=ea(E,f,o,null),E.flags|=2),E.return=r,c.return=r,c.sibling=E,r.child=c,Zl(null,c),c=r.child,E=s.child.memoizedState,E===null?E=Np(o):(f=E.cachePool,f!==null?(P=kt._currentValue,f=f.parent!==P?{parent:P,pool:P}:f):f=py(),E={baseLanes:E.baseLanes|o,cachePool:f}),c.memoizedState=E,c.childLanes=Rp(s,b,o),r.memoizedState=Cp,Zl(s.child,c)):(Wi(r),o=s.child,s=o.sibling,o=ii(o,{mode:"visible",children:c.children}),o.return=r,o.sibling=null,s!==null&&(b=r.deletions,b===null?(r.deletions=[s],r.flags|=16):b.push(s)),r.child=o,r.memoizedState=null,o)}function kp(s,r){return r=yh({mode:"visible",children:r},s.mode),r.return=s,s.child=r}function yh(s,r){return s=Rn(22,s,null,r),s.lanes=0,s}function Ip(s,r,o){return oa(r,s.child,null,o),s=kp(r,r.pendingProps.children),s.flags|=2,r.memoizedState=null,s}function Cv(s,r,o){s.lanes|=r;var c=s.alternate;c!==null&&(c.lanes|=r),Gf(s.return,r,o)}function Op(s,r,o,c,f,y){var b=s.memoizedState;b===null?s.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:f,treeForkCount:y}:(b.isBackwards=r,b.rendering=null,b.renderingStartTime=0,b.last=c,b.tail=o,b.tailMode=f,b.treeForkCount=y)}function Nv(s,r,o){var c=r.pendingProps,f=c.revealOrder,y=c.tail;c=c.children;var b=wt.current,E=(b&2)!==0;if(E?(b=b&1|2,r.flags|=128):b&=1,ue(wt,b),Jt(s,r,c,o),c=$e?Bl:0,!E&&s!==null&&(s.flags&128)!==0)e:for(s=r.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Cv(s,o,r);else if(s.tag===19)Cv(s,o,r);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break e;for(;s.sibling===null;){if(s.return===null||s.return===r)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(f){case"forwards":for(o=r.child,f=null;o!==null;)s=o.alternate,s!==null&&rh(s)===null&&(f=o),o=o.sibling;o=f,o===null?(f=r.child,r.child=null):(f=o.sibling,o.sibling=null),Op(r,!1,f,o,y,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,f=r.child,r.child=null;f!==null;){if(s=f.alternate,s!==null&&rh(s)===null){r.child=f;break}s=f.sibling,f.sibling=o,o=f,f=s}Op(r,!0,o,null,y,c);break;case"together":Op(r,!1,null,null,void 0,c);break;default:r.memoizedState=null}return r.child}function ui(s,r,o){if(s!==null&&(r.dependencies=s.dependencies),Zi|=r.lanes,(o&r.childLanes)===0)if(s!==null){if(oo(s,r,o,!1),(o&r.childLanes)===0)return null}else return null;if(s!==null&&r.child!==s.child)throw Error(i(153));if(r.child!==null){for(s=r.child,o=ii(s,s.pendingProps),r.child=o,o.return=r;s.sibling!==null;)s=s.sibling,o=o.sibling=ii(s,s.pendingProps),o.return=r;o.sibling=null}return r.child}function jp(s,r){return(s.lanes&r)!==0?!0:(s=s.dependencies,!!(s!==null&&Ju(s)))}function sA(s,r,o){switch(r.tag){case 3:Et(r,r.stateNode.containerInfo),Fi(r,kt,s.memoizedState.cache),ta();break;case 27:case 5:Vn(r);break;case 4:Et(r,r.stateNode.containerInfo);break;case 10:Fi(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,ip(r),null;break;case 13:var c=r.memoizedState;if(c!==null)return c.dehydrated!==null?(Wi(r),r.flags|=128,null):(o&r.child.childLanes)!==0?Av(s,r,o):(Wi(r),s=ui(s,r,o),s!==null?s.sibling:null);Wi(r);break;case 19:var f=(s.flags&128)!==0;if(c=(o&r.childLanes)!==0,c||(oo(s,r,o,!1),c=(o&r.childLanes)!==0),f){if(c)return Nv(s,r,o);r.flags|=128}if(f=r.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),ue(wt,wt.current),c)break;return null;case 22:return r.lanes=0,bv(s,r,o,r.pendingProps);case 24:Fi(r,kt,s.memoizedState.cache)}return ui(s,r,o)}function Rv(s,r,o){if(s!==null)if(s.memoizedProps!==r.pendingProps)Ot=!0;else{if(!jp(s,o)&&(r.flags&128)===0)return Ot=!1,sA(s,r,o);Ot=(s.flags&131072)!==0}else Ot=!1,$e&&(r.flags&1048576)!==0&&oy(r,Bl,r.index);switch(r.lanes=0,r.tag){case 16:e:{var c=r.pendingProps;if(s=ra(r.elementType),r.type=s,typeof s=="function")Uf(s)?(c=ca(s,c),r.tag=1,r=Ev(null,r,s,c,o)):(r.tag=0,r=Ap(null,r,s,c,o));else{if(s!=null){var f=s.$$typeof;if(f===D){r.tag=11,r=yv(null,r,s,c,o);break e}else if(f===R){r.tag=14,r=vv(null,r,s,c,o);break e}}throw r=H(s)||s,Error(i(306,r,""))}}return r;case 0:return Ap(s,r,r.type,r.pendingProps,o);case 1:return c=r.type,f=ca(c,r.pendingProps),Ev(s,r,c,f,o);case 3:e:{if(Et(r,r.stateNode.containerInfo),s===null)throw Error(i(387));c=r.pendingProps;var y=r.memoizedState;f=y.element,Zf(s,r),Yl(r,c,null,o);var b=r.memoizedState;if(c=b.cache,Fi(r,kt,c),c!==y.cache&&Kf(r,[kt],o,!0),Kl(),c=b.element,y.isDehydrated)if(y={element:c,isDehydrated:!1,cache:b.cache},r.updateQueue.baseState=y,r.memoizedState=y,r.flags&256){r=Sv(s,r,c,o);break e}else if(c!==f){f=Gn(Error(i(424)),r),zl(f),r=Sv(s,r,c,o);break e}else{switch(s=r.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(ot=Jn(s.firstChild),Wt=r,$e=!0,$i=null,Wn=!0,o=by(r,null,c,o),r.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling}else{if(ta(),c===f){r=ui(s,r,o);break e}Jt(s,r,c,o)}r=r.child}return r;case 26:return mh(s,r),s===null?(o=B_(r.type,null,r.pendingProps,null))?r.memoizedState=o:$e||(o=r.type,s=r.pendingProps,c=jh(Ne.current).createElement(o),c[Ct]=r,c[$t]=s,Xt(c,o,s),Nt(c),r.stateNode=c):r.memoizedState=B_(r.type,s.memoizedProps,r.pendingProps,s.memoizedState),null;case 27:return Vn(r),s===null&&$e&&(c=r.stateNode=L_(r.type,r.pendingProps,Ne.current),Wt=r,Wn=!0,f=ot,ir(r.type)?(dg=f,ot=Jn(c.firstChild)):ot=f),Jt(s,r,r.pendingProps.children,o),mh(s,r),s===null&&(r.flags|=4194304),r.child;case 5:return s===null&&$e&&((f=c=ot)&&(c=jA(c,r.type,r.pendingProps,Wn),c!==null?(r.stateNode=c,Wt=r,ot=Jn(c.firstChild),Wn=!1,f=!0):f=!1),f||qi(r)),Vn(r),f=r.type,y=r.pendingProps,b=s!==null?s.memoizedProps:null,c=y.children,og(f,y)?c=null:b!==null&&og(f,b)&&(r.flags|=32),r.memoizedState!==null&&(f=ap(s,r,YS,null,null,o),pc._currentValue=f),mh(s,r),Jt(s,r,c,o),r.child;case 6:return s===null&&$e&&((s=o=ot)&&(o=DA(o,r.pendingProps,Wn),o!==null?(r.stateNode=o,Wt=r,ot=null,s=!0):s=!1),s||qi(r)),null;case 13:return Av(s,r,o);case 4:return Et(r,r.stateNode.containerInfo),c=r.pendingProps,s===null?r.child=oa(r,null,c,o):Jt(s,r,c,o),r.child;case 11:return yv(s,r,r.type,r.pendingProps,o);case 7:return Jt(s,r,r.pendingProps,o),r.child;case 8:return Jt(s,r,r.pendingProps.children,o),r.child;case 12:return Jt(s,r,r.pendingProps.children,o),r.child;case 10:return c=r.pendingProps,Fi(r,r.type,c.value),Jt(s,r,c.children,o),r.child;case 9:return f=r.type._context,c=r.pendingProps.children,sa(r),f=Qt(f),c=c(f),r.flags|=1,Jt(s,r,c,o),r.child;case 14:return vv(s,r,r.type,r.pendingProps,o);case 15:return _v(s,r,r.type,r.pendingProps,o);case 19:return Nv(s,r,o);case 31:return nA(s,r,o);case 22:return bv(s,r,o,r.pendingProps);case 24:return sa(r),c=Qt(kt),s===null?(f=Qf(),f===null&&(f=it,y=Yf(),f.pooledCache=y,y.refCount++,y!==null&&(f.pooledCacheLanes|=o),f=y),r.memoizedState={parent:c,cache:f},Xf(r),Fi(r,kt,f)):((s.lanes&o)!==0&&(Zf(s,r),Yl(r,null,null,o),Kl()),f=s.memoizedState,y=r.memoizedState,f.parent!==c?(f={parent:c,cache:c},r.memoizedState=f,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=f),Fi(r,kt,c)):(c=y.cache,Fi(r,kt,c),c!==f.cache&&Kf(r,[kt],o,!0))),Jt(s,r,r.pendingProps.children,o),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function hi(s){s.flags|=4}function Dp(s,r,o,c,f){if((r=(s.mode&32)!==0)&&(r=!1),r){if(s.flags|=16777216,(f&335544128)===f)if(s.stateNode.complete)s.flags|=8192;else if(n_())s.flags|=8192;else throw aa=th,Jf}else s.flags&=-16777217}function kv(s,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!F_(r))if(n_())s.flags|=8192;else throw aa=th,Jf}function vh(s,r){r!==null&&(s.flags|=4),s.flags&16384&&(r=s.tag!==22?Eu():536870912,s.lanes|=r,bo|=r)}function ec(s,r){if(!$e)switch(s.tailMode){case"hidden":r=s.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?s.tail=null:o.sibling=null;break;case"collapsed":o=s.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?r||s.tail===null?s.tail=null:s.tail.sibling=null:c.sibling=null}}function lt(s){var r=s.alternate!==null&&s.alternate.child===s.child,o=0,c=0;if(r)for(var f=s.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags&65011712,c|=f.flags&65011712,f.return=s,f=f.sibling;else for(f=s.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags,c|=f.flags,f.return=s,f=f.sibling;return s.subtreeFlags|=c,s.childLanes=o,r}function iA(s,r,o){var c=r.pendingProps;switch(Hf(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return lt(r),null;case 1:return lt(r),null;case 3:return o=r.stateNode,c=null,s!==null&&(c=s.memoizedState.cache),r.memoizedState.cache!==c&&(r.flags|=2048),oi(kt),rt(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(s===null||s.child===null)&&(ao(r)?hi(r):s===null||s.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,qf())),lt(r),null;case 26:var f=r.type,y=r.memoizedState;return s===null?(hi(r),y!==null?(lt(r),kv(r,y)):(lt(r),Dp(r,f,null,c,o))):y?y!==s.memoizedState?(hi(r),lt(r),kv(r,y)):(lt(r),r.flags&=-16777217):(s=s.memoizedProps,s!==c&&hi(r),lt(r),Dp(r,f,s,c,o)),null;case 27:if(Ua(r),o=Ne.current,f=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==c&&hi(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return lt(r),null}s=fe.current,ao(r)?cy(r):(s=L_(f,c,o),r.stateNode=s,hi(r))}return lt(r),null;case 5:if(Ua(r),f=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==c&&hi(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return lt(r),null}if(y=fe.current,ao(r))cy(r);else{var b=jh(Ne.current);switch(y){case 1:y=b.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:y=b.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":y=b.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":y=b.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":y=b.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof c.is=="string"?b.createElement("select",{is:c.is}):b.createElement("select"),c.multiple?y.multiple=!0:c.size&&(y.size=c.size);break;default:y=typeof c.is=="string"?b.createElement(f,{is:c.is}):b.createElement(f)}}y[Ct]=r,y[$t]=c;e:for(b=r.child;b!==null;){if(b.tag===5||b.tag===6)y.appendChild(b.stateNode);else if(b.tag!==4&&b.tag!==27&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===r)break e;for(;b.sibling===null;){if(b.return===null||b.return===r)break e;b=b.return}b.sibling.return=b.return,b=b.sibling}r.stateNode=y;e:switch(Xt(y,f,c),f){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&hi(r)}}return lt(r),Dp(r,r.type,s===null?null:s.memoizedProps,r.pendingProps,o),null;case 6:if(s&&r.stateNode!=null)s.memoizedProps!==c&&hi(r);else{if(typeof c!="string"&&r.stateNode===null)throw Error(i(166));if(s=Ne.current,ao(r)){if(s=r.stateNode,o=r.memoizedProps,c=null,f=Wt,f!==null)switch(f.tag){case 27:case 5:c=f.memoizedProps}s[Ct]=r,s=!!(s.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||A_(s.nodeValue,o)),s||qi(r,!0)}else s=jh(s).createTextNode(c),s[Ct]=r,r.stateNode=s}return lt(r),null;case 31:if(o=r.memoizedState,s===null||s.memoizedState!==null){if(c=ao(r),o!==null){if(s===null){if(!c)throw Error(i(318));if(s=r.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[Ct]=r}else ta(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;lt(r),s=!1}else o=qf(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=o),s=!0;if(!s)return r.flags&256?(In(r),r):(In(r),null);if((r.flags&128)!==0)throw Error(i(558))}return lt(r),null;case 13:if(c=r.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(f=ao(r),c!==null&&c.dehydrated!==null){if(s===null){if(!f)throw Error(i(318));if(f=r.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(i(317));f[Ct]=r}else ta(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;lt(r),f=!1}else f=qf(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=f),f=!0;if(!f)return r.flags&256?(In(r),r):(In(r),null)}return In(r),(r.flags&128)!==0?(r.lanes=o,r):(o=c!==null,s=s!==null&&s.memoizedState!==null,o&&(c=r.child,f=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(f=c.alternate.memoizedState.cachePool.pool),y=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(y=c.memoizedState.cachePool.pool),y!==f&&(c.flags|=2048)),o!==s&&o&&(r.child.flags|=8192),vh(r,r.updateQueue),lt(r),null);case 4:return rt(),s===null&&ng(r.stateNode.containerInfo),lt(r),null;case 10:return oi(r.type),lt(r),null;case 19:if(ne(wt),c=r.memoizedState,c===null)return lt(r),null;if(f=(r.flags&128)!==0,y=c.rendering,y===null)if(f)ec(c,!1);else{if(mt!==0||s!==null&&(s.flags&128)!==0)for(s=r.child;s!==null;){if(y=rh(s),y!==null){for(r.flags|=128,ec(c,!1),s=y.updateQueue,r.updateQueue=s,vh(r,s),r.subtreeFlags=0,s=o,o=r.child;o!==null;)iy(o,s),o=o.sibling;return ue(wt,wt.current&1|2),$e&&ri(r,c.treeForkCount),r.child}s=s.sibling}c.tail!==null&&hn()>Th&&(r.flags|=128,f=!0,ec(c,!1),r.lanes=4194304)}else{if(!f)if(s=rh(y),s!==null){if(r.flags|=128,f=!0,s=s.updateQueue,r.updateQueue=s,vh(r,s),ec(c,!0),c.tail===null&&c.tailMode==="hidden"&&!y.alternate&&!$e)return lt(r),null}else 2*hn()-c.renderingStartTime>Th&&o!==536870912&&(r.flags|=128,f=!0,ec(c,!1),r.lanes=4194304);c.isBackwards?(y.sibling=r.child,r.child=y):(s=c.last,s!==null?s.sibling=y:r.child=y,c.last=y)}return c.tail!==null?(s=c.tail,c.rendering=s,c.tail=s.sibling,c.renderingStartTime=hn(),s.sibling=null,o=wt.current,ue(wt,f?o&1|2:o&1),$e&&ri(r,c.treeForkCount),s):(lt(r),null);case 22:case 23:return In(r),sp(),c=r.memoizedState!==null,s!==null?s.memoizedState!==null!==c&&(r.flags|=8192):c&&(r.flags|=8192),c?(o&536870912)!==0&&(r.flags&128)===0&&(lt(r),r.subtreeFlags&6&&(r.flags|=8192)):lt(r),o=r.updateQueue,o!==null&&vh(r,o.retryQueue),o=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),c=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),c!==o&&(r.flags|=2048),s!==null&&ne(ia),null;case 24:return o=null,s!==null&&(o=s.memoizedState.cache),r.memoizedState.cache!==o&&(r.flags|=2048),oi(kt),lt(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function rA(s,r){switch(Hf(r),r.tag){case 1:return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 3:return oi(kt),rt(),s=r.flags,(s&65536)!==0&&(s&128)===0?(r.flags=s&-65537|128,r):null;case 26:case 27:case 5:return Ua(r),null;case 31:if(r.memoizedState!==null){if(In(r),r.alternate===null)throw Error(i(340));ta()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 13:if(In(r),s=r.memoizedState,s!==null&&s.dehydrated!==null){if(r.alternate===null)throw Error(i(340));ta()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 19:return ne(wt),null;case 4:return rt(),null;case 10:return oi(r.type),null;case 22:case 23:return In(r),sp(),s!==null&&ne(ia),s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 24:return oi(kt),null;case 25:return null;default:return null}}function Iv(s,r){switch(Hf(r),r.tag){case 3:oi(kt),rt();break;case 26:case 27:case 5:Ua(r);break;case 4:rt();break;case 31:r.memoizedState!==null&&In(r);break;case 13:In(r);break;case 19:ne(wt);break;case 10:oi(r.type);break;case 22:case 23:In(r),sp(),s!==null&&ne(ia);break;case 24:oi(kt)}}function tc(s,r){try{var o=r.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var f=c.next;o=f;do{if((o.tag&s)===s){c=void 0;var y=o.create,b=o.inst;c=y(),b.destroy=c}o=o.next}while(o!==f)}}catch(E){Ze(r,r.return,E)}}function Ji(s,r,o){try{var c=r.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var y=f.next;c=y;do{if((c.tag&s)===s){var b=c.inst,E=b.destroy;if(E!==void 0){b.destroy=void 0,f=r;var P=o,Q=E;try{Q()}catch(ie){Ze(f,P,ie)}}}c=c.next}while(c!==y)}}catch(ie){Ze(r,r.return,ie)}}function Ov(s){var r=s.updateQueue;if(r!==null){var o=s.stateNode;try{xy(r,o)}catch(c){Ze(s,s.return,c)}}}function jv(s,r,o){o.props=ca(s.type,s.memoizedProps),o.state=s.memoizedState;try{o.componentWillUnmount()}catch(c){Ze(s,r,c)}}function nc(s,r){try{var o=s.ref;if(o!==null){switch(s.tag){case 26:case 27:case 5:var c=s.stateNode;break;case 30:c=s.stateNode;break;default:c=s.stateNode}typeof o=="function"?s.refCleanup=o(c):o.current=c}}catch(f){Ze(s,r,f)}}function zs(s,r){var o=s.ref,c=s.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(f){Ze(s,r,f)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(f){Ze(s,r,f)}else o.current=null}function Dv(s){var r=s.type,o=s.memoizedProps,c=s.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(f){Ze(s,s.return,f)}}function Pp(s,r,o){try{var c=s.stateNode;CA(c,s.type,o,r),c[$t]=r}catch(f){Ze(s,s.return,f)}}function Pv(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&ir(s.type)||s.tag===4}function Mp(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Pv(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&ir(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Lp(s,r,o){var c=s.tag;if(c===5||c===6)s=s.stateNode,r?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(s,r):(r=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,r.appendChild(s),o=o._reactRootContainer,o!=null||r.onclick!==null||(r.onclick=as));else if(c!==4&&(c===27&&ir(s.type)&&(o=s.stateNode,r=null),s=s.child,s!==null))for(Lp(s,r,o),s=s.sibling;s!==null;)Lp(s,r,o),s=s.sibling}function _h(s,r,o){var c=s.tag;if(c===5||c===6)s=s.stateNode,r?o.insertBefore(s,r):o.appendChild(s);else if(c!==4&&(c===27&&ir(s.type)&&(o=s.stateNode),s=s.child,s!==null))for(_h(s,r,o),s=s.sibling;s!==null;)_h(s,r,o),s=s.sibling}function Mv(s){var r=s.stateNode,o=s.memoizedProps;try{for(var c=s.type,f=r.attributes;f.length;)r.removeAttributeNode(f[0]);Xt(r,c,o),r[Ct]=s,r[$t]=o}catch(y){Ze(s,s.return,y)}}var di=!1,jt=!1,Up=!1,Lv=typeof WeakSet=="function"?WeakSet:Set,Ft=null;function aA(s,r){if(s=s.containerInfo,rg=Bh,s=W0(s),If(s)){if("selectionStart"in s)var o={start:s.selectionStart,end:s.selectionEnd};else e:{o=(o=s.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var f=c.anchorOffset,y=c.focusNode;c=c.focusOffset;try{o.nodeType,y.nodeType}catch{o=null;break e}var b=0,E=-1,P=-1,Q=0,ie=0,ae=s,X=null;t:for(;;){for(var te;ae!==o||f!==0&&ae.nodeType!==3||(E=b+f),ae!==y||c!==0&&ae.nodeType!==3||(P=b+c),ae.nodeType===3&&(b+=ae.nodeValue.length),(te=ae.firstChild)!==null;)X=ae,ae=te;for(;;){if(ae===s)break t;if(X===o&&++Q===f&&(E=b),X===y&&++ie===c&&(P=b),(te=ae.nextSibling)!==null)break;ae=X,X=ae.parentNode}ae=te}o=E===-1||P===-1?null:{start:E,end:P}}else o=null}o=o||{start:0,end:0}}else o=null;for(ag={focusedElem:s,selectionRange:o},Bh=!1,Ft=r;Ft!==null;)if(r=Ft,s=r.child,(r.subtreeFlags&1028)!==0&&s!==null)s.return=r,Ft=s;else for(;Ft!==null;){switch(r=Ft,y=r.alternate,s=r.flags,r.tag){case 0:if((s&4)!==0&&(s=r.updateQueue,s=s!==null?s.events:null,s!==null))for(o=0;o<s.length;o++)f=s[o],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&y!==null){s=void 0,o=r,f=y.memoizedProps,y=y.memoizedState,c=o.stateNode;try{var ge=ca(o.type,f);s=c.getSnapshotBeforeUpdate(ge,y),c.__reactInternalSnapshotBeforeUpdate=s}catch(xe){Ze(o,o.return,xe)}}break;case 3:if((s&1024)!==0){if(s=r.stateNode.containerInfo,o=s.nodeType,o===9)cg(s);else if(o===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":cg(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=r.sibling,s!==null){s.return=r.return,Ft=s;break}Ft=r.return}}function Uv(s,r,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:pi(s,o),c&4&&tc(5,o);break;case 1:if(pi(s,o),c&4)if(s=o.stateNode,r===null)try{s.componentDidMount()}catch(b){Ze(o,o.return,b)}else{var f=ca(o.type,r.memoizedProps);r=r.memoizedState;try{s.componentDidUpdate(f,r,s.__reactInternalSnapshotBeforeUpdate)}catch(b){Ze(o,o.return,b)}}c&64&&Ov(o),c&512&&nc(o,o.return);break;case 3:if(pi(s,o),c&64&&(s=o.updateQueue,s!==null)){if(r=null,o.child!==null)switch(o.child.tag){case 27:case 5:r=o.child.stateNode;break;case 1:r=o.child.stateNode}try{xy(s,r)}catch(b){Ze(o,o.return,b)}}break;case 27:r===null&&c&4&&Mv(o);case 26:case 5:pi(s,o),r===null&&c&4&&Dv(o),c&512&&nc(o,o.return);break;case 12:pi(s,o);break;case 31:pi(s,o),c&4&&zv(s,o);break;case 13:pi(s,o),c&4&&Hv(s,o),c&64&&(s=o.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(o=gA.bind(null,o),PA(s,o))));break;case 22:if(c=o.memoizedState!==null||di,!c){r=r!==null&&r.memoizedState!==null||jt,f=di;var y=jt;di=c,(jt=r)&&!y?gi(s,o,(o.subtreeFlags&8772)!==0):pi(s,o),di=f,jt=y}break;case 30:break;default:pi(s,o)}}function Vv(s){var r=s.alternate;r!==null&&(s.alternate=null,Vv(r)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(r=s.stateNode,r!==null&&$a(r)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var dt=null,yn=!1;function fi(s,r,o){for(o=o.child;o!==null;)Bv(s,r,o),o=o.sibling}function Bv(s,r,o){if(Kt&&typeof Kt.onCommitFiberUnmount=="function")try{Kt.onCommitFiberUnmount(ns,o)}catch{}switch(o.tag){case 26:jt||zs(o,r),fi(s,r,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:jt||zs(o,r);var c=dt,f=yn;ir(o.type)&&(dt=o.stateNode,yn=!1),fi(s,r,o),hc(o.stateNode),dt=c,yn=f;break;case 5:jt||zs(o,r);case 6:if(c=dt,f=yn,dt=null,fi(s,r,o),dt=c,yn=f,dt!==null)if(yn)try{(dt.nodeType===9?dt.body:dt.nodeName==="HTML"?dt.ownerDocument.body:dt).removeChild(o.stateNode)}catch(y){Ze(o,r,y)}else try{dt.removeChild(o.stateNode)}catch(y){Ze(o,r,y)}break;case 18:dt!==null&&(yn?(s=dt,O_(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,o.stateNode),No(s)):O_(dt,o.stateNode));break;case 4:c=dt,f=yn,dt=o.stateNode.containerInfo,yn=!0,fi(s,r,o),dt=c,yn=f;break;case 0:case 11:case 14:case 15:Ji(2,o,r),jt||Ji(4,o,r),fi(s,r,o);break;case 1:jt||(zs(o,r),c=o.stateNode,typeof c.componentWillUnmount=="function"&&jv(o,r,c)),fi(s,r,o);break;case 21:fi(s,r,o);break;case 22:jt=(c=jt)||o.memoizedState!==null,fi(s,r,o),jt=c;break;default:fi(s,r,o)}}function zv(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{No(s)}catch(o){Ze(r,r.return,o)}}}function Hv(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{No(s)}catch(o){Ze(r,r.return,o)}}function oA(s){switch(s.tag){case 31:case 13:case 19:var r=s.stateNode;return r===null&&(r=s.stateNode=new Lv),r;case 22:return s=s.stateNode,r=s._retryCache,r===null&&(r=s._retryCache=new Lv),r;default:throw Error(i(435,s.tag))}}function bh(s,r){var o=oA(s);r.forEach(function(c){if(!o.has(c)){o.add(c);var f=mA.bind(null,s,c);c.then(f,f)}})}function vn(s,r){var o=r.deletions;if(o!==null)for(var c=0;c<o.length;c++){var f=o[c],y=s,b=r,E=b;e:for(;E!==null;){switch(E.tag){case 27:if(ir(E.type)){dt=E.stateNode,yn=!1;break e}break;case 5:dt=E.stateNode,yn=!1;break e;case 3:case 4:dt=E.stateNode.containerInfo,yn=!0;break e}E=E.return}if(dt===null)throw Error(i(160));Bv(y,b,f),dt=null,yn=!1,y=f.alternate,y!==null&&(y.return=null),f.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)$v(r,s),r=r.sibling}var ds=null;function $v(s,r){var o=s.alternate,c=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:vn(r,s),_n(s),c&4&&(Ji(3,s,s.return),tc(3,s),Ji(5,s,s.return));break;case 1:vn(r,s),_n(s),c&512&&(jt||o===null||zs(o,o.return)),c&64&&di&&(s=s.updateQueue,s!==null&&(c=s.callbacks,c!==null&&(o=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var f=ds;if(vn(r,s),_n(s),c&512&&(jt||o===null||zs(o,o.return)),c&4){var y=o!==null?o.memoizedState:null;if(c=s.memoizedState,o===null)if(c===null)if(s.stateNode===null){e:{c=s.type,o=s.memoizedProps,f=f.ownerDocument||f;t:switch(c){case"title":y=f.getElementsByTagName("title")[0],(!y||y[Cs]||y[Ct]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=f.createElement(c),f.head.insertBefore(y,f.querySelector("head > title"))),Xt(y,c,o),y[Ct]=s,Nt(y),c=y;break e;case"link":var b=$_("link","href",f).get(c+(o.href||""));if(b){for(var E=0;E<b.length;E++)if(y=b[E],y.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&y.getAttribute("rel")===(o.rel==null?null:o.rel)&&y.getAttribute("title")===(o.title==null?null:o.title)&&y.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){b.splice(E,1);break t}}y=f.createElement(c),Xt(y,c,o),f.head.appendChild(y);break;case"meta":if(b=$_("meta","content",f).get(c+(o.content||""))){for(E=0;E<b.length;E++)if(y=b[E],y.getAttribute("content")===(o.content==null?null:""+o.content)&&y.getAttribute("name")===(o.name==null?null:o.name)&&y.getAttribute("property")===(o.property==null?null:o.property)&&y.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&y.getAttribute("charset")===(o.charSet==null?null:o.charSet)){b.splice(E,1);break t}}y=f.createElement(c),Xt(y,c,o),f.head.appendChild(y);break;default:throw Error(i(468,c))}y[Ct]=s,Nt(y),c=y}s.stateNode=c}else q_(f,s.type,s.stateNode);else s.stateNode=H_(f,c,s.memoizedProps);else y!==c?(y===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):y.count--,c===null?q_(f,s.type,s.stateNode):H_(f,c,s.memoizedProps)):c===null&&s.stateNode!==null&&Pp(s,s.memoizedProps,o.memoizedProps)}break;case 27:vn(r,s),_n(s),c&512&&(jt||o===null||zs(o,o.return)),o!==null&&c&4&&Pp(s,s.memoizedProps,o.memoizedProps);break;case 5:if(vn(r,s),_n(s),c&512&&(jt||o===null||zs(o,o.return)),s.flags&32){f=s.stateNode;try{mn(f,"")}catch(ge){Ze(s,s.return,ge)}}c&4&&s.stateNode!=null&&(f=s.memoizedProps,Pp(s,f,o!==null?o.memoizedProps:f)),c&1024&&(Up=!0);break;case 6:if(vn(r,s),_n(s),c&4){if(s.stateNode===null)throw Error(i(162));c=s.memoizedProps,o=s.stateNode;try{o.nodeValue=c}catch(ge){Ze(s,s.return,ge)}}break;case 3:if(Mh=null,f=ds,ds=Dh(r.containerInfo),vn(r,s),ds=f,_n(s),c&4&&o!==null&&o.memoizedState.isDehydrated)try{No(r.containerInfo)}catch(ge){Ze(s,s.return,ge)}Up&&(Up=!1,qv(s));break;case 4:c=ds,ds=Dh(s.stateNode.containerInfo),vn(r,s),_n(s),ds=c;break;case 12:vn(r,s),_n(s);break;case 31:vn(r,s),_n(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,bh(s,c)));break;case 13:vn(r,s),_n(s),s.child.flags&8192&&s.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(xh=hn()),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,bh(s,c)));break;case 22:f=s.memoizedState!==null;var P=o!==null&&o.memoizedState!==null,Q=di,ie=jt;if(di=Q||f,jt=ie||P,vn(r,s),jt=ie,di=Q,_n(s),c&8192)e:for(r=s.stateNode,r._visibility=f?r._visibility&-2:r._visibility|1,f&&(o===null||P||di||jt||ua(s)),o=null,r=s;;){if(r.tag===5||r.tag===26){if(o===null){P=o=r;try{if(y=P.stateNode,f)b=y.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none";else{E=P.stateNode;var ae=P.memoizedProps.style,X=ae!=null&&ae.hasOwnProperty("display")?ae.display:null;E.style.display=X==null||typeof X=="boolean"?"":(""+X).trim()}}catch(ge){Ze(P,P.return,ge)}}}else if(r.tag===6){if(o===null){P=r;try{P.stateNode.nodeValue=f?"":P.memoizedProps}catch(ge){Ze(P,P.return,ge)}}}else if(r.tag===18){if(o===null){P=r;try{var te=P.stateNode;f?j_(te,!0):j_(P.stateNode,!1)}catch(ge){Ze(P,P.return,ge)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===s)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;o===r&&(o=null),r=r.return}o===r&&(o=null),r.sibling.return=r.return,r=r.sibling}c&4&&(c=s.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,bh(s,o))));break;case 19:vn(r,s),_n(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,bh(s,c)));break;case 30:break;case 21:break;default:vn(r,s),_n(s)}}function _n(s){var r=s.flags;if(r&2){try{for(var o,c=s.return;c!==null;){if(Pv(c)){o=c;break}c=c.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var f=o.stateNode,y=Mp(s);_h(s,y,f);break;case 5:var b=o.stateNode;o.flags&32&&(mn(b,""),o.flags&=-33);var E=Mp(s);_h(s,E,b);break;case 3:case 4:var P=o.stateNode.containerInfo,Q=Mp(s);Lp(s,Q,P);break;default:throw Error(i(161))}}catch(ie){Ze(s,s.return,ie)}s.flags&=-3}r&4096&&(s.flags&=-4097)}function qv(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var r=s;qv(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),s=s.sibling}}function pi(s,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)Uv(s,r.alternate,r),r=r.sibling}function ua(s){for(s=s.child;s!==null;){var r=s;switch(r.tag){case 0:case 11:case 14:case 15:Ji(4,r,r.return),ua(r);break;case 1:zs(r,r.return);var o=r.stateNode;typeof o.componentWillUnmount=="function"&&jv(r,r.return,o),ua(r);break;case 27:hc(r.stateNode);case 26:case 5:zs(r,r.return),ua(r);break;case 22:r.memoizedState===null&&ua(r);break;case 30:ua(r);break;default:ua(r)}s=s.sibling}}function gi(s,r,o){for(o=o&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var c=r.alternate,f=s,y=r,b=y.flags;switch(y.tag){case 0:case 11:case 15:gi(f,y,o),tc(4,y);break;case 1:if(gi(f,y,o),c=y,f=c.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(Q){Ze(c,c.return,Q)}if(c=y,f=c.updateQueue,f!==null){var E=c.stateNode;try{var P=f.shared.hiddenCallbacks;if(P!==null)for(f.shared.hiddenCallbacks=null,f=0;f<P.length;f++)wy(P[f],E)}catch(Q){Ze(c,c.return,Q)}}o&&b&64&&Ov(y),nc(y,y.return);break;case 27:Mv(y);case 26:case 5:gi(f,y,o),o&&c===null&&b&4&&Dv(y),nc(y,y.return);break;case 12:gi(f,y,o);break;case 31:gi(f,y,o),o&&b&4&&zv(f,y);break;case 13:gi(f,y,o),o&&b&4&&Hv(f,y);break;case 22:y.memoizedState===null&&gi(f,y,o),nc(y,y.return);break;case 30:break;default:gi(f,y,o)}r=r.sibling}}function Vp(s,r){var o=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),s=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(s=r.memoizedState.cachePool.pool),s!==o&&(s!=null&&s.refCount++,o!=null&&Hl(o))}function Bp(s,r){s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&Hl(s))}function fs(s,r,o,c){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)Fv(s,r,o,c),r=r.sibling}function Fv(s,r,o,c){var f=r.flags;switch(r.tag){case 0:case 11:case 15:fs(s,r,o,c),f&2048&&tc(9,r);break;case 1:fs(s,r,o,c);break;case 3:fs(s,r,o,c),f&2048&&(s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&Hl(s)));break;case 12:if(f&2048){fs(s,r,o,c),s=r.stateNode;try{var y=r.memoizedProps,b=y.id,E=y.onPostCommit;typeof E=="function"&&E(b,r.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(P){Ze(r,r.return,P)}}else fs(s,r,o,c);break;case 31:fs(s,r,o,c);break;case 13:fs(s,r,o,c);break;case 23:break;case 22:y=r.stateNode,b=r.alternate,r.memoizedState!==null?y._visibility&2?fs(s,r,o,c):sc(s,r):y._visibility&2?fs(s,r,o,c):(y._visibility|=2,yo(s,r,o,c,(r.subtreeFlags&10256)!==0||!1)),f&2048&&Vp(b,r);break;case 24:fs(s,r,o,c),f&2048&&Bp(r.alternate,r);break;default:fs(s,r,o,c)}}function yo(s,r,o,c,f){for(f=f&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var y=s,b=r,E=o,P=c,Q=b.flags;switch(b.tag){case 0:case 11:case 15:yo(y,b,E,P,f),tc(8,b);break;case 23:break;case 22:var ie=b.stateNode;b.memoizedState!==null?ie._visibility&2?yo(y,b,E,P,f):sc(y,b):(ie._visibility|=2,yo(y,b,E,P,f)),f&&Q&2048&&Vp(b.alternate,b);break;case 24:yo(y,b,E,P,f),f&&Q&2048&&Bp(b.alternate,b);break;default:yo(y,b,E,P,f)}r=r.sibling}}function sc(s,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var o=s,c=r,f=c.flags;switch(c.tag){case 22:sc(o,c),f&2048&&Vp(c.alternate,c);break;case 24:sc(o,c),f&2048&&Bp(c.alternate,c);break;default:sc(o,c)}r=r.sibling}}var ic=8192;function vo(s,r,o){if(s.subtreeFlags&ic)for(s=s.child;s!==null;)Gv(s,r,o),s=s.sibling}function Gv(s,r,o){switch(s.tag){case 26:vo(s,r,o),s.flags&ic&&s.memoizedState!==null&&KA(o,ds,s.memoizedState,s.memoizedProps);break;case 5:vo(s,r,o);break;case 3:case 4:var c=ds;ds=Dh(s.stateNode.containerInfo),vo(s,r,o),ds=c;break;case 22:s.memoizedState===null&&(c=s.alternate,c!==null&&c.memoizedState!==null?(c=ic,ic=16777216,vo(s,r,o),ic=c):vo(s,r,o));break;default:vo(s,r,o)}}function Kv(s){var r=s.alternate;if(r!==null&&(s=r.child,s!==null)){r.child=null;do r=s.sibling,s.sibling=null,s=r;while(s!==null)}}function rc(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var c=r[o];Ft=c,Wv(c,s)}Kv(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Yv(s),s=s.sibling}function Yv(s){switch(s.tag){case 0:case 11:case 15:rc(s),s.flags&2048&&Ji(9,s,s.return);break;case 3:rc(s);break;case 12:rc(s);break;case 22:var r=s.stateNode;s.memoizedState!==null&&r._visibility&2&&(s.return===null||s.return.tag!==13)?(r._visibility&=-3,wh(s)):rc(s);break;default:rc(s)}}function wh(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var c=r[o];Ft=c,Wv(c,s)}Kv(s)}for(s=s.child;s!==null;){switch(r=s,r.tag){case 0:case 11:case 15:Ji(8,r,r.return),wh(r);break;case 22:o=r.stateNode,o._visibility&2&&(o._visibility&=-3,wh(r));break;default:wh(r)}s=s.sibling}}function Wv(s,r){for(;Ft!==null;){var o=Ft;switch(o.tag){case 0:case 11:case 15:Ji(8,o,r);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:Hl(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,Ft=c;else e:for(o=s;Ft!==null;){c=Ft;var f=c.sibling,y=c.return;if(Vv(c),c===o){Ft=null;break e}if(f!==null){f.return=y,Ft=f;break e}Ft=y}}}var lA={getCacheForType:function(s){var r=Qt(kt),o=r.data.get(s);return o===void 0&&(o=s(),r.data.set(s,o)),o},cacheSignal:function(){return Qt(kt).controller.signal}},cA=typeof WeakMap=="function"?WeakMap:Map,We=0,it=null,Me=null,Ue=0,Xe=0,On=null,Xi=!1,_o=!1,zp=!1,mi=0,mt=0,Zi=0,ha=0,Hp=0,jn=0,bo=0,ac=null,bn=null,$p=!1,xh=0,Qv=0,Th=1/0,Eh=null,er=null,Vt=0,tr=null,wo=null,yi=0,qp=0,Fp=null,Jv=null,oc=0,Gp=null;function Dn(){return(We&2)!==0&&Ue!==0?Ue&-Ue:O.T!==null?Xp():Su()}function Xv(){if(jn===0)if((Ue&536870912)===0||$e){var s=Ur;Ur<<=1,(Ur&3932160)===0&&(Ur=262144),jn=s}else jn=536870912;return s=kn.current,s!==null&&(s.flags|=32),jn}function wn(s,r,o){(s===it&&(Xe===2||Xe===9)||s.cancelPendingCommit!==null)&&(xo(s,0),nr(s,Ue,jn,!1)),Vr(s,o),((We&2)===0||s!==it)&&(s===it&&((We&2)===0&&(ha|=o),mt===4&&nr(s,Ue,jn,!1)),Hs(s))}function Zv(s,r,o){if((We&6)!==0)throw Error(i(327));var c=!o&&(r&127)===0&&(r&s.expiredLanes)===0||ss(s,r),f=c?dA(s,r):Yp(s,r,!0),y=c;do{if(f===0){_o&&!c&&nr(s,r,0,!1);break}else{if(o=s.current.alternate,y&&!uA(o)){f=Yp(s,r,!1),y=!1;continue}if(f===2){if(y=r,s.errorRecoveryDisabledLanes&y)var b=0;else b=s.pendingLanes&-536870913,b=b!==0?b:b&536870912?536870912:0;if(b!==0){r=b;e:{var E=s;f=ac;var P=E.current.memoizedState.isDehydrated;if(P&&(xo(E,b).flags|=256),b=Yp(E,b,!1),b!==2){if(zp&&!P){E.errorRecoveryDisabledLanes|=y,ha|=y,f=4;break e}y=bn,bn=f,y!==null&&(bn===null?bn=y:bn.push.apply(bn,y))}f=b}if(y=!1,f!==2)continue}}if(f===1){xo(s,0),nr(s,r,0,!0);break}e:{switch(c=s,y=f,y){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:nr(c,r,jn,!Xi);break e;case 2:bn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(f=xh+300-hn(),10<f)){if(nr(c,r,jn,!Xi),Es(c,0,!0)!==0)break e;yi=r,c.timeoutHandle=k_(e_.bind(null,c,o,bn,Eh,$p,r,jn,ha,bo,Xi,y,"Throttled",-0,0),f);break e}e_(c,o,bn,Eh,$p,r,jn,ha,bo,Xi,y,null,-0,0)}}break}while(!0);Hs(s)}function e_(s,r,o,c,f,y,b,E,P,Q,ie,ae,X,te){if(s.timeoutHandle=-1,ae=r.subtreeFlags,ae&8192||(ae&16785408)===16785408){ae={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:as},Gv(r,y,ae);var ge=(y&62914560)===y?xh-hn():(y&4194048)===y?Qv-hn():0;if(ge=YA(ae,ge),ge!==null){yi=y,s.cancelPendingCommit=ge(l_.bind(null,s,r,y,o,c,f,b,E,P,ie,ae,null,X,te)),nr(s,y,b,!Q);return}}l_(s,r,y,o,c,f,b,E,P)}function uA(s){for(var r=s;;){var o=r.tag;if((o===0||o===11||o===15)&&r.flags&16384&&(o=r.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var f=o[c],y=f.getSnapshot;f=f.value;try{if(!Nn(y(),f))return!1}catch{return!1}}if(o=r.child,r.subtreeFlags&16384&&o!==null)o.return=r,r=o;else{if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function nr(s,r,o,c){r&=~Hp,r&=~ha,s.suspendedLanes|=r,s.pingedLanes&=~r,c&&(s.warmLanes|=r),c=s.expirationTimes;for(var f=r;0<f;){var y=31-_t(f),b=1<<y;c[y]=-1,f&=~b}o!==0&&Br(s,o,r)}function Sh(){return(We&6)===0?(lc(0),!1):!0}function Kp(){if(Me!==null){if(Xe===0)var s=Me.return;else s=Me,ai=na=null,cp(s),ho=null,ql=0,s=Me;for(;s!==null;)Iv(s.alternate,s),s=s.return;Me=null}}function xo(s,r){var o=s.timeoutHandle;o!==-1&&(s.timeoutHandle=-1,kA(o)),o=s.cancelPendingCommit,o!==null&&(s.cancelPendingCommit=null,o()),yi=0,Kp(),it=s,Me=o=ii(s.current,null),Ue=r,Xe=0,On=null,Xi=!1,_o=ss(s,r),zp=!1,bo=jn=Hp=ha=Zi=mt=0,bn=ac=null,$p=!1,(r&8)!==0&&(r|=r&32);var c=s.entangledLanes;if(c!==0)for(s=s.entanglements,c&=r;0<c;){var f=31-_t(c),y=1<<f;r|=s[f],c&=~y}return mi=r,Gu(),o}function t_(s,r){je=null,O.H=Xl,r===uo||r===eh?(r=yy(),Xe=3):r===Jf?(r=yy(),Xe=4):Xe=r===Sp?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,On=r,Me===null&&(mt=1,ph(s,Gn(r,s.current)))}function n_(){var s=kn.current;return s===null?!0:(Ue&4194048)===Ue?Qn===null:(Ue&62914560)===Ue||(Ue&536870912)!==0?s===Qn:!1}function s_(){var s=O.H;return O.H=Xl,s===null?Xl:s}function i_(){var s=O.A;return O.A=lA,s}function Ah(){mt=4,Xi||(Ue&4194048)!==Ue&&kn.current!==null||(_o=!0),(Zi&134217727)===0&&(ha&134217727)===0||it===null||nr(it,Ue,jn,!1)}function Yp(s,r,o){var c=We;We|=2;var f=s_(),y=i_();(it!==s||Ue!==r)&&(Eh=null,xo(s,r)),r=!1;var b=mt;e:do try{if(Xe!==0&&Me!==null){var E=Me,P=On;switch(Xe){case 8:Kp(),b=6;break e;case 3:case 2:case 9:case 6:kn.current===null&&(r=!0);var Q=Xe;if(Xe=0,On=null,To(s,E,P,Q),o&&_o){b=0;break e}break;default:Q=Xe,Xe=0,On=null,To(s,E,P,Q)}}hA(),b=mt;break}catch(ie){t_(s,ie)}while(!0);return r&&s.shellSuspendCounter++,ai=na=null,We=c,O.H=f,O.A=y,Me===null&&(it=null,Ue=0,Gu()),b}function hA(){for(;Me!==null;)r_(Me)}function dA(s,r){var o=We;We|=2;var c=s_(),f=i_();it!==s||Ue!==r?(Eh=null,Th=hn()+500,xo(s,r)):_o=ss(s,r);e:do try{if(Xe!==0&&Me!==null){r=Me;var y=On;t:switch(Xe){case 1:Xe=0,On=null,To(s,r,y,1);break;case 2:case 9:if(gy(y)){Xe=0,On=null,a_(r);break}r=function(){Xe!==2&&Xe!==9||it!==s||(Xe=7),Hs(s)},y.then(r,r);break e;case 3:Xe=7;break e;case 4:Xe=5;break e;case 7:gy(y)?(Xe=0,On=null,a_(r)):(Xe=0,On=null,To(s,r,y,7));break;case 5:var b=null;switch(Me.tag){case 26:b=Me.memoizedState;case 5:case 27:var E=Me;if(b?F_(b):E.stateNode.complete){Xe=0,On=null;var P=E.sibling;if(P!==null)Me=P;else{var Q=E.return;Q!==null?(Me=Q,Ch(Q)):Me=null}break t}}Xe=0,On=null,To(s,r,y,5);break;case 6:Xe=0,On=null,To(s,r,y,6);break;case 8:Kp(),mt=6;break e;default:throw Error(i(462))}}fA();break}catch(ie){t_(s,ie)}while(!0);return ai=na=null,O.H=c,O.A=f,We=o,Me!==null?0:(it=null,Ue=0,Gu(),mt)}function fA(){for(;Me!==null&&!Ef();)r_(Me)}function r_(s){var r=Rv(s.alternate,s,mi);s.memoizedProps=s.pendingProps,r===null?Ch(s):Me=r}function a_(s){var r=s,o=r.alternate;switch(r.tag){case 15:case 0:r=Tv(o,r,r.pendingProps,r.type,void 0,Ue);break;case 11:r=Tv(o,r,r.pendingProps,r.type.render,r.ref,Ue);break;case 5:cp(r);default:Iv(o,r),r=Me=iy(r,mi),r=Rv(o,r,mi)}s.memoizedProps=s.pendingProps,r===null?Ch(s):Me=r}function To(s,r,o,c){ai=na=null,cp(r),ho=null,ql=0;var f=r.return;try{if(tA(s,f,r,o,Ue)){mt=1,ph(s,Gn(o,s.current)),Me=null;return}}catch(y){if(f!==null)throw Me=f,y;mt=1,ph(s,Gn(o,s.current)),Me=null;return}r.flags&32768?($e||c===1?s=!0:_o||(Ue&536870912)!==0?s=!1:(Xi=s=!0,(c===2||c===9||c===3||c===6)&&(c=kn.current,c!==null&&c.tag===13&&(c.flags|=16384))),o_(r,s)):Ch(r)}function Ch(s){var r=s;do{if((r.flags&32768)!==0){o_(r,Xi);return}s=r.return;var o=iA(r.alternate,r,mi);if(o!==null){Me=o;return}if(r=r.sibling,r!==null){Me=r;return}Me=r=s}while(r!==null);mt===0&&(mt=5)}function o_(s,r){do{var o=rA(s.alternate,s);if(o!==null){o.flags&=32767,Me=o;return}if(o=s.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!r&&(s=s.sibling,s!==null)){Me=s;return}Me=s=o}while(s!==null);mt=6,Me=null}function l_(s,r,o,c,f,y,b,E,P){s.cancelPendingCommit=null;do Nh();while(Vt!==0);if((We&6)!==0)throw Error(i(327));if(r!==null){if(r===s.current)throw Error(i(177));if(y=r.lanes|r.childLanes,y|=Mf,Cf(s,o,y,b,E,P),s===it&&(Me=it=null,Ue=0),wo=r,tr=s,yi=o,qp=y,Fp=f,Jv=c,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,yA(Oi,function(){return f_(),null})):(s.callbackNode=null,s.callbackPriority=0),c=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||c){c=O.T,O.T=null,f=se.p,se.p=2,b=We,We|=4;try{aA(s,r,o)}finally{We=b,se.p=f,O.T=c}}Vt=1,c_(),u_(),h_()}}function c_(){if(Vt===1){Vt=0;var s=tr,r=wo,o=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||o){o=O.T,O.T=null;var c=se.p;se.p=2;var f=We;We|=4;try{$v(r,s);var y=ag,b=W0(s.containerInfo),E=y.focusedElem,P=y.selectionRange;if(b!==E&&E&&E.ownerDocument&&Y0(E.ownerDocument.documentElement,E)){if(P!==null&&If(E)){var Q=P.start,ie=P.end;if(ie===void 0&&(ie=Q),"selectionStart"in E)E.selectionStart=Q,E.selectionEnd=Math.min(ie,E.value.length);else{var ae=E.ownerDocument||document,X=ae&&ae.defaultView||window;if(X.getSelection){var te=X.getSelection(),ge=E.textContent.length,xe=Math.min(P.start,ge),st=P.end===void 0?xe:Math.min(P.end,ge);!te.extend&&xe>st&&(b=st,st=xe,xe=b);var K=K0(E,xe),z=K0(E,st);if(K&&z&&(te.rangeCount!==1||te.anchorNode!==K.node||te.anchorOffset!==K.offset||te.focusNode!==z.node||te.focusOffset!==z.offset)){var W=ae.createRange();W.setStart(K.node,K.offset),te.removeAllRanges(),xe>st?(te.addRange(W),te.extend(z.node,z.offset)):(W.setEnd(z.node,z.offset),te.addRange(W))}}}}for(ae=[],te=E;te=te.parentNode;)te.nodeType===1&&ae.push({element:te,left:te.scrollLeft,top:te.scrollTop});for(typeof E.focus=="function"&&E.focus(),E=0;E<ae.length;E++){var re=ae[E];re.element.scrollLeft=re.left,re.element.scrollTop=re.top}}Bh=!!rg,ag=rg=null}finally{We=f,se.p=c,O.T=o}}s.current=r,Vt=2}}function u_(){if(Vt===2){Vt=0;var s=tr,r=wo,o=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||o){o=O.T,O.T=null;var c=se.p;se.p=2;var f=We;We|=4;try{Uv(s,r.alternate,r)}finally{We=f,se.p=c,O.T=o}}Vt=3}}function h_(){if(Vt===4||Vt===3){Vt=0,vu();var s=tr,r=wo,o=yi,c=Jv;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Vt=5:(Vt=0,wo=tr=null,d_(s,s.pendingLanes));var f=s.pendingLanes;if(f===0&&(er=null),ei(o),r=r.stateNode,Kt&&typeof Kt.onCommitFiberRoot=="function")try{Kt.onCommitFiberRoot(ns,r,void 0,(r.current.flags&128)===128)}catch{}if(c!==null){r=O.T,f=se.p,se.p=2,O.T=null;try{for(var y=s.onRecoverableError,b=0;b<c.length;b++){var E=c[b];y(E.value,{componentStack:E.stack})}}finally{O.T=r,se.p=f}}(yi&3)!==0&&Nh(),Hs(s),f=s.pendingLanes,(o&261930)!==0&&(f&42)!==0?s===Gp?oc++:(oc=0,Gp=s):oc=0,lc(0)}}function d_(s,r){(s.pooledCacheLanes&=r)===0&&(r=s.pooledCache,r!=null&&(s.pooledCache=null,Hl(r)))}function Nh(){return c_(),u_(),h_(),f_()}function f_(){if(Vt!==5)return!1;var s=tr,r=qp;qp=0;var o=ei(yi),c=O.T,f=se.p;try{se.p=32>o?32:o,O.T=null,o=Fp,Fp=null;var y=tr,b=yi;if(Vt=0,wo=tr=null,yi=0,(We&6)!==0)throw Error(i(331));var E=We;if(We|=4,Yv(y.current),Fv(y,y.current,b,o),We=E,lc(0,!1),Kt&&typeof Kt.onPostCommitFiberRoot=="function")try{Kt.onPostCommitFiberRoot(ns,y)}catch{}return!0}finally{se.p=f,O.T=c,d_(s,r)}}function p_(s,r,o){r=Gn(o,r),r=Ep(s.stateNode,r,2),s=Yi(s,r,2),s!==null&&(Vr(s,2),Hs(s))}function Ze(s,r,o){if(s.tag===3)p_(s,s,o);else for(;r!==null;){if(r.tag===3){p_(r,s,o);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(er===null||!er.has(c))){s=Gn(o,s),o=gv(2),c=Yi(r,o,2),c!==null&&(mv(o,c,r,s),Vr(c,2),Hs(c));break}}r=r.return}}function Wp(s,r,o){var c=s.pingCache;if(c===null){c=s.pingCache=new cA;var f=new Set;c.set(r,f)}else f=c.get(r),f===void 0&&(f=new Set,c.set(r,f));f.has(o)||(zp=!0,f.add(o),s=pA.bind(null,s,r,o),r.then(s,s))}function pA(s,r,o){var c=s.pingCache;c!==null&&c.delete(r),s.pingedLanes|=s.suspendedLanes&o,s.warmLanes&=~o,it===s&&(Ue&o)===o&&(mt===4||mt===3&&(Ue&62914560)===Ue&&300>hn()-xh?(We&2)===0&&xo(s,0):Hp|=o,bo===Ue&&(bo=0)),Hs(s)}function g_(s,r){r===0&&(r=Eu()),s=Zr(s,r),s!==null&&(Vr(s,r),Hs(s))}function gA(s){var r=s.memoizedState,o=0;r!==null&&(o=r.retryLane),g_(s,o)}function mA(s,r){var o=0;switch(s.tag){case 31:case 13:var c=s.stateNode,f=s.memoizedState;f!==null&&(o=f.retryLane);break;case 19:c=s.stateNode;break;case 22:c=s.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(r),g_(s,o)}function yA(s,r){return Ut(s,r)}var Rh=null,Eo=null,Qp=!1,kh=!1,Jp=!1,sr=0;function Hs(s){s!==Eo&&s.next===null&&(Eo===null?Rh=Eo=s:Eo=Eo.next=s),kh=!0,Qp||(Qp=!0,_A())}function lc(s,r){if(!Jp&&kh){Jp=!0;do for(var o=!1,c=Rh;c!==null;){if(s!==0){var f=c.pendingLanes;if(f===0)var y=0;else{var b=c.suspendedLanes,E=c.pingedLanes;y=(1<<31-_t(42|s)+1)-1,y&=f&~(b&~E),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(o=!0,__(c,y))}else y=Ue,y=Es(c,c===it?y:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(y&3)===0||ss(c,y)||(o=!0,__(c,y));c=c.next}while(o);Jp=!1}}function vA(){m_()}function m_(){kh=Qp=!1;var s=0;sr!==0&&RA()&&(s=sr);for(var r=hn(),o=null,c=Rh;c!==null;){var f=c.next,y=y_(c,r);y===0?(c.next=null,o===null?Rh=f:o.next=f,f===null&&(Eo=o)):(o=c,(s!==0||(y&3)!==0)&&(kh=!0)),c=f}Vt!==0&&Vt!==5||lc(s),sr!==0&&(sr=0)}function y_(s,r){for(var o=s.suspendedLanes,c=s.pingedLanes,f=s.expirationTimes,y=s.pendingLanes&-62914561;0<y;){var b=31-_t(y),E=1<<b,P=f[b];P===-1?((E&o)===0||(E&c)!==0)&&(f[b]=Af(E,r)):P<=r&&(s.expiredLanes|=E),y&=~E}if(r=it,o=Ue,o=Es(s,s===r?o:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c=s.callbackNode,o===0||s===r&&(Xe===2||Xe===9)||s.cancelPendingCommit!==null)return c!==null&&c!==null&&Ii(c),s.callbackNode=null,s.callbackPriority=0;if((o&3)===0||ss(s,o)){if(r=o&-o,r===s.callbackPriority)return r;switch(c!==null&&Ii(c),ei(o)){case 2:case 8:o=vl;break;case 32:o=Oi;break;case 268435456:o=_u;break;default:o=Oi}return c=v_.bind(null,s),o=Ut(o,c),s.callbackPriority=r,s.callbackNode=o,r}return c!==null&&c!==null&&Ii(c),s.callbackPriority=2,s.callbackNode=null,2}function v_(s,r){if(Vt!==0&&Vt!==5)return s.callbackNode=null,s.callbackPriority=0,null;var o=s.callbackNode;if(Nh()&&s.callbackNode!==o)return null;var c=Ue;return c=Es(s,s===it?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c===0?null:(Zv(s,c,r),y_(s,hn()),s.callbackNode!=null&&s.callbackNode===o?v_.bind(null,s):null)}function __(s,r){if(Nh())return null;Zv(s,r,!0)}function _A(){IA(function(){(We&6)!==0?Ut(yl,vA):m_()})}function Xp(){if(sr===0){var s=lo;s===0&&(s=xs,xs<<=1,(xs&261888)===0&&(xs=256)),sr=s}return sr}function b_(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Ka(""+s)}function w_(s,r){var o=r.ownerDocument.createElement("input");return o.name=r.name,o.value=r.value,s.id&&o.setAttribute("form",s.id),r.parentNode.insertBefore(o,r),s=new FormData(s),o.parentNode.removeChild(o),s}function bA(s,r,o,c,f){if(r==="submit"&&o&&o.stateNode===f){var y=b_((f[$t]||null).action),b=c.submitter;b&&(r=(r=b[$t]||null)?b_(r.formAction):b.getAttribute("formAction"),r!==null&&(y=r,b=null));var E=new Ps("action","action",null,c,f);s.push({event:E,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(sr!==0){var P=b?w_(f,b):new FormData(f);vp(o,{pending:!0,data:P,method:f.method,action:y},null,P)}}else typeof y=="function"&&(E.preventDefault(),P=b?w_(f,b):new FormData(f),vp(o,{pending:!0,data:P,method:f.method,action:y},y,P))},currentTarget:f}]})}}for(var Zp=0;Zp<Pf.length;Zp++){var eg=Pf[Zp],wA=eg.toLowerCase(),xA=eg[0].toUpperCase()+eg.slice(1);hs(wA,"on"+xA)}hs(X0,"onAnimationEnd"),hs(Z0,"onAnimationIteration"),hs(ey,"onAnimationStart"),hs("dblclick","onDoubleClick"),hs("focusin","onFocus"),hs("focusout","onBlur"),hs(US,"onTransitionRun"),hs(VS,"onTransitionStart"),hs(BS,"onTransitionCancel"),hs(ty,"onTransitionEnd"),Is("onMouseEnter",["mouseout","mouseover"]),Is("onMouseLeave",["mouseout","mouseover"]),Is("onPointerEnter",["pointerout","pointerover"]),Is("onPointerLeave",["pointerout","pointerover"]),ks("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ks("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ks("onBeforeInput",["compositionend","keypress","textInput","paste"]),ks("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ks("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ks("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var cc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),TA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(cc));function x_(s,r){r=(r&4)!==0;for(var o=0;o<s.length;o++){var c=s[o],f=c.event;c=c.listeners;e:{var y=void 0;if(r)for(var b=c.length-1;0<=b;b--){var E=c[b],P=E.instance,Q=E.currentTarget;if(E=E.listener,P!==y&&f.isPropagationStopped())break e;y=E,f.currentTarget=Q;try{y(f)}catch(ie){Fu(ie)}f.currentTarget=null,y=P}else for(b=0;b<c.length;b++){if(E=c[b],P=E.instance,Q=E.currentTarget,E=E.listener,P!==y&&f.isPropagationStopped())break e;y=E,f.currentTarget=Q;try{y(f)}catch(ie){Fu(ie)}f.currentTarget=null,y=P}}}}function Le(s,r){var o=r[Ha];o===void 0&&(o=r[Ha]=new Set);var c=s+"__bubble";o.has(c)||(T_(r,s,2,!1),o.add(c))}function tg(s,r,o){var c=0;r&&(c|=4),T_(o,s,c,r)}var Ih="_reactListening"+Math.random().toString(36).slice(2);function ng(s){if(!s[Ih]){s[Ih]=!0,wl.forEach(function(o){o!=="selectionchange"&&(TA.has(o)||tg(o,!1,s),tg(o,!0,s))});var r=s.nodeType===9?s:s.ownerDocument;r===null||r[Ih]||(r[Ih]=!0,tg("selectionchange",!1,r))}}function T_(s,r,o,c){switch(X_(r)){case 2:var f=JA;break;case 8:f=XA;break;default:f=yg}o=f.bind(null,r,o,s),f=void 0,!Fr||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(f=!0),c?f!==void 0?s.addEventListener(r,o,{capture:!0,passive:f}):s.addEventListener(r,o,!0):f!==void 0?s.addEventListener(r,o,{passive:f}):s.addEventListener(r,o,!1)}function sg(s,r,o,c,f){var y=c;if((r&1)===0&&(r&2)===0&&c!==null)e:for(;;){if(c===null)return;var b=c.tag;if(b===3||b===4){var E=c.stateNode.containerInfo;if(E===f)break;if(b===4)for(b=c.return;b!==null;){var P=b.tag;if((P===3||P===4)&&b.stateNode.containerInfo===f)return;b=b.return}for(;E!==null;){if(b=Ns(E),b===null)return;if(P=b.tag,P===5||P===6||P===26||P===27){c=y=b;continue e}E=E.parentNode}}c=c.return}Ui(function(){var Q=y,ie=Hn(o),ae=[];e:{var X=ny.get(s);if(X!==void 0){var te=Ps,ge=s;switch(s){case"keypress":if(Kr(o)===0)break e;case"keydown":case"keyup":te=Hu;break;case"focusin":ge="focus",te=Wr;break;case"focusout":ge="blur",te=Wr;break;case"beforeblur":case"afterblur":te=Wr;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":te=Dl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":te=ju;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":te=v;break;case X0:case Z0:case ey:te=Pu;break;case ty:te=C;break;case"scroll":case"scrollend":te=jl;break;case"wheel":te=ee;break;case"copy":case"cut":case"paste":te=Mu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":te=si;break;case"toggle":case"beforetoggle":te=Oe}var xe=(r&4)!==0,st=!xe&&(s==="scroll"||s==="scrollend"),K=xe?X!==null?X+"Capture":null:X;xe=[];for(var z=Q,W;z!==null;){var re=z;if(W=re.stateNode,re=re.tag,re!==5&&re!==26&&re!==27||W===null||K===null||(re=os(z,K),re!=null&&xe.push(uc(z,re,W))),st)break;z=z.return}0<xe.length&&(X=new te(X,ge,null,o,ie),ae.push({event:X,listeners:xe}))}}if((r&7)===0){e:{if(X=s==="mouseover"||s==="pointerover",te=s==="mouseout"||s==="pointerout",X&&o!==kl&&(ge=o.relatedTarget||o.fromElement)&&(Ns(ge)||ge[As]))break e;if((te||X)&&(X=ie.window===ie?ie:(X=ie.ownerDocument)?X.defaultView||X.parentWindow:window,te?(ge=o.relatedTarget||o.toElement,te=Q,ge=ge?Ns(ge):null,ge!==null&&(st=l(ge),xe=ge.tag,ge!==st||xe!==5&&xe!==27&&xe!==6)&&(ge=null)):(te=null,ge=Q),te!==ge)){if(xe=Dl,re="onMouseLeave",K="onMouseEnter",z="mouse",(s==="pointerout"||s==="pointerover")&&(xe=si,re="onPointerLeave",K="onPointerEnter",z="pointer"),st=te==null?X:An(te),W=ge==null?X:An(ge),X=new xe(re,z+"leave",te,o,ie),X.target=st,X.relatedTarget=W,re=null,Ns(ie)===Q&&(xe=new xe(K,z+"enter",ge,o,ie),xe.target=W,xe.relatedTarget=st,re=xe),st=re,te&&ge)t:{for(xe=EA,K=te,z=ge,W=0,re=K;re;re=xe(re))W++;re=0;for(var be=z;be;be=xe(be))re++;for(;0<W-re;)K=xe(K),W--;for(;0<re-W;)z=xe(z),re--;for(;W--;){if(K===z||z!==null&&K===z.alternate){xe=K;break t}K=xe(K),z=xe(z)}xe=null}else xe=null;te!==null&&E_(ae,X,te,xe,!1),ge!==null&&st!==null&&E_(ae,st,ge,xe,!0)}}e:{if(X=Q?An(Q):window,te=X.nodeName&&X.nodeName.toLowerCase(),te==="select"||te==="input"&&X.type==="file")var Ge=z0;else if(V0(X))if(H0)Ge=PS;else{Ge=jS;var ve=OS}else te=X.nodeName,!te||te.toLowerCase()!=="input"||X.type!=="checkbox"&&X.type!=="radio"?Q&&Ga(Q.elementType)&&(Ge=z0):Ge=DS;if(Ge&&(Ge=Ge(s,Q))){B0(ae,Ge,o,ie);break e}ve&&ve(s,X,Q),s==="focusout"&&Q&&X.type==="number"&&Q.memoizedProps.value!=null&&Cl(X,"number",X.value)}switch(ve=Q?An(Q):window,s){case"focusin":(V0(ve)||ve.contentEditable==="true")&&(eo=ve,Of=Q,Vl=null);break;case"focusout":Vl=Of=eo=null;break;case"mousedown":jf=!0;break;case"contextmenu":case"mouseup":case"dragend":jf=!1,Q0(ae,o,ie);break;case"selectionchange":if(LS)break;case"keydown":case"keyup":Q0(ae,o,ie)}var De;if(Ye)e:{switch(s){case"compositionstart":var Ve="onCompositionStart";break e;case"compositionend":Ve="onCompositionEnd";break e;case"compositionupdate":Ve="onCompositionUpdate";break e}Ve=void 0}else Za?Qr(s,o)&&(Ve="onCompositionEnd"):s==="keydown"&&o.keyCode===229&&(Ve="onCompositionStart");Ve&&(Us&&o.locale!=="ko"&&(Za||Ve!=="onCompositionStart"?Ve==="onCompositionEnd"&&Za&&(De=Ol()):(Ds=ie,Il="value"in Ds?Ds.value:Ds.textContent,Za=!0)),ve=Oh(Q,Ve),0<ve.length&&(Ve=new Ls(Ve,s,null,o,ie),ae.push({event:Ve,listeners:ve}),De?Ve.data=De:(De=Xa(o),De!==null&&(Ve.data=De)))),(De=qn?NS(s,o):RS(s,o))&&(Ve=Oh(Q,"onBeforeInput"),0<Ve.length&&(ve=new Ls("onBeforeInput","beforeinput",null,o,ie),ae.push({event:ve,listeners:Ve}),ve.data=De)),bA(ae,s,Q,o,ie)}x_(ae,r)})}function uc(s,r,o){return{instance:s,listener:r,currentTarget:o}}function Oh(s,r){for(var o=r+"Capture",c=[];s!==null;){var f=s,y=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||y===null||(f=os(s,o),f!=null&&c.unshift(uc(s,f,y)),f=os(s,r),f!=null&&c.push(uc(s,f,y))),s.tag===3)return c;s=s.return}return[]}function EA(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function E_(s,r,o,c,f){for(var y=r._reactName,b=[];o!==null&&o!==c;){var E=o,P=E.alternate,Q=E.stateNode;if(E=E.tag,P!==null&&P===c)break;E!==5&&E!==26&&E!==27||Q===null||(P=Q,f?(Q=os(o,y),Q!=null&&b.unshift(uc(o,Q,P))):f||(Q=os(o,y),Q!=null&&b.push(uc(o,Q,P)))),o=o.return}b.length!==0&&s.push({event:r,listeners:b})}var SA=/\r\n?/g,AA=/\u0000|\uFFFD/g;function S_(s){return(typeof s=="string"?s:""+s).replace(SA,`
`).replace(AA,"")}function A_(s,r){return r=S_(r),S_(s)===r}function nt(s,r,o,c,f,y){switch(o){case"children":typeof c=="string"?r==="body"||r==="textarea"&&c===""||mn(s,c):(typeof c=="number"||typeof c=="bigint")&&r!=="body"&&mn(s,""+c);break;case"className":Cn(s,"class",c);break;case"tabIndex":Cn(s,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":Cn(s,o,c);break;case"style":Rl(s,c,y);break;case"data":if(r!=="object"){Cn(s,"data",c);break}case"src":case"href":if(c===""&&(r!=="a"||o!=="href")){s.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(o);break}c=Ka(""+c),s.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){s.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(o==="formAction"?(r!=="input"&&nt(s,r,"name",f.name,f,null),nt(s,r,"formEncType",f.formEncType,f,null),nt(s,r,"formMethod",f.formMethod,f,null),nt(s,r,"formTarget",f.formTarget,f,null)):(nt(s,r,"encType",f.encType,f,null),nt(s,r,"method",f.method,f,null),nt(s,r,"target",f.target,f,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(o);break}c=Ka(""+c),s.setAttribute(o,c);break;case"onClick":c!=null&&(s.onclick=as);break;case"onScroll":c!=null&&Le("scroll",s);break;case"onScrollEnd":c!=null&&Le("scrollend",s);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(f.children!=null)throw Error(i(60));s.innerHTML=o}}break;case"multiple":s.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":s.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){s.removeAttribute("xlink:href");break}o=Ka(""+c),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,""+c):s.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,""):s.removeAttribute(o);break;case"capture":case"download":c===!0?s.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,c):s.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?s.setAttribute(o,c):s.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?s.removeAttribute(o):s.setAttribute(o,c);break;case"popover":Le("beforetoggle",s),Le("toggle",s),qa(s,"popover",c);break;case"xlinkActuate":Rt(s,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Rt(s,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Rt(s,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Rt(s,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Rt(s,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Rt(s,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Rt(s,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Rt(s,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Rt(s,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":qa(s,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Ou.get(o)||o,qa(s,o,c))}}function ig(s,r,o,c,f,y){switch(o){case"style":Rl(s,c,y);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(f.children!=null)throw Error(i(60));s.innerHTML=o}}break;case"children":typeof c=="string"?mn(s,c):(typeof c=="number"||typeof c=="bigint")&&mn(s,""+c);break;case"onScroll":c!=null&&Le("scroll",s);break;case"onScrollEnd":c!=null&&Le("scrollend",s);break;case"onClick":c!=null&&(s.onclick=as);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!xl.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(f=o.endsWith("Capture"),r=o.slice(2,f?o.length-7:void 0),y=s[$t]||null,y=y!=null?y[o]:null,typeof y=="function"&&s.removeEventListener(r,y,f),typeof c=="function")){typeof y!="function"&&y!==null&&(o in s?s[o]=null:s.hasAttribute(o)&&s.removeAttribute(o)),s.addEventListener(r,c,f);break e}o in s?s[o]=c:c===!0?s.setAttribute(o,""):qa(s,o,c)}}}function Xt(s,r,o){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Le("error",s),Le("load",s);var c=!1,f=!1,y;for(y in o)if(o.hasOwnProperty(y)){var b=o[y];if(b!=null)switch(y){case"src":c=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:nt(s,r,y,b,o,null)}}f&&nt(s,r,"srcSet",o.srcSet,o,null),c&&nt(s,r,"src",o.src,o,null);return;case"input":Le("invalid",s);var E=y=b=f=null,P=null,Q=null;for(c in o)if(o.hasOwnProperty(c)){var ie=o[c];if(ie!=null)switch(c){case"name":f=ie;break;case"type":b=ie;break;case"checked":P=ie;break;case"defaultChecked":Q=ie;break;case"value":y=ie;break;case"defaultValue":E=ie;break;case"children":case"dangerouslySetInnerHTML":if(ie!=null)throw Error(i(137,r));break;default:nt(s,r,c,ie,o,null)}}Ru(s,y,E,P,Q,b,f,!1);return;case"select":Le("invalid",s),c=b=y=null;for(f in o)if(o.hasOwnProperty(f)&&(E=o[f],E!=null))switch(f){case"value":y=E;break;case"defaultValue":b=E;break;case"multiple":c=E;default:nt(s,r,f,E,o,null)}r=y,o=b,s.multiple=!!c,r!=null?Di(s,!!c,r,!1):o!=null&&Di(s,!!c,o,!0);return;case"textarea":Le("invalid",s),y=f=c=null;for(b in o)if(o.hasOwnProperty(b)&&(E=o[b],E!=null))switch(b){case"value":c=E;break;case"defaultValue":f=E;break;case"children":y=E;break;case"dangerouslySetInnerHTML":if(E!=null)throw Error(i(91));break;default:nt(s,r,b,E,o,null)}Pi(s,c,f,y);return;case"option":for(P in o)if(o.hasOwnProperty(P)&&(c=o[P],c!=null))switch(P){case"selected":s.selected=c&&typeof c!="function"&&typeof c!="symbol";break;default:nt(s,r,P,c,o,null)}return;case"dialog":Le("beforetoggle",s),Le("toggle",s),Le("cancel",s),Le("close",s);break;case"iframe":case"object":Le("load",s);break;case"video":case"audio":for(c=0;c<cc.length;c++)Le(cc[c],s);break;case"image":Le("error",s),Le("load",s);break;case"details":Le("toggle",s);break;case"embed":case"source":case"link":Le("error",s),Le("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Q in o)if(o.hasOwnProperty(Q)&&(c=o[Q],c!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:nt(s,r,Q,c,o,null)}return;default:if(Ga(r)){for(ie in o)o.hasOwnProperty(ie)&&(c=o[ie],c!==void 0&&ig(s,r,ie,c,o,void 0));return}}for(E in o)o.hasOwnProperty(E)&&(c=o[E],c!=null&&nt(s,r,E,c,o,null))}function CA(s,r,o,c){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,y=null,b=null,E=null,P=null,Q=null,ie=null;for(te in o){var ae=o[te];if(o.hasOwnProperty(te)&&ae!=null)switch(te){case"checked":break;case"value":break;case"defaultValue":P=ae;default:c.hasOwnProperty(te)||nt(s,r,te,null,c,ae)}}for(var X in c){var te=c[X];if(ae=o[X],c.hasOwnProperty(X)&&(te!=null||ae!=null))switch(X){case"type":y=te;break;case"name":f=te;break;case"checked":Q=te;break;case"defaultChecked":ie=te;break;case"value":b=te;break;case"defaultValue":E=te;break;case"children":case"dangerouslySetInnerHTML":if(te!=null)throw Error(i(137,r));break;default:te!==ae&&nt(s,r,X,te,c,ae)}}Fa(s,b,E,P,Q,ie,y,f);return;case"select":te=b=E=X=null;for(y in o)if(P=o[y],o.hasOwnProperty(y)&&P!=null)switch(y){case"value":break;case"multiple":te=P;default:c.hasOwnProperty(y)||nt(s,r,y,null,c,P)}for(f in c)if(y=c[f],P=o[f],c.hasOwnProperty(f)&&(y!=null||P!=null))switch(f){case"value":X=y;break;case"defaultValue":E=y;break;case"multiple":b=y;default:y!==P&&nt(s,r,f,y,c,P)}r=E,o=b,c=te,X!=null?Di(s,!!o,X,!1):!!c!=!!o&&(r!=null?Di(s,!!o,r,!0):Di(s,!!o,o?[]:"",!1));return;case"textarea":te=X=null;for(E in o)if(f=o[E],o.hasOwnProperty(E)&&f!=null&&!c.hasOwnProperty(E))switch(E){case"value":break;case"children":break;default:nt(s,r,E,null,c,f)}for(b in c)if(f=c[b],y=o[b],c.hasOwnProperty(b)&&(f!=null||y!=null))switch(b){case"value":X=f;break;case"defaultValue":te=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(i(91));break;default:f!==y&&nt(s,r,b,f,c,y)}ku(s,X,te);return;case"option":for(var ge in o)if(X=o[ge],o.hasOwnProperty(ge)&&X!=null&&!c.hasOwnProperty(ge))switch(ge){case"selected":s.selected=!1;break;default:nt(s,r,ge,null,c,X)}for(P in c)if(X=c[P],te=o[P],c.hasOwnProperty(P)&&X!==te&&(X!=null||te!=null))switch(P){case"selected":s.selected=X&&typeof X!="function"&&typeof X!="symbol";break;default:nt(s,r,P,X,c,te)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var xe in o)X=o[xe],o.hasOwnProperty(xe)&&X!=null&&!c.hasOwnProperty(xe)&&nt(s,r,xe,null,c,X);for(Q in c)if(X=c[Q],te=o[Q],c.hasOwnProperty(Q)&&X!==te&&(X!=null||te!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":if(X!=null)throw Error(i(137,r));break;default:nt(s,r,Q,X,c,te)}return;default:if(Ga(r)){for(var st in o)X=o[st],o.hasOwnProperty(st)&&X!==void 0&&!c.hasOwnProperty(st)&&ig(s,r,st,void 0,c,X);for(ie in c)X=c[ie],te=o[ie],!c.hasOwnProperty(ie)||X===te||X===void 0&&te===void 0||ig(s,r,ie,X,c,te);return}}for(var K in o)X=o[K],o.hasOwnProperty(K)&&X!=null&&!c.hasOwnProperty(K)&&nt(s,r,K,null,c,X);for(ae in c)X=c[ae],te=o[ae],!c.hasOwnProperty(ae)||X===te||X==null&&te==null||nt(s,r,ae,X,c,te)}function C_(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function NA(){if(typeof performance.getEntriesByType=="function"){for(var s=0,r=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var f=o[c],y=f.transferSize,b=f.initiatorType,E=f.duration;if(y&&E&&C_(b)){for(b=0,E=f.responseEnd,c+=1;c<o.length;c++){var P=o[c],Q=P.startTime;if(Q>E)break;var ie=P.transferSize,ae=P.initiatorType;ie&&C_(ae)&&(P=P.responseEnd,b+=ie*(P<E?1:(E-Q)/(P-Q)))}if(--c,r+=8*(y+b)/(f.duration/1e3),s++,10<s)break}}if(0<s)return r/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var rg=null,ag=null;function jh(s){return s.nodeType===9?s:s.ownerDocument}function N_(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function R_(s,r){if(s===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&r==="foreignObject"?0:s}function og(s,r){return s==="textarea"||s==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var lg=null;function RA(){var s=window.event;return s&&s.type==="popstate"?s===lg?!1:(lg=s,!0):(lg=null,!1)}var k_=typeof setTimeout=="function"?setTimeout:void 0,kA=typeof clearTimeout=="function"?clearTimeout:void 0,I_=typeof Promise=="function"?Promise:void 0,IA=typeof queueMicrotask=="function"?queueMicrotask:typeof I_<"u"?function(s){return I_.resolve(null).then(s).catch(OA)}:k_;function OA(s){setTimeout(function(){throw s})}function ir(s){return s==="head"}function O_(s,r){var o=r,c=0;do{var f=o.nextSibling;if(s.removeChild(o),f&&f.nodeType===8)if(o=f.data,o==="/$"||o==="/&"){if(c===0){s.removeChild(f),No(r);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")hc(s.ownerDocument.documentElement);else if(o==="head"){o=s.ownerDocument.head,hc(o);for(var y=o.firstChild;y;){var b=y.nextSibling,E=y.nodeName;y[Cs]||E==="SCRIPT"||E==="STYLE"||E==="LINK"&&y.rel.toLowerCase()==="stylesheet"||o.removeChild(y),y=b}}else o==="body"&&hc(s.ownerDocument.body);o=f}while(o);No(r)}function j_(s,r){var o=s;s=0;do{var c=o.nextSibling;if(o.nodeType===1?r?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(r?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(s===0)break;s--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||s++;o=c}while(o)}function cg(s){var r=s.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var o=r;switch(r=r.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":cg(o),$a(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}s.removeChild(o)}}function jA(s,r,o,c){for(;s.nodeType===1;){var f=o;if(s.nodeName.toLowerCase()!==r.toLowerCase()){if(!c&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(c){if(!s[Cs])switch(r){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(y=s.getAttribute("rel"),y==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(y!==f.rel||s.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||s.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||s.getAttribute("title")!==(f.title==null?null:f.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(y=s.getAttribute("src"),(y!==(f.src==null?null:f.src)||s.getAttribute("type")!==(f.type==null?null:f.type)||s.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&y&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(r==="input"&&s.type==="hidden"){var y=f.name==null?null:""+f.name;if(f.type==="hidden"&&s.getAttribute("name")===y)return s}else return s;if(s=Jn(s.nextSibling),s===null)break}return null}function DA(s,r,o){if(r==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!o||(s=Jn(s.nextSibling),s===null))return null;return s}function D_(s,r){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!r||(s=Jn(s.nextSibling),s===null))return null;return s}function ug(s){return s.data==="$?"||s.data==="$~"}function hg(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function PA(s,r){var o=s.ownerDocument;if(s.data==="$~")s._reactRetry=r;else if(s.data!=="$?"||o.readyState!=="loading")r();else{var c=function(){r(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),s._reactRetry=c}}function Jn(s){for(;s!=null;s=s.nextSibling){var r=s.nodeType;if(r===1||r===3)break;if(r===8){if(r=s.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return s}var dg=null;function P_(s){s=s.nextSibling;for(var r=0;s;){if(s.nodeType===8){var o=s.data;if(o==="/$"||o==="/&"){if(r===0)return Jn(s.nextSibling);r--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||r++}s=s.nextSibling}return null}function M_(s){s=s.previousSibling;for(var r=0;s;){if(s.nodeType===8){var o=s.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(r===0)return s;r--}else o!=="/$"&&o!=="/&"||r++}s=s.previousSibling}return null}function L_(s,r,o){switch(r=jh(o),s){case"html":if(s=r.documentElement,!s)throw Error(i(452));return s;case"head":if(s=r.head,!s)throw Error(i(453));return s;case"body":if(s=r.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function hc(s){for(var r=s.attributes;r.length;)s.removeAttributeNode(r[0]);$a(s)}var Xn=new Map,U_=new Set;function Dh(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var vi=se.d;se.d={f:MA,r:LA,D:UA,C:VA,L:BA,m:zA,X:$A,S:HA,M:qA};function MA(){var s=vi.f(),r=Sh();return s||r}function LA(s){var r=zn(s);r!==null&&r.tag===5&&r.type==="form"?tv(r):vi.r(s)}var So=typeof document>"u"?null:document;function V_(s,r,o){var c=So;if(c&&typeof r=="string"&&r){var f=gn(r);f='link[rel="'+s+'"][href="'+f+'"]',typeof o=="string"&&(f+='[crossorigin="'+o+'"]'),U_.has(f)||(U_.add(f),s={rel:s,crossOrigin:o,href:r},c.querySelector(f)===null&&(r=c.createElement("link"),Xt(r,"link",s),Nt(r),c.head.appendChild(r)))}}function UA(s){vi.D(s),V_("dns-prefetch",s,null)}function VA(s,r){vi.C(s,r),V_("preconnect",s,r)}function BA(s,r,o){vi.L(s,r,o);var c=So;if(c&&s&&r){var f='link[rel="preload"][as="'+gn(r)+'"]';r==="image"&&o&&o.imageSrcSet?(f+='[imagesrcset="'+gn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(f+='[imagesizes="'+gn(o.imageSizes)+'"]')):f+='[href="'+gn(s)+'"]';var y=f;switch(r){case"style":y=Ao(s);break;case"script":y=Co(s)}Xn.has(y)||(s=w({rel:"preload",href:r==="image"&&o&&o.imageSrcSet?void 0:s,as:r},o),Xn.set(y,s),c.querySelector(f)!==null||r==="style"&&c.querySelector(dc(y))||r==="script"&&c.querySelector(fc(y))||(r=c.createElement("link"),Xt(r,"link",s),Nt(r),c.head.appendChild(r)))}}function zA(s,r){vi.m(s,r);var o=So;if(o&&s){var c=r&&typeof r.as=="string"?r.as:"script",f='link[rel="modulepreload"][as="'+gn(c)+'"][href="'+gn(s)+'"]',y=f;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=Co(s)}if(!Xn.has(y)&&(s=w({rel:"modulepreload",href:s},r),Xn.set(y,s),o.querySelector(f)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(fc(y)))return}c=o.createElement("link"),Xt(c,"link",s),Nt(c),o.head.appendChild(c)}}}function HA(s,r,o){vi.S(s,r,o);var c=So;if(c&&s){var f=Rs(c).hoistableStyles,y=Ao(s);r=r||"default";var b=f.get(y);if(!b){var E={loading:0,preload:null};if(b=c.querySelector(dc(y)))E.loading=5;else{s=w({rel:"stylesheet",href:s,"data-precedence":r},o),(o=Xn.get(y))&&fg(s,o);var P=b=c.createElement("link");Nt(P),Xt(P,"link",s),P._p=new Promise(function(Q,ie){P.onload=Q,P.onerror=ie}),P.addEventListener("load",function(){E.loading|=1}),P.addEventListener("error",function(){E.loading|=2}),E.loading|=4,Ph(b,r,c)}b={type:"stylesheet",instance:b,count:1,state:E},f.set(y,b)}}}function $A(s,r){vi.X(s,r);var o=So;if(o&&s){var c=Rs(o).hoistableScripts,f=Co(s),y=c.get(f);y||(y=o.querySelector(fc(f)),y||(s=w({src:s,async:!0},r),(r=Xn.get(f))&&pg(s,r),y=o.createElement("script"),Nt(y),Xt(y,"link",s),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},c.set(f,y))}}function qA(s,r){vi.M(s,r);var o=So;if(o&&s){var c=Rs(o).hoistableScripts,f=Co(s),y=c.get(f);y||(y=o.querySelector(fc(f)),y||(s=w({src:s,async:!0,type:"module"},r),(r=Xn.get(f))&&pg(s,r),y=o.createElement("script"),Nt(y),Xt(y,"link",s),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},c.set(f,y))}}function B_(s,r,o,c){var f=(f=Ne.current)?Dh(f):null;if(!f)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(r=Ao(o.href),o=Rs(f).hoistableStyles,c=o.get(r),c||(c={type:"style",instance:null,count:0,state:null},o.set(r,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){s=Ao(o.href);var y=Rs(f).hoistableStyles,b=y.get(s);if(b||(f=f.ownerDocument||f,b={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(s,b),(y=f.querySelector(dc(s)))&&!y._p&&(b.instance=y,b.state.loading=5),Xn.has(s)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},Xn.set(s,o),y||FA(f,s,o,b.state))),r&&c===null)throw Error(i(528,""));return b}if(r&&c!==null)throw Error(i(529,""));return null;case"script":return r=o.async,o=o.src,typeof o=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=Co(o),o=Rs(f).hoistableScripts,c=o.get(r),c||(c={type:"script",instance:null,count:0,state:null},o.set(r,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function Ao(s){return'href="'+gn(s)+'"'}function dc(s){return'link[rel="stylesheet"]['+s+"]"}function z_(s){return w({},s,{"data-precedence":s.precedence,precedence:null})}function FA(s,r,o,c){s.querySelector('link[rel="preload"][as="style"]['+r+"]")?c.loading=1:(r=s.createElement("link"),c.preload=r,r.addEventListener("load",function(){return c.loading|=1}),r.addEventListener("error",function(){return c.loading|=2}),Xt(r,"link",o),Nt(r),s.head.appendChild(r))}function Co(s){return'[src="'+gn(s)+'"]'}function fc(s){return"script[async]"+s}function H_(s,r,o){if(r.count++,r.instance===null)switch(r.type){case"style":var c=s.querySelector('style[data-href~="'+gn(o.href)+'"]');if(c)return r.instance=c,Nt(c),c;var f=w({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(s.ownerDocument||s).createElement("style"),Nt(c),Xt(c,"style",f),Ph(c,o.precedence,s),r.instance=c;case"stylesheet":f=Ao(o.href);var y=s.querySelector(dc(f));if(y)return r.state.loading|=4,r.instance=y,Nt(y),y;c=z_(o),(f=Xn.get(f))&&fg(c,f),y=(s.ownerDocument||s).createElement("link"),Nt(y);var b=y;return b._p=new Promise(function(E,P){b.onload=E,b.onerror=P}),Xt(y,"link",c),r.state.loading|=4,Ph(y,o.precedence,s),r.instance=y;case"script":return y=Co(o.src),(f=s.querySelector(fc(y)))?(r.instance=f,Nt(f),f):(c=o,(f=Xn.get(y))&&(c=w({},o),pg(c,f)),s=s.ownerDocument||s,f=s.createElement("script"),Nt(f),Xt(f,"link",c),s.head.appendChild(f),r.instance=f);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(c=r.instance,r.state.loading|=4,Ph(c,o.precedence,s));return r.instance}function Ph(s,r,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=c.length?c[c.length-1]:null,y=f,b=0;b<c.length;b++){var E=c[b];if(E.dataset.precedence===r)y=E;else if(y!==f)break}y?y.parentNode.insertBefore(s,y.nextSibling):(r=o.nodeType===9?o.head:o,r.insertBefore(s,r.firstChild))}function fg(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.title==null&&(s.title=r.title)}function pg(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.integrity==null&&(s.integrity=r.integrity)}var Mh=null;function $_(s,r,o){if(Mh===null){var c=new Map,f=Mh=new Map;f.set(o,c)}else f=Mh,c=f.get(o),c||(c=new Map,f.set(o,c));if(c.has(s))return c;for(c.set(s,null),o=o.getElementsByTagName(s),f=0;f<o.length;f++){var y=o[f];if(!(y[Cs]||y[Ct]||s==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var b=y.getAttribute(r)||"";b=s+b;var E=c.get(b);E?E.push(y):c.set(b,[y])}}return c}function q_(s,r,o){s=s.ownerDocument||s,s.head.insertBefore(o,r==="title"?s.querySelector("head > title"):null)}function GA(s,r,o){if(o===1||r.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;switch(r.rel){case"stylesheet":return s=r.disabled,typeof r.precedence=="string"&&s==null;default:return!0}case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function F_(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function KA(s,r,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var f=Ao(c.href),y=r.querySelector(dc(f));if(y){r=y._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(s.count++,s=Lh.bind(s),r.then(s,s)),o.state.loading|=4,o.instance=y,Nt(y);return}y=r.ownerDocument||r,c=z_(c),(f=Xn.get(f))&&fg(c,f),y=y.createElement("link"),Nt(y);var b=y;b._p=new Promise(function(E,P){b.onload=E,b.onerror=P}),Xt(y,"link",c),o.instance=y}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(o,r),(r=o.state.preload)&&(o.state.loading&3)===0&&(s.count++,o=Lh.bind(s),r.addEventListener("load",o),r.addEventListener("error",o))}}var gg=0;function YA(s,r){return s.stylesheets&&s.count===0&&Vh(s,s.stylesheets),0<s.count||0<s.imgCount?function(o){var c=setTimeout(function(){if(s.stylesheets&&Vh(s,s.stylesheets),s.unsuspend){var y=s.unsuspend;s.unsuspend=null,y()}},6e4+r);0<s.imgBytes&&gg===0&&(gg=62500*NA());var f=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&Vh(s,s.stylesheets),s.unsuspend)){var y=s.unsuspend;s.unsuspend=null,y()}},(s.imgBytes>gg?50:800)+r);return s.unsuspend=o,function(){s.unsuspend=null,clearTimeout(c),clearTimeout(f)}}:null}function Lh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Vh(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Uh=null;function Vh(s,r){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Uh=new Map,r.forEach(WA,s),Uh=null,Lh.call(s))}function WA(s,r){if(!(r.state.loading&4)){var o=Uh.get(s);if(o)var c=o.get(null);else{o=new Map,Uh.set(s,o);for(var f=s.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<f.length;y++){var b=f[y];(b.nodeName==="LINK"||b.getAttribute("media")!=="not all")&&(o.set(b.dataset.precedence,b),c=b)}c&&o.set(null,c)}f=r.instance,b=f.getAttribute("data-precedence"),y=o.get(b)||c,y===c&&o.set(null,f),o.set(b,f),this.count++,c=Lh.bind(this),f.addEventListener("load",c),f.addEventListener("error",c),y?y.parentNode.insertBefore(f,y.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(f,s.firstChild)),r.state.loading|=4}}var pc={$$typeof:$,Provider:null,Consumer:null,_currentValue:de,_currentValue2:de,_threadCount:0};function QA(s,r,o,c,f,y,b,E,P){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ss(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ss(0),this.hiddenUpdates=Ss(null),this.identifierPrefix=c,this.onUncaughtError=f,this.onCaughtError=y,this.onRecoverableError=b,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=P,this.incompleteTransitions=new Map}function G_(s,r,o,c,f,y,b,E,P,Q,ie,ae){return s=new QA(s,r,o,b,P,Q,ie,ae,E),r=1,y===!0&&(r|=24),y=Rn(3,null,null,r),s.current=y,y.stateNode=s,r=Yf(),r.refCount++,s.pooledCache=r,r.refCount++,y.memoizedState={element:c,isDehydrated:o,cache:r},Xf(y),s}function K_(s){return s?(s=so,s):so}function Y_(s,r,o,c,f,y){f=K_(f),c.context===null?c.context=f:c.pendingContext=f,c=Ki(r),c.payload={element:o},y=y===void 0?null:y,y!==null&&(c.callback=y),o=Yi(s,c,r),o!==null&&(wn(o,s,r),Gl(o,s,r))}function W_(s,r){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var o=s.retryLane;s.retryLane=o!==0&&o<r?o:r}}function mg(s,r){W_(s,r),(s=s.alternate)&&W_(s,r)}function Q_(s){if(s.tag===13||s.tag===31){var r=Zr(s,67108864);r!==null&&wn(r,s,67108864),mg(s,67108864)}}function J_(s){if(s.tag===13||s.tag===31){var r=Dn();r=zr(r);var o=Zr(s,r);o!==null&&wn(o,s,r),mg(s,r)}}var Bh=!0;function JA(s,r,o,c){var f=O.T;O.T=null;var y=se.p;try{se.p=2,yg(s,r,o,c)}finally{se.p=y,O.T=f}}function XA(s,r,o,c){var f=O.T;O.T=null;var y=se.p;try{se.p=8,yg(s,r,o,c)}finally{se.p=y,O.T=f}}function yg(s,r,o,c){if(Bh){var f=vg(c);if(f===null)sg(s,r,c,zh,o),Z_(s,c);else if(e2(f,s,r,o,c))c.stopPropagation();else if(Z_(s,c),r&4&&-1<ZA.indexOf(s)){for(;f!==null;){var y=zn(f);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var b=Ts(y.pendingLanes);if(b!==0){var E=y;for(E.pendingLanes|=2,E.entangledLanes|=2;b;){var P=1<<31-_t(b);E.entanglements[1]|=P,b&=~P}Hs(y),(We&6)===0&&(Th=hn()+500,lc(0))}}break;case 31:case 13:E=Zr(y,2),E!==null&&wn(E,y,2),Sh(),mg(y,2)}if(y=vg(c),y===null&&sg(s,r,c,zh,o),y===f)break;f=y}f!==null&&c.stopPropagation()}else sg(s,r,c,null,o)}}function vg(s){return s=Hn(s),_g(s)}var zh=null;function _g(s){if(zh=null,s=Ns(s),s!==null){var r=l(s);if(r===null)s=null;else{var o=r.tag;if(o===13){if(s=u(r),s!==null)return s;s=null}else if(o===31){if(s=d(r),s!==null)return s;s=null}else if(o===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;s=null}else r!==s&&(s=null)}}return zh=s,null}function X_(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Lr()){case yl:return 2;case vl:return 8;case Oi:case Sf:return 32;case _u:return 268435456;default:return 32}default:return 32}}var bg=!1,rr=null,ar=null,or=null,gc=new Map,mc=new Map,lr=[],ZA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Z_(s,r){switch(s){case"focusin":case"focusout":rr=null;break;case"dragenter":case"dragleave":ar=null;break;case"mouseover":case"mouseout":or=null;break;case"pointerover":case"pointerout":gc.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":mc.delete(r.pointerId)}}function yc(s,r,o,c,f,y){return s===null||s.nativeEvent!==y?(s={blockedOn:r,domEventName:o,eventSystemFlags:c,nativeEvent:y,targetContainers:[f]},r!==null&&(r=zn(r),r!==null&&Q_(r)),s):(s.eventSystemFlags|=c,r=s.targetContainers,f!==null&&r.indexOf(f)===-1&&r.push(f),s)}function e2(s,r,o,c,f){switch(r){case"focusin":return rr=yc(rr,s,r,o,c,f),!0;case"dragenter":return ar=yc(ar,s,r,o,c,f),!0;case"mouseover":return or=yc(or,s,r,o,c,f),!0;case"pointerover":var y=f.pointerId;return gc.set(y,yc(gc.get(y)||null,s,r,o,c,f)),!0;case"gotpointercapture":return y=f.pointerId,mc.set(y,yc(mc.get(y)||null,s,r,o,c,f)),!0}return!1}function eb(s){var r=Ns(s.target);if(r!==null){var o=l(r);if(o!==null){if(r=o.tag,r===13){if(r=u(o),r!==null){s.blockedOn=r,is(s.priority,function(){J_(o)});return}}else if(r===31){if(r=d(o),r!==null){s.blockedOn=r,is(s.priority,function(){J_(o)});return}}else if(r===3&&o.stateNode.current.memoizedState.isDehydrated){s.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Hh(s){if(s.blockedOn!==null)return!1;for(var r=s.targetContainers;0<r.length;){var o=vg(s.nativeEvent);if(o===null){o=s.nativeEvent;var c=new o.constructor(o.type,o);kl=c,o.target.dispatchEvent(c),kl=null}else return r=zn(o),r!==null&&Q_(r),s.blockedOn=o,!1;r.shift()}return!0}function tb(s,r,o){Hh(s)&&o.delete(r)}function t2(){bg=!1,rr!==null&&Hh(rr)&&(rr=null),ar!==null&&Hh(ar)&&(ar=null),or!==null&&Hh(or)&&(or=null),gc.forEach(tb),mc.forEach(tb)}function $h(s,r){s.blockedOn===r&&(s.blockedOn=null,bg||(bg=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,t2)))}var qh=null;function nb(s){qh!==s&&(qh=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){qh===s&&(qh=null);for(var r=0;r<s.length;r+=3){var o=s[r],c=s[r+1],f=s[r+2];if(typeof c!="function"){if(_g(c||o)===null)continue;break}var y=zn(o);y!==null&&(s.splice(r,3),r-=3,vp(y,{pending:!0,data:f,method:o.method,action:c},c,f))}}))}function No(s){function r(P){return $h(P,s)}rr!==null&&$h(rr,s),ar!==null&&$h(ar,s),or!==null&&$h(or,s),gc.forEach(r),mc.forEach(r);for(var o=0;o<lr.length;o++){var c=lr[o];c.blockedOn===s&&(c.blockedOn=null)}for(;0<lr.length&&(o=lr[0],o.blockedOn===null);)eb(o),o.blockedOn===null&&lr.shift();if(o=(s.ownerDocument||s).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var f=o[c],y=o[c+1],b=f[$t]||null;if(typeof y=="function")b||nb(o);else if(b){var E=null;if(y&&y.hasAttribute("formAction")){if(f=y,b=y[$t]||null)E=b.formAction;else if(_g(f)!==null)continue}else E=b.action;typeof E=="function"?o[c+1]=E:(o.splice(c,3),c-=3),nb(o)}}}function sb(){function s(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(b){return f=b})},focusReset:"manual",scroll:"manual"})}function r(){f!==null&&(f(),f=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,f=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),f!==null&&(f(),f=null)}}}function wg(s){this._internalRoot=s}Fh.prototype.render=wg.prototype.render=function(s){var r=this._internalRoot;if(r===null)throw Error(i(409));var o=r.current,c=Dn();Y_(o,c,s,r,null,null)},Fh.prototype.unmount=wg.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var r=s.containerInfo;Y_(s.current,2,null,s,null,null),Sh(),r[As]=null}};function Fh(s){this._internalRoot=s}Fh.prototype.unstable_scheduleHydration=function(s){if(s){var r=Su();s={blockedOn:null,target:s,priority:r};for(var o=0;o<lr.length&&r!==0&&r<lr[o].priority;o++);lr.splice(o,0,s),o===0&&eb(s)}};var ib=e.version;if(ib!=="19.2.3")throw Error(i(527,ib,"19.2.3"));se.findDOMNode=function(s){var r=s._reactInternals;if(r===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=m(r),s=s!==null?_(s):null,s=s===null?null:s.stateNode,s};var n2={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:O,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Gh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Gh.isDisabled&&Gh.supportsFiber)try{ns=Gh.inject(n2),Kt=Gh}catch{}}return _c.createRoot=function(s,r){if(!a(s))throw Error(i(299));var o=!1,c="",f=hv,y=dv,b=fv;return r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onUncaughtError!==void 0&&(f=r.onUncaughtError),r.onCaughtError!==void 0&&(y=r.onCaughtError),r.onRecoverableError!==void 0&&(b=r.onRecoverableError)),r=G_(s,1,!1,null,null,o,c,null,f,y,b,sb),s[As]=r.current,ng(s),new wg(r)},_c.hydrateRoot=function(s,r,o){if(!a(s))throw Error(i(299));var c=!1,f="",y=hv,b=dv,E=fv,P=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(y=o.onUncaughtError),o.onCaughtError!==void 0&&(b=o.onCaughtError),o.onRecoverableError!==void 0&&(E=o.onRecoverableError),o.formState!==void 0&&(P=o.formState)),r=G_(s,1,!0,r,o??null,c,f,P,y,b,E,sb),r.context=K_(null),o=r.current,c=Dn(),c=zr(c),f=Ki(c),f.callback=null,Yi(o,f,c),o=c,r.current.lanes=o,Vr(r,o),Hs(r),s[As]=r.current,ng(s),new Fh(r)},_c.version="19.2.3",_c}var pb;function d2(){if(pb)return Eg.exports;pb=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Eg.exports=h2(),Eg.exports}var f2=d2();const p2=Wx(f2);var $s;(function(n){n.STRING="string",n.NUMBER="number",n.INTEGER="integer",n.BOOLEAN="boolean",n.ARRAY="array",n.OBJECT="object"})($s||($s={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gb;(function(n){n.LANGUAGE_UNSPECIFIED="language_unspecified",n.PYTHON="python"})(gb||(gb={}));var mb;(function(n){n.OUTCOME_UNSPECIFIED="outcome_unspecified",n.OUTCOME_OK="outcome_ok",n.OUTCOME_FAILED="outcome_failed",n.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"})(mb||(mb={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yb=["user","model","function","system"];var vb;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(vb||(vb={}));var _b;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(_b||(_b={}));var bb;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(bb||(bb={}));var wb;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER"})(wb||(wb={}));var kc;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.OTHER="OTHER"})(kc||(kc={}));var xb;(function(n){n.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",n.RETRIEVAL_QUERY="RETRIEVAL_QUERY",n.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",n.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",n.CLASSIFICATION="CLASSIFICATION",n.CLUSTERING="CLUSTERING"})(xb||(xb={}));var Tb;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE"})(Tb||(Tb={}));var Eb;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(Eb||(Eb={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cn extends Error{constructor(e){super(`[GoogleGenerativeAI Error]: ${e}`)}}class Ro extends cn{constructor(e,t){super(e),this.response=t}}class Qx extends cn{constructor(e,t,i,a){super(e),this.status=t,this.statusText=i,this.errorDetails=a}}class _r extends cn{}class Jx extends cn{}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g2="https://generativelanguage.googleapis.com",m2="v1beta",y2="0.24.1",v2="genai-js";var Ea;(function(n){n.GENERATE_CONTENT="generateContent",n.STREAM_GENERATE_CONTENT="streamGenerateContent",n.COUNT_TOKENS="countTokens",n.EMBED_CONTENT="embedContent",n.BATCH_EMBED_CONTENTS="batchEmbedContents"})(Ea||(Ea={}));class _2{constructor(e,t,i,a,l){this.model=e,this.task=t,this.apiKey=i,this.stream=a,this.requestOptions=l}toString(){var e,t;const i=((e=this.requestOptions)===null||e===void 0?void 0:e.apiVersion)||m2;let l=`${((t=this.requestOptions)===null||t===void 0?void 0:t.baseUrl)||g2}/${i}/${this.model}:${this.task}`;return this.stream&&(l+="?alt=sse"),l}}function b2(n){const e=[];return n!=null&&n.apiClient&&e.push(n.apiClient),e.push(`${v2}/${y2}`),e.join(" ")}async function w2(n){var e;const t=new Headers;t.append("Content-Type","application/json"),t.append("x-goog-api-client",b2(n.requestOptions)),t.append("x-goog-api-key",n.apiKey);let i=(e=n.requestOptions)===null||e===void 0?void 0:e.customHeaders;if(i){if(!(i instanceof Headers))try{i=new Headers(i)}catch(a){throw new _r(`unable to convert customHeaders value ${JSON.stringify(i)} to Headers: ${a.message}`)}for(const[a,l]of i.entries()){if(a==="x-goog-api-key")throw new _r(`Cannot set reserved header name ${a}`);if(a==="x-goog-api-client")throw new _r(`Header name ${a} can only be set using the apiClient field`);t.append(a,l)}}return t}async function x2(n,e,t,i,a,l){const u=new _2(n,e,t,i,l);return{url:u.toString(),fetchOptions:Object.assign(Object.assign({},A2(l)),{method:"POST",headers:await w2(u),body:a})}}async function iu(n,e,t,i,a,l={},u=fetch){const{url:d,fetchOptions:g}=await x2(n,e,t,i,a,l);return T2(d,g,u)}async function T2(n,e,t=fetch){let i;try{i=await t(n,e)}catch(a){E2(a,n)}return i.ok||await S2(i,n),i}function E2(n,e){let t=n;throw t.name==="AbortError"?(t=new Jx(`Request aborted when fetching ${e.toString()}: ${n.message}`),t.stack=n.stack):n instanceof Qx||n instanceof _r||(t=new cn(`Error fetching from ${e.toString()}: ${n.message}`),t.stack=n.stack),t}async function S2(n,e){let t="",i;try{const a=await n.json();t=a.error.message,a.error.details&&(t+=` ${JSON.stringify(a.error.details)}`,i=a.error.details)}catch{}throw new Qx(`Error fetching from ${e.toString()}: [${n.status} ${n.statusText}] ${t}`,n.status,n.statusText,i)}function A2(n){const e={};if((n==null?void 0:n.signal)!==void 0||(n==null?void 0:n.timeout)>=0){const t=new AbortController;(n==null?void 0:n.timeout)>=0&&setTimeout(()=>t.abort(),n.timeout),n!=null&&n.signal&&n.signal.addEventListener("abort",()=>{t.abort()}),e.signal=t.signal}return e}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hm(n){return n.text=()=>{if(n.candidates&&n.candidates.length>0){if(n.candidates.length>1&&console.warn(`This response had ${n.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),od(n.candidates[0]))throw new Ro(`${hr(n)}`,n);return C2(n)}else if(n.promptFeedback)throw new Ro(`Text not available. ${hr(n)}`,n);return""},n.functionCall=()=>{if(n.candidates&&n.candidates.length>0){if(n.candidates.length>1&&console.warn(`This response had ${n.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),od(n.candidates[0]))throw new Ro(`${hr(n)}`,n);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),Sb(n)[0]}else if(n.promptFeedback)throw new Ro(`Function call not available. ${hr(n)}`,n)},n.functionCalls=()=>{if(n.candidates&&n.candidates.length>0){if(n.candidates.length>1&&console.warn(`This response had ${n.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),od(n.candidates[0]))throw new Ro(`${hr(n)}`,n);return Sb(n)}else if(n.promptFeedback)throw new Ro(`Function call not available. ${hr(n)}`,n)},n}function C2(n){var e,t,i,a;const l=[];if(!((t=(e=n.candidates)===null||e===void 0?void 0:e[0].content)===null||t===void 0)&&t.parts)for(const u of(a=(i=n.candidates)===null||i===void 0?void 0:i[0].content)===null||a===void 0?void 0:a.parts)u.text&&l.push(u.text),u.executableCode&&l.push("\n```"+u.executableCode.language+`
`+u.executableCode.code+"\n```\n"),u.codeExecutionResult&&l.push("\n```\n"+u.codeExecutionResult.output+"\n```\n");return l.length>0?l.join(""):""}function Sb(n){var e,t,i,a;const l=[];if(!((t=(e=n.candidates)===null||e===void 0?void 0:e[0].content)===null||t===void 0)&&t.parts)for(const u of(a=(i=n.candidates)===null||i===void 0?void 0:i[0].content)===null||a===void 0?void 0:a.parts)u.functionCall&&l.push(u.functionCall);if(l.length>0)return l}const N2=[kc.RECITATION,kc.SAFETY,kc.LANGUAGE];function od(n){return!!n.finishReason&&N2.includes(n.finishReason)}function hr(n){var e,t,i;let a="";if((!n.candidates||n.candidates.length===0)&&n.promptFeedback)a+="Response was blocked",!((e=n.promptFeedback)===null||e===void 0)&&e.blockReason&&(a+=` due to ${n.promptFeedback.blockReason}`),!((t=n.promptFeedback)===null||t===void 0)&&t.blockReasonMessage&&(a+=`: ${n.promptFeedback.blockReasonMessage}`);else if(!((i=n.candidates)===null||i===void 0)&&i[0]){const l=n.candidates[0];od(l)&&(a+=`Candidate was blocked due to ${l.finishReason}`,l.finishMessage&&(a+=`: ${l.finishMessage}`))}return a}function zc(n){return this instanceof zc?(this.v=n,this):new zc(n)}function R2(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),a,l=[];return a={},u("next"),u("throw"),u("return"),a[Symbol.asyncIterator]=function(){return this},a;function u(T){i[T]&&(a[T]=function(S){return new Promise(function(N,M){l.push([T,S,N,M])>1||d(T,S)})})}function d(T,S){try{g(i[T](S))}catch(N){w(l[0][3],N)}}function g(T){T.value instanceof zc?Promise.resolve(T.value.v).then(m,_):w(l[0][2],T)}function m(T){d("next",T)}function _(T){d("throw",T)}function w(T,S){T(S),l.shift(),l.length&&d(l[0][0],l[0][1])}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ab=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function k2(n){const e=n.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),t=j2(e),[i,a]=t.tee();return{stream:O2(i),response:I2(a)}}async function I2(n){const e=[],t=n.getReader();for(;;){const{done:i,value:a}=await t.read();if(i)return Hm(D2(e));e.push(a)}}function O2(n){return R2(this,arguments,function*(){const t=n.getReader();for(;;){const{value:i,done:a}=yield zc(t.read());if(a)break;yield yield zc(Hm(i))}})}function j2(n){const e=n.getReader();return new ReadableStream({start(i){let a="";return l();function l(){return e.read().then(({value:u,done:d})=>{if(d){if(a.trim()){i.error(new cn("Failed to parse stream"));return}i.close();return}a+=u;let g=a.match(Ab),m;for(;g;){try{m=JSON.parse(g[1])}catch{i.error(new cn(`Error parsing JSON response: "${g[1]}"`));return}i.enqueue(m),a=a.substring(g[0].length),g=a.match(Ab)}return l()}).catch(u=>{let d=u;throw d.stack=u.stack,d.name==="AbortError"?d=new Jx("Request aborted when reading from the stream"):d=new cn("Error reading from the stream"),d})}}})}function D2(n){const e=n[n.length-1],t={promptFeedback:e==null?void 0:e.promptFeedback};for(const i of n){if(i.candidates){let a=0;for(const l of i.candidates)if(t.candidates||(t.candidates=[]),t.candidates[a]||(t.candidates[a]={index:a}),t.candidates[a].citationMetadata=l.citationMetadata,t.candidates[a].groundingMetadata=l.groundingMetadata,t.candidates[a].finishReason=l.finishReason,t.candidates[a].finishMessage=l.finishMessage,t.candidates[a].safetyRatings=l.safetyRatings,l.content&&l.content.parts){t.candidates[a].content||(t.candidates[a].content={role:l.content.role||"user",parts:[]});const u={};for(const d of l.content.parts)d.text&&(u.text=d.text),d.functionCall&&(u.functionCall=d.functionCall),d.executableCode&&(u.executableCode=d.executableCode),d.codeExecutionResult&&(u.codeExecutionResult=d.codeExecutionResult),Object.keys(u).length===0&&(u.text=""),t.candidates[a].content.parts.push(u)}a++}i.usageMetadata&&(t.usageMetadata=i.usageMetadata)}return t}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xx(n,e,t,i){const a=await iu(e,Ea.STREAM_GENERATE_CONTENT,n,!0,JSON.stringify(t),i);return k2(a)}async function Zx(n,e,t,i){const l=await(await iu(e,Ea.GENERATE_CONTENT,n,!1,JSON.stringify(t),i)).json();return{response:Hm(l)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eT(n){if(n!=null){if(typeof n=="string")return{role:"system",parts:[{text:n}]};if(n.text)return{role:"system",parts:[n]};if(n.parts)return n.role?n:{role:"system",parts:n.parts}}}function Hc(n){let e=[];if(typeof n=="string")e=[{text:n}];else for(const t of n)typeof t=="string"?e.push({text:t}):e.push(t);return P2(e)}function P2(n){const e={role:"user",parts:[]},t={role:"function",parts:[]};let i=!1,a=!1;for(const l of n)"functionResponse"in l?(t.parts.push(l),a=!0):(e.parts.push(l),i=!0);if(i&&a)throw new cn("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!i&&!a)throw new cn("No content is provided for sending chat message.");return i?e:t}function M2(n,e){var t;let i={model:e==null?void 0:e.model,generationConfig:e==null?void 0:e.generationConfig,safetySettings:e==null?void 0:e.safetySettings,tools:e==null?void 0:e.tools,toolConfig:e==null?void 0:e.toolConfig,systemInstruction:e==null?void 0:e.systemInstruction,cachedContent:(t=e==null?void 0:e.cachedContent)===null||t===void 0?void 0:t.name,contents:[]};const a=n.generateContentRequest!=null;if(n.contents){if(a)throw new _r("CountTokensRequest must have one of contents or generateContentRequest, not both.");i.contents=n.contents}else if(a)i=Object.assign(Object.assign({},i),n.generateContentRequest);else{const l=Hc(n);i.contents=[l]}return{generateContentRequest:i}}function Cb(n){let e;return n.contents?e=n:e={contents:[Hc(n)]},n.systemInstruction&&(e.systemInstruction=eT(n.systemInstruction)),e}function L2(n){return typeof n=="string"||Array.isArray(n)?{content:Hc(n)}:n}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nb=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],U2={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function V2(n){let e=!1;for(const t of n){const{role:i,parts:a}=t;if(!e&&i!=="user")throw new cn(`First content should be with role 'user', got ${i}`);if(!yb.includes(i))throw new cn(`Each item should include role field. Got ${i} but valid roles are: ${JSON.stringify(yb)}`);if(!Array.isArray(a))throw new cn("Content should have 'parts' property with an array of Parts");if(a.length===0)throw new cn("Each Content should have at least one part");const l={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(const d of a)for(const g of Nb)g in d&&(l[g]+=1);const u=U2[i];for(const d of Nb)if(!u.includes(d)&&l[d]>0)throw new cn(`Content with role '${i}' can't contain '${d}' part`);e=!0}}function Rb(n){var e;if(n.candidates===void 0||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;if(t===void 0||t.parts===void 0||t.parts.length===0)return!1;for(const i of t.parts)if(i===void 0||Object.keys(i).length===0||i.text!==void 0&&i.text==="")return!1;return!0}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kb="SILENT_ERROR";class B2{constructor(e,t,i,a={}){this.model=t,this.params=i,this._requestOptions=a,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=e,i!=null&&i.history&&(V2(i.history),this._history=i.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(e,t={}){var i,a,l,u,d,g;await this._sendPromise;const m=Hc(e),_={safetySettings:(i=this.params)===null||i===void 0?void 0:i.safetySettings,generationConfig:(a=this.params)===null||a===void 0?void 0:a.generationConfig,tools:(l=this.params)===null||l===void 0?void 0:l.tools,toolConfig:(u=this.params)===null||u===void 0?void 0:u.toolConfig,systemInstruction:(d=this.params)===null||d===void 0?void 0:d.systemInstruction,cachedContent:(g=this.params)===null||g===void 0?void 0:g.cachedContent,contents:[...this._history,m]},w=Object.assign(Object.assign({},this._requestOptions),t);let T;return this._sendPromise=this._sendPromise.then(()=>Zx(this._apiKey,this.model,_,w)).then(S=>{var N;if(Rb(S.response)){this._history.push(m);const M=Object.assign({parts:[],role:"model"},(N=S.response.candidates)===null||N===void 0?void 0:N[0].content);this._history.push(M)}else{const M=hr(S.response);M&&console.warn(`sendMessage() was unsuccessful. ${M}. Inspect response object for details.`)}T=S}).catch(S=>{throw this._sendPromise=Promise.resolve(),S}),await this._sendPromise,T}async sendMessageStream(e,t={}){var i,a,l,u,d,g;await this._sendPromise;const m=Hc(e),_={safetySettings:(i=this.params)===null||i===void 0?void 0:i.safetySettings,generationConfig:(a=this.params)===null||a===void 0?void 0:a.generationConfig,tools:(l=this.params)===null||l===void 0?void 0:l.tools,toolConfig:(u=this.params)===null||u===void 0?void 0:u.toolConfig,systemInstruction:(d=this.params)===null||d===void 0?void 0:d.systemInstruction,cachedContent:(g=this.params)===null||g===void 0?void 0:g.cachedContent,contents:[...this._history,m]},w=Object.assign(Object.assign({},this._requestOptions),t),T=Xx(this._apiKey,this.model,_,w);return this._sendPromise=this._sendPromise.then(()=>T).catch(S=>{throw new Error(kb)}).then(S=>S.response).then(S=>{if(Rb(S)){this._history.push(m);const N=Object.assign({},S.candidates[0].content);N.role||(N.role="model"),this._history.push(N)}else{const N=hr(S);N&&console.warn(`sendMessageStream() was unsuccessful. ${N}. Inspect response object for details.`)}}).catch(S=>{S.message!==kb&&console.error(S)}),T}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function z2(n,e,t,i){return(await iu(e,Ea.COUNT_TOKENS,n,!1,JSON.stringify(t),i)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function H2(n,e,t,i){return(await iu(e,Ea.EMBED_CONTENT,n,!1,JSON.stringify(t),i)).json()}async function $2(n,e,t,i){const a=t.requests.map(u=>Object.assign(Object.assign({},u),{model:e}));return(await iu(e,Ea.BATCH_EMBED_CONTENTS,n,!1,JSON.stringify({requests:a}),i)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ib{constructor(e,t,i={}){this.apiKey=e,this._requestOptions=i,t.model.includes("/")?this.model=t.model:this.model=`models/${t.model}`,this.generationConfig=t.generationConfig||{},this.safetySettings=t.safetySettings||[],this.tools=t.tools,this.toolConfig=t.toolConfig,this.systemInstruction=eT(t.systemInstruction),this.cachedContent=t.cachedContent}async generateContent(e,t={}){var i;const a=Cb(e),l=Object.assign(Object.assign({},this._requestOptions),t);return Zx(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(i=this.cachedContent)===null||i===void 0?void 0:i.name},a),l)}async generateContentStream(e,t={}){var i;const a=Cb(e),l=Object.assign(Object.assign({},this._requestOptions),t);return Xx(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(i=this.cachedContent)===null||i===void 0?void 0:i.name},a),l)}startChat(e){var t;return new B2(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(t=this.cachedContent)===null||t===void 0?void 0:t.name},e),this._requestOptions)}async countTokens(e,t={}){const i=M2(e,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),a=Object.assign(Object.assign({},this._requestOptions),t);return z2(this.apiKey,this.model,i,a)}async embedContent(e,t={}){const i=L2(e),a=Object.assign(Object.assign({},this._requestOptions),t);return H2(this.apiKey,this.model,i,a)}async batchEmbedContents(e,t={}){const i=Object.assign(Object.assign({},this._requestOptions),t);return $2(this.apiKey,this.model,e,i)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kd{constructor(e){this.apiKey=e}getGenerativeModel(e,t){if(!e.model)throw new cn("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new Ib(this.apiKey,e,t)}getGenerativeModelFromCachedContent(e,t,i){if(!e.name)throw new _r("Cached content must contain a `name` field.");if(!e.model)throw new _r("Cached content must contain a `model` field.");const a=["model","systemInstruction"];for(const u of a)if(t!=null&&t[u]&&e[u]&&(t==null?void 0:t[u])!==e[u]){if(u==="model"){const d=t.model.startsWith("models/")?t.model.replace("models/",""):t.model,g=e.model.startsWith("models/")?e.model.replace("models/",""):e.model;if(d===g)continue}throw new _r(`Different value for "${u}" specified in modelParams (${t[u]}) and cachedContent (${e[u]})`)}const l=Object.assign(Object.assign({},t),{model:e.model,tools:e.tools,toolConfig:e.toolConfig,systemInstruction:e.systemInstruction,cachedContent:e});return new Ib(this.apiKey,l,i)}}const Ng={},q2=["gemini-flash-latest","gemini-1.5-flash","gemini-2.0-flash-lite-preview-02-05","gemini-2.5-flash","gemini-2.0-flash-lite-001","gemini-2.0-flash","gemini-2.5-pro"];let nm=[];const sm=n=>{nm=n.filter(e=>e.trim()!=="")},F2=n=>{let e=[];n&&(e=n.split(/[\n,]+/).map(i=>i.trim()).filter(i=>i));const t=Ng==null?void 0:Ng.VITE_GEMINI_API_KEY;if(t){const i=t.split(",").map(a=>a.trim()).filter(a=>a);e=[...e,...i]}return nm.length>0&&(e=[...e,...nm]),[...new Set(e)]},Ia=async(n,e)=>{const t=F2(n);if(t.length===0)throw new Error("No API Keys provided. Please configure VITE_GEMINI_API_KEY or enter a key.");let i;for(const a of t){const l=new Kd(a);for(const u of q2)try{const d=l.getGenerativeModel({model:u});return await e(d)}catch(d){console.warn(`Failed: Key(...${a.slice(-4)}) Model(${u}) error: ${d.message}`),i=d}}throw i||new Error("All keys and models failed to generate content.")},G2=async(n,e)=>Ia(e,async t=>{const i=`
        c ton b "Kch bn i th" sau v phn tch theo quy tc:
        Kch bn: """${n}"""

        Mc tiu: Rt ra khung xng cu trc cm xc (Hook, Build-up, Value/Twist, CTA).
        
        Yu cu:
        1. Xc nh ranh gii phn theo chc nng cm xc.
        2. Vi tng phn m t: Ni dung chnh, Cm xc ch o, Cch truyn ti cm xc, L do hiu qu.
        3. Rt ra: 3 yu t ct li, c im ngn ng & tit tu (5-8 im), 3 pattern cm xc.
        
        Rng buc: Khng thm nhn vt/bi cnh ngoi script. Khng nh gi cm tnh. 
        KT THC BNG MT ON RING BIT C TIU  "PHONG CCH I TH" lit k cc c im phong cch  bc sau s dng.
      `;return(await t.generateContent(i)).response.text()}),K2=async(n,e)=>Ia(e,async t=>{const i=`
        Da trn kt qu phn tch khung xng sau:
        """${n}"""
        
        Nhim v: Sng to ra 5  tng ni dung video mi, gi nguyn "linh hn cm xc" ca kch bn gc.
        
        Mi  tng gm:
        - Tiu  ngn
        - M t ni dung (3-5 cu)
        - Nhn vt/Bi cnh
        - Gi tr ni bt (Cm xc/Thc tin)
        - Kh nng lan truyn

        Response must be a valid JSON array matching the schema:
        [{ "id": number, "title": string, "description": string, "charactersContext": string, "highlightValue": string, "viralPotential": string }]
      `,a=await t.generateContent({contents:[{role:"user",parts:[{text:i}]}],generationConfig:{responseMimeType:"application/json"}});return JSON.parse(a.response.text())}),Y2=async(n,e,t,i)=>Ia(i,async a=>{const l=`
        Xy dng dn  chi tit da trn:
        - Khung xng gc: """${n}"""
        -  tng chn: """${JSON.stringify(e)}"""
        - Tng s t mc tiu: ${t}

        Cu trc: Gi nguyn form gc (Hook -> Build-up -> Value/Twist -> CTA).
        Yu cu: Vi mi phn nu r: Mc tiu, Cm xc chnh, Ni dung trin khai, Lin kt trc-sau, S t phn b.
      `;return(await a.generateContent(l)).response.text()}),W2=async(n,e,t)=>Ia(t,async i=>{const a=`
        Vit li thoi kch bn hon chnh (voice-ready) da trn dn  v phong cch sau:
        - Dn : """${n}"""
        - Phong cch m phng: """${e}"""

        QUY TC NGHIM NGT:
        1. Ch tr v li thoi sch 100%. Khng tiu , khng ch thch, khng ngoc ( ), khng nhc nn.
        2. Vit lin mch theo th t Hook -> Build-up -> Value/Twist -> CTA.
      `;return(await i.generateContent(a)).response.text()}),Q2=async(n,e,t)=>Ia(t,async i=>{const a=`
        Da trn kch bn video sau:
        """${n}"""
        
        Hy chn ra 1 phong cch hnh nh ph hp nht t danh sch sau:
        ${e.join(", ")}
        
        Ch tr v duy nht tn ID ca phong cch , khng gii thch g thm.
      `;return(await i.generateContent(a)).response.text().trim()}),J2=async(n,e,t)=>Ia(t,async i=>{const a=`
        Da trn kch bn sau v phong cch hnh nh [${e}]:
        Kch bn: """${n}"""
        
        Hy thit k chi tit cc nhn vt xut hin trong kch bn. Nu kch bn khng m t r, hy t sng to chi tit  m bo tnh thm m v ng b.
        
        QUY TC BT BUC: 
        1. Phn "bodyType" (Dng ngi): Ghi CC K NGN GN (v d: "Cao gy", "Mp mp", "Cn i", "Vm v").
        2. Phn "facialDetails" (c im khun mt): 
           - Nu kch bn thiu, hy t thm cho y  nhng phi M T GN GNG, KHNG LNG NHNG, KHNG VN HOA. 
           - CH C M T TRNG THI BNH THNG/TRUNG TNH (Neutral expression).
           - TUYT I KHNG a vo cm xc hay tnh hung c th (v d: KHNG ghi "ang khc", "mt lm lem", "ci nham him"). Ch m t cu trc vt l (mt, mi, ming, da, tc...).

        Tr v nh dng JSON mng cc i tng:
        - name: Tn nhn vt
        - gender: Gii tnh
        - country: Quc gia/Chng tc
        - age:  tui
        - bodyType: Dng ngi (ngn gn nht c th)
        - facialDetails: c im chi tit khun mt (cu trc vt l, gn gng, khng cm xc)
      `,l=await i.generateContent({contents:[{role:"user",parts:[{text:a}]}],generationConfig:{responseMimeType:"application/json"}});return JSON.parse(l.response.text())}),X2=async(n,e,t,i)=>Ia(i,async a=>{const l=t.map(g=>`[Nhn vt: ${g.name} | Gii tnh: ${g.gender} | Quc gia: ${g.country} | Tui: ${g.age} | Dng ngi: ${g.bodyType} | Khun mt: ${g.facialDetails}]`).join(`
`),u=`
        Bn l mt CHUYN GIA PHN TCH TNH HUNG v o din hnh nh i ti.
        Nhim v: Phn tch kch bn sau  trch xut cc hnh ng quay (Shot Action).

        Kch bn: """${n}"""
        
        THNG TIN NHN VT GC (BT BUC PHI SAO CHP CHNH XC KHI NHC N):
        ${l}

        NGUYN TC PHN TCH TNH HUNG (SITUATIONAL ANALYSIS):
        1. QUAN ST NG CNH: Da vo ni dung lin trc (nu c) v lin sau ca mi hnh ng, hy suy lun logic xem nhn vt no ANG C MT trong cnh .
        2. D ON NHN VT: Nu kch bn khng nhc tn nhng logic tnh hung cho thy nhn vt  phi   (v d: ang i thoi, ang ng cnh), BT BUC phi a h vo.
        3. HIN TH TRONG 'ACTION': Trong trng 'action' (M t ngn hnh ng), hy lit k tn cc nhn vt c mt u tin, sau  n m t hnh ng.

        QUY TC TO PROMPT (Strict Compliance - Rules Override All):

        1. [VISUAL STYLE]: Lun bt u bng phong cch: [${e}].

        2. [Bi cnh] (Context Memory):
           - Nu kch bn khng nu r, hy thm chi tit (bn gh,  vt, b cc...).
           - QUAN TRNG: Ghi nh bi cnh. Nu cha i cnh, DNG LI m t bi cnh c. Nu i cnh, thit lp bi cnh mi chi tit v ghi nh cho cc shot sau.

        3. [QUY TC] (Safety & Quality):
           - Lun thm vo prompt: [NO duplication, NO mutation, NO anatomical distortion, Any violation of anatomy rules is forbidden]

        4. [CAMERA]: Gc my, chuyn ng my (Cinematic wording).

        5. [ACTION] (Character Consistency):
           - Khi nhc n nhn vt no, BT BUC COPY NGUYN VN "c im nhn vt" (Gii tnh, Tui, Dng, Khun mt) t thng tin gc vo prompt.
           - TUYT I KHNG ghi tt, KHNG tm tt, KHNG dng "nh trn". Phi copy full.
           - Nu shot c nhn vt khc, cng copy full c im ca h vo.

        6. [Trang Phc] (Costume Memory):
           - Nu kch bn khng nu, t thm v ghi r mu sc.
           - QUAN TRNG: Gi nguyn trang phc xuyn sut cc shot nu cha i thi gian/cnh.

        7. [AUDIO/VOICE  LIP SYNC]:
           - Cu trc: [Tn nhn vt ni: "Li thoi trong Master Transcript"] (nu c thoi).
           - Nu khng thoi: b qua.

        8. [SPEECH SYNC]:
           - Nu c li thoi  mc trn, BT BUC ghi tag: [Chuyn ng ming nhn vt ng b vi li thoi].

        9. [TECHNICAL]: nh sng, mu sc (Lighting, Color).

        CU TRC PROMPT VIDEO (Video Motion Ai Prompt - Output String):
        [${e}], [Bi cnh chi tit], [NO duplication, NO mutation, NO anatomical distortion, Any violation of anatomy rules is forbidden], [CAMERA], [ACTION: Tn NV + (c im Full Copy) + Hnh ng. ${t.length===1?"The scene contains EXACTLY ONE character":"Check logic"}], [Trang phc], [AUDIO/VOICE  LIP SYNC], [SPEECH SYNC], [TECHNICAL]

        TR V JSON Array cc object:
        - action: [Tn cc NV c mt]: [M t hnh ng]
        - voiceText: Li thoi (nu c)
        - motionPrompt: Prompt video (Tun th cu trc trn)
      `,d=await a.generateContent({contents:[{role:"user",parts:[{text:u}]}],generationConfig:{responseMimeType:"application/json"}});return JSON.parse(d.response.text())}),Z2=({userId:n})=>{const[e,t]=le.useState(!1),[i,a]=le.useState(!1),[l,u]=le.useState({gemini:"",chatgpt:"",openrouter:""}),[d,g]=le.useState(!1),m=k=>{try{return btoa(k)}catch{return k}},_=k=>{try{return atob(k)}catch{return k}},w=`app_api_keys_${n}`;le.useEffect(()=>{const k=localStorage.getItem(w);if(!k){u({gemini:"",chatgpt:"",openrouter:""}),sm([]);return}if(k)try{const V=JSON.parse(k),F={gemini:_(V.gemini||""),chatgpt:_(V.chatgpt||""),openrouter:_(V.openrouter||"")};u(F),F.gemini&&T(F.gemini)}catch(V){console.error("Failed to parse keys",V)}},[n]);const T=k=>{const V=k.split(`
`).map(F=>F.trim()).filter(F=>F!=="");sm(V)},S=()=>{if(!(l.gemini.trim()!==""||l.chatgpt.trim()!==""||l.openrouter.trim()!=="")){alert("Li: Bn phi nhp t nht 1 API Key vo mt trong 3 mc  tip tc!");return}const V={gemini:m(l.gemini),chatgpt:m(l.chatgpt),openrouter:m(l.openrouter)};localStorage.setItem(w,JSON.stringify(V)),l.gemini&&T(l.gemini),g(!0),setTimeout(()=>g(!1),3e3)},N=(k,V)=>{u(F=>({...F,[k]:V}))},M=()=>p.jsx("div",{className:"absolute inset-0 bg-slate-900/90 backdrop-blur-sm flex items-center justify-center cursor-pointer z-10 rounded-lg border border-slate-700/50",onClick:()=>a(!0),children:p.jsxs("span",{className:"text-slate-400 text-xs font-medium flex items-center gap-2",children:[p.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}),"Click to Show Keys"]})});return p.jsxs("div",{className:"w-full bg-[#0f172a] border-b border-white/10 relative z-[200]",children:[p.jsxs("div",{className:"px-6 py-2 flex items-center justify-between cursor-pointer hover:bg-white/5 transition-all text-xs font-bold uppercase tracking-widest text-slate-400",onClick:()=>t(!e),children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("svg",{className:`w-4 h-4 transition-transform ${e?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})}),p.jsxs("span",{children:["API Configuration Manager",p.jsxs("span",{className:"ml-2 text-indigo-400 normal-case tracking-normal opacity-70",children:["(User: ",n.replace("user_","Account ")," - ",i?"Visible":"Hidden",")"]}),d&&p.jsx("span",{className:"text-emerald-400 ml-4 animate-in fade-in slide-in-from-left-2 normal-case tracking-normal",children:" Saved!"})]})]}),p.jsxs("div",{className:"flex gap-4 items-center",children:[p.jsx("button",{onClick:k=>{k.stopPropagation(),a(!i)},className:"text-[10px] bg-slate-800 px-2 py-1 rounded hover:bg-slate-700 transition",children:i?"Hide Keys":"Show Keys"}),p.jsxs("div",{className:"flex gap-4 opacity-50",children:[p.jsxs("span",{children:["Gemini: ",l.gemini?l.gemini.split(`
`).filter(k=>k.trim()).length:0]}),p.jsx("span",{className:"opacity-30",children:"|"}),p.jsxs("span",{children:["GPT: ",l.chatgpt?l.chatgpt.split(`
`).filter(k=>k.trim()).length:0]}),p.jsx("span",{className:"opacity-30",children:"|"}),p.jsxs("span",{children:["OR: ",l.openrouter?l.openrouter.split(`
`).filter(k=>k.trim()).length:0]})]})]})]}),e&&p.jsxs("div",{className:"p-6 grid grid-cols-1 md:grid-cols-3 gap-6 animate-in slide-in-from-top-2 duration-300 bg-black/20",children:[p.jsxs("div",{className:"space-y-2",children:[p.jsx("label",{className:"text-[10px] uppercase font-black text-indigo-400 tracking-widest",children:"Google Gemini Keys"}),p.jsxs("div",{className:"relative group",children:[!i&&p.jsx(M,{}),p.jsx("textarea",{value:l.gemini,onChange:k=>N("gemini",k.target.value),placeholder:`AIzaSy...
AIzaSy...`,rows:4,disabled:!i,className:`w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 text-white text-xs font-mono focus:border-indigo-500 focus:ring-1 outline-none transition-all resize-y ${i?"":"blur-sm select-none"}`})]})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx("label",{className:"text-[10px] uppercase font-black text-emerald-400 tracking-widest",children:"ChatGPT Keys"}),p.jsxs("div",{className:"relative group",children:[!i&&p.jsx(M,{}),p.jsx("textarea",{value:l.chatgpt,onChange:k=>N("chatgpt",k.target.value),placeholder:`sk-...
sk-...`,rows:4,disabled:!i,className:`w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 text-white text-xs font-mono focus:border-emerald-500 focus:ring-1 outline-none transition-all resize-y ${i?"":"blur-sm select-none"}`})]})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx("label",{className:"text-[10px] uppercase font-black text-rose-400 tracking-widest",children:"OpenRouter Keys"}),p.jsxs("div",{className:"relative group",children:[!i&&p.jsx(M,{}),p.jsx("textarea",{value:l.openrouter,onChange:k=>N("openrouter",k.target.value),placeholder:`sk-or-...
sk-or-...`,rows:4,disabled:!i,className:`w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 text-white text-xs font-mono focus:border-rose-500 focus:ring-1 outline-none transition-all resize-y ${i?"":"blur-sm select-none"}`})]})]}),p.jsxs("div",{className:"md:col-span-3 flex flex-col md:flex-row items-center justify-between mt-2 gap-4",children:[p.jsxs("p",{className:"text-[10px] text-slate-500 italic text-center md:text-left",children:["* Bo mt: Key lu ring cho ti khon ",p.jsx("b",{children:n}),". ",p.jsx("br",{}),"H thng t ng xoay vng key khi chy."]}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx("button",{onClick:async()=>{const k=l.gemini.split(`
`).map(F=>F.trim()).filter(F=>F!=="");if(k.length===0){alert("Vui lng nhp v LU t nht 1 API Key Gemini trc khi test!");return}const V=k[0];try{const $=await(await fetch(`https://generativelanguage.googleapis.com/v1beta/models?key=${V}`)).json();if($.error)alert(`Li: ${$.error.message}`);else if($.models){const D=$.models.map(q=>q.name.replace("models/","")).slice(0,10).join(", ");alert(`Kt ni OK! C ${$.models.length} models:
${D}`)}else alert("Phn hi l: "+JSON.stringify($))}catch(F){alert("Li mng: "+F.message)}},className:"bg-blue-600/20 text-blue-400 font-bold uppercase text-xs px-6 py-3 rounded-xl hover:bg-blue-600/30 transition-all border border-blue-600/30",children:"Test Local"}),p.jsx("button",{onClick:S,className:"bg-white text-slate-900 font-black uppercase text-xs px-8 py-3 rounded-xl hover:bg-slate-200 active:scale-95 transition-all shadow-lg flex items-center gap-2",children:"Lu cu hnh (Save)"})]})]})]})]})},eC=()=>{};var Ob={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tT=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let a=n.charCodeAt(i);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(a=65536+((a&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},tC=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const a=n[t++];if(a<128)e[i++]=String.fromCharCode(a);else if(a>191&&a<224){const l=n[t++];e[i++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=n[t++],u=n[t++],d=n[t++],g=((a&7)<<18|(l&63)<<12|(u&63)<<6|d&63)-65536;e[i++]=String.fromCharCode(55296+(g>>10)),e[i++]=String.fromCharCode(56320+(g&1023))}else{const l=n[t++],u=n[t++];e[i++]=String.fromCharCode((a&15)<<12|(l&63)<<6|u&63)}}return e.join("")},nT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let a=0;a<n.length;a+=3){const l=n[a],u=a+1<n.length,d=u?n[a+1]:0,g=a+2<n.length,m=g?n[a+2]:0,_=l>>2,w=(l&3)<<4|d>>4;let T=(d&15)<<2|m>>6,S=m&63;g||(S=64,u||(T=64)),i.push(t[_],t[w],t[T],t[S])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(tT(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):tC(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let a=0;a<n.length;){const l=t[n.charAt(a++)],d=a<n.length?t[n.charAt(a)]:0;++a;const m=a<n.length?t[n.charAt(a)]:64;++a;const w=a<n.length?t[n.charAt(a)]:64;if(++a,l==null||d==null||m==null||w==null)throw new nC;const T=l<<2|d>>4;if(i.push(T),m!==64){const S=d<<4&240|m>>2;if(i.push(S),w!==64){const N=m<<6&192|w;i.push(N)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class nC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const sC=function(n){const e=tT(n);return nT.encodeByteArray(e,!0)},_d=function(n){return sC(n).replace(/\./g,"")},sT=function(n){try{return nT.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rC=()=>iC().__FIREBASE_DEFAULTS__,aC=()=>{if(typeof process>"u"||typeof Ob>"u")return;const n=Ob.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},oC=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&sT(n[1]);return e&&JSON.parse(e)},Yd=()=>{try{return eC()||rC()||aC()||oC()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},iT=n=>{var e,t;return(t=(e=Yd())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},rT=n=>{const e=iT(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},aT=()=>{var n;return(n=Yd())==null?void 0:n.config},oT=n=>{var e;return(e=Yd())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let lC=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}};/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oa(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function $m(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lT(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",a=n.iat||0,l=n.sub||n.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u={iss:`https://securetoken.google.com/${i}`,aud:i,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...n};return[_d(JSON.stringify(t)),_d(JSON.stringify(u)),""].join(".")}const Ic={};function cC(){const n={prod:[],emulator:[]};for(const e of Object.keys(Ic))Ic[e]?n.emulator.push(e):n.prod.push(e);return n}function uC(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let jb=!1;function qm(n,e){if(typeof window>"u"||typeof document>"u"||!Oa(window.location.host)||Ic[n]===e||Ic[n]||jb)return;Ic[n]=e;function t(T){return`__firebase__banner__${T}`}const i="__firebase__banner",l=cC().prod.length>0;function u(){const T=document.getElementById(i);T&&T.remove()}function d(T){T.style.display="flex",T.style.background="#7faaf0",T.style.position="fixed",T.style.bottom="5px",T.style.left="5px",T.style.padding=".5em",T.style.borderRadius="5px",T.style.alignItems="center"}function g(T,S){T.setAttribute("width","24"),T.setAttribute("id",S),T.setAttribute("height","24"),T.setAttribute("viewBox","0 0 24 24"),T.setAttribute("fill","none"),T.style.marginLeft="-6px"}function m(){const T=document.createElement("span");return T.style.cursor="pointer",T.style.marginLeft="16px",T.style.fontSize="24px",T.innerHTML=" &times;",T.onclick=()=>{jb=!0,u()},T}function _(T,S){T.setAttribute("id",S),T.innerText="Learn more",T.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",T.setAttribute("target","__blank"),T.style.paddingLeft="5px",T.style.textDecoration="underline"}function w(){const T=uC(i),S=t("text"),N=document.getElementById(S)||document.createElement("span"),M=t("learnmore"),k=document.getElementById(M)||document.createElement("a"),V=t("preprendIcon"),F=document.getElementById(V)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(T.created){const $=T.element;d($),_(k,M);const D=m();g(F,V),$.append(F,N,k,D),document.body.appendChild($)}l?(N.innerText="Preview backend disconnected.",F.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(F.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,N.innerText="Preview backend running in this workspace."),N.setAttribute("id",S)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",w):w()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function un(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function hC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(un())}function dC(){var e;const n=(e=Yd())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function fC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function cT(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function pC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function gC(){const n=un();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function mC(){return!dC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function uT(){try{return typeof indexedDB=="object"}catch{return!1}}function hT(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(i);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{var l;e(((l=a.error)==null?void 0:l.message)||"")}}catch(t){e(t)}})}function yC(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vC="FirebaseError";class ts extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=vC,Object.setPrototypeOf(this,ts.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ja.prototype.create)}}class ja{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},a=`${this.service}/${e}`,l=this.errors[e],u=l?_C(l,i):"Error",d=`${this.serviceName}: ${u} (${a}).`;return new ts(a,d,i)}}function _C(n,e){return n.replace(bC,(t,i)=>{const a=e[i];return a!=null?String(a):`<${i}?>`})}const bC=/\{\$([^}]+)}/g;function wC(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Er(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const a of t){if(!i.includes(a))return!1;const l=n[a],u=e[a];if(Db(l)&&Db(u)){if(!Er(l,u))return!1}else if(l!==u)return!1}for(const a of i)if(!t.includes(a))return!1;return!0}function Db(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ru(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(a=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Tc(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[a,l]=i.split("=");e[decodeURIComponent(a)]=decodeURIComponent(l)}}),e}function Ec(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function xC(n,e){const t=new TC(n,e);return t.subscribe.bind(t)}class TC{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let a;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");EC(e,["next","error","complete"])?a=e:a={next:e,error:t,complete:i},a.next===void 0&&(a.next=Rg),a.error===void 0&&(a.error=Rg),a.complete===void 0&&(a.complete=Rg);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function EC(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Rg(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SC=1e3,AC=2,CC=14400*1e3,NC=.5;function Pb(n,e=SC,t=AC){const i=e*Math.pow(t,n),a=Math.round(NC*i*(Math.random()-.5)*2);return Math.min(CC,i+a)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vt(n){return n&&n._delegate?n._delegate:n}class es{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pa="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RC{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new lC;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&i.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(a){if(i)return null;throw a}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(IC(e))try{this.getOrInitializeService({instanceIdentifier:pa})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:a});i.resolve(l)}catch{}}}}clearInstance(e=pa){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=pa){return this.instances.has(e)}getOptions(e=pa){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[l,u]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(l);i===d&&u.resolve(a)}return a}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),a=this.onInitCallbacks.get(i)??new Set;a.add(e),this.onInitCallbacks.set(i,a);const l=this.instances.get(i);return l&&e(l,i),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const a of i)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:kC(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=pa){return this.component?this.component.multipleInstances?e:pa:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function kC(n){return n===pa?void 0:n}function IC(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new RC(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Be;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Be||(Be={}));const jC={debug:Be.DEBUG,verbose:Be.VERBOSE,info:Be.INFO,warn:Be.WARN,error:Be.ERROR,silent:Be.SILENT},DC=Be.INFO,PC={[Be.DEBUG]:"log",[Be.VERBOSE]:"log",[Be.INFO]:"info",[Be.WARN]:"warn",[Be.ERROR]:"error"},MC=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),a=PC[e];if(a)console[a](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Wd{constructor(e){this.name=e,this._logLevel=DC,this._logHandler=MC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Be))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?jC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Be.DEBUG,...e),this._logHandler(this,Be.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Be.VERBOSE,...e),this._logHandler(this,Be.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Be.INFO,...e),this._logHandler(this,Be.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Be.WARN,...e),this._logHandler(this,Be.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Be.ERROR,...e),this._logHandler(this,Be.ERROR,...e)}}const LC=(n,e)=>e.some(t=>n instanceof t);let Mb,Lb;function UC(){return Mb||(Mb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function VC(){return Lb||(Lb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const dT=new WeakMap,im=new WeakMap,fT=new WeakMap,kg=new WeakMap,Fm=new WeakMap;function BC(n){const e=new Promise((t,i)=>{const a=()=>{n.removeEventListener("success",l),n.removeEventListener("error",u)},l=()=>{t(br(n.result)),a()},u=()=>{i(n.error),a()};n.addEventListener("success",l),n.addEventListener("error",u)});return e.then(t=>{t instanceof IDBCursor&&dT.set(t,n)}).catch(()=>{}),Fm.set(e,n),e}function zC(n){if(im.has(n))return;const e=new Promise((t,i)=>{const a=()=>{n.removeEventListener("complete",l),n.removeEventListener("error",u),n.removeEventListener("abort",u)},l=()=>{t(),a()},u=()=>{i(n.error||new DOMException("AbortError","AbortError")),a()};n.addEventListener("complete",l),n.addEventListener("error",u),n.addEventListener("abort",u)});im.set(n,e)}let rm={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return im.get(n);if(e==="objectStoreNames")return n.objectStoreNames||fT.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return br(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function HC(n){rm=n(rm)}function $C(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Ig(this),e,...t);return fT.set(i,e.sort?e.sort():[e]),br(i)}:VC().includes(n)?function(...e){return n.apply(Ig(this),e),br(dT.get(this))}:function(...e){return br(n.apply(Ig(this),e))}}function qC(n){return typeof n=="function"?$C(n):(n instanceof IDBTransaction&&zC(n),LC(n,UC())?new Proxy(n,rm):n)}function br(n){if(n instanceof IDBRequest)return BC(n);if(kg.has(n))return kg.get(n);const e=qC(n);return e!==n&&(kg.set(n,e),Fm.set(e,n)),e}const Ig=n=>Fm.get(n);function pT(n,e,{blocked:t,upgrade:i,blocking:a,terminated:l}={}){const u=indexedDB.open(n,e),d=br(u);return i&&u.addEventListener("upgradeneeded",g=>{i(br(u.result),g.oldVersion,g.newVersion,br(u.transaction),g)}),t&&u.addEventListener("blocked",g=>t(g.oldVersion,g.newVersion,g)),d.then(g=>{l&&g.addEventListener("close",()=>l()),a&&g.addEventListener("versionchange",m=>a(m.oldVersion,m.newVersion,m))}).catch(()=>{}),d}const FC=["get","getKey","getAll","getAllKeys","count"],GC=["put","add","delete","clear"],Og=new Map;function Ub(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Og.get(e))return Og.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,a=GC.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(a||FC.includes(t)))return;const l=async function(u,...d){const g=this.transaction(u,a?"readwrite":"readonly");let m=g.store;return i&&(m=m.index(d.shift())),(await Promise.all([m[t](...d),a&&g.done]))[0]};return Og.set(e,l),l}HC(n=>({...n,get:(e,t,i)=>Ub(e,t)||n.get(e,t,i),has:(e,t)=>!!Ub(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KC{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(YC(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function YC(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const am="@firebase/app",Vb="0.14.7";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ei=new Wd("@firebase/app"),WC="@firebase/app-compat",QC="@firebase/analytics-compat",JC="@firebase/analytics",XC="@firebase/app-check-compat",ZC="@firebase/app-check",eN="@firebase/auth",tN="@firebase/auth-compat",nN="@firebase/database",sN="@firebase/data-connect",iN="@firebase/database-compat",rN="@firebase/functions",aN="@firebase/functions-compat",oN="@firebase/installations",lN="@firebase/installations-compat",cN="@firebase/messaging",uN="@firebase/messaging-compat",hN="@firebase/performance",dN="@firebase/performance-compat",fN="@firebase/remote-config",pN="@firebase/remote-config-compat",gN="@firebase/storage",mN="@firebase/storage-compat",yN="@firebase/firestore",vN="@firebase/ai",_N="@firebase/firestore-compat",bN="firebase",wN="12.8.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const om="[DEFAULT]",xN={[am]:"fire-core",[WC]:"fire-core-compat",[JC]:"fire-analytics",[QC]:"fire-analytics-compat",[ZC]:"fire-app-check",[XC]:"fire-app-check-compat",[eN]:"fire-auth",[tN]:"fire-auth-compat",[nN]:"fire-rtdb",[sN]:"fire-data-connect",[iN]:"fire-rtdb-compat",[rN]:"fire-fn",[aN]:"fire-fn-compat",[oN]:"fire-iid",[lN]:"fire-iid-compat",[cN]:"fire-fcm",[uN]:"fire-fcm-compat",[hN]:"fire-perf",[dN]:"fire-perf-compat",[fN]:"fire-rc",[pN]:"fire-rc-compat",[gN]:"fire-gcs",[mN]:"fire-gcs-compat",[yN]:"fire-fst",[_N]:"fire-fst-compat",[vN]:"fire-vertex","fire-js":"fire-js",[bN]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bd=new Map,TN=new Map,lm=new Map;function Bb(n,e){try{n.container.addComponent(e)}catch(t){Ei.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function _s(n){const e=n.name;if(lm.has(e))return Ei.debug(`There were multiple attempts to register component ${e}.`),!1;lm.set(e,n);for(const t of bd.values())Bb(t,n);for(const t of TN.values())Bb(t,n);return!0}function Ir(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Mn(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},wr=new ja("app","Firebase",EN);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SN{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new es("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw wr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Da=wN;function gT(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:om,automaticDataCollectionEnabled:!0,...e},a=i.name;if(typeof a!="string"||!a)throw wr.create("bad-app-name",{appName:String(a)});if(t||(t=aT()),!t)throw wr.create("no-options");const l=bd.get(a);if(l){if(Er(t,l.options)&&Er(i,l.config))return l;throw wr.create("duplicate-app",{appName:a})}const u=new OC(a);for(const g of lm.values())u.addComponent(g);const d=new SN(t,i,u);return bd.set(a,d),d}function Qd(n=om){const e=bd.get(n);if(!e&&n===om&&aT())return gT();if(!e)throw wr.create("no-app",{appName:n});return e}function En(n,e,t){let i=xN[n]??n;t&&(i+=`-${t}`);const a=i.match(/\s|\//),l=e.match(/\s|\//);if(a||l){const u=[`Unable to register library "${i}" with version "${e}":`];a&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),a&&l&&u.push("and"),l&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ei.warn(u.join(" "));return}_s(new es(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AN="firebase-heartbeat-database",CN=1,$c="firebase-heartbeat-store";let jg=null;function mT(){return jg||(jg=pT(AN,CN,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore($c)}catch(t){console.warn(t)}}}}).catch(n=>{throw wr.create("idb-open",{originalErrorMessage:n.message})})),jg}async function NN(n){try{const t=(await mT()).transaction($c),i=await t.objectStore($c).get(yT(n));return await t.done,i}catch(e){if(e instanceof ts)Ei.warn(e.message);else{const t=wr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ei.warn(t.message)}}}async function zb(n,e){try{const i=(await mT()).transaction($c,"readwrite");await i.objectStore($c).put(e,yT(n)),await i.done}catch(t){if(t instanceof ts)Ei.warn(t.message);else{const i=wr.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Ei.warn(i.message)}}}function yT(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RN=1024,kN=30;class IN{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new jN(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=Hb();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(u=>u.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:a}),this._heartbeatsCache.heartbeats.length>kN){const u=DN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(u,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){Ei.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Hb(),{heartbeatsToSend:i,unsentEntries:a}=ON(this._heartbeatsCache.heartbeats),l=_d(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(t){return Ei.warn(t),""}}}function Hb(){return new Date().toISOString().substring(0,10)}function ON(n,e=RN){const t=[];let i=n.slice();for(const a of n){const l=t.find(u=>u.agent===a.agent);if(l){if(l.dates.push(a.date),$b(t)>e){l.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),$b(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class jN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return uT()?hT().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await NN(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return zb(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return zb(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function $b(n){return _d(JSON.stringify({version:2,heartbeats:n})).length}function DN(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PN(n){_s(new es("platform-logger",e=>new KC(e),"PRIVATE")),_s(new es("heartbeat",e=>new IN(e),"PRIVATE")),En(am,Vb,n),En(am,Vb,"esm2020"),En("fire-js","")}PN("");var MN="firebase",LN="12.8.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */En(MN,LN,"app");const vT="@firebase/installations",Gm="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _T=1e4,bT=`w:${Gm}`,wT="FIS_v2",UN="https://firebaseinstallations.googleapis.com/v1",VN=3600*1e3,BN="installations",zN="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HN={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Sa=new ja(BN,zN,HN);function xT(n){return n instanceof ts&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TT({projectId:n}){return`${UN}/projects/${n}/installations`}function ET(n){return{token:n.token,requestStatus:2,expiresIn:qN(n.expiresIn),creationTime:Date.now()}}async function ST(n,e){const i=(await e.json()).error;return Sa.create("request-failed",{requestName:n,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function AT({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function $N(n,{refreshToken:e}){const t=AT(n);return t.append("Authorization",FN(e)),t}async function CT(n){const e=await n();return e.status>=500&&e.status<600?n():e}function qN(n){return Number(n.replace("s","000"))}function FN(n){return`${wT} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GN({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const i=TT(n),a=AT(n),l=e.getImmediate({optional:!0});if(l){const m=await l.getHeartbeatsHeader();m&&a.append("x-firebase-client",m)}const u={fid:t,authVersion:wT,appId:n.appId,sdkVersion:bT},d={method:"POST",headers:a,body:JSON.stringify(u)},g=await CT(()=>fetch(i,d));if(g.ok){const m=await g.json();return{fid:m.fid||t,registrationStatus:2,refreshToken:m.refreshToken,authToken:ET(m.authToken)}}else throw await ST("Create Installation",g)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NT(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KN(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YN=/^[cdef][\w-]{21}$/,cm="";function WN(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=QN(n);return YN.test(t)?t:cm}catch{return cm}}function QN(n){return KN(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jd(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RT=new Map;function kT(n,e){const t=Jd(n);IT(t,e),JN(t,e)}function IT(n,e){const t=RT.get(n);if(t)for(const i of t)i(e)}function JN(n,e){const t=XN();t&&t.postMessage({key:n,fid:e}),ZN()}let va=null;function XN(){return!va&&"BroadcastChannel"in self&&(va=new BroadcastChannel("[Firebase] FID Change"),va.onmessage=n=>{IT(n.data.key,n.data.fid)}),va}function ZN(){RT.size===0&&va&&(va.close(),va=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eR="firebase-installations-database",tR=1,Aa="firebase-installations-store";let Dg=null;function Km(){return Dg||(Dg=pT(eR,tR,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(Aa)}}})),Dg}async function wd(n,e){const t=Jd(n),a=(await Km()).transaction(Aa,"readwrite"),l=a.objectStore(Aa),u=await l.get(t);return await l.put(e,t),await a.done,(!u||u.fid!==e.fid)&&kT(n,e.fid),e}async function OT(n){const e=Jd(n),i=(await Km()).transaction(Aa,"readwrite");await i.objectStore(Aa).delete(e),await i.done}async function Xd(n,e){const t=Jd(n),a=(await Km()).transaction(Aa,"readwrite"),l=a.objectStore(Aa),u=await l.get(t),d=e(u);return d===void 0?await l.delete(t):await l.put(d,t),await a.done,d&&(!u||u.fid!==d.fid)&&kT(n,d.fid),d}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ym(n){let e;const t=await Xd(n.appConfig,i=>{const a=nR(i),l=sR(n,a);return e=l.registrationPromise,l.installationEntry});return t.fid===cm?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function nR(n){const e=n||{fid:WN(),registrationStatus:0};return jT(e)}function sR(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const a=Promise.reject(Sa.create("app-offline"));return{installationEntry:e,registrationPromise:a}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=iR(n,t);return{installationEntry:t,registrationPromise:i}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:rR(n)}:{installationEntry:e}}async function iR(n,e){try{const t=await GN(n,e);return wd(n.appConfig,t)}catch(t){throw xT(t)&&t.customData.serverCode===409?await OT(n.appConfig):await wd(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function rR(n){let e=await qb(n.appConfig);for(;e.registrationStatus===1;)await NT(100),e=await qb(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:i}=await Ym(n);return i||t}return e}function qb(n){return Xd(n,e=>{if(!e)throw Sa.create("installation-not-found");return jT(e)})}function jT(n){return aR(n)?{fid:n.fid,registrationStatus:0}:n}function aR(n){return n.registrationStatus===1&&n.registrationTime+_T<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oR({appConfig:n,heartbeatServiceProvider:e},t){const i=lR(n,t),a=$N(n,t),l=e.getImmediate({optional:!0});if(l){const m=await l.getHeartbeatsHeader();m&&a.append("x-firebase-client",m)}const u={installation:{sdkVersion:bT,appId:n.appId}},d={method:"POST",headers:a,body:JSON.stringify(u)},g=await CT(()=>fetch(i,d));if(g.ok){const m=await g.json();return ET(m)}else throw await ST("Generate Auth Token",g)}function lR(n,{fid:e}){return`${TT(n)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wm(n,e=!1){let t;const i=await Xd(n.appConfig,l=>{if(!DT(l))throw Sa.create("not-registered");const u=l.authToken;if(!e&&hR(u))return l;if(u.requestStatus===1)return t=cR(n,e),l;{if(!navigator.onLine)throw Sa.create("app-offline");const d=fR(l);return t=uR(n,d),d}});return t?await t:i.authToken}async function cR(n,e){let t=await Fb(n.appConfig);for(;t.authToken.requestStatus===1;)await NT(100),t=await Fb(n.appConfig);const i=t.authToken;return i.requestStatus===0?Wm(n,e):i}function Fb(n){return Xd(n,e=>{if(!DT(e))throw Sa.create("not-registered");const t=e.authToken;return pR(t)?{...e,authToken:{requestStatus:0}}:e})}async function uR(n,e){try{const t=await oR(n,e),i={...e,authToken:t};return await wd(n.appConfig,i),t}catch(t){if(xT(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await OT(n.appConfig);else{const i={...e,authToken:{requestStatus:0}};await wd(n.appConfig,i)}throw t}}function DT(n){return n!==void 0&&n.registrationStatus===2}function hR(n){return n.requestStatus===2&&!dR(n)}function dR(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+VN}function fR(n){const e={requestStatus:1,requestTime:Date.now()};return{...n,authToken:e}}function pR(n){return n.requestStatus===1&&n.requestTime+_T<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gR(n){const e=n,{installationEntry:t,registrationPromise:i}=await Ym(e);return i?i.catch(console.error):Wm(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mR(n,e=!1){const t=n;return await yR(t),(await Wm(t,e)).token}async function yR(n){const{registrationPromise:e}=await Ym(n);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vR(n){if(!n||!n.options)throw Pg("App Configuration");if(!n.name)throw Pg("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw Pg(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function Pg(n){return Sa.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PT="installations",_R="installations-internal",bR=n=>{const e=n.getProvider("app").getImmediate(),t=vR(e),i=Ir(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},wR=n=>{const e=n.getProvider("app").getImmediate(),t=Ir(e,PT).getImmediate();return{getId:()=>gR(t),getToken:a=>mR(t,a)}};function xR(){_s(new es(PT,bR,"PUBLIC")),_s(new es(_R,wR,"PRIVATE"))}xR();En(vT,Gm);En(vT,Gm,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xd="analytics",TR="firebase_id",ER="origin",SR=60*1e3,AR="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Qm="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pn=new Wd("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CR={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Un=new ja("analytics","Analytics",CR);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NR(n){if(!n.startsWith(Qm)){const e=Un.create("invalid-gtag-resource",{gtagURL:n});return pn.warn(e.message),""}return n}function MT(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function RR(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function kR(n,e){const t=RR("firebase-js-sdk-policy",{createScriptURL:NR}),i=document.createElement("script"),a=`${Qm}?l=${n}&id=${e}`;i.src=t?t==null?void 0:t.createScriptURL(a):a,i.async=!0,document.head.appendChild(i)}function IR(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}async function OR(n,e,t,i,a,l){const u=i[a];try{if(u)await e[u];else{const g=(await MT(t)).find(m=>m.measurementId===a);g&&await e[g.appId]}}catch(d){pn.error(d)}n("config",a,l)}async function jR(n,e,t,i,a){try{let l=[];if(a&&a.send_to){let u=a.send_to;Array.isArray(u)||(u=[u]);const d=await MT(t);for(const g of u){const m=d.find(w=>w.measurementId===g),_=m&&e[m.appId];if(_)l.push(_);else{l=[];break}}}l.length===0&&(l=Object.values(e)),await Promise.all(l),n("event",i,a||{})}catch(l){pn.error(l)}}function DR(n,e,t,i){async function a(l,...u){try{if(l==="event"){const[d,g]=u;await jR(n,e,t,d,g)}else if(l==="config"){const[d,g]=u;await OR(n,e,t,i,d,g)}else if(l==="consent"){const[d,g]=u;n("consent",d,g)}else if(l==="get"){const[d,g,m]=u;n("get",d,g,m)}else if(l==="set"){const[d]=u;n("set",d)}else n(l,...u)}catch(d){pn.error(d)}}return a}function PR(n,e,t,i,a){let l=function(...u){window[i].push(arguments)};return window[a]&&typeof window[a]=="function"&&(l=window[a]),window[a]=DR(l,n,e,t),{gtagCore:l,wrappedGtag:window[a]}}function MR(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(Qm)&&t.src.includes(n))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LR=30,UR=1e3;class VR{constructor(e={},t=UR){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const LT=new VR;function BR(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}async function zR(n){var u;const{appId:e,apiKey:t}=n,i={method:"GET",headers:BR(t)},a=AR.replace("{app-id}",e),l=await fetch(a,i);if(l.status!==200&&l.status!==304){let d="";try{const g=await l.json();(u=g.error)!=null&&u.message&&(d=g.error.message)}catch{}throw Un.create("config-fetch-failed",{httpStatus:l.status,responseMessage:d})}return l.json()}async function HR(n,e=LT,t){const{appId:i,apiKey:a,measurementId:l}=n.options;if(!i)throw Un.create("no-app-id");if(!a){if(l)return{measurementId:l,appId:i};throw Un.create("no-api-key")}const u=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},d=new FR;return setTimeout(async()=>{d.abort()},SR),UT({appId:i,apiKey:a,measurementId:l},u,d,e)}async function UT(n,{throttleEndTimeMillis:e,backoffCount:t},i,a=LT){var d;const{appId:l,measurementId:u}=n;try{await $R(i,e)}catch(g){if(u)return pn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${u} provided in the "measurementId" field in the local Firebase config. [${g==null?void 0:g.message}]`),{appId:l,measurementId:u};throw g}try{const g=await zR(n);return a.deleteThrottleMetadata(l),g}catch(g){const m=g;if(!qR(m)){if(a.deleteThrottleMetadata(l),u)return pn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${u} provided in the "measurementId" field in the local Firebase config. [${m==null?void 0:m.message}]`),{appId:l,measurementId:u};throw g}const _=Number((d=m==null?void 0:m.customData)==null?void 0:d.httpStatus)===503?Pb(t,a.intervalMillis,LR):Pb(t,a.intervalMillis),w={throttleEndTimeMillis:Date.now()+_,backoffCount:t+1};return a.setThrottleMetadata(l,w),pn.debug(`Calling attemptFetch again in ${_} millis`),UT(n,w,i,a)}}function $R(n,e){return new Promise((t,i)=>{const a=Math.max(e-Date.now(),0),l=setTimeout(t,a);n.addEventListener(()=>{clearTimeout(l),i(Un.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function qR(n){if(!(n instanceof ts)||!n.customData)return!1;const e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}class FR{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function GR(n,e,t,i,a){if(a&&a.global){n("event",t,i);return}else{const l=await e,u={...i,send_to:l};n("event",t,u)}}async function KR(n,e,t,i){if(i&&i.global){const a={};for(const l of Object.keys(t))a[`user_properties.${l}`]=t[l];return n("set",a),Promise.resolve()}else{const a=await e;n("config",a,{update:!0,user_properties:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YR(){if(uT())try{await hT()}catch(n){return pn.warn(Un.create("indexeddb-unavailable",{errorInfo:n==null?void 0:n.toString()}).message),!1}else return pn.warn(Un.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function WR(n,e,t,i,a,l,u){const d=HR(n);d.then(T=>{t[T.measurementId]=T.appId,n.options.measurementId&&T.measurementId!==n.options.measurementId&&pn.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${T.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(T=>pn.error(T)),e.push(d);const g=YR().then(T=>{if(T)return i.getId()}),[m,_]=await Promise.all([d,g]);MR(l)||kR(l,m.measurementId),a("js",new Date);const w=(u==null?void 0:u.config)??{};return w[ER]="firebase",w.update=!0,_!=null&&(w[TR]=_),a("config",m.measurementId,w),m.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QR{constructor(e){this.app=e}_delete(){return delete Fo[this.app.options.appId],Promise.resolve()}}let Fo={},Gb=[];const Kb={};let Mg="dataLayer",JR="gtag",Yb,Jm,Wb=!1;function XR(){const n=[];if(cT()&&n.push("This is a browser extension environment."),yC()||n.push("Cookies are not available."),n.length>0){const e=n.map((i,a)=>`(${a+1}) ${i}`).join(" "),t=Un.create("invalid-analytics-context",{errorInfo:e});pn.warn(t.message)}}function ZR(n,e,t){XR();const i=n.options.appId;if(!i)throw Un.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)pn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Un.create("no-api-key");if(Fo[i]!=null)throw Un.create("already-exists",{id:i});if(!Wb){IR(Mg);const{wrappedGtag:l,gtagCore:u}=PR(Fo,Gb,Kb,Mg,JR);Jm=l,Yb=u,Wb=!0}return Fo[i]=WR(n,Gb,Kb,e,Yb,Mg,t),new QR(n)}function ek(n=Qd()){n=vt(n);const e=Ir(n,xd);return e.isInitialized()?e.getImmediate():tk(n)}function tk(n,e={}){const t=Ir(n,xd);if(t.isInitialized()){const a=t.getImmediate();if(Er(e,t.getOptions()))return a;throw Un.create("already-initialized")}return t.initialize({options:e})}function nk(n,e,t){n=vt(n),KR(Jm,Fo[n.app.options.appId],e,t).catch(i=>pn.error(i))}function sk(n,e,t,i){n=vt(n),GR(Jm,Fo[n.app.options.appId],e,t,i).catch(a=>pn.error(a))}const Qb="@firebase/analytics",Jb="0.10.19";function ik(){_s(new es(xd,(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),a=e.getProvider("installations-internal").getImmediate();return ZR(i,a,t)},"PUBLIC")),_s(new es("analytics-internal",n,"PRIVATE")),En(Qb,Jb),En(Qb,Jb,"esm2020");function n(e){try{const t=e.getProvider(xd).getImmediate();return{logEvent:(i,a,l)=>sk(t,i,a,l),setUserProperties:(i,a)=>nk(t,i,a)}}catch(t){throw Un.create("interop-component-reg-failed",{reason:t})}}}ik();function VT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const rk=VT,BT=new ja("auth","Firebase",VT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Td=new Wd("@firebase/auth");function ak(n,...e){Td.logLevel<=Be.WARN&&Td.warn(`Auth (${Da}): ${n}`,...e)}function ld(n,...e){Td.logLevel<=Be.ERROR&&Td.error(`Auth (${Da}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bs(n,...e){throw Xm(n,...e)}function Fs(n,...e){return Xm(n,...e)}function zT(n,e,t){const i={...rk(),[e]:t};return new ja("auth","Firebase",i).create(e,{appName:n.name})}function xi(n){return zT(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Xm(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return BT.create(n,...e)}function Ae(n,e,...t){if(!n)throw Xm(e,...t)}function bi(n){const e="INTERNAL ASSERTION FAILED: "+n;throw ld(e),new Error(e)}function Si(n,e){n||bi(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function um(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function ok(){return Xb()==="http:"||Xb()==="https:"}function Xb(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lk(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(ok()||cT()||"connection"in navigator)?navigator.onLine:!0}function ck(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class au{constructor(e,t){this.shortDelay=e,this.longDelay=t,Si(t>e,"Short delay should be less than long delay!"),this.isMobile=hC()||pC()}get(){return lk()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zm(n,e){Si(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HT{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;bi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;bi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;bi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uk={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hk=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],dk=new au(3e4,6e4);function Or(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Ri(n,e,t,i,a={}){return $T(n,a,async()=>{let l={},u={};i&&(e==="GET"?u=i:l={body:JSON.stringify(i)});const d=ru({key:n.config.apiKey,...u}).slice(1),g=await n._getAdditionalHeaders();g["Content-Type"]="application/json",n.languageCode&&(g["X-Firebase-Locale"]=n.languageCode);const m={method:e,headers:g,...l};return fC()||(m.referrerPolicy="no-referrer"),n.emulatorConfig&&Oa(n.emulatorConfig.host)&&(m.credentials="include"),HT.fetch()(await qT(n,n.config.apiHost,t,d),m)})}async function $T(n,e,t){n._canInitEmulator=!1;const i={...uk,...e};try{const a=new pk(n),l=await Promise.race([t(),a.promise]);a.clearNetworkTimeout();const u=await l.json();if("needConfirmation"in u)throw Kh(n,"account-exists-with-different-credential",u);if(l.ok&&!("errorMessage"in u))return u;{const d=l.ok?u.errorMessage:u.error.message,[g,m]=d.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw Kh(n,"credential-already-in-use",u);if(g==="EMAIL_EXISTS")throw Kh(n,"email-already-in-use",u);if(g==="USER_DISABLED")throw Kh(n,"user-disabled",u);const _=i[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw zT(n,_,m);bs(n,_)}}catch(a){if(a instanceof ts)throw a;bs(n,"network-request-failed",{message:String(a)})}}async function ou(n,e,t,i,a={}){const l=await Ri(n,e,t,i,a);return"mfaPendingCredential"in l&&bs(n,"multi-factor-auth-required",{_serverResponse:l}),l}async function qT(n,e,t,i){const a=`${e}${t}?${i}`,l=n,u=l.config.emulator?Zm(n.config,a):`${n.config.apiScheme}://${a}`;return hk.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(u).toString():u}function fk(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class pk{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Fs(this.auth,"network-request-failed")),dk.get())})}}function Kh(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const a=Fs(n,e,i);return a.customData._tokenResponse=t,a}function Zb(n){return n!==void 0&&n.enterprise!==void 0}class gk{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return fk(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function mk(n,e){return Ri(n,"GET","/v2/recaptchaConfig",Or(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yk(n,e){return Ri(n,"POST","/v1/accounts:delete",e)}async function Ed(n,e){return Ri(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oc(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function vk(n,e=!1){const t=vt(n),i=await t.getIdToken(e),a=e0(i);Ae(a&&a.exp&&a.auth_time&&a.iat,t.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,u=l==null?void 0:l.sign_in_provider;return{claims:a,token:i,authTime:Oc(Lg(a.auth_time)),issuedAtTime:Oc(Lg(a.iat)),expirationTime:Oc(Lg(a.exp)),signInProvider:u||null,signInSecondFactor:(l==null?void 0:l.sign_in_second_factor)||null}}function Lg(n){return Number(n)*1e3}function e0(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return ld("JWT malformed, contained fewer than 3 sections"),null;try{const a=sT(t);return a?JSON.parse(a):(ld("Failed to decode base64 JWT payload"),null)}catch(a){return ld("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function ew(n){const e=e0(n);return Ae(e,"internal-error"),Ae(typeof e.exp<"u","internal-error"),Ae(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function el(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof ts&&_k(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function _k({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bk{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hm{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Oc(this.lastLoginAt),this.creationTime=Oc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sd(n){var w;const e=n.auth,t=await n.getIdToken(),i=await el(n,Ed(e,{idToken:t}));Ae(i==null?void 0:i.users.length,e,"internal-error");const a=i.users[0];n._notifyReloadListener(a);const l=(w=a.providerUserInfo)!=null&&w.length?FT(a.providerUserInfo):[],u=xk(n.providerData,l),d=n.isAnonymous,g=!(n.email&&a.passwordHash)&&!(u!=null&&u.length),m=d?g:!1,_={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:u,metadata:new hm(a.createdAt,a.lastLoginAt),isAnonymous:m};Object.assign(n,_)}async function wk(n){const e=vt(n);await Sd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function xk(n,e){return[...n.filter(i=>!e.some(a=>a.providerId===i.providerId)),...e]}function FT(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tk(n,e){const t=await $T(n,{},async()=>{const i=ru({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=n.config,u=await qT(n,a,"/v1/token",`key=${l}`),d=await n._getAdditionalHeaders();d["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:d,body:i};return n.emulatorConfig&&Oa(n.emulatorConfig.host)&&(g.credentials="include"),HT.fetch()(u,g)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Ek(n,e){return Ri(n,"POST","/v2/accounts:revokeToken",Or(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ae(e.idToken,"internal-error"),Ae(typeof e.idToken<"u","internal-error"),Ae(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ew(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ae(e.length!==0,"internal-error");const t=ew(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ae(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:a,expiresIn:l}=await Tk(e,t);this.updateTokensAndExpiration(i,a,Number(l))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:a,expirationTime:l}=t,u=new Go;return i&&(Ae(typeof i=="string","internal-error",{appName:e}),u.refreshToken=i),a&&(Ae(typeof a=="string","internal-error",{appName:e}),u.accessToken=a),l&&(Ae(typeof l=="number","internal-error",{appName:e}),u.expirationTime=l),u}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Go,this.toJSON())}_performRefresh(){return bi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ur(n,e){Ae(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class ms{constructor({uid:e,auth:t,stsTokenManager:i,...a}){this.providerId="firebase",this.proactiveRefresh=new bk(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new hm(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const t=await el(this,this.stsTokenManager.getToken(this.auth,e));return Ae(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return vk(this,e)}reload(){return wk(this)}_assign(e){this!==e&&(Ae(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ms({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Ae(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Sd(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Mn(this.auth.app))return Promise.reject(xi(this.auth));const e=await this.getIdToken();return await el(this,yk(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,a=t.email??void 0,l=t.phoneNumber??void 0,u=t.photoURL??void 0,d=t.tenantId??void 0,g=t._redirectEventId??void 0,m=t.createdAt??void 0,_=t.lastLoginAt??void 0,{uid:w,emailVerified:T,isAnonymous:S,providerData:N,stsTokenManager:M}=t;Ae(w&&M,e,"internal-error");const k=Go.fromJSON(this.name,M);Ae(typeof w=="string",e,"internal-error"),ur(i,e.name),ur(a,e.name),Ae(typeof T=="boolean",e,"internal-error"),Ae(typeof S=="boolean",e,"internal-error"),ur(l,e.name),ur(u,e.name),ur(d,e.name),ur(g,e.name),ur(m,e.name),ur(_,e.name);const V=new ms({uid:w,auth:e,email:a,emailVerified:T,displayName:i,isAnonymous:S,photoURL:u,phoneNumber:l,tenantId:d,stsTokenManager:k,createdAt:m,lastLoginAt:_});return N&&Array.isArray(N)&&(V.providerData=N.map(F=>({...F}))),g&&(V._redirectEventId=g),V}static async _fromIdTokenResponse(e,t,i=!1){const a=new Go;a.updateFromServerResponse(t);const l=new ms({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:i});return await Sd(l),l}static async _fromGetAccountInfoResponse(e,t,i){const a=t.users[0];Ae(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?FT(a.providerUserInfo):[],u=!(a.email&&a.passwordHash)&&!(l!=null&&l.length),d=new Go;d.updateFromIdToken(i);const g=new ms({uid:a.localId,auth:e,stsTokenManager:d,isAnonymous:u}),m={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new hm(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(l!=null&&l.length)};return Object.assign(g,m),g}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tw=new Map;function wi(n){Si(n instanceof Function,"Expected a class definition");let e=tw.get(n);return e?(Si(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,tw.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}GT.type="NONE";const nw=GT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cd(n,e,t){return`firebase:${n}:${e}:${t}`}class Ko{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:a,name:l}=this.auth;this.fullUserKey=cd(this.userKey,a.apiKey,l),this.fullPersistenceKey=cd("persistence",a.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Ed(this.auth,{idToken:e}).catch(()=>{});return t?ms._fromGetAccountInfoResponse(this.auth,t,e):null}return ms._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Ko(wi(nw),e,i);const a=(await Promise.all(t.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let l=a[0]||wi(nw);const u=cd(i,e.config.apiKey,e.name);let d=null;for(const m of t)try{const _=await m._get(u);if(_){let w;if(typeof _=="string"){const T=await Ed(e,{idToken:_}).catch(()=>{});if(!T)break;w=await ms._fromGetAccountInfoResponse(e,T,_)}else w=ms._fromJSON(e,_);m!==l&&(d=w),l=m;break}}catch{}const g=a.filter(m=>m._shouldAllowMigration);return!l._shouldAllowMigration||!g.length?new Ko(l,e,i):(l=g[0],d&&await l._set(u,d.toJSON()),await Promise.all(t.map(async m=>{if(m!==l)try{await m._remove(u)}catch{}})),new Ko(l,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sw(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(QT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(KT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(XT(e))return"Blackberry";if(ZT(e))return"Webos";if(YT(e))return"Safari";if((e.includes("chrome/")||WT(e))&&!e.includes("edge/"))return"Chrome";if(JT(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function KT(n=un()){return/firefox\//i.test(n)}function YT(n=un()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function WT(n=un()){return/crios\//i.test(n)}function QT(n=un()){return/iemobile/i.test(n)}function JT(n=un()){return/android/i.test(n)}function XT(n=un()){return/blackberry/i.test(n)}function ZT(n=un()){return/webos/i.test(n)}function t0(n=un()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Sk(n=un()){var e;return t0(n)&&!!((e=window.navigator)!=null&&e.standalone)}function Ak(){return gC()&&document.documentMode===10}function eE(n=un()){return t0(n)||JT(n)||ZT(n)||XT(n)||/windows phone/i.test(n)||QT(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tE(n,e=[]){let t;switch(n){case"Browser":t=sw(un());break;case"Worker":t=`${sw(un())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Da}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ck{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=l=>new Promise((u,d)=>{try{const g=e(l);u(g)}catch(g){d(g)}});i.onAbort=t,this.queue.push(i);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const a of t)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nk(n,e={}){return Ri(n,"GET","/v2/passwordPolicy",Or(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rk=6;class kk{constructor(e){var i;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??Rk,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((i=e.allowedNonAlphanumericCharacters)==null?void 0:i.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),a&&(t.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let a=0;a<e.length;a++)i=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ik{constructor(e,t,i,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new iw(this),this.idTokenSubscription=new iw(this),this.beforeStateQueue=new Ck(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=BT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=wi(t)),this._initializationPromise=this.queue(async()=>{var i,a,l;if(!this._deleted&&(this.persistenceManager=await Ko.create(this,e),(i=this._resolvePersistenceManagerAvailable)==null||i.call(this),!this._deleted)){if((a=this._popupRedirectResolver)!=null&&a._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((l=this.currentUser)==null?void 0:l.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Ed(this,{idToken:e}),i=await ms._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var l;if(Mn(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=(l=this.redirectUser)==null?void 0:l._redirectEventId,d=i==null?void 0:i._redirectEventId,g=await this.tryRedirectSignIn(e);(!u||u===d)&&(g!=null&&g.user)&&(i=g.user,a=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(i)}catch(u){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Ae(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Sd(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=ck()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Mn(this.app))return Promise.reject(xi(this));const t=e?vt(e):null;return t&&Ae(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ae(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Mn(this.app)?Promise.reject(xi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Mn(this.app)?Promise.reject(xi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(wi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Nk(this),t=new kk(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ja("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await Ek(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&wi(e)||this._popupRedirectResolver;Ae(t,this,"argument-error"),this.redirectPersistenceManager=await Ko.create(this,[wi(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)==null?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,a){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let u=!1;const d=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ae(d,this,"internal-error"),d.then(()=>{u||l(this.currentUser)}),typeof t=="function"){const g=e.addObserver(t,i,a);return()=>{u=!0,g()}}else{const g=e.addObserver(t);return()=>{u=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ae(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=tE(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var a;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((a=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:a.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){var t;if(Mn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&ak(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Pa(n){return vt(n)}class iw{constructor(e){this.auth=e,this.observer=null,this.addObserver=xC(t=>this.observer=t)}get next(){return Ae(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Ok(n){Zd=n}function nE(n){return Zd.loadJS(n)}function jk(){return Zd.recaptchaEnterpriseScript}function Dk(){return Zd.gapiScript}function Pk(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class Mk{constructor(){this.enterprise=new Lk}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Lk{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Uk="recaptcha-enterprise",sE="NO_RECAPTCHA";class Vk{constructor(e){this.type=Uk,this.auth=Pa(e)}async verify(e="verify",t=!1){async function i(l){if(!t){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(u,d)=>{mk(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)d(new Error("recaptcha Enterprise site key undefined"));else{const m=new gk(g);return l.tenantId==null?l._agentRecaptchaConfig=m:l._tenantRecaptchaConfigs[l.tenantId]=m,u(m.siteKey)}}).catch(g=>{d(g)})})}function a(l,u,d){const g=window.grecaptcha;Zb(g)?g.enterprise.ready(()=>{g.enterprise.execute(l,{action:e}).then(m=>{u(m)}).catch(()=>{u(sE)})}):d(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Mk().execute("siteKey",{action:"verify"}):new Promise((l,u)=>{i(this.auth).then(d=>{if(!t&&Zb(window.grecaptcha))a(d,l,u);else{if(typeof window>"u"){u(new Error("RecaptchaVerifier is only supported in browser"));return}let g=jk();g.length!==0&&(g+=d),nE(g).then(()=>{a(d,l,u)}).catch(m=>{u(m)})}}).catch(d=>{u(d)})})}}async function rw(n,e,t,i=!1,a=!1){const l=new Vk(n);let u;if(a)u=sE;else try{u=await l.verify(t)}catch{u=await l.verify(t,!0)}const d={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in d){const g=d.phoneEnrollmentInfo.phoneNumber,m=d.phoneEnrollmentInfo.recaptchaToken;Object.assign(d,{phoneEnrollmentInfo:{phoneNumber:g,recaptchaToken:m,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in d){const g=d.phoneSignInInfo.recaptchaToken;Object.assign(d,{phoneSignInInfo:{recaptchaToken:g,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return d}return i?Object.assign(d,{captchaResp:u}):Object.assign(d,{captchaResponse:u}),Object.assign(d,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(d,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),d}async function dm(n,e,t,i,a){var l;if((l=n._getRecaptchaConfig())!=null&&l.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await rw(n,e,t,t==="getOobCode");return i(n,u)}else return i(n,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await rw(n,e,t,t==="getOobCode");return i(n,d)}else return Promise.reject(u)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bk(n,e){const t=Ir(n,"auth");if(t.isInitialized()){const a=t.getImmediate(),l=t.getOptions();if(Er(l,e??{}))return a;bs(a,"already-initialized")}return t.initialize({options:e})}function zk(n,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map(wi);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function Hk(n,e,t){const i=Pa(n);Ae(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const a=!1,l=iE(e),{host:u,port:d}=$k(e),g=d===null?"":`:${d}`,m={url:`${l}//${u}${g}/`},_=Object.freeze({host:u,port:d,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!i._canInitEmulator){Ae(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Ae(Er(m,i.config.emulator)&&Er(_,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=m,i.emulatorConfig=_,i.settings.appVerificationDisabledForTesting=!0,Oa(u)?($m(`${l}//${u}${g}`),qm("Auth",!0)):qk()}function iE(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function $k(n){const e=iE(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(i);if(a){const l=a[1];return{host:l,port:aw(i.substr(l.length+1))}}else{const[l,u]=i.split(":");return{host:l,port:aw(u)}}}function aw(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function qk(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n0{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return bi("not implemented")}_getIdTokenResponse(e){return bi("not implemented")}_linkToIdToken(e,t){return bi("not implemented")}_getReauthenticationResolver(e){return bi("not implemented")}}async function Fk(n,e){return Ri(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gk(n,e){return ou(n,"POST","/v1/accounts:signInWithPassword",Or(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kk(n,e){return ou(n,"POST","/v1/accounts:signInWithEmailLink",Or(n,e))}async function Yk(n,e){return ou(n,"POST","/v1/accounts:signInWithEmailLink",Or(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qc extends n0{constructor(e,t,i,a=null){super("password",i),this._email=e,this._password=t,this._tenantId=a}static _fromEmailAndPassword(e,t){return new qc(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new qc(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return dm(e,t,"signInWithPassword",Gk);case"emailLink":return Kk(e,{email:this._email,oobCode:this._password});default:bs(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return dm(e,i,"signUpPassword",Fk);case"emailLink":return Yk(e,{idToken:t,email:this._email,oobCode:this._password});default:bs(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yo(n,e){return ou(n,"POST","/v1/accounts:signInWithIdp",Or(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wk="http://localhost";class Ca extends n0{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Ca(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):bs("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:a,...l}=t;if(!i||!a)return null;const u=new Ca(i,a);return u.idToken=l.idToken||void 0,u.accessToken=l.accessToken||void 0,u.secret=l.secret,u.nonce=l.nonce,u.pendingToken=l.pendingToken||null,u}_getIdTokenResponse(e){const t=this.buildRequest();return Yo(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Yo(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Yo(e,t)}buildRequest(){const e={requestUri:Wk,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=ru(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qk(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Jk(n){const e=Tc(Ec(n)).link,t=e?Tc(Ec(e)).deep_link_id:null,i=Tc(Ec(n)).deep_link_id;return(i?Tc(Ec(i)).link:null)||i||t||e||n}class s0{constructor(e){const t=Tc(Ec(e)),i=t.apiKey??null,a=t.oobCode??null,l=Qk(t.mode??null);Ae(i&&a&&l,"argument-error"),this.apiKey=i,this.operation=l,this.code=a,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=Jk(e);try{return new s0(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ol{constructor(){this.providerId=ol.PROVIDER_ID}static credential(e,t){return qc._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=s0.parseLink(t);return Ae(i,"argument-error"),qc._fromEmailAndCode(e,i.code,i.tenantId)}}ol.PROVIDER_ID="password";ol.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ol.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rE{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu extends rE{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fr extends lu{constructor(){super("facebook.com")}static credential(e){return Ca._fromParams({providerId:fr.PROVIDER_ID,signInMethod:fr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return fr.credentialFromTaggedObject(e)}static credentialFromError(e){return fr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return fr.credential(e.oauthAccessToken)}catch{return null}}}fr.FACEBOOK_SIGN_IN_METHOD="facebook.com";fr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pr extends lu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Ca._fromParams({providerId:pr.PROVIDER_ID,signInMethod:pr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return pr.credentialFromTaggedObject(e)}static credentialFromError(e){return pr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return pr.credential(t,i)}catch{return null}}}pr.GOOGLE_SIGN_IN_METHOD="google.com";pr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr extends lu{constructor(){super("github.com")}static credential(e){return Ca._fromParams({providerId:gr.PROVIDER_ID,signInMethod:gr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return gr.credentialFromTaggedObject(e)}static credentialFromError(e){return gr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return gr.credential(e.oauthAccessToken)}catch{return null}}}gr.GITHUB_SIGN_IN_METHOD="github.com";gr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mr extends lu{constructor(){super("twitter.com")}static credential(e,t){return Ca._fromParams({providerId:mr.PROVIDER_ID,signInMethod:mr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return mr.credentialFromTaggedObject(e)}static credentialFromError(e){return mr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return mr.credential(t,i)}catch{return null}}}mr.TWITTER_SIGN_IN_METHOD="twitter.com";mr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xk(n,e){return ou(n,"POST","/v1/accounts:signUp",Or(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Na{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,a=!1){const l=await ms._fromIdTokenResponse(e,i,a),u=ow(i);return new Na({user:l,providerId:u,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const a=ow(i);return new Na({user:e,providerId:a,_tokenResponse:i,operationType:t})}}function ow(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ad extends ts{constructor(e,t,i,a){super(t.code,t.message),this.operationType=i,this.user=a,Object.setPrototypeOf(this,Ad.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,a){return new Ad(e,t,i,a)}}function aE(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?Ad._fromErrorAndOperation(n,l,e,i):l})}async function Zk(n,e,t=!1){const i=await el(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Na._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eI(n,e,t=!1){const{auth:i}=n;if(Mn(i.app))return Promise.reject(xi(i));const a="reauthenticate";try{const l=await el(n,aE(i,a,e,n),t);Ae(l.idToken,i,"internal-error");const u=e0(l.idToken);Ae(u,i,"internal-error");const{sub:d}=u;return Ae(n.uid===d,i,"user-mismatch"),Na._forOperation(n,a,l)}catch(l){throw(l==null?void 0:l.code)==="auth/user-not-found"&&bs(i,"user-mismatch"),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oE(n,e,t=!1){if(Mn(n.app))return Promise.reject(xi(n));const i="signIn",a=await aE(n,i,e),l=await Na._fromIdTokenResponse(n,i,a);return t||await n._updateCurrentUser(l.user),l}async function tI(n,e){return oE(Pa(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lE(n){const e=Pa(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function nI(n,e,t){if(Mn(n.app))return Promise.reject(xi(n));const i=Pa(n),u=await dm(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Xk).catch(g=>{throw g.code==="auth/password-does-not-meet-requirements"&&lE(n),g}),d=await Na._fromIdTokenResponse(i,"signIn",u);return await i._updateCurrentUser(d.user),d}function sI(n,e,t){return Mn(n.app)?Promise.reject(xi(n)):tI(vt(n),ol.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&lE(n),i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iI(n,e){return Ri(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rI(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const i=vt(n),l={idToken:await i.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},u=await el(i,iI(i.auth,l));i.displayName=u.displayName||null,i.photoURL=u.photoUrl||null;const d=i.providerData.find(({providerId:g})=>g==="password");d&&(d.displayName=i.displayName,d.photoURL=i.photoURL),await i._updateTokensIfNecessary(u)}function aI(n,e,t,i){return vt(n).onIdTokenChanged(e,t,i)}function oI(n,e,t){return vt(n).beforeAuthStateChanged(e,t)}function lI(n,e,t,i){return vt(n).onAuthStateChanged(e,t,i)}function cI(n){return vt(n).signOut()}const Cd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cE{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Cd,"1"),this.storage.removeItem(Cd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uI=1e3,hI=10;class uE extends cE{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=eE(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),a=this.localCache[t];i!==a&&e(t,a,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((u,d,g)=>{this.notifyListeners(u,g)});return}const i=e.key;t?this.detachListener():this.stopPolling();const a=()=>{const u=this.storage.getItem(i);!t&&this.localCache[i]===u||this.notifyListeners(i,u)},l=this.storage.getItem(i);Ak()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,hI):a()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const a of Array.from(i))a(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},uI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}uE.type="LOCAL";const dI=uE;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hE extends cE{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}hE.type="SESSION";const dE=hE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fI(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(a=>a.isListeningto(e));if(t)return t;const i=new ef(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:a,data:l}=t.data,u=this.handlersMap[a];if(!(u!=null&&u.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:a});const d=Array.from(u).map(async m=>m(t.origin,l)),g=await fI(d);t.ports[0].postMessage({status:"done",eventId:i,eventType:a,response:g})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ef.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i0(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pI{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,u;return new Promise((d,g)=>{const m=i0("",20);a.port1.start();const _=setTimeout(()=>{g(new Error("unsupported_event"))},i);u={messageChannel:a,onMessage(w){const T=w;if(T.data.eventId===m)switch(T.data.status){case"ack":clearTimeout(_),l=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),d(T.data.response);break;default:clearTimeout(_),clearTimeout(l),g(new Error("invalid_response"));break}}},this.handlers.add(u),a.port1.addEventListener("message",u.onMessage),this.target.postMessage({eventType:e,eventId:m,data:t},[a.port2])}).finally(()=>{u&&this.removeMessageHandler(u)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gs(){return window}function gI(n){Gs().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fE(){return typeof Gs().WorkerGlobalScope<"u"&&typeof Gs().importScripts=="function"}async function mI(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function yI(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function vI(){return fE()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pE="firebaseLocalStorageDb",_I=1,Nd="firebaseLocalStorage",gE="fbase_key";class cu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function tf(n,e){return n.transaction([Nd],e?"readwrite":"readonly").objectStore(Nd)}function bI(){const n=indexedDB.deleteDatabase(pE);return new cu(n).toPromise()}function fm(){const n=indexedDB.open(pE,_I);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Nd,{keyPath:gE})}catch(a){t(a)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Nd)?e(i):(i.close(),await bI(),e(await fm()))})})}async function lw(n,e,t){const i=tf(n,!0).put({[gE]:e,value:t});return new cu(i).toPromise()}async function wI(n,e){const t=tf(n,!1).get(e),i=await new cu(t).toPromise();return i===void 0?null:i.value}function cw(n,e){const t=tf(n,!0).delete(e);return new cu(t).toPromise()}const xI=800,TI=3;class mE{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await fm(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>TI)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return fE()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ef._getInstance(vI()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,i;if(this.activeServiceWorker=await mI(),!this.activeServiceWorker)return;this.sender=new pI(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(i=e[0])!=null&&i.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||yI()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await fm();return await lw(e,Cd,"1"),await cw(e,Cd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>lw(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>wI(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>cw(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=tf(a,!1).getAll();return new cu(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)i.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!i.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const a of Array.from(i))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),xI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}mE.type="LOCAL";const EI=mE;new au(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SI(n,e){return e?wi(e):(Ae(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r0 extends n0{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Yo(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Yo(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Yo(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function AI(n){return oE(n.auth,new r0(n),n.bypassAuthState)}function CI(n){const{auth:e,user:t}=n;return Ae(t,e,"internal-error"),eI(t,new r0(n),n.bypassAuthState)}async function NI(n){const{auth:e,user:t}=n;return Ae(t,e,"internal-error"),Zk(t,new r0(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yE{constructor(e,t,i,a,l=!1){this.auth=e,this.resolver=i,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:a,tenantId:l,error:u,type:d}=e;if(u){this.reject(u);return}const g={auth:this.auth,requestUri:t,sessionId:i,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(d)(g))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return AI;case"linkViaPopup":case"linkViaRedirect":return NI;case"reauthViaPopup":case"reauthViaRedirect":return CI;default:bs(this.auth,"internal-error")}}resolve(e){Si(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Si(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RI=new au(2e3,1e4);class $o extends yE{constructor(e,t,i,a,l){super(e,t,a,l),this.provider=i,this.authWindow=null,this.pollId=null,$o.currentPopupAction&&$o.currentPopupAction.cancel(),$o.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ae(e,this.auth,"internal-error"),e}async onExecution(){Si(this.filter.length===1,"Popup operations only handle one event");const e=i0();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Fs(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Fs(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,$o.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if((i=(t=this.authWindow)==null?void 0:t.window)!=null&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Fs(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,RI.get())};e()}}$o.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kI="pendingRedirect",ud=new Map;class II extends yE{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=ud.get(this.auth._key());if(!e){try{const i=await OI(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}ud.set(this.auth._key(),e)}return this.bypassAuthState||ud.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function OI(n,e){const t=PI(e),i=DI(n);if(!await i._isAvailable())return!1;const a=await i._get(t)==="true";return await i._remove(t),a}function jI(n,e){ud.set(n._key(),e)}function DI(n){return wi(n._redirectPersistence)}function PI(n){return cd(kI,n.config.apiKey,n.name)}async function MI(n,e,t=!1){if(Mn(n.app))return Promise.reject(xi(n));const i=Pa(n),a=SI(i,e),u=await new II(i,a,t).execute();return u&&!t&&(delete u.user._redirectEventId,await i._persistUserIfCurrent(u.user),await i._setRedirectUser(null,e)),u}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LI=600*1e3;class UI{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!VI(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!vE(e)){const a=((i=e.error.code)==null?void 0:i.split("auth/")[1])||"internal-error";t.onError(Fs(this.auth,a))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=LI&&this.cachedEventUids.clear(),this.cachedEventUids.has(uw(e))}saveEventToCache(e){this.cachedEventUids.add(uw(e)),this.lastProcessedEventTime=Date.now()}}function uw(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function vE({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function VI(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return vE(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BI(n,e={}){return Ri(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zI=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,HI=/^https?/;async function $I(n){if(n.config.emulator)return;const{authorizedDomains:e}=await BI(n);for(const t of e)try{if(qI(t))return}catch{}bs(n,"unauthorized-domain")}function qI(n){const e=um(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const u=new URL(n);return u.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&u.hostname===i}if(!HI.test(t))return!1;if(zI.test(n))return i===n;const a=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FI=new au(3e4,6e4);function hw(){const n=Gs().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function GI(n){return new Promise((e,t)=>{var a,l,u;function i(){hw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{hw(),t(Fs(n,"network-request-failed"))},timeout:FI.get()})}if((l=(a=Gs().gapi)==null?void 0:a.iframes)!=null&&l.Iframe)e(gapi.iframes.getContext());else if((u=Gs().gapi)!=null&&u.load)i();else{const d=Pk("iframefcb");return Gs()[d]=()=>{gapi.load?i():t(Fs(n,"network-request-failed"))},nE(`${Dk()}?onload=${d}`).catch(g=>t(g))}}).catch(e=>{throw hd=null,e})}let hd=null;function KI(n){return hd=hd||GI(n),hd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YI=new au(5e3,15e3),WI="__/auth/iframe",QI="emulator/auth/iframe",JI={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},XI=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function ZI(n){const e=n.config;Ae(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Zm(e,QI):`https://${n.config.authDomain}/${WI}`,i={apiKey:e.apiKey,appName:n.name,v:Da},a=XI.get(n.config.apiHost);a&&(i.eid=a);const l=n._getFrameworks();return l.length&&(i.fw=l.join(",")),`${t}?${ru(i).slice(1)}`}async function eO(n){const e=await KI(n),t=Gs().gapi;return Ae(t,n,"internal-error"),e.open({where:document.body,url:ZI(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:JI,dontclear:!0},i=>new Promise(async(a,l)=>{await i.restyle({setHideOnLeave:!1});const u=Fs(n,"network-request-failed"),d=Gs().setTimeout(()=>{l(u)},YI.get());function g(){Gs().clearTimeout(d),a(i)}i.ping(g).then(g,()=>{l(u)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tO={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},nO=500,sO=600,iO="_blank",rO="http://localhost";class dw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function aO(n,e,t,i=nO,a=sO){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),u=Math.max((window.screen.availWidth-i)/2,0).toString();let d="";const g={...tO,width:i.toString(),height:a.toString(),top:l,left:u},m=un().toLowerCase();t&&(d=WT(m)?iO:t),KT(m)&&(e=e||rO,g.scrollbars="yes");const _=Object.entries(g).reduce((T,[S,N])=>`${T}${S}=${N},`,"");if(Sk(m)&&d!=="_self")return oO(e||"",d),new dw(null);const w=window.open(e||"",d,_);Ae(w,n,"popup-blocked");try{w.focus()}catch{}return new dw(w)}function oO(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lO="__/auth/handler",cO="emulator/auth/handler",uO=encodeURIComponent("fac");async function fw(n,e,t,i,a,l){Ae(n.config.authDomain,n,"auth-domain-config-required"),Ae(n.config.apiKey,n,"invalid-api-key");const u={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Da,eventId:a};if(e instanceof rE){e.setDefaultLanguage(n.languageCode),u.providerId=e.providerId||"",wC(e.getCustomParameters())||(u.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,w]of Object.entries({}))u[_]=w}if(e instanceof lu){const _=e.getScopes().filter(w=>w!=="");_.length>0&&(u.scopes=_.join(","))}n.tenantId&&(u.tid=n.tenantId);const d=u;for(const _ of Object.keys(d))d[_]===void 0&&delete d[_];const g=await n._getAppCheckToken(),m=g?`#${uO}=${encodeURIComponent(g)}`:"";return`${hO(n)}?${ru(d).slice(1)}${m}`}function hO({config:n}){return n.emulator?Zm(n,cO):`https://${n.authDomain}/${lO}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ug="webStorageSupport";class dO{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=dE,this._completeRedirectFn=MI,this._overrideRedirectResult=jI}async _openPopup(e,t,i,a){var u;Si((u=this.eventManagers[e._key()])==null?void 0:u.manager,"_initialize() not called before _openPopup()");const l=await fw(e,t,i,um(),a);return aO(e,l,i0())}async _openRedirect(e,t,i,a){await this._originValidation(e);const l=await fw(e,t,i,um(),a);return gI(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:a,promise:l}=this.eventManagers[t];return a?Promise.resolve(a):(Si(l,"If manager is not set, promise should be"),l)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await eO(e),i=new UI(e);return t.register("authEvent",a=>(Ae(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:i.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ug,{type:Ug},a=>{var u;const l=(u=a==null?void 0:a[0])==null?void 0:u[Ug];l!==void 0&&t(!!l),bs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=$I(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return eE()||YT()||t0()}}const fO=dO;var pw="@firebase/auth",gw="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pO{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ae(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gO(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function mO(n){_s(new es("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:u,authDomain:d}=i.options;Ae(u&&!u.includes(":"),"invalid-api-key",{appName:i.name});const g={apiKey:u,authDomain:d,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:tE(n)},m=new Ik(i,a,l,g);return zk(m,t),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),_s(new es("auth-internal",e=>{const t=Pa(e.getProvider("auth").getImmediate());return(i=>new pO(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),En(pw,gw,gO(n)),En(pw,gw,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yO=300,vO=oT("authIdTokenMaxAge")||yO;let mw=null;const _O=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>vO)return;const a=t==null?void 0:t.token;mw!==a&&(mw=a,await fetch(n,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function bO(n=Qd()){const e=Ir(n,"auth");if(e.isInitialized())return e.getImmediate();const t=Bk(n,{popupRedirectResolver:fO,persistence:[EI,dI,dE]}),i=oT("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(i,location.origin);if(location.origin===l.origin){const u=_O(l.toString());oI(t,u,()=>u(t.currentUser)),aI(t,d=>u(d))}}const a=iT("auth");return a&&Hk(t,`http://${a}`),t}function wO(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}Ok({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=a=>{const l=Fs("internal-error");l.customData=a,t(l)},i.type="text/javascript",i.charset="UTF-8",wO().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});mO("Browser");var yw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var xr,_E;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(R,A){function I(){}I.prototype=A.prototype,R.F=A.prototype,R.prototype=new I,R.prototype.constructor=R,R.D=function(L,U,G){for(var j=Array(arguments.length-2),H=2;H<arguments.length;H++)j[H-2]=arguments[H];return A.prototype[U].apply(L,j)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(R,A,I){I||(I=0);const L=Array(16);if(typeof A=="string")for(var U=0;U<16;++U)L[U]=A.charCodeAt(I++)|A.charCodeAt(I++)<<8|A.charCodeAt(I++)<<16|A.charCodeAt(I++)<<24;else for(U=0;U<16;++U)L[U]=A[I++]|A[I++]<<8|A[I++]<<16|A[I++]<<24;A=R.g[0],I=R.g[1],U=R.g[2];let G=R.g[3],j;j=A+(G^I&(U^G))+L[0]+3614090360&4294967295,A=I+(j<<7&4294967295|j>>>25),j=G+(U^A&(I^U))+L[1]+3905402710&4294967295,G=A+(j<<12&4294967295|j>>>20),j=U+(I^G&(A^I))+L[2]+606105819&4294967295,U=G+(j<<17&4294967295|j>>>15),j=I+(A^U&(G^A))+L[3]+3250441966&4294967295,I=U+(j<<22&4294967295|j>>>10),j=A+(G^I&(U^G))+L[4]+4118548399&4294967295,A=I+(j<<7&4294967295|j>>>25),j=G+(U^A&(I^U))+L[5]+1200080426&4294967295,G=A+(j<<12&4294967295|j>>>20),j=U+(I^G&(A^I))+L[6]+2821735955&4294967295,U=G+(j<<17&4294967295|j>>>15),j=I+(A^U&(G^A))+L[7]+4249261313&4294967295,I=U+(j<<22&4294967295|j>>>10),j=A+(G^I&(U^G))+L[8]+1770035416&4294967295,A=I+(j<<7&4294967295|j>>>25),j=G+(U^A&(I^U))+L[9]+2336552879&4294967295,G=A+(j<<12&4294967295|j>>>20),j=U+(I^G&(A^I))+L[10]+4294925233&4294967295,U=G+(j<<17&4294967295|j>>>15),j=I+(A^U&(G^A))+L[11]+2304563134&4294967295,I=U+(j<<22&4294967295|j>>>10),j=A+(G^I&(U^G))+L[12]+1804603682&4294967295,A=I+(j<<7&4294967295|j>>>25),j=G+(U^A&(I^U))+L[13]+4254626195&4294967295,G=A+(j<<12&4294967295|j>>>20),j=U+(I^G&(A^I))+L[14]+2792965006&4294967295,U=G+(j<<17&4294967295|j>>>15),j=I+(A^U&(G^A))+L[15]+1236535329&4294967295,I=U+(j<<22&4294967295|j>>>10),j=A+(U^G&(I^U))+L[1]+4129170786&4294967295,A=I+(j<<5&4294967295|j>>>27),j=G+(I^U&(A^I))+L[6]+3225465664&4294967295,G=A+(j<<9&4294967295|j>>>23),j=U+(A^I&(G^A))+L[11]+643717713&4294967295,U=G+(j<<14&4294967295|j>>>18),j=I+(G^A&(U^G))+L[0]+3921069994&4294967295,I=U+(j<<20&4294967295|j>>>12),j=A+(U^G&(I^U))+L[5]+3593408605&4294967295,A=I+(j<<5&4294967295|j>>>27),j=G+(I^U&(A^I))+L[10]+38016083&4294967295,G=A+(j<<9&4294967295|j>>>23),j=U+(A^I&(G^A))+L[15]+3634488961&4294967295,U=G+(j<<14&4294967295|j>>>18),j=I+(G^A&(U^G))+L[4]+3889429448&4294967295,I=U+(j<<20&4294967295|j>>>12),j=A+(U^G&(I^U))+L[9]+568446438&4294967295,A=I+(j<<5&4294967295|j>>>27),j=G+(I^U&(A^I))+L[14]+3275163606&4294967295,G=A+(j<<9&4294967295|j>>>23),j=U+(A^I&(G^A))+L[3]+4107603335&4294967295,U=G+(j<<14&4294967295|j>>>18),j=I+(G^A&(U^G))+L[8]+1163531501&4294967295,I=U+(j<<20&4294967295|j>>>12),j=A+(U^G&(I^U))+L[13]+2850285829&4294967295,A=I+(j<<5&4294967295|j>>>27),j=G+(I^U&(A^I))+L[2]+4243563512&4294967295,G=A+(j<<9&4294967295|j>>>23),j=U+(A^I&(G^A))+L[7]+1735328473&4294967295,U=G+(j<<14&4294967295|j>>>18),j=I+(G^A&(U^G))+L[12]+2368359562&4294967295,I=U+(j<<20&4294967295|j>>>12),j=A+(I^U^G)+L[5]+4294588738&4294967295,A=I+(j<<4&4294967295|j>>>28),j=G+(A^I^U)+L[8]+2272392833&4294967295,G=A+(j<<11&4294967295|j>>>21),j=U+(G^A^I)+L[11]+1839030562&4294967295,U=G+(j<<16&4294967295|j>>>16),j=I+(U^G^A)+L[14]+4259657740&4294967295,I=U+(j<<23&4294967295|j>>>9),j=A+(I^U^G)+L[1]+2763975236&4294967295,A=I+(j<<4&4294967295|j>>>28),j=G+(A^I^U)+L[4]+1272893353&4294967295,G=A+(j<<11&4294967295|j>>>21),j=U+(G^A^I)+L[7]+4139469664&4294967295,U=G+(j<<16&4294967295|j>>>16),j=I+(U^G^A)+L[10]+3200236656&4294967295,I=U+(j<<23&4294967295|j>>>9),j=A+(I^U^G)+L[13]+681279174&4294967295,A=I+(j<<4&4294967295|j>>>28),j=G+(A^I^U)+L[0]+3936430074&4294967295,G=A+(j<<11&4294967295|j>>>21),j=U+(G^A^I)+L[3]+3572445317&4294967295,U=G+(j<<16&4294967295|j>>>16),j=I+(U^G^A)+L[6]+76029189&4294967295,I=U+(j<<23&4294967295|j>>>9),j=A+(I^U^G)+L[9]+3654602809&4294967295,A=I+(j<<4&4294967295|j>>>28),j=G+(A^I^U)+L[12]+3873151461&4294967295,G=A+(j<<11&4294967295|j>>>21),j=U+(G^A^I)+L[15]+530742520&4294967295,U=G+(j<<16&4294967295|j>>>16),j=I+(U^G^A)+L[2]+3299628645&4294967295,I=U+(j<<23&4294967295|j>>>9),j=A+(U^(I|~G))+L[0]+4096336452&4294967295,A=I+(j<<6&4294967295|j>>>26),j=G+(I^(A|~U))+L[7]+1126891415&4294967295,G=A+(j<<10&4294967295|j>>>22),j=U+(A^(G|~I))+L[14]+2878612391&4294967295,U=G+(j<<15&4294967295|j>>>17),j=I+(G^(U|~A))+L[5]+4237533241&4294967295,I=U+(j<<21&4294967295|j>>>11),j=A+(U^(I|~G))+L[12]+1700485571&4294967295,A=I+(j<<6&4294967295|j>>>26),j=G+(I^(A|~U))+L[3]+2399980690&4294967295,G=A+(j<<10&4294967295|j>>>22),j=U+(A^(G|~I))+L[10]+4293915773&4294967295,U=G+(j<<15&4294967295|j>>>17),j=I+(G^(U|~A))+L[1]+2240044497&4294967295,I=U+(j<<21&4294967295|j>>>11),j=A+(U^(I|~G))+L[8]+1873313359&4294967295,A=I+(j<<6&4294967295|j>>>26),j=G+(I^(A|~U))+L[15]+4264355552&4294967295,G=A+(j<<10&4294967295|j>>>22),j=U+(A^(G|~I))+L[6]+2734768916&4294967295,U=G+(j<<15&4294967295|j>>>17),j=I+(G^(U|~A))+L[13]+1309151649&4294967295,I=U+(j<<21&4294967295|j>>>11),j=A+(U^(I|~G))+L[4]+4149444226&4294967295,A=I+(j<<6&4294967295|j>>>26),j=G+(I^(A|~U))+L[11]+3174756917&4294967295,G=A+(j<<10&4294967295|j>>>22),j=U+(A^(G|~I))+L[2]+718787259&4294967295,U=G+(j<<15&4294967295|j>>>17),j=I+(G^(U|~A))+L[9]+3951481745&4294967295,R.g[0]=R.g[0]+A&4294967295,R.g[1]=R.g[1]+(U+(j<<21&4294967295|j>>>11))&4294967295,R.g[2]=R.g[2]+U&4294967295,R.g[3]=R.g[3]+G&4294967295}i.prototype.v=function(R,A){A===void 0&&(A=R.length);const I=A-this.blockSize,L=this.C;let U=this.h,G=0;for(;G<A;){if(U==0)for(;G<=I;)a(this,R,G),G+=this.blockSize;if(typeof R=="string"){for(;G<A;)if(L[U++]=R.charCodeAt(G++),U==this.blockSize){a(this,L),U=0;break}}else for(;G<A;)if(L[U++]=R[G++],U==this.blockSize){a(this,L),U=0;break}}this.h=U,this.o+=A},i.prototype.A=function(){var R=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);R[0]=128;for(var A=1;A<R.length-8;++A)R[A]=0;A=this.o*8;for(var I=R.length-8;I<R.length;++I)R[I]=A&255,A/=256;for(this.v(R),R=Array(16),A=0,I=0;I<4;++I)for(let L=0;L<32;L+=8)R[A++]=this.g[I]>>>L&255;return R};function l(R,A){var I=d;return Object.prototype.hasOwnProperty.call(I,R)?I[R]:I[R]=A(R)}function u(R,A){this.h=A;const I=[];let L=!0;for(let U=R.length-1;U>=0;U--){const G=R[U]|0;L&&G==A||(I[U]=G,L=!1)}this.g=I}var d={};function g(R){return-128<=R&&R<128?l(R,function(A){return new u([A|0],A<0?-1:0)}):new u([R|0],R<0?-1:0)}function m(R){if(isNaN(R)||!isFinite(R))return w;if(R<0)return k(m(-R));const A=[];let I=1;for(let L=0;R>=I;L++)A[L]=R/I|0,I*=4294967296;return new u(A,0)}function _(R,A){if(R.length==0)throw Error("number format error: empty string");if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(R.charAt(0)=="-")return k(_(R.substring(1),A));if(R.indexOf("-")>=0)throw Error('number format error: interior "-" character');const I=m(Math.pow(A,8));let L=w;for(let G=0;G<R.length;G+=8){var U=Math.min(8,R.length-G);const j=parseInt(R.substring(G,G+U),A);U<8?(U=m(Math.pow(A,U)),L=L.j(U).add(m(j))):(L=L.j(I),L=L.add(m(j)))}return L}var w=g(0),T=g(1),S=g(16777216);n=u.prototype,n.m=function(){if(M(this))return-k(this).m();let R=0,A=1;for(let I=0;I<this.g.length;I++){const L=this.i(I);R+=(L>=0?L:4294967296+L)*A,A*=4294967296}return R},n.toString=function(R){if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(N(this))return"0";if(M(this))return"-"+k(this).toString(R);const A=m(Math.pow(R,6));var I=this;let L="";for(;;){const U=D(I,A).g;I=V(I,U.j(A));let G=((I.g.length>0?I.g[0]:I.h)>>>0).toString(R);if(I=U,N(I))return G+L;for(;G.length<6;)G="0"+G;L=G+L}},n.i=function(R){return R<0?0:R<this.g.length?this.g[R]:this.h};function N(R){if(R.h!=0)return!1;for(let A=0;A<R.g.length;A++)if(R.g[A]!=0)return!1;return!0}function M(R){return R.h==-1}n.l=function(R){return R=V(this,R),M(R)?-1:N(R)?0:1};function k(R){const A=R.g.length,I=[];for(let L=0;L<A;L++)I[L]=~R.g[L];return new u(I,~R.h).add(T)}n.abs=function(){return M(this)?k(this):this},n.add=function(R){const A=Math.max(this.g.length,R.g.length),I=[];let L=0;for(let U=0;U<=A;U++){let G=L+(this.i(U)&65535)+(R.i(U)&65535),j=(G>>>16)+(this.i(U)>>>16)+(R.i(U)>>>16);L=j>>>16,G&=65535,j&=65535,I[U]=j<<16|G}return new u(I,I[I.length-1]&-2147483648?-1:0)};function V(R,A){return R.add(k(A))}n.j=function(R){if(N(this)||N(R))return w;if(M(this))return M(R)?k(this).j(k(R)):k(k(this).j(R));if(M(R))return k(this.j(k(R)));if(this.l(S)<0&&R.l(S)<0)return m(this.m()*R.m());const A=this.g.length+R.g.length,I=[];for(var L=0;L<2*A;L++)I[L]=0;for(L=0;L<this.g.length;L++)for(let U=0;U<R.g.length;U++){const G=this.i(L)>>>16,j=this.i(L)&65535,H=R.i(U)>>>16,Z=R.i(U)&65535;I[2*L+2*U]+=j*Z,F(I,2*L+2*U),I[2*L+2*U+1]+=G*Z,F(I,2*L+2*U+1),I[2*L+2*U+1]+=j*H,F(I,2*L+2*U+1),I[2*L+2*U+2]+=G*H,F(I,2*L+2*U+2)}for(R=0;R<A;R++)I[R]=I[2*R+1]<<16|I[2*R];for(R=A;R<2*A;R++)I[R]=0;return new u(I,0)};function F(R,A){for(;(R[A]&65535)!=R[A];)R[A+1]+=R[A]>>>16,R[A]&=65535,A++}function $(R,A){this.g=R,this.h=A}function D(R,A){if(N(A))throw Error("division by zero");if(N(R))return new $(w,w);if(M(R))return A=D(k(R),A),new $(k(A.g),k(A.h));if(M(A))return A=D(R,k(A)),new $(k(A.g),A.h);if(R.g.length>30){if(M(R)||M(A))throw Error("slowDivide_ only works with positive integers.");for(var I=T,L=A;L.l(R)<=0;)I=q(I),L=q(L);var U=J(I,1),G=J(L,1);for(L=J(L,2),I=J(I,2);!N(L);){var j=G.add(L);j.l(R)<=0&&(U=U.add(I),G=j),L=J(L,1),I=J(I,1)}return A=V(R,U.j(A)),new $(U,A)}for(U=w;R.l(A)>=0;){for(I=Math.max(1,Math.floor(R.m()/A.m())),L=Math.ceil(Math.log(I)/Math.LN2),L=L<=48?1:Math.pow(2,L-48),G=m(I),j=G.j(A);M(j)||j.l(R)>0;)I-=L,G=m(I),j=G.j(A);N(G)&&(G=T),U=U.add(G),R=V(R,j)}return new $(U,R)}n.B=function(R){return D(this,R).h},n.and=function(R){const A=Math.max(this.g.length,R.g.length),I=[];for(let L=0;L<A;L++)I[L]=this.i(L)&R.i(L);return new u(I,this.h&R.h)},n.or=function(R){const A=Math.max(this.g.length,R.g.length),I=[];for(let L=0;L<A;L++)I[L]=this.i(L)|R.i(L);return new u(I,this.h|R.h)},n.xor=function(R){const A=Math.max(this.g.length,R.g.length),I=[];for(let L=0;L<A;L++)I[L]=this.i(L)^R.i(L);return new u(I,this.h^R.h)};function q(R){const A=R.g.length+1,I=[];for(let L=0;L<A;L++)I[L]=R.i(L)<<1|R.i(L-1)>>>31;return new u(I,R.h)}function J(R,A){const I=A>>5;A%=32;const L=R.g.length-I,U=[];for(let G=0;G<L;G++)U[G]=A>0?R.i(G+I)>>>A|R.i(G+I+1)<<32-A:R.i(G+I);return new u(U,R.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,_E=i,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.B,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=m,u.fromString=_,xr=u}).apply(typeof yw<"u"?yw:typeof self<"u"?self:typeof window<"u"?window:{});var Yh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var bE,Sc,wE,dd,pm,xE,TE,EE;(function(){var n,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Yh=="object"&&Yh];for(var v=0;v<h.length;++v){var x=h[v];if(x&&x.Math==Math)return x}throw Error("Cannot find global object")}var i=t(this);function a(h,v){if(v)e:{var x=i;h=h.split(".");for(var C=0;C<h.length-1;C++){var Y=h[C];if(!(Y in x))break e;x=x[Y]}h=h[h.length-1],C=x[h],v=v(C),v!=C&&v!=null&&e(x,h,{configurable:!0,writable:!0,value:v})}}a("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(h){return h||function(v){var x=[],C;for(C in v)Object.prototype.hasOwnProperty.call(v,C)&&x.push([C,v[C]]);return x}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},u=this||self;function d(h){var v=typeof h;return v=="object"&&h!=null||v=="function"}function g(h,v,x){return h.call.apply(h.bind,arguments)}function m(h,v,x){return m=g,m.apply(null,arguments)}function _(h,v){var x=Array.prototype.slice.call(arguments,1);return function(){var C=x.slice();return C.push.apply(C,arguments),h.apply(this,C)}}function w(h,v){function x(){}x.prototype=v.prototype,h.Z=v.prototype,h.prototype=new x,h.prototype.constructor=h,h.Ob=function(C,Y,ee){for(var he=Array(arguments.length-2),Oe=2;Oe<arguments.length;Oe++)he[Oe-2]=arguments[Oe];return v.prototype[Y].apply(C,he)}}var T=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function S(h){const v=h.length;if(v>0){const x=Array(v);for(let C=0;C<v;C++)x[C]=h[C];return x}return[]}function N(h,v){for(let C=1;C<arguments.length;C++){const Y=arguments[C];var x=typeof Y;if(x=x!="object"?x:Y?Array.isArray(Y)?"array":x:"null",x=="array"||x=="object"&&typeof Y.length=="number"){x=h.length||0;const ee=Y.length||0;h.length=x+ee;for(let he=0;he<ee;he++)h[x+he]=Y[he]}else h.push(Y)}}class M{constructor(v,x){this.i=v,this.j=x,this.h=0,this.g=null}get(){let v;return this.h>0?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function k(h){u.setTimeout(()=>{throw h},0)}function V(){var h=R;let v=null;return h.g&&(v=h.g,h.g=h.g.next,h.g||(h.h=null),v.next=null),v}class F{constructor(){this.h=this.g=null}add(v,x){const C=$.get();C.set(v,x),this.h?this.h.next=C:this.g=C,this.h=C}}var $=new M(()=>new D,h=>h.reset());class D{constructor(){this.next=this.g=this.h=null}set(v,x){this.h=v,this.g=x,this.next=null}reset(){this.next=this.g=this.h=null}}let q,J=!1,R=new F,A=()=>{const h=Promise.resolve(void 0);q=()=>{h.then(I)}};function I(){for(var h;h=V();){try{h.h.call(h.g)}catch(x){k(x)}var v=$;v.j(h),v.h<100&&(v.h++,h.next=v.g,v.g=h)}J=!1}function L(){this.u=this.u,this.C=this.C}L.prototype.u=!1,L.prototype.dispose=function(){this.u||(this.u=!0,this.N())},L.prototype[Symbol.dispose]=function(){this.dispose()},L.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function U(h,v){this.type=h,this.g=this.target=v,this.defaultPrevented=!1}U.prototype.h=function(){this.defaultPrevented=!0};var G=(function(){if(!u.addEventListener||!Object.defineProperty)return!1;var h=!1,v=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const x=()=>{};u.addEventListener("test",x,v),u.removeEventListener("test",x,v)}catch{}return h})();function j(h){return/^[\s\xa0]*$/.test(h)}function H(h,v){U.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,v)}w(H,U),H.prototype.init=function(h,v){const x=this.type=h.type,C=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=v,v=h.relatedTarget,v||(x=="mouseover"?v=h.fromElement:x=="mouseout"&&(v=h.toElement)),this.relatedTarget=v,C?(this.clientX=C.clientX!==void 0?C.clientX:C.pageX,this.clientY=C.clientY!==void 0?C.clientY:C.pageY,this.screenX=C.screenX||0,this.screenY=C.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&H.Z.h.call(this)},H.prototype.h=function(){H.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var Z="closure_listenable_"+(Math.random()*1e6|0),O=0;function se(h,v,x,C,Y){this.listener=h,this.proxy=null,this.src=v,this.type=x,this.capture=!!C,this.ha=Y,this.key=++O,this.da=this.fa=!1}function de(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function me(h,v,x){for(const C in h)v.call(x,h[C],C,h)}function qe(h,v){for(const x in h)v.call(void 0,h[x],x,h)}function B(h){const v={};for(const x in h)v[x]=h[x];return v}const ne="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ue(h,v){let x,C;for(let Y=1;Y<arguments.length;Y++){C=arguments[Y];for(x in C)h[x]=C[x];for(let ee=0;ee<ne.length;ee++)x=ne[ee],Object.prototype.hasOwnProperty.call(C,x)&&(h[x]=C[x])}}function fe(h){this.src=h,this.g={},this.h=0}fe.prototype.add=function(h,v,x,C,Y){const ee=h.toString();h=this.g[ee],h||(h=this.g[ee]=[],this.h++);const he=Ne(h,v,C,Y);return he>-1?(v=h[he],x||(v.fa=!1)):(v=new se(v,this.src,ee,!!C,Y),v.fa=x,h.push(v)),v};function Ee(h,v){const x=v.type;if(x in h.g){var C=h.g[x],Y=Array.prototype.indexOf.call(C,v,void 0),ee;(ee=Y>=0)&&Array.prototype.splice.call(C,Y,1),ee&&(de(v),h.g[x].length==0&&(delete h.g[x],h.h--))}}function Ne(h,v,x,C){for(let Y=0;Y<h.length;++Y){const ee=h[Y];if(!ee.da&&ee.listener==v&&ee.capture==!!x&&ee.ha==C)return Y}return-1}var Pe="closure_lm_"+(Math.random()*1e6|0),Et={};function rt(h,v,x,C,Y){if(Array.isArray(v)){for(let ee=0;ee<v.length;ee++)rt(h,v[ee],x,C,Y);return null}return x=ml(x),h&&h[Z]?h.J(v,x,d(C)?!!C.capture:!1,Y):Vn(h,v,x,!1,C,Y)}function Vn(h,v,x,C,Y,ee){if(!v)throw Error("Invalid event type");const he=d(Y)?!!Y.capture:!!Y;let Oe=Mr(h);if(Oe||(h[Pe]=Oe=new fe(h)),x=Oe.add(v,x,C,he,ee),x.proxy)return x;if(C=Ua(),x.proxy=C,C.src=h,C.listener=x,h.addEventListener)G||(Y=he),Y===void 0&&(Y=!1),h.addEventListener(v.toString(),C,Y);else if(h.attachEvent)h.attachEvent(ws(v.toString()),C);else if(h.addListener&&h.removeListener)h.addListener(C);else throw Error("addEventListener and attachEvent are unavailable.");return x}function Ua(){function h(x){return v.call(h.src,h.listener,x)}const v=pl;return h}function Va(h,v,x,C,Y){if(Array.isArray(v))for(var ee=0;ee<v.length;ee++)Va(h,v[ee],x,C,Y);else C=d(C)?!!C.capture:!!C,x=ml(x),h&&h[Z]?(h=h.i,ee=String(v).toString(),ee in h.g&&(v=h.g[ee],x=Ne(v,x,C,Y),x>-1&&(de(v[x]),Array.prototype.splice.call(v,x,1),v.length==0&&(delete h.g[ee],h.h--)))):h&&(h=Mr(h))&&(v=h.g[v.toString()],h=-1,v&&(h=Ne(v,x,C,Y)),(x=h>-1?v[h]:null)&&Ba(x))}function Ba(h){if(typeof h!="number"&&h&&!h.da){var v=h.src;if(v&&v[Z])Ee(v.i,h);else{var x=h.type,C=h.proxy;v.removeEventListener?v.removeEventListener(x,C,h.capture):v.detachEvent?v.detachEvent(ws(x),C):v.addListener&&v.removeListener&&v.removeListener(C),(x=Mr(v))?(Ee(x,h),x.h==0&&(x.src=null,v[Pe]=null)):de(h)}}}function ws(h){return h in Et?Et[h]:Et[h]="on"+h}function pl(h,v){if(h.da)h=!0;else{v=new H(v,this);const x=h.listener,C=h.ha||h.src;h.fa&&Ba(h),h=x.call(C,v)}return h}function Mr(h){return h=h[Pe],h instanceof fe?h:null}var gl="__closure_events_fn_"+(Math.random()*1e9>>>0);function ml(h){return typeof h=="function"?h:(h[gl]||(h[gl]=function(v){return h.handleEvent(v)}),h[gl])}function St(){L.call(this),this.i=new fe(this),this.M=this,this.G=null}w(St,L),St.prototype[Z]=!0,St.prototype.removeEventListener=function(h,v,x,C){Va(this,h,v,x,C)};function Ut(h,v){var x,C=h.G;if(C)for(x=[];C;C=C.G)x.push(C);if(h=h.M,C=v.type||v,typeof v=="string")v=new U(v,h);else if(v instanceof U)v.target=v.target||h;else{var Y=v;v=new U(C,h),ue(v,Y)}Y=!0;let ee,he;if(x)for(he=x.length-1;he>=0;he--)ee=v.g=x[he],Y=Ii(ee,C,!0,v)&&Y;if(ee=v.g=h,Y=Ii(ee,C,!0,v)&&Y,Y=Ii(ee,C,!1,v)&&Y,x)for(he=0;he<x.length;he++)ee=v.g=x[he],Y=Ii(ee,C,!1,v)&&Y}St.prototype.N=function(){if(St.Z.N.call(this),this.i){var h=this.i;for(const v in h.g){const x=h.g[v];for(let C=0;C<x.length;C++)de(x[C]);delete h.g[v],h.h--}}this.G=null},St.prototype.J=function(h,v,x,C){return this.i.add(String(h),v,!1,x,C)},St.prototype.K=function(h,v,x,C){return this.i.add(String(h),v,!0,x,C)};function Ii(h,v,x,C){if(v=h.i.g[String(v)],!v)return!0;v=v.concat();let Y=!0;for(let ee=0;ee<v.length;++ee){const he=v[ee];if(he&&!he.da&&he.capture==x){const Oe=he.listener,bt=he.ha||he.src;he.fa&&Ee(h.i,he),Y=Oe.call(bt,C)!==!1&&Y}}return Y&&!C.defaultPrevented}function Ef(h,v){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=m(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(v)>2147483647?-1:u.setTimeout(h,v||0)}function vu(h){h.g=Ef(()=>{h.g=null,h.i&&(h.i=!1,vu(h))},h.l);const v=h.h;h.h=null,h.m.apply(null,v)}class hn extends L{constructor(v,x){super(),this.m=v,this.l=x,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:vu(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Lr(h){L.call(this),this.h=h,this.g={}}w(Lr,L);var yl=[];function vl(h){me(h.g,function(v,x){this.g.hasOwnProperty(x)&&Ba(v)},h),h.g={}}Lr.prototype.N=function(){Lr.Z.N.call(this),vl(this)},Lr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Oi=u.JSON.stringify,Sf=u.JSON.parse,_u=class{stringify(h){return u.JSON.stringify(h,void 0)}parse(h){return u.JSON.parse(h,void 0)}};function bu(){}function wu(){}var ns={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Kt(){U.call(this,"d")}w(Kt,U);function Bn(){U.call(this,"c")}w(Bn,U);var _t={},xu=null;function za(){return xu=xu||new St}_t.Ia="serverreachability";function Tu(h){U.call(this,_t.Ia,h)}w(Tu,U);function xs(h){const v=za();Ut(v,new Tu(v))}_t.STAT_EVENT="statevent";function Ur(h,v){U.call(this,_t.STAT_EVENT,h),this.stat=v}w(Ur,U);function At(h){const v=za();Ut(v,new Ur(v,h))}_t.Ja="timingevent";function Ts(h,v){U.call(this,_t.Ja,h),this.size=v}w(Ts,U);function Es(h,v){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){h()},v)}function ss(){this.g=!0}ss.prototype.ua=function(){this.g=!1};function Af(h,v,x,C,Y,ee){h.info(function(){if(h.g)if(ee){var he="",Oe=ee.split("&");for(let Ye=0;Ye<Oe.length;Ye++){var bt=Oe[Ye].split("=");if(bt.length>1){const ht=bt[0];bt=bt[1];const qn=ht.split("_");he=qn.length>=2&&qn[1]=="type"?he+(ht+"="+bt+"&"):he+(ht+"=redacted&")}}}else he=null;else he=ee;return"XMLHTTP REQ ("+C+") [attempt "+Y+"]: "+v+`
`+x+`
`+he})}function Eu(h,v,x,C,Y,ee,he){h.info(function(){return"XMLHTTP RESP ("+C+") [ attempt "+Y+"]: "+v+`
`+x+`
`+ee+" "+he})}function Ss(h,v,x,C){h.info(function(){return"XMLHTTP TEXT ("+v+"): "+Cf(h,x)+(C?" "+C:"")})}function Vr(h,v){h.info(function(){return"TIMEOUT: "+v})}ss.prototype.info=function(){};function Cf(h,v){if(!h.g)return v;if(!v)return null;try{const ee=JSON.parse(v);if(ee){for(h=0;h<ee.length;h++)if(Array.isArray(ee[h])){var x=ee[h];if(!(x.length<2)){var C=x[1];if(Array.isArray(C)&&!(C.length<1)){var Y=C[0];if(Y!="noop"&&Y!="stop"&&Y!="close")for(let he=1;he<C.length;he++)C[he]=""}}}}return Oi(ee)}catch{return v}}var Br={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},_l={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},bl;function zr(){}w(zr,bu),zr.prototype.g=function(){return new XMLHttpRequest},bl=new zr;function ei(h){return encodeURIComponent(String(h))}function Su(h){var v=1;h=h.split(":");const x=[];for(;v>0&&h.length;)x.push(h.shift()),v--;return h.length&&x.push(h.join(":")),x}function is(h,v,x,C){this.j=h,this.i=v,this.l=x,this.S=C||1,this.V=new Lr(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new rs}function rs(){this.i=null,this.g="",this.h=!1}var Ct={},$t={};function As(h,v,x){h.M=1,h.A=Hr(Rt(v)),h.u=x,h.R=!0,Ha(h,null)}function Ha(h,v){h.F=Date.now(),Cs(h),h.B=Rt(h.A);var x=h.B,C=h.S;Array.isArray(C)||(C=[String(C)]),Ga(x.i,"t",C),h.C=0,x=h.j.L,h.h=new rs,h.g=Bu(h.j,x?v:null,!h.u),h.P>0&&(h.O=new hn(m(h.Y,h,h.g),h.P)),v=h.V,x=h.g,C=h.ba;var Y="readystatechange";Array.isArray(Y)||(Y&&(yl[0]=Y.toString()),Y=yl);for(let ee=0;ee<Y.length;ee++){const he=rt(x,Y[ee],C||v.handleEvent,!1,v.h||v);if(!he)break;v.g[he.key]=he}v=h.J?B(h.J):{},h.u?(h.v||(h.v="POST"),v["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,v)):(h.v="GET",h.g.ea(h.B,h.v,null,v)),xs(),Af(h.i,h.v,h.B,h.l,h.S,h.u)}is.prototype.ba=function(h){h=h.target;const v=this.O;v&&ls(h)==3?v.j():this.Y(h)},is.prototype.Y=function(h){try{if(h==this.g)e:{const Oe=ls(this.g),bt=this.g.ya(),Ye=this.g.ca();if(!(Oe<3)&&(Oe!=3||this.g&&(this.h.h||this.g.la()||Yt(this.g)))){this.K||Oe!=4||bt==7||(bt==8||Ye<=0?xs(3):xs(2)),Ns(this);var v=this.g.ca();this.X=v;var x=Nf(this);if(this.o=v==200,Eu(this.i,this.v,this.B,this.l,this.S,Oe,v),this.o){if(this.U&&!this.L){t:{if(this.g){var C,Y=this.g;if((C=Y.g?Y.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(C)){var ee=C;break t}}ee=null}if(h=ee)Ss(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Rs(this,h);else{this.o=!1,this.m=3,At(12),An(this),zn(this);break e}}if(this.R){h=!0;let ht;for(;!this.K&&this.C<x.length;)if(ht=Cu(this,x),ht==$t){Oe==4&&(this.m=4,At(14),h=!1),Ss(this.i,this.l,null,"[Incomplete Response]");break}else if(ht==Ct){this.m=4,At(15),Ss(this.i,this.l,x,"[Invalid Chunk]"),h=!1;break}else Ss(this.i,this.l,ht,null),Rs(this,ht);if(Au(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Oe!=4||x.length!=0||this.h.h||(this.m=1,At(16),h=!1),this.o=this.o&&h,!h)Ss(this.i,this.l,x,"[Invalid Chunked Response]"),An(this),zn(this);else if(x.length>0&&!this.W){this.W=!0;var he=this.j;he.g==this&&he.aa&&!he.P&&(he.j.info("Great, no buffering proxy detected. Bytes received: "+x.length),Pl(he),he.P=!0,At(11))}}else Ss(this.i,this.l,x,null),Rs(this,x);Oe==4&&An(this),this.o&&!this.K&&(Oe==4?Mu(this.j,this):(this.o=!1,Cs(this)))}else ni(this.g),v==400&&x.indexOf("Unknown SID")>0?(this.m=3,At(12)):(this.m=0,At(13)),An(this),zn(this)}}}catch{}finally{}};function Nf(h){if(!Au(h))return h.g.la();const v=Yt(h.g);if(v==="")return"";let x="";const C=v.length,Y=ls(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return An(h),zn(h),"";h.h.i=new u.TextDecoder}for(let ee=0;ee<C;ee++)h.h.h=!0,x+=h.h.i.decode(v[ee],{stream:!(Y&&ee==C-1)});return v.length=0,h.h.g+=x,h.C=0,h.h.g}function Au(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function Cu(h,v){var x=h.C,C=v.indexOf(`
`,x);return C==-1?$t:(x=Number(v.substring(x,C)),isNaN(x)?Ct:(C+=1,C+x>v.length?$t:(v=v.slice(C,C+x),h.C=C+x,v)))}is.prototype.cancel=function(){this.K=!0,An(this)};function Cs(h){h.T=Date.now()+h.H,$a(h,h.H)}function $a(h,v){if(h.D!=null)throw Error("WatchDog timer not null");h.D=Es(m(h.aa,h),v)}function Ns(h){h.D&&(u.clearTimeout(h.D),h.D=null)}is.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(Vr(this.i,this.B),this.M!=2&&(xs(),At(17)),An(this),this.m=2,zn(this)):$a(this,this.T-h)};function zn(h){h.j.I==0||h.K||Mu(h.j,h)}function An(h){Ns(h);var v=h.O;v&&typeof v.dispose=="function"&&v.dispose(),h.O=null,vl(h.V),h.g&&(v=h.g,h.g=null,v.abort(),v.dispose())}function Rs(h,v){try{var x=h.j;if(x.I!=0&&(x.g==h||Is(x.h,h))){if(!h.L&&Is(x.h,h)&&x.I==3){try{var C=x.Ba.g.parse(v)}catch{C=null}if(Array.isArray(C)&&C.length==3){var Y=C;if(Y[0]==0){e:if(!x.v){if(x.g)if(x.g.F+3e3<h.F)Ja(x),Bi(x);else break e;Wr(x),At(18)}}else x.xa=Y[1],0<x.xa-x.K&&Y[2]<37500&&x.F&&x.A==0&&!x.C&&(x.C=Es(m(x.Va,x),6e3));ks(x.h)<=1&&x.ta&&(x.ta=void 0)}else Ls(x,11)}else if((h.L||x.g==h)&&Ja(x),!j(v))for(Y=x.Ba.g.parse(v),v=0;v<Y.length;v++){let Ye=Y[v];const ht=Ye[0];if(!(ht<=x.K))if(x.K=ht,Ye=Ye[1],x.I==2)if(Ye[0]=="c"){x.M=Ye[1],x.ba=Ye[2];const qn=Ye[3];qn!=null&&(x.ka=qn,x.j.info("VER="+x.ka));const Us=Ye[4];Us!=null&&(x.za=Us,x.j.info("SVER="+x.za));const cs=Ye[5];cs!=null&&typeof cs=="number"&&cs>0&&(C=1.5*cs,x.O=C,x.j.info("backChannelRequestTimeoutMs_="+C)),C=x;const us=h.g;if(us){const Qr=us.g?us.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Qr){var ee=C.h;ee.g||Qr.indexOf("spdy")==-1&&Qr.indexOf("quic")==-1&&Qr.indexOf("h2")==-1||(ee.j=ee.l,ee.g=new Set,ee.h&&(Tl(ee,ee.h),ee.h=null))}if(C.G){const Xa=us.g?us.g.getResponseHeader("X-HTTP-Session-Id"):null;Xa&&(C.wa=Xa,Je(C.J,C.G,Xa))}}x.I=3,x.l&&x.l.ra(),x.aa&&(x.T=Date.now()-h.F,x.j.info("Handshake RTT: "+x.T+"ms")),C=x;var he=h;if(C.na=Vu(C,C.L?C.ba:null,C.W),he.L){El(C.h,he);var Oe=he,bt=C.O;bt&&(Oe.H=bt),Oe.D&&(Ns(Oe),Cs(Oe)),C.g=he}else Du(C);x.i.length>0&&Ms(x)}else Ye[0]!="stop"&&Ye[0]!="close"||Ls(x,7);else x.I==3&&(Ye[0]=="stop"||Ye[0]=="close"?Ye[0]=="stop"?Ls(x,7):jl(x):Ye[0]!="noop"&&x.l&&x.l.qa(Ye),x.A=0)}}xs(4)}catch{}}var Nt=class{constructor(h,v){this.g=h,this.map=v}};function wl(h){this.l=h||10,u.PerformanceNavigationTiming?(h=u.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function xl(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function ks(h){return h.h?1:h.g?h.g.size:0}function Is(h,v){return h.h?h.h==v:h.g?h.g.has(v):!1}function Tl(h,v){h.g?h.g.add(v):h.h=v}function El(h,v){h.h&&h.h==v?h.h=null:h.g&&h.g.has(v)&&h.g.delete(v)}wl.prototype.cancel=function(){if(this.i=Sl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Sl(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let v=h.i;for(const x of h.g.values())v=v.concat(x.G);return v}return S(h.i)}var Nu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function qa(h,v){if(h){h=h.split("&");for(let x=0;x<h.length;x++){const C=h[x].indexOf("=");let Y,ee=null;C>=0?(Y=h[x].substring(0,C),ee=h[x].substring(C+1)):Y=h[x],v(Y,ee?decodeURIComponent(ee.replace(/\+/g," ")):"")}}}function Cn(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let v;h instanceof Cn?(this.l=h.l,qt(this,h.j),this.o=h.o,this.g=h.g,ji(this,h.u),this.h=h.h,Al(this,Ou(h.i)),this.m=h.m):h&&(v=String(h).match(Nu))?(this.l=!1,qt(this,v[1]||"",!0),this.o=Os(v[2]||""),this.g=Os(v[3]||"",!0),ji(this,v[4]),this.h=Os(v[5]||"",!0),Al(this,v[6]||"",!0),this.m=Os(v[7]||"")):(this.l=!1,this.i=new Pi(null,this.l))}Cn.prototype.toString=function(){const h=[];var v=this.j;v&&h.push($r(v,Fa,!0),":");var x=this.g;return(x||v=="file")&&(h.push("//"),(v=this.o)&&h.push($r(v,Fa,!0),"@"),h.push(ei(x).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),x=this.u,x!=null&&h.push(":",String(x))),(x=this.h)&&(this.g&&x.charAt(0)!="/"&&h.push("/"),h.push($r(x,x.charAt(0)=="/"?Cl:Ru,!0))),(x=this.i.toString())&&h.push("?",x),(x=this.m)&&h.push("#",$r(x,ku)),h.join("")},Cn.prototype.resolve=function(h){const v=Rt(this);let x=!!h.j;x?qt(v,h.j):x=!!h.o,x?v.o=h.o:x=!!h.g,x?v.g=h.g:x=h.u!=null;var C=h.h;if(x)ji(v,h.u);else if(x=!!h.h){if(C.charAt(0)!="/")if(this.g&&!this.h)C="/"+C;else{var Y=v.h.lastIndexOf("/");Y!=-1&&(C=v.h.slice(0,Y+1)+C)}if(Y=C,Y==".."||Y==".")C="";else if(Y.indexOf("./")!=-1||Y.indexOf("/.")!=-1){C=Y.lastIndexOf("/",0)==0,Y=Y.split("/");const ee=[];for(let he=0;he<Y.length;){const Oe=Y[he++];Oe=="."?C&&he==Y.length&&ee.push(""):Oe==".."?((ee.length>1||ee.length==1&&ee[0]!="")&&ee.pop(),C&&he==Y.length&&ee.push("")):(ee.push(Oe),C=!0)}C=ee.join("/")}else C=Y}return x?v.h=C:x=h.i.toString()!=="",x?Al(v,Ou(h.i)):x=!!h.m,x&&(v.m=h.m),v};function Rt(h){return new Cn(h)}function qt(h,v,x){h.j=x?Os(v,!0):v,h.j&&(h.j=h.j.replace(/:$/,""))}function ji(h,v){if(v){if(v=Number(v),isNaN(v)||v<0)throw Error("Bad port number "+v);h.u=v}else h.u=null}function Al(h,v,x){v instanceof Pi?(h.i=v,Ka(h.i,h.l)):(x||(v=$r(v,Di)),h.i=new Pi(v,h.l))}function Je(h,v,x){h.i.set(v,x)}function Hr(h){return Je(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function Os(h,v){return h?v?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function $r(h,v,x){return typeof h=="string"?(h=encodeURI(h).replace(v,gn),x&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function gn(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Fa=/[#\/\?@]/g,Ru=/[#\?:]/g,Cl=/[#\?]/g,Di=/[#\?@]/g,ku=/#/g;function Pi(h,v){this.h=this.g=null,this.i=h||null,this.j=!!v}function mn(h){h.g||(h.g=new Map,h.h=0,h.i&&qa(h.i,function(v,x){h.add(decodeURIComponent(v.replace(/\+/g," ")),x)}))}n=Pi.prototype,n.add=function(h,v){mn(this),this.i=null,h=Mi(this,h);let x=this.g.get(h);return x||this.g.set(h,x=[]),x.push(v),this.h+=1,this};function Iu(h,v){mn(h),v=Mi(h,v),h.g.has(v)&&(h.i=null,h.h-=h.g.get(v).length,h.g.delete(v))}function Nl(h,v){return mn(h),v=Mi(h,v),h.g.has(v)}n.forEach=function(h,v){mn(this),this.g.forEach(function(x,C){x.forEach(function(Y){h.call(v,Y,C,this)},this)},this)};function Rl(h,v){mn(h);let x=[];if(typeof v=="string")Nl(h,v)&&(x=x.concat(h.g.get(Mi(h,v))));else for(h=Array.from(h.g.values()),v=0;v<h.length;v++)x=x.concat(h[v]);return x}n.set=function(h,v){return mn(this),this.i=null,h=Mi(this,h),Nl(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[v]),this.h+=1,this},n.get=function(h,v){return h?(h=Rl(this,h),h.length>0?String(h[0]):v):v};function Ga(h,v,x){Iu(h,v),x.length>0&&(h.i=null,h.g.set(Mi(h,v),S(x)),h.h+=x.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],v=Array.from(this.g.keys());for(let C=0;C<v.length;C++){var x=v[C];const Y=ei(x);x=Rl(this,x);for(let ee=0;ee<x.length;ee++){let he=Y;x[ee]!==""&&(he+="="+ei(x[ee])),h.push(he)}}return this.i=h.join("&")};function Ou(h){const v=new Pi;return v.i=h.i,h.g&&(v.g=new Map(h.g),v.h=h.h),v}function Mi(h,v){return v=String(v),h.j&&(v=v.toLowerCase()),v}function Ka(h,v){v&&!h.j&&(mn(h),h.i=null,h.g.forEach(function(x,C){const Y=C.toLowerCase();C!=Y&&(Iu(this,C),Ga(this,Y,x))},h)),h.j=v}function as(h,v){const x=new ss;if(u.Image){const C=new Image;C.onload=_(Hn,x,"TestLoadImage: loaded",!0,v,C),C.onerror=_(Hn,x,"TestLoadImage: error",!1,v,C),C.onabort=_(Hn,x,"TestLoadImage: abort",!1,v,C),C.ontimeout=_(Hn,x,"TestLoadImage: timeout",!1,v,C),u.setTimeout(function(){C.ontimeout&&C.ontimeout()},1e4),C.src=h}else v(!1)}function kl(h,v){const x=new ss,C=new AbortController,Y=setTimeout(()=>{C.abort(),Hn(x,"TestPingServer: timeout",!1,v)},1e4);fetch(h,{signal:C.signal}).then(ee=>{clearTimeout(Y),ee.ok?Hn(x,"TestPingServer: ok",!0,v):Hn(x,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(Y),Hn(x,"TestPingServer: error",!1,v)})}function Hn(h,v,x,C,Y){try{Y&&(Y.onload=null,Y.onerror=null,Y.onabort=null,Y.ontimeout=null),C(x)}catch{}}function Li(){this.g=new _u}function js(h){this.i=h.Sb||null,this.h=h.ab||!1}w(js,bu),js.prototype.g=function(){return new qr(this.i,this.h)};function qr(h,v){St.call(this),this.H=h,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}w(qr,St),n=qr.prototype,n.open=function(h,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=v,this.readyState=1,os(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const v={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(v.body=h),(this.H||u).fetch(new Request(this.D,v)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ui(this)),this.readyState=0},n.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,os(this)),this.g&&(this.readyState=3,os(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ya(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function Ya(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}n.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var v=h.value?h.value:new Uint8Array(0);(v=this.B.decode(v,{stream:!h.done}))&&(this.response=this.responseText+=v)}h.done?Ui(this):os(this),this.readyState==3&&Ya(this)}},n.Oa=function(h){this.g&&(this.response=this.responseText=h,Ui(this))},n.Na=function(h){this.g&&(this.response=h,Ui(this))},n.ga=function(){this.g&&Ui(this)};function Ui(h){h.readyState=4,h.l=null,h.j=null,h.B=null,os(h)}n.setRequestHeader=function(h,v){this.A.append(h,v)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],v=this.h.entries();for(var x=v.next();!x.done;)x=x.value,h.push(x[0]+": "+x[1]),x=v.next();return h.join(`\r
`)};function os(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(qr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function $n(h){let v="";return me(h,function(x,C){v+=C,v+=":",v+=x,v+=`\r
`}),v}function Fr(h,v,x){e:{for(C in x){var C=!1;break e}C=!0}C||(x=$n(x),typeof h=="string"?x!=null&&ei(x):Je(h,v,x))}function et(h){St.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}w(et,St);var Ds=/^https?$/i,Il=["POST","PUT"];n=et.prototype,n.Fa=function(h){this.H=h},n.ea=function(h,v,x,C){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);v=v?v.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():bl.g(),this.g.onreadystatechange=T(m(this.Ca,this));try{this.B=!0,this.g.open(v,String(h),!0),this.B=!1}catch(ee){Gr(this,ee);return}if(h=x||"",x=new Map(this.headers),C)if(Object.getPrototypeOf(C)===Object.prototype)for(var Y in C)x.set(Y,C[Y]);else if(typeof C.keys=="function"&&typeof C.get=="function")for(const ee of C.keys())x.set(ee,C.get(ee));else throw Error("Unknown input type for opt_headers: "+String(C));C=Array.from(x.keys()).find(ee=>ee.toLowerCase()=="content-type"),Y=u.FormData&&h instanceof u.FormData,!(Array.prototype.indexOf.call(Il,v,void 0)>=0)||C||Y||x.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ee,he]of x)this.g.setRequestHeader(ee,he);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(ee){Gr(this,ee)}};function Gr(h,v){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=v,h.o=5,Ol(h),ti(h)}function Ol(h){h.A||(h.A=!0,Ut(h,"complete"),Ut(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,Ut(this,"complete"),Ut(this,"abort"),ti(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ti(this,!0)),et.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Kr(this):this.Xa())},n.Xa=function(){Kr(this)};function Kr(h){if(h.h&&typeof l<"u"){if(h.v&&ls(h)==4)setTimeout(h.Ca.bind(h),0);else if(Ut(h,"readystatechange"),ls(h)==4){h.h=!1;try{const ee=h.ca();e:switch(ee){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var x;if(!(x=v)){var C;if(C=ee===0){let he=String(h.D).match(Nu)[1]||null;!he&&u.self&&u.self.location&&(he=u.self.location.protocol.slice(0,-1)),C=!Ds.test(he?he.toLowerCase():"")}x=C}if(x)Ut(h,"complete"),Ut(h,"success");else{h.o=6;try{var Y=ls(h)>2?h.g.statusText:""}catch{Y=""}h.l=Y+" ["+h.ca()+"]",Ol(h)}}finally{ti(h)}}}}function ti(h,v){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const x=h.g;h.g=null,v||Ut(h,"ready");try{x.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function ls(h){return h.g?h.g.readyState:0}n.ca=function(){try{return ls(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(h){if(this.g){var v=this.g.responseText;return h&&v.indexOf(h)==0&&(v=v.substring(h.length)),Sf(v)}};function Yt(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function ni(h){const v={};h=(h.g&&ls(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let C=0;C<h.length;C++){if(j(h[C]))continue;var x=Su(h[C]);const Y=x[0];if(x=x[1],typeof x!="string")continue;x=x.trim();const ee=v[Y]||[];v[Y]=ee,ee.push(x)}qe(v,function(C){return C.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ps(h,v,x){return x&&x.internalChannelParams&&x.internalChannelParams[h]||v}function Vi(h){this.za=0,this.i=[],this.j=new ss,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ps("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ps("baseRetryDelayMs",5e3,h),this.Za=Ps("retryDelaySeedMs",1e4,h),this.Ta=Ps("forwardChannelMaxRetries",2,h),this.va=Ps("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new wl(h&&h.concurrentRequestLimit),this.Ba=new Li,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Vi.prototype,n.ka=8,n.I=1,n.connect=function(h,v,x,C){At(0),this.W=h,this.H=v||{},x&&C!==void 0&&(this.H.OSID=x,this.H.OAID=C),this.F=this.X,this.J=Vu(this,null,this.W),Ms(this)};function jl(h){if(Wa(h),h.I==3){var v=h.V++,x=Rt(h.J);if(Je(x,"SID",h.M),Je(x,"RID",v),Je(x,"TYPE","terminate"),Yr(h,x),v=new is(h,h.j,v),v.M=2,v.A=Hr(Rt(x)),x=!1,u.navigator&&u.navigator.sendBeacon)try{x=u.navigator.sendBeacon(v.A.toString(),"")}catch{}!x&&u.Image&&(new Image().src=v.A,x=!0),x||(v.g=Bu(v.j,null),v.g.ea(v.A)),v.F=Date.now(),Cs(v)}Uu(h)}function Bi(h){h.g&&(Pl(h),h.g.cancel(),h.g=null)}function Wa(h){Bi(h),h.v&&(u.clearTimeout(h.v),h.v=null),Ja(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&u.clearTimeout(h.m),h.m=null)}function Ms(h){if(!xl(h.h)&&!h.m){h.m=!0;var v=h.Ea;q||A(),J||(q(),J=!0),R.add(v,h),h.D=0}}function Qa(h,v){return ks(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=v.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=Es(m(h.Ea,h,v),Lu(h,h.D)),h.D++,!0)}n.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const Y=new is(this,this.j,h);let ee=this.o;if(this.U&&(ee?(ee=B(ee),ue(ee,this.U)):ee=this.U),this.u!==null||this.R||(Y.J=ee,ee=null),this.S)e:{for(var v=0,x=0;x<this.i.length;x++){t:{var C=this.i[x];if("__data__"in C.map&&(C=C.map.__data__,typeof C=="string")){C=C.length;break t}C=void 0}if(C===void 0)break;if(v+=C,v>4096){v=x;break e}if(v===4096||x===this.i.length-1){v=x+1;break e}}v=1e3}else v=1e3;v=ju(this,Y,v),x=Rt(this.J),Je(x,"RID",h),Je(x,"CVER",22),this.G&&Je(x,"X-HTTP-Session-Id",this.G),Yr(this,x),ee&&(this.R?v="headers="+ei($n(ee))+"&"+v:this.u&&Fr(x,this.u,ee)),Tl(this.h,Y),this.Ra&&Je(x,"TYPE","init"),this.S?(Je(x,"$req",v),Je(x,"SID","null"),Y.U=!0,As(Y,x,null)):As(Y,x,v),this.I=2}}else this.I==3&&(h?Dl(this,h):this.i.length==0||xl(this.h)||Dl(this))};function Dl(h,v){var x;v?x=v.l:x=h.V++;const C=Rt(h.J);Je(C,"SID",h.M),Je(C,"RID",x),Je(C,"AID",h.K),Yr(h,C),h.u&&h.o&&Fr(C,h.u,h.o),x=new is(h,h.j,x,h.D+1),h.u===null&&(x.J=h.o),v&&(h.i=v.G.concat(h.i)),v=ju(h,x,1e3),x.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),Tl(h.h,x),As(x,C,v)}function Yr(h,v){h.H&&me(h.H,function(x,C){Je(v,C,x)}),h.l&&me({},function(x,C){Je(v,C,x)})}function ju(h,v,x){x=Math.min(h.i.length,x);const C=h.l?m(h.l.Ka,h.l,h):null;e:{var Y=h.i;let Oe=-1;for(;;){const bt=["count="+x];Oe==-1?x>0?(Oe=Y[0].g,bt.push("ofs="+Oe)):Oe=0:bt.push("ofs="+Oe);let Ye=!0;for(let ht=0;ht<x;ht++){var ee=Y[ht].g;const qn=Y[ht].map;if(ee-=Oe,ee<0)Oe=Math.max(0,Y[ht].g-100),Ye=!1;else try{ee="req"+ee+"_"||"";try{var he=qn instanceof Map?qn:Object.entries(qn);for(const[Us,cs]of he){let us=cs;d(cs)&&(us=Oi(cs)),bt.push(ee+Us+"="+encodeURIComponent(us))}}catch(Us){throw bt.push(ee+"type="+encodeURIComponent("_badmap")),Us}}catch{C&&C(qn)}}if(Ye){he=bt.join("&");break e}}he=void 0}return h=h.i.splice(0,x),v.G=h,he}function Du(h){if(!h.g&&!h.v){h.Y=1;var v=h.Da;q||A(),J||(q(),J=!0),R.add(v,h),h.A=0}}function Wr(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=Es(m(h.Da,h),Lu(h,h.A)),h.A++,!0)}n.Da=function(){if(this.v=null,Pu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=Es(m(this.Wa,this),h)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,At(10),Bi(this),Pu(this))};function Pl(h){h.B!=null&&(u.clearTimeout(h.B),h.B=null)}function Pu(h){h.g=new is(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var v=Rt(h.na);Je(v,"RID","rpc"),Je(v,"SID",h.M),Je(v,"AID",h.K),Je(v,"CI",h.F?"0":"1"),!h.F&&h.ia&&Je(v,"TO",h.ia),Je(v,"TYPE","xmlhttp"),Yr(h,v),h.u&&h.o&&Fr(v,h.u,h.o),h.O&&(h.g.H=h.O);var x=h.g;h=h.ba,x.M=1,x.A=Hr(Rt(v)),x.u=null,x.R=!0,Ha(x,h)}n.Va=function(){this.C!=null&&(this.C=null,Bi(this),Wr(this),At(19))};function Ja(h){h.C!=null&&(u.clearTimeout(h.C),h.C=null)}function Mu(h,v){var x=null;if(h.g==v){Ja(h),Pl(h),h.g=null;var C=2}else if(Is(h.h,v))x=v.G,El(h.h,v),C=1;else return;if(h.I!=0){if(v.o)if(C==1){x=v.u?v.u.length:0,v=Date.now()-v.F;var Y=h.D;C=za(),Ut(C,new Ts(C,x)),Ms(h)}else Du(h);else if(Y=v.m,Y==3||Y==0&&v.X>0||!(C==1&&Qa(h,v)||C==2&&Wr(h)))switch(x&&x.length>0&&(v=h.h,v.i=v.i.concat(x)),Y){case 1:Ls(h,5);break;case 4:Ls(h,10);break;case 3:Ls(h,6);break;default:Ls(h,2)}}}function Lu(h,v){let x=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(x*=2),x*v}function Ls(h,v){if(h.j.info("Error code "+v),v==2){var x=m(h.bb,h),C=h.Ua;const Y=!C;C=new Cn(C||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||qt(C,"https"),Hr(C),Y?as(C.toString(),x):kl(C.toString(),x)}else At(2);h.I=0,h.l&&h.l.pa(v),Uu(h),Wa(h)}n.bb=function(h){h?(this.j.info("Successfully pinged google.com"),At(2)):(this.j.info("Failed to ping google.com"),At(1))};function Uu(h){if(h.I=0,h.ja=[],h.l){const v=Sl(h.h);(v.length!=0||h.i.length!=0)&&(N(h.ja,v),N(h.ja,h.i),h.h.i.length=0,S(h.i),h.i.length=0),h.l.oa()}}function Vu(h,v,x){var C=x instanceof Cn?Rt(x):new Cn(x);if(C.g!="")v&&(C.g=v+"."+C.g),ji(C,C.u);else{var Y=u.location;C=Y.protocol,v=v?v+"."+Y.hostname:Y.hostname,Y=+Y.port;const ee=new Cn(null);C&&qt(ee,C),v&&(ee.g=v),Y&&ji(ee,Y),x&&(ee.h=x),C=ee}return x=h.G,v=h.wa,x&&v&&Je(C,x,v),Je(C,"VER",h.ka),Yr(h,C),C}function Bu(h,v,x){if(v&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return v=h.Aa&&!h.ma?new et(new js({ab:x})):new et(h.ma),v.Fa(h.L),v}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function zu(){}n=zu.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function zi(){}zi.prototype.g=function(h,v){return new dn(h,v)};function dn(h,v){St.call(this),this.g=new Vi(v),this.l=h,this.h=v&&v.messageUrlParams||null,h=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(h?h["X-WebChannel-Content-Type"]=v.messageContentType:h={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.sa&&(h?h["X-WebChannel-Client-Profile"]=v.sa:h={"X-WebChannel-Client-Profile":v.sa}),this.g.U=h,(h=v&&v.Qb)&&!j(h)&&(this.g.u=h),this.A=v&&v.supportsCrossDomainXhr||!1,this.v=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!j(v)&&(this.g.G=v,h=this.h,h!==null&&v in h&&(h=this.h,v in h&&delete h[v])),this.j=new si(this)}w(dn,St),dn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},dn.prototype.close=function(){jl(this.g)},dn.prototype.o=function(h){var v=this.g;if(typeof h=="string"){var x={};x.__data__=h,h=x}else this.v&&(x={},x.__data__=Oi(h),h=x);v.i.push(new Nt(v.Ya++,h)),v.I==3&&Ms(v)},dn.prototype.N=function(){this.g.l=null,delete this.j,jl(this.g),delete this.g,dn.Z.N.call(this)};function Hu(h){Kt.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var v=h.__sm__;if(v){e:{for(const x in v){h=x;break e}h=void 0}(this.i=h)&&(h=this.i,v=v!==null&&h in v?v[h]:void 0),this.data=v}else this.data=h}w(Hu,Kt);function $u(){Bn.call(this),this.status=1}w($u,Bn);function si(h){this.g=h}w(si,zu),si.prototype.ra=function(){Ut(this.g,"a")},si.prototype.qa=function(h){Ut(this.g,new Hu(h))},si.prototype.pa=function(h){Ut(this.g,new $u)},si.prototype.oa=function(){Ut(this.g,"b")},zi.prototype.createWebChannel=zi.prototype.g,dn.prototype.send=dn.prototype.o,dn.prototype.open=dn.prototype.m,dn.prototype.close=dn.prototype.close,EE=function(){return new zi},TE=function(){return za()},xE=_t,pm={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Br.NO_ERROR=0,Br.TIMEOUT=8,Br.HTTP_ERROR=6,dd=Br,_l.COMPLETE="complete",wE=_l,wu.EventType=ns,ns.OPEN="a",ns.CLOSE="b",ns.ERROR="c",ns.MESSAGE="d",St.prototype.listen=St.prototype.J,Sc=wu,et.prototype.listenOnce=et.prototype.K,et.prototype.getLastError=et.prototype.Ha,et.prototype.getLastErrorCode=et.prototype.ya,et.prototype.getStatus=et.prototype.ca,et.prototype.getResponseJson=et.prototype.La,et.prototype.getResponseText=et.prototype.la,et.prototype.send=et.prototype.ea,et.prototype.setWithCredentials=et.prototype.Fa,bE=et}).apply(typeof Yh<"u"?Yh:typeof self<"u"?self:typeof window<"u"?window:{});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}on.UNAUTHENTICATED=new on(null),on.GOOGLE_CREDENTIALS=new on("google-credentials-uid"),on.FIRST_PARTY=new on("first-party-uid"),on.MOCK_USER=new on("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ll="12.8.0";function xO(n){ll=n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ra=new Wd("@firebase/firestore");function Mo(){return Ra.logLevel}function pe(n,...e){if(Ra.logLevel<=Be.DEBUG){const t=e.map(a0);Ra.debug(`Firestore (${ll}): ${n}`,...t)}}function Ai(n,...e){if(Ra.logLevel<=Be.ERROR){const t=e.map(a0);Ra.error(`Firestore (${ll}): ${n}`,...t)}}function tl(n,...e){if(Ra.logLevel<=Be.WARN){const t=e.map(a0);Ra.warn(`Firestore (${ll}): ${n}`,...t)}}function a0(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ce(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,SE(n,i,t)}function SE(n,e,t){let i=`FIRESTORE (${ll}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw Ai(i),new Error(i)}function Qe(n,e,t,i){let a="Unexpected state";typeof t=="string"?a=t:i=t,n||SE(e,a,i)}function Ie(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ce={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ye extends ts{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ti{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AE{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class TO{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(on.UNAUTHENTICATED)))}shutdown(){}}class EO{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class SO{constructor(e){this.t=e,this.currentUser=on.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Qe(this.o===void 0,42304);let i=this.i;const a=g=>this.i!==i?(i=this.i,t(g)):Promise.resolve();let l=new Ti;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new Ti,e.enqueueRetryable((()=>a(this.currentUser)))};const u=()=>{const g=l;e.enqueueRetryable((async()=>{await g.promise,await a(this.currentUser)}))},d=g=>{pe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit((g=>d(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?d(g):(pe("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new Ti)}}),0),u()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(pe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Qe(typeof i.accessToken=="string",31837,{l:i}),new AE(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Qe(e===null||typeof e=="string",2055,{h:e}),new on(e)}}class AO{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=on.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class CO{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new AO(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(on.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class vw{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class NO{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Mn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Qe(this.o===void 0,3512);const i=l=>{l.error!=null&&pe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const u=l.token!==this.m;return this.m=l.token,pe("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>i(l)))};const a=l=>{pe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):pe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new vw(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Qe(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new vw(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RO(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const a=RO(40);for(let l=0;l<a.length;++l)i.length<20&&a[l]<t&&(i+=e.charAt(a[l]%62))}return i}}function ze(n,e){return n<e?-1:n>e?1:0}function gm(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const a=n.charAt(i),l=e.charAt(i);if(a!==l)return Vg(a)===Vg(l)?ze(a,l):Vg(a)?1:-1}return ze(n.length,e.length)}const kO=55296,IO=57343;function Vg(n){const e=n.charCodeAt(0);return e>=kO&&e<=IO}function nl(n,e,t){return n.length===e.length&&n.every(((i,a)=>t(i,e[a])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _w="__name__";class qs{constructor(e,t,i){t===void 0?t=0:t>e.length&&Ce(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Ce(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return qs.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof qs?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let a=0;a<i;a++){const l=qs.compareSegments(e.get(a),t.get(a));if(l!==0)return l}return ze(e.length,t.length)}static compareSegments(e,t){const i=qs.isNumericId(e),a=qs.isNumericId(t);return i&&!a?-1:!i&&a?1:i&&a?qs.extractNumericId(e).compare(qs.extractNumericId(t)):gm(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return xr.fromString(e.substring(4,e.length-2))}}class ct extends qs{construct(e,t,i){return new ct(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new ye(ce.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((a=>a.length>0)))}return new ct(t)}static emptyPath(){return new ct([])}}const OO=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class nn extends qs{construct(e,t,i){return new nn(e,t,i)}static isValidIdentifier(e){return OO.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),nn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===_w}static keyField(){return new nn([_w])}static fromServerFormat(e){const t=[];let i="",a=0;const l=()=>{if(i.length===0)throw new ye(ce.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let u=!1;for(;a<e.length;){const d=e[a];if(d==="\\"){if(a+1===e.length)throw new ye(ce.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[a+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new ye(ce.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=g,a+=2}else d==="`"?(u=!u,a++):d!=="."||u?(i+=d,a++):(l(),a++)}if(l(),u)throw new ye(ce.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new nn(t)}static emptyPath(){return new nn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{constructor(e){this.path=e}static fromPath(e){return new we(ct.fromString(e))}static fromName(e){return new we(ct.fromString(e).popFirst(5))}static empty(){return new we(ct.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ct.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ct.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new we(new ct(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CE(n,e,t){if(!t)throw new ye(ce.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function jO(n,e,t,i){if(e===!0&&i===!0)throw new ye(ce.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function bw(n){if(!we.isDocumentKey(n))throw new ye(ce.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function ww(n){if(we.isDocumentKey(n))throw new ye(ce.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function NE(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function l0(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ce(12329,{type:typeof n})}function Ci(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ye(ce.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=l0(n);throw new ye(ce.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mt(n,e){const t={typeString:n};return e&&(t.value=e),t}function uu(n,e){if(!NE(n))throw new ye(ce.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const a=e[i].typeString,l="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const u=n[i];if(a&&typeof u!==a){t=`JSON field '${i}' must be a ${a}.`;break}if(l!==void 0&&u!==l.value){t=`Expected '${i}' field to equal '${l.value}'`;break}}if(t)throw new ye(ce.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xw=-62135596800,Tw=1e6;class ut{static now(){return ut.fromMillis(Date.now())}static fromDate(e){return ut.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*Tw);return new ut(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ye(ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ye(ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<xw)throw new ye(ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ye(ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Tw}_compareTo(e){return this.seconds===e.seconds?ze(this.nanoseconds,e.nanoseconds):ze(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ut._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(uu(e,ut._jsonSchema))return new ut(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-xw;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ut._jsonSchemaVersion="firestore/timestamp/1.0",ut._jsonSchema={type:Mt("string",ut._jsonSchemaVersion),seconds:Mt("number"),nanoseconds:Mt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Re{static fromTimestamp(e){return new Re(e)}static min(){return new Re(new ut(0,0))}static max(){return new Re(new ut(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fc=-1;function DO(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,a=Re.fromTimestamp(i===1e9?new ut(t+1,0):new ut(t,i));return new Sr(a,we.empty(),e)}function PO(n){return new Sr(n.readTime,n.key,Fc)}class Sr{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Sr(Re.min(),we.empty(),Fc)}static max(){return new Sr(Re.max(),we.empty(),Fc)}}function MO(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=we.comparator(n.documentKey,e.documentKey),t!==0?t:ze(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LO="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class UO{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cl(n){if(n.code!==ce.FAILED_PRECONDITION||n.message!==LO)throw n;pe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ce(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new oe(((i,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(i,a)},this.catchCallback=l=>{this.wrapFailure(t,l).next(i,a)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof oe?t:oe.resolve(t)}catch(t){return oe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):oe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):oe.reject(t)}static resolve(e){return new oe(((t,i)=>{t(e)}))}static reject(e){return new oe(((t,i)=>{i(e)}))}static waitFor(e){return new oe(((t,i)=>{let a=0,l=0,u=!1;e.forEach((d=>{++a,d.next((()=>{++l,u&&l===a&&t()}),(g=>i(g)))})),u=!0,l===a&&t()}))}static or(e){let t=oe.resolve(!1);for(const i of e)t=t.next((a=>a?oe.resolve(a):i()));return t}static forEach(e,t){const i=[];return e.forEach(((a,l)=>{i.push(t.call(this,a,l))})),this.waitFor(i)}static mapArray(e,t){return new oe(((i,a)=>{const l=e.length,u=new Array(l);let d=0;for(let g=0;g<l;g++){const m=g;t(e[m]).next((_=>{u[m]=_,++d,d===l&&i(u)}),(_=>a(_)))}}))}static doWhile(e,t){return new oe(((i,a)=>{const l=()=>{e()===!0?t().next((()=>{l()}),a):i()};l()}))}}function VO(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function ul(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}nf.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c0=-1;function sf(n){return n==null}function Rd(n){return n===0&&1/n==-1/0}function BO(n){return typeof n=="number"&&Number.isInteger(n)&&!Rd(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RE="";function zO(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Ew(e)),e=HO(n.get(t),e);return Ew(e)}function HO(n,e){let t=e;const i=n.length;for(let a=0;a<i;a++){const l=n.charAt(a);switch(l){case"\0":t+="";break;case RE:t+="";break;default:t+=l}}return t}function Ew(n){return n+RE+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sw(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function jr(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function kE(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pt{constructor(e,t){this.comparator=e,this.root=t||tn.EMPTY}insert(e,t){return new pt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,tn.BLACK,null,null))}remove(e){return new pt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,tn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const a=this.comparator(e,i.key);if(a===0)return t+i.left.size;a<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Wh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Wh(this.root,e,this.comparator,!1)}getReverseIterator(){return new Wh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Wh(this.root,e,this.comparator,!0)}}class Wh{constructor(e,t,i,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?i(e.key,t):1,t&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class tn{constructor(e,t,i,a,l){this.key=e,this.value=t,this.color=i??tn.RED,this.left=a??tn.EMPTY,this.right=l??tn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,a,l){return new tn(e??this.key,t??this.value,i??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let a=this;const l=i(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,t,i),null):l===0?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,i)),a.fixUp()}removeMin(){if(this.left.isEmpty())return tn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),t(e,a.key)===0){if(a.right.isEmpty())return tn.EMPTY;i=a.right.min(),a=a.copy(i.key,i.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,tn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,tn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ce(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ce(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ce(27949);return e+(this.isRed()?0:1)}}tn.EMPTY=null,tn.RED=!0,tn.BLACK=!1;tn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ce(57766)}get value(){throw Ce(16141)}get color(){throw Ce(16727)}get left(){throw Ce(29726)}get right(){throw Ce(36894)}copy(e,t,i,a,l){return this}insert(e,t,i){return new tn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(e){this.comparator=e,this.data=new pt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const a=i.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Aw(this.data.getIterator())}getIteratorFrom(e){return new Aw(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Ht)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=i.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Ht(this.comparator);return t.data=e,t}}class Aw{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ln{constructor(e){this.fields=e,e.sort(nn.comparator)}static empty(){return new Ln([])}unionWith(e){let t=new Ht(nn.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Ln(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return nl(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IE extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new IE("Invalid base64 string: "+l):l}})(e);return new sn(t)}static fromUint8Array(e){const t=(function(a){let l="";for(let u=0;u<a.length;++u)l+=String.fromCharCode(a[u]);return l})(e);return new sn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let a=0;a<t.length;a++)i[a]=t.charCodeAt(a);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ze(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}sn.EMPTY_BYTE_STRING=new sn("");const $O=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ar(n){if(Qe(!!n,39018),typeof n=="string"){let e=0;const t=$O.exec(n);if(Qe(!!t,46558,{timestamp:n}),t[1]){let a=t[1];a=(a+"000000000").substr(0,9),e=Number(a)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Tt(n.seconds),nanos:Tt(n.nanos)}}function Tt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Cr(n){return typeof n=="string"?sn.fromBase64String(n):sn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OE="server_timestamp",jE="__type__",DE="__previous_value__",PE="__local_write_time__";function u0(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[jE])==null?void 0:i.stringValue)===OE}function rf(n){const e=n.mapValue.fields[DE];return u0(e)?rf(e):e}function Gc(n){const e=Ar(n.mapValue.fields[PE].timestampValue);return new ut(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qO{constructor(e,t,i,a,l,u,d,g,m,_,w){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=a,this.ssl=l,this.forceLongPolling=u,this.autoDetectLongPolling=d,this.longPollingOptions=g,this.useFetchStreams=m,this.isUsingEmulator=_,this.apiKey=w}}const kd="(default)";class Kc{constructor(e,t){this.projectId=e,this.database=t||kd}static empty(){return new Kc("","")}get isDefaultDatabase(){return this.database===kd}isEqual(e){return e instanceof Kc&&e.projectId===this.projectId&&e.database===this.database}}function FO(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new ye(ce.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Kc(n.options.projectId,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ME="__type__",GO="__max__",Qh={mapValue:{}},LE="__vector__",Id="value";function Nr(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?u0(n)?4:YO(n)?9007199254740991:KO(n)?10:11:Ce(28295,{value:n})}function Js(n,e){if(n===e)return!0;const t=Nr(n);if(t!==Nr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Gc(n).isEqual(Gc(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const u=Ar(a.timestampValue),d=Ar(l.timestampValue);return u.seconds===d.seconds&&u.nanos===d.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(a,l){return Cr(a.bytesValue).isEqual(Cr(l.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(a,l){return Tt(a.geoPointValue.latitude)===Tt(l.geoPointValue.latitude)&&Tt(a.geoPointValue.longitude)===Tt(l.geoPointValue.longitude)})(n,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return Tt(a.integerValue)===Tt(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const u=Tt(a.doubleValue),d=Tt(l.doubleValue);return u===d?Rd(u)===Rd(d):isNaN(u)&&isNaN(d)}return!1})(n,e);case 9:return nl(n.arrayValue.values||[],e.arrayValue.values||[],Js);case 10:case 11:return(function(a,l){const u=a.mapValue.fields||{},d=l.mapValue.fields||{};if(Sw(u)!==Sw(d))return!1;for(const g in u)if(u.hasOwnProperty(g)&&(d[g]===void 0||!Js(u[g],d[g])))return!1;return!0})(n,e);default:return Ce(52216,{left:n})}}function Yc(n,e){return(n.values||[]).find((t=>Js(t,e)))!==void 0}function sl(n,e){if(n===e)return 0;const t=Nr(n),i=Nr(e);if(t!==i)return ze(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return ze(n.booleanValue,e.booleanValue);case 2:return(function(l,u){const d=Tt(l.integerValue||l.doubleValue),g=Tt(u.integerValue||u.doubleValue);return d<g?-1:d>g?1:d===g?0:isNaN(d)?isNaN(g)?0:-1:1})(n,e);case 3:return Cw(n.timestampValue,e.timestampValue);case 4:return Cw(Gc(n),Gc(e));case 5:return gm(n.stringValue,e.stringValue);case 6:return(function(l,u){const d=Cr(l),g=Cr(u);return d.compareTo(g)})(n.bytesValue,e.bytesValue);case 7:return(function(l,u){const d=l.split("/"),g=u.split("/");for(let m=0;m<d.length&&m<g.length;m++){const _=ze(d[m],g[m]);if(_!==0)return _}return ze(d.length,g.length)})(n.referenceValue,e.referenceValue);case 8:return(function(l,u){const d=ze(Tt(l.latitude),Tt(u.latitude));return d!==0?d:ze(Tt(l.longitude),Tt(u.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Nw(n.arrayValue,e.arrayValue);case 10:return(function(l,u){var T,S,N,M;const d=l.fields||{},g=u.fields||{},m=(T=d[Id])==null?void 0:T.arrayValue,_=(S=g[Id])==null?void 0:S.arrayValue,w=ze(((N=m==null?void 0:m.values)==null?void 0:N.length)||0,((M=_==null?void 0:_.values)==null?void 0:M.length)||0);return w!==0?w:Nw(m,_)})(n.mapValue,e.mapValue);case 11:return(function(l,u){if(l===Qh.mapValue&&u===Qh.mapValue)return 0;if(l===Qh.mapValue)return 1;if(u===Qh.mapValue)return-1;const d=l.fields||{},g=Object.keys(d),m=u.fields||{},_=Object.keys(m);g.sort(),_.sort();for(let w=0;w<g.length&&w<_.length;++w){const T=gm(g[w],_[w]);if(T!==0)return T;const S=sl(d[g[w]],m[_[w]]);if(S!==0)return S}return ze(g.length,_.length)})(n.mapValue,e.mapValue);default:throw Ce(23264,{he:t})}}function Cw(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ze(n,e);const t=Ar(n),i=Ar(e),a=ze(t.seconds,i.seconds);return a!==0?a:ze(t.nanos,i.nanos)}function Nw(n,e){const t=n.values||[],i=e.values||[];for(let a=0;a<t.length&&a<i.length;++a){const l=sl(t[a],i[a]);if(l)return l}return ze(t.length,i.length)}function il(n){return mm(n)}function mm(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=Ar(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Cr(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return we.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",a=!0;for(const l of t.values||[])a?a=!1:i+=",",i+=mm(l);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let a="{",l=!0;for(const u of i)l?l=!1:a+=",",a+=`${u}:${mm(t.fields[u])}`;return a+"}"})(n.mapValue):Ce(61005,{value:n})}function fd(n){switch(Nr(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=rf(n);return e?16+fd(e):16;case 5:return 2*n.stringValue.length;case 6:return Cr(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((a,l)=>a+fd(l)),0)})(n.arrayValue);case 10:case 11:return(function(i){let a=0;return jr(i.fields,((l,u)=>{a+=l.length+fd(u)})),a})(n.mapValue);default:throw Ce(13486,{value:n})}}function ym(n){return!!n&&"integerValue"in n}function h0(n){return!!n&&"arrayValue"in n}function Rw(n){return!!n&&"nullValue"in n}function kw(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function pd(n){return!!n&&"mapValue"in n}function KO(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[ME])==null?void 0:i.stringValue)===LE}function jc(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return jr(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=jc(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=jc(n.arrayValue.values[t]);return e}return{...n}}function YO(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===GO}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tn{constructor(e){this.value=e}static empty(){return new Tn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!pd(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=jc(t)}setAll(e){let t=nn.emptyPath(),i={},a=[];e.forEach(((u,d)=>{if(!t.isImmediateParentOf(d)){const g=this.getFieldsMap(t);this.applyChanges(g,i,a),i={},a=[],t=d.popLast()}u?i[d.lastSegment()]=jc(u):a.push(d.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,i,a)}delete(e){const t=this.field(e.popLast());pd(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Js(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let a=t.mapValue.fields[e.get(i)];pd(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,i){jr(t,((a,l)=>e[a]=l));for(const a of i)delete e[a]}clone(){return new Tn(jc(this.value))}}function UE(n){const e=[];return jr(n.fields,((t,i)=>{const a=new nn([t]);if(pd(i)){const l=UE(i.mapValue).fields;if(l.length===0)e.push(a);else for(const u of l)e.push(a.child(u))}else e.push(a)})),new Ln(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(e,t,i,a,l,u,d){this.key=e,this.documentType=t,this.version=i,this.readTime=a,this.createTime=l,this.data=u,this.documentState=d}static newInvalidDocument(e){return new ln(e,0,Re.min(),Re.min(),Re.min(),Tn.empty(),0)}static newFoundDocument(e,t,i,a){return new ln(e,1,t,Re.min(),i,a,0)}static newNoDocument(e,t){return new ln(e,2,t,Re.min(),Re.min(),Tn.empty(),0)}static newUnknownDocument(e,t){return new ln(e,3,t,Re.min(),Re.min(),Tn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Re.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Tn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Tn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Re.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ln&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ln(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Od{constructor(e,t){this.position=e,this.inclusive=t}}function Iw(n,e,t){let i=0;for(let a=0;a<n.position.length;a++){const l=e[a],u=n.position[a];if(l.field.isKeyField()?i=we.comparator(we.fromName(u.referenceValue),t.key):i=sl(u,t.data.field(l.field)),l.dir==="desc"&&(i*=-1),i!==0)break}return i}function Ow(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Js(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jd{constructor(e,t="asc"){this.field=e,this.dir=t}}function WO(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VE{}class zt extends VE{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new JO(e,t,i):t==="array-contains"?new ej(e,i):t==="in"?new tj(e,i):t==="not-in"?new nj(e,i):t==="array-contains-any"?new sj(e,i):new zt(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new XO(e,i):new ZO(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(sl(t,this.value)):t!==null&&Nr(this.value)===Nr(t)&&this.matchesComparison(sl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ce(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Xs extends VE{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Xs(e,t)}matches(e){return BE(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function BE(n){return n.op==="and"}function zE(n){return QO(n)&&BE(n)}function QO(n){for(const e of n.filters)if(e instanceof Xs)return!1;return!0}function vm(n){if(n instanceof zt)return n.field.canonicalString()+n.op.toString()+il(n.value);if(zE(n))return n.filters.map((e=>vm(e))).join(",");{const e=n.filters.map((t=>vm(t))).join(",");return`${n.op}(${e})`}}function HE(n,e){return n instanceof zt?(function(i,a){return a instanceof zt&&i.op===a.op&&i.field.isEqual(a.field)&&Js(i.value,a.value)})(n,e):n instanceof Xs?(function(i,a){return a instanceof Xs&&i.op===a.op&&i.filters.length===a.filters.length?i.filters.reduce(((l,u,d)=>l&&HE(u,a.filters[d])),!0):!1})(n,e):void Ce(19439)}function $E(n){return n instanceof zt?(function(t){return`${t.field.canonicalString()} ${t.op} ${il(t.value)}`})(n):n instanceof Xs?(function(t){return t.op.toString()+" {"+t.getFilters().map($E).join(" ,")+"}"})(n):"Filter"}class JO extends zt{constructor(e,t,i){super(e,t,i),this.key=we.fromName(i.referenceValue)}matches(e){const t=we.comparator(e.key,this.key);return this.matchesComparison(t)}}class XO extends zt{constructor(e,t){super(e,"in",t),this.keys=qE("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class ZO extends zt{constructor(e,t){super(e,"not-in",t),this.keys=qE("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function qE(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((i=>we.fromName(i.referenceValue)))}class ej extends zt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return h0(t)&&Yc(t.arrayValue,this.value)}}class tj extends zt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Yc(this.value.arrayValue,t)}}class nj extends zt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Yc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Yc(this.value.arrayValue,t)}}class sj extends zt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!h0(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Yc(this.value.arrayValue,i)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ij{constructor(e,t=null,i=[],a=[],l=null,u=null,d=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=a,this.limit=l,this.startAt=u,this.endAt=d,this.Te=null}}function jw(n,e=null,t=[],i=[],a=null,l=null,u=null){return new ij(n,e,t,i,a,l,u)}function d0(n){const e=Ie(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>vm(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(l){return l.field.canonicalString()+l.dir})(i))).join(","),sf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>il(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>il(i))).join(",")),e.Te=t}return e.Te}function f0(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!WO(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!HE(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Ow(n.startAt,e.startAt)&&Ow(n.endAt,e.endAt)}function _m(n){return we.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class af{constructor(e,t=null,i=[],a=[],l=null,u="F",d=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=a,this.limit=l,this.limitType=u,this.startAt=d,this.endAt=g,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function rj(n,e,t,i,a,l,u,d){return new af(n,e,t,i,a,l,u,d)}function p0(n){return new af(n)}function Dw(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function aj(n){return we.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function oj(n){return n.collectionGroup!==null}function Dc(n){const e=Ie(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),t.add(l.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let d=new Ht(nn.comparator);return u.filters.forEach((g=>{g.getFlattenedFilters().forEach((m=>{m.isInequality()&&(d=d.add(m.field))}))})),d})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new jd(l,i))})),t.has(nn.keyField().canonicalString())||e.Ie.push(new jd(nn.keyField(),i))}return e.Ie}function Ks(n){const e=Ie(n);return e.Ee||(e.Ee=lj(e,Dc(n))),e.Ee}function lj(n,e){if(n.limitType==="F")return jw(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new jd(a.field,l)}));const t=n.endAt?new Od(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Od(n.startAt.position,n.startAt.inclusive):null;return jw(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function bm(n,e,t){return new af(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function of(n,e){return f0(Ks(n),Ks(e))&&n.limitType===e.limitType}function FE(n){return`${d0(Ks(n))}|lt:${n.limitType}`}function Lo(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((a=>$E(a))).join(", ")}]`),sf(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((a=>(function(u){return`${u.field.canonicalString()} (${u.dir})`})(a))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((a=>il(a))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((a=>il(a))).join(",")),`Target(${i})`})(Ks(n))}; limitType=${n.limitType})`}function lf(n,e){return e.isFoundDocument()&&(function(i,a){const l=a.key.path;return i.collectionGroup!==null?a.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(l):we.isDocumentKey(i.path)?i.path.isEqual(l):i.path.isImmediateParentOf(l)})(n,e)&&(function(i,a){for(const l of Dc(i))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(n,e)&&(function(i,a){for(const l of i.filters)if(!l.matches(a))return!1;return!0})(n,e)&&(function(i,a){return!(i.startAt&&!(function(u,d,g){const m=Iw(u,d,g);return u.inclusive?m<=0:m<0})(i.startAt,Dc(i),a)||i.endAt&&!(function(u,d,g){const m=Iw(u,d,g);return u.inclusive?m>=0:m>0})(i.endAt,Dc(i),a))})(n,e)}function cj(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function GE(n){return(e,t)=>{let i=!1;for(const a of Dc(n)){const l=uj(a,e,t);if(l!==0)return l;i=i||a.field.isKeyField()}return 0}}function uj(n,e,t){const i=n.field.isKeyField()?we.comparator(e.key,t.key):(function(l,u,d){const g=u.data.field(l),m=d.data.field(l);return g!==null&&m!==null?sl(g,m):Ce(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Ce(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ma{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[a,l]of i)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),a=this.inner[i];if(a===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return i.length===1?delete this.inner[t]:i.splice(a,1),this.innerSize--,!0;return!1}forEach(e){jr(this.inner,((t,i)=>{for(const[a,l]of i)e(a,l)}))}isEmpty(){return kE(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hj=new pt(we.comparator);function Ni(){return hj}const KE=new pt(we.comparator);function Ac(...n){let e=KE;for(const t of n)e=e.insert(t.key,t);return e}function YE(n){let e=KE;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function _a(){return Pc()}function WE(){return Pc()}function Pc(){return new Ma((n=>n.toString()),((n,e)=>n.isEqual(e)))}const dj=new pt(we.comparator),fj=new Ht(we.comparator);function He(...n){let e=fj;for(const t of n)e=e.add(t);return e}const pj=new Ht(ze);function gj(){return pj}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g0(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Rd(e)?"-0":e}}function QE(n){return{integerValue:""+n}}function mj(n,e){return BO(e)?QE(e):g0(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cf{constructor(){this._=void 0}}function yj(n,e,t){return n instanceof Dd?(function(a,l){const u={fields:{[jE]:{stringValue:OE},[PE]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&u0(l)&&(l=rf(l)),l&&(u.fields[DE]=l),{mapValue:u}})(t,e):n instanceof Wc?XE(n,e):n instanceof Qc?ZE(n,e):(function(a,l){const u=JE(a,l),d=Pw(u)+Pw(a.Ae);return ym(u)&&ym(a.Ae)?QE(d):g0(a.serializer,d)})(n,e)}function vj(n,e,t){return n instanceof Wc?XE(n,e):n instanceof Qc?ZE(n,e):t}function JE(n,e){return n instanceof Pd?(function(i){return ym(i)||(function(l){return!!l&&"doubleValue"in l})(i)})(e)?e:{integerValue:0}:null}class Dd extends cf{}class Wc extends cf{constructor(e){super(),this.elements=e}}function XE(n,e){const t=e1(e);for(const i of n.elements)t.some((a=>Js(a,i)))||t.push(i);return{arrayValue:{values:t}}}class Qc extends cf{constructor(e){super(),this.elements=e}}function ZE(n,e){let t=e1(e);for(const i of n.elements)t=t.filter((a=>!Js(a,i)));return{arrayValue:{values:t}}}class Pd extends cf{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Pw(n){return Tt(n.integerValue||n.doubleValue)}function e1(n){return h0(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function _j(n,e){return n.field.isEqual(e.field)&&(function(i,a){return i instanceof Wc&&a instanceof Wc||i instanceof Qc&&a instanceof Qc?nl(i.elements,a.elements,Js):i instanceof Pd&&a instanceof Pd?Js(i.Ae,a.Ae):i instanceof Dd&&a instanceof Dd})(n.transform,e.transform)}class bj{constructor(e,t){this.version=e,this.transformResults=t}}class Ys{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Ys}static exists(e){return new Ys(void 0,e)}static updateTime(e){return new Ys(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function gd(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class uf{}function t1(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new s1(n.key,Ys.none()):new hu(n.key,n.data,Ys.none());{const t=n.data,i=Tn.empty();let a=new Ht(nn.comparator);for(let l of e.fields)if(!a.has(l)){let u=t.field(l);u===null&&l.length>1&&(l=l.popLast(),u=t.field(l)),u===null?i.delete(l):i.set(l,u),a=a.add(l)}return new Dr(n.key,i,new Ln(a.toArray()),Ys.none())}}function wj(n,e,t){n instanceof hu?(function(a,l,u){const d=a.value.clone(),g=Lw(a.fieldTransforms,l,u.transformResults);d.setAll(g),l.convertToFoundDocument(u.version,d).setHasCommittedMutations()})(n,e,t):n instanceof Dr?(function(a,l,u){if(!gd(a.precondition,l))return void l.convertToUnknownDocument(u.version);const d=Lw(a.fieldTransforms,l,u.transformResults),g=l.data;g.setAll(n1(a)),g.setAll(d),l.convertToFoundDocument(u.version,g).setHasCommittedMutations()})(n,e,t):(function(a,l,u){l.convertToNoDocument(u.version).setHasCommittedMutations()})(0,e,t)}function Mc(n,e,t,i){return n instanceof hu?(function(l,u,d,g){if(!gd(l.precondition,u))return d;const m=l.value.clone(),_=Uw(l.fieldTransforms,g,u);return m.setAll(_),u.convertToFoundDocument(u.version,m).setHasLocalMutations(),null})(n,e,t,i):n instanceof Dr?(function(l,u,d,g){if(!gd(l.precondition,u))return d;const m=Uw(l.fieldTransforms,g,u),_=u.data;return _.setAll(n1(l)),_.setAll(m),u.convertToFoundDocument(u.version,_).setHasLocalMutations(),d===null?null:d.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((w=>w.field)))})(n,e,t,i):(function(l,u,d){return gd(l.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):d})(n,e,t)}function xj(n,e){let t=null;for(const i of n.fieldTransforms){const a=e.data.field(i.field),l=JE(i.transform,a||null);l!=null&&(t===null&&(t=Tn.empty()),t.set(i.field,l))}return t||null}function Mw(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,a){return i===void 0&&a===void 0||!(!i||!a)&&nl(i,a,((l,u)=>_j(l,u)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class hu extends uf{constructor(e,t,i,a=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class Dr extends uf{constructor(e,t,i,a,l=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function n1(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function Lw(n,e,t){const i=new Map;Qe(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let a=0;a<t.length;a++){const l=n[a],u=l.transform,d=e.data.field(l.field);i.set(l.field,vj(u,d,t[a]))}return i}function Uw(n,e,t){const i=new Map;for(const a of n){const l=a.transform,u=t.data.field(a.field);i.set(a.field,yj(l,u,e))}return i}class s1 extends uf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Tj extends uf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ej{constructor(e,t,i,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=a}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&wj(l,e,i[a])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=Mc(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=Mc(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=WE();return this.mutations.forEach((a=>{const l=e.get(a.key),u=l.overlayedDocument;let d=this.applyToLocalView(u,l.mutatedFields);d=t.has(a.key)?null:d;const g=t1(u,d);g!==null&&i.set(a.key,g),u.isValidDocument()||u.convertToNoDocument(Re.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),He())}isEqual(e){return this.batchId===e.batchId&&nl(this.mutations,e.mutations,((t,i)=>Mw(t,i)))&&nl(this.baseMutations,e.baseMutations,((t,i)=>Mw(t,i)))}}class m0{constructor(e,t,i,a){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=a}static from(e,t,i){Qe(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let a=(function(){return dj})();const l=e.mutations;for(let u=0;u<l.length;u++)a=a.insert(l[u].key,i[u].version);return new m0(e,t,i,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sj{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aj{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Dt,Fe;function Cj(n){switch(n){case ce.OK:return Ce(64938);case ce.CANCELLED:case ce.UNKNOWN:case ce.DEADLINE_EXCEEDED:case ce.RESOURCE_EXHAUSTED:case ce.INTERNAL:case ce.UNAVAILABLE:case ce.UNAUTHENTICATED:return!1;case ce.INVALID_ARGUMENT:case ce.NOT_FOUND:case ce.ALREADY_EXISTS:case ce.PERMISSION_DENIED:case ce.FAILED_PRECONDITION:case ce.ABORTED:case ce.OUT_OF_RANGE:case ce.UNIMPLEMENTED:case ce.DATA_LOSS:return!0;default:return Ce(15467,{code:n})}}function i1(n){if(n===void 0)return Ai("GRPC error has no .code"),ce.UNKNOWN;switch(n){case Dt.OK:return ce.OK;case Dt.CANCELLED:return ce.CANCELLED;case Dt.UNKNOWN:return ce.UNKNOWN;case Dt.DEADLINE_EXCEEDED:return ce.DEADLINE_EXCEEDED;case Dt.RESOURCE_EXHAUSTED:return ce.RESOURCE_EXHAUSTED;case Dt.INTERNAL:return ce.INTERNAL;case Dt.UNAVAILABLE:return ce.UNAVAILABLE;case Dt.UNAUTHENTICATED:return ce.UNAUTHENTICATED;case Dt.INVALID_ARGUMENT:return ce.INVALID_ARGUMENT;case Dt.NOT_FOUND:return ce.NOT_FOUND;case Dt.ALREADY_EXISTS:return ce.ALREADY_EXISTS;case Dt.PERMISSION_DENIED:return ce.PERMISSION_DENIED;case Dt.FAILED_PRECONDITION:return ce.FAILED_PRECONDITION;case Dt.ABORTED:return ce.ABORTED;case Dt.OUT_OF_RANGE:return ce.OUT_OF_RANGE;case Dt.UNIMPLEMENTED:return ce.UNIMPLEMENTED;case Dt.DATA_LOSS:return ce.DATA_LOSS;default:return Ce(39323,{code:n})}}(Fe=Dt||(Dt={}))[Fe.OK=0]="OK",Fe[Fe.CANCELLED=1]="CANCELLED",Fe[Fe.UNKNOWN=2]="UNKNOWN",Fe[Fe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Fe[Fe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Fe[Fe.NOT_FOUND=5]="NOT_FOUND",Fe[Fe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Fe[Fe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Fe[Fe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Fe[Fe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Fe[Fe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Fe[Fe.ABORTED=10]="ABORTED",Fe[Fe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Fe[Fe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Fe[Fe.INTERNAL=13]="INTERNAL",Fe[Fe.UNAVAILABLE=14]="UNAVAILABLE",Fe[Fe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nj(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rj=new xr([4294967295,4294967295],0);function Vw(n){const e=Nj().encode(n),t=new _E;return t.update(e),new Uint8Array(t.digest())}function Bw(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new xr([t,i],0),new xr([a,l],0)]}class y0{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new Cc(`Invalid padding: ${t}`);if(i<0)throw new Cc(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Cc(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new Cc(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=xr.fromNumber(this.ge)}ye(e,t,i){let a=e.add(t.multiply(xr.fromNumber(i)));return a.compare(Rj)===1&&(a=new xr([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Vw(e),[i,a]=Bw(t);for(let l=0;l<this.hashCount;l++){const u=this.ye(i,a,l);if(!this.we(u))return!1}return!0}static create(e,t,i){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),u=new y0(l,a,t);return i.forEach((d=>u.insert(d))),u}insert(e){if(this.ge===0)return;const t=Vw(e),[i,a]=Bw(t);for(let l=0;l<this.hashCount;l++){const u=this.ye(i,a,l);this.be(u)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class Cc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hf{constructor(e,t,i,a,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const a=new Map;return a.set(e,du.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new hf(Re.min(),a,new pt(ze),Ni(),He())}}class du{constructor(e,t,i,a,l){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new du(i,t,He(),He(),He())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class md{constructor(e,t,i,a){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=a}}class r1{constructor(e,t){this.targetId=e,this.Ce=t}}class a1{constructor(e,t,i=sn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=a}}class zw{constructor(){this.ve=0,this.Fe=Hw(),this.Me=sn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=He(),t=He(),i=He();return this.Fe.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:i=i.add(a);break;default:Ce(38017,{changeType:l})}})),new du(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=Hw()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Qe(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class kj{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ni(),this.He=Jh(),this.Je=Jh(),this.Ze=new pt(ze)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:Ce(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,a)=>{this.rt(a)&&t(a)}))}st(e){const t=e.targetId,i=e.Ce.count,a=this.ot(t);if(a){const l=a.target;if(_m(l))if(i===0){const u=new we(l.path);this.et(t,u,ln.newNoDocument(u,Re.min()))}else Qe(i===1,20013,{expectedCount:i});else{const u=this._t(t);if(u!==i){const d=this.ut(e),g=d?this.ct(d,e,u):1;if(g!==0){this.it(t);const m=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,m)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:a=0},hashCount:l=0}=t;let u,d;try{u=Cr(i).toUint8Array()}catch(g){if(g instanceof IE)return tl("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{d=new y0(u,a,l)}catch(g){return tl(g instanceof Cc?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return d.ge===0?null:d}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let a=0;return i.forEach((l=>{const u=this.Ge.ht(),d=`projects/${u.projectId}/databases/${u.database}/documents/${l.path.canonicalString()}`;e.mightContain(d)||(this.et(t,l,null),a++)})),a}Tt(e){const t=new Map;this.ze.forEach(((l,u)=>{const d=this.ot(u);if(d){if(l.current&&_m(d.target)){const g=new we(d.target.path);this.It(g).has(u)||this.Et(u,g)||this.et(u,g,ln.newNoDocument(g,e))}l.Be&&(t.set(u,l.ke()),l.Ke())}}));let i=He();this.Je.forEach(((l,u)=>{let d=!0;u.forEachWhile((g=>{const m=this.ot(g);return!m||m.purpose==="TargetPurposeLimboResolution"||(d=!1,!1)})),d&&(i=i.add(l))})),this.je.forEach(((l,u)=>u.setReadTime(e)));const a=new hf(e,t,this.Ze,this.je,i);return this.je=Ni(),this.He=Jh(),this.Je=Jh(),this.Ze=new pt(ze),a}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,t)?a.qe(t,1):a.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new zw,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Ht(ze),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Ht(ze),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||pe("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new zw),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Jh(){return new pt(we.comparator)}function Hw(){return new pt(we.comparator)}const Ij={asc:"ASCENDING",desc:"DESCENDING"},Oj={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},jj={and:"AND",or:"OR"};class Dj{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function wm(n,e){return n.useProto3Json||sf(e)?e:{value:e}}function Md(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function o1(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Pj(n,e){return Md(n,e.toTimestamp())}function Ws(n){return Qe(!!n,49232),Re.fromTimestamp((function(t){const i=Ar(t);return new ut(i.seconds,i.nanos)})(n))}function v0(n,e){return xm(n,e).canonicalString()}function xm(n,e){const t=(function(a){return new ct(["projects",a.projectId,"databases",a.database])})(n).child("documents");return e===void 0?t:t.child(e)}function l1(n){const e=ct.fromString(n);return Qe(f1(e),10190,{key:e.toString()}),e}function Tm(n,e){return v0(n.databaseId,e.path)}function Bg(n,e){const t=l1(e);if(t.get(1)!==n.databaseId.projectId)throw new ye(ce.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ye(ce.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new we(u1(t))}function c1(n,e){return v0(n.databaseId,e)}function Mj(n){const e=l1(n);return e.length===4?ct.emptyPath():u1(e)}function Em(n){return new ct(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function u1(n){return Qe(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function $w(n,e,t){return{name:Tm(n,e),fields:t.value.mapValue.fields}}function Lj(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:Ce(39313,{state:m})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(m,_){return m.useProto3Json?(Qe(_===void 0||typeof _=="string",58123),sn.fromBase64String(_||"")):(Qe(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),sn.fromUint8Array(_||new Uint8Array))})(n,e.targetChange.resumeToken),u=e.targetChange.cause,d=u&&(function(m){const _=m.code===void 0?ce.UNKNOWN:i1(m.code);return new ye(_,m.message||"")})(u);t=new a1(i,a,l,d||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const a=Bg(n,i.document.name),l=Ws(i.document.updateTime),u=i.document.createTime?Ws(i.document.createTime):Re.min(),d=new Tn({mapValue:{fields:i.document.fields}}),g=ln.newFoundDocument(a,l,u,d),m=i.targetIds||[],_=i.removedTargetIds||[];t=new md(m,_,g.key,g)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const a=Bg(n,i.document),l=i.readTime?Ws(i.readTime):Re.min(),u=ln.newNoDocument(a,l),d=i.removedTargetIds||[];t=new md([],d,u.key,u)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const a=Bg(n,i.document),l=i.removedTargetIds||[];t=new md([],l,a,null)}else{if(!("filter"in e))return Ce(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:a=0,unchangedNames:l}=i,u=new Aj(a,l),d=i.targetId;t=new r1(d,u)}}return t}function Uj(n,e){let t;if(e instanceof hu)t={update:$w(n,e.key,e.value)};else if(e instanceof s1)t={delete:Tm(n,e.key)};else if(e instanceof Dr)t={update:$w(n,e.key,e.data),updateMask:Kj(e.fieldMask)};else{if(!(e instanceof Tj))return Ce(16599,{dt:e.type});t={verify:Tm(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(l,u){const d=u.transform;if(d instanceof Dd)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(d instanceof Wc)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:d.elements}};if(d instanceof Qc)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:d.elements}};if(d instanceof Pd)return{fieldPath:u.field.canonicalString(),increment:d.Ae};throw Ce(20930,{transform:u.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:Pj(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:Ce(27497)})(n,e.precondition)),t}function Vj(n,e){return n&&n.length>0?(Qe(e!==void 0,14353),n.map((t=>(function(a,l){let u=a.updateTime?Ws(a.updateTime):Ws(l);return u.isEqual(Re.min())&&(u=Ws(l)),new bj(u,a.transformResults||[])})(t,e)))):[]}function Bj(n,e){return{documents:[c1(n,e.path)]}}function zj(n,e){const t={structuredQuery:{}},i=e.path;let a;e.collectionGroup!==null?(a=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=c1(n,a);const l=(function(m){if(m.length!==0)return d1(Xs.create(m,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const u=(function(m){if(m.length!==0)return m.map((_=>(function(T){return{field:Uo(T.field),direction:qj(T.dir)}})(_)))})(e.orderBy);u&&(t.structuredQuery.orderBy=u);const d=wm(n,e.limit);return d!==null&&(t.structuredQuery.limit=d),e.startAt&&(t.structuredQuery.startAt=(function(m){return{before:m.inclusive,values:m.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(m){return{before:!m.inclusive,values:m.position}})(e.endAt)),{ft:t,parent:a}}function Hj(n){let e=Mj(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let a=null;if(i>0){Qe(i===1,65062);const _=t.from[0];_.allDescendants?a=_.collectionId:e=e.child(_.collectionId)}let l=[];t.where&&(l=(function(w){const T=h1(w);return T instanceof Xs&&zE(T)?T.getFilters():[T]})(t.where));let u=[];t.orderBy&&(u=(function(w){return w.map((T=>(function(N){return new jd(Vo(N.field),(function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(N.direction))})(T)))})(t.orderBy));let d=null;t.limit&&(d=(function(w){let T;return T=typeof w=="object"?w.value:w,sf(T)?null:T})(t.limit));let g=null;t.startAt&&(g=(function(w){const T=!!w.before,S=w.values||[];return new Od(S,T)})(t.startAt));let m=null;return t.endAt&&(m=(function(w){const T=!w.before,S=w.values||[];return new Od(S,T)})(t.endAt)),rj(e,a,u,l,d,"F",g,m)}function $j(n,e){const t=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ce(28987,{purpose:a})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function h1(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Vo(t.unaryFilter.field);return zt.create(i,"==",{doubleValue:NaN});case"IS_NULL":const a=Vo(t.unaryFilter.field);return zt.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=Vo(t.unaryFilter.field);return zt.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=Vo(t.unaryFilter.field);return zt.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ce(61313);default:return Ce(60726)}})(n):n.fieldFilter!==void 0?(function(t){return zt.create(Vo(t.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ce(58110);default:return Ce(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Xs.create(t.compositeFilter.filters.map((i=>h1(i))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return Ce(1026)}})(t.compositeFilter.op))})(n):Ce(30097,{filter:n})}function qj(n){return Ij[n]}function Fj(n){return Oj[n]}function Gj(n){return jj[n]}function Uo(n){return{fieldPath:n.canonicalString()}}function Vo(n){return nn.fromServerFormat(n.fieldPath)}function d1(n){return n instanceof zt?(function(t){if(t.op==="=="){if(kw(t.value))return{unaryFilter:{field:Uo(t.field),op:"IS_NAN"}};if(Rw(t.value))return{unaryFilter:{field:Uo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(kw(t.value))return{unaryFilter:{field:Uo(t.field),op:"IS_NOT_NAN"}};if(Rw(t.value))return{unaryFilter:{field:Uo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Uo(t.field),op:Fj(t.op),value:t.value}}})(n):n instanceof Xs?(function(t){const i=t.getFilters().map((a=>d1(a)));return i.length===1?i[0]:{compositeFilter:{op:Gj(t.op),filters:i}}})(n):Ce(54877,{filter:n})}function Kj(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function f1(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function p1(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vr{constructor(e,t,i,a,l=Re.min(),u=Re.min(),d=sn.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=d,this.expectedCount=g}withSequenceNumber(e){return new vr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new vr(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new vr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new vr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yj{constructor(e){this.yt=e}}function Wj(n){const e=Hj({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?bm(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qj{constructor(){this.Sn=new Jj}addToCollectionParentIndex(e,t){return this.Sn.add(t),oe.resolve()}getCollectionParents(e,t){return oe.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return oe.resolve()}deleteFieldIndex(e,t){return oe.resolve()}deleteAllFieldIndexes(e){return oe.resolve()}createTargetIndexes(e,t){return oe.resolve()}getDocumentsMatchingTarget(e,t){return oe.resolve(null)}getIndexType(e,t){return oe.resolve(0)}getFieldIndexes(e,t){return oe.resolve([])}getNextCollectionGroupToUpdate(e){return oe.resolve(null)}getMinOffset(e,t){return oe.resolve(Sr.min())}getMinOffsetFromCollectionGroup(e,t){return oe.resolve(Sr.min())}updateCollectionGroup(e,t,i){return oe.resolve()}updateIndexEntries(e,t){return oe.resolve()}}class Jj{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),a=this.index[t]||new Ht(ct.comparator),l=!a.has(i);return this.index[t]=a.add(i),l}has(e){const t=e.lastSegment(),i=e.popLast(),a=this.index[t];return a&&a.has(i)}getEntries(e){return(this.index[e]||new Ht(ct.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},g1=41943040;class xn{static withCacheSize(e){return new xn(e,xn.DEFAULT_COLLECTION_PERCENTILE,xn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */xn.DEFAULT_COLLECTION_PERCENTILE=10,xn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,xn.DEFAULT=new xn(g1,xn.DEFAULT_COLLECTION_PERCENTILE,xn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),xn.DISABLED=new xn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new rl(0)}static ar(){return new rl(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fw="LruGarbageCollector",Xj=1048576;function Gw([n,e],[t,i]){const a=ze(n,t);return a===0?ze(e,i):a}class Zj{constructor(e){this.Pr=e,this.buffer=new Ht(Gw),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();Gw(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class e4{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){pe(Fw,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ul(t)?pe(Fw,"Ignoring IndexedDB error during garbage collection: ",t):await cl(t)}await this.Ar(3e5)}))}}class t4{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return oe.resolve(nf.ce);const i=new Zj(t);return this.Vr.forEachTarget(e,(a=>i.Er(a.sequenceNumber))).next((()=>this.Vr.mr(e,(a=>i.Er(a))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(pe("LruGarbageCollector","Garbage collection skipped; disabled"),oe.resolve(qw)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(pe("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),qw):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,a,l,u,d,g,m;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((w=>(w>this.params.maximumSequenceNumbersToCollect?(pe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${w}`),a=this.params.maximumSequenceNumbersToCollect):a=w,u=Date.now(),this.nthSequenceNumber(e,a)))).next((w=>(i=w,d=Date.now(),this.removeTargets(e,i,t)))).next((w=>(l=w,g=Date.now(),this.removeOrphanedDocuments(e,i)))).next((w=>(m=Date.now(),Mo()<=Be.DEBUG&&pe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-_}ms
	Determined least recently used ${a} in `+(d-u)+`ms
	Removed ${l} targets in `+(g-d)+`ms
	Removed ${w} documents in `+(m-g)+`ms
Total Duration: ${m-_}ms`),oe.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:w}))))}}function n4(n,e){return new t4(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s4{constructor(){this.changes=new Ma((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ln.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?oe.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i4{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r4{constructor(e,t,i,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=a}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((a=>(i=a,this.remoteDocumentCache.getEntry(e,t)))).next((a=>(i!==null&&Mc(i.mutation,a,Ln.empty(),ut.now()),a)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,He()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=He()){const a=_a();return this.populateOverlays(e,a,t).next((()=>this.computeViews(e,t,a,i).next((l=>{let u=Ac();return l.forEach(((d,g)=>{u=u.insert(d,g.overlayedDocument)})),u}))))}getOverlayedDocuments(e,t){const i=_a();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,He())))}populateOverlays(e,t,i){const a=[];return i.forEach((l=>{t.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((u,d)=>{t.set(u,d)}))}))}computeViews(e,t,i,a){let l=Ni();const u=Pc(),d=(function(){return Pc()})();return t.forEach(((g,m)=>{const _=i.get(m.key);a.has(m.key)&&(_===void 0||_.mutation instanceof Dr)?l=l.insert(m.key,m):_!==void 0?(u.set(m.key,_.mutation.getFieldMask()),Mc(_.mutation,m,_.mutation.getFieldMask(),ut.now())):u.set(m.key,Ln.empty())})),this.recalculateAndSaveOverlays(e,l).next((g=>(g.forEach(((m,_)=>u.set(m,_))),t.forEach(((m,_)=>d.set(m,new i4(_,u.get(m)??null)))),d)))}recalculateAndSaveOverlays(e,t){const i=Pc();let a=new pt(((u,d)=>u-d)),l=He();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((u=>{for(const d of u)d.keys().forEach((g=>{const m=t.get(g);if(m===null)return;let _=i.get(g)||Ln.empty();_=d.applyToLocalView(m,_),i.set(g,_);const w=(a.get(d.batchId)||He()).add(g);a=a.insert(d.batchId,w)}))})).next((()=>{const u=[],d=a.getReverseIterator();for(;d.hasNext();){const g=d.getNext(),m=g.key,_=g.value,w=WE();_.forEach((T=>{if(!l.has(T)){const S=t1(t.get(T),i.get(T));S!==null&&w.set(T,S),l=l.add(T)}})),u.push(this.documentOverlayCache.saveOverlays(e,m,w))}return oe.waitFor(u)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,a){return aj(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):oj(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,a):this.getDocumentsMatchingCollectionQuery(e,t,i,a)}getNextDocuments(e,t,i,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,a).next((l=>{const u=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,a-l.size):oe.resolve(_a());let d=Fc,g=l;return u.next((m=>oe.forEach(m,((_,w)=>(d<w.largestBatchId&&(d=w.largestBatchId),l.get(_)?oe.resolve():this.remoteDocumentCache.getEntry(e,_).next((T=>{g=g.insert(_,T)}))))).next((()=>this.populateOverlays(e,m,l))).next((()=>this.computeViews(e,g,m,He()))).next((_=>({batchId:d,changes:YE(_)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new we(t)).next((i=>{let a=Ac();return i.isFoundDocument()&&(a=a.insert(i.key,i)),a}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,a){const l=t.collectionGroup;let u=Ac();return this.indexManager.getCollectionParents(e,l).next((d=>oe.forEach(d,(g=>{const m=(function(w,T){return new af(T,null,w.explicitOrderBy.slice(),w.filters.slice(),w.limit,w.limitType,w.startAt,w.endAt)})(t,g.child(l));return this.getDocumentsMatchingCollectionQuery(e,m,i,a).next((_=>{_.forEach(((w,T)=>{u=u.insert(w,T)}))}))})).next((()=>u))))}getDocumentsMatchingCollectionQuery(e,t,i,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((u=>(l=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,l,a)))).next((u=>{l.forEach(((g,m)=>{const _=m.getKey();u.get(_)===null&&(u=u.insert(_,ln.newInvalidDocument(_)))}));let d=Ac();return u.forEach(((g,m)=>{const _=l.get(g);_!==void 0&&Mc(_.mutation,m,Ln.empty(),ut.now()),lf(t,m)&&(d=d.insert(g,m))})),d}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a4{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return oe.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(a){return{id:a.id,version:a.version,createTime:Ws(a.createTime)}})(t)),oe.resolve()}getNamedQuery(e,t){return oe.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(a){return{name:a.name,query:Wj(a.bundledQuery),readTime:Ws(a.readTime)}})(t)),oe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o4{constructor(){this.overlays=new pt(we.comparator),this.Lr=new Map}getOverlay(e,t){return oe.resolve(this.overlays.get(t))}getOverlays(e,t){const i=_a();return oe.forEach(t,(a=>this.getOverlay(e,a).next((l=>{l!==null&&i.set(a,l)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((a,l)=>{this.bt(e,t,l)})),oe.resolve()}removeOverlaysForBatchId(e,t,i){const a=this.Lr.get(i);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.Lr.delete(i)),oe.resolve()}getOverlaysForCollection(e,t,i){const a=_a(),l=t.length+1,u=new we(t.child("")),d=this.overlays.getIteratorFrom(u);for(;d.hasNext();){const g=d.getNext().value,m=g.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===l&&g.largestBatchId>i&&a.set(g.getKey(),g)}return oe.resolve(a)}getOverlaysForCollectionGroup(e,t,i,a){let l=new pt(((m,_)=>m-_));const u=this.overlays.getIterator();for(;u.hasNext();){const m=u.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>i){let _=l.get(m.largestBatchId);_===null&&(_=_a(),l=l.insert(m.largestBatchId,_)),_.set(m.getKey(),m)}}const d=_a(),g=l.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((m,_)=>d.set(m,_))),!(d.size()>=a)););return oe.resolve(d)}bt(e,t,i){const a=this.overlays.get(i.key);if(a!==null){const u=this.Lr.get(a.largestBatchId).delete(i.key);this.Lr.set(a.largestBatchId,u)}this.overlays=this.overlays.insert(i.key,new Sj(t,i));let l=this.Lr.get(t);l===void 0&&(l=He(),this.Lr.set(t,l)),this.Lr.set(t,l.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l4{constructor(){this.sessionToken=sn.EMPTY_BYTE_STRING}getSessionToken(e){return oe.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,oe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _0{constructor(){this.kr=new Ht(Gt.Kr),this.qr=new Ht(Gt.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new Gt(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new Gt(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new we(new ct([])),i=new Gt(t,e),a=new Gt(t,e+1),l=[];return this.qr.forEachInRange([i,a],(u=>{this.Wr(u),l.push(u.key)})),l}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new we(new ct([])),i=new Gt(t,e),a=new Gt(t,e+1);let l=He();return this.qr.forEachInRange([i,a],(u=>{l=l.add(u.key)})),l}containsKey(e){const t=new Gt(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Gt{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return we.comparator(e.key,t.key)||ze(e.Hr,t.Hr)}static Ur(e,t){return ze(e.Hr,t.Hr)||we.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c4{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Ht(Gt.Kr)}checkEmpty(e){return oe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,a){const l=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new Ej(l,t,i,a);this.mutationQueue.push(u);for(const d of a)this.Jr=this.Jr.add(new Gt(d.key,l)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return oe.resolve(u)}lookupMutationBatch(e,t){return oe.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,a=this.Xr(i),l=a<0?0:a;return oe.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return oe.resolve(this.mutationQueue.length===0?c0:this.Yn-1)}getAllMutationBatches(e){return oe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Gt(t,0),a=new Gt(t,Number.POSITIVE_INFINITY),l=[];return this.Jr.forEachInRange([i,a],(u=>{const d=this.Zr(u.Hr);l.push(d)})),oe.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Ht(ze);return t.forEach((a=>{const l=new Gt(a,0),u=new Gt(a,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([l,u],(d=>{i=i.add(d.Hr)}))})),oe.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,a=i.length+1;let l=i;we.isDocumentKey(l)||(l=l.child(""));const u=new Gt(new we(l),0);let d=new Ht(ze);return this.Jr.forEachWhile((g=>{const m=g.key.path;return!!i.isPrefixOf(m)&&(m.length===a&&(d=d.add(g.Hr)),!0)}),u),oe.resolve(this.Yr(d))}Yr(e){const t=[];return e.forEach((i=>{const a=this.Zr(i);a!==null&&t.push(a)})),t}removeMutationBatch(e,t){Qe(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return oe.forEach(t.mutations,(a=>{const l=new Gt(a.key,t.batchId);return i=i.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new Gt(t,0),a=this.Jr.firstAfterOrEqual(i);return oe.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,oe.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u4{constructor(e){this.ti=e,this.docs=(function(){return new pt(we.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,a=this.docs.get(i),l=a?a.size:0,u=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:u}),this.size+=u-l,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return oe.resolve(i?i.document.mutableCopy():ln.newInvalidDocument(t))}getEntries(e,t){let i=Ni();return t.forEach((a=>{const l=this.docs.get(a);i=i.insert(a,l?l.document.mutableCopy():ln.newInvalidDocument(a))})),oe.resolve(i)}getDocumentsMatchingQuery(e,t,i,a){let l=Ni();const u=t.path,d=new we(u.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(d);for(;g.hasNext();){const{key:m,value:{document:_}}=g.getNext();if(!u.isPrefixOf(m.path))break;m.path.length>u.length+1||MO(PO(_),i)<=0||(a.has(_.key)||lf(t,_))&&(l=l.insert(_.key,_.mutableCopy()))}return oe.resolve(l)}getAllFromCollectionGroup(e,t,i,a){Ce(9500)}ni(e,t){return oe.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new h4(this)}getSize(e){return oe.resolve(this.size)}}class h4 extends s4{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,a)=>{a.isValidDocument()?t.push(this.Mr.addEntry(e,a)):this.Mr.removeEntry(i)})),oe.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d4{constructor(e){this.persistence=e,this.ri=new Ma((t=>d0(t)),f0),this.lastRemoteSnapshotVersion=Re.min(),this.highestTargetId=0,this.ii=0,this.si=new _0,this.targetCount=0,this.oi=rl._r()}forEachTarget(e,t){return this.ri.forEach(((i,a)=>t(a))),oe.resolve()}getLastRemoteSnapshotVersion(e){return oe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return oe.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),oe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),oe.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new rl(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,oe.resolve()}updateTargetData(e,t){return this.lr(t),oe.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,oe.resolve()}removeTargets(e,t,i){let a=0;const l=[];return this.ri.forEach(((u,d)=>{d.sequenceNumber<=t&&i.get(d.targetId)===null&&(this.ri.delete(u),l.push(this.removeMatchingKeysForTargetId(e,d.targetId)),a++)})),oe.waitFor(l).next((()=>a))}getTargetCount(e){return oe.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return oe.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),oe.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const a=this.persistence.referenceDelegate,l=[];return a&&t.forEach((u=>{l.push(a.markPotentiallyOrphaned(e,u))})),oe.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),oe.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return oe.resolve(i)}containsKey(e,t){return oe.resolve(this.si.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m1{constructor(e,t){this._i={},this.overlays={},this.ai=new nf(0),this.ui=!1,this.ui=!0,this.ci=new l4,this.referenceDelegate=e(this),this.li=new d4(this),this.indexManager=new Qj,this.remoteDocumentCache=(function(a){return new u4(a)})((i=>this.referenceDelegate.hi(i))),this.serializer=new Yj(t),this.Pi=new a4(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new o4,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new c4(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){pe("MemoryPersistence","Starting transaction:",e);const a=new f4(this.ai.next());return this.referenceDelegate.Ti(),i(a).next((l=>this.referenceDelegate.Ii(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ei(e,t){return oe.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class f4 extends UO{constructor(e){super(),this.currentSequenceNumber=e}}class b0{constructor(e){this.persistence=e,this.Ri=new _0,this.Ai=null}static Vi(e){return new b0(e)}get di(){if(this.Ai)return this.Ai;throw Ce(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),oe.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),oe.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),oe.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((a=>this.di.add(a.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((a=>{a.forEach((l=>this.di.add(l.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return oe.forEach(this.di,(i=>{const a=we.fromPath(i);return this.mi(e,a).next((l=>{l||t.removeEntry(a,Re.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return oe.or([()=>oe.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Ld{constructor(e,t){this.persistence=e,this.fi=new Ma((i=>zO(i.path)),((i,a)=>i.isEqual(a))),this.garbageCollector=n4(this,t)}static Vi(e,t){return new Ld(e,t)}Ti(){}Ii(e){return oe.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((a=>i+a))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return oe.forEach(this.fi,((i,a)=>this.wr(e,i,a).next((l=>l?oe.resolve():t(a)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ni(e,(u=>this.wr(e,u,t).next((d=>{d||(i++,l.removeEntry(u,Re.min()))})))).next((()=>l.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),oe.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),oe.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),oe.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),oe.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=fd(e.data.value)),t}wr(e,t,i){return oe.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const a=this.fi.get(t);return oe.resolve(a!==void 0&&a>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w0{constructor(e,t,i,a){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=a}static Es(e,t){let i=He(),a=He();for(const l of t.docChanges)switch(l.type){case 0:i=i.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new w0(e,t.fromCache,i,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p4{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g4{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return mC()?8:VO(un())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,a){const l={result:null};return this.gs(e,t).next((u=>{l.result=u})).next((()=>{if(!l.result)return this.ps(e,t,a,i).next((u=>{l.result=u}))})).next((()=>{if(l.result)return;const u=new p4;return this.ys(e,t,u).next((d=>{if(l.result=d,this.As)return this.ws(e,t,u,d.size)}))})).next((()=>l.result))}ws(e,t,i,a){return i.documentReadCount<this.Vs?(Mo()<=Be.DEBUG&&pe("QueryEngine","SDK will not create cache indexes for query:",Lo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),oe.resolve()):(Mo()<=Be.DEBUG&&pe("QueryEngine","Query:",Lo(t),"scans",i.documentReadCount,"local documents and returns",a,"documents as results."),i.documentReadCount>this.ds*a?(Mo()<=Be.DEBUG&&pe("QueryEngine","The SDK decides to create cache indexes for query:",Lo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ks(t))):oe.resolve())}gs(e,t){if(Dw(t))return oe.resolve(null);let i=Ks(t);return this.indexManager.getIndexType(e,i).next((a=>a===0?null:(t.limit!==null&&a===1&&(t=bm(t,null,"F"),i=Ks(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((l=>{const u=He(...l);return this.fs.getDocuments(e,u).next((d=>this.indexManager.getMinOffset(e,i).next((g=>{const m=this.bs(t,d);return this.Ss(t,m,u,g.readTime)?this.gs(e,bm(t,null,"F")):this.Ds(e,m,t,g)}))))})))))}ps(e,t,i,a){return Dw(t)||a.isEqual(Re.min())?oe.resolve(null):this.fs.getDocuments(e,i).next((l=>{const u=this.bs(t,l);return this.Ss(t,u,i,a)?oe.resolve(null):(Mo()<=Be.DEBUG&&pe("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),Lo(t)),this.Ds(e,u,t,DO(a,Fc)).next((d=>d)))}))}bs(e,t){let i=new Ht(GE(e));return t.forEach(((a,l)=>{lf(e,l)&&(i=i.add(l))})),i}Ss(e,t,i,a){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}ys(e,t,i){return Mo()<=Be.DEBUG&&pe("QueryEngine","Using full collection scan to execute query:",Lo(t)),this.fs.getDocumentsMatchingQuery(e,t,Sr.min(),i)}Ds(e,t,i,a){return this.fs.getDocumentsMatchingQuery(e,i,a).next((l=>(t.forEach((u=>{l=l.insert(u.key,u)})),l)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x0="LocalStore",m4=3e8;class y4{constructor(e,t,i,a){this.persistence=e,this.Cs=t,this.serializer=a,this.vs=new pt(ze),this.Fs=new Ma((l=>d0(l)),f0),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new r4(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function v4(n,e,t,i){return new y4(n,e,t,i)}async function y1(n,e){const t=Ie(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let a;return t.mutationQueue.getAllMutationBatches(i).next((l=>(a=l,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((l=>{const u=[],d=[];let g=He();for(const m of a){u.push(m.batchId);for(const _ of m.mutations)g=g.add(_.key)}for(const m of l){d.push(m.batchId);for(const _ of m.mutations)g=g.add(_.key)}return t.localDocuments.getDocuments(i,g).next((m=>({Ns:m,removedBatchIds:u,addedBatchIds:d})))}))}))}function _4(n,e){const t=Ie(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const a=e.batch.keys(),l=t.xs.newChangeBuffer({trackRemovals:!0});return(function(d,g,m,_){const w=m.batch,T=w.keys();let S=oe.resolve();return T.forEach((N=>{S=S.next((()=>_.getEntry(g,N))).next((M=>{const k=m.docVersions.get(N);Qe(k!==null,48541),M.version.compareTo(k)<0&&(w.applyToRemoteDocument(M,m),M.isValidDocument()&&(M.setReadTime(m.commitVersion),_.addEntry(M)))}))})),S.next((()=>d.mutationQueue.removeMutationBatch(g,w)))})(t,i,e,l).next((()=>l.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,a,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(d){let g=He();for(let m=0;m<d.mutationResults.length;++m)d.mutationResults[m].transformResults.length>0&&(g=g.add(d.batch.mutations[m].key));return g})(e)))).next((()=>t.localDocuments.getDocuments(i,a)))}))}function v1(n){const e=Ie(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function b4(n,e){const t=Ie(n),i=e.snapshotVersion;let a=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const u=t.xs.newChangeBuffer({trackRemovals:!0});a=t.vs;const d=[];e.targetChanges.forEach(((_,w)=>{const T=a.get(w);if(!T)return;d.push(t.li.removeMatchingKeys(l,_.removedDocuments,w).next((()=>t.li.addMatchingKeys(l,_.addedDocuments,w))));let S=T.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(w)!==null?S=S.withResumeToken(sn.EMPTY_BYTE_STRING,Re.min()).withLastLimboFreeSnapshotVersion(Re.min()):_.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(_.resumeToken,i)),a=a.insert(w,S),(function(M,k,V){return M.resumeToken.approximateByteSize()===0||k.snapshotVersion.toMicroseconds()-M.snapshotVersion.toMicroseconds()>=m4?!0:V.addedDocuments.size+V.modifiedDocuments.size+V.removedDocuments.size>0})(T,S,_)&&d.push(t.li.updateTargetData(l,S))}));let g=Ni(),m=He();if(e.documentUpdates.forEach((_=>{e.resolvedLimboDocuments.has(_)&&d.push(t.persistence.referenceDelegate.updateLimboDocument(l,_))})),d.push(w4(l,u,e.documentUpdates).next((_=>{g=_.Bs,m=_.Ls}))),!i.isEqual(Re.min())){const _=t.li.getLastRemoteSnapshotVersion(l).next((w=>t.li.setTargetsMetadata(l,l.currentSequenceNumber,i)));d.push(_)}return oe.waitFor(d).next((()=>u.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,g,m))).next((()=>g))})).then((l=>(t.vs=a,l)))}function w4(n,e,t){let i=He(),a=He();return t.forEach((l=>i=i.add(l))),e.getEntries(n,i).next((l=>{let u=Ni();return t.forEach(((d,g)=>{const m=l.get(d);g.isFoundDocument()!==m.isFoundDocument()&&(a=a.add(d)),g.isNoDocument()&&g.version.isEqual(Re.min())?(e.removeEntry(d,g.readTime),u=u.insert(d,g)):!m.isValidDocument()||g.version.compareTo(m.version)>0||g.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(g),u=u.insert(d,g)):pe(x0,"Ignoring outdated watch update for ",d,". Current version:",m.version," Watch version:",g.version)})),{Bs:u,Ls:a}}))}function x4(n,e){const t=Ie(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=c0),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function T4(n,e){const t=Ie(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let a;return t.li.getTargetData(i,e).next((l=>l?(a=l,oe.resolve(a)):t.li.allocateTargetId(i).next((u=>(a=new vr(e,u,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,a).next((()=>a)))))))})).then((i=>{const a=t.vs.get(i.targetId);return(a===null||i.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function Sm(n,e,t){const i=Ie(n),a=i.vs.get(e),l=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",l,(u=>i.persistence.referenceDelegate.removeTarget(u,a)))}catch(u){if(!ul(u))throw u;pe(x0,`Failed to update sequence numbers for target ${e}: ${u}`)}i.vs=i.vs.remove(e),i.Fs.delete(a.target)}function Kw(n,e,t){const i=Ie(n);let a=Re.min(),l=He();return i.persistence.runTransaction("Execute query","readwrite",(u=>(function(g,m,_){const w=Ie(g),T=w.Fs.get(_);return T!==void 0?oe.resolve(w.vs.get(T)):w.li.getTargetData(m,_)})(i,u,Ks(e)).next((d=>{if(d)return a=d.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(u,d.targetId).next((g=>{l=g}))})).next((()=>i.Cs.getDocumentsMatchingQuery(u,e,t?a:Re.min(),t?l:He()))).next((d=>(E4(i,cj(e),d),{documents:d,ks:l})))))}function E4(n,e,t){let i=n.Ms.get(e)||Re.min();t.forEach(((a,l)=>{l.readTime.compareTo(i)>0&&(i=l.readTime)})),n.Ms.set(e,i)}class Yw{constructor(){this.activeTargetIds=gj()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class S4{constructor(){this.vo=new Yw,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new Yw,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A4{Mo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ww="ConnectivityMonitor";class Qw{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){pe(Ww,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){pe(Ww,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xh=null;function Am(){return Xh===null?Xh=(function(){return 268435456+Math.round(2147483648*Math.random())})():Xh++,"0x"+Xh.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zg="RestConnection",C4={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class N4{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${a}`,this.$o=this.databaseId.database===kd?`project_id=${i}`:`project_id=${i}&database_id=${a}`}Wo(e,t,i,a,l){const u=Am(),d=this.Qo(e,t.toUriEncodedString());pe(zg,`Sending RPC '${e}' ${u}:`,d,i);const g={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(g,a,l);const{host:m}=new URL(d),_=Oa(m);return this.zo(e,d,g,i,_).then((w=>(pe(zg,`Received RPC '${e}' ${u}: `,w),w)),(w=>{throw tl(zg,`RPC '${e}' ${u} failed with error: `,w,"url: ",d,"request:",i),w}))}jo(e,t,i,a,l,u){return this.Wo(e,t,i,a,l)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+ll})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((a,l)=>e[l]=a)),i&&i.headers.forEach(((a,l)=>e[l]=a))}Qo(e,t){const i=C4[e];let a=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(a=`${a}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),a}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R4{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const an="WebChannelConnection",bc=(n,e,t)=>{n.listen(e,(i=>{try{t(i)}catch(a){setTimeout((()=>{throw a}),0)}}))};class Wo extends N4{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Wo.c_){const e=TE();bc(e,xE.STAT_EVENT,(t=>{t.stat===pm.PROXY?pe(an,"STAT_EVENT: detected buffering proxy"):t.stat===pm.NOPROXY&&pe(an,"STAT_EVENT: detected no buffering proxy")})),Wo.c_=!0}}zo(e,t,i,a,l){const u=Am();return new Promise(((d,g)=>{const m=new bE;m.setWithCredentials(!0),m.listenOnce(wE.COMPLETE,(()=>{try{switch(m.getLastErrorCode()){case dd.NO_ERROR:const w=m.getResponseJson();pe(an,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(w)),d(w);break;case dd.TIMEOUT:pe(an,`RPC '${e}' ${u} timed out`),g(new ye(ce.DEADLINE_EXCEEDED,"Request time out"));break;case dd.HTTP_ERROR:const T=m.getStatus();if(pe(an,`RPC '${e}' ${u} failed with status:`,T,"response text:",m.getResponseText()),T>0){let S=m.getResponseJson();Array.isArray(S)&&(S=S[0]);const N=S==null?void 0:S.error;if(N&&N.status&&N.message){const M=(function(V){const F=V.toLowerCase().replace(/_/g,"-");return Object.values(ce).indexOf(F)>=0?F:ce.UNKNOWN})(N.status);g(new ye(M,N.message))}else g(new ye(ce.UNKNOWN,"Server responded with status "+m.getStatus()))}else g(new ye(ce.UNAVAILABLE,"Connection failed."));break;default:Ce(9055,{l_:e,streamId:u,h_:m.getLastErrorCode(),P_:m.getLastError()})}}finally{pe(an,`RPC '${e}' ${u} completed.`)}}));const _=JSON.stringify(a);pe(an,`RPC '${e}' ${u} sending request:`,a),m.send(t,"POST",_,i,15)}))}T_(e,t,i){const a=Am(),l=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=this.createWebChannelTransport(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(d.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(d.useFetchStreams=!0),this.Go(d.initMessageHeaders,t,i),d.encodeInitMessageHeaders=!0;const m=l.join("");pe(an,`Creating RPC '${e}' stream ${a}: ${m}`,d);const _=u.createWebChannel(m,d);this.I_(_);let w=!1,T=!1;const S=new R4({Ho:N=>{T?pe(an,`Not sending because RPC '${e}' stream ${a} is closed:`,N):(w||(pe(an,`Opening RPC '${e}' stream ${a} transport.`),_.open(),w=!0),pe(an,`RPC '${e}' stream ${a} sending:`,N),_.send(N))},Jo:()=>_.close()});return bc(_,Sc.EventType.OPEN,(()=>{T||(pe(an,`RPC '${e}' stream ${a} transport opened.`),S.i_())})),bc(_,Sc.EventType.CLOSE,(()=>{T||(T=!0,pe(an,`RPC '${e}' stream ${a} transport closed`),S.o_(),this.E_(_))})),bc(_,Sc.EventType.ERROR,(N=>{T||(T=!0,tl(an,`RPC '${e}' stream ${a} transport errored. Name:`,N.name,"Message:",N.message),S.o_(new ye(ce.UNAVAILABLE,"The operation could not be completed")))})),bc(_,Sc.EventType.MESSAGE,(N=>{var M;if(!T){const k=N.data[0];Qe(!!k,16349);const V=k,F=(V==null?void 0:V.error)||((M=V[0])==null?void 0:M.error);if(F){pe(an,`RPC '${e}' stream ${a} received error:`,F);const $=F.status;let D=(function(R){const A=Dt[R];if(A!==void 0)return i1(A)})($),q=F.message;D===void 0&&(D=ce.INTERNAL,q="Unknown error status: "+$+" with message "+F.message),T=!0,S.o_(new ye(D,q)),_.close()}else pe(an,`RPC '${e}' stream ${a} received:`,k),S.__(k)}})),Wo.u_(),setTimeout((()=>{S.s_()}),0),S}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return EE()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k4(n){return new Wo(n)}function Hg(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function df(n){return new Dj(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Wo.c_=!1;class _1{constructor(e,t,i=1e3,a=1.5,l=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=a,this.V_=l,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),a=Math.max(0,t-i);a>0&&pe("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,a,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jw="PersistentStream";class b1{constructor(e,t,i,a,l,u,d,g){this.Ci=e,this.b_=i,this.S_=a,this.connection=l,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=d,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new _1(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ce.RESOURCE_EXHAUSTED?(Ai(t.toString()),Ai("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ce.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,a])=>{this.D_===t&&this.G_(i,a)}),(i=>{e((()=>{const a=new ye(ce.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(a)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((a=>{i((()=>this.z_(a)))})),this.stream.onMessage((a=>{i((()=>++this.F_==1?this.H_(a):this.onNext(a)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return pe(Jw,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(pe(Jw,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class I4 extends b1{constructor(e,t,i,a,l,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,a,u),this.serializer=l}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=Lj(this.serializer,e),i=(function(l){if(!("targetChange"in l))return Re.min();const u=l.targetChange;return u.targetIds&&u.targetIds.length?Re.min():u.readTime?Ws(u.readTime):Re.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=Em(this.serializer),t.addTarget=(function(l,u){let d;const g=u.target;if(d=_m(g)?{documents:Bj(l,g)}:{query:zj(l,g).ft},d.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){d.resumeToken=o1(l,u.resumeToken);const m=wm(l,u.expectedCount);m!==null&&(d.expectedCount=m)}else if(u.snapshotVersion.compareTo(Re.min())>0){d.readTime=Md(l,u.snapshotVersion.toTimestamp());const m=wm(l,u.expectedCount);m!==null&&(d.expectedCount=m)}return d})(this.serializer,e);const i=$j(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=Em(this.serializer),t.removeTarget=e,this.K_(t)}}class O4 extends b1{constructor(e,t,i,a,l,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,a,u),this.serializer=l}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return Qe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Qe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Qe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=Vj(e.writeResults,e.commitTime),i=Ws(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=Em(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>Uj(this.serializer,i)))};this.K_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j4{}class D4 extends j4{constructor(e,t,i,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new ye(ce.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,u])=>this.connection.Wo(e,xm(t,i),a,l,u))).catch((l=>{throw l.name==="FirebaseError"?(l.code===ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new ye(ce.UNKNOWN,l.toString())}))}jo(e,t,i,a,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,d])=>this.connection.jo(e,xm(t,i),a,u,d,l))).catch((u=>{throw u.name==="FirebaseError"?(u.code===ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new ye(ce.UNKNOWN,u.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function P4(n,e,t,i){return new D4(n,e,t,i)}class M4{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ai(t),this.aa=!1):pe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ka="RemoteStore";class L4{constructor(e,t,i,a,l){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=l,this.Aa.Mo((u=>{i.enqueueAndForget((async()=>{La(this)&&(pe(ka,"Restarting streams for network reachability change."),await(async function(g){const m=Ie(g);m.Ea.add(4),await fu(m),m.Va.set("Unknown"),m.Ea.delete(4),await ff(m)})(this))}))})),this.Va=new M4(i,a)}}async function ff(n){if(La(n))for(const e of n.Ra)await e(!0)}async function fu(n){for(const e of n.Ra)await e(!1)}function w1(n,e){const t=Ie(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),A0(t)?S0(t):hl(t).O_()&&E0(t,e))}function T0(n,e){const t=Ie(n),i=hl(t);t.Ia.delete(e),i.O_()&&x1(t,e),t.Ia.size===0&&(i.O_()?i.L_():La(t)&&t.Va.set("Unknown"))}function E0(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Re.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}hl(n).Z_(e)}function x1(n,e){n.da.$e(e),hl(n).X_(e)}function S0(n){n.da=new kj({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),hl(n).start(),n.Va.ua()}function A0(n){return La(n)&&!hl(n).x_()&&n.Ia.size>0}function La(n){return Ie(n).Ea.size===0}function T1(n){n.da=void 0}async function U4(n){n.Va.set("Online")}async function V4(n){n.Ia.forEach(((e,t)=>{E0(n,e)}))}async function B4(n,e){T1(n),A0(n)?(n.Va.ha(e),S0(n)):n.Va.set("Unknown")}async function z4(n,e,t){if(n.Va.set("Online"),e instanceof a1&&e.state===2&&e.cause)try{await(async function(a,l){const u=l.cause;for(const d of l.targetIds)a.Ia.has(d)&&(await a.remoteSyncer.rejectListen(d,u),a.Ia.delete(d),a.da.removeTarget(d))})(n,e)}catch(i){pe(ka,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Ud(n,i)}else if(e instanceof md?n.da.Xe(e):e instanceof r1?n.da.st(e):n.da.tt(e),!t.isEqual(Re.min()))try{const i=await v1(n.localStore);t.compareTo(i)>=0&&await(function(l,u){const d=l.da.Tt(u);return d.targetChanges.forEach(((g,m)=>{if(g.resumeToken.approximateByteSize()>0){const _=l.Ia.get(m);_&&l.Ia.set(m,_.withResumeToken(g.resumeToken,u))}})),d.targetMismatches.forEach(((g,m)=>{const _=l.Ia.get(g);if(!_)return;l.Ia.set(g,_.withResumeToken(sn.EMPTY_BYTE_STRING,_.snapshotVersion)),x1(l,g);const w=new vr(_.target,g,m,_.sequenceNumber);E0(l,w)})),l.remoteSyncer.applyRemoteEvent(d)})(n,t)}catch(i){pe(ka,"Failed to raise snapshot:",i),await Ud(n,i)}}async function Ud(n,e,t){if(!ul(e))throw e;n.Ea.add(1),await fu(n),n.Va.set("Offline"),t||(t=()=>v1(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{pe(ka,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await ff(n)}))}function E1(n,e){return e().catch((t=>Ud(n,t,e)))}async function pf(n){const e=Ie(n),t=Rr(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:c0;for(;H4(e);)try{const a=await x4(e.localStore,i);if(a===null){e.Ta.length===0&&t.L_();break}i=a.batchId,$4(e,a)}catch(a){await Ud(e,a)}S1(e)&&A1(e)}function H4(n){return La(n)&&n.Ta.length<10}function $4(n,e){n.Ta.push(e);const t=Rr(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function S1(n){return La(n)&&!Rr(n).x_()&&n.Ta.length>0}function A1(n){Rr(n).start()}async function q4(n){Rr(n).ra()}async function F4(n){const e=Rr(n);for(const t of n.Ta)e.ea(t.mutations)}async function G4(n,e,t){const i=n.Ta.shift(),a=m0.from(i,e,t);await E1(n,(()=>n.remoteSyncer.applySuccessfulWrite(a))),await pf(n)}async function K4(n,e){e&&Rr(n).Y_&&await(async function(i,a){if((function(u){return Cj(u)&&u!==ce.ABORTED})(a.code)){const l=i.Ta.shift();Rr(i).B_(),await E1(i,(()=>i.remoteSyncer.rejectFailedWrite(l.batchId,a))),await pf(i)}})(n,e),S1(n)&&A1(n)}async function Xw(n,e){const t=Ie(n);t.asyncQueue.verifyOperationInProgress(),pe(ka,"RemoteStore received new credentials");const i=La(t);t.Ea.add(3),await fu(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await ff(t)}async function Y4(n,e){const t=Ie(n);e?(t.Ea.delete(2),await ff(t)):e||(t.Ea.add(2),await fu(t),t.Va.set("Unknown"))}function hl(n){return n.ma||(n.ma=(function(t,i,a){const l=Ie(t);return l.sa(),new I4(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Zo:U4.bind(null,n),Yo:V4.bind(null,n),t_:B4.bind(null,n),J_:z4.bind(null,n)}),n.Ra.push((async e=>{e?(n.ma.B_(),A0(n)?S0(n):n.Va.set("Unknown")):(await n.ma.stop(),T1(n))}))),n.ma}function Rr(n){return n.fa||(n.fa=(function(t,i,a){const l=Ie(t);return l.sa(),new O4(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:q4.bind(null,n),t_:K4.bind(null,n),ta:F4.bind(null,n),na:G4.bind(null,n)}),n.Ra.push((async e=>{e?(n.fa.B_(),await pf(n)):(await n.fa.stop(),n.Ta.length>0&&(pe(ka,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C0{constructor(e,t,i,a,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=a,this.removalCallback=l,this.deferred=new Ti,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((u=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,a,l){const u=Date.now()+i,d=new C0(e,t,u,a,l);return d.start(i),d}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ye(ce.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function N0(n,e){if(Ai("AsyncQueue",`${e}: ${n}`),ul(n))return new ye(ce.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qo{static emptySet(e){return new Qo(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||we.comparator(t.key,i.key):(t,i)=>we.comparator(t.key,i.key),this.keyedMap=Ac(),this.sortedSet=new pt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Qo)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=i.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Qo;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zw{constructor(){this.ga=new pt(we.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Ce(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class al{constructor(e,t,i,a,l,u,d,g,m){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=a,this.mutatedKeys=l,this.fromCache=u,this.syncStateChanged=d,this.excludesMetadataChanges=g,this.hasCachedResults=m}static fromInitialDocuments(e,t,i,a,l){const u=[];return t.forEach((d=>{u.push({type:0,doc:d})})),new al(e,t,Qo.emptySet(t),u,i,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&of(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==i[a].type||!t[a].doc.isEqual(i[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W4{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class Q4{constructor(){this.queries=ex(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const a=Ie(t),l=a.queries;a.queries=ex(),l.forEach(((u,d)=>{for(const g of d.ba)g.onError(i)}))})(this,new ye(ce.ABORTED,"Firestore shutting down"))}}function ex(){return new Ma((n=>FE(n)),of)}async function C1(n,e){const t=Ie(n);let i=3;const a=e.query;let l=t.queries.get(a);l?!l.Sa()&&e.Da()&&(i=2):(l=new W4,i=e.Da()?0:1);try{switch(i){case 0:l.wa=await t.onListen(a,!0);break;case 1:l.wa=await t.onListen(a,!1);break;case 2:await t.onFirstRemoteStoreListen(a)}}catch(u){const d=N0(u,`Initialization of query '${Lo(e.query)}' failed`);return void e.onError(d)}t.queries.set(a,l),l.ba.push(e),e.va(t.onlineState),l.wa&&e.Fa(l.wa)&&R0(t)}async function N1(n,e){const t=Ie(n),i=e.query;let a=3;const l=t.queries.get(i);if(l){const u=l.ba.indexOf(e);u>=0&&(l.ba.splice(u,1),l.ba.length===0?a=e.Da()?0:1:!l.Sa()&&e.Da()&&(a=2))}switch(a){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function J4(n,e){const t=Ie(n);let i=!1;for(const a of e){const l=a.query,u=t.queries.get(l);if(u){for(const d of u.ba)d.Fa(a)&&(i=!0);u.wa=a}}i&&R0(t)}function X4(n,e,t){const i=Ie(n),a=i.queries.get(e);if(a)for(const l of a.ba)l.onError(t);i.queries.delete(e)}function R0(n){n.Ca.forEach((e=>{e.next()}))}var Cm,tx;(tx=Cm||(Cm={})).Ma="default",tx.Cache="cache";class R1{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const a of e.docChanges)a.type!==3&&i.push(a);e=new al(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=al.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Cm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k1{constructor(e){this.key=e}}class I1{constructor(e){this.key=e}}class Z4{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=He(),this.mutatedKeys=He(),this.eu=GE(e),this.tu=new Qo(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new Zw,a=t?t.tu:this.tu;let l=t?t.mutatedKeys:this.mutatedKeys,u=a,d=!1;const g=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,m=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((_,w)=>{const T=a.get(_),S=lf(this.query,w)?w:null,N=!!T&&this.mutatedKeys.has(T.key),M=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations);let k=!1;T&&S?T.data.isEqual(S.data)?N!==M&&(i.track({type:3,doc:S}),k=!0):this.su(T,S)||(i.track({type:2,doc:S}),k=!0,(g&&this.eu(S,g)>0||m&&this.eu(S,m)<0)&&(d=!0)):!T&&S?(i.track({type:0,doc:S}),k=!0):T&&!S&&(i.track({type:1,doc:T}),k=!0,(g||m)&&(d=!0)),k&&(S?(u=u.add(S),l=M?l.add(_):l.delete(_)):(u=u.delete(_),l=l.delete(_)))})),this.query.limit!==null)for(;u.size>this.query.limit;){const _=this.query.limitType==="F"?u.last():u.first();u=u.delete(_.key),l=l.delete(_.key),i.track({type:1,doc:_})}return{tu:u,iu:i,Ss:d,mutatedKeys:l}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,a){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const u=e.iu.ya();u.sort(((_,w)=>(function(S,N){const M=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ce(20277,{Vt:k})}};return M(S)-M(N)})(_.type,w.type)||this.eu(_.doc,w.doc))),this.ou(i),a=a??!1;const d=t&&!a?this._u():[],g=this.Ya.size===0&&this.current&&!a?1:0,m=g!==this.Xa;return this.Xa=g,u.length!==0||m?{snapshot:new al(this.query,e.tu,l,u,e.mutatedKeys,g===0,m,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:d}:{au:d}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Zw,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=He(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new I1(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new k1(i))})),t}cu(e){this.Za=e.ks,this.Ya=He();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return al.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const k0="SyncEngine";class eD{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class tD{constructor(e){this.key=e,this.hu=!1}}class nD{constructor(e,t,i,a,l,u){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=u,this.Pu={},this.Tu=new Ma((d=>FE(d)),of),this.Iu=new Map,this.Eu=new Set,this.Ru=new pt(we.comparator),this.Au=new Map,this.Vu=new _0,this.du={},this.mu=new Map,this.fu=rl.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function sD(n,e,t=!0){const i=L1(n);let a;const l=i.Tu.get(e);return l?(i.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.lu()):a=await O1(i,e,t,!0),a}async function iD(n,e){const t=L1(n);await O1(t,e,!0,!1)}async function O1(n,e,t,i){const a=await T4(n.localStore,Ks(e)),l=a.targetId,u=n.sharedClientState.addLocalQueryTarget(l,t);let d;return i&&(d=await rD(n,e,l,u==="current",a.resumeToken)),n.isPrimaryClient&&t&&w1(n.remoteStore,a),d}async function rD(n,e,t,i,a){n.pu=(w,T,S)=>(async function(M,k,V,F){let $=k.view.ru(V);$.Ss&&($=await Kw(M.localStore,k.query,!1).then((({documents:R})=>k.view.ru(R,$))));const D=F&&F.targetChanges.get(k.targetId),q=F&&F.targetMismatches.get(k.targetId)!=null,J=k.view.applyChanges($,M.isPrimaryClient,D,q);return sx(M,k.targetId,J.au),J.snapshot})(n,w,T,S);const l=await Kw(n.localStore,e,!0),u=new Z4(e,l.ks),d=u.ru(l.documents),g=du.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",a),m=u.applyChanges(d,n.isPrimaryClient,g);sx(n,t,m.au);const _=new eD(e,t,u);return n.Tu.set(e,_),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),m.snapshot}async function aD(n,e,t){const i=Ie(n),a=i.Tu.get(e),l=i.Iu.get(a.targetId);if(l.length>1)return i.Iu.set(a.targetId,l.filter((u=>!of(u,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(a.targetId),i.sharedClientState.isActiveQueryTarget(a.targetId)||await Sm(i.localStore,a.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(a.targetId),t&&T0(i.remoteStore,a.targetId),Nm(i,a.targetId)})).catch(cl)):(Nm(i,a.targetId),await Sm(i.localStore,a.targetId,!0))}async function oD(n,e){const t=Ie(n),i=t.Tu.get(e),a=t.Iu.get(i.targetId);t.isPrimaryClient&&a.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),T0(t.remoteStore,i.targetId))}async function lD(n,e,t){const i=gD(n);try{const a=await(function(u,d){const g=Ie(u),m=ut.now(),_=d.reduce(((S,N)=>S.add(N.key)),He());let w,T;return g.persistence.runTransaction("Locally write mutations","readwrite",(S=>{let N=Ni(),M=He();return g.xs.getEntries(S,_).next((k=>{N=k,N.forEach(((V,F)=>{F.isValidDocument()||(M=M.add(V))}))})).next((()=>g.localDocuments.getOverlayedDocuments(S,N))).next((k=>{w=k;const V=[];for(const F of d){const $=xj(F,w.get(F.key).overlayedDocument);$!=null&&V.push(new Dr(F.key,$,UE($.value.mapValue),Ys.exists(!0)))}return g.mutationQueue.addMutationBatch(S,m,V,d)})).next((k=>{T=k;const V=k.applyToLocalDocumentSet(w,M);return g.documentOverlayCache.saveOverlays(S,k.batchId,V)}))})).then((()=>({batchId:T.batchId,changes:YE(w)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(a.batchId),(function(u,d,g){let m=u.du[u.currentUser.toKey()];m||(m=new pt(ze)),m=m.insert(d,g),u.du[u.currentUser.toKey()]=m})(i,a.batchId,t),await pu(i,a.changes),await pf(i.remoteStore)}catch(a){const l=N0(a,"Failed to persist write");t.reject(l)}}async function j1(n,e){const t=Ie(n);try{const i=await b4(t.localStore,e);e.targetChanges.forEach(((a,l)=>{const u=t.Au.get(l);u&&(Qe(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?u.hu=!0:a.modifiedDocuments.size>0?Qe(u.hu,14607):a.removedDocuments.size>0&&(Qe(u.hu,42227),u.hu=!1))})),await pu(t,i,e)}catch(i){await cl(i)}}function nx(n,e,t){const i=Ie(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const a=[];i.Tu.forEach(((l,u)=>{const d=u.view.va(e);d.snapshot&&a.push(d.snapshot)})),(function(u,d){const g=Ie(u);g.onlineState=d;let m=!1;g.queries.forEach(((_,w)=>{for(const T of w.ba)T.va(d)&&(m=!0)})),m&&R0(g)})(i.eventManager,e),a.length&&i.Pu.J_(a),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function cD(n,e,t){const i=Ie(n);i.sharedClientState.updateQueryState(e,"rejected",t);const a=i.Au.get(e),l=a&&a.key;if(l){let u=new pt(we.comparator);u=u.insert(l,ln.newNoDocument(l,Re.min()));const d=He().add(l),g=new hf(Re.min(),new Map,new pt(ze),u,d);await j1(i,g),i.Ru=i.Ru.remove(l),i.Au.delete(e),I0(i)}else await Sm(i.localStore,e,!1).then((()=>Nm(i,e,t))).catch(cl)}async function uD(n,e){const t=Ie(n),i=e.batch.batchId;try{const a=await _4(t.localStore,e);P1(t,i,null),D1(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await pu(t,a)}catch(a){await cl(a)}}async function hD(n,e,t){const i=Ie(n);try{const a=await(function(u,d){const g=Ie(u);return g.persistence.runTransaction("Reject batch","readwrite-primary",(m=>{let _;return g.mutationQueue.lookupMutationBatch(m,d).next((w=>(Qe(w!==null,37113),_=w.keys(),g.mutationQueue.removeMutationBatch(m,w)))).next((()=>g.mutationQueue.performConsistencyCheck(m))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(m,_,d))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,_))).next((()=>g.localDocuments.getDocuments(m,_)))}))})(i.localStore,e);P1(i,e,t),D1(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await pu(i,a)}catch(a){await cl(a)}}function D1(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function P1(n,e,t){const i=Ie(n);let a=i.du[i.currentUser.toKey()];if(a){const l=a.get(e);l&&(t?l.reject(t):l.resolve(),a=a.remove(e)),i.du[i.currentUser.toKey()]=a}}function Nm(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach((i=>{n.Vu.containsKey(i)||M1(n,i)}))}function M1(n,e){n.Eu.delete(e.path.canonicalString());const t=n.Ru.get(e);t!==null&&(T0(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),I0(n))}function sx(n,e,t){for(const i of t)i instanceof k1?(n.Vu.addReference(i.key,e),dD(n,i)):i instanceof I1?(pe(k0,"Document no longer in limbo: "+i.key),n.Vu.removeReference(i.key,e),n.Vu.containsKey(i.key)||M1(n,i.key)):Ce(19791,{wu:i})}function dD(n,e){const t=e.key,i=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(i)||(pe(k0,"New document in limbo: "+t),n.Eu.add(i),I0(n))}function I0(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new we(ct.fromString(e)),i=n.fu.next();n.Au.set(i,new tD(t)),n.Ru=n.Ru.insert(t,i),w1(n.remoteStore,new vr(Ks(p0(t.path)),i,"TargetPurposeLimboResolution",nf.ce))}}async function pu(n,e,t){const i=Ie(n),a=[],l=[],u=[];i.Tu.isEmpty()||(i.Tu.forEach(((d,g)=>{u.push(i.pu(g,e,t).then((m=>{var _;if((m||t)&&i.isPrimaryClient){const w=m?!m.fromCache:(_=t==null?void 0:t.targetChanges.get(g.targetId))==null?void 0:_.current;i.sharedClientState.updateQueryState(g.targetId,w?"current":"not-current")}if(m){a.push(m);const w=w0.Es(g.targetId,m);l.push(w)}})))})),await Promise.all(u),i.Pu.J_(a),await(async function(g,m){const _=Ie(g);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",(w=>oe.forEach(m,(T=>oe.forEach(T.Ts,(S=>_.persistence.referenceDelegate.addReference(w,T.targetId,S))).next((()=>oe.forEach(T.Is,(S=>_.persistence.referenceDelegate.removeReference(w,T.targetId,S)))))))))}catch(w){if(!ul(w))throw w;pe(x0,"Failed to update sequence numbers: "+w)}for(const w of m){const T=w.targetId;if(!w.fromCache){const S=_.vs.get(T),N=S.snapshotVersion,M=S.withLastLimboFreeSnapshotVersion(N);_.vs=_.vs.insert(T,M)}}})(i.localStore,l))}async function fD(n,e){const t=Ie(n);if(!t.currentUser.isEqual(e)){pe(k0,"User change. New user:",e.toKey());const i=await y1(t.localStore,e);t.currentUser=e,(function(l,u){l.mu.forEach((d=>{d.forEach((g=>{g.reject(new ye(ce.CANCELLED,u))}))})),l.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await pu(t,i.Ns)}}function pD(n,e){const t=Ie(n),i=t.Au.get(e);if(i&&i.hu)return He().add(i.key);{let a=He();const l=t.Iu.get(e);if(!l)return a;for(const u of l){const d=t.Tu.get(u);a=a.unionWith(d.view.nu)}return a}}function L1(n){const e=Ie(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=j1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=pD.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=cD.bind(null,e),e.Pu.J_=J4.bind(null,e.eventManager),e.Pu.yu=X4.bind(null,e.eventManager),e}function gD(n){const e=Ie(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=uD.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=hD.bind(null,e),e}class Vd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=df(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return v4(this.persistence,new g4,e.initialUser,this.serializer)}Cu(e){return new m1(b0.Vi,this.serializer)}Du(e){return new S4}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Vd.provider={build:()=>new Vd};class mD extends Vd{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Qe(this.persistence.referenceDelegate instanceof Ld,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new e4(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?xn.withCacheSize(this.cacheSizeBytes):xn.DEFAULT;return new m1((i=>Ld.Vi(i,t)),this.serializer)}}class Rm{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>nx(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=fD.bind(null,this.syncEngine),await Y4(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new Q4})()}createDatastore(e){const t=df(e.databaseInfo.databaseId),i=k4(e.databaseInfo);return P4(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,a,l,u,d){return new L4(i,a,l,u,d)})(this.localStore,this.datastore,e.asyncQueue,(t=>nx(this.syncEngine,t,0)),(function(){return Qw.v()?new Qw:new A4})())}createSyncEngine(e,t){return(function(a,l,u,d,g,m,_){const w=new nD(a,l,u,d,g,m);return _&&(w.gu=!0),w})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(a){const l=Ie(a);pe(ka,"RemoteStore shutting down."),l.Ea.add(5),await fu(l),l.Aa.shutdown(),l.Va.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}Rm.provider={build:()=>new Rm};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U1{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ai("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kr="FirestoreClient";class yD{constructor(e,t,i,a,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=a,this.user=on.UNAUTHENTICATED,this.clientId=o0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(i,(async u=>{pe(kr,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u})),this.appCheckCredentials.start(i,(u=>(pe(kr,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ti;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=N0(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function $g(n,e){n.asyncQueue.verifyOperationInProgress(),pe(kr,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async a=>{i.isEqual(a)||(await y1(e.localStore,a),i=a)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function ix(n,e){n.asyncQueue.verifyOperationInProgress();const t=await vD(n);pe(kr,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>Xw(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,a)=>Xw(e.remoteStore,a))),n._onlineComponents=e}async function vD(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){pe(kr,"Using user provided OfflineComponentProvider");try{await $g(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(a){return a.name==="FirebaseError"?a.code===ce.FAILED_PRECONDITION||a.code===ce.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(t))throw t;tl("Error using user provided cache. Falling back to memory cache: "+t),await $g(n,new Vd)}}else pe(kr,"Using default OfflineComponentProvider"),await $g(n,new mD(void 0));return n._offlineComponents}async function V1(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(pe(kr,"Using user provided OnlineComponentProvider"),await ix(n,n._uninitializedComponentsProvider._online)):(pe(kr,"Using default OnlineComponentProvider"),await ix(n,new Rm))),n._onlineComponents}function _D(n){return V1(n).then((e=>e.syncEngine))}async function B1(n){const e=await V1(n),t=e.eventManager;return t.onListen=sD.bind(null,e.syncEngine),t.onUnlisten=aD.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=iD.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=oD.bind(null,e.syncEngine),t}function bD(n,e,t={}){const i=new Ti;return n.asyncQueue.enqueueAndForget((async()=>(function(l,u,d,g,m){const _=new U1({next:T=>{_.Nu(),u.enqueueAndForget((()=>N1(l,w)));const S=T.docs.has(d);!S&&T.fromCache?m.reject(new ye(ce.UNAVAILABLE,"Failed to get document because the client is offline.")):S&&T.fromCache&&g&&g.source==="server"?m.reject(new ye(ce.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(T)},error:T=>m.reject(T)}),w=new R1(p0(d.path),_,{includeMetadataChanges:!0,Ka:!0});return C1(l,w)})(await B1(n),n.asyncQueue,e,t,i))),i.promise}function wD(n,e,t={}){const i=new Ti;return n.asyncQueue.enqueueAndForget((async()=>(function(l,u,d,g,m){const _=new U1({next:T=>{_.Nu(),u.enqueueAndForget((()=>N1(l,w))),T.fromCache&&g.source==="server"?m.reject(new ye(ce.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(T)},error:T=>m.reject(T)}),w=new R1(d,_,{includeMetadataChanges:!0,Ka:!0});return C1(l,w)})(await B1(n),n.asyncQueue,e,t,i))),i.promise}function xD(n,e){const t=new Ti;return n.asyncQueue.enqueueAndForget((async()=>lD(await _D(n),e,t))),t.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z1(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TD="ComponentProvider",rx=new Map;function ED(n,e,t,i,a){return new qO(n,e,t,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,z1(a.experimentalLongPollingOptions),a.useFetchStreams,a.isUsingEmulator,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H1="firestore.googleapis.com",ax=!0;class ox{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ye(ce.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=H1,this.ssl=ax}else this.host=e.host,this.ssl=e.ssl??ax;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=g1;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Xj)throw new ye(ce.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}jO("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=z1(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new ye(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new ye(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new ye(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,a){return i.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class gf{constructor(e,t,i,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ox({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ye(ce.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ye(ce.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ox(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new TO;switch(i.type){case"firstParty":return new CO(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new ye(ce.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=rx.get(t);i&&(pe(TD,"Removing Datastore"),rx.delete(t),i.terminate())})(this),Promise.resolve()}}function SD(n,e,t,i={}){var m;n=Ci(n,gf);const a=Oa(e),l=n._getSettings(),u={...l,emulatorOptions:n._getEmulatorOptions()},d=`${e}:${t}`;a&&($m(`https://${d}`),qm("Firestore",!0)),l.host!==H1&&l.host!==d&&tl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...l,host:d,ssl:a,emulatorOptions:i};if(!Er(g,u)&&(n._setSettings(g),i.mockUserToken)){let _,w;if(typeof i.mockUserToken=="string")_=i.mockUserToken,w=on.MOCK_USER;else{_=lT(i.mockUserToken,(m=n._app)==null?void 0:m.options.projectId);const T=i.mockUserToken.sub||i.mockUserToken.user_id;if(!T)throw new ye(ce.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");w=new on(T)}n._authCredentials=new EO(new AE(_,w))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mf{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new mf(this.firestore,e,this._query)}}class Lt{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Tr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Lt(this.firestore,e,this._key)}toJSON(){return{type:Lt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(uu(t,Lt._jsonSchema))return new Lt(e,i||null,new we(ct.fromString(t.referencePath)))}}Lt._jsonSchemaVersion="firestore/documentReference/1.0",Lt._jsonSchema={type:Mt("string",Lt._jsonSchemaVersion),referencePath:Mt("string")};class Tr extends mf{constructor(e,t,i){super(e,t,p0(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Lt(this.firestore,null,new we(e))}withConverter(e){return new Tr(this.firestore,e,this._path)}}function AD(n,e,...t){if(n=vt(n),CE("collection","path",e),n instanceof gf){const i=ct.fromString(e,...t);return ww(i),new Tr(n,null,i)}{if(!(n instanceof Lt||n instanceof Tr))throw new ye(ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(ct.fromString(e,...t));return ww(i),new Tr(n.firestore,null,i)}}function Lc(n,e,...t){if(n=vt(n),arguments.length===1&&(e=o0.newId()),CE("doc","path",e),n instanceof gf){const i=ct.fromString(e,...t);return bw(i),new Lt(n,null,new we(i))}{if(!(n instanceof Lt||n instanceof Tr))throw new ye(ce.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(ct.fromString(e,...t));return bw(i),new Lt(n.firestore,n instanceof Tr?n.converter:null,new we(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lx="AsyncQueue";class cx{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new _1(this,"async_queue_retry"),this._c=()=>{const i=Hg();i&&pe(lx,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Hg();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Hg();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Ti;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!ul(e))throw e;pe(lx,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Ai("INTERNAL UNHANDLED ERROR: ",ux(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const a=C0.createAndSchedule(this,e,t,i,(l=>this.hc(l)));return this.tc.push(a),a}uc(){this.nc&&Ce(47125,{Pc:ux(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function ux(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class gu extends gf{constructor(e,t,i,a){super(e,t,i,a),this.type="firestore",this._queue=new cx,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new cx(e),this._firestoreClient=void 0,await e}}}function CD(n,e){const t=typeof n=="object"?n:Qd(),i=typeof n=="string"?n:kd,a=Ir(t,"firestore").getImmediate({identifier:i});if(!a._initialized){const l=rT("firestore");l&&SD(a,...l)}return a}function O0(n){if(n._terminated)throw new ye(ce.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||ND(n),n._firestoreClient}function ND(n){var i,a,l,u;const e=n._freezeSettings(),t=ED(n._databaseId,((i=n._app)==null?void 0:i.options.appId)||"",n._persistenceKey,(a=n._app)==null?void 0:a.options.apiKey,e);n._componentsProvider||(l=e.localCache)!=null&&l._offlineComponentProvider&&((u=e.localCache)!=null&&u._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new yD(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(g){const m=g==null?void 0:g._online.build();return{_offline:g==null?void 0:g._offline.build(m),_online:m}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Zn(sn.fromBase64String(e))}catch(t){throw new ye(ce.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Zn(sn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Zn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(uu(e,Zn._jsonSchema))return Zn.fromBase64String(e.bytes)}}Zn._jsonSchemaVersion="firestore/bytes/1.0",Zn._jsonSchema={type:Mt("string",Zn._jsonSchemaVersion),bytes:Mt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j0{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ye(ce.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new nn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D0{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qs{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ye(ce.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ye(ce.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ze(this._lat,e._lat)||ze(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Qs._jsonSchemaVersion}}static fromJSON(e){if(uu(e,Qs._jsonSchema))return new Qs(e.latitude,e.longitude)}}Qs._jsonSchemaVersion="firestore/geoPoint/1.0",Qs._jsonSchema={type:Mt("string",Qs._jsonSchemaVersion),latitude:Mt("number"),longitude:Mt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,a){if(i.length!==a.length)return!1;for(let l=0;l<i.length;++l)if(i[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:vs._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(uu(e,vs._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new vs(e.vectorValues);throw new ye(ce.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}vs._jsonSchemaVersion="firestore/vectorValue/1.0",vs._jsonSchema={type:Mt("string",vs._jsonSchemaVersion),vectorValues:Mt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RD=/^__.*__$/;class kD{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Dr(e,this.data,this.fieldMask,t,this.fieldTransforms):new hu(e,this.data,t,this.fieldTransforms)}}class $1{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new Dr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function q1(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ce(40011,{dataSource:n})}}class P0{constructor(e,t,i,a,l,u){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=a,l===void 0&&this.validatePath(),this.fieldTransforms=l||[],this.fieldMask=u||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new P0({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){var a;const t=(a=this.path)==null?void 0:a.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){var a;const t=(a=this.path)==null?void 0:a.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Bd(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(q1(this.dataSource)&&RD.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class ID{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||df(e)}createContext(e,t,i,a=!1){return new P0({dataSource:e,methodName:t,targetDoc:i,path:nn.emptyPath(),arrayElement:!1,hasConverter:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function F1(n){const e=n._freezeSettings(),t=df(n._databaseId);return new ID(n._databaseId,!!e.ignoreUndefinedProperties,t)}function OD(n,e,t,i,a,l={}){const u=n.createContext(l.merge||l.mergeFields?2:0,e,t,a);M0("Data must be an object, but it was:",u,i);const d=G1(i,u);let g,m;if(l.merge)g=new Ln(u.fieldMask),m=u.fieldTransforms;else if(l.mergeFields){const _=[];for(const w of l.mergeFields){const T=Jc(e,w,t);if(!u.contains(T))throw new ye(ce.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);W1(_,T)||_.push(T)}g=new Ln(_),m=u.fieldTransforms.filter((w=>g.covers(w.field)))}else g=null,m=u.fieldTransforms;return new kD(new Tn(d),g,m)}class yf extends D0{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof yf}}function jD(n,e,t,i){const a=n.createContext(1,e,t);M0("Data must be an object, but it was:",a,i);const l=[],u=Tn.empty();jr(i,((g,m)=>{const _=Y1(e,g,t);m=vt(m);const w=a.childContextForFieldPath(_);if(m instanceof yf)l.push(_);else{const T=vf(m,w);T!=null&&(l.push(_),u.set(_,T))}}));const d=new Ln(l);return new $1(u,d,a.fieldTransforms)}function DD(n,e,t,i,a,l){const u=n.createContext(1,e,t),d=[Jc(e,i,t)],g=[a];if(l.length%2!=0)throw new ye(ce.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<l.length;T+=2)d.push(Jc(e,l[T])),g.push(l[T+1]);const m=[],_=Tn.empty();for(let T=d.length-1;T>=0;--T)if(!W1(m,d[T])){const S=d[T];let N=g[T];N=vt(N);const M=u.childContextForFieldPath(S);if(N instanceof yf)m.push(S);else{const k=vf(N,M);k!=null&&(m.push(S),_.set(S,k))}}const w=new Ln(m);return new $1(_,w,u.fieldTransforms)}function vf(n,e){if(K1(n=vt(n)))return M0("Unsupported field value:",e,n),G1(n,e);if(n instanceof D0)return(function(i,a){if(!q1(a.dataSource))throw a.createError(`${i._methodName}() can only be used with update() and set()`);if(!a.path)throw a.createError(`${i._methodName}() is not currently supported inside arrays`);const l=i._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,a){const l=[];let u=0;for(const d of i){let g=vf(d,a.childContextForArray(u));g==null&&(g={nullValue:"NULL_VALUE"}),l.push(g),u++}return{arrayValue:{values:l}}})(n,e)}return(function(i,a){if((i=vt(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return mj(a.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const l=ut.fromDate(i);return{timestampValue:Md(a.serializer,l)}}if(i instanceof ut){const l=new ut(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Md(a.serializer,l)}}if(i instanceof Qs)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Zn)return{bytesValue:o1(a.serializer,i._byteString)};if(i instanceof Lt){const l=a.databaseId,u=i.firestore._databaseId;if(!u.isEqual(l))throw a.createError(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:v0(i.firestore._databaseId||a.databaseId,i._key.path)}}if(i instanceof vs)return(function(u,d){const g=u instanceof vs?u.toArray():u;return{mapValue:{fields:{[ME]:{stringValue:LE},[Id]:{arrayValue:{values:g.map((_=>{if(typeof _!="number")throw d.createError("VectorValues must only contain numeric values.");return g0(d.serializer,_)}))}}}}}})(i,a);if(p1(i))return i._toProto(a.serializer);throw a.createError(`Unsupported field value: ${l0(i)}`)})(n,e)}function G1(n,e){const t={};return kE(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):jr(n,((i,a)=>{const l=vf(a,e.childContextForField(i));l!=null&&(t[i]=l)})),{mapValue:{fields:t}}}function K1(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ut||n instanceof Qs||n instanceof Zn||n instanceof Lt||n instanceof D0||n instanceof vs||p1(n))}function M0(n,e,t){if(!K1(t)||!NE(t)){const i=l0(t);throw i==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+i)}}function Jc(n,e,t){if((e=vt(e))instanceof j0)return e._internalPath;if(typeof e=="string")return Y1(n,e);throw Bd("Field path arguments must be of type string or ",n,!1,void 0,t)}const PD=new RegExp("[~\\*/\\[\\]]");function Y1(n,e,t){if(e.search(PD)>=0)throw Bd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new j0(...e.split("."))._internalPath}catch{throw Bd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Bd(n,e,t,i,a){const l=i&&!i.isEmpty(),u=a!==void 0;let d=`Function ${e}() called with invalid data`;t&&(d+=" (via `toFirestore()`)"),d+=". ";let g="";return(l||u)&&(g+=" (found",l&&(g+=` in field ${i}`),u&&(g+=` in document ${a}`),g+=")"),new ye(ce.INVALID_ARGUMENT,d+n+g)}function W1(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MD{convertValue(e,t="none"){switch(Nr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Tt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Cr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ce(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return jr(e,((a,l)=>{i[a]=this.convertValue(l,t)})),i}convertVectorValue(e){var i,a,l;const t=(l=(a=(i=e.fields)==null?void 0:i[Id].arrayValue)==null?void 0:a.values)==null?void 0:l.map((u=>Tt(u.doubleValue)));return new vs(t)}convertGeoPoint(e){return new Qs(Tt(e.latitude),Tt(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=rf(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Gc(e));default:return null}}convertTimestamp(e){const t=Ar(e);return new ut(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=ct.fromString(e);Qe(f1(i),9688,{name:e});const a=new Kc(i.get(1),i.get(3)),l=new we(i.popFirst(5));return a.isEqual(t)||Ai(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q1 extends MD{constructor(e){super(),this.firestore=e}convertBytes(e){return new Zn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Lt(this.firestore,null,t)}}const hx="@firebase/firestore",dx="4.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J1{constructor(e,t,i,a,l){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new Lt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new LD(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){var e;return((e=this._document)==null?void 0:e.data.clone().value.mapValue.fields)??void 0}get(e){if(this._document){const t=this._document.data.field(Jc("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class LD extends J1{data(){return super.data()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UD(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ye(ce.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}function VD(n,e,t){let i;return i=n?n.toFirestore(e):e,i}class Nc{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class xa extends J1{constructor(e,t,i,a,l,u){super(e,t,i,a,u),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new yd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(Jc("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ye(ce.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=xa._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}xa._jsonSchemaVersion="firestore/documentSnapshot/1.0",xa._jsonSchema={type:Mt("string",xa._jsonSchemaVersion),bundleSource:Mt("string","DocumentSnapshot"),bundleName:Mt("string"),bundle:Mt("string")};class yd extends xa{data(e={}){return super.data(e)}}class Jo{constructor(e,t,i,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new Nc(a.hasPendingWrites,a.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new yd(this._firestore,this._userDataWriter,i.key,i,new Nc(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ye(ce.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let u=0;return a._snapshot.docChanges.map((d=>{const g=new yd(a._firestore,a._userDataWriter,d.doc.key,d.doc,new Nc(a._snapshot.mutatedKeys.has(d.doc.key),a._snapshot.fromCache),a.query.converter);return d.doc,{type:"added",doc:g,oldIndex:-1,newIndex:u++}}))}{let u=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((d=>l||d.type!==3)).map((d=>{const g=new yd(a._firestore,a._userDataWriter,d.doc.key,d.doc,new Nc(a._snapshot.mutatedKeys.has(d.doc.key),a._snapshot.fromCache),a.query.converter);let m=-1,_=-1;return d.type!==0&&(m=u.indexOf(d.doc.key),u=u.delete(d.doc.key)),d.type!==1&&(u=u.add(d.doc),_=u.indexOf(d.doc.key)),{type:BD(d.type),doc:g,oldIndex:m,newIndex:_}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ye(ce.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Jo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=o0.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),i.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function BD(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ce(61501,{type:n})}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Jo._jsonSchemaVersion="firestore/querySnapshot/1.0",Jo._jsonSchema={type:Mt("string",Jo._jsonSchemaVersion),bundleSource:Mt("string","QuerySnapshot"),bundleName:Mt("string"),bundle:Mt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zD(n){n=Ci(n,Lt);const e=Ci(n.firestore,gu),t=O0(e);return bD(t,n._key).then((i=>qD(e,n,i)))}function HD(n){n=Ci(n,mf);const e=Ci(n.firestore,gu),t=O0(e),i=new Q1(e);return UD(n._query),wD(t,n._query).then((a=>new Jo(e,i,n,a)))}function $D(n,e,t){n=Ci(n,Lt);const i=Ci(n.firestore,gu),a=VD(n.converter,e),l=F1(i);return X1(i,[OD(l,"setDoc",n._key,a,n.converter!==null,t).toMutation(n._key,Ys.none())])}function km(n,e,t,...i){n=Ci(n,Lt);const a=Ci(n.firestore,gu),l=F1(a);let u;return u=typeof(e=vt(e))=="string"||e instanceof j0?DD(l,"updateDoc",n._key,e,t,i):jD(l,"updateDoc",n._key,e),X1(a,[u.toMutation(n._key,Ys.exists(!0))])}function X1(n,e){const t=O0(n);return xD(t,e)}function qD(n,e,t){const i=t.docs.get(e._key),a=new Q1(n);return new xa(n,a,e._key,i,new Nc(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){xO(Da),_s(new es("firestore",((i,{instanceIdentifier:a,options:l})=>{const u=i.getProvider("app").getImmediate(),d=new gu(new SO(i.getProvider("auth-internal")),new NO(u,i.getProvider("app-check-internal")),FO(u,a),u);return l={useFetchStreams:t,...l},d._setSettings(l),d}),"PUBLIC").setMultipleInstances(!0)),En(hx,dx,e),En(hx,dx,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z1="firebasestorage.googleapis.com",FD="storageBucket",GD=120*1e3,KD=600*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pr=class eS extends ts{constructor(e,t,i=0){super(qg(e),`Firebase Storage: ${t} (${qg(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,eS.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return qg(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}};var Zs;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Zs||(Zs={}));function qg(n){return"storage/"+n}function YD(){const n="An unknown error occurred, please check the error payload for server response.";return new Pr(Zs.UNKNOWN,n)}function WD(){return new Pr(Zs.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function QD(){return new Pr(Zs.CANCELED,"User canceled the upload/download.")}function JD(n){return new Pr(Zs.INVALID_URL,"Invalid URL '"+n+"'.")}function XD(n){return new Pr(Zs.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function fx(n){return new Pr(Zs.INVALID_ARGUMENT,n)}function tS(){return new Pr(Zs.APP_DELETED,"The Firebase app was deleted.")}function ZD(n){return new Pr(Zs.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=ys.makeFromUrl(e,t)}catch{return new ys(e,"")}if(i.path==="")return i;throw XD(e)}static makeFromUrl(e,t){let i=null;const a="([A-Za-z0-9.\\-_]+)";function l(D){D.path.charAt(D.path.length-1)==="/"&&(D.path_=D.path_.slice(0,-1))}const u="(/(.*))?$",d=new RegExp("^gs://"+a+u,"i"),g={bucket:1,path:3};function m(D){D.path_=decodeURIComponent(D.path)}const _="v[A-Za-z0-9_]+",w=t.replace(/[.]/g,"\\."),T="(/([^?#]*).*)?$",S=new RegExp(`^https?://${w}/${_}/b/${a}/o${T}`,"i"),N={bucket:1,path:3},M=t===Z1?"(?:storage.googleapis.com|storage.cloud.google.com)":t,k="([^?#]*)",V=new RegExp(`^https?://${M}/${a}/${k}`,"i"),$=[{regex:d,indices:g,postModify:l},{regex:S,indices:N,postModify:m},{regex:V,indices:{bucket:1,path:2},postModify:m}];for(let D=0;D<$.length;D++){const q=$[D],J=q.regex.exec(e);if(J){const R=J[q.indices.bucket];let A=J[q.indices.path];A||(A=""),i=new ys(R,A),q.postModify(i);break}}if(i==null)throw JD(e);return i}}class eP{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tP(n,e,t){let i=1,a=null,l=null,u=!1,d=0;function g(){return d===2}let m=!1;function _(...k){m||(m=!0,e.apply(null,k))}function w(k){a=setTimeout(()=>{a=null,n(S,g())},k)}function T(){l&&clearTimeout(l)}function S(k,...V){if(m){T();return}if(k){T(),_.call(null,k,...V);return}if(g()||u){T(),_.call(null,k,...V);return}i<64&&(i*=2);let $;d===1?(d=2,$=0):$=(i+Math.random())*1e3,w($)}let N=!1;function M(k){N||(N=!0,T(),!m&&(a!==null?(k||(d=2),clearTimeout(a),w(0)):k||(d=1)))}return w(0),l=setTimeout(()=>{u=!0,M(!0)},t),M}function nP(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sP(n){return n!==void 0}function px(n,e,t,i){if(i<e)throw fx(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw fx(`Invalid value for '${n}'. Expected ${t} or less.`)}function iP(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const a=e(i)+"="+e(n[i]);t=t+a+"&"}return t=t.slice(0,-1),t}var zd;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(zd||(zd={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rP(n,e){const t=n>=500&&n<600,a=[408,429].indexOf(n)!==-1,l=e.indexOf(n)!==-1;return t||a||l}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aP{constructor(e,t,i,a,l,u,d,g,m,_,w,T=!0,S=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=a,this.successCodes_=l,this.additionalRetryCodes_=u,this.callback_=d,this.errorCallback_=g,this.timeout_=m,this.progressCallback_=_,this.connectionFactory_=w,this.retry=T,this.isUsingEmulator=S,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((N,M)=>{this.resolve_=N,this.reject_=M,this.start_()})}start_(){const e=(i,a)=>{if(a){i(!1,new Zh(!1,null,!0));return}const l=this.connectionFactory_();this.pendingConnection_=l;const u=d=>{const g=d.loaded,m=d.lengthComputable?d.total:-1;this.progressCallback_!==null&&this.progressCallback_(g,m)};this.progressCallback_!==null&&l.addUploadProgressListener(u),l.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&l.removeUploadProgressListener(u),this.pendingConnection_=null;const d=l.getErrorCode()===zd.NO_ERROR,g=l.getStatus();if(!d||rP(g,this.additionalRetryCodes_)&&this.retry){const _=l.getErrorCode()===zd.ABORT;i(!1,new Zh(!1,null,_));return}const m=this.successCodes_.indexOf(g)!==-1;i(!0,new Zh(m,l))})},t=(i,a)=>{const l=this.resolve_,u=this.reject_,d=a.connection;if(a.wasSuccessCode)try{const g=this.callback_(d,d.getResponse());sP(g)?l(g):l()}catch(g){u(g)}else if(d!==null){const g=YD();g.serverResponse=d.getErrorText(),this.errorCallback_?u(this.errorCallback_(d,g)):u(g)}else if(a.canceled){const g=this.appDelete_?tS():QD();u(g)}else{const g=WD();u(g)}};this.canceled_?t(!1,new Zh(!1,null,!0)):this.backoffId_=tP(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&nP(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Zh{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function oP(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function lP(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function cP(n,e){e&&(n["X-Firebase-GMPID"]=e)}function uP(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function hP(n,e,t,i,a,l,u=!0,d=!1){const g=iP(n.urlParams),m=n.url+g,_=Object.assign({},n.headers);return cP(_,e),oP(_,t),lP(_,l),uP(_,i),new aP(m,n.method,_,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,a,u,d)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dP(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function fP(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hd{constructor(e,t){this._service=e,t instanceof ys?this._location=t:this._location=ys.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Hd(e,t)}get root(){const e=new ys(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return fP(this._location.path)}get storage(){return this._service}get parent(){const e=dP(this._location.path);if(e===null)return null;const t=new ys(this._location.bucket,e);return new Hd(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw ZD(e)}}function gx(n,e){const t=e==null?void 0:e[FD];return t==null?null:ys.makeFromBucketSpec(t,n)}function pP(n,e,t,i={}){n.host=`${e}:${t}`;const a=Oa(e);a&&($m(`https://${n.host}/b`),qm("Storage",!0)),n._isUsingEmulator=!0,n._protocol=a?"https":"http";const{mockUserToken:l}=i;l&&(n._overrideAuthToken=typeof l=="string"?l:lT(l,n.app.options.projectId))}class gP{constructor(e,t,i,a,l,u=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=a,this._firebaseVersion=l,this._isUsingEmulator=u,this._bucket=null,this._host=Z1,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=GD,this._maxUploadRetryTime=KD,this._requests=new Set,a!=null?this._bucket=ys.makeFromBucketSpec(a,this._host):this._bucket=gx(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=ys.makeFromBucketSpec(this._url,e):this._bucket=gx(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){px("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){px("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Mn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Hd(this,e)}_makeRequest(e,t,i,a,l=!0){if(this._deleted)return new eP(tS());{const u=hP(e,this._appId,i,a,t,this._firebaseVersion,l,this._isUsingEmulator);return this._requests.add(u),u.getPromise().then(()=>this._requests.delete(u),()=>this._requests.delete(u)),u}}async makeRequestWithTokens(e,t){const[i,a]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,a).getPromise()}}const mx="@firebase/storage",yx="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nS="storage";function mP(n=Qd(),e){n=vt(n);const i=Ir(n,nS).getImmediate({identifier:e}),a=rT("storage");return a&&yP(i,...a),i}function yP(n,e,t,i={}){pP(n,e,t,i)}function vP(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),a=n.getProvider("app-check-internal");return new gP(t,i,a,e,Da)}function _P(){_s(new es(nS,vP,"PUBLIC").setMultipleInstances(!0)),En(mx,yx,""),En(mx,yx,"esm2020")}_P();const bP={apiKey:"AIzaSyAGphhC3qC1qLA_ErvpWk9QAaHc0N3ovQM",authDomain:"appaistudio-55b77.firebaseapp.com",projectId:"appaistudio-55b77",storageBucket:"appaistudio-55b77.firebasestorage.app",messagingSenderId:"98616437820",appId:"1:98616437820:web:10b78e2f4718d35b3ee739",measurementId:"G-Q8Q00T026N"},_f=gT(bP);ek(_f);const vd=bO(_f),Xo=CD(_f);mP(_f);const Ta={registerUser:async(n,e,t,i,a="user")=>{try{const u=(await nI(vd,n,e)).user;await rI(u,{displayName:t});let d=a,g=[];(t==="huytamky"||n.includes("huytamky"))&&(d="admin",g=["video-viral","image-script","zenshot-ai","translation","new-tool"]);const m={id:u.uid,username:t,email:n,phone:i,role:d,allowedApps:g,createdAt:Date.now()};return await $D(Lc(Xo,"users",u.uid),m),m}catch(l){throw console.error("Firebase Registration Error:",l),l}},loginUser:async(n,e)=>{try{const i=(await sI(vd,n,e)).user,a=await Ta.getUserProfile(i.uid);return a||{id:i.uid,username:i.displayName||n.split("@")[0],email:n,phone:"",role:"user",allowedApps:[],createdAt:Date.now()}}catch(t){throw console.error("Firebase Login Error:",t),t}},getUserProfile:async n=>{try{const e=Lc(Xo,"users",n),t=await zD(e);return t.exists()?t.data():(console.warn("No such document!"),null)}catch(e){return console.error("Error getting user profile:",e),null}},logoutUser:async()=>{try{await cI(vd)}catch(n){throw console.error("Logout Error:",n),n}},updateProfile:async(n,e)=>{try{const t=Lc(Xo,"users",n);await km(t,e)}catch(t){throw console.error("Update Profile Error:",t),t}}},wP=({onLogin:n})=>{const[e,t]=le.useState(!1),[i,a]=le.useState(""),[l,u]=le.useState(""),[d,g]=le.useState(""),[m,_]=le.useState(""),[w,T]=le.useState(""),[S,N]=le.useState(""),[M,k]=le.useState(!1),V=Bc.useRef(!0);Bc.useEffect(()=>()=>{V.current=!1},[]);const F=async()=>{if(N(""),k(!0),!m||!l){N("Vui lng nhp Email v Mt khu"),k(!1);return}try{console.log("Starting Auth...");const $=new Promise((q,J)=>setTimeout(()=>J(new Error("Request timed out (15s)")),15e3));let D;if(e){if(!i||!w){N("Vui lng nhp y  Tn v ST"),k(!1);return}if(l!==d){N("Mt khu nhp li khng khp"),k(!1);return}D=await Promise.race([Ta.registerUser(m,l,i,w),$])}else D=await Promise.race([Ta.loginUser(m,l),$]);console.log("Auth Success:",D),n(D)}catch($){console.error($),$.message.includes("timed out")?(N("Mng qu chm hoc b chn. Vui lng th li!"),alert("Li: Qu thi gian ch (Timeout). Kim tra kt ni mng.")):$.code==="auth/email-already-in-use"?N("Email ny  c s dng."):$.code==="auth/invalid-email"?N("a ch Email khng hp l (V d: ten@gmail.com)."):$.code==="auth/invalid-credential"||$.message.includes("Invalid login credentials")?N("Sai email hoc mt khu."):$.code==="auth/weak-password"?N("Mt khu qu yu (cn t nht 6 k t)."):(N("Li: "+($.message||"Khng xc nh")),alert("Li chi tit: "+$.message))}finally{V.current&&k(!1)}};return p.jsx("div",{className:"min-h-screen bg-[#020617] flex items-center justify-center p-4",children:p.jsxs("div",{className:"bg-[#1e293b] p-8 rounded-2xl shadow-xl w-full max-w-md border border-white/10",children:[p.jsx("h2",{className:"text-2xl font-bold text-white mb-6 text-center",children:e?"ng K Ti Khon":"ng Nhp"}),p.jsxs("div",{className:"space-y-4",children:[e&&p.jsxs("div",{children:[p.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400 mb-2",children:"Tn hin th"}),p.jsx("input",{type:"text",value:i,onChange:$=>a($.target.value),className:"w-full bg-[#0f172a] border border-slate-700 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 outline-none"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400 mb-2",children:"Email"}),p.jsx("input",{type:"email",value:m,onChange:$=>_($.target.value),className:"w-full bg-[#0f172a] border border-slate-700 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 outline-none"})]}),e&&p.jsxs("div",{children:[p.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400 mb-2",children:"S in thoi"}),p.jsx("input",{type:"tel",value:w,onChange:$=>T($.target.value),className:"w-full bg-[#0f172a] border border-slate-700 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 outline-none"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400 mb-2",children:"Mt khu"}),p.jsx("input",{type:"password",value:l,onChange:$=>u($.target.value),className:"w-full bg-[#0f172a] border border-slate-700 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 outline-none"})]}),e&&p.jsxs("div",{children:[p.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400 mb-2",children:"Nhp li mt khu"}),p.jsx("input",{type:"password",value:d,onChange:$=>g($.target.value),className:"w-full bg-[#0f172a] border border-slate-700 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 outline-none"})]}),S&&p.jsx("p",{className:"text-red-400 text-sm text-center",children:S}),p.jsx("button",{onClick:F,disabled:M,className:`w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 rounded-lg transition-colors mt-4 ${M?"opacity-50 cursor-not-allowed":""}`,children:M?"ang x l...":e?"ng K":"ng Nhp"}),p.jsx("p",{className:"text-center text-slate-400 text-sm mt-4 cursor-pointer hover:text-white",onClick:()=>t(!e),children:e?" c ti khon? ng nhp ngay":"Cha c ti khon? ng k mi"}),p.jsx("div",{className:"mt-6 pt-4 border-t border-white/5 text-center",children:p.jsx("span",{className:"text-[10px] uppercase font-black tracking-widest text-orange-500/50",children:"System: Firebase V2 (Fast) + Supabase Storage"})})]}),p.jsxs("div",{className:"mt-8 pt-6 border-t border-white/10 text-center",children:[p.jsx("p",{className:"text-slate-500 text-xs mb-3",children:"Gp s c ng nhp?"}),p.jsx("button",{onClick:()=>{window.confirm("Thao tc ny s xa ton b d liu tm (Cache/Storage) v ti li trang. Bn c chc chn?")&&(localStorage.clear(),sessionStorage.clear(),window.location.reload())},className:"text-xs font-bold text-slate-400 hover:text-red-400 uppercase tracking-wider underline decoration-slate-700 hover:decoration-red-400 underline-offset-4 transition-all",children:"Xa Cache & Ti Li App"}),p.jsx("div",{className:"mt-2 text-[10px] text-slate-600",children:'S dng khi b li "Timeout" hoc treo logo'})]})]})})},ed=[{id:"Cinematic Realistic",label:"Cinematic High-End Realistic (in nh thc t cao cp)"},{id:"3D Pixar Animation",label:"3D Pixar/Disney Style Animation (Hot hnh 3D Pixar/Disney)"},{id:"Japanese Anime 90s",label:"Classic 90s Japanese Anime (Hot hnh Nht Bn thp nin 90)"},{id:"Modern Makoto Shinkai",label:"Makoto Shinkai Cinematic Style (Phong cch Makoto Shinkai hin i)"},{id:"Studio Ghibli Aesthetic",label:"Studio Ghibli Hand-painted Aesthetic (Phong cch v tay Ghibli)"},{id:"Cyberpunk Neon 2077",label:"Cyberpunk Neon / Sci-Fi Futurism (Tng lai vin tng Neon)"},{id:"Hyper-realistic 8K Photo",label:"Hyper-realistic 8K RAW Photography (Nhip nh siu thc 8K)"},{id:"Spider-Verse Vibrant Comic",label:"Into the Spider-Verse Vibrant Comic (Truyn tranh phong cch Spider-Verse)"},{id:"Vintage 16mm Film",label:"Vintage 16mm Grainy Film Style (Phim nha 16mm c in)"},{id:"Noir Black and White",label:"Classic Film Noir / Moody Black & White (Phim en trng Noir su lng)"},{id:"Oil Painting Impressionism",label:"Classic Oil Painting / Impressionist Art (Tranh sn du n tng)"},{id:"Lo-fi Aesthetic Retro",label:"Lo-fi / Vaporwave Retro Aesthetic (Phong cch Lo-fi c in)"},{id:"Claymation Stop Motion",label:"Claymation Claymation Style (Hot hnh t st)"},{id:"Minimalist Vector Art",label:"Clean Minimalist Vector Illustration (Minh ha Vector ti gin)"},{id:"Dark Fantasy Gothic",label:"Dark Fantasy / Gothic Horror Style (Gi tng en ti / Gothic)"},{id:"Ukiyo-e Woodblock",label:"Traditional Japanese Ukiyo-e Woodblock (Tranh khc g Nht Bn)"},{id:"Surrealist Dreamscape",label:"Surrealist / Dreamlike Visual Art (Ngh thut siu thc o mng)"},{id:"Paper Cutout Collage",label:"Hand-crafted Paper Cutout Collage (Ct dn giy th cng)"},{id:"Sketch Graphite Art",label:"Detailed Graphite Pencil Sketch (Phc tho bt ch chi tit)"},{id:"Glitch Art Digital",label:"Experimental Glitch Art / Digital Distortion (Ngh thut li k thut s)"}];let xP=class extends le.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("ErrorBoundary caught error:",e,t)}render(){var e;return this.state.hasError?p.jsxs("div",{className:"p-8 m-8 bg-slate-900 border border-slate-700 rounded-3xl space-y-4 text-center text-white",children:[p.jsx("h2",{className:"text-xl font-bold text-rose-500",children:" xy ra li hin th"}),p.jsx("p",{className:"text-slate-300",children:(e=this.state.error)==null?void 0:e.message}),p.jsx("button",{onClick:()=>this.setState({hasError:!1}),className:"px-6 py-3 bg-white text-slate-900 font-bold rounded-xl hover:bg-slate-200 transition-all",children:"Th li"}),p.jsx("p",{className:"text-xs text-slate-500",children:"D liu vn c lu trong b nh tm."})]}):this.props.children}};const TP=({userId:n})=>{const[e,t]=le.useState({opponentScript:"",skeleton:null,ideas:[],selectedIdeaIndex:null,outlines:{},finalScripts:{},selectedStyle:ed[0].id,characters:[],tags:{},showCharacterSection:!1,loading:{analysis:!1,ideas:!1,outline:!1,script:!1,characters:!1}}),[i,a]=le.useState("");le.useEffect(()=>{if(!n)return;const D=`app_api_keys_${n}`,q=localStorage.getItem(D);if(q)try{const J=JSON.parse(q),A=atob(J.gemini||"").split(`
`).map(I=>I.trim()).filter(I=>I);A.length>0&&(a(A.join(`
`)),sm(A))}catch(J){console.error("Failed to load Gemini keys",J)}},[n]);const[l,u]=le.useState(null),d=(D,q="info")=>{u({message:D,type:q}),setTimeout(()=>u(null),5e3)},g=le.useRef(null),m=D=>/[\u3040-\u30ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff\uff66-\uff9f\uac00-\ud7af]/.test(D)?D.replace(/\s/g,"").length:D.trim().split(/\s+/).filter(Boolean).length,_=async()=>{if(e.opponentScript.trim()){t(D=>({...D,loading:{...D.loading,analysis:!0}}));try{const D=await G2(e.opponentScript,i),q=m(e.opponentScript),J=D.split(/PHONG CCH I TH/i),R=J.length>1?J[1].trim():"T nhin, viral";t(A=>({...A,skeleton:{content:D,wordCount:q,style:R},loading:{...A.loading,analysis:!1}}))}catch(D){console.error(D),d("Li Phn tch: "+(D instanceof Error?D.message:String(D)),"error"),t(q=>({...q,loading:{...q.loading,analysis:!1}}))}}},w=async()=>{if(e.skeleton){t(D=>({...D,loading:{...D.loading,ideas:!0}}));try{const D=await K2(e.skeleton.content,i);t(q=>({...q,ideas:D,loading:{...q.loading,ideas:!1}}))}catch(D){console.error(D),d("Li Sinh  tng: "+(D instanceof Error?D.message:String(D)),"error"),t(q=>({...q,loading:{...q.loading,ideas:!1}}))}}},T=async D=>{if(!(!e.skeleton||!e.ideas[D])){t(q=>({...q,selectedIdeaIndex:D,loading:{...q.loading,outline:!0}}));try{const q=await Y2(e.skeleton.content,e.ideas[D],e.skeleton.wordCount,i);t(J=>({...J,outlines:{...J.outlines,[D]:q},loading:{...J.loading,outline:!1}}))}catch(q){console.error(q),d("Li Lp dn : "+(q instanceof Error?q.message:String(q)),"error"),t(J=>({...J,loading:{...J.loading,outline:!1}}))}}},S=async D=>{if(!(!e.outlines[D]||!e.skeleton)){t(q=>({...q,loading:{...q.loading,script:!0}}));try{const q=await W2(e.outlines[D],e.skeleton.style,i);t(J=>({...J,finalScripts:{...J.finalScripts,[D]:q},loading:{...J.loading,script:!1}}))}catch(q){console.error(q),d("Li Vit kch bn: "+(q instanceof Error?q.message:String(q)),"error"),t(J=>({...J,loading:{...J.loading,script:!1}}))}}},N=async()=>{const D=e.selectedIdeaIndex,q=D!==null?e.finalScripts[D]:null;if(t(J=>({...J,showCharacterSection:!0})),setTimeout(()=>{var J;(J=g.current)==null||J.scrollIntoView({behavior:"smooth",block:"start"})},100),q)try{const J=await Q2(q,ed.map(A=>A.id),i),R=ed.find(A=>A.id===J||J.includes(A.id));R&&t(A=>({...A,selectedStyle:R.id}))}catch(J){console.error("Style recommendation failed",J)}},M=async()=>{const D=e.selectedIdeaIndex;if(!(D===null||!e.finalScripts[D])){t(q=>({...q,loading:{...q.loading,characters:!0}}));try{const q=await J2(e.finalScripts[D],e.selectedStyle,i);t(J=>({...J,characters:q,loading:{...J.loading,characters:!1}}))}catch(q){console.error(q),d("Li Thit k NV: "+(q instanceof Error?q.message:String(q)),"error"),t(J=>({...J,loading:{...J.loading,characters:!1}}))}}},k=D=>{const q=e.finalScripts[D];if(!q)return;const J=2e3;let R=[];if(q.length<=J)R=[q];else{let I=q;for(;I.length>0;){let L=I.lastIndexOf(`
`,J);(L===-1||L<500)&&(L=J),R.push(I.substring(0,L).trim()),I=I.substring(L).trim()}}const A=R.map(I=>({content:I,actions:[],isAnalyzing:!1}));t(I=>({...I,tags:{...I.tags,[D]:A}}))},V=async(D,q)=>{var R;const J=(R=e.tags[D])==null?void 0:R[q];if(!J||!e.characters.length){d("Vui lng thc hin bc 'Thit k Nhn Vt' trc khi phn tch hnh ng.","info");return}t(A=>{const I={...A.tags},L=[...I[D]||[]];return L[q]&&(L[q]={...L[q],isAnalyzing:!0}),I[D]=L,{...A,tags:I}});try{const A=await X2(J.content,e.selectedStyle,e.characters,i);t(I=>{const L={...I.tags},U=[...L[D]||[]];return U[q]&&(U[q]={...U[q],actions:A,isAnalyzing:!1}),L[D]=U,{...I,tags:L}})}catch(A){console.error(A),d("Li Phn tch Tag: "+(A instanceof Error?A.message:String(A)),"error"),t(I=>{const L={...I.tags},U=[...L[D]||[]];return U[q]&&(U[q]={...U[q],isAnalyzing:!1}),L[D]=U,{...I,tags:L}})}},F=D=>{navigator.clipboard.writeText(D),d(" sao chp prompt!","success")},$=D=>{const q=D.map(J=>J.motionPrompt).join(`
`);navigator.clipboard.writeText(q),d(" sao chp tt c prompt video!","success")};return p.jsx(xP,{children:p.jsxs(Bc.Fragment,{children:[l&&p.jsx("div",{className:"fixed top-4 right-4 z-50 animate-in slide-in-from-right fade-in duration-300",children:p.jsxs("div",{className:`px-6 py-4 rounded-2xl shadow-2xl flex items-center gap-3 font-bold text-sm ${l.type==="error"?"bg-rose-50 text-rose-600 border border-rose-100":l.type==="success"?"bg-emerald-50 text-emerald-600 border border-emerald-100":"bg-white text-slate-700 border border-slate-100"}`,children:[l.type==="success"&&p.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),l.type==="error"&&p.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),l.message]})}),p.jsxs("main",{className:"w-full grid grid-cols-1 md:grid-cols-10 gap-8 p-4 md:p-10",children:[p.jsxs("div",{className:"md:col-span-3 space-y-10",children:[p.jsxs("section",{className:"bg-white rounded-3xl shadow-xl shadow-slate-200/50 border border-slate-100 p-8 group transition-all",children:[p.jsxs("h2",{className:"text-xl font-black text-slate-800 uppercase tracking-tighter mb-6 flex items-center gap-3",children:[p.jsx("span",{className:"w-2 h-6 bg-indigo-600 rounded-full"}),"Kch bn i th"]}),p.jsx("textarea",{className:"w-full h-80 p-6 bg-slate-50 border border-slate-100 rounded-2xl focus:ring-8 focus:ring-indigo-600/5 focus:border-indigo-600/20 focus:bg-white outline-none transition-all text-sm leading-relaxed placeholder:text-slate-300 font-medium custom-scrollbar mb-6",placeholder:"Dn kch bn i th vo y...",value:e.opponentScript,onChange:D=>t(q=>({...q,opponentScript:D.target.value}))}),p.jsx("button",{onClick:_,disabled:e.loading.analysis||!e.opponentScript,className:"w-full bg-[#020617] hover:bg-indigo-700 disabled:bg-slate-100 disabled:text-slate-300 text-white font-black py-6 rounded-2xl transition-all shadow-2xl hover:scale-[1.02] active:scale-95 flex justify-center items-center gap-4 text-sm uppercase tracking-widest",children:e.loading.analysis?"ang x l...":"Phn tch Cu trc & Phong cch"})]}),e.skeleton&&p.jsxs("div",{className:"space-y-8 animate-in slide-in-from-left-8 duration-700",children:[p.jsxs("div",{className:"bg-gradient-to-br from-indigo-600 to-indigo-800 rounded-3xl p-8 text-white shadow-2xl relative overflow-hidden",children:[p.jsx("h3",{className:"text-[10px] font-black uppercase opacity-60 mb-2 tracking-[0.3em]",children:"Quantitative Data"}),p.jsxs("div",{className:"text-5xl font-black italic tracking-tighter",children:[e.skeleton.wordCount," ",p.jsx("span",{className:"text-xs font-bold uppercase opacity-60",children:"Units"})]})]}),p.jsxs("section",{className:"bg-white rounded-3xl shadow-xl border border-slate-100 p-8",children:[p.jsx("h2",{className:"text-lg font-black text-slate-800 uppercase tracking-tighter mb-6",children:"Khung xng Logic"}),p.jsx("div",{className:"max-h-96 overflow-y-auto pr-4 text-sm text-slate-600 leading-relaxed whitespace-pre-wrap font-medium custom-scrollbar",children:e.skeleton.content}),p.jsx("button",{onClick:w,disabled:e.loading.ideas,className:"w-full mt-8 bg-rose-500 hover:bg-rose-600 disabled:bg-slate-100 text-white font-black py-6 rounded-2xl transition-all shadow-xl hover:scale-[1.02] active:scale-95 uppercase tracking-widest text-xs",children:"SINH 5  TNG LIN QUAN"})]})]}),e.showCharacterSection&&p.jsxs("div",{ref:g,className:"animate-in fade-in slide-in-from-bottom-12 duration-1000 space-y-8",children:[p.jsxs("section",{className:"bg-white rounded-3xl shadow-xl border border-slate-100 p-8",children:[p.jsx("h2",{className:"text-lg font-black text-slate-800 uppercase tracking-tighter mb-6",children:"B lc Phong cch"}),p.jsxs("div",{className:"space-y-6 mb-8",children:[p.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400 tracking-widest px-1",children:"Visual Architecture"}),p.jsx("select",{value:e.selectedStyle,onChange:D=>t(q=>({...q,selectedStyle:D.target.value})),className:"w-full p-5 bg-slate-50 border border-slate-200 rounded-xl focus:ring-4 focus:ring-amber-500/10 outline-none text-sm font-bold text-slate-800 transition-all cursor-pointer",children:ed.map(D=>p.jsx("option",{value:D.id,children:D.label},D.id))})]}),p.jsx("button",{onClick:M,disabled:e.loading.characters,className:"w-full bg-amber-500 hover:bg-amber-600 disabled:bg-slate-100 text-white font-black py-6 rounded-2xl shadow-xl transition-all hover:scale-[1.02] active:scale-95 uppercase tracking-widest text-xs",children:"Thit k Nhn Vt"})]}),e.characters.length>0&&p.jsx("div",{className:"space-y-6",children:e.characters.map((D,q)=>p.jsxs("div",{className:"bg-[#020617] text-white p-8 rounded-[2rem] border-l-[10px] border-amber-500 shadow-3xl",children:[p.jsx("input",{className:"bg-transparent border-none text-2xl font-black text-white tracking-tighter mb-1 w-full focus:ring-0 placeholder-white/30",value:D.name,onChange:J=>{const R=[...e.characters];R[q].name=J.target.value,t(A=>({...A,characters:R}))},placeholder:"Tn nhn vt"}),p.jsx("div",{className:"text-[10px] font-bold text-amber-500/60 uppercase tracking-widest mb-4",children:"Neural Casting Profile"}),p.jsxs("div",{className:"grid grid-cols-2 gap-4 text-[11px] mb-4",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("span",{className:"opacity-40 uppercase whitespace-nowrap",children:"G.Tnh:"}),p.jsx("input",{className:"bg-white/10 rounded px-2 py-1 w-full border-none focus:ring-1 focus:ring-amber-500 text-white",value:D.gender,onChange:J=>{const R=[...e.characters];R[q].gender=J.target.value,t(A=>({...A,characters:R}))}})]}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("span",{className:"opacity-40 uppercase whitespace-nowrap",children:"Tui:"}),p.jsx("input",{className:"bg-white/10 rounded px-2 py-1 w-full border-none focus:ring-1 focus:ring-amber-500 text-white",value:D.age,onChange:J=>{const R=[...e.characters];R[q].age=J.target.value,t(A=>({...A,characters:R}))}})]}),p.jsxs("div",{className:"flex items-center gap-2 col-span-2",children:[p.jsx("span",{className:"opacity-40 uppercase whitespace-nowrap",children:"Quc tch:"}),p.jsx("input",{className:"bg-white/10 rounded px-2 py-1 w-full border-none focus:ring-1 focus:ring-amber-500 text-white",value:D.country,onChange:J=>{const R=[...e.characters];R[q].country=J.target.value,t(A=>({...A,characters:R}))}})]}),p.jsxs("div",{className:"flex items-center gap-2 col-span-2",children:[p.jsx("span",{className:"opacity-40 uppercase whitespace-nowrap",children:"Dng ngi:"}),p.jsx("input",{className:"bg-white/10 rounded px-2 py-1 w-full border-none focus:ring-1 focus:ring-amber-500 text-white",value:D.bodyType,onChange:J=>{const R=[...e.characters];R[q].bodyType=J.target.value,t(A=>({...A,characters:R}))}})]})]}),p.jsxs("div",{className:"mt-4 pt-4 border-t border-white/10",children:[p.jsx("label",{className:"text-[10px] text-slate-400 uppercase tracking-widest block mb-1",children:"c im khun mt (Trung tnh)"}),p.jsx("textarea",{className:"w-full bg-white/5 rounded-xl p-3 text-xs text-slate-300 italic leading-relaxed border border-white/10 focus:ring-1 focus:ring-amber-500 outline-none resize-none h-24",value:D.facialDetails,onChange:J=>{const R=[...e.characters];R[q].facialDetails=J.target.value,t(A=>({...A,characters:R}))}})]})]},q))})]})]}),p.jsx("div",{className:"md:col-span-7 space-y-12",children:e.ideas.length>0?p.jsxs("div",{className:"space-y-16 animate-in fade-in zoom-in-95 duration-1000",children:[p.jsx("div",{className:"flex items-center justify-between border-b-4 border-slate-100 pb-8",children:p.jsxs("div",{className:"flex items-center gap-6",children:[p.jsx("div",{className:"bg-[#020617] text-white w-14 h-14 rounded-2xl flex items-center justify-center text-3xl font-black shadow-2xl",children:"#"}),p.jsx("h2",{className:"text-4xl font-black text-slate-900 tracking-tighter uppercase",children:"Production Suite"})]})}),e.ideas.map((D,q)=>p.jsxs("div",{className:"bg-white rounded-[3rem] shadow-2xl border border-slate-100 p-10 md:p-16 space-y-12 transition-all hover:border-indigo-200",children:[p.jsxs("div",{className:"space-y-8",children:[p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsxs("span",{className:"bg-indigo-600 text-white text-[11px] font-black px-6 py-2 rounded-full uppercase",children:["Module ",q+1]}),p.jsx("span",{className:"text-rose-500 text-xs font-black uppercase tracking-widest",children:D.highlightValue})]}),p.jsx("h3",{className:"text-5xl font-black text-slate-900 tracking-tighter leading-none",children:D.title}),p.jsx("p",{className:"text-xl text-slate-500 leading-relaxed font-medium",children:D.description}),p.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 pt-4",children:[p.jsxs("div",{className:"bg-slate-50 p-8 rounded-3xl border border-slate-100",children:[p.jsx("div",{className:"text-[10px] font-black text-slate-400 uppercase mb-2 tracking-widest",children:"Environment Context"}),p.jsx("p",{className:"font-bold text-slate-700",children:D.charactersContext})]}),p.jsxs("div",{className:"bg-slate-50 p-8 rounded-3xl border border-slate-100",children:[p.jsx("div",{className:"text-[10px] font-black text-slate-400 uppercase mb-2 tracking-widest",children:"Growth Potential"}),p.jsx("p",{className:"font-bold text-slate-700",children:D.viralPotential})]})]})]}),p.jsx("div",{className:"pt-12 border-t-2 border-slate-50 space-y-12",children:e.outlines[q]?p.jsxs("div",{className:"space-y-16",children:[p.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-[2.5rem] p-12 shadow-inner",children:[p.jsxs("h4",{className:"text-slate-900 font-black mb-8 uppercase tracking-[0.4em] text-[10px] flex items-center gap-3",children:[p.jsx("span",{className:"w-2 h-2 bg-indigo-500 rounded-full animate-ping"})," Structural Protocol"]}),p.jsx("div",{className:"whitespace-pre-wrap text-base text-slate-600 leading-[2] font-medium opacity-80 max-h-[500px] overflow-y-auto pr-8 custom-scrollbar",children:e.outlines[q]}),!e.finalScripts[q]&&p.jsx("button",{onClick:()=>S(q),disabled:e.loading.script,className:`mt-12 bg-emerald-600 hover:bg-emerald-700 text-white font-black px-12 py-8 rounded-2xl shadow-2xl transition-all uppercase tracking-widest text-xs ${e.loading.script?"opacity-30 cursor-not-allowed":"hover:scale-[1.02] active:scale-95"}`,children:e.loading.script?"ang vit...":"Vit kch bn hon chnh"})]}),e.finalScripts[q]&&p.jsxs("div",{className:"space-y-12 animate-in zoom-in-95 duration-[1200ms]",children:[p.jsxs("div",{className:"bg-[#020617] text-white rounded-[3.5rem] p-16 lg:p-24 shadow-[0_50px_100px_-20px_rgba(0,0,0,0.5)]",children:[p.jsx("h4",{className:"text-indigo-400 font-black uppercase text-xs tracking-[0.5em] border-b border-white/5 pb-8 mb-12",children:"Final Master Copy"}),p.jsx("div",{className:"whitespace-pre-wrap text-lg lg:text-xl font-bold tracking-tight leading-relaxed text-slate-100",children:e.finalScripts[q]})]}),p.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-8",children:[p.jsxs("button",{onClick:N,className:"bg-amber-500 hover:bg-amber-600 text-white font-black px-12 py-10 rounded-3xl shadow-2xl transition-all hover:scale-[1.03] active:scale-95 flex flex-col items-center gap-4 text-center group",children:[p.jsx("svg",{className:"w-8 h-8 group-hover:rotate-45 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})}),p.jsxs("div",{children:[p.jsx("div",{className:"text-xl",children:"Thit lp Styles & NV"}),p.jsx("div",{className:"text-[10px] opacity-60 mt-2 uppercase tracking-widest",children:"Tip tc thit k hnh nh"})]})]}),p.jsxs("button",{onClick:()=>k(q),className:"bg-indigo-600 hover:bg-indigo-700 text-white font-black px-12 py-10 rounded-3xl shadow-2xl transition-all hover:scale-[1.03] active:scale-95 flex flex-col items-center gap-4 text-center group",children:[p.jsx("svg",{className:"w-8 h-8 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),p.jsxs("div",{children:[p.jsx("div",{className:"text-xl",children:"Bt u Chia TAGS"}),p.jsx("div",{className:"text-[10px] opacity-60 mt-2 uppercase tracking-widest",children:"Shot Decomposition"})]})]})]}),e.tags[q]&&p.jsxs("div",{className:"space-y-16 pt-24 border-t-8 border-slate-100",children:[p.jsx("h3",{className:"text-5xl font-black text-slate-900 tracking-tighter italic",children:"Alpha Production Tags"}),e.tags[q].map((J,R)=>p.jsxs("div",{className:"bg-white border-4 border-slate-50 rounded-[4rem] p-12 md:p-16 space-y-12 shadow-sm transition-all animate-in slide-in-from-bottom-16 duration-700",children:[p.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-8",children:[p.jsxs("div",{className:"flex items-center gap-6",children:[p.jsxs("div",{className:"bg-[#020617] text-white px-6 py-2 rounded-xl text-xs font-black uppercase tracking-widest",children:["TAG #",R+1]}),p.jsxs("div",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest",children:[m(J.content)," units identified"]})]}),p.jsxs("div",{className:"flex gap-4",children:[p.jsx("button",{onClick:()=>$(J.actions),disabled:J.actions.length===0,className:"bg-indigo-50 hover:bg-indigo-100 text-indigo-600 px-6 py-3 rounded-xl text-xs font-black uppercase tracking-widest transition-all shadow-sm border border-indigo-100 disabled:opacity-30",children:"Copy All Video"}),p.jsx("button",{onClick:()=>V(q,R),disabled:J.isAnalyzing,className:"bg-indigo-600 hover:bg-indigo-700 disabled:bg-slate-100 text-white font-black px-10 py-4 rounded-xl text-xs transition-all shadow-xl uppercase tracking-widest",children:J.isAnalyzing?"Processing...":"To Motion Prompts"})]})]}),p.jsx("div",{className:"p-10 bg-slate-50 rounded-[2.5rem] text-slate-500 text-lg italic font-medium leading-relaxed border-2 border-slate-100",children:J.content}),J.actions.length>0&&p.jsx("div",{className:"grid grid-cols-1 gap-12 mt-12",children:J.actions.map((A,I)=>p.jsxs("div",{className:"space-y-8 animate-in slide-in-from-bottom-12 duration-1000",children:[p.jsxs("div",{className:"flex items-center gap-6",children:[p.jsx("div",{className:"w-10 h-10 bg-slate-900 text-white rounded-lg flex items-center justify-center font-black text-sm",children:I+1}),p.jsx("div",{className:"h-px flex-1 bg-slate-100"})]}),p.jsxs("div",{className:"grid grid-cols-1 gap-8",children:[p.jsxs("div",{className:"bg-[#020617] text-white p-10 rounded-[2.5rem] shadow-3xl",children:[p.jsx("div",{className:"text-[10px] font-black uppercase text-indigo-400 mb-4 tracking-widest",children:"Shot Execution"}),p.jsx("div",{className:"text-xl font-bold leading-relaxed",children:A.action})]}),p.jsxs("div",{className:"bg-indigo-50 border-l-[10px] border-indigo-400 p-10 rounded-[2.5rem] shadow-inner",children:[p.jsx("div",{className:"text-[10px] font-black text-indigo-400 uppercase tracking-widest mb-4",children:"Master Transcript"}),p.jsx("div",{className:"text-xl font-bold text-indigo-900 italic font-serif",children:A.voiceText?`"${A.voiceText}"`:"--- Instrumental Segment ---"})]}),p.jsxs("div",{className:"bg-[#FFF1F2] border-l-[10px] border-rose-400 p-10 rounded-[2.5rem] relative group shadow-lg",children:[p.jsxs("div",{className:"flex items-center justify-between mb-4",children:[p.jsx("div",{className:"text-[10px] font-black text-rose-400 uppercase tracking-[0.3em]",children:"Video Motion AI Prompt"}),p.jsx("button",{onClick:()=>F(A.motionPrompt),className:"bg-white/80 hover:bg-white p-2 rounded-lg text-rose-500 shadow-sm transition-all active:scale-90",children:p.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"})})})]}),p.jsx("div",{className:"text-sm font-bold text-rose-950 leading-relaxed italic bg-white/40 p-6 rounded-2xl border border-rose-200",children:A.motionPrompt})]})]})]},I))})]},R))]})]})]}):p.jsx("button",{onClick:()=>T(q),disabled:e.loading.outline,className:"bg-[#020617] text-white px-12 py-8 rounded-2xl font-black shadow-2xl hover:bg-indigo-700 hover:scale-[1.02] active:scale-95 transition-all text-sm uppercase tracking-widest",children:e.loading.outline&&e.selectedIdeaIndex===q?"Kin trc...":"Chn & Lp dn "})})]},q))]}):p.jsxs("div",{className:"h-full min-h-[900px] flex flex-col items-center justify-center text-slate-200 space-y-16 border-8 border-dashed border-slate-100 rounded-[6rem] bg-white/50 backdrop-blur-3xl group hover:border-indigo-100 transition-all duration-[2000ms]",children:[p.jsx("div",{className:"relative",children:p.jsx("div",{className:"w-56 h-56 bg-white rounded-[4.5rem] flex items-center justify-center shadow-3xl group-hover:rotate-12 transition-all",children:p.jsx("svg",{className:"w-24 h-24 text-slate-100",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})})})}),p.jsxs("div",{className:"text-center space-y-6",children:[p.jsx("h3",{className:"text-4xl font-black italic uppercase tracking-[0.5em] text-slate-300",children:"Quang Huy Production"}),p.jsx("p",{className:"text-sm font-bold text-slate-400 uppercase tracking-widest opacity-40 italic",children:"Waiting for initial data analysis to start production sequence..."})]})]})})]}),p.jsxs("footer",{className:"w-full p-20 text-center border-t border-slate-100 bg-white mt-40",children:[p.jsxs("h4",{className:"text-2xl font-black tracking-tighter uppercase text-[#020617]",children:["QUANG HUY ",p.jsx("span",{className:"text-indigo-600",children:"VIDEO"})]}),p.jsx("p",{className:"text-[10px] font-black uppercase tracking-[0.5em] text-slate-400 mt-4",children:"AI Viral Content Engine  2024"})]})]})})},Fg={},EP=n=>{let e=[];if(n&&(e=n.split(`
`).map(t=>t.trim()).filter(t=>t)),e.length===0){const t=Fg==null?void 0:Fg.VITE_GEMINI_API_KEY;t&&e.push(t)}return e},SP=["gemini-2.0-flash-lite-preview-02-05","gemini-2.5-flash","gemini-2.0-flash-lite-001","gemini-2.0-flash-exp","gemini-2.0-flash-001","gemini-2.0-flash","gemini-2.5-pro","gemini-flash-latest"],mu=async(n,e)=>{const t=EP(n);if(t.length===0)throw new Error("No API Keys provided.");let i;for(const a of t){const l=new Kd(a);for(const u of SP)try{const d=l.getGenerativeModel({model:u});return await e(d)}catch(d){console.warn(`Failed: Key(...${a.slice(-4)}) Model(${u}) error: ${d.message}`),i=d}}throw i||new Error("All keys and models failed to generate content.")},AP=async(n,e)=>mu(e,async t=>(await t.generateContent([{inlineData:{mimeType:"image/jpeg",data:n}},{text:"Hy phn tch chi tit phong cch hnh nh trong bc nh ny: nh sng, mu sc, gc my, cht liu ngh thut (medium), tm trng v cc c im hnh nh c trng khc. Tr v m t ngn gn nhng sc tch bng ting Vit."}])).response.text()||"Khng th phn tch phong cch."),CP=async(n,e)=>mu(e,async t=>{const i=`Nhim v: c kch bn di y v chia tch thnh cc phn cnh hnh nh tiu biu (Scene Breakdown). Mi phn on phi i din cho mt thng ip hoc giai on cm xc. Sau  hy m tng s phn on.
      
      Kch bn: "${n}"
      
      Tr v JSON: { "breakdown": string, "count": number }`,a={responseMimeType:"application/json"},l=await t.generateContent({contents:[{role:"user",parts:[{text:i}]}],generationConfig:a}),u=JSON.parse(l.response.text()||"{}");let d=u.breakdown||"";return typeof d!="string"&&(d=JSON.stringify(d)),{breakdown:d,count:Number(u.count)||0}}),NP=async(n,e,t,i)=>mu(i,async a=>{const l=`Da vo phn tch phn cnh: "${e}" v s lng ${t} phn on. Hy chia ni dung kch bn gc di y thnh ng ${t} hng tng ng vi cc phn on.
        
        QUY TC CC K QUAN TRNG:
        - KHNG C XO B BT C K T NO ca kch bn gc.
        - Ch c thm xung dng  phn tch cc on.
        - Tr v danh sch cc chui tng ng vi mi phn cnh.
        
        Kch bn gc: "${n}"`,u=await a.generateContent({contents:[{role:"user",parts:[{text:l}]}],generationConfig:{responseMimeType:"application/json"}}),d=JSON.parse(u.response.text()||"[]");return Array.isArray(d)?d.map(g=>typeof g=="string"?g:typeof g=="object"&&g!==null?g.content||g.text||g.description||g.script_content||g.row||JSON.stringify(g):String(g)):[]}),RP=async(n,e,t)=>mu(t,async i=>{const a=`Hy to ra Image Prompts cho Midjourney/Stable Diffusion da trn cc on kch bn sau v phong cch hnh nh c cung cp.
        
        Phong cch (Style): ${e}
        
        Cu trc Prompt (Ting Anh): [Subject], [Action], [Environment], [Lighting/Atmosphere], [Camera Angle/Lens], [Style].
        
        Cc on kch bn cn to prompt:
        ${n.map((u,d)=>`${d+1}. ${u}`).join(`
`)}
        
        Tr v mng JSON cha cc prompt tng ng theo th t (mng string).`,l=await i.generateContent({contents:[{role:"user",parts:[{text:a}]}],generationConfig:{responseMimeType:"application/json"}});return JSON.parse(l.response.text()||"[]")}),kP=async(n,e,t)=>mu(t,async i=>{const a=`Da vo ni dung kch bn v cc prompt nh  c, hy to ra cc "Video Motion Prompts" (Prompt chuyn ng cho video) tng ng.
        
        Yu cu:
        - Mi prompt video phi m t chuyn ng ca ch th v my nh (Camera motion, subject action, dynamic transitions).
        - Ngn ng: Ting Anh.
        - Kt qu phi l mt mng chui, mi chui tng ng vi mt hng kch bn.
        
        Kch bn & Prompt nh:
        ${n.map((u,d)=>`Hng ${d+1}: [Kch bn: ${u}] [Prompt nh: ${e[d]||"N/A"}]`).join(`
`)}
        
        Tr v mng JSON (mng string).`,l=await i.generateContent({contents:[{role:"user",parts:[{text:a}]}],generationConfig:{responseMimeType:"application/json"}});return JSON.parse(l.response.text()||"[]")});let sS=class extends Bc.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("ErrorBoundary caught error:",e,t)}render(){var e;return this.state.hasError?p.jsxs("div",{className:"p-8 m-8 bg-red-50 border border-red-200 rounded-xl space-y-4 text-center",children:[p.jsx("h2",{className:"text-xl font-bold text-red-700",children:" xy ra li hin th"}),p.jsx("p",{className:"text-red-600",children:(e=this.state.error)==null?void 0:e.message}),p.jsx("button",{onClick:()=>this.setState({hasError:!1}),className:"px-4 py-2 bg-white border border-red-200 text-red-600 rounded-lg hover:bg-red-50",children:"Th li"}),p.jsx("p",{className:"text-xs text-slate-500",children:"D liu vn c lu trong b nh tm."})]}):this.props.children}};const IP=le.forwardRef(({tag:n,style:e,index:t,apiKey:i,onNotify:a},l)=>{const[u,d]=le.useState(n),g=le.useRef(u);le.useEffect(()=>{g.current=u},[u]);const[m,_]=le.useState({}),w=V=>new Promise(F=>setTimeout(F,V)),T=async()=>{_(V=>({...V,analyze:!0}));try{const V=await CP(u.content,i);return d(F=>({...F,analysis:V.breakdown,sceneCount:V.count})),V}catch(V){throw console.error(V),a("Li khi phn tch phn cnh","error"),V}finally{_(V=>({...V,analyze:!1}))}},S=async(V,F)=>{const $=V||u.analysis,D=F||u.sceneCount;if(!$||!D){a("Cn phn tch phn cnh trc","info");return}_(q=>({...q,split:!0}));try{const q=await NP(u.content,$,D,i);return d(J=>({...J,rows:q})),q}catch(q){throw console.error(q),a("Li khi chia hng","error"),q}finally{_(q=>({...q,split:!1}))}},N=async V=>{const F=V||u.rows;if(!F||F.length===0){a("Cn chia hng trc","info");return}_($=>({...$,prompt:!0}));try{const $=await RP(F,e,i);return d(D=>({...D,prompts:$})),$}catch($){throw console.error($),a("Li khi to prompt","error"),$}finally{_($=>({...$,prompt:!1}))}},M=async()=>{if(!u.rows||u.rows.length===0){a("Cn chia hng trc","info");return}_(V=>({...V,videoPrompt:!0}));try{const V=await kP(u.rows,u.prompts||[],i);d(F=>({...F,videoPrompts:V}))}catch(V){console.error(V),a("Li khi to prompt video","error")}finally{_(V=>({...V,videoPrompt:!1}))}},k=V=>{if(!V||V.length===0)return;const F=V.map($=>$.trim()).filter($=>$.length>0).map($=>$.replace(/\r?\n|\r/g," ")).map($=>$.replace(/^["']+|["']+$/g,"")).join(`
`);navigator.clipboard.writeText(F),a(" sao chp ni dung chnh xc theo tng hng!","success")};return le.useImperativeHandle(l,()=>({runAutoSequence:async()=>{const V=await T();await w(5e3);const F=await S(V.breakdown,V.count);await w(5e3),await N(F)},getRows:()=>g.current.rows||[],getPrompts:()=>g.current.prompts||[]}),[]),p.jsxs("div",{className:`bg-white rounded-2xl shadow-sm border p-6 space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500 transition-colors ${Object.values(m).some(V=>V)?"border-indigo-300 ring-1 ring-indigo-100":"border-gray-100"}`,children:[p.jsxs("div",{className:"flex items-center justify-between border-b border-gray-50 pb-4",children:[p.jsxs("h3",{className:"font-bold text-gray-800 flex items-center gap-2",children:[p.jsxs("span",{className:"w-10 h-10 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center text-xs font-bold",children:["TAG ",t+1]}),"Phn kch bn"]}),u.sceneCount!==void 0&&p.jsxs("span",{className:"px-3 py-1 bg-green-100 text-green-700 rounded-full text-xs font-bold",children:[u.sceneCount," Phn on"]})]}),p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"space-y-1",children:[p.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Ni dung kch bn"}),p.jsx("div",{className:"p-4 bg-gray-50 rounded-xl border border-gray-100 text-sm text-gray-700 max-h-48 overflow-y-auto whitespace-pre-wrap leading-relaxed",children:u.content})]}),p.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[p.jsx("button",{onClick:()=>T(),disabled:m.analyze,className:`py-2.5 px-3 rounded-xl text-xs font-semibold transition-all flex items-center justify-center gap-2 ${m.analyze?"bg-gray-100 text-gray-400":"bg-blue-50 text-blue-700 hover:bg-blue-100 active:scale-95"}`,children:m.analyze?"...":"Phn Tch"}),p.jsx("button",{onClick:()=>S(),disabled:m.split||!u.analysis,className:`py-2.5 px-3 rounded-xl text-xs font-semibold transition-all flex items-center justify-center gap-2 ${m.split||!u.analysis?"bg-gray-100 text-gray-400":"bg-teal-50 text-teal-700 hover:bg-teal-100 active:scale-95"}`,children:m.split?"...":"Chia hng"}),p.jsx("button",{onClick:()=>N(),disabled:m.prompt||!u.rows,className:`py-2.5 px-3 rounded-xl text-xs font-semibold transition-all flex items-center justify-center gap-2 ${m.prompt||!u.rows?"bg-gray-100 text-gray-400":"bg-purple-50 text-purple-700 hover:bg-purple-100 active:scale-95"}`,children:m.prompt?"...":"Prompt nh"}),p.jsx("button",{onClick:()=>M(),disabled:m.videoPrompt||!u.rows,className:`py-2.5 px-3 rounded-xl text-xs font-semibold transition-all flex items-center justify-center gap-2 ${m.videoPrompt||!u.rows?"bg-gray-100 text-gray-400":"bg-rose-50 text-rose-700 hover:bg-rose-100 active:scale-95"}`,children:m.videoPrompt?"...":"Prompt Video"})]}),u.analysis&&p.jsxs("div",{className:"p-4 bg-indigo-50 border border-indigo-100 rounded-xl space-y-2",children:[p.jsx("h4",{className:"text-xs font-bold text-indigo-700 uppercase",children:"Phn tch phn cnh"}),p.jsx("p",{className:"text-sm text-indigo-900 leading-relaxed whitespace-pre-wrap",children:u.analysis})]}),u.rows&&u.rows.length>0&&p.jsxs("div",{className:"space-y-3",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:["Kch bn  chia hng (",u.rows.length,")"]}),p.jsx("button",{onClick:()=>k(u.rows||[]),className:"text-[10px] font-bold text-indigo-500 hover:text-indigo-700 uppercase flex items-center gap-1",children:"Copy All"})]}),p.jsx("div",{className:"space-y-2",children:u.rows.map((V,F)=>p.jsxs("div",{className:"p-3 bg-white border border-gray-100 rounded-lg text-sm flex gap-3",children:[p.jsx("span",{className:"text-indigo-300 font-mono text-xs",children:F+1}),p.jsxs("span",{className:"text-gray-700 italic",children:['"',V,'"']})]},F))})]}),u.prompts&&u.prompts.length>0&&p.jsxs("div",{className:"space-y-3 pt-4 border-t border-gray-50",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsx("h4",{className:"text-xs font-bold text-purple-700 uppercase tracking-wider",children:"Image Prompts"}),p.jsx("button",{onClick:()=>k(u.prompts||[]),className:"text-[10px] font-bold text-purple-500 hover:text-purple-700 uppercase flex items-center gap-1",children:"Copy All"})]}),p.jsx("div",{className:"space-y-3",children:u.prompts.map((V,F)=>p.jsxs("div",{className:"p-4 bg-purple-50 border border-purple-100 rounded-xl text-sm font-mono text-purple-900 leading-relaxed",children:[p.jsxs("div",{className:"text-[10px] font-bold text-purple-400 mb-1",children:["PROMPT #",F+1]}),V]},F))})]})]})]})}),OP=({onStyleChange:n,onSplitScript:e,apiKey:t})=>{const[i,a]=le.useState(null),[l,u]=le.useState(""),[d,g]=le.useState(""),[m,_]=le.useState(!1),w=async S=>{var k;const N=(k=S.target.files)==null?void 0:k[0];if(!N)return;const M=new FileReader;M.onloadend=async()=>{const V=M.result.split(",")[1];a(M.result),_(!0);try{const F=await AP(V,t);u(F),n(F)}catch(F){console.error(F),alert("Li khi phn tch nh: "+(F instanceof Error?F.message:String(F)))}finally{_(!1)}},M.readAsDataURL(N)},T=()=>{d.trim()&&e(d)};return p.jsxs("div",{className:"flex flex-col h-full space-y-6 p-6 border-r border-gray-200 bg-white",children:[p.jsxs("div",{className:"space-y-2",children:[p.jsx("h2",{className:"text-xl font-bold text-indigo-700",children:"HOT AI Visual Director"}),p.jsx("p",{className:"text-xs text-gray-500 italic",children:"Professional image direction & analysis"})]}),p.jsxs("div",{className:"space-y-4",children:[p.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Ti nh phong cch"}),p.jsxs("div",{className:"relative group",children:[p.jsxs("div",{className:`border-2 border-dashed rounded-xl p-4 transition-all duration-300 flex flex-col items-center justify-center cursor-pointer ${i?"border-indigo-400 bg-indigo-50":"border-gray-300 hover:border-indigo-500 hover:bg-gray-50"}`,children:[p.jsx("input",{type:"file",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",onChange:w,accept:"image/*"}),i?p.jsx("img",{src:i,alt:"Reference",className:"w-full h-32 object-cover rounded-lg shadow-sm"}):p.jsxs("div",{className:"text-center",children:[p.jsx("svg",{className:"mx-auto h-10 w-10 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),p.jsx("span",{className:"mt-2 block text-xs font-medium text-gray-600",children:"Click hoc ko th nh vo y"})]})]}),m&&p.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-70 flex items-center justify-center rounded-xl",children:p.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})})]})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Phong cch phn tch"}),p.jsx("textarea",{value:l,onChange:S=>{u(S.target.value),n(S.target.value)},className:"w-full h-32 p-3 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent resize-none bg-gray-50",placeholder:"c im phong cch s hin  y..."})]}),p.jsxs("div",{className:"flex-grow flex flex-col space-y-2",children:[p.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Nhp kch bn"}),p.jsx("textarea",{value:d,onChange:S=>g(S.target.value),className:"flex-grow w-full p-3 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent resize-none",placeholder:"Dn kch bn ca bn vo y..."})]}),p.jsx("button",{onClick:T,className:"w-full py-3 px-4 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-xl shadow-lg transform transition-all active:scale-95 focus:outline-none focus:ring-4 focus:ring-indigo-200",children:"Chia Kch Bn"}),p.jsx("div",{className:"text-[10px] text-gray-400 text-center uppercase tracking-widest",children:" 2024 HOT AI Studio"})]})},jP=({tags:n,style:e,apiKey:t,onNotify:i})=>{const a=le.useRef([]),[l,u]=le.useState(!1),[d,g]=le.useState(""),m=async()=>{if(n.length!==0){u(!0),g("ang x l...");try{for(let T=0;T<a.current.length;T++){const S=a.current[T];S&&(g(`ang x l Tag ${T+1}/${n.length}...`),console.log(`Auto processing tag ${T+1}/${n.length}...`),await S.runAutoSequence())}g("Hon tt!")}catch(T){console.error(T),g("C li xy ra!"),i("Qu trnh t ng b gin on do li.","error")}finally{u(!1),setTimeout(()=>g(""),5e3)}}},_=()=>{const T=[];if(a.current.forEach(S=>{if(S){const M=S.getRows().map(k=>k.trim()).filter(k=>k.length>0).map(k=>k.replace(/\r?\n|\r/g," ")).map(k=>k.replace(/^["']+|["']+$/g,""));T.push(...M)}}),T.length===0){i("Khng c kch bn  chia hng  copy!","info");return}navigator.clipboard.writeText(T.join(`
`)),i(` copy chnh xc ${T.length} hng kch bn!`,"success")},w=()=>{const T=[];if(a.current.forEach(S=>{if(S){const M=S.getPrompts().map(k=>k.trim()).filter(k=>k.length>0).map(k=>k.replace(/\r?\n|\r/g," ")).map(k=>k.replace(/^["']+|["']+$/g,""));T.push(...M)}}),T.length===0){i("Khng c prompt  copy!","info");return}navigator.clipboard.writeText(T.join(`
`)),i(` copy chnh xc ${T.length} prompt!`,"success")};return n.length===0?p.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-gray-400 space-y-4 p-12 bg-white rounded-3xl border border-gray-100 border-dashed",children:[p.jsx("svg",{className:"w-16 h-16 opacity-20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),p.jsx("p",{className:"text-lg font-medium",children:"Cha c kch bn c chia"}),p.jsx("p",{className:"text-sm",children:'Vui lng nhp kch bn v nhn "Chia Kch Bn"  ct tri'})]}):(a.current.length!==n.length&&(a.current=new Array(n.length).fill(null)),p.jsxs("div",{className:"space-y-8 pb-12",children:[p.jsxs("div",{className:"flex flex-wrap items-center gap-3 p-4 bg-gray-100 rounded-2xl sticky top-4 z-10 shadow-sm border border-gray-200",children:[p.jsx("button",{onClick:m,disabled:l,className:`px-6 py-2.5 rounded-xl font-bold text-sm transition-all flex items-center gap-2 ${l?"bg-gray-400 text-white cursor-not-allowed":"bg-gradient-to-r from-indigo-600 to-blue-600 hover:from-indigo-700 hover:to-blue-700 text-white shadow-md active:scale-95"}`,children:l?p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"ang T ng..."]}):p.jsxs(p.Fragment,{children:[p.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"T ng Hon Ton"]})}),p.jsxs("button",{onClick:_,className:"px-5 py-2.5 bg-white border border-gray-200 text-gray-700 rounded-xl font-bold text-sm hover:bg-gray-50 transition-all shadow-sm active:scale-95 flex items-center gap-2",children:[p.jsx("svg",{className:"w-4 h-4 text-teal-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),"Copy All Kch Bn"]}),p.jsxs("button",{onClick:w,className:"px-5 py-2.5 bg-white border border-gray-200 text-gray-700 rounded-xl font-bold text-sm hover:bg-gray-50 transition-all shadow-sm active:scale-95 flex items-center gap-2",children:[p.jsx("svg",{className:"w-4 h-4 text-purple-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Copy All Prompt Anh"]})]}),d&&p.jsxs("div",{className:`mx-4 mt-2 p-3 rounded-xl text-sm font-bold flex items-center gap-2 ${d==="C li xy ra!"?"bg-red-50 text-red-600":"bg-green-50 text-green-700 border border-green-200"}`,children:[d==="Hon tt!"?p.jsx("svg",{className:"w-5 h-5 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}):p.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-current border-t-transparent animate-spin"}),d]}),p.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[p.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Bng iu Khin Tags"}),p.jsx("div",{className:"h-px flex-grow bg-gray-100"}),p.jsxs("span",{className:"text-sm font-medium text-gray-400",children:[n.length," TAGS SN SNG"]})]}),p.jsx("div",{className:"space-y-8",children:n.map((T,S)=>p.jsx(IP,{tag:T,style:e,index:S,apiKey:t,ref:N=>{a.current[S]=N},onNotify:i},T.id))})]}))},DP=({userId:n})=>{const[e,t]=le.useState(""),[i,a]=le.useState([]),[l,u]=le.useState(""),[d,g]=le.useState(null),m=(T,S="info")=>{g({message:T,type:S}),setTimeout(()=>g(null),5e3)};le.useEffect(()=>{if(n)try{const T=`app_api_keys_${n}`,S=localStorage.getItem(T);if(S){const N=JSON.parse(S),k=atob(N.gemini||"").split(`
`).map(V=>V.trim()).filter(V=>V);u(k.join(`
`))}}catch(T){console.error("Failed to load API key",T)}},[n]);const _=le.useCallback(T=>{const S=/[\u3040-\u30ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff\uff66-\uff9f]/.test(T);let N=[];if(S)for(let k=0;k<T.length;k+=2e3)N.push(T.substring(k,k+2e3));else{const k=T.split(/\s+/),V=1400;for(let F=0;F<k.length;F+=V)N.push(k.slice(F,F+V).join(" "))}const M=N.map((k,V)=>({id:crypto.randomUUID(),content:k}));a(M)},[]),w=T=>{t(T)};return p.jsxs("div",{className:"flex h-screen w-full overflow-hidden bg-gray-50",children:[p.jsx("aside",{className:"w-[30%] min-w-[320px] max-w-[450px] flex-shrink-0 h-full",children:p.jsx(OP,{onStyleChange:w,onSplitScript:_,apiKey:l})}),p.jsx("main",{className:"flex-grow h-full overflow-y-auto p-8 lg:p-12 scroll-smooth",children:p.jsxs("div",{className:"max-w-4xl mx-auto",children:[p.jsxs("header",{className:"mb-12",children:[p.jsxs("h1",{className:"text-4xl font-extrabold text-gray-900 tracking-tight",children:["HOT ",p.jsx("span",{className:"text-indigo-600",children:"AI"})]}),p.jsx("p",{className:"mt-2 text-gray-500 font-medium",children:"H thng sn xut Visual Prompts chuyn nghip"})]}),p.jsx(sS,{children:p.jsxs("div",{className:"relative",children:[d&&p.jsx("div",{className:"fixed top-4 right-4 z-50 animate-in slide-in-from-right fade-in duration-300",children:p.jsxs("div",{className:`px-6 py-4 rounded-2xl shadow-2xl flex items-center gap-3 font-bold text-sm ${d.type==="error"?"bg-rose-50 text-rose-600 border border-rose-100":d.type==="success"?"bg-emerald-50 text-emerald-600 border border-emerald-100":"bg-white text-slate-700 border border-slate-100"}`,children:[d.type==="success"&&p.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),d.type==="error"&&p.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),d.message]})}),p.jsx(jP,{tags:i,style:e,apiKey:l,onNotify:m})]})})]})})]})};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PP=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),MP=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),vx=n=>{const e=MP(n);return e.charAt(0).toUpperCase()+e.slice(1)},iS=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim(),LP=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var UP={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VP=le.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:a="",children:l,iconNode:u,...d},g)=>le.createElement("svg",{ref:g,...UP,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:iS("lucide",a),...!l&&!LP(d)&&{"aria-hidden":"true"},...d},[...u.map(([m,_])=>le.createElement(m,_)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sn=(n,e)=>{const t=le.forwardRef(({className:i,...a},l)=>le.createElement(VP,{ref:l,iconNode:e,className:iS(`lucide-${PP(vx(n))}`,`lucide-${n}`,i),...a}));return t.displayName=vx(n),t};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BP=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],zP=Sn("activity",BP);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HP=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],$P=Sn("camera",HP);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qP=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],rS=Sn("circle-check",qP);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FP=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],GP=Sn("clipboard-list",FP);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KP=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],aS=Sn("copy",KP);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YP=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],_x=Sn("image",YP);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WP=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],QP=Sn("layers",WP);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JP=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],ba=Sn("loader-circle",JP);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XP=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],oS=Sn("play",XP);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZP=[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]],lS=Sn("scissors",ZP);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eM=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],cS=Sn("trash-2",eM);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tM=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],bx=Sn("upload",tM);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nM=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],sM=Sn("video",nM);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iM=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],wx=Sn("zap",iM),Gg={},rM=n=>{let e=[];if(n&&(e=n.split(`
`).map(t=>t.trim()).filter(t=>t)),e.length===0){const t=Gg==null?void 0:Gg.VITE_GEMINI_API_KEY;t&&e.push(t)}return e},aM=["gemini-2.0-flash-lite-preview-02-05","gemini-2.5-flash","gemini-2.0-flash-lite-001","gemini-2.0-flash-exp","gemini-2.0-flash-001","gemini-2.0-flash","gemini-2.5-pro","gemini-flash-latest"],dl=async(n,e)=>{const t=rM(n);if(t.length===0)throw new Error("No API Keys provided.");let i;for(const a of t){const l=new Kd(a);for(const u of aM)try{const d=l.getGenerativeModel({model:u});return await e(d)}catch(d){console.warn(`Failed: Key(...${a.slice(-4)}) Model(${u}) error: ${d.message}`),i=d}}throw i||new Error("All keys and models failed to generate content.")},oM=async(n,e)=>dl(e,async t=>(await t.generateContent([{inlineData:{mimeType:"image/jpeg",data:n}},{text:"Analyze this image and describe its visual style in detail (lighting, color palette, texture, composition, atmosphere). Provide a concise but comprehensive paragraph suitable for an image generation prompt style reference."}])).response.text()||"No analysis found."),lM=async(n,e)=>dl(e,async t=>{const i={type:$s.ARRAY,items:{type:$s.OBJECT,properties:{name:{type:$s.STRING},gender:{type:$s.STRING},country:{type:$s.STRING},age:{type:$s.STRING},physique:{type:$s.STRING},features:{type:$s.STRING}},required:["name","gender","country","age","physique","features"]}},a=`Analyze the following script and extract/create characters. For each character, provide: Name, Gender, Country, Age, Physique, and Detailed Facial Features. 
        
        CRITICAL RULES:
        1. If details are missing in the script (Gender, Country, Age, Physique, or Face), you MUST creatively generate them to make the character visually distinct.
        2. Focus HEAVILY on specific facial features: eye shape/color, nose shape, skin texture, wrinkles, hair style/texture/color, and any unique facial markings.
        3. ABSOLUTELY NO clothing, NO personality traits, and NO equipment.
        4. Format the 'features' field as descriptive sentences about the face and hair only.
        
        Example structure: "Mi tc en bng mt vi nhng si bc thanh lch c bi cht thnh kiu tc truyn thng gn gng. Ln da mn mng. i mt nu sm hnh qu hnh m p, np nhn nh quanh khe mt, chic mi nh nhn, thanh t."
        
        Output in JSON format as an array of objects. Script: ${n}`,l=await t.generateContent({contents:[{role:"user",parts:[{text:a}]}],generationConfig:{responseMimeType:"application/json",responseSchema:i}});return JSON.parse(l.response.text()||"[]")}),cM=async(n,e)=>dl(e,async t=>{var u;const i=`Bn l chuyn gia phn tch kch bn. Hy m s lng "hnh ng th gic" (visual actions) chnh trong kch bn di y.
        
        QUY TC:
        1. Ch m cc hnh ng c th c th dng thnh hnh nh (v d: "chy", "cm bento", "nhn xa xm").
        2. B qua cc li dn truyn (narration) mang tnh suy tng v cc suy ngh ni tm khng th hin qua hnh ng/biu cm.
        3. Tr v DUY NHT mt con s.
        
        KCH BN:
        ${n}`,a=await t.generateContent(i),l=parseInt(((u=a.response.text())==null?void 0:u.trim())||"0");return isNaN(l)?0:l}),uM=async(n,e,t)=>dl(t,async i=>{const a=`Bn l mt cng c chia kch bn chuyn nghip. Hy chia kch bn di y thnh ng ${e} hng.
        
        CC QUY TC TI THNG:
        1. CH TR V CC HNG KCH BN. Khng c bt k cu dn nhp no.
        2. GI NGUYN 100% VN BN GC. Tuyt i khng xa b, khng chnh sa, khng thm bt bt k k t no.
        3. Tr v ng ${e} dng, mi dng l mt phn on logic.
        
        KCH BN:
        ${n}`;return((await i.generateContent(a)).response.text()||"").trim().split(`
`).filter(d=>d.trim().length>0)}),hM=async(n,e,t,i,a)=>dl(a,async l=>{const d=`Bn l ZenShot AI - Mt Visual Director k lut st . Nhim v ca bn l chuyn i kch bn thnh Image Prompts cho Midjourney.
    
    QUY TC CT LI (BT BUC TUN TH 100%):
    1. NH DNG: Mi prompt phi nm trn MT HNG DUY NHT (Single line). Khng xung dng bn trong mt prompt.
    2. KHNG TM TT: Copy-paste NGUYN VN m t nhn vt t d liu bn di.
    3. B NH TRNG THI:
       - Nu c thng tin cnh trc (Previous Context), hy k tha trang phc v bi cnh t  tr khi kch bn thay i.
       - Lun duy tr tnh nht qun v qun o v bi cnh cho cc phn on lin tip.
    4. CU TRC PROMPT (Vit lin thnh 1 on vn): 
       [Phong cch/Gc my] + [Hnh ng/Biu cm] + [Tn nhn vt: M t chi tit nguyn vn] + [Trang phc hin ti] + [Bi cnh chi tit] + --ar 16:9
    
    D LIU NHN VT:
    ${t.map(_=>`${_.name}: ${_.gender}, ${_.country}, ${_.age}, ${_.physique}. ${_.features}`).join(`
`)}
    
    PHONG CCH VISUAL:
    ${e}
    
    BI CNH/TRANG PHC CA CC TAG TRC (NU C):
    ${i||"Khng c cnh trc."}
    
    HY TO PROMPT CHO CC PHN ON SAU (Mi prompt 1 hng):
    ${n.map((_,w)=>`Row ${w+1}: ${_}`).join(`
`)}
    
    Ch tr v danh sch cc prompt. Mi prompt l 1 hng.`;return{prompts:((await l.generateContent(d)).response.text()||"").split(`
`).filter(_=>_.trim().length>0)}}),dM=async(n,e,t,i,a)=>dl(a,async l=>{const d=`Bn l o din hnh nh (Visual Director) chuyn v Video/Cinematic. Nhim v ca bn l phn tch ni dung on "Hook" v to Video Prompts (din t chuyn ng).
    
    YU CU CHI TIT:
    1. PHN TCH HNH NG: Mi hnh ng c th trong on Hook phi c mt prompt ring bit.
    2. NG B NHN VT: Copy-paste NGUYN VN m t nhn vt t d liu bn di khi nhn vt  xut hin trong hnh ng.
    3. CHUYN NG (MOTION): M t r loi chuyn ng (v d: "Slo-mo walking", "Cinematic drone shot following", "Close-up of facial expression change").
    4. BI CNH/TRANG PHC: K tha t thng tin bi cnh  cung cp.
    5. NH DNG: Mi prompt l 1 hng duy nht.
    
    CU TRC PROMPT:
    [Loi chuyn ng/Gc my] + [Hnh ng nhn vt] + [M t nhn vt chi tit] + [Trang phc & Bi cnh]
    
    D LIU NHN VT:
    ${t.map(m=>`${m.name}: ${m.gender}, ${m.country}, ${m.age}, ${m.physique}. ${m.features}`).join(`
`)}
    
    PHONG CCH VISUAL:
    ${e}
    
    BI CNH/TRANG PHC K THA:
    ${i||"T do sng to da trn khng kh chung."}
    
    NI DUNG ON HOOK CN X L:
    ${n}
    
    Ch tr v danh sch cc prompt video, mi prompt mt hng.`;return((await l.generateContent(d)).response.text()||"").split(`
`).filter(m=>m.trim().length>0)});class fM extends le.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("ErrorBoundary caught error:",e,t)}render(){var e;return this.state.hasError?p.jsxs("div",{className:"p-8 m-8 bg-slate-900 border border-slate-700 rounded-3xl space-y-4 text-center text-white",children:[p.jsx("h2",{className:"text-xl font-bold text-rose-500",children:" xy ra li hin th"}),p.jsx("p",{className:"text-slate-300",children:(e=this.state.error)==null?void 0:e.message}),p.jsx("button",{onClick:()=>this.setState({hasError:!1}),className:"px-6 py-3 bg-white text-slate-900 font-bold rounded-xl hover:bg-slate-200 transition-all",children:"Th li"}),p.jsx("p",{className:"text-xs text-slate-500",children:"D liu vn c lu trong b nh tm."})]}):this.props.children}}const pM=({userId:n})=>{const[e,t]=le.useState({visualStyle:"",script:"",characters:[],tags:[],hook:"",hookPrompts:[],isAnalyzing:!1,isProcessingScript:!1,isGeneratingHook:!1}),[i,a]=le.useState(!1),[l,u]=le.useState(!1),[d,g]=le.useState(""),[m,_]=le.useState(null),[w,T]=le.useState(null),S=(H,Z="info")=>{T({message:H,type:Z}),setTimeout(()=>T(null),5e3)};le.useEffect(()=>{if(n)try{const H=`app_api_keys_${n}`,Z=localStorage.getItem(H);if(Z){const O=JSON.parse(Z),de=atob(O.gemini||"").split(`
`).map(me=>me.trim()).filter(me=>me);g(de.join(`
`))}}catch(H){console.error("Failed to load API key",H)}},[n]);const N=le.useRef(e.tags);le.useEffect(()=>{N.current=e.tags},[e.tags]);const M=H=>new Promise(Z=>setTimeout(Z,H)),k=async H=>{var se;const Z=(se=H.target.files)==null?void 0:se[0];if(!Z)return;a(!0);const O=new FileReader;O.onload=async de=>{var B;const me=(B=de.target)==null?void 0:B.result;_(me);const qe=me.split(",")[1];try{const ne=await oM(qe,d);t(ue=>({...ue,visualStyle:ne}))}catch(ne){S(`Li phn tch style: ${ne.message||ne}`,"error")}finally{a(!1)}},O.readAsDataURL(Z)},V=async()=>{if(e.script){t(H=>({...H,isProcessingScript:!0}));try{const H=await lM(e.script,d);t(Z=>({...Z,characters:H,isProcessingScript:!1}))}catch(H){S(`Li x l kch bn: ${H.message||H}`,"error"),t(Z=>({...Z,isProcessingScript:!1}))}}},F=H=>{const Z=/[\u3000-\u303f\u3040-\u309f\u30a0-\u30ff\uff00-\uff9f\u4e00-\u9faf\u3400-\u4dbf\uac00-\ud7af]/.test(H),O=[];let se=H;const de=Z?1800:1200,me=Z?2e3:1500,qe=Z?[`
`,"","","",".","!","?"]:[`
`,".","!","?"];for(;se.length>0;)if(Z){if(se.length<=me){O.push(se);break}let B=se.slice(de,me),ne=-1;for(const ue of qe){const fe=B.lastIndexOf(ue);fe>ne&&(ne=fe)}if(ne!==-1){const ue=de+ne+1;O.push(se.slice(0,ue)),se=se.slice(ue)}else O.push(se.slice(0,me)),se=se.slice(me)}else{const B=se.split(/(\s+)/);let ne=0,ue=0,fe=-1,Ee=!1;for(let Ne=0;Ne<B.length;Ne++){const Pe=B[Ne];/\S/.test(Pe)&&ne++;const rt=ue;if(ue+=Pe.length,ne>=de&&ne<=me&&qe.some(Vn=>Pe.includes(Vn))&&(fe=ue),ne>me){const Vn=fe!==-1?fe:rt;O.push(se.slice(0,Vn)),se=se.slice(Vn),Ee=!0;break}}if(!Ee){O.push(se);break}}return O},$=()=>{if(!e.script)return;const Z=F(e.script).map((O,se)=>({id:`tag-${Date.now()}-${se}`,originalContent:O,rows:[O],imageCount:10,prompts:[],status:"idle"}));t(O=>({...O,tags:Z}))},D=(H,Z)=>{t(O=>({...O,tags:O.tags.map(se=>se.id===H?{...se,...Z}:se)}))},q=(H,Z)=>{t(O=>({...O,characters:O.characters.map((se,de)=>de===H?{...se,...Z}:se)}))},J=async H=>{const Z=N.current.find(O=>O.id===H);if(!Z)return!1;D(H,{status:"splitting"});try{const O=await uM(Z.originalContent,Z.imageCount,d);return D(H,{rows:O,status:"ready"}),!0}catch(O){return console.error(`Error splitting rows for TAG: ${H}`,O),S(`Li chia hng: ${O.message||O}`,"error"),D(H,{status:"idle"}),!1}},R=async H=>{const Z=N.current,O=Z.findIndex(me=>me.id===H);if(O===-1)return!1;const se=Z[O];let de="";if(O>0){const me=Z[O-1];me&&me.prompts.length>0&&(de=`y l prompt cui ca Tag trc  bn k tha bi cnh v trang phc: ${me.prompts[me.prompts.length-1]}`)}D(H,{status:"generating"});try{const me=await hM(se.rows,e.visualStyle,e.characters,de,d);if(!me.prompts||me.prompts.length===0)throw new Error("Empty prompts generated");return D(H,{prompts:me.prompts,status:"ready"}),!0}catch(me){return console.error(`Error generating prompts for TAG: ${H}`,me),D(H,{status:"ready"}),!1}},A=async()=>{if(!e.hook||e.characters.length===0){S("Vui lng nhp ni dung Hook v m bo  phn tch nhn vt.","info");return}t(O=>({...O,isGeneratingHook:!0}));let H="";const Z=e.tags[e.tags.length-1];Z&&Z.prompts.length>0&&(H=`K tha bi cnh t prompt ny: ${Z.prompts[Z.prompts.length-1]}`);try{const O=await dM(e.hook,e.visualStyle,e.characters,H,d);t(se=>({...se,hookPrompts:O,isGeneratingHook:!1}))}catch(O){S(`Li to Prompt Video Hook: ${O.message||O}`,"error"),t(se=>({...se,isGeneratingHook:!1}))}},I=async H=>{const Z=e.tags.find(O=>O.id===H);if(Z){D(H,{status:"analyzing"});try{const O=await cM(Z.originalContent,d);D(H,{actionCount:O,status:"idle"})}catch(O){S(`Li phn tch hnh ng: ${O.message||O}`,"error"),D(H,{status:"idle"})}}},L=async()=>{if(e.tags.length===0)return;u(!0);const H=e.tags.map(Z=>Z.id);for(const Z of H){if(!await J(Z)&&!await J(Z))break;await M(1e4);let se=await R(Z);if(se||(await M(1e4),se=await R(Z)),!se&&!confirm(`TAG ${Z} khng th to prompt sau 2 ln th. Bn c mun tip tc cc TAG sau khng?`))break;await M(1e4)}u(!1),S("Hon thnh quy trnh t ng cho tt c cc TAG!","success")},U=()=>{const Z=e.tags.flatMap(O=>(O.status==="ready"||O.status==="generating"?O.rows.join(`
`):O.originalContent).split(`
`).map(de=>de.trim()).filter(de=>de.length>0)).join(`
`);navigator.clipboard.writeText(Z),S(" copy ton b kch bn ca tt c cc TAG!","success")},G=()=>{const H=e.tags.flatMap(Z=>Z.prompts).map(Z=>Z.trim()).filter(Z=>Z.length>0).join(`
`);navigator.clipboard.writeText(H),S(" copy ton b Prompt ca tt c cc TAG!","success")},j=()=>{const H=e.hookPrompts.join(`
`);navigator.clipboard.writeText(H),S(" copy Prompt Video cho Hook!","success")};return p.jsx(fM,{children:p.jsxs("div",{className:"flex h-screen bg-slate-50 overflow-hidden text-slate-900 w-full relative",children:[w&&p.jsx("div",{className:"absolute top-4 right-4 z-50 animate-in slide-in-from-right fade-in duration-300",children:p.jsxs("div",{className:`px-6 py-4 rounded-2xl shadow-2xl flex items-center gap-3 font-bold text-sm ${w.type==="error"?"bg-rose-50 text-rose-600 border border-rose-100":w.type==="success"?"bg-emerald-50 text-emerald-600 border border-emerald-100":"bg-white text-slate-700 border border-slate-100"}`,children:[w.type==="success"&&p.jsx(rS,{className:"w-5 h-5"}),w.type==="error"&&p.jsx(cS,{className:"w-5 h-5"}),w.message]})}),p.jsxs("aside",{className:"w-[30%] bg-white border-r border-slate-200 overflow-y-auto p-6 space-y-8 flex flex-col shrink-0",children:[p.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[p.jsx("div",{className:"bg-indigo-600 p-2 rounded-lg",children:p.jsx($P,{className:"text-white w-6 h-6"})}),p.jsx("h1",{className:"text-xl font-black text-slate-800 tracking-tight uppercase",children:"ZenShot AI"})]}),p.jsxs("div",{className:"space-y-3",children:[p.jsxs("label",{className:"flex items-center gap-2 text-xs font-bold text-slate-500 uppercase tracking-widest",children:[p.jsx(_x,{className:"w-3.5 h-3.5"})," Phong cch hnh nh"]}),p.jsxs("div",{className:`border-2 border-dashed border-slate-200 rounded-xl p-4 transition hover:border-indigo-400 bg-slate-50/50 relative group overflow-hidden ${m?"border-none p-0":""}`,children:[p.jsx("input",{type:"file",accept:"image/*",onChange:k,className:"hidden",id:"image-upload"}),p.jsx("label",{htmlFor:"image-upload",className:`cursor-pointer flex flex-col items-center justify-center gap-2 py-2 w-full h-full ${m?"p-0":""}`,children:i?p.jsxs("div",{className:"py-8 flex flex-col items-center",children:[p.jsx(ba,{className:"animate-spin text-indigo-500 w-8 h-8"}),p.jsx("span",{className:"text-[10px] text-indigo-500 font-bold mt-2 uppercase tracking-wider",children:"ang phn tch..."})]}):m?p.jsxs("div",{className:"relative w-full h-48",children:[p.jsx("img",{src:m,alt:"Style Reference",className:"w-full h-full object-cover rounded-lg shadow-sm"}),p.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity rounded-lg",children:p.jsxs("div",{className:"flex items-center gap-2 text-white text-xs font-bold uppercase tracking-widest bg-black/50 px-3 py-2 rounded-full backdrop-blur-sm border border-white/20",children:[p.jsx(bx,{className:"w-3 h-3"})," Thay i nh"]})})]}):p.jsxs(p.Fragment,{children:[p.jsx(bx,{className:"text-slate-400 w-6 h-6"}),p.jsx("span",{className:"text-[10px] text-slate-400 font-bold uppercase tracking-tighter",children:"Phn tch phong cch qua nh"})]})})]}),p.jsx("textarea",{className:"w-full h-24 p-3 text-sm bg-white border border-slate-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none transition placeholder:italic",placeholder:"Phong cch chi tit s hin  y...",value:e.visualStyle,onChange:H=>t(Z=>({...Z,visualStyle:H.target.value}))})]}),p.jsxs("div",{className:"space-y-3",children:[p.jsx("label",{className:"flex items-center gap-2 text-xs font-bold text-slate-500 uppercase tracking-widest",children:"Nhp kch bn chnh"}),p.jsx("textarea",{className:"w-full h-40 p-3 text-sm border border-slate-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none transition leading-relaxed",placeholder:"Dn kch bn ca bn vo y...",value:e.script,onChange:H=>t(Z=>({...Z,script:H.target.value}))}),p.jsxs("button",{onClick:V,disabled:e.isProcessingScript||!e.script,className:"w-full flex items-center justify-center gap-2 bg-indigo-600 hover:bg-indigo-700 disabled:bg-slate-300 text-white font-bold py-3.5 px-4 rounded-xl transition shadow-lg shadow-indigo-100 uppercase text-xs tracking-widest",children:[e.isProcessingScript?p.jsx(ba,{className:"animate-spin w-4 h-4"}):p.jsx(oS,{className:"w-4 h-4 fill-current"}),"Bt u phn tch kch bn"]})]}),e.characters.length>0&&p.jsxs("div",{className:"space-y-4 pt-4 border-t border-slate-100",children:[p.jsx("label",{className:"flex items-center gap-2 text-xs font-bold text-slate-500 uppercase tracking-widest",children:"Thng tin nhn vt (C th chnh sa)"}),p.jsx("div",{className:"space-y-4 max-h-[500px] overflow-y-auto pr-1",children:e.characters.map((H,Z)=>p.jsxs("div",{className:"p-4 bg-white rounded-xl border border-slate-200 shadow-sm relative overflow-hidden transition hover:border-indigo-300 group",children:[p.jsx("div",{className:"absolute top-0 left-0 w-1 h-full bg-indigo-500"}),p.jsxs("div",{className:"flex flex-col gap-2",children:[p.jsx("input",{className:"font-black text-slate-800 text-[11px] uppercase bg-transparent border-none p-0 focus:ring-0",value:H.name,onChange:O=>q(Z,{name:O.target.value})}),p.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[p.jsx("input",{className:"text-[10px] bg-slate-50 border border-slate-100 rounded px-2 py-1 focus:ring-1 focus:ring-indigo-400",value:H.gender,placeholder:"Gender",onChange:O=>q(Z,{gender:O.target.value})}),p.jsx("input",{className:"text-[10px] bg-slate-50 border border-slate-100 rounded px-2 py-1 focus:ring-1 focus:ring-indigo-400",value:H.age,placeholder:"Age",onChange:O=>q(Z,{age:O.target.value})})]}),p.jsx("textarea",{className:"text-[10px] text-slate-700 leading-relaxed font-medium bg-slate-50 border border-slate-100 rounded p-2 focus:ring-1 focus:ring-indigo-400 resize-none h-20",value:H.features,onChange:O=>q(Z,{features:O.target.value})})]})]},Z))})]}),p.jsx("div",{className:"mt-auto pt-6",children:p.jsxs("button",{onClick:$,disabled:!e.script,className:"w-full flex items-center justify-center gap-2 bg-slate-800 hover:bg-slate-900 text-white font-bold py-3.5 px-4 rounded-xl transition uppercase text-xs tracking-widest",children:[p.jsx(lS,{className:"w-4 h-4"}),"Chia kch bn sang TAG"]})})]}),p.jsxs("main",{className:"flex-1 overflow-y-auto bg-slate-50 scroll-smooth flex flex-col",children:[e.tags.length>0&&p.jsxs("div",{className:"sticky top-0 z-10 bg-white/80 backdrop-blur-md border-b border-slate-200 px-8 py-4 flex items-center justify-between shadow-sm",children:[p.jsx("div",{className:"flex items-center gap-3",children:p.jsxs("button",{onClick:L,disabled:l,className:"flex items-center gap-2 bg-indigo-600 hover:bg-indigo-700 disabled:bg-indigo-300 text-white px-5 py-2.5 rounded-xl font-black text-[11px] uppercase tracking-widest shadow-lg shadow-indigo-100 transition-all active:scale-95",children:[l?p.jsx(ba,{className:"animate-spin w-4 h-4"}):p.jsx(wx,{className:"w-4 h-4 fill-amber-400 text-amber-400"}),"T ng Hon Ton"]})}),p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsxs("button",{onClick:U,className:"flex items-center gap-2 bg-slate-800 hover:bg-slate-900 text-white px-5 py-2.5 rounded-xl font-black text-[11px] uppercase tracking-widest transition-all active:scale-95",children:[p.jsx(GP,{className:"w-4 h-4"}),"Copy All Kch Bn"]}),p.jsxs("button",{onClick:G,className:"flex items-center gap-2 bg-slate-800 hover:bg-slate-900 text-white px-5 py-2.5 rounded-xl font-black text-[11px] uppercase tracking-widest transition-all active:scale-95",children:[p.jsx(QP,{className:"w-4 h-4"}),"Copy All Prompt nh"]})]})]}),p.jsx("div",{className:"max-w-4xl mx-auto space-y-8 p-8 w-full",children:e.tags.length===0?p.jsxs("div",{className:"h-[70vh] flex flex-col items-center justify-center text-slate-300 space-y-6",children:[p.jsx("div",{className:"w-24 h-24 bg-white rounded-full flex items-center justify-center shadow-sm border border-slate-100",children:p.jsx(_x,{className:"w-10 h-10 opacity-40"})}),p.jsxs("div",{className:"text-center",children:[p.jsx("p",{className:"text-xl font-bold text-slate-400",children:"ZenShot Visual Director"}),p.jsx("p",{className:"text-sm text-slate-400 mt-1 uppercase tracking-widest font-bold opacity-60",children:"Split script and start generating prompts"})]})]}):p.jsxs(p.Fragment,{children:[e.tags.map((H,Z)=>p.jsx(gM,{tag:H,index:Z,onSplit:()=>J(H.id),onAnalyze:()=>I(H.id),onGenerate:()=>R(H.id),onUpdateCount:O=>D(H.id,{imageCount:O}),onCopy:()=>{const O=H.prompts.map(se=>se.trim()).join(`
`);navigator.clipboard.writeText(O),S("Copied prompts for this TAG!","success")},onUpdateContent:O=>D(H.id,{originalContent:O}),onDelete:()=>t(O=>({...O,tags:O.tags.filter(se=>se.id!==H.id)}))},H.id)),p.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden transition hover:shadow-lg mt-12 mb-20 p-8 space-y-6",children:[p.jsxs("div",{className:"flex items-center justify-between border-b border-slate-50 pb-4",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("span",{className:"bg-amber-500 text-white text-[10px] font-black px-3 py-1 rounded-full uppercase tracking-widest",children:"VIDEO HOOK"}),p.jsx("h2",{className:"text-sm font-black text-slate-800 uppercase tracking-widest",children:"Phn tch chuyn ng"})]}),p.jsx(sM,{className:"w-5 h-5 text-slate-300"})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Ni dung on Hook"}),p.jsx("textarea",{className:"w-full h-40 p-4 text-sm bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:outline-none resize-none leading-relaxed transition font-medium",placeholder:"Nhp ni dung on Hook kch bn ti y...",value:e.hook,onChange:H=>t(Z=>({...Z,hook:H.target.value}))})]}),e.hookPrompts.length>0&&p.jsxs("div",{className:"space-y-4 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Prompts Video Chuyn ng"}),p.jsxs("button",{onClick:j,className:"flex items-center gap-1.5 text-amber-600 hover:text-amber-700 text-[10px] font-black px-4 py-2 bg-amber-50 rounded-xl transition uppercase tracking-widest shadow-sm shadow-amber-50",children:[p.jsx(aS,{className:"w-3.5 h-3.5"})," Copy Hook Prompts"]})]}),p.jsx("div",{className:"space-y-4",children:e.hookPrompts.map((H,Z)=>p.jsxs("div",{className:"p-4 bg-slate-900 rounded-xl border border-slate-800 relative group transition hover:border-amber-500 shadow-lg",children:[p.jsx("div",{className:"absolute -left-3 top-4 w-7 h-7 bg-amber-500 text-white flex items-center justify-center text-[10px] font-black rounded-full border-2 border-slate-50 shadow-md",children:Z+1}),p.jsx("p",{className:"text-slate-300 text-[11px] font-mono break-words leading-relaxed pl-4",children:H})]},Z))})]}),p.jsxs("button",{onClick:A,disabled:e.isGeneratingHook||!e.hook,className:"w-full flex items-center justify-center gap-2 bg-slate-800 hover:bg-slate-900 disabled:bg-slate-300 text-white font-black py-4.5 rounded-2xl transition shadow-xl shadow-slate-200 uppercase text-xs tracking-[0.2em]",children:[e.isGeneratingHook?p.jsx(ba,{className:"animate-spin w-5 h-5"}):p.jsx(wx,{className:"w-5 h-5 fill-amber-400 text-amber-400"}),"To Prompt Video"]})]})]})})]})]})})},gM=({tag:n,index:e,onSplit:t,onAnalyze:i,onGenerate:a,onUpdateCount:l,onCopy:u,onUpdateContent:d,onDelete:g})=>p.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden transition hover:shadow-lg",children:[p.jsxs("div",{className:"px-6 py-4 bg-slate-50/80 border-b border-slate-100 flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsxs("span",{className:"bg-slate-800 text-white text-[10px] font-black px-3 py-1 rounded-full uppercase tracking-widest",children:["TAG ",e+1]}),p.jsxs("span",{className:"text-[10px] text-slate-400 font-black uppercase tracking-widest",children:[n.originalContent.length," k t"]})]}),p.jsx("button",{onClick:g,className:"text-slate-300 hover:text-red-500 transition p-1",children:p.jsx(cS,{className:"w-4 h-4"})})]}),p.jsxs("div",{className:"p-6 space-y-6",children:[p.jsxs("div",{className:"space-y-2",children:[p.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Kch bn phn on"}),p.jsxs("div",{className:"relative group",children:[p.jsx("textarea",{className:"w-full h-40 p-4 text-sm bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:outline-none resize-none leading-relaxed transition font-medium",value:n.status==="ready"||n.status==="generating"?n.rows.join(`
`):n.originalContent,readOnly:n.status==="ready"||n.status==="generating",onChange:m=>d(m.target.value)}),(n.status==="ready"||n.status==="generating")&&n.rows.length>1&&p.jsxs("div",{className:"absolute top-2 right-2 flex items-center gap-1.5 bg-white text-emerald-600 px-3 py-1.5 rounded-lg text-[10px] font-black border border-emerald-100 shadow-sm uppercase",children:[p.jsx(rS,{className:"w-3 h-3"})," Chia hng xong"]})]})]}),p.jsxs("div",{className:"flex flex-wrap gap-6 items-end border-y border-slate-50 py-4",children:[p.jsxs("div",{className:"flex-1 space-y-2",children:[p.jsxs("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest flex items-center gap-2",children:[p.jsx(zP,{className:"w-3 h-3"})," Phn tch hnh ng"]}),p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsx("button",{onClick:i,disabled:n.status==="analyzing",className:"flex items-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-800 text-[10px] font-black rounded-lg transition uppercase tracking-widest",children:n.status==="analyzing"?p.jsx(ba,{className:"animate-spin w-3 h-3"}):"Phn tch"}),n.actionCount!==void 0&&p.jsxs("div",{className:"flex items-center gap-1.5 text-indigo-600 font-black text-sm",children:[p.jsx("span",{className:"text-[10px] text-slate-400 font-bold",children:"S hnh ng:"})," ",n.actionCount]})]})]}),p.jsxs("div",{className:"w-40 space-y-2",children:[p.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"S lng nh"}),p.jsxs("div",{className:"relative flex items-center",children:[p.jsx("button",{onClick:()=>l(Math.max(1,n.imageCount-1)),className:"absolute left-1 w-7 h-7 flex items-center justify-center bg-slate-100 hover:bg-slate-200 text-slate-600 rounded-lg font-bold",children:"-"}),p.jsx("input",{type:"number",min:"1",max:"100",className:"w-full h-10 px-8 text-center border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:outline-none font-bold text-slate-700",value:n.imageCount,onChange:m=>l(parseInt(m.target.value)||1)}),p.jsx("button",{onClick:()=>l(n.imageCount+1),className:"absolute right-1 w-7 h-7 flex items-center justify-center bg-slate-100 hover:bg-slate-200 text-slate-600 rounded-lg font-bold",children:"+"})]})]}),p.jsxs("button",{onClick:t,disabled:n.status==="splitting",className:"h-10 px-6 flex items-center justify-center gap-2 bg-slate-800 hover:bg-slate-900 text-white font-bold rounded-xl transition uppercase text-[10px] tracking-widest shadow-sm",children:[n.status==="splitting"?p.jsx(ba,{className:"animate-spin w-3 h-3"}):p.jsx(lS,{className:"w-3 h-3"}),"Chia hng"]})]}),n.prompts.length>0&&p.jsxs("div",{className:"space-y-4 pt-6",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Prompts Midjourney"}),p.jsxs("button",{onClick:u,className:"flex items-center gap-1.5 text-indigo-600 hover:text-indigo-700 text-[10px] font-black px-4 py-2 bg-indigo-50 rounded-xl transition uppercase tracking-widest shadow-sm shadow-indigo-50",children:[p.jsx(aS,{className:"w-3.5 h-3.5"})," Sao chp Tag ny"]})]}),p.jsx("div",{className:"space-y-4 max-h-[600px] overflow-y-auto pr-2 custom-scrollbar",children:n.prompts.map((m,_)=>p.jsxs("div",{className:"p-4 bg-slate-900 rounded-xl border border-slate-800 relative group transition hover:border-indigo-500 shadow-lg",children:[p.jsx("div",{className:"absolute -left-3 top-4 w-7 h-7 bg-indigo-600 text-white flex items-center justify-center text-[10px] font-black rounded-full border-2 border-slate-50 shadow-md",children:_+1}),p.jsx("p",{className:"text-slate-300 text-[11px] font-mono break-words leading-relaxed pl-4",children:m})]},_))})]}),p.jsxs("button",{onClick:a,disabled:n.status==="generating",className:"w-full flex items-center justify-center gap-2 bg-indigo-600 hover:bg-indigo-700 disabled:bg-indigo-300 text-white font-black py-4.5 rounded-2xl transition shadow-xl shadow-indigo-200 uppercase text-xs tracking-[0.2em]",children:[n.status==="generating"?p.jsx(ba,{className:"animate-spin w-5 h-5"}):p.jsx(oS,{className:"w-5 h-5 fill-current"}),"To Prompt nh"]})]})]});function bf(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t}function mM(n,e,t,i){function a(l){return l instanceof t?l:new t(function(u){u(l)})}return new(t||(t=Promise))(function(l,u){function d(_){try{m(i.next(_))}catch(w){u(w)}}function g(_){try{m(i.throw(_))}catch(w){u(w)}}function m(_){_.done?l(_.value):a(_.value).then(d,g)}m((i=i.apply(n,e||[])).next())})}const yM=n=>n?(...e)=>n(...e):(...e)=>fetch(...e);class L0 extends Error{constructor(e,t="FunctionsError",i){super(e),this.name=t,this.context=i}}class vM extends L0{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class xx extends L0{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Tx extends L0{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Im;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(Im||(Im={}));class _M{constructor(e,{headers:t={},customFetch:i,region:a=Im.Any}={}){this.url=e,this.headers=t,this.region=a,this.fetch=yM(i)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return mM(this,arguments,void 0,function*(t,i={}){var a;let l,u;try{const{headers:d,method:g,body:m,signal:_,timeout:w}=i;let T={},{region:S}=i;S||(S=this.region);const N=new URL(`${this.url}/${t}`);S&&S!=="any"&&(T["x-region"]=S,N.searchParams.set("forceFunctionRegion",S));let M;m&&(d&&!Object.prototype.hasOwnProperty.call(d,"Content-Type")||!d)?typeof Blob<"u"&&m instanceof Blob||m instanceof ArrayBuffer?(T["Content-Type"]="application/octet-stream",M=m):typeof m=="string"?(T["Content-Type"]="text/plain",M=m):typeof FormData<"u"&&m instanceof FormData?M=m:(T["Content-Type"]="application/json",M=JSON.stringify(m)):m&&typeof m!="string"&&!(typeof Blob<"u"&&m instanceof Blob)&&!(m instanceof ArrayBuffer)&&!(typeof FormData<"u"&&m instanceof FormData)?M=JSON.stringify(m):M=m;let k=_;w&&(u=new AbortController,l=setTimeout(()=>u.abort(),w),_?(k=u.signal,_.addEventListener("abort",()=>u.abort())):k=u.signal);const V=yield this.fetch(N.toString(),{method:g||"POST",headers:Object.assign(Object.assign(Object.assign({},T),this.headers),d),body:M,signal:k}).catch(q=>{throw new vM(q)}),F=V.headers.get("x-relay-error");if(F&&F==="true")throw new xx(V);if(!V.ok)throw new Tx(V);let $=((a=V.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),D;return $==="application/json"?D=yield V.json():$==="application/octet-stream"||$==="application/pdf"?D=yield V.blob():$==="text/event-stream"?D=V:$==="multipart/form-data"?D=yield V.formData():D=yield V.text(),{data:D,error:null,response:V}}catch(d){return{data:null,error:d,response:d instanceof Tx||d instanceof xx?d.context:void 0}}finally{l&&clearTimeout(l)}})}}var bM=class extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}},wM=class{constructor(n){var e,t;this.shouldThrowOnError=!1,this.method=n.method,this.url=n.url,this.headers=new Headers(n.headers),this.schema=n.schema,this.body=n.body,this.shouldThrowOnError=(e=n.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=n.signal,this.isMaybeSingle=(t=n.isMaybeSingle)!==null&&t!==void 0?t:!1,n.fetch?this.fetch=n.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(n,e){return this.headers=new Headers(this.headers),this.headers.set(n,e),this}then(n,e){var t=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const i=this.fetch;let a=i(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async l=>{let u=null,d=null,g=null,m=l.status,_=l.statusText;if(l.ok){var w,T;if(t.method!=="HEAD"){var S;const V=await l.text();V===""||(t.headers.get("Accept")==="text/csv"||t.headers.get("Accept")&&(!((S=t.headers.get("Accept"))===null||S===void 0)&&S.includes("application/vnd.pgrst.plan+text"))?d=V:d=JSON.parse(V))}const M=(w=t.headers.get("Prefer"))===null||w===void 0?void 0:w.match(/count=(exact|planned|estimated)/),k=(T=l.headers.get("content-range"))===null||T===void 0?void 0:T.split("/");M&&k&&k.length>1&&(g=parseInt(k[1])),t.isMaybeSingle&&t.method==="GET"&&Array.isArray(d)&&(d.length>1?(u={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,g=null,m=406,_="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{var N;const M=await l.text();try{u=JSON.parse(M),Array.isArray(u)&&l.status===404&&(d=[],u=null,m=200,_="OK")}catch{l.status===404&&M===""?(m=204,_="No Content"):u={message:M}}if(u&&t.isMaybeSingle&&(!(u==null||(N=u.details)===null||N===void 0)&&N.includes("0 rows"))&&(u=null,m=200,_="OK"),u&&t.shouldThrowOnError)throw new bM(u)}return{error:u,data:d,count:g,status:m,statusText:_}});return this.shouldThrowOnError||(a=a.catch(l=>{var u;let d="";const g=l==null?void 0:l.cause;if(g){var m,_,w,T;const N=(m=g==null?void 0:g.message)!==null&&m!==void 0?m:"",M=(_=g==null?void 0:g.code)!==null&&_!==void 0?_:"";d=`${(w=l==null?void 0:l.name)!==null&&w!==void 0?w:"FetchError"}: ${l==null?void 0:l.message}`,d+=`

Caused by: ${(T=g==null?void 0:g.name)!==null&&T!==void 0?T:"Error"}: ${N}`,M&&(d+=` (${M})`),g!=null&&g.stack&&(d+=`
${g.stack}`)}else{var S;d=(S=l==null?void 0:l.stack)!==null&&S!==void 0?S:""}return{error:{message:`${(u=l==null?void 0:l.name)!==null&&u!==void 0?u:"FetchError"}: ${l==null?void 0:l.message}`,details:d,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),a.then(n,e)}returns(){return this}overrideTypes(){return this}},xM=class extends wM{select(n){let e=!1;const t=(n??"*").split("").map(i=>/\s/.test(i)&&!e?"":(i==='"'&&(e=!e),i)).join("");return this.url.searchParams.set("select",t),this.headers.append("Prefer","return=representation"),this}order(n,{ascending:e=!0,nullsFirst:t,foreignTable:i,referencedTable:a=i}={}){const l=a?`${a}.order`:"order",u=this.url.searchParams.get(l);return this.url.searchParams.set(l,`${u?`${u},`:""}${n}.${e?"asc":"desc"}${t===void 0?"":t?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:e,referencedTable:t=e}={}){const i=typeof t>"u"?"limit":`${t}.limit`;return this.url.searchParams.set(i,`${n}`),this}range(n,e,{foreignTable:t,referencedTable:i=t}={}){const a=typeof i>"u"?"offset":`${i}.offset`,l=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(a,`${n}`),this.url.searchParams.set(l,`${e-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:n=!1,verbose:e=!1,settings:t=!1,buffers:i=!1,wal:a=!1,format:l="text"}={}){var u;const d=[n?"analyze":null,e?"verbose":null,t?"settings":null,i?"buffers":null,a?"wal":null].filter(Boolean).join("|"),g=(u=this.headers.get("Accept"))!==null&&u!==void 0?u:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${l}; for="${g}"; options=${d};`),l==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(n){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${n}`),this}};const Ex=new RegExp("[,()]");var Bo=class extends xM{eq(n,e){return this.url.searchParams.append(n,`eq.${e}`),this}neq(n,e){return this.url.searchParams.append(n,`neq.${e}`),this}gt(n,e){return this.url.searchParams.append(n,`gt.${e}`),this}gte(n,e){return this.url.searchParams.append(n,`gte.${e}`),this}lt(n,e){return this.url.searchParams.append(n,`lt.${e}`),this}lte(n,e){return this.url.searchParams.append(n,`lte.${e}`),this}like(n,e){return this.url.searchParams.append(n,`like.${e}`),this}likeAllOf(n,e){return this.url.searchParams.append(n,`like(all).{${e.join(",")}}`),this}likeAnyOf(n,e){return this.url.searchParams.append(n,`like(any).{${e.join(",")}}`),this}ilike(n,e){return this.url.searchParams.append(n,`ilike.${e}`),this}ilikeAllOf(n,e){return this.url.searchParams.append(n,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(n,e){return this.url.searchParams.append(n,`ilike(any).{${e.join(",")}}`),this}regexMatch(n,e){return this.url.searchParams.append(n,`match.${e}`),this}regexIMatch(n,e){return this.url.searchParams.append(n,`imatch.${e}`),this}is(n,e){return this.url.searchParams.append(n,`is.${e}`),this}isDistinct(n,e){return this.url.searchParams.append(n,`isdistinct.${e}`),this}in(n,e){const t=Array.from(new Set(e)).map(i=>typeof i=="string"&&Ex.test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(n,`in.(${t})`),this}notIn(n,e){const t=Array.from(new Set(e)).map(i=>typeof i=="string"&&Ex.test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(n,`not.in.(${t})`),this}contains(n,e){return typeof e=="string"?this.url.searchParams.append(n,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(n,`cs.{${e.join(",")}}`):this.url.searchParams.append(n,`cs.${JSON.stringify(e)}`),this}containedBy(n,e){return typeof e=="string"?this.url.searchParams.append(n,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(n,`cd.{${e.join(",")}}`):this.url.searchParams.append(n,`cd.${JSON.stringify(e)}`),this}rangeGt(n,e){return this.url.searchParams.append(n,`sr.${e}`),this}rangeGte(n,e){return this.url.searchParams.append(n,`nxl.${e}`),this}rangeLt(n,e){return this.url.searchParams.append(n,`sl.${e}`),this}rangeLte(n,e){return this.url.searchParams.append(n,`nxr.${e}`),this}rangeAdjacent(n,e){return this.url.searchParams.append(n,`adj.${e}`),this}overlaps(n,e){return typeof e=="string"?this.url.searchParams.append(n,`ov.${e}`):this.url.searchParams.append(n,`ov.{${e.join(",")}}`),this}textSearch(n,e,{config:t,type:i}={}){let a="";i==="plain"?a="pl":i==="phrase"?a="ph":i==="websearch"&&(a="w");const l=t===void 0?"":`(${t})`;return this.url.searchParams.append(n,`${a}fts${l}.${e}`),this}match(n){return Object.entries(n).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(n,e,t){return this.url.searchParams.append(n,`not.${e}.${t}`),this}or(n,{foreignTable:e,referencedTable:t=e}={}){const i=t?`${t}.or`:"or";return this.url.searchParams.append(i,`(${n})`),this}filter(n,e,t){return this.url.searchParams.append(n,`${e}.${t}`),this}},TM=class{constructor(n,{headers:e={},schema:t,fetch:i}){this.url=n,this.headers=new Headers(e),this.schema=t,this.fetch=i}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(n,e){const{head:t=!1,count:i}=e??{},a=t?"HEAD":"GET";let l=!1;const u=(n??"*").split("").map(m=>/\s/.test(m)&&!l?"":(m==='"'&&(l=!l),m)).join(""),{url:d,headers:g}=this.cloneRequestState();return d.searchParams.set("select",u),i&&g.append("Prefer",`count=${i}`),new Bo({method:a,url:d,headers:g,schema:this.schema,fetch:this.fetch})}insert(n,{count:e,defaultToNull:t=!0}={}){var i;const a="POST",{url:l,headers:u}=this.cloneRequestState();if(e&&u.append("Prefer",`count=${e}`),t||u.append("Prefer","missing=default"),Array.isArray(n)){const d=n.reduce((g,m)=>g.concat(Object.keys(m)),[]);if(d.length>0){const g=[...new Set(d)].map(m=>`"${m}"`);l.searchParams.set("columns",g.join(","))}}return new Bo({method:a,url:l,headers:u,schema:this.schema,body:n,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}upsert(n,{onConflict:e,ignoreDuplicates:t=!1,count:i,defaultToNull:a=!0}={}){var l;const u="POST",{url:d,headers:g}=this.cloneRequestState();if(g.append("Prefer",`resolution=${t?"ignore":"merge"}-duplicates`),e!==void 0&&d.searchParams.set("on_conflict",e),i&&g.append("Prefer",`count=${i}`),a||g.append("Prefer","missing=default"),Array.isArray(n)){const m=n.reduce((_,w)=>_.concat(Object.keys(w)),[]);if(m.length>0){const _=[...new Set(m)].map(w=>`"${w}"`);d.searchParams.set("columns",_.join(","))}}return new Bo({method:u,url:d,headers:g,schema:this.schema,body:n,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}update(n,{count:e}={}){var t;const i="PATCH",{url:a,headers:l}=this.cloneRequestState();return e&&l.append("Prefer",`count=${e}`),new Bo({method:i,url:a,headers:l,schema:this.schema,body:n,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}delete({count:n}={}){var e;const t="DELETE",{url:i,headers:a}=this.cloneRequestState();return n&&a.append("Prefer",`count=${n}`),new Bo({method:t,url:i,headers:a,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}},EM=class uS{constructor(e,{headers:t={},schema:i,fetch:a}={}){this.url=e,this.headers=new Headers(t),this.schemaName=i,this.fetch=a}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new TM(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new uS(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:i=!1,get:a=!1,count:l}={}){var u;let d;const g=new URL(`${this.url}/rpc/${e}`);let m;const _=S=>S!==null&&typeof S=="object"&&(!Array.isArray(S)||S.some(_)),w=i&&Object.values(t).some(_);w?(d="POST",m=t):i||a?(d=i?"HEAD":"GET",Object.entries(t).filter(([S,N])=>N!==void 0).map(([S,N])=>[S,Array.isArray(N)?`{${N.join(",")}}`:`${N}`]).forEach(([S,N])=>{g.searchParams.append(S,N)})):(d="POST",m=t);const T=new Headers(this.headers);return w?T.set("Prefer",l?`count=${l},return=minimal`:"return=minimal"):l&&T.set("Prefer",`count=${l}`),new Bo({method:d,url:g,headers:T,schema:this.schemaName,body:m,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}};class SM{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const t=globalThis.process;if(t){const i=t.versions;if(i&&i.node){const a=i.node,l=parseInt(a.replace(/^v/,"").split(".")[0]);return l>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${l} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${l} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const i=this.getWebSocketConstructor();return new i(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const AM="2.93.2",CM=`realtime-js/${AM}`,NM="1.0.0",hS="2.0.0",Sx=hS,Om=1e4,RM=1e3,kM=100;var dr;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(dr||(dr={}));var Bt;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(Bt||(Bt={}));var gs;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(gs||(gs={}));var jm;(function(n){n.websocket="websocket"})(jm||(jm={}));var ma;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(ma||(ma={}));class IM{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,t){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return t(this._binaryEncodeUserBroadcastPush(e));let i=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(i))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer((t=e.payload)===null||t===void 0?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,i;const a=(i=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&i!==void 0?i:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,a)}_encodeJsonUserBroadcastPush(e){var t,i;const a=(i=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&i!==void 0?i:{},u=new TextEncoder().encode(JSON.stringify(a)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,u)}_encodeUserBroadcastPush(e,t,i){var a,l;const u=e.topic,d=(a=e.ref)!==null&&a!==void 0?a:"",g=(l=e.join_ref)!==null&&l!==void 0?l:"",m=e.payload.event,_=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},w=Object.keys(_).length===0?"":JSON.stringify(_);if(g.length>255)throw new Error(`joinRef length ${g.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`ref length ${d.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`topic length ${u.length} exceeds maximum of 255`);if(m.length>255)throw new Error(`userEvent length ${m.length} exceeds maximum of 255`);if(w.length>255)throw new Error(`metadata length ${w.length} exceeds maximum of 255`);const T=this.USER_BROADCAST_PUSH_META_LENGTH+g.length+d.length+u.length+m.length+w.length,S=new ArrayBuffer(this.HEADER_LENGTH+T);let N=new DataView(S),M=0;N.setUint8(M++,this.KINDS.userBroadcastPush),N.setUint8(M++,g.length),N.setUint8(M++,d.length),N.setUint8(M++,u.length),N.setUint8(M++,m.length),N.setUint8(M++,w.length),N.setUint8(M++,t),Array.from(g,V=>N.setUint8(M++,V.charCodeAt(0))),Array.from(d,V=>N.setUint8(M++,V.charCodeAt(0))),Array.from(u,V=>N.setUint8(M++,V.charCodeAt(0))),Array.from(m,V=>N.setUint8(M++,V.charCodeAt(0))),Array.from(w,V=>N.setUint8(M++,V.charCodeAt(0)));var k=new Uint8Array(S.byteLength+i.byteLength);return k.set(new Uint8Array(S),0),k.set(new Uint8Array(i),S.byteLength),k.buffer}decode(e,t){if(this._isArrayBuffer(e)){let i=this._binaryDecode(e);return t(i)}if(typeof e=="string"){const i=JSON.parse(e),[a,l,u,d,g]=i;return t({join_ref:a,ref:l,topic:u,event:d,payload:g})}return t({})}_binaryDecode(e){const t=new DataView(e),i=t.getUint8(0),a=new TextDecoder;switch(i){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,t,a)}}_decodeUserBroadcast(e,t,i){const a=t.getUint8(1),l=t.getUint8(2),u=t.getUint8(3),d=t.getUint8(4);let g=this.HEADER_LENGTH+4;const m=i.decode(e.slice(g,g+a));g=g+a;const _=i.decode(e.slice(g,g+l));g=g+l;const w=i.decode(e.slice(g,g+u));g=g+u;const T=e.slice(g,e.byteLength),S=d===this.JSON_ENCODING?JSON.parse(i.decode(T)):T,N={type:this.BROADCAST_EVENT,event:_,payload:S};return u>0&&(N.meta=JSON.parse(w)),{join_ref:null,ref:null,topic:m,event:this.BROADCAST_EVENT,payload:N}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||((t=e==null?void 0:e.constructor)===null||t===void 0?void 0:t.name)==="ArrayBuffer"}_pick(e,t){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([i])=>t.includes(i)))}}class dS{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var at;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(at||(at={}));const Ax=(n,e,t={})=>{var i;const a=(i=t.skipTypes)!==null&&i!==void 0?i:[];return e?Object.keys(e).reduce((l,u)=>(l[u]=OM(u,n,e,a),l),{}):{}},OM=(n,e,t,i)=>{const a=e.find(d=>d.name===n),l=a==null?void 0:a.type,u=t[n];return l&&!i.includes(l)?fS(l,u):Dm(u)},fS=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return MM(e,t)}switch(n){case at.bool:return jM(e);case at.float4:case at.float8:case at.int2:case at.int4:case at.int8:case at.numeric:case at.oid:return DM(e);case at.json:case at.jsonb:return PM(e);case at.timestamp:return LM(e);case at.abstime:case at.date:case at.daterange:case at.int4range:case at.int8range:case at.money:case at.reltime:case at.text:case at.time:case at.timestamptz:case at.timetz:case at.tsrange:case at.tstzrange:return Dm(e);default:return Dm(e)}},Dm=n=>n,jM=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},DM=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},PM=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch{return n}return n},MM=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,i=n[t];if(n[0]==="{"&&i==="}"){let l;const u=n.slice(1,t);try{l=JSON.parse("["+u+"]")}catch{l=u?u.split(","):[]}return l.map(d=>fS(e,d))}return n},LM=n=>typeof n=="string"?n.replace(" ","T"):n,pS=n=>{const e=new URL(n);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Kg{constructor(e,t,i={},a=Om){this.channel=e,this.event=t,this.payload=i,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var i;return this._hasReceived(e)&&t((i=this.receivedResp)===null||i===void 0?void 0:i.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(i=>i.status===e).forEach(i=>i.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Cx;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(Cx||(Cx={}));class Uc{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const i=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},a=>{const{onJoin:l,onLeave:u,onSync:d}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Uc.syncState(this.state,a,l,u),this.pendingDiffs.forEach(g=>{this.state=Uc.syncDiff(this.state,g,l,u)}),this.pendingDiffs=[],d()}),this.channel._on(i.diff,{},a=>{const{onJoin:l,onLeave:u,onSync:d}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=Uc.syncDiff(this.state,a,l,u),d())}),this.onJoin((a,l,u)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:l,newPresences:u})}),this.onLeave((a,l,u)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:l,leftPresences:u})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,i,a){const l=this.cloneDeep(e),u=this.transformState(t),d={},g={};return this.map(l,(m,_)=>{u[m]||(g[m]=_)}),this.map(u,(m,_)=>{const w=l[m];if(w){const T=_.map(k=>k.presence_ref),S=w.map(k=>k.presence_ref),N=_.filter(k=>S.indexOf(k.presence_ref)<0),M=w.filter(k=>T.indexOf(k.presence_ref)<0);N.length>0&&(d[m]=N),M.length>0&&(g[m]=M)}else d[m]=_}),this.syncDiff(l,{joins:d,leaves:g},i,a)}static syncDiff(e,t,i,a){const{joins:l,leaves:u}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return i||(i=()=>{}),a||(a=()=>{}),this.map(l,(d,g)=>{var m;const _=(m=e[d])!==null&&m!==void 0?m:[];if(e[d]=this.cloneDeep(g),_.length>0){const w=e[d].map(S=>S.presence_ref),T=_.filter(S=>w.indexOf(S.presence_ref)<0);e[d].unshift(...T)}i(d,_,g)}),this.map(u,(d,g)=>{let m=e[d];if(!m)return;const _=g.map(w=>w.presence_ref);m=m.filter(w=>_.indexOf(w.presence_ref)<0),e[d]=m,a(d,m,g),m.length===0&&delete e[d]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(i=>t(i,e[i]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,i)=>{const a=e[i];return"metas"in a?t[i]=a.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):t[i]=a,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Nx;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(Nx||(Nx={}));var Vc;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(Vc||(Vc={}));var _i;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(_i||(_i={}));class qo{constructor(e,t={config:{}},i){var a,l;if(this.topic=e,this.params=t,this.socket=i,this.bindings={},this.state=Bt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Kg(this,gs.join,this.params,this.timeout),this.rejoinTimer=new dS(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Bt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(u=>u.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Bt.closed,this.socket._remove(this)}),this._onError(u=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,u),this.state=Bt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Bt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",u=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,u),this.state=Bt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(gs.reply,{},(u,d)=>{this._trigger(this._replyEventName(d),u)}),this.presence=new Uc(this),this.broadcastEndpointURL=pS(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((l=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var i,a,l;if(this.socket.isConnected()||this.socket.connect(),this.state==Bt.closed){const{config:{broadcast:u,presence:d,private:g}}=this.params,m=(a=(i=this.bindings.postgres_changes)===null||i===void 0?void 0:i.map(S=>S.filter))!==null&&a!==void 0?a:[],_=!!this.bindings[Vc.PRESENCE]&&this.bindings[Vc.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,w={},T={broadcast:u,presence:Object.assign(Object.assign({},d),{enabled:_}),postgres_changes:m,private:g};this.socket.accessTokenValue&&(w.access_token=this.socket.accessTokenValue),this._onError(S=>e==null?void 0:e(_i.CHANNEL_ERROR,S)),this._onClose(()=>e==null?void 0:e(_i.CLOSED)),this.updateJoinPayload(Object.assign({config:T},w)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:S})=>{var N;if(this.socket._isManualToken()||this.socket.setAuth(),S===void 0){e==null||e(_i.SUBSCRIBED);return}else{const M=this.bindings.postgres_changes,k=(N=M==null?void 0:M.length)!==null&&N!==void 0?N:0,V=[];for(let F=0;F<k;F++){const $=M[F],{filter:{event:D,schema:q,table:J,filter:R}}=$,A=S&&S[F];if(A&&A.event===D&&qo.isFilterValueEqual(A.schema,q)&&qo.isFilterValueEqual(A.table,J)&&qo.isFilterValueEqual(A.filter,R))V.push(Object.assign(Object.assign({},$),{id:A.id}));else{this.unsubscribe(),this.state=Bt.errored,e==null||e(_i.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=V,e&&e(_i.SUBSCRIBED);return}}).receive("error",S=>{this.state=Bt.errored,e==null||e(_i.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(S).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(_i.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,i){return this.state===Bt.joined&&e===Vc.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,t,i)}async httpSend(e,t,i={}){var a;if(t==null)return Promise.reject("Payload is required for httpSend()");const l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const u={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},d=await this._fetchWithTimeout(this.broadcastEndpointURL,u,(a=i.timeout)!==null&&a!==void 0?a:this.timeout);if(d.status===202)return{success:!0};let g=d.statusText;try{const m=await d.json();g=m.error||m.message||g}catch{}return Promise.reject(new Error(g))}async send(e,t={}){var i,a;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:l,payload:u}=e,d={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(d.Authorization=`Bearer ${this.socket.accessTokenValue}`);const g={method:"POST",headers:d,body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:u,private:this.private}]})};try{const m=await this._fetchWithTimeout(this.broadcastEndpointURL,g,(i=t.timeout)!==null&&i!==void 0?i:this.timeout);return await((a=m.body)===null||a===void 0?void 0:a.cancel()),m.ok?"ok":"error"}catch(m){return m.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var u,d,g;const m=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((g=(d=(u=this.params)===null||u===void 0?void 0:u.config)===null||d===void 0?void 0:d.broadcast)===null||g===void 0)&&g.ack)&&l("ok"),m.receive("ok",()=>l("ok")),m.receive("error",()=>l("error")),m.receive("timeout",()=>l("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Bt.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(gs.close,"leave",this._joinRef())};this.joinPush.destroy();let i=null;return new Promise(a=>{i=new Kg(this,gs.leave,{},e),i.receive("ok",()=>{t(),a("ok")}).receive("timeout",()=>{t(),a("timed out")}).receive("error",()=>{a("error")}),i.send(),this._canPush()||i.trigger("ok",{})}).finally(()=>{i==null||i.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Bt.closed,this.bindings={}}async _fetchWithTimeout(e,t,i){const a=new AbortController,l=setTimeout(()=>a.abort(),i),u=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:a.signal}));return clearTimeout(l),u}_push(e,t,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Kg(this,e,t,i);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>kM){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,i){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,i){var a,l;const u=e.toLocaleLowerCase(),{close:d,error:g,leave:m,join:_}=gs;if(i&&[d,g,m,_].indexOf(u)>=0&&i!==this._joinRef())return;let T=this._onMessage(u,t,i);if(t&&!T)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(u)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(S=>{var N,M,k;return((N=S.filter)===null||N===void 0?void 0:N.event)==="*"||((k=(M=S.filter)===null||M===void 0?void 0:M.event)===null||k===void 0?void 0:k.toLocaleLowerCase())===u}).map(S=>S.callback(T,i)):(l=this.bindings[u])===null||l===void 0||l.filter(S=>{var N,M,k,V,F,$;if(["broadcast","presence","postgres_changes"].includes(u))if("id"in S){const D=S.id,q=(N=S.filter)===null||N===void 0?void 0:N.event;return D&&((M=t.ids)===null||M===void 0?void 0:M.includes(D))&&(q==="*"||(q==null?void 0:q.toLocaleLowerCase())===((k=t.data)===null||k===void 0?void 0:k.type.toLocaleLowerCase()))}else{const D=(F=(V=S==null?void 0:S.filter)===null||V===void 0?void 0:V.event)===null||F===void 0?void 0:F.toLocaleLowerCase();return D==="*"||D===(($=t==null?void 0:t.event)===null||$===void 0?void 0:$.toLocaleLowerCase())}else return S.type.toLocaleLowerCase()===u}).map(S=>{if(typeof T=="object"&&"ids"in T){const N=T.data,{schema:M,table:k,commit_timestamp:V,type:F,errors:$}=N;T=Object.assign(Object.assign({},{schema:M,table:k,commit_timestamp:V,eventType:F,new:{},old:{},errors:$}),this._getPayloadRecords(N))}S.callback(T,i)})}_isClosed(){return this.state===Bt.closed}_isJoined(){return this.state===Bt.joined}_isJoining(){return this.state===Bt.joining}_isLeaving(){return this.state===Bt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,i){const a=e.toLocaleLowerCase(),l={type:a,filter:t,callback:i};return this.bindings[a]?this.bindings[a].push(l):this.bindings[a]=[l],this}_off(e,t){const i=e.toLocaleLowerCase();return this.bindings[i]&&(this.bindings[i]=this.bindings[i].filter(a=>{var l;return!(((l=a.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===i&&qo.isEqual(a.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(e[i]!==t[i])return!1;return!0}static isFilterValueEqual(e,t){return(e??void 0)===(t??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(gs.close,{},e)}_onError(e){this._on(gs.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Bt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Ax(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Ax(e.columns,e.old_record)),t}}const Yg=()=>{},td={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},UM=[1e3,2e3,5e3,1e4],VM=1e4,BM=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class zM{constructor(e,t){var i;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Om,this.transport=null,this.heartbeatIntervalMs=td.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Yg,this.ref=0,this.reconnectTimer=null,this.vsn=Sx,this.logger=Yg,this.conn=null,this.sendBuffer=[],this.serializer=new IM,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=a=>a?(...l)=>a(...l):(...l)=>fetch(...l),!(!((i=t==null?void 0:t.params)===null||i===void 0)&&i.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${jm.websocket}`,this.httpEndpoint=pS(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=SM.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const i=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(i),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,t??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,i){this.logger(e,t,i)}connectionState(){switch(this.conn&&this.conn.readyState){case dr.connecting:return ma.Connecting;case dr.open:return ma.Open;case dr.closing:return ma.Closing;default:return ma.Closed}}isConnected(){return this.connectionState()===ma.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const i=`realtime:${e}`,a=this.getChannels().find(l=>l.topic===i);if(a)return a;{const l=new qo(`realtime:${e}`,t,this);return this.channels.push(l),l}}push(e){const{topic:t,event:i,payload:a,ref:l}=e,u=()=>{this.encode(e,d=>{var g;(g=this.conn)===null||g===void 0||g.send(d)})};this.log("push",`${t} ${i} (${l})`,a),this.isConnected()?u():this.sendBuffer.push(u)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(RM,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},td.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(i=>i.topic===e&&(i._isJoined()||i._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply"&&t.ref&&t.ref===this.pendingHeartbeatRef){const m=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error",m)}catch(_){this.log("error","error in heartbeat callback",_)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:i,event:a,payload:l,ref:u}=t,d=u?`(${u})`:"",g=l.status||"";this.log("receive",`${g} ${i} ${a} ${d}`.trim(),l),this.channels.filter(m=>m._isMember(i)).forEach(m=>m._trigger(a,l,u)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===dr.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===dr.open||this.conn.readyState===dr.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(t=>{this.log("error","error waiting for auth on connect",t),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this._terminateWorker()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e);try{this.heartbeatCallback("error")}catch(t){this.log("error","error in heartbeat callback",t)}}_triggerChanError(){this.channels.forEach(e=>e._trigger(gs.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const i=e.match(/\?/)?"&":"?",a=new URLSearchParams(t);return`${e}${i}${a}`}_workerObjectUrl(e){let t;if(e)t=e;else{const i=new Blob([BM],{type:"application/javascript"});t=URL.createObjectURL(i)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t,i=!1;if(e)t=e,i=!0;else if(this.accessToken)try{t=await this.accessToken()}catch(a){this.log("error","Error fetching access token from callback",a),t=this.accessTokenValue}else t=this.accessTokenValue;i?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(a=>{const l={access_token:t,version:CM};t&&a.updateJoinPayload(l),a.joinedOnce&&a._isJoined()&&a._push(gs.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(t=>{this.log("error",`Error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(i=>{try{i(t)}catch(a){this.log("error",`error in ${e} callback`,a)}})}catch(i){this.log("error",`error triggering ${e} callbacks`,i)}}_setupReconnectionTimer(){this.reconnectTimer=new dS(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},td.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,i,a,l,u,d,g,m,_,w,T,S;switch(this.transport=(t=e==null?void 0:e.transport)!==null&&t!==void 0?t:null,this.timeout=(i=e==null?void 0:e.timeout)!==null&&i!==void 0?i:Om,this.heartbeatIntervalMs=(a=e==null?void 0:e.heartbeatIntervalMs)!==null&&a!==void 0?a:td.HEARTBEAT_INTERVAL,this.worker=(l=e==null?void 0:e.worker)!==null&&l!==void 0?l:!1,this.accessToken=(u=e==null?void 0:e.accessToken)!==null&&u!==void 0?u:null,this.heartbeatCallback=(d=e==null?void 0:e.heartbeatCallback)!==null&&d!==void 0?d:Yg,this.vsn=(g=e==null?void 0:e.vsn)!==null&&g!==void 0?g:Sx,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(m=e==null?void 0:e.reconnectAfterMs)!==null&&m!==void 0?m:(N=>UM[N-1]||VM),this.vsn){case NM:this.encode=(_=e==null?void 0:e.encode)!==null&&_!==void 0?_:((N,M)=>M(JSON.stringify(N))),this.decode=(w=e==null?void 0:e.decode)!==null&&w!==void 0?w:((N,M)=>M(JSON.parse(N)));break;case hS:this.encode=(T=e==null?void 0:e.encode)!==null&&T!==void 0?T:this.serializer.encode.bind(this.serializer),this.decode=(S=e==null?void 0:e.decode)!==null&&S!==void 0?S:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}var Xc=class extends Error{constructor(n,e){var t;super(n),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&((t=e.icebergType)==null?void 0:t.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function HM(n,e,t){const i=new URL(e,n);if(t)for(const[a,l]of Object.entries(t))l!==void 0&&i.searchParams.set(a,l);return i.toString()}async function $M(n){return!n||n.type==="none"?{}:n.type==="bearer"?{Authorization:`Bearer ${n.token}`}:n.type==="header"?{[n.name]:n.value}:n.type==="custom"?await n.getHeaders():{}}function qM(n){const e=n.fetchImpl??globalThis.fetch;return{async request({method:t,path:i,query:a,body:l,headers:u}){const d=HM(n.baseUrl,i,a),g=await $M(n.auth),m=await e(d,{method:t,headers:{...l?{"Content-Type":"application/json"}:{},...g,...u},body:l?JSON.stringify(l):void 0}),_=await m.text(),w=(m.headers.get("content-type")||"").includes("application/json"),T=w&&_?JSON.parse(_):_;if(!m.ok){const S=w?T:void 0,N=S==null?void 0:S.error;throw new Xc((N==null?void 0:N.message)??`Request failed with status ${m.status}`,{status:m.status,icebergType:N==null?void 0:N.type,icebergCode:N==null?void 0:N.code,details:S})}return{status:m.status,headers:m.headers,data:T}}}}function nd(n){return n.join("")}var FM=class{constructor(n,e=""){this.client=n,this.prefix=e}async listNamespaces(n){const e=n?{parent:nd(n.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(i=>({namespace:i}))}async createNamespace(n,e){const t={namespace:n.namespace,properties:e==null?void 0:e.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:t})).data}async dropNamespace(n){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${nd(n.namespace)}`})}async loadNamespaceMetadata(n){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${nd(n.namespace)}`})).data.properties}}async namespaceExists(n){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${nd(n.namespace)}`}),!0}catch(e){if(e instanceof Xc&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(n,e){try{return await this.createNamespace(n,e)}catch(t){if(t instanceof Xc&&t.status===409)return;throw t}}};function ko(n){return n.join("")}var GM=class{constructor(n,e="",t){this.client=n,this.prefix=e,this.accessDelegation=t}async listTables(n){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ko(n.namespace)}/tables`})).data.identifiers}async createTable(n,e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${ko(n.namespace)}/tables`,body:e,headers:t})).data.metadata}async updateTable(n,e){const t=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${ko(n.namespace)}/tables/${n.name}`,body:e});return{"metadata-location":t.data["metadata-location"],metadata:t.data.metadata}}async dropTable(n,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${ko(n.namespace)}/tables/${n.name}`,query:{purgeRequested:String((e==null?void 0:e.purge)??!1)}})}async loadTable(n){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ko(n.namespace)}/tables/${n.name}`,headers:e})).data.metadata}async tableExists(n){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${ko(n.namespace)}/tables/${n.name}`,headers:e}),!0}catch(t){if(t instanceof Xc&&t.status===404)return!1;throw t}}async createTableIfNotExists(n,e){try{return await this.createTable(n,e)}catch(t){if(t instanceof Xc&&t.status===409)return await this.loadTable({namespace:n.namespace,name:e.name});throw t}}},KM=class{constructor(n){var i;let e="v1";n.catalogName&&(e+=`/${n.catalogName}`);const t=n.baseUrl.endsWith("/")?n.baseUrl:`${n.baseUrl}/`;this.client=qM({baseUrl:t,auth:n.auth,fetchImpl:n.fetch}),this.accessDelegation=(i=n.accessDelegation)==null?void 0:i.join(","),this.namespaceOps=new FM(this.client,e),this.tableOps=new GM(this.client,e,this.accessDelegation)}async listNamespaces(n){return this.namespaceOps.listNamespaces(n)}async createNamespace(n,e){return this.namespaceOps.createNamespace(n,e)}async dropNamespace(n){await this.namespaceOps.dropNamespace(n)}async loadNamespaceMetadata(n){return this.namespaceOps.loadNamespaceMetadata(n)}async listTables(n){return this.tableOps.listTables(n)}async createTable(n,e){return this.tableOps.createTable(n,e)}async updateTable(n,e){return this.tableOps.updateTable(n,e)}async dropTable(n,e){await this.tableOps.dropTable(n,e)}async loadTable(n){return this.tableOps.loadTable(n)}async namespaceExists(n){return this.namespaceOps.namespaceExists(n)}async tableExists(n){return this.tableOps.tableExists(n)}async createNamespaceIfNotExists(n,e){return this.namespaceOps.createNamespaceIfNotExists(n,e)}async createTableIfNotExists(n,e){return this.tableOps.createTableIfNotExists(n,e)}},wf=class extends Error{constructor(n,e="storage",t,i){super(n),this.__isStorageError=!0,this.namespace=e,this.name=e==="vectors"?"StorageVectorsError":"StorageError",this.status=t,this.statusCode=i}};function xf(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}var sd=class extends wf{constructor(n,e,t,i="storage"){super(n,i,e,t),this.name=i==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=e,this.statusCode=t}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},gS=class extends wf{constructor(n,e,t="storage"){super(n,t),this.name=t==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=e}};const YM=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),WM=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},Pm=n=>{if(Array.isArray(n))return n.map(t=>Pm(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,i])=>{const a=t.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));e[a]=Pm(i)}),e},QM=n=>!n||typeof n!="string"||n.length===0||n.length>100||n.trim()!==n||n.includes("/")||n.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(n);function Zc(n){"@babel/helpers - typeof";return Zc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zc(n)}function JM(n,e){if(Zc(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(Zc(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function XM(n){var e=JM(n,"string");return Zc(e)=="symbol"?e:e+""}function ZM(n,e,t){return(e=XM(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Rx(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,i)}return t}function Se(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Rx(Object(t),!0).forEach(function(i){ZM(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Rx(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}const kx=n=>{var e;return n.msg||n.message||n.error_description||(typeof n.error=="string"?n.error:(e=n.error)===null||e===void 0?void 0:e.message)||JSON.stringify(n)},e6=async(n,e,t,i)=>{if(n&&typeof n=="object"&&"status"in n&&"ok"in n&&typeof n.status=="number"&&!(t!=null&&t.noResolveJson)){const a=n,l=a.status||500;if(typeof a.json=="function")a.json().then(u=>{const d=(u==null?void 0:u.statusCode)||(u==null?void 0:u.code)||l+"";e(new sd(kx(u),l,d,i))}).catch(()=>{if(i==="vectors"){const u=l+"";e(new sd(a.statusText||`HTTP ${l} error`,l,u,i))}else{const u=l+"";e(new sd(a.statusText||`HTTP ${l} error`,l,u,i))}});else{const u=l+"";e(new sd(a.statusText||`HTTP ${l} error`,l,u,i))}}else e(new gS(kx(n),n,i))},t6=(n,e,t,i)=>{const a={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"||n==="HEAD"||!i?Se(Se({},a),t):(WM(i)?(a.headers=Se({"Content-Type":"application/json"},e==null?void 0:e.headers),a.body=JSON.stringify(i)):a.body=i,e!=null&&e.duplex&&(a.duplex=e.duplex),Se(Se({},a),t))};async function wc(n,e,t,i,a,l,u){return new Promise((d,g)=>{n(t,t6(e,i,a,l)).then(m=>{if(!m.ok)throw m;if(i!=null&&i.noResolveJson)return m;if(u==="vectors"){const _=m.headers.get("content-type");if(!_||!_.includes("application/json"))return{}}return m.json()}).then(m=>d(m)).catch(m=>e6(m,g,i,u))})}function n6(n="storage"){return{get:async(e,t,i,a)=>wc(e,"GET",t,i,a,void 0,n),post:async(e,t,i,a,l)=>wc(e,"POST",t,a,l,i,n),put:async(e,t,i,a,l)=>wc(e,"PUT",t,a,l,i,n),head:async(e,t,i,a)=>wc(e,"HEAD",t,Se(Se({},i),{},{noResolveJson:!0}),a,void 0,n),remove:async(e,t,i,a,l)=>wc(e,"DELETE",t,a,l,i,n)}}const s6=n6("storage"),{get:eu,post:ft,put:Mm,head:i6,remove:U0}=s6;var fl=class{constructor(n,e={},t,i="storage"){this.shouldThrowOnError=!1,this.url=n,this.headers=e,this.fetch=YM(t),this.namespace=i}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(n){var e=this;try{return{data:await n(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(xf(t))return{data:null,error:t};throw t}}},r6=class{constructor(n,e){this.downloadFn=n,this.shouldThrowOnError=e}then(n,e){return this.execute().then(n,e)}async execute(){var n=this;try{return{data:(await n.downloadFn()).body,error:null}}catch(e){if(n.shouldThrowOnError)throw e;if(xf(e))return{data:null,error:e};throw e}}};let mS;mS=Symbol.toStringTag;var a6=class{constructor(n,e){this.downloadFn=n,this.shouldThrowOnError=e,this[mS]="BlobDownloadBuilder",this.promise=null}asStream(){return new r6(this.downloadFn,this.shouldThrowOnError)}then(n,e){return this.getPromise().then(n,e)}catch(n){return this.getPromise().catch(n)}finally(n){return this.getPromise().finally(n)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var n=this;try{return{data:await(await n.downloadFn()).blob(),error:null}}catch(e){if(n.shouldThrowOnError)throw e;if(xf(e))return{data:null,error:e};throw e}}};const o6={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ix={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var l6=class extends fl{constructor(n,e={},t,i){super(n,e,i,"storage"),this.bucketId=t}async uploadOrUpdate(n,e,t,i){var a=this;return a.handleOperation(async()=>{let l;const u=Se(Se({},Ix),i);let d=Se(Se({},a.headers),n==="POST"&&{"x-upsert":String(u.upsert)});const g=u.metadata;typeof Blob<"u"&&t instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),g&&l.append("metadata",a.encodeMetadata(g)),l.append("",t)):typeof FormData<"u"&&t instanceof FormData?(l=t,l.has("cacheControl")||l.append("cacheControl",u.cacheControl),g&&!l.has("metadata")&&l.append("metadata",a.encodeMetadata(g))):(l=t,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType,g&&(d["x-metadata"]=a.toBase64(a.encodeMetadata(g))),(typeof ReadableStream<"u"&&l instanceof ReadableStream||l&&typeof l=="object"&&"pipe"in l&&typeof l.pipe=="function")&&!u.duplex&&(u.duplex="half")),i!=null&&i.headers&&(d=Se(Se({},d),i.headers));const m=a._removeEmptyFolders(e),_=a._getFinalPath(m),w=await(n=="PUT"?Mm:ft)(a.fetch,`${a.url}/object/${_}`,l,Se({headers:d},u!=null&&u.duplex?{duplex:u.duplex}:{}));return{path:m,id:w.Id,fullPath:w.Key}})}async upload(n,e,t){return this.uploadOrUpdate("POST",n,e,t)}async uploadToSignedUrl(n,e,t,i){var a=this;const l=a._removeEmptyFolders(n),u=a._getFinalPath(l),d=new URL(a.url+`/object/upload/sign/${u}`);return d.searchParams.set("token",e),a.handleOperation(async()=>{let g;const m=Se({upsert:Ix.upsert},i),_=Se(Se({},a.headers),{"x-upsert":String(m.upsert)});return typeof Blob<"u"&&t instanceof Blob?(g=new FormData,g.append("cacheControl",m.cacheControl),g.append("",t)):typeof FormData<"u"&&t instanceof FormData?(g=t,g.append("cacheControl",m.cacheControl)):(g=t,_["cache-control"]=`max-age=${m.cacheControl}`,_["content-type"]=m.contentType),{path:l,fullPath:(await Mm(a.fetch,d.toString(),g,{headers:_})).Key}})}async createSignedUploadUrl(n,e){var t=this;return t.handleOperation(async()=>{let i=t._getFinalPath(n);const a=Se({},t.headers);e!=null&&e.upsert&&(a["x-upsert"]="true");const l=await ft(t.fetch,`${t.url}/object/upload/sign/${i}`,{},{headers:a}),u=new URL(t.url+l.url),d=u.searchParams.get("token");if(!d)throw new wf("No token returned by API");return{signedUrl:u.toString(),path:n,token:d}})}async update(n,e,t){return this.uploadOrUpdate("PUT",n,e,t)}async move(n,e,t){var i=this;return i.handleOperation(async()=>await ft(i.fetch,`${i.url}/object/move`,{bucketId:i.bucketId,sourceKey:n,destinationKey:e,destinationBucket:t==null?void 0:t.destinationBucket},{headers:i.headers}))}async copy(n,e,t){var i=this;return i.handleOperation(async()=>({path:(await ft(i.fetch,`${i.url}/object/copy`,{bucketId:i.bucketId,sourceKey:n,destinationKey:e,destinationBucket:t==null?void 0:t.destinationBucket},{headers:i.headers})).Key}))}async createSignedUrl(n,e,t){var i=this;return i.handleOperation(async()=>{let a=i._getFinalPath(n),l=await ft(i.fetch,`${i.url}/object/sign/${a}`,Se({expiresIn:e},t!=null&&t.transform?{transform:t.transform}:{}),{headers:i.headers});const u=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return{signedUrl:encodeURI(`${i.url}${l.signedURL}${u}`)}})}async createSignedUrls(n,e,t){var i=this;return i.handleOperation(async()=>{const a=await ft(i.fetch,`${i.url}/object/sign/${i.bucketId}`,{expiresIn:e,paths:n},{headers:i.headers}),l=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return a.map(u=>Se(Se({},u),{},{signedUrl:u.signedURL?encodeURI(`${i.url}${u.signedURL}${l}`):null}))})}download(n,e){const t=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),a=i?`?${i}`:"",l=this._getFinalPath(n),u=()=>eu(this.fetch,`${this.url}/${t}/${l}${a}`,{headers:this.headers,noResolveJson:!0});return new a6(u,this.shouldThrowOnError)}async info(n){var e=this;const t=e._getFinalPath(n);return e.handleOperation(async()=>Pm(await eu(e.fetch,`${e.url}/object/info/${t}`,{headers:e.headers})))}async exists(n){var e=this;const t=e._getFinalPath(n);try{return await i6(e.fetch,`${e.url}/object/${t}`,{headers:e.headers}),{data:!0,error:null}}catch(i){if(e.shouldThrowOnError)throw i;if(xf(i)&&i instanceof gS){const a=i.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:i}}throw i}}getPublicUrl(n,e){const t=this._getFinalPath(n),i=[],a=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";a!==""&&i.push(a);const l=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",u=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});u!==""&&i.push(u);let d=i.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${t}${d}`)}}}async remove(n){var e=this;return e.handleOperation(async()=>await U0(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:n},{headers:e.headers}))}async list(n,e,t){var i=this;return i.handleOperation(async()=>{const a=Se(Se(Se({},o6),e),{},{prefix:n||""});return await ft(i.fetch,`${i.url}/object/list/${i.bucketId}`,a,{headers:i.headers},t)})}async listV2(n,e){var t=this;return t.handleOperation(async()=>{const i=Se({},n);return await ft(t.fetch,`${t.url}/object/list-v2/${t.bucketId}`,i,{headers:t.headers},e)})}encodeMetadata(n){return JSON.stringify(n)}toBase64(n){return typeof Buffer<"u"?Buffer.from(n).toString("base64"):btoa(n)}_getFinalPath(n){return`${this.bucketId}/${n.replace(/^\/+/,"")}`}_removeEmptyFolders(n){return n.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(n){const e=[];return n.width&&e.push(`width=${n.width}`),n.height&&e.push(`height=${n.height}`),n.resize&&e.push(`resize=${n.resize}`),n.format&&e.push(`format=${n.format}`),n.quality&&e.push(`quality=${n.quality}`),e.join("&")}};const c6="2.93.2",yu={"X-Client-Info":`storage-js/${c6}`};var u6=class extends fl{constructor(n,e={},t,i){const a=new URL(n);i!=null&&i.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase."));const l=a.href.replace(/\/$/,""),u=Se(Se({},yu),e);super(l,u,t,"storage")}async listBuckets(n){var e=this;return e.handleOperation(async()=>{const t=e.listBucketOptionsToQueryString(n);return await eu(e.fetch,`${e.url}/bucket${t}`,{headers:e.headers})})}async getBucket(n){var e=this;return e.handleOperation(async()=>await eu(e.fetch,`${e.url}/bucket/${n}`,{headers:e.headers}))}async createBucket(n,e={public:!1}){var t=this;return t.handleOperation(async()=>await ft(t.fetch,`${t.url}/bucket`,{id:n,name:n,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}))}async updateBucket(n,e){var t=this;return t.handleOperation(async()=>await Mm(t.fetch,`${t.url}/bucket/${n}`,{id:n,name:n,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}))}async emptyBucket(n){var e=this;return e.handleOperation(async()=>await ft(e.fetch,`${e.url}/bucket/${n}/empty`,{},{headers:e.headers}))}async deleteBucket(n){var e=this;return e.handleOperation(async()=>await U0(e.fetch,`${e.url}/bucket/${n}`,{},{headers:e.headers}))}listBucketOptionsToQueryString(n){const e={};return n&&("limit"in n&&(e.limit=String(n.limit)),"offset"in n&&(e.offset=String(n.offset)),n.search&&(e.search=n.search),n.sortColumn&&(e.sortColumn=n.sortColumn),n.sortOrder&&(e.sortOrder=n.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},h6=class extends fl{constructor(n,e={},t){const i=n.replace(/\/$/,""),a=Se(Se({},yu),e);super(i,a,t,"storage")}async createBucket(n){var e=this;return e.handleOperation(async()=>await ft(e.fetch,`${e.url}/bucket`,{name:n},{headers:e.headers}))}async listBuckets(n){var e=this;return e.handleOperation(async()=>{const t=new URLSearchParams;(n==null?void 0:n.limit)!==void 0&&t.set("limit",n.limit.toString()),(n==null?void 0:n.offset)!==void 0&&t.set("offset",n.offset.toString()),n!=null&&n.sortColumn&&t.set("sortColumn",n.sortColumn),n!=null&&n.sortOrder&&t.set("sortOrder",n.sortOrder),n!=null&&n.search&&t.set("search",n.search);const i=t.toString(),a=i?`${e.url}/bucket?${i}`:`${e.url}/bucket`;return await eu(e.fetch,a,{headers:e.headers})})}async deleteBucket(n){var e=this;return e.handleOperation(async()=>await U0(e.fetch,`${e.url}/bucket/${n}`,{},{headers:e.headers}))}from(n){var e=this;if(!QM(n))throw new wf("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const t=new KM({baseUrl:this.url,catalogName:n,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),i=this.shouldThrowOnError;return new Proxy(t,{get(a,l){const u=a[l];return typeof u!="function"?u:async(...d)=>{try{return{data:await u.apply(a,d),error:null}}catch(g){if(i)throw g;return{data:null,error:g}}}}})}},d6=class extends fl{constructor(n,e={},t){const i=n.replace(/\/$/,""),a=Se(Se({},yu),{},{"Content-Type":"application/json"},e);super(i,a,t,"vectors")}async createIndex(n){var e=this;return e.handleOperation(async()=>await ft(e.fetch,`${e.url}/CreateIndex`,n,{headers:e.headers})||{})}async getIndex(n,e){var t=this;return t.handleOperation(async()=>await ft(t.fetch,`${t.url}/GetIndex`,{vectorBucketName:n,indexName:e},{headers:t.headers}))}async listIndexes(n){var e=this;return e.handleOperation(async()=>await ft(e.fetch,`${e.url}/ListIndexes`,n,{headers:e.headers}))}async deleteIndex(n,e){var t=this;return t.handleOperation(async()=>await ft(t.fetch,`${t.url}/DeleteIndex`,{vectorBucketName:n,indexName:e},{headers:t.headers})||{})}},f6=class extends fl{constructor(n,e={},t){const i=n.replace(/\/$/,""),a=Se(Se({},yu),{},{"Content-Type":"application/json"},e);super(i,a,t,"vectors")}async putVectors(n){var e=this;if(n.vectors.length<1||n.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return e.handleOperation(async()=>await ft(e.fetch,`${e.url}/PutVectors`,n,{headers:e.headers})||{})}async getVectors(n){var e=this;return e.handleOperation(async()=>await ft(e.fetch,`${e.url}/GetVectors`,n,{headers:e.headers}))}async listVectors(n){var e=this;if(n.segmentCount!==void 0){if(n.segmentCount<1||n.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(n.segmentIndex!==void 0&&(n.segmentIndex<0||n.segmentIndex>=n.segmentCount))throw new Error(`segmentIndex must be between 0 and ${n.segmentCount-1}`)}return e.handleOperation(async()=>await ft(e.fetch,`${e.url}/ListVectors`,n,{headers:e.headers}))}async queryVectors(n){var e=this;return e.handleOperation(async()=>await ft(e.fetch,`${e.url}/QueryVectors`,n,{headers:e.headers}))}async deleteVectors(n){var e=this;if(n.keys.length<1||n.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return e.handleOperation(async()=>await ft(e.fetch,`${e.url}/DeleteVectors`,n,{headers:e.headers})||{})}},p6=class extends fl{constructor(n,e={},t){const i=n.replace(/\/$/,""),a=Se(Se({},yu),{},{"Content-Type":"application/json"},e);super(i,a,t,"vectors")}async createBucket(n){var e=this;return e.handleOperation(async()=>await ft(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:n},{headers:e.headers})||{})}async getBucket(n){var e=this;return e.handleOperation(async()=>await ft(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:n},{headers:e.headers}))}async listBuckets(n={}){var e=this;return e.handleOperation(async()=>await ft(e.fetch,`${e.url}/ListVectorBuckets`,n,{headers:e.headers}))}async deleteBucket(n){var e=this;return e.handleOperation(async()=>await ft(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:n},{headers:e.headers})||{})}},g6=class extends p6{constructor(n,e={}){super(n,e.headers||{},e.fetch)}from(n){return new m6(this.url,this.headers,n,this.fetch)}async createBucket(n){var e=()=>super.createBucket,t=this;return e().call(t,n)}async getBucket(n){var e=()=>super.getBucket,t=this;return e().call(t,n)}async listBuckets(n={}){var e=()=>super.listBuckets,t=this;return e().call(t,n)}async deleteBucket(n){var e=()=>super.deleteBucket,t=this;return e().call(t,n)}},m6=class extends d6{constructor(n,e,t,i){super(n,e,i),this.vectorBucketName=t}async createIndex(n){var e=()=>super.createIndex,t=this;return e().call(t,Se(Se({},n),{},{vectorBucketName:t.vectorBucketName}))}async listIndexes(n={}){var e=()=>super.listIndexes,t=this;return e().call(t,Se(Se({},n),{},{vectorBucketName:t.vectorBucketName}))}async getIndex(n){var e=()=>super.getIndex,t=this;return e().call(t,t.vectorBucketName,n)}async deleteIndex(n){var e=()=>super.deleteIndex,t=this;return e().call(t,t.vectorBucketName,n)}index(n){return new y6(this.url,this.headers,this.vectorBucketName,n,this.fetch)}},y6=class extends f6{constructor(n,e,t,i,a){super(n,e,a),this.vectorBucketName=t,this.indexName=i}async putVectors(n){var e=()=>super.putVectors,t=this;return e().call(t,Se(Se({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async getVectors(n){var e=()=>super.getVectors,t=this;return e().call(t,Se(Se({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async listVectors(n={}){var e=()=>super.listVectors,t=this;return e().call(t,Se(Se({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async queryVectors(n){var e=()=>super.queryVectors,t=this;return e().call(t,Se(Se({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async deleteVectors(n){var e=()=>super.deleteVectors,t=this;return e().call(t,Se(Se({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}},v6=class extends u6{constructor(n,e={},t,i){super(n,e,t,i)}from(n){return new l6(this.url,this.headers,n,this.fetch)}get vectors(){return new g6(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new h6(this.url+"/iceberg",this.headers,this.fetch)}};const yS="2.93.2",zo=30*1e3,Lm=3,Wg=Lm*zo,_6="http://localhost:9999",b6="supabase.auth.token",w6={"X-Client-Info":`gotrue-js/${yS}`},Um="X-Supabase-Api-Version",vS={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},x6=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,T6=600*1e3;class tu extends Error{constructor(e,t,i){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=i}}function _e(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class E6 extends tu{constructor(e,t,i){super(e,t,i),this.name="AuthApiError",this.status=t,this.code=i}}function S6(n){return _e(n)&&n.name==="AuthApiError"}class ya extends tu{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class ki extends tu{constructor(e,t,i,a){super(e,i,a),this.name=t,this.status=i}}class Pn extends ki{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Qg(n){return _e(n)&&n.name==="AuthSessionMissingError"}class Io extends ki{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class id extends ki{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class rd extends ki{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function A6(n){return _e(n)&&n.name==="AuthImplicitGrantRedirectError"}class Ox extends ki{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class C6 extends ki{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Vm extends ki{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Jg(n){return _e(n)&&n.name==="AuthRetryableFetchError"}class jx extends ki{constructor(e,t,i){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=i}}class Bm extends ki{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const $d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Dx=` 	
\r=`.split(""),N6=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<Dx.length;e+=1)n[Dx[e].charCodeAt(0)]=-2;for(let e=0;e<$d.length;e+=1)n[$d[e].charCodeAt(0)]=e;return n})();function Px(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;t($d[i]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;t($d[i]),e.queuedBits-=6}}function _S(n,e,t){const i=N6[n];if(i>-1)for(e.queue=e.queue<<6|i,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(i===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function Mx(n){const e=[],t=u=>{e.push(String.fromCodePoint(u))},i={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},l=u=>{I6(u,i,t)};for(let u=0;u<n.length;u+=1)_S(n.charCodeAt(u),a,l);return e.join("")}function R6(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function k6(n,e){for(let t=0;t<n.length;t+=1){let i=n.charCodeAt(t);if(i>55295&&i<=56319){const a=(i-55296)*1024&65535;i=(n.charCodeAt(t+1)-56320&65535|a)+65536,t+=1}R6(i,e)}}function I6(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let i=1;i<6;i+=1)if((n>>7-i&1)===0){e.utf8seq=i;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function Zo(n){const e=[],t={queue:0,queuedBits:0},i=a=>{e.push(a)};for(let a=0;a<n.length;a+=1)_S(n.charCodeAt(a),t,i);return new Uint8Array(e)}function O6(n){const e=[];return k6(n,t=>e.push(t)),new Uint8Array(e)}function wa(n){const e=[],t={queue:0,queuedBits:0},i=a=>{e.push(a)};return n.forEach(a=>Px(a,t,i)),Px(null,t,i),e.join("")}function j6(n){return Math.round(Date.now()/1e3)+n}function D6(){return Symbol("auth-callback")}const en=()=>typeof window<"u"&&typeof document<"u",da={tested:!1,writable:!1},bS=()=>{if(!en())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(da.tested)return da.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),da.tested=!0,da.writable=!0}catch{da.tested=!0,da.writable=!1}return da.writable};function P6(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((a,l)=>{e[l]=a})}catch{}return t.searchParams.forEach((i,a)=>{e[a]=i}),e}const wS=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),M6=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",Ho=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},fa=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Zt=async(n,e)=>{await n.removeItem(e)};class Tf{constructor(){this.promise=new Tf.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Tf.promiseConstructor=Promise;function ad(n){const e=n.split(".");if(e.length!==3)throw new Bm("Invalid JWT structure");for(let i=0;i<e.length;i++)if(!x6.test(e[i]))throw new Bm("JWT not in base64url format");return{header:JSON.parse(Mx(e[0])),payload:JSON.parse(Mx(e[1])),signature:Zo(e[2]),raw:{header:e[0],payload:e[1]}}}async function L6(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function U6(n,e){return new Promise((i,a)=>{(async()=>{for(let l=0;l<1/0;l++)try{const u=await n(l);if(!e(l,null,u)){i(u);return}}catch(u){if(!e(l,u)){a(u);return}}})()})}function V6(n){return("0"+n.toString(16)).substr(-2)}function B6(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",i=t.length;let a="";for(let l=0;l<56;l++)a+=t.charAt(Math.floor(Math.random()*i));return a}return crypto.getRandomValues(e),Array.from(e,V6).join("")}async function z6(n){const t=new TextEncoder().encode(n),i=await crypto.subtle.digest("SHA-256",t),a=new Uint8Array(i);return Array.from(a).map(l=>String.fromCharCode(l)).join("")}async function H6(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await z6(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Oo(n,e,t=!1){const i=B6();let a=i;t&&(a+="/PASSWORD_RECOVERY"),await Ho(n,`${e}-code-verifier`,a);const l=await H6(i);return[l,i===l?"plain":"s256"]}const $6=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function q6(n){const e=n.headers.get(Um);if(!e||!e.match($6))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function F6(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function G6(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const K6=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function jo(n){if(!K6.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Xg(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const i=t.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Y6(n,e){return new Proxy(n,{get:(t,i,a)=>{if(i==="__isInsecureUserWarningProxy")return!0;if(typeof i=="symbol"){const l=i.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)"||l==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,i,a)}return!e.value&&typeof i=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(t,i,a)}})}function Lx(n){return JSON.parse(JSON.stringify(n))}const ga=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),W6=[502,503,504];async function Ux(n){var e;if(!M6(n))throw new Vm(ga(n),0);if(W6.includes(n.status))throw new Vm(ga(n),n.status);let t;try{t=await n.json()}catch(l){throw new ya(ga(l),l)}let i;const a=q6(n);if(a&&a.getTime()>=vS["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?i=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(i=t.error_code),i){if(i==="weak_password")throw new jx(ga(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(i==="session_not_found")throw new Pn}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((l,u)=>l&&typeof u=="string",!0))throw new jx(ga(t),n.status,t.weak_password.reasons);throw new E6(ga(t),n.status||500,i)}const Q6=(n,e,t,i)=>{const a={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),a.body=JSON.stringify(i),Object.assign(Object.assign({},a),t))};async function Te(n,e,t,i){var a;const l=Object.assign({},i==null?void 0:i.headers);l[Um]||(l[Um]=vS["2024-01-01"].name),i!=null&&i.jwt&&(l.Authorization=`Bearer ${i.jwt}`);const u=(a=i==null?void 0:i.query)!==null&&a!==void 0?a:{};i!=null&&i.redirectTo&&(u.redirect_to=i.redirectTo);const d=Object.keys(u).length?"?"+new URLSearchParams(u).toString():"",g=await J6(n,e,t+d,{headers:l,noResolveJson:i==null?void 0:i.noResolveJson},{},i==null?void 0:i.body);return i!=null&&i.xform?i==null?void 0:i.xform(g):{data:Object.assign({},g),error:null}}async function J6(n,e,t,i,a,l){const u=Q6(e,i,a,l);let d;try{d=await n(t,Object.assign({},u))}catch(g){throw console.error(g),new Vm(ga(g),0)}if(d.ok||await Ux(d),i!=null&&i.noResolveJson)return d;try{return await d.json()}catch(g){await Ux(g)}}function ps(n){var e;let t=null;e3(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=j6(n.expires_in)));const i=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:i},error:null}}function Vx(n){const e=ps(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,i)=>t&&typeof i=="string",!0)&&(e.data.weak_password=n.weak_password),e}function yr(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function X6(n){return{data:n,error:null}}function Z6(n){const{action_link:e,email_otp:t,hashed_token:i,redirect_to:a,verification_type:l}=n,u=bf(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),d={action_link:e,email_otp:t,hashed_token:i,redirect_to:a,verification_type:l},g=Object.assign({},u);return{data:{properties:d,user:g},error:null}}function Bx(n){return n}function e3(n){return n.access_token&&n.refresh_token&&n.expires_in}const Zg=["global","local","others"];class t3{constructor({url:e="",headers:t={},fetch:i}){this.url=e,this.headers=t,this.fetch=wS(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=Zg[0]){if(Zg.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Zg.join(", ")}`);try{return await Te(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(i){if(_e(i))return{data:null,error:i};throw i}}async inviteUserByEmail(e,t={}){try{return await Te(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:yr})}catch(i){if(_e(i))return{data:{user:null},error:i};throw i}}async generateLink(e){try{const{options:t}=e,i=bf(e,["options"]),a=Object.assign(Object.assign({},i),t);return"newEmail"in i&&(a.new_email=i==null?void 0:i.newEmail,delete a.newEmail),await Te(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:Z6,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(_e(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Te(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:yr})}catch(t){if(_e(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,i,a,l,u,d,g;try{const m={nextPage:null,lastPage:0,total:0},_=await Te(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:"",per_page:(l=(a=e==null?void 0:e.perPage)===null||a===void 0?void 0:a.toString())!==null&&l!==void 0?l:""},xform:Bx});if(_.error)throw _.error;const w=await _.json(),T=(u=_.headers.get("x-total-count"))!==null&&u!==void 0?u:0,S=(g=(d=_.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&g!==void 0?g:[];return S.length>0&&(S.forEach(N=>{const M=parseInt(N.split(";")[0].split("=")[1].substring(0,1)),k=JSON.parse(N.split(";")[1].split("=")[1]);m[`${k}Page`]=M}),m.total=parseInt(T)),{data:Object.assign(Object.assign({},w),m),error:null}}catch(m){if(_e(m))return{data:{users:[]},error:m};throw m}}async getUserById(e){jo(e);try{return await Te(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:yr})}catch(t){if(_e(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){jo(e);try{return await Te(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:yr})}catch(i){if(_e(i))return{data:{user:null},error:i};throw i}}async deleteUser(e,t=!1){jo(e);try{return await Te(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:yr})}catch(i){if(_e(i))return{data:{user:null},error:i};throw i}}async _listFactors(e){jo(e.userId);try{const{data:t,error:i}=await Te(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:t,error:i}}catch(t){if(_e(t))return{data:null,error:t};throw t}}async _deleteFactor(e){jo(e.userId),jo(e.id);try{return{data:await Te(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(_e(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,i,a,l,u,d,g;try{const m={nextPage:null,lastPage:0,total:0},_=await Te(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:"",per_page:(l=(a=e==null?void 0:e.perPage)===null||a===void 0?void 0:a.toString())!==null&&l!==void 0?l:""},xform:Bx});if(_.error)throw _.error;const w=await _.json(),T=(u=_.headers.get("x-total-count"))!==null&&u!==void 0?u:0,S=(g=(d=_.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&g!==void 0?g:[];return S.length>0&&(S.forEach(N=>{const M=parseInt(N.split(";")[0].split("=")[1].substring(0,1)),k=JSON.parse(N.split(";")[1].split("=")[1]);m[`${k}Page`]=M}),m.total=parseInt(T)),{data:Object.assign(Object.assign({},w),m),error:null}}catch(m){if(_e(m))return{data:{clients:[]},error:m};throw m}}async _createOAuthClient(e){try{return await Te(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(_e(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await Te(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(_e(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await Te(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:i=>({data:i,error:null})})}catch(i){if(_e(i))return{data:null,error:i};throw i}}async _deleteOAuthClient(e){try{return await Te(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(_e(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await Te(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(_e(t))return{data:null,error:t};throw t}}}function zx(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}const Do={debug:!!(globalThis&&bS()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class xS extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class n3 extends xS{}async function s3(n,e,t){Do.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const i=new globalThis.AbortController;return e>0&&setTimeout(()=>{i.abort(),Do.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},async a=>{if(a){Do.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,a.name);try{return await t()}finally{Do.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,a.name)}}else{if(e===0)throw Do.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new n3(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(Do.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}function i3(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function TS(n){if(!/^0x[a-fA-F0-9]{40}$/.test(n))throw new Error(`@supabase/auth-js: Address "${n}" is invalid.`);return n.toLowerCase()}function r3(n){return parseInt(n,16)}function a3(n){const e=new TextEncoder().encode(n);return"0x"+Array.from(e,i=>i.toString(16).padStart(2,"0")).join("")}function o3(n){var e;const{chainId:t,domain:i,expirationTime:a,issuedAt:l=new Date,nonce:u,notBefore:d,requestId:g,resources:m,scheme:_,uri:w,version:T}=n;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!i)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(u&&u.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${u}`);if(!w)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(T!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${T}`);if(!((e=n.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${n.statement}`)}const S=TS(n.address),N=_?`${_}://${i}`:i,M=n.statement?`${n.statement}
`:"",k=`${N} wants you to sign in with your Ethereum account:
${S}

${M}`;let V=`URI: ${w}
Version: ${T}
Chain ID: ${t}${u?`
Nonce: ${u}`:""}
Issued At: ${l.toISOString()}`;if(a&&(V+=`
Expiration Time: ${a.toISOString()}`),d&&(V+=`
Not Before: ${d.toISOString()}`),g&&(V+=`
Request ID: ${g}`),m){let F=`
Resources:`;for(const $ of m){if(!$||typeof $!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${$}`);F+=`
- ${$}`}V+=F}return`${k}
${V}`}class Pt extends Error{constructor({message:e,code:t,cause:i,name:a}){var l;super(e,{cause:i}),this.__isWebAuthnError=!0,this.name=(l=a??(i instanceof Error?i.name:void 0))!==null&&l!==void 0?l:"Unknown Error",this.code=t}}class qd extends Pt{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function l3({error:n,options:e}){var t,i,a;const{publicKey:l}=e;if(!l)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Pt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else if(n.name==="ConstraintError"){if(((t=l.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new Pt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:n});if(e.mediation==="conditional"&&((i=l.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new Pt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:n});if(((a=l.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new Pt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:n})}else{if(n.name==="InvalidStateError")return new Pt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:n});if(n.name==="NotAllowedError")return new Pt({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="NotSupportedError")return l.pubKeyCredParams.filter(d=>d.type==="public-key").length===0?new Pt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:n}):new Pt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:n});if(n.name==="SecurityError"){const u=window.location.hostname;if(ES(u)){if(l.rp.id!==u)return new Pt({message:`The RP ID "${l.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new Pt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="TypeError"){if(l.user.id.byteLength<1||l.user.id.byteLength>64)return new Pt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:n})}else if(n.name==="UnknownError")return new Pt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new Pt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}function c3({error:n,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Pt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else{if(n.name==="NotAllowedError")return new Pt({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="SecurityError"){const i=window.location.hostname;if(ES(i)){if(t.rpId!==i)return new Pt({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new Pt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="UnknownError")return new Pt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new Pt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}class u3{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const h3=new u3;function d3(n){if(!n)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(n);const{challenge:e,user:t,excludeCredentials:i}=n,a=bf(n,["challenge","user","excludeCredentials"]),l=Zo(e).buffer,u=Object.assign(Object.assign({},t),{id:Zo(t.id).buffer}),d=Object.assign(Object.assign({},a),{challenge:l,user:u});if(i&&i.length>0){d.excludeCredentials=new Array(i.length);for(let g=0;g<i.length;g++){const m=i[g];d.excludeCredentials[g]=Object.assign(Object.assign({},m),{id:Zo(m.id).buffer,type:m.type||"public-key",transports:m.transports})}}return d}function f3(n){if(!n)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(n);const{challenge:e,allowCredentials:t}=n,i=bf(n,["challenge","allowCredentials"]),a=Zo(e).buffer,l=Object.assign(Object.assign({},i),{challenge:a});if(t&&t.length>0){l.allowCredentials=new Array(t.length);for(let u=0;u<t.length;u++){const d=t[u];l.allowCredentials[u]=Object.assign(Object.assign({},d),{id:Zo(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function p3(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n;return{id:n.id,rawId:n.id,response:{attestationObject:wa(new Uint8Array(n.response.attestationObject)),clientDataJSON:wa(new Uint8Array(n.response.clientDataJSON))},type:"public-key",clientExtensionResults:n.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function g3(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n,i=n.getClientExtensionResults(),a=n.response;return{id:n.id,rawId:n.id,response:{authenticatorData:wa(new Uint8Array(a.authenticatorData)),clientDataJSON:wa(new Uint8Array(a.clientDataJSON)),signature:wa(new Uint8Array(a.signature)),userHandle:a.userHandle?wa(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:i,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function ES(n){return n==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(n)}function Hx(){var n,e;return!!(en()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((n=navigator==null?void 0:navigator.credentials)===null||n===void 0?void 0:n.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function m3(n){try{const e=await navigator.credentials.create(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new qd("Browser returned unexpected credential type",e)}:{data:null,error:new qd("Empty credential response",e)}}catch(e){return{data:null,error:l3({error:e,options:n})}}}async function y3(n){try{const e=await navigator.credentials.get(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new qd("Browser returned unexpected credential type",e)}:{data:null,error:new qd("Empty credential response",e)}}catch(e){return{data:null,error:c3({error:e,options:n})}}}const v3={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},_3={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Fd(...n){const e=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),t=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),i={};for(const a of n)if(a)for(const l in a){const u=a[l];if(u!==void 0)if(Array.isArray(u))i[l]=u;else if(t(u))i[l]=u;else if(e(u)){const d=i[l];e(d)?i[l]=Fd(d,u):i[l]=Fd(u)}else i[l]=u}return i}function b3(n,e){return Fd(v3,n,e||{})}function w3(n,e){return Fd(_3,n,e||{})}class x3{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:i,signal:a},l){try{const{data:u,error:d}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!u)return{data:null,error:d};const g=a??h3.createNewAbortSignal();if(u.webauthn.type==="create"){const{user:m}=u.webauthn.credential_options.publicKey;m.name||(m.name=`${m.id}:${i}`),m.displayName||(m.displayName=m.name)}switch(u.webauthn.type){case"create":{const m=b3(u.webauthn.credential_options.publicKey,l==null?void 0:l.create),{data:_,error:w}=await m3({publicKey:m,signal:g});return _?{data:{factorId:e,challengeId:u.id,webauthn:{type:u.webauthn.type,credential_response:_}},error:null}:{data:null,error:w}}case"request":{const m=w3(u.webauthn.credential_options.publicKey,l==null?void 0:l.request),{data:_,error:w}=await y3(Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:m,signal:g}));return _?{data:{factorId:e,challengeId:u.id,webauthn:{type:u.webauthn.type,credential_response:_}},error:null}:{data:null,error:w}}}}catch(u){return _e(u)?{data:null,error:u}:{data:null,error:new ya("Unexpected error in challenge",u)}}}async _verify({challengeId:e,factorId:t,webauthn:i}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:i})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},l){if(!t)return{data:null,error:new tu("rpId is required for WebAuthn authentication")};try{if(!Hx())return{data:null,error:new ya("Browser does not support WebAuthn",null)};const{data:u,error:d}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:i},signal:a},{request:l});if(!u)return{data:null,error:d};const{webauthn:g}=u;return this._verify({factorId:e,challengeId:u.challengeId,webauthn:{type:g.type,rpId:t,rpOrigins:i,credential_response:g.credential_response}})}catch(u){return _e(u)?{data:null,error:u}:{data:null,error:new ya("Unexpected error in authenticate",u)}}}async _register({friendlyName:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},l){if(!t)return{data:null,error:new tu("rpId is required for WebAuthn registration")};try{if(!Hx())return{data:null,error:new ya("Browser does not support WebAuthn",null)};const{data:u,error:d}=await this._enroll({friendlyName:e});if(!u)return await this.client.mfa.listFactors().then(_=>{var w;return(w=_.data)===null||w===void 0?void 0:w.all.find(T=>T.factor_type==="webauthn"&&T.friendly_name===e&&T.status!=="unverified")}).then(_=>_?this.client.mfa.unenroll({factorId:_==null?void 0:_.id}):void 0),{data:null,error:d};const{data:g,error:m}=await this._challenge({factorId:u.id,friendlyName:u.friendly_name,webauthn:{rpId:t,rpOrigins:i},signal:a},{create:l});return g?this._verify({factorId:u.id,challengeId:g.challengeId,webauthn:{rpId:t,rpOrigins:i,type:g.webauthn.type,credential_response:g.webauthn.credential_response}}):{data:null,error:m}}catch(u){return _e(u)?{data:null,error:u}:{data:null,error:new ya("Unexpected error in register",u)}}}}i3();const T3={url:_6,storageKey:b6,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:w6,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function $x(n,e,t){return await t()}const Po={};class nu{get jwks(){var e,t;return(t=(e=Po[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Po[this.storageKey]=Object.assign(Object.assign({},Po[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Po[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Po[this.storageKey]=Object.assign(Object.assign({},Po[this.storageKey]),{cachedAt:e})}constructor(e){var t,i,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const l=Object.assign(Object.assign({},T3),e);if(this.storageKey=l.storageKey,this.instanceID=(t=nu.nextInstanceID[this.storageKey])!==null&&t!==void 0?t:0,nu.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!l.debug,typeof l.debug=="function"&&(this.logger=l.debug),this.instanceID>0&&en()){const u=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(u),this.logDebugMessages&&console.trace(u)}if(this.persistSession=l.persistSession,this.autoRefreshToken=l.autoRefreshToken,this.admin=new t3({url:l.url,headers:l.headers,fetch:l.fetch}),this.url=l.url,this.headers=l.headers,this.fetch=wS(l.fetch),this.lock=l.lock||$x,this.detectSessionInUrl=l.detectSessionInUrl,this.flowType=l.flowType,this.hasCustomAuthorizationHeader=l.hasCustomAuthorizationHeader,this.throwOnError=l.throwOnError,this.lockAcquireTimeout=l.lockAcquireTimeout,l.lock?this.lock=l.lock:this.persistSession&&en()&&(!((i=globalThis==null?void 0:globalThis.navigator)===null||i===void 0)&&i.locks)?this.lock=s3:this.lock=$x,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new x3(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(l.storage?this.storage=l.storage:bS()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=zx(this.memoryStorage)),l.userStorage&&(this.userStorage=l.userStorage)):(this.memoryStorage={},this.storage=zx(this.memoryStorage)),en()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(u){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",u)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async u=>{this._debug("received broadcast notification from other tab or client",u);try{await this._notifyAllSubscribers(u.data.event,u.data.session,!1)}catch(d){this._debug("#broadcastChannel","error",d)}})}this.initialize().catch(u=>{this._debug("#initialize()","error",u)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${yS}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let t={},i="none";if(en()&&(t=P6(window.location.href),this._isImplicitGrantCallback(t)?i="implicit":await this._isPKCECallback(t)&&(i="pkce")),en()&&this.detectSessionInUrl&&i!=="none"){const{data:a,error:l}=await this._getSessionFromURL(t,i);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),A6(l)){const g=(e=l.details)===null||e===void 0?void 0:e.code;if(g==="identity_already_exists"||g==="identity_not_found"||g==="single_identity_not_deletable")return{error:l}}return{error:l}}const{session:u,redirectType:d}=a;return this._debug("#_initialize()","detected session in URL",u,"redirect type",d),await this._saveSession(u),setTimeout(async()=>{d==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",u):await this._notifyAllSubscribers("SIGNED_IN",u)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return _e(t)?this._returnResult({error:t}):this._returnResult({error:new ya("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,i,a;try{const l=await Te(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(i=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:(a=e==null?void 0:e.options)===null||a===void 0?void 0:a.captchaToken}},xform:ps}),{data:u,error:d}=l;if(d||!u)return this._returnResult({data:{user:null,session:null},error:d});const g=u.session,m=u.user;return u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",g)),this._returnResult({data:{user:m,session:g},error:null})}catch(l){if(_e(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signUp(e){var t,i,a;try{let l;if("email"in e){const{email:_,password:w,options:T}=e;let S=null,N=null;this.flowType==="pkce"&&([S,N]=await Oo(this.storage,this.storageKey)),l=await Te(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:T==null?void 0:T.emailRedirectTo,body:{email:_,password:w,data:(t=T==null?void 0:T.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:T==null?void 0:T.captchaToken},code_challenge:S,code_challenge_method:N},xform:ps})}else if("phone"in e){const{phone:_,password:w,options:T}=e;l=await Te(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:_,password:w,data:(i=T==null?void 0:T.data)!==null&&i!==void 0?i:{},channel:(a=T==null?void 0:T.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:T==null?void 0:T.captchaToken}},xform:ps})}else throw new id("You must provide either an email or phone number and a password");const{data:u,error:d}=l;if(d||!u)return await Zt(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:d});const g=u.session,m=u.user;return u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",g)),this._returnResult({data:{user:m,session:g},error:null})}catch(l){if(await Zt(this.storage,`${this.storageKey}-code-verifier`),_e(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signInWithPassword(e){try{let t;if("email"in e){const{email:l,password:u,options:d}=e;t=await Te(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:u,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:Vx})}else if("phone"in e){const{phone:l,password:u,options:d}=e;t=await Te(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:u,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:Vx})}else throw new id("You must provide either an email or phone number and a password");const{data:i,error:a}=t;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!i||!i.session||!i.user){const l=new Io;return this._returnResult({data:{user:null,session:null},error:l})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:a})}catch(t){if(_e(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,i,a,l;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(i=e.options)===null||i===void 0?void 0:i.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(l=e.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,i,a,l,u,d,g,m,_,w,T;let S,N;if("message"in e)S=e.message,N=e.signature;else{const{chain:M,wallet:k,statement:V,options:F}=e;let $;if(en())if(typeof k=="object")$=k;else{const I=window;if("ethereum"in I&&typeof I.ethereum=="object"&&"request"in I.ethereum&&typeof I.ethereum.request=="function")$=I.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof k!="object"||!(F!=null&&F.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");$=k}const D=new URL((t=F==null?void 0:F.url)!==null&&t!==void 0?t:window.location.href),q=await $.request({method:"eth_requestAccounts"}).then(I=>I).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!q||q.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const J=TS(q[0]);let R=(i=F==null?void 0:F.signInWithEthereum)===null||i===void 0?void 0:i.chainId;if(!R){const I=await $.request({method:"eth_chainId"});R=r3(I)}const A={domain:D.host,address:J,statement:V,uri:D.href,version:"1",chainId:R,nonce:(a=F==null?void 0:F.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(u=(l=F==null?void 0:F.signInWithEthereum)===null||l===void 0?void 0:l.issuedAt)!==null&&u!==void 0?u:new Date,expirationTime:(d=F==null?void 0:F.signInWithEthereum)===null||d===void 0?void 0:d.expirationTime,notBefore:(g=F==null?void 0:F.signInWithEthereum)===null||g===void 0?void 0:g.notBefore,requestId:(m=F==null?void 0:F.signInWithEthereum)===null||m===void 0?void 0:m.requestId,resources:(_=F==null?void 0:F.signInWithEthereum)===null||_===void 0?void 0:_.resources};S=o3(A),N=await $.request({method:"personal_sign",params:[a3(S),J]})}try{const{data:M,error:k}=await Te(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:S,signature:N},!((w=e.options)===null||w===void 0)&&w.captchaToken?{gotrue_meta_security:{captcha_token:(T=e.options)===null||T===void 0?void 0:T.captchaToken}}:null),xform:ps});if(k)throw k;if(!M||!M.session||!M.user){const V=new Io;return this._returnResult({data:{user:null,session:null},error:V})}return M.session&&(await this._saveSession(M.session),await this._notifyAllSubscribers("SIGNED_IN",M.session)),this._returnResult({data:Object.assign({},M),error:k})}catch(M){if(_e(M))return this._returnResult({data:{user:null,session:null},error:M});throw M}}async signInWithSolana(e){var t,i,a,l,u,d,g,m,_,w,T,S;let N,M;if("message"in e)N=e.message,M=e.signature;else{const{chain:k,wallet:V,statement:F,options:$}=e;let D;if(en())if(typeof V=="object")D=V;else{const J=window;if("solana"in J&&typeof J.solana=="object"&&("signIn"in J.solana&&typeof J.solana.signIn=="function"||"signMessage"in J.solana&&typeof J.solana.signMessage=="function"))D=J.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof V!="object"||!($!=null&&$.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");D=V}const q=new URL((t=$==null?void 0:$.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in D&&D.signIn){const J=await D.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},$==null?void 0:$.signInWithSolana),{version:"1",domain:q.host,uri:q.href}),F?{statement:F}:null));let R;if(Array.isArray(J)&&J[0]&&typeof J[0]=="object")R=J[0];else if(J&&typeof J=="object"&&"signedMessage"in J&&"signature"in J)R=J;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in R&&"signature"in R&&(typeof R.signedMessage=="string"||R.signedMessage instanceof Uint8Array)&&R.signature instanceof Uint8Array)N=typeof R.signedMessage=="string"?R.signedMessage:new TextDecoder().decode(R.signedMessage),M=R.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in D)||typeof D.signMessage!="function"||!("publicKey"in D)||typeof D!="object"||!D.publicKey||!("toBase58"in D.publicKey)||typeof D.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");N=[`${q.host} wants you to sign in with your Solana account:`,D.publicKey.toBase58(),...F?["",F,""]:[""],"Version: 1",`URI: ${q.href}`,`Issued At: ${(a=(i=$==null?void 0:$.signInWithSolana)===null||i===void 0?void 0:i.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((l=$==null?void 0:$.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${$.signInWithSolana.notBefore}`]:[],...!((u=$==null?void 0:$.signInWithSolana)===null||u===void 0)&&u.expirationTime?[`Expiration Time: ${$.signInWithSolana.expirationTime}`]:[],...!((d=$==null?void 0:$.signInWithSolana)===null||d===void 0)&&d.chainId?[`Chain ID: ${$.signInWithSolana.chainId}`]:[],...!((g=$==null?void 0:$.signInWithSolana)===null||g===void 0)&&g.nonce?[`Nonce: ${$.signInWithSolana.nonce}`]:[],...!((m=$==null?void 0:$.signInWithSolana)===null||m===void 0)&&m.requestId?[`Request ID: ${$.signInWithSolana.requestId}`]:[],...!((w=(_=$==null?void 0:$.signInWithSolana)===null||_===void 0?void 0:_.resources)===null||w===void 0)&&w.length?["Resources",...$.signInWithSolana.resources.map(R=>`- ${R}`)]:[]].join(`
`);const J=await D.signMessage(new TextEncoder().encode(N),"utf8");if(!J||!(J instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");M=J}}try{const{data:k,error:V}=await Te(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:N,signature:wa(M)},!((T=e.options)===null||T===void 0)&&T.captchaToken?{gotrue_meta_security:{captcha_token:(S=e.options)===null||S===void 0?void 0:S.captchaToken}}:null),xform:ps});if(V)throw V;if(!k||!k.session||!k.user){const F=new Io;return this._returnResult({data:{user:null,session:null},error:F})}return k.session&&(await this._saveSession(k.session),await this._notifyAllSubscribers("SIGNED_IN",k.session)),this._returnResult({data:Object.assign({},k),error:V})}catch(k){if(_e(k))return this._returnResult({data:{user:null,session:null},error:k});throw k}}async _exchangeCodeForSession(e){const t=await fa(this.storage,`${this.storageKey}-code-verifier`),[i,a]=(t??"").split("/");try{if(!i&&this.flowType==="pkce")throw new C6;const{data:l,error:u}=await Te(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:i},xform:ps});if(await Zt(this.storage,`${this.storageKey}-code-verifier`),u)throw u;if(!l||!l.session||!l.user){const d=new Io;return this._returnResult({data:{user:null,session:null,redirectType:null},error:d})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign(Object.assign({},l),{redirectType:a??null}),error:u})}catch(l){if(await Zt(this.storage,`${this.storageKey}-code-verifier`),_e(l))return this._returnResult({data:{user:null,session:null,redirectType:null},error:l});throw l}}async signInWithIdToken(e){try{const{options:t,provider:i,token:a,access_token:l,nonce:u}=e,d=await Te(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:a,access_token:l,nonce:u,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:ps}),{data:g,error:m}=d;if(m)return this._returnResult({data:{user:null,session:null},error:m});if(!g||!g.session||!g.user){const _=new Io;return this._returnResult({data:{user:null,session:null},error:_})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:g,error:m})}catch(t){if(_e(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,i,a,l,u;try{if("email"in e){const{email:d,options:g}=e;let m=null,_=null;this.flowType==="pkce"&&([m,_]=await Oo(this.storage,this.storageKey));const{error:w}=await Te(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:d,data:(t=g==null?void 0:g.data)!==null&&t!==void 0?t:{},create_user:(i=g==null?void 0:g.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},code_challenge:m,code_challenge_method:_},redirectTo:g==null?void 0:g.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:w})}if("phone"in e){const{phone:d,options:g}=e,{data:m,error:_}=await Te(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:d,data:(a=g==null?void 0:g.data)!==null&&a!==void 0?a:{},create_user:(l=g==null?void 0:g.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},channel:(u=g==null?void 0:g.channel)!==null&&u!==void 0?u:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:m==null?void 0:m.message_id},error:_})}throw new id("You must provide either an email or phone number.")}catch(d){if(await Zt(this.storage,`${this.storageKey}-code-verifier`),_e(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async verifyOtp(e){var t,i;try{let a,l;"options"in e&&(a=(t=e.options)===null||t===void 0?void 0:t.redirectTo,l=(i=e.options)===null||i===void 0?void 0:i.captchaToken);const{data:u,error:d}=await Te(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:l}}),redirectTo:a,xform:ps});if(d)throw d;if(!u)throw new Error("An error occurred on token verification.");const g=u.session,m=u.user;return g!=null&&g.access_token&&(await this._saveSession(g),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",g)),this._returnResult({data:{user:m,session:g},error:null})}catch(a){if(_e(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(e){var t,i,a,l,u;try{let d=null,g=null;this.flowType==="pkce"&&([d,g]=await Oo(this.storage,this.storageKey));const m=await Te(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(i=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&i!==void 0?i:void 0}),!((a=e==null?void 0:e.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:d,code_challenge_method:g}),headers:this.headers,xform:X6});return!((l=m.data)===null||l===void 0)&&l.url&&en()&&!(!((u=e.options)===null||u===void 0)&&u.skipBrowserRedirect)&&window.location.assign(m.data.url),this._returnResult(m)}catch(d){if(await Zt(this.storage,`${this.storageKey}-code-verifier`),_e(d))return this._returnResult({data:null,error:d});throw d}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:i}=e;if(i)throw i;if(!t)throw new Pn;const{error:a}=await Te(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(e){if(_e(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:i,type:a,options:l}=e,{error:u}=await Te(this.fetch,"POST",t,{headers:this.headers,body:{email:i,type:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},redirectTo:l==null?void 0:l.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:u})}else if("phone"in e){const{phone:i,type:a,options:l}=e,{data:u,error:d}=await Te(this.fetch,"POST",t,{headers:this.headers,body:{phone:i,type:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d})}throw new id("You must provide either an email or phone number and a type")}catch(t){if(_e(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const i=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await i,await t()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const i=t();for(this.pendingInLock.push((async()=>{try{await i}catch{}})()),await i;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await i}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await fa(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const i=e.expires_at?e.expires_at*1e3-Date.now()<Wg:!1;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",e.expires_at),!i){if(this.userStorage){const u=await fa(this.userStorage,this.storageKey+"-user");u!=null&&u.user?e.user=u.user:e.user=Xg()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const u={value:this.suppressGetSessionWarning};e.user=Y6(e.user,u),u.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:a,error:l}=await this._callRefreshToken(e.refresh_token);return l?this._returnResult({data:{session:null},error:l}):this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const t=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(e){try{return e?await Te(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:yr}):await this._useSession(async t=>{var i,a,l;const{data:u,error:d}=t;if(d)throw d;return!(!((i=u.session)===null||i===void 0)&&i.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Pn}:await Te(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(a=u.session)===null||a===void 0?void 0:a.access_token)!==null&&l!==void 0?l:void 0,xform:yr})})}catch(t){if(_e(t))return Qg(t)&&(await this._removeSession(),await Zt(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async i=>{const{data:a,error:l}=i;if(l)throw l;if(!a.session)throw new Pn;const u=a.session;let d=null,g=null;this.flowType==="pkce"&&e.email!=null&&([d,g]=await Oo(this.storage,this.storageKey));const{data:m,error:_}=await Te(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:d,code_challenge_method:g}),jwt:u.access_token,xform:yr});if(_)throw _;return u.user=m.user,await this._saveSession(u),await this._notifyAllSubscribers("USER_UPDATED",u),this._returnResult({data:{user:u.user},error:null})})}catch(i){if(await Zt(this.storage,`${this.storageKey}-code-verifier`),_e(i))return this._returnResult({data:{user:null},error:i});throw i}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Pn;const t=Date.now()/1e3;let i=t,a=!0,l=null;const{payload:u}=ad(e.access_token);if(u.exp&&(i=u.exp,a=i<=t),a){const{data:d,error:g}=await this._callRefreshToken(e.refresh_token);if(g)return this._returnResult({data:{user:null,session:null},error:g});if(!d)return{data:{user:null,session:null},error:null};l=d}else{const{data:d,error:g}=await this._getUser(e.access_token);if(g)return this._returnResult({data:{user:null,session:null},error:g});l={access_token:e.access_token,refresh_token:e.refresh_token,user:d.user,token_type:"bearer",expires_in:i-t,expires_at:i},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return this._returnResult({data:{user:l.user,session:l},error:null})}catch(t){if(_e(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var i;if(!e){const{data:u,error:d}=t;if(d)throw d;e=(i=u.session)!==null&&i!==void 0?i:void 0}if(!(e!=null&&e.refresh_token))throw new Pn;const{data:a,error:l}=await this._callRefreshToken(e.refresh_token);return l?this._returnResult({data:{user:null,session:null},error:l}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(_e(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!en())throw new rd("No browser detected.");if(e.error||e.error_description||e.error_code)throw new rd(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Ox("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new rd("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Ox("No code detected.");const{data:F,error:$}=await this._exchangeCodeForSession(e.code);if($)throw $;const D=new URL(window.location.href);return D.searchParams.delete("code"),window.history.replaceState(window.history.state,"",D.toString()),{data:{session:F.session,redirectType:null},error:null}}const{provider_token:i,provider_refresh_token:a,access_token:l,refresh_token:u,expires_in:d,expires_at:g,token_type:m}=e;if(!l||!d||!u||!m)throw new rd("No session defined in URL");const _=Math.round(Date.now()/1e3),w=parseInt(d);let T=_+w;g&&(T=parseInt(g));const S=T-_;S*1e3<=zo&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${S}s, should have been closer to ${w}s`);const N=T-w;_-N>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",N,T,_):_-N<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",N,T,_);const{data:M,error:k}=await this._getUser(l);if(k)throw k;const V={provider_token:i,provider_refresh_token:a,access_token:l,expires_in:w,expires_at:T,refresh_token:u,token_type:m,user:M.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:V,redirectType:e.type},error:null})}catch(i){if(_e(i))return this._returnResult({data:{session:null,redirectType:null},error:i});throw i}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await fa(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var i;const{data:a,error:l}=t;if(l&&!Qg(l))return this._returnResult({error:l});const u=(i=a.session)===null||i===void 0?void 0:i.access_token;if(u){const{error:d}=await this.admin.signOut(u,e);if(d&&!(S6(d)&&(d.status===404||d.status===401||d.status===403)||Qg(d)))return this._returnResult({error:d})}return e!=="others"&&(await this._removeSession(),await Zt(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=D6(),i={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,i),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:i}}}async _emitInitialSession(e){return await this._useSession(async t=>{var i,a;try{const{data:{session:l},error:u}=t;if(u)throw u;await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",e,"session",l)}catch(l){await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",l),console.error(l)}})}async resetPasswordForEmail(e,t={}){let i=null,a=null;this.flowType==="pkce"&&([i,a]=await Oo(this.storage,this.storageKey,!0));try{return await Te(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:i,code_challenge_method:a,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(l){if(await Zt(this.storage,`${this.storageKey}-code-verifier`),_e(l))return this._returnResult({data:null,error:l});throw l}}async getUserIdentities(){var e;try{const{data:t,error:i}=await this.getUser();if(i)throw i;return this._returnResult({data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(t){if(_e(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:i,error:a}=await this._useSession(async l=>{var u,d,g,m,_;const{data:w,error:T}=l;if(T)throw T;const S=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(u=e.options)===null||u===void 0?void 0:u.redirectTo,scopes:(d=e.options)===null||d===void 0?void 0:d.scopes,queryParams:(g=e.options)===null||g===void 0?void 0:g.queryParams,skipBrowserRedirect:!0});return await Te(this.fetch,"GET",S,{headers:this.headers,jwt:(_=(m=w.session)===null||m===void 0?void 0:m.access_token)!==null&&_!==void 0?_:void 0})});if(a)throw a;return en()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(i==null?void 0:i.url),this._returnResult({data:{provider:e.provider,url:i==null?void 0:i.url},error:null})}catch(i){if(_e(i))return this._returnResult({data:{provider:e.provider,url:null},error:i});throw i}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var i;try{const{error:a,data:{session:l}}=t;if(a)throw a;const{options:u,provider:d,token:g,access_token:m,nonce:_}=e,w=await Te(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(i=l==null?void 0:l.access_token)!==null&&i!==void 0?i:void 0,body:{provider:d,id_token:g,access_token:m,nonce:_,link_identity:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken}},xform:ps}),{data:T,error:S}=w;return S?this._returnResult({data:{user:null,session:null},error:S}):!T||!T.session||!T.user?this._returnResult({data:{user:null,session:null},error:new Io}):(T.session&&(await this._saveSession(T.session),await this._notifyAllSubscribers("USER_UPDATED",T.session)),this._returnResult({data:T,error:S}))}catch(a){if(await Zt(this.storage,`${this.storageKey}-code-verifier`),_e(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var i,a;const{data:l,error:u}=t;if(u)throw u;return await Te(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(a=(i=l.session)===null||i===void 0?void 0:i.access_token)!==null&&a!==void 0?a:void 0})})}catch(t){if(_e(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const i=Date.now();return await U6(async a=>(a>0&&await L6(200*Math.pow(2,a-1)),this._debug(t,"refreshing attempt",a),await Te(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:ps})),(a,l)=>{const u=200*Math.pow(2,a);return l&&Jg(l)&&Date.now()+u-i<zo})}catch(i){if(this._debug(t,"error",i),_e(i))return this._returnResult({data:{session:null,user:null},error:i});throw i}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const i=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",i),en()&&!t.skipBrowserRedirect&&window.location.assign(i),{data:{provider:e,url:i},error:null}}async _recoverAndRefresh(){var e,t;const i="#_recoverAndRefresh()";this._debug(i,"begin");try{const a=await fa(this.storage,this.storageKey);if(a&&this.userStorage){let u=await fa(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!u&&(u={user:a.user},await Ho(this.userStorage,this.storageKey+"-user",u)),a.user=(e=u==null?void 0:u.user)!==null&&e!==void 0?e:Xg()}else if(a&&!a.user&&!a.user){const u=await fa(this.storage,this.storageKey+"-user");u&&(u!=null&&u.user)?(a.user=u.user,await Zt(this.storage,this.storageKey+"-user"),await Ho(this.storage,this.storageKey,a)):a.user=Xg()}if(this._debug(i,"session from storage",a),!this._isValidSession(a)){this._debug(i,"session is not valid"),a!==null&&await this._removeSession();return}const l=((t=a.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Wg;if(this._debug(i,`session has${l?"":" not"} expired with margin of ${Wg}s`),l){if(this.autoRefreshToken&&a.refresh_token){const{error:u}=await this._callRefreshToken(a.refresh_token);u&&(console.error(u),Jg(u)||(this._debug(i,"refresh failed with a non-retryable error, removing the session",u),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:u,error:d}=await this._getUser(a.access_token);!d&&(u!=null&&u.user)?(a.user=u.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(i,"could not get user data, skipping SIGNED_IN notification")}catch(u){console.error("Error getting user data:",u),this._debug(i,"error getting user data, skipping SIGNED_IN notification",u)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(i,"error",a),console.error(a);return}finally{this._debug(i,"end")}}async _callRefreshToken(e){var t,i;if(!e)throw new Pn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Tf;const{data:l,error:u}=await this._refreshAccessToken(e);if(u)throw u;if(!l.session)throw new Pn;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const d={data:l.session,error:null};return this.refreshingDeferred.resolve(d),d}catch(l){if(this._debug(a,"error",l),_e(l)){const u={data:null,error:l};return Jg(l)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(u),u}throw(i=this.refreshingDeferred)===null||i===void 0||i.reject(l),l}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,t,i=!0){const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",t,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:e,session:t});const l=[],u=Array.from(this.stateChangeEmitters.values()).map(async d=>{try{await d.callback(e,t)}catch(g){l.push(g)}});if(await Promise.all(u),l.length>0){for(let d=0;d<l.length;d+=1)console.error(l[d]);throw l[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Zt(this.storage,`${this.storageKey}-code-verifier`);const t=Object.assign({},e),i=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!i&&t.user&&await Ho(this.userStorage,this.storageKey+"-user",{user:t.user});const a=Object.assign({},t);delete a.user;const l=Lx(a);await Ho(this.storage,this.storageKey,l)}else{const a=Lx(t);await Ho(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Zt(this.storage,this.storageKey),await Zt(this.storage,this.storageKey+"-code-verifier"),await Zt(this.storage,this.storageKey+"-user"),this.userStorage&&await Zt(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&en()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),zo);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e);const t=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const t=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,t&&clearTimeout(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:i}}=t;if(!i||!i.refresh_token||!i.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((i.expires_at*1e3-e)/zo);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${zo}ms, refresh threshold is ${Lm} ticks`),a<=Lm&&await this._callRefreshToken(i.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof xS)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!en()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(e){this._debug("#visibilityChangedCallback","error",e)}},window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,i){const a=[`provider=${encodeURIComponent(t)}`];if(i!=null&&i.redirectTo&&a.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),i!=null&&i.scopes&&a.push(`scopes=${encodeURIComponent(i.scopes)}`),this.flowType==="pkce"){const[l,u]=await Oo(this.storage,this.storageKey),d=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(u)}`});a.push(d.toString())}if(i!=null&&i.queryParams){const l=new URLSearchParams(i.queryParams);a.push(l.toString())}return i!=null&&i.skipBrowserRedirect&&a.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var i;const{data:a,error:l}=t;return l?this._returnResult({data:null,error:l}):await Te(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(i=a==null?void 0:a.session)===null||i===void 0?void 0:i.access_token})})}catch(t){if(_e(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var i,a;const{data:l,error:u}=t;if(u)return this._returnResult({data:null,error:u});const d=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:g,error:m}=await Te(this.fetch,"POST",`${this.url}/factors`,{body:d,headers:this.headers,jwt:(i=l==null?void 0:l.session)===null||i===void 0?void 0:i.access_token});return m?this._returnResult({data:null,error:m}):(e.factorType==="totp"&&g.type==="totp"&&(!((a=g==null?void 0:g.totp)===null||a===void 0)&&a.qr_code)&&(g.totp.qr_code=`data:image/svg+xml;utf-8,${g.totp.qr_code}`),this._returnResult({data:g,error:null}))})}catch(t){if(_e(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var i;const{data:a,error:l}=t;if(l)return this._returnResult({data:null,error:l});const u=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?p3(e.webauthn.credential_response):g3(e.webauthn.credential_response)})}:{code:e.code}),{data:d,error:g}=await Te(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:u,headers:this.headers,jwt:(i=a==null?void 0:a.session)===null||i===void 0?void 0:i.access_token});return g?this._returnResult({data:null,error:g}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+d.expires_in},d)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",d),this._returnResult({data:d,error:g}))})}catch(t){if(_e(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var i;const{data:a,error:l}=t;if(l)return this._returnResult({data:null,error:l});const u=await Te(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(i=a==null?void 0:a.session)===null||i===void 0?void 0:i.access_token});if(u.error)return u;const{data:d}=u;if(d.type!=="webauthn")return{data:d,error:null};switch(d.webauthn.type){case"create":return{data:Object.assign(Object.assign({},d),{webauthn:Object.assign(Object.assign({},d.webauthn),{credential_options:Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:d3(d.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},d),{webauthn:Object.assign(Object.assign({},d.webauthn),{credential_options:Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:f3(d.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(_e(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:i}=await this._challenge({factorId:e.factorId});return i?this._returnResult({data:null,error:i}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:i}=await this.getUser();if(i)return{data:null,error:i};const a={all:[],phone:[],totp:[],webauthn:[]};for(const l of(e=t==null?void 0:t.factors)!==null&&e!==void 0?e:[])a.all.push(l),l.status==="verified"&&a[l.factor_type].push(l);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(e){var t,i,a,l;if(e)try{const{payload:S}=ad(e);let N=null;S.aal&&(N=S.aal);let M=N;const{data:{user:k},error:V}=await this.getUser(e);if(V)return this._returnResult({data:null,error:V});((i=(t=k==null?void 0:k.factors)===null||t===void 0?void 0:t.filter(D=>D.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(M="aal2");const $=S.amr||[];return{data:{currentLevel:N,nextLevel:M,currentAuthenticationMethods:$},error:null}}catch(S){if(_e(S))return this._returnResult({data:null,error:S});throw S}const{data:{session:u},error:d}=await this.getSession();if(d)return this._returnResult({data:null,error:d});if(!u)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:g}=ad(u.access_token);let m=null;g.aal&&(m=g.aal);let _=m;((l=(a=u.user.factors)===null||a===void 0?void 0:a.filter(S=>S.status==="verified"))!==null&&l!==void 0?l:[]).length>0&&(_="aal2");const T=g.amr||[];return{data:{currentLevel:m,nextLevel:_,currentAuthenticationMethods:T},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:i},error:a}=t;return a?this._returnResult({data:null,error:a}):i?await Te(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:i.access_token,xform:l=>({data:l,error:null})}):this._returnResult({data:null,error:new Pn})})}catch(t){if(_e(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async i=>{const{data:{session:a},error:l}=i;if(l)return this._returnResult({data:null,error:l});if(!a)return this._returnResult({data:null,error:new Pn});const u=await Te(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:d=>({data:d,error:null})});return u.data&&u.data.redirect_url&&en()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(u.data.redirect_url),u})}catch(i){if(_e(i))return this._returnResult({data:null,error:i});throw i}}async _denyAuthorization(e,t){try{return await this._useSession(async i=>{const{data:{session:a},error:l}=i;if(l)return this._returnResult({data:null,error:l});if(!a)return this._returnResult({data:null,error:new Pn});const u=await Te(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:d=>({data:d,error:null})});return u.data&&u.data.redirect_url&&en()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(u.data.redirect_url),u})}catch(i){if(_e(i))return this._returnResult({data:null,error:i});throw i}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:t},error:i}=e;return i?this._returnResult({data:null,error:i}):t?await Te(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new Pn})})}catch(e){if(_e(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{const{data:{session:i},error:a}=t;return a?this._returnResult({data:null,error:a}):i?(await Te(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:i.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Pn})})}catch(t){if(_e(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(e,t={keys:[]}){let i=t.keys.find(d=>d.kid===e);if(i)return i;const a=Date.now();if(i=this.jwks.keys.find(d=>d.kid===e),i&&this.jwks_cached_at+T6>a)return i;const{data:l,error:u}=await Te(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(u)throw u;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=a,i=l.keys.find(d=>d.kid===e),!i)?null:i}async getClaims(e,t={}){try{let i=e;if(!i){const{data:S,error:N}=await this.getSession();if(N||!S.session)return this._returnResult({data:null,error:N});i=S.session.access_token}const{header:a,payload:l,signature:u,raw:{header:d,payload:g}}=ad(i);t!=null&&t.allowExpired||F6(l.exp);const m=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,t!=null&&t.keys?{keys:t.keys}:t==null?void 0:t.jwks);if(!m){const{error:S}=await this.getUser(i);if(S)throw S;return{data:{claims:l,header:a,signature:u},error:null}}const _=G6(a.alg),w=await crypto.subtle.importKey("jwk",m,_,!0,["verify"]);if(!await crypto.subtle.verify(_,w,u,O6(`${d}.${g}`)))throw new Bm("Invalid JWT signature");return{data:{claims:l,header:a,signature:u},error:null}}catch(i){if(_e(i))return this._returnResult({data:null,error:i});throw i}}}nu.nextInstanceID={};const E3=nu,S3="2.93.2";let Rc="";typeof Deno<"u"?Rc="deno":typeof document<"u"?Rc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Rc="react-native":Rc="node";const A3={"X-Client-Info":`supabase-js-${Rc}/${S3}`},C3={headers:A3},N3={schema:"public"},R3={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},k3={};function su(n){"@babel/helpers - typeof";return su=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},su(n)}function I3(n,e){if(su(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(su(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function O3(n){var e=I3(n,"string");return su(e)=="symbol"?e:e+""}function j3(n,e,t){return(e=O3(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function qx(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,i)}return t}function yt(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?qx(Object(t),!0).forEach(function(i){j3(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):qx(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}const D3=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),P3=()=>Headers,M3=(n,e,t)=>{const i=D3(t),a=P3();return async(l,u)=>{var d;const g=(d=await e())!==null&&d!==void 0?d:n;let m=new a(u==null?void 0:u.headers);return m.has("apikey")||m.set("apikey",n),m.has("Authorization")||m.set("Authorization",`Bearer ${g}`),i(l,yt(yt({},u),{},{headers:m}))}};function L3(n){return n.endsWith("/")?n:n+"/"}function U3(n,e){var t,i;const{db:a,auth:l,realtime:u,global:d}=n,{db:g,auth:m,realtime:_,global:w}=e,T={db:yt(yt({},g),a),auth:yt(yt({},m),l),realtime:yt(yt({},_),u),storage:{},global:yt(yt(yt({},w),d),{},{headers:yt(yt({},(t=w==null?void 0:w.headers)!==null&&t!==void 0?t:{}),(i=d==null?void 0:d.headers)!==null&&i!==void 0?i:{})}),accessToken:async()=>""};return n.accessToken?T.accessToken=n.accessToken:delete T.accessToken,T}function V3(n){const e=n==null?void 0:n.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(L3(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var B3=class extends E3{constructor(n){super(n)}},z3=class{constructor(n,e,t){var i,a;this.supabaseUrl=n,this.supabaseKey=e;const l=V3(n);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const u=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:N3,realtime:k3,auth:yt(yt({},R3),{},{storageKey:u}),global:C3},g=U3(t??{},d);if(this.storageKey=(i=g.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(a=g.global.headers)!==null&&a!==void 0?a:{},g.accessToken)this.accessToken=g.accessToken,this.auth=new Proxy({},{get:(_,w)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(w)} is not possible`)}});else{var m;this.auth=this._initSupabaseAuthClient((m=g.auth)!==null&&m!==void 0?m:{},this.headers,g.global.fetch)}this.fetch=M3(e,this._getAccessToken.bind(this),g.global.fetch),this.realtime=this._initRealtimeClient(yt({headers:this.headers,accessToken:this._getAccessToken.bind(this)},g.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(_=>this.realtime.setAuth(_)).catch(_=>console.warn("Failed to set initial Realtime auth token:",_)),this.rest=new EM(new URL("rest/v1",l).href,{headers:this.headers,schema:g.db.schema,fetch:this.fetch}),this.storage=new v6(this.storageUrl.href,this.headers,this.fetch,t==null?void 0:t.storage),g.accessToken||this._listenForAuthEvents()}get functions(){return new _M(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(n){return this.rest.from(n)}schema(n){return this.rest.schema(n)}rpc(n,e={},t={head:!1,get:!1,count:void 0}){return this.rest.rpc(n,e,t)}channel(n,e={config:{}}){return this.realtime.channel(n,e)}getChannels(){return this.realtime.getChannels()}removeChannel(n){return this.realtime.removeChannel(n)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var n=this,e,t;if(n.accessToken)return await n.accessToken();const{data:i}=await n.auth.getSession();return(e=(t=i.session)===null||t===void 0?void 0:t.access_token)!==null&&e!==void 0?e:n.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:n,persistSession:e,detectSessionInUrl:t,storage:i,userStorage:a,storageKey:l,flowType:u,lock:d,debug:g,throwOnError:m},_,w){const T={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new B3({url:this.authUrl.href,headers:yt(yt({},T),_),storageKey:l,autoRefreshToken:n,persistSession:e,detectSessionInUrl:t,storage:i,userStorage:a,flowType:u,lock:d,debug:g,throwOnError:m,fetch:w,hasCustomAuthorizationHeader:Object.keys(this.headers).some(S=>S.toLowerCase()==="authorization")})}_initRealtimeClient(n){return new zM(this.realtimeUrl.href,yt(yt({},n),{},{params:yt(yt({},{apikey:this.supabaseKey}),n==null?void 0:n.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,e)=>{this._handleTokenChanged(n,"CLIENT",e==null?void 0:e.access_token)})}_handleTokenChanged(n,e,t){(n==="TOKEN_REFRESHED"||n==="SIGNED_IN")&&this.changedAccessToken!==t?(this.changedAccessToken=t,this.realtime.setAuth(t)):n==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const H3=(n,e,t)=>new z3(n,e,t);function $3(){if(typeof window<"u")return!1;const n=globalThis.process;if(!n)return!1;const e=n.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}$3()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const q3="https://prrldyvdefoyloqtrhfw.supabase.co",F3="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBycmxkeXZkZWZveWxvcXRyaGZ3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk1OTQ5NzUsImV4cCI6MjA4NTE3MDk3NX0.ANRkpfrxGKefAW3-2-WXfB7RRmQbTFIYd2VcW24OeWk",Gd=H3(q3,F3),SS=async(n,e="images")=>{try{const t=n.name.split(".").pop(),a=`${`${Date.now()}_${Math.random().toString(36).substring(2)}.${t}`}`,{data:l,error:u}=await Gd.storage.from(e).upload(a,n,{cacheControl:"3600",upsert:!1});if(u)throw u;const{data:d}=Gd.storage.from(e).getPublicUrl(a);return d.publicUrl}catch(t){throw console.error("Supabase Upload Error:",t),new Error(t.message||"Upload failed")}},G3=le.forwardRef(({value:n,onChange:e,className:t=""},i)=>{const a=le.useRef(null),l=le.useRef(null),u=le.useRef(null),[d,g]=le.useState(!1);le.useEffect(()=>{a.current&&a.current.innerHTML!==n&&(n===""&&a.current.innerHTML!==""?a.current.innerHTML="":a.current.innerHTML===""&&n&&(a.current.innerHTML=n))},[n]),le.useImperativeHandle(i,()=>({insertText:N=>{document.activeElement===a.current||_(),document.execCommand("insertText",!1,N),T()},insertHtml:N=>{document.activeElement===a.current||_(),document.execCommand("insertHTML",!1,N),T()}}));const m=()=>{const N=window.getSelection();N&&N.rangeCount>0&&a.current&&a.current.contains(N.anchorNode)&&(l.current=N.getRangeAt(0))},_=()=>{var M;const N=window.getSelection();if(N&&!(N.rangeCount>0&&a.current&&a.current.contains(N.anchorNode))){if(l.current&&((M=a.current)!=null&&M.contains(l.current.commonAncestorContainer)))N.removeAllRanges(),N.addRange(l.current);else if(a.current){a.current.focus();const k=document.createRange();k.selectNodeContents(a.current),k.collapse(!1),N.removeAllRanges(),N.addRange(k),l.current=k}}},w=(N,M=void 0)=>{document.activeElement!==a.current&&_(),document.execCommand(N,!1,M),T()},T=()=>{a.current&&e(a.current.innerHTML),m()},S=async N=>{if(N.target.files&&N.target.files[0]){const M=N.target.files[0];g(!0);try{m();const k=await SS(M,"images");_(),document.execCommand("insertHTML",!1,`<img src="${k}" style="max-width:100%; border-radius: 8px;" />`),T()}catch(k){alert("Upload fail: "+k.message)}finally{g(!1),u.current&&(u.current.value="")}}};return p.jsxs("div",{className:`border border-slate-700 rounded-lg overflow-hidden flex flex-col ${t}`,children:[p.jsxs("div",{className:"bg-slate-800 border-b border-slate-700 p-2 flex gap-1 flex-wrap items-center",children:[p.jsx("button",{onMouseDown:N=>{N.preventDefault(),w("bold")},className:"p-1 px-2 text-slate-300 hover:bg-white/10 rounded font-bold",type:"button",title:"Bold",children:"B"}),p.jsx("button",{onMouseDown:N=>{N.preventDefault(),w("italic")},className:"p-1 px-2 text-slate-300 hover:bg-white/10 rounded italic",type:"button",title:"Italic",children:"I"}),p.jsx("button",{onMouseDown:N=>{N.preventDefault(),w("underline")},className:"p-1 px-2 text-slate-300 hover:bg-white/10 rounded underline",type:"button",title:"Underline",children:"U"}),p.jsx("div",{className:"w-px h-6 bg-slate-600 mx-1 self-center"}),p.jsx("button",{onMouseDown:N=>{N.preventDefault(),w("justifyLeft")},className:"p-1 px-2 text-slate-300 hover:bg-white/10 rounded",type:"button",title:"Align Left",children:""}),p.jsx("button",{onMouseDown:N=>{N.preventDefault(),w("justifyCenter")},className:"p-1 px-2 text-slate-300 hover:bg-white/10 rounded",type:"button",title:"Align Center",children:""}),p.jsx("button",{onMouseDown:N=>{N.preventDefault(),w("justifyRight")},className:"p-1 px-2 text-slate-300 hover:bg-white/10 rounded",type:"button",title:"Align Right",children:""}),p.jsx("div",{className:"w-px h-6 bg-slate-600 mx-1 self-center"}),p.jsx("button",{onMouseDown:N=>{N.preventDefault();const M=prompt("Nhp ng dn URL:");M&&w("createLink",M)},className:"p-1 px-2 text-slate-300 hover:bg-white/10 rounded text-blue-400",type:"button",title:"Chn Link",children:"Link"}),p.jsx("button",{onMouseDown:N=>{var M;N.preventDefault(),(M=u.current)==null||M.click()},className:"p-1 px-2 text-slate-300 hover:bg-white/10 rounded text-emerald-400 flex items-center gap-1",type:"button",title:"Upload nh (Chn ngay)",children:d?"...":p.jsxs(p.Fragment,{children:["Img",p.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})})]})}),p.jsx("input",{type:"file",ref:u,onChange:S,className:"hidden",accept:"image/*"}),p.jsxs("select",{onChange:N=>w("formatBlock",N.target.value),className:"bg-slate-700 text-white text-xs rounded px-2 py-1 outline-none border border-slate-600 ml-2",children:[p.jsx("option",{value:"p",children:"Normal"}),p.jsx("option",{value:"h3",children:"Heading 1"}),p.jsx("option",{value:"h4",children:"Heading 2"}),p.jsx("option",{value:"blockquote",children:"Quote"})]})]}),p.jsx("div",{ref:a,contentEditable:!0,onInput:T,onBlur:m,onMouseUp:m,onKeyUp:m,className:"flex-grow bg-slate-900 text-white p-4 outline-none min-h-[150px] overflow-auto prose prose-invert prose-sm max-w-none"})]})}),K3=({currentImage:n,onImageUploaded:e,onClear:t})=>{const[i,a]=le.useState(n||null),[l,u]=le.useState(!1),[d,g]=le.useState(null),m=le.useRef(null),_=le.useRef(null);le.useEffect(()=>{a(n||null)},[n]),le.useEffect(()=>{const k=V=>{if(V.clipboardData&&V.clipboardData.items){const F=V.clipboardData.items;for(let $=0;$<F.length;$++)if(F[$].type.indexOf("image")!==-1){const D=F[$].getAsFile();D&&T(D);break}}};return window.addEventListener("paste",k),()=>window.removeEventListener("paste",k)},[]);const w=k=>k.type.startsWith("image/")?k.size>5*1024*1024?(g("Dung lng hnh nh phi di 5MB."),!1):!0:(g("Ch chp nhn file hnh nh (JPG, PNG, GIF, WEBP)."),!1),T=async k=>{if(g(null),!w(k))return;const V=URL.createObjectURL(k);a(V),u(!0);try{const F=await SS(k,"images");e(F),u(!1)}catch(F){console.error("Upload error:",F);let $="C li xy ra khi ti nh ln.";F.message&&($=F.message),g($),u(!1)}},S=k=>{k.target.files&&k.target.files[0]&&T(k.target.files[0])},N=k=>{k.preventDefault(),k.stopPropagation(),k.dataTransfer.files&&k.dataTransfer.files[0]&&T(k.dataTransfer.files[0])},M=k=>{k.preventDefault(),k.stopPropagation()};return p.jsxs("div",{className:"space-y-3",children:[p.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400",children:"Hnh nh i din (Ti a 5MB)"}),i?p.jsxs("div",{className:"relative group rounded-xl overflow-hidden border border-slate-700 bg-slate-900",children:[p.jsx("img",{src:i,alt:"Preview",className:"w-full h-48 object-cover opacity-80 group-hover:opacity-100 transition-opacity"}),p.jsxs("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-3",children:[p.jsx("button",{onClick:()=>{var k;return(k=m.current)==null?void 0:k.click()},className:"bg-indigo-600 hover:bg-indigo-700 text-white px-3 py-1.5 rounded text-xs font-bold",children:"Thay i"}),p.jsx("button",{onClick:()=>{a(null),t()},className:"bg-red-600 hover:bg-red-700 text-white px-3 py-1.5 rounded text-xs font-bold",children:"Xa"})]}),l&&p.jsxs("div",{className:"absolute inset-0 bg-black/70 flex flex-col items-center justify-center z-10",children:[p.jsx("div",{className:"w-12 h-12 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin mb-2"}),p.jsx("span",{className:"text-white text-xs font-bold mb-2",children:"ang ti ln Supabase..."})]})]}):p.jsxs("div",{ref:_,onDrop:N,onDragOver:M,className:"border-2 border-dashed border-slate-700 hover:border-indigo-500 bg-slate-800/50 hover:bg-slate-800 rounded-xl p-8 text-center cursor-pointer transition-all flex flex-col items-center justify-center gap-2 group",onClick:()=>{var k;return(k=m.current)==null?void 0:k.click()},tabIndex:0,children:[p.jsx("svg",{className:"w-8 h-8 text-slate-500 group-hover:text-indigo-400 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),p.jsxs("div",{children:[p.jsx("span",{className:"text-indigo-400 font-bold text-sm",children:"Upload File"}),p.jsx("span",{className:"text-slate-500 text-sm",children:" hoc ko th vo y"})]}),p.jsx("div",{className:"text-[10px] text-slate-500 uppercase font-bold tracking-widest mt-1",children:"H tr Paste (Ctrl+V)"})]}),d&&p.jsx("div",{className:"text-red-400 text-xs font-bold bg-red-400/10 p-2 rounded",children:d}),p.jsx("input",{type:"file",ref:m,onChange:S,accept:"image/*",className:"hidden"})]})},Y3=({news:n,formatDate:e,onImageClick:t})=>{const[i,a]=le.useState(!1),d=(m=>{const _=document.createElement("DIV");return _.innerHTML=m,_.textContent||_.innerText||""})(n.content).split(/\s+/).filter(m=>m.length>0),g=d.length>50;return p.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-shadow",children:[p.jsx("h3",{className:"text-xl font-bold text-indigo-700 mb-2",children:n.title}),p.jsxs("div",{className:"text-xs text-gray-400 mb-4",children:[e(n.date)," | Bi ",n.author]}),n.imageUrl&&p.jsx("div",{className:"mb-4 rounded-xl overflow-hidden cursor-zoom-in shadow-sm hover:shadow-md transition-all",children:p.jsx("img",{src:n.imageUrl,alt:n.title,className:"w-full h-auto object-cover hover:scale-105 transition-transform duration-500",onClick:m=>{m.stopPropagation(),t(n.imageUrl)}})}),p.jsx("div",{className:`prose prose-slate max-w-none ${!i&&g?"line-clamp-3":""}`,onClick:m=>{const _=m.target;_.tagName==="IMG"&&(m.stopPropagation(),t(_.src))},children:i||!g?p.jsx("div",{dangerouslySetInnerHTML:{__html:n.content},className:"[&_img]:cursor-zoom-in [&_img]:rounded-lg [&_img]:shadow-sm hover:[&_img]:shadow-md [&_img]:transition-all"}):p.jsx("div",{children:p.jsxs("p",{children:[d.slice(0,50).join(" "),"..."]})})}),g&&p.jsx("button",{onClick:()=>a(!i),className:"mt-3 text-sm font-bold text-indigo-600 hover:text-indigo-800 underline decoration-2 underline-offset-4",children:i?"Thu gn":"Xem thm"})]})},W3=({user:n,onNavigate:e})=>{var j;const[t,i]=le.useState({layout:"modern",news:[],welcomeTitle:"",welcomeMessage:"",statusTitle:"",statusMessage:""}),[a,l]=le.useState(!1),[u,d]=le.useState({}),[g,m]=le.useState(!1),_=le.useRef(null),[w,T]=le.useState(null),[S,N]=le.useState(null);le.useEffect(()=>{const H=localStorage.getItem("app_settings");if(H)i(JSON.parse(H));else{const Z=[{id:"1",title:"Cho mng n vi Quang Huy Studio",content:"<p>H thng <b>Multi-App Engine</b>  chnh thc vn hnh. Hy chn ng dng  bt u!</p>",date:Date.now(),author:"System"}];i({layout:"modern",news:Z,welcomeTitle:"Cho mng, {username}!",welcomeMessage:"H thng AI Studio cung cp cc cng c ti tn nht  t ng ha quy trnh sng to ni dung ca bn.",statusTitle:"Stable",statusMessage:"Tt c dch v API ang hot ng bnh thng.",zaloPhone:"0987654321",sidebarWidgets:[{id:"w1",type:"status",title:"Trng thi",order:0},{id:"w2",type:"shortcuts",title:"Li tt",order:1}]})}},[]),le.useEffect(()=>{a&&T(t)},[a,t]);const M=H=>{i(H),localStorage.setItem("app_settings",JSON.stringify(H))},k=()=>{w&&(M(w),alert(" lu cu hnh thnh cng!"))},V=(H,Z)=>{w&&T({...w,[H]:Z})},F=()=>{if(!u.title||!u.content)return;const H={id:u.id||crypto.randomUUID(),title:u.title,content:u.content,imageUrl:u.imageUrl,date:u.date||Date.now(),author:n.username};let Z=[...t.news];u.id?Z=Z.map(O=>O.id===u.id?H:O):Z=[H,...Z],M({...t,news:Z}),m(!1),d({})},$=H=>{if(confirm("Bn c chc mun xa tin tc ny?")){const Z=t.news.filter(O=>O.id!==H);M({...t,news:Z})}},D=H=>new Date(H).toLocaleDateString("vi-VN",{year:"numeric",month:"long",day:"numeric"}),q=H=>H?H.replace("{username}",n.username||"User"):"",J=(H,Z)=>{if(!w)return;const O=[...w.sidebarWidgets||[]];Z==="up"&&H>0?[O[H],O[H-1]]=[O[H-1],O[H]]:Z==="down"&&H<O.length-1&&([O[H],O[H+1]]=[O[H+1],O[H]]),V("sidebarWidgets",O)},R=()=>{var Z;if(!w)return;const H={id:crypto.randomUUID(),type:"custom",title:"Tiu  mi",content:"<p>Ni dung ty chnh...</p>",order:((Z=w.sidebarWidgets)==null?void 0:Z.length)||0};V("sidebarWidgets",[...w.sidebarWidgets||[],H])},A=H=>{var Z;if(w&&confirm("Xa widget ny?")){const O=((Z=w.sidebarWidgets)==null?void 0:Z.filter(se=>se.id!==H))||[];V("sidebarWidgets",O)}},I=(H,Z,O)=>{var de;if(!w)return;const se=((de=w.sidebarWidgets)==null?void 0:de.map(me=>me.id===H?{...me,[Z]:O}:me))||[];V("sidebarWidgets",se)},L=(H,Z)=>{const O=[...t.news];Z==="up"&&H>0?[O[H],O[H-1]]=[O[H-1],O[H]]:Z==="down"&&H<O.length-1&&([O[H],O[H+1]]=[O[H+1],O[H]]),M({...t,news:O})},U=()=>p.jsxs("div",{className:"flex flex-col h-full overflow-y-auto",children:[t.zaloPhone&&p.jsxs("a",{href:`https://zalo.me/${t.zaloPhone}`,target:"_blank",rel:"noreferrer",className:"fixed bottom-24 right-6 z-40 bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-full shadow-lg flex items-center gap-2 animate-bounce transition-transform hover:scale-110",title:"Chat Zalo",children:[p.jsx("svg",{className:"w-6 h-6",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M12 2C6.48 2 2 5.92 2 10.5c0 2.37 1.17 4.54 3.12 6.13-.15.86-.54 1.95-1.42 2.62-.23.18-.08.57.21.57 2.39 0 4.19-1.29 4.88-1.93.7.13 1.43.21 2.21.21 5.52 0 10-3.92 10-8.5S17.52 2 12 2zm0 15c-.71 0-1.39-.07-2.04-.2-.27-.05-.54.04-.73.23-.74.72-2.12 1.58-3.73 1.66.44-.8 1.05-2.22 1.05-2.22.06-.16.03-.35-.09-.48C4.94 14.54 4 12.63 4 10.5 4 7.02 7.7 4 12 4s8 3.02 8 6.5-3.7 6.5-8 6.5z"})}),p.jsx("span",{className:"font-bold text-xs",children:t.zaloPhone})]}),p.jsxs("div",{className:"relative py-24 px-6 md:px-12 text-center overflow-hidden",children:[p.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-900 via-[#0f172a] to-slate-900 z-0"}),p.jsx("div",{className:"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-20 z-0"}),p.jsxs("div",{className:"relative z-10 space-y-6 max-w-4xl mx-auto",children:[p.jsx("span",{className:"inline-block py-1 px-3 rounded-full bg-indigo-500/20 border border-indigo-400/30 text-indigo-300 text-xs font-bold uppercase tracking-widest animate-in fade-in slide-in-from-bottom-4",children:"H thng iu hnh AI tp trung"}),p.jsx("h1",{className:"text-5xl md:text-7xl font-black text-transparent bg-clip-text bg-gradient-to-r from-white via-indigo-200 to-indigo-400 leading-tight drop-shadow-2xl animate-in zoom-in-95 duration-700",children:t.welcomeTitle?q(t.welcomeTitle):"QUANG HUY AI STUDIO"}),p.jsx("p",{className:"text-lg md:text-xl text-slate-400 font-light max-w-2xl mx-auto leading-relaxed animate-in fade-in slide-in-from-bottom-6 delay-200",children:t.welcomeMessage||"Nn tng tch hp a cng c mnh m, gip bn ti u ha quy trnh sng to Video v Hnh nh Viral ch vi mt c click."}),p.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-4 pt-8 animate-in fade-in slide-in-from-bottom-8 delay-300",children:[p.jsxs("button",{onClick:()=>e("video-viral"),className:"group relative px-8 py-4 bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded-2xl shadow-xl shadow-indigo-600/20 transition-all hover:-translate-y-1 active:scale-95 overflow-hidden",children:[p.jsx("div",{className:"absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform duration-300 transform skew-y-12"}),"VIDEO VIRAL ENGINE"]}),p.jsx("button",{onClick:()=>e("image-script"),className:"px-8 py-4 bg-slate-800 hover:bg-slate-700 border border-slate-700 text-white font-bold rounded-2xl shadow-xl transition-all hover:-translate-y-1 active:scale-95",children:"VISUAL SCRIPT ENGINE"})]})]})]}),p.jsxs("div",{className:"max-w-5xl mx-auto w-full px-6 py-16 space-y-12",children:[p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsx("h2",{className:"text-2xl font-bold text-gray-800 border-l-4 border-indigo-600 pl-4 uppercase tracking-wider",children:"Tin Tc Mi Nht"}),p.jsx("div",{className:"h-px bg-gray-200 flex-grow"})]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[t.news.map(H=>p.jsxs("div",{className:"group bg-white rounded-2xl p-6 shadow-lg border border-gray-100 hover:shadow-2xl hover:border-indigo-100 transition-all",children:[p.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-400 mb-4 font-bold uppercase tracking-wider",children:[p.jsx("span",{children:D(H.date)}),p.jsx("span",{className:"text-indigo-500",children:H.author})]}),H.imageUrl&&p.jsx("div",{className:"mb-3 rounded-lg overflow-hidden h-40 w-full relative",children:p.jsx("img",{src:H.imageUrl,alt:H.title,className:"absolute inset-0 w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-500 cursor-zoom-in",onClick:()=>N(H.imageUrl)})}),p.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-3 group-hover:text-indigo-600 transition-colors line-clamp-2",children:H.title}),p.jsx("div",{className:"prose prose-sm text-gray-500 line-clamp-4 [&_img]:cursor-zoom-in",dangerouslySetInnerHTML:{__html:H.content},onClick:Z=>{const O=Z.target;O.tagName==="IMG"&&(Z.stopPropagation(),N(O.src))}}),p.jsxs("button",{className:"mt-6 text-sm font-bold text-indigo-600 hover:text-indigo-800 flex items-center gap-2 group/btn",children:["Xem chi tit",p.jsx("svg",{className:"w-4 h-4 group-hover/btn:translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 8l4 4m0 0l-4 4m4-4H3"})})]})]},H.id)),t.news.length===0&&p.jsx("p",{className:"text-gray-400 italic",children:"Cha c tin tc no."})]})]})]}),G=()=>{var H;return p.jsxs("div",{className:"h-full overflow-y-auto bg-gray-50",children:[t.zaloPhone&&p.jsxs("a",{href:`https://zalo.me/${t.zaloPhone}`,target:"_blank",rel:"noreferrer",className:"fixed bottom-24 right-6 z-40 bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-full shadow-lg flex items-center gap-2 animate-bounce transition-transform hover:scale-110",title:"Chat Zalo",children:[p.jsx("svg",{className:"w-6 h-6",viewBox:"0 0 24 24",fill:"currentColor",children:p.jsx("path",{d:"M12 2C6.48 2 2 5.92 2 10.5c0 2.37 1.17 4.54 3.12 6.13-.15.86-.54 1.95-1.42 2.62-.23.18-.08.57.21.57 2.39 0 4.19-1.29 4.88-1.93.7.13 1.43.21 2.21.21 5.52 0 10-3.92 10-8.5S17.52 2 12 2zm0 15c-.71 0-1.39-.07-2.04-.2-.27-.05-.54.04-.73.23-.74.72-2.12 1.58-3.73 1.66.44-.8 1.05-2.22 1.05-2.22.06-.16.03-.35-.09-.48C4.94 14.54 4 12.63 4 10.5 4 7.02 7.7 4 12 4s8 3.02 8 6.5-3.7 6.5-8 6.5z"})}),p.jsxs("span",{className:"font-bold text-sm",children:["H tr: ",t.zaloPhone]})]}),p.jsx("div",{className:"max-w-6xl mx-auto px-6 py-12",children:p.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-12",children:[p.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[p.jsxs("div",{className:"bg-white rounded-3xl p-10 shadow-xl border border-gray-100 relative overflow-hidden",children:[p.jsx("div",{className:"absolute top-0 right-0 p-8 w-64 opacity-10",children:p.jsx("svg",{fill:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5zm0 9l2.5-1.25L12 8.5l-2.5 1.25L12 11zm0 2.5l-5-2.5-5 2.5L12 22l10-8.5-5-2.5-5 2.5z"})})}),p.jsx("h1",{className:"text-4xl font-black text-gray-900 mb-6",children:q(t.welcomeTitle)||`Cho mng, ${n.username}!`}),p.jsx("p",{className:"text-lg text-gray-600 mb-8 leading-relaxed",children:t.welcomeMessage||"H thng AI Studio cung cp cc cng c ti tn nht  t ng ha quy trnh sng to ni dung ca bn."}),p.jsx("div",{className:"flex flex-wrap gap-4"})]}),p.jsxs("div",{className:"space-y-6",children:[p.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Cp nht h thng"}),t.news.map(Z=>p.jsx(Y3,{news:Z,formatDate:D,onImageClick:N},Z.id))]})]}),p.jsx("div",{className:"space-y-6",children:(H=t.sidebarWidgets)==null?void 0:H.map(Z=>p.jsxs("div",{className:`${Z.type==="status"?"bg-gradient-to-br from-indigo-500 to-purple-600 text-white":"bg-white text-gray-800 border-gray-100"} rounded-3xl p-8 shadow-xl border`,children:[p.jsx("h3",{className:"text-lg font-bold uppercase tracking-widest mb-4 opacity-80",children:Z.title}),Z.type==="status"&&p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"text-4xl font-black mb-4",children:t.statusTitle||"Stable"}),p.jsx("p",{className:"text-sm opacity-90",children:t.statusMessage||"Tt c dch v API ang hot ng bnh thng."})]}),Z.type==="shortcuts"&&p.jsxs("ul",{className:"space-y-3 text-sm text-gray-600",children:[p.jsxs("li",{className:"flex items-center gap-2 cursor-pointer hover:text-indigo-600",children:[p.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500"})," User Guide"]}),p.jsxs("li",{className:"flex items-center gap-2 cursor-pointer hover:text-indigo-600",children:[p.jsx("span",{className:"w-2 h-2 rounded-full bg-blue-500"})," API Docs"]}),p.jsxs("li",{className:"flex items-center gap-2 cursor-pointer hover:text-indigo-600",children:[p.jsx("span",{className:"w-2 h-2 rounded-full bg-orange-500"})," Support"]})]}),Z.type==="custom"&&Z.content&&p.jsx("div",{className:"prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:Z.content}})]},Z.id))})]})})]})};return p.jsxs("div",{className:"relative h-full w-full bg-slate-50",children:[t.layout==="modern"&&p.jsx(U,{}),t.layout==="classic"&&p.jsx(G,{}),t.layout==="news-focus"&&p.jsx(G,{})," ",n.role==="admin"&&p.jsx("div",{className:"fixed bottom-6 right-6 z-50",children:p.jsx("button",{onClick:()=>l(!0),className:"w-14 h-14 bg-red-600 hover:bg-red-700 text-white rounded-full shadow-2xl flex items-center justify-center transition-transform hover:scale-110 active:scale-95",title:"Qun tr trang ch",children:p.jsxs("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})})}),S&&p.jsx("div",{className:"fixed inset-0 z-[300] bg-black/95 backdrop-blur-md flex items-center justify-center p-4 md:p-10 animate-in fade-in duration-300",onClick:()=>N(null),children:p.jsxs("div",{className:"relative max-w-full max-h-full flex flex-col items-center",children:[p.jsx("img",{src:S,alt:"Full View",className:"max-w-full max-h-[85vh] object-contain rounded-lg shadow-2xl",onClick:H=>H.stopPropagation()}),p.jsxs("button",{onClick:()=>N(null),className:"mt-6 bg-white/10 hover:bg-white/20 text-white px-6 py-2 rounded-full backdrop-blur-md border border-white/20 font-bold transition-all hover:scale-105 active:scale-95 flex items-center gap-2",children:[p.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),"ng hnh nh"]})]})}),a&&p.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-[200] flex items-center justify-center p-6",children:p.jsxs("div",{className:"bg-[#1e293b] w-full max-w-4xl h-[90vh] rounded-2xl border border-white/10 shadow-2xl flex flex-col animate-in zoom-in-95",children:[p.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-white/10",children:[p.jsx("h2",{className:"text-xl font-bold text-white uppercase tracking-widest",children:"Cu hnh Trang Ch"}),p.jsx("button",{onClick:()=>l(!1),className:"text-slate-400 hover:text-white",children:p.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),p.jsxs("div",{className:"flex-grow flex overflow-hidden",children:[p.jsxs("div",{className:"w-1/3 bg-black/20 p-6 border-r border-white/5 space-y-8 overflow-y-auto flex flex-col",children:[p.jsxs("div",{className:"flex-grow space-y-8",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400 mb-3",children:"Chn B Cc (Layout)"}),p.jsxs("div",{className:"space-y-3",children:[p.jsxs("div",{onClick:()=>V("layout","modern"),className:`p-4 rounded-xl border-2 cursor-pointer transition-all ${(w==null?void 0:w.layout)==="modern"?"border-indigo-500 bg-indigo-500/10":"border-slate-700 hover:border-slate-500"}`,children:[p.jsx("div",{className:"font-bold text-white text-sm mb-1",children:"Modern Visual (Default)"}),p.jsx("div",{className:"text-xs text-slate-400",children:"Hero ln, nn ng, card trong sut."})]}),p.jsxs("div",{onClick:()=>V("layout","classic"),className:`p-4 rounded-xl border-2 cursor-pointer transition-all ${(w==null?void 0:w.layout)==="classic"?"border-indigo-500 bg-indigo-500/10":"border-slate-700 hover:border-slate-500"}`,children:[p.jsx("div",{className:"font-bold text-white text-sm mb-1",children:"Classic Dashboard"}),p.jsx("div",{className:"text-xs text-slate-400",children:"Gn gng, tp trung thng tin."})]})]})]}),p.jsx("hr",{className:"border-white/10"}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400 mb-3",children:"Thng tin Zalo (0 n)"}),p.jsx("input",{type:"text",value:(w==null?void 0:w.zaloPhone)||"",onChange:H=>V("zaloPhone",H.target.value),placeholder:"ST Zalo (V d: 0987654321)",className:"w-full bg-slate-800 border-slate-700 text-white p-2 rounded text-sm"})]}),p.jsx("hr",{className:"border-white/10"}),p.jsxs("div",{children:[p.jsxs("div",{className:"flex justify-between items-center mb-3",children:[p.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400",children:"Qun l Ct Bn Phi"}),p.jsx("button",{onClick:R,className:"text-xs bg-indigo-600 px-2 py-1 rounded text-white hover:bg-indigo-700",children:"+ Thm Ct"})]}),p.jsx("div",{className:"space-y-3",children:(j=w==null?void 0:w.sidebarWidgets)==null?void 0:j.map((H,Z)=>{var O;return p.jsxs("div",{className:"bg-slate-800 p-3 rounded-lg border border-slate-700",children:[p.jsxs("div",{className:"flex justify-between items-center mb-2",children:[p.jsxs("span",{className:"text-xs font-bold text-slate-300",children:["#",Z+1," - ",H.type==="custom"?"Ty chnh":H.title]}),p.jsxs("div",{className:"flex gap-1",children:[p.jsx("button",{onClick:()=>J(Z,"up"),disabled:Z===0,className:"p-1 text-slate-400 hover:text-white disabled:opacity-30",children:""}),p.jsx("button",{onClick:()=>J(Z,"down"),disabled:Z===(((O=w.sidebarWidgets)==null?void 0:O.length)||0)-1,className:"p-1 text-slate-400 hover:text-white disabled:opacity-30",children:""}),p.jsx("button",{onClick:()=>A(H.id),className:"p-1 text-red-400 hover:text-red-300",children:""})]})]}),p.jsx("input",{type:"text",value:H.title,onChange:se=>I(H.id,"title",se.target.value),className:"w-full bg-slate-900 border border-slate-700 text-white p-1 rounded text-xs mb-2",placeholder:"Tiu  widget..."}),H.type==="custom"&&p.jsx("textarea",{value:H.content||"",onChange:se=>I(H.id,"content",se.target.value),className:"w-full bg-slate-900 border border-slate-700 text-white p-1 rounded text-xs h-16",placeholder:"Ni dung HTML..."})]},H.id)})})]}),p.jsx("hr",{className:"border-white/10"}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400 mb-3",children:"Ni dung Cho mng"}),p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{children:[p.jsxs("label",{className:"text-xs text-slate-500 block mb-1",children:["Tiu  (dng ","{username}","  chn tn)"]}),p.jsx("input",{type:"text",value:(w==null?void 0:w.welcomeTitle)||"",onChange:H=>V("welcomeTitle",H.target.value),placeholder:"Cho mng, {username}!",className:"w-full bg-slate-800 border-slate-700 text-white p-2 rounded text-sm"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"text-xs text-slate-500 block mb-1",children:"M t"}),p.jsx("textarea",{value:(w==null?void 0:w.welcomeMessage)||"",onChange:H=>V("welcomeMessage",H.target.value),placeholder:"M t ngn...",className:"w-full bg-slate-800 border-slate-700 text-white p-2 rounded text-sm h-20"})]})]})]})]}),p.jsx("div",{className:"pt-6 border-t border-white/10",children:p.jsx("button",{onClick:k,className:"w-full py-3 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-xl shadow-lg transition-all",children:"Lu Cu Hnh"})})]}),p.jsxs("div",{className:"w-2/3 p-6 flex flex-col bg-[#0f172a]",children:[p.jsxs("div",{className:"flex justify-between items-center mb-6",children:[p.jsx("h3",{className:"font-bold text-white",children:"Qun l Tin Tc"}),p.jsx("button",{onClick:()=>{m(!0),d({})},className:"bg-indigo-600 hover:bg-indigo-700 text-white text-xs font-bold px-4 py-2 rounded-lg",children:"+ Thm Tin Mi"})]}),g?p.jsxs("div",{className:"flex-grow flex flex-col min-h-0",children:[p.jsxs("div",{className:"flex-grow overflow-y-auto pr-2 space-y-4",children:[p.jsx("input",{type:"text",placeholder:"Tiu  bi vit...",value:u.title||"",onChange:H=>d({...u,title:H.target.value}),className:"bg-slate-800 border-slate-700 text-white p-3 rounded-lg outline-none focus:border-indigo-500 w-full"}),p.jsx("div",{className:"flex flex-col min-h-[300px]",children:p.jsx(G3,{ref:_,value:u.content||"",onChange:H=>d({...u,content:H}),className:"flex-grow h-full"})}),p.jsxs("div",{className:"flex gap-2 flex-wrap pt-2 pb-2",children:[["","","","","","","","","","","","","","Ok",""].map(H=>p.jsx("button",{type:"button",onMouseDown:Z=>{var O;Z.preventDefault(),(O=_.current)==null||O.insertText(H)},className:"bg-slate-700 hover:bg-slate-600 text-white px-2 py-1 rounded text-sm transition-colors",title:"Chn vo ni dung",children:H},H)),p.jsx("span",{className:"text-[10px] text-slate-500 self-center ml-2 uppercase font-bold tracking-wider opacity-60",children:"Click  chn vo ni dung"})]}),p.jsx("div",{className:"pt-2",children:p.jsx(K3,{currentImage:u.imageUrl,onImageUploaded:H=>d({...u,imageUrl:H}),onClear:()=>d({...u,imageUrl:void 0})})})]}),p.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-700 mt-2 flex-shrink-0 bg-[#0f172a]",children:[p.jsx("button",{onClick:()=>m(!1),className:"px-4 py-2 text-slate-400 hover:text-white",children:"Hy"}),p.jsx("button",{onClick:F,className:"px-6 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-bold",children:"Lu Tin"})]})]}):p.jsx("div",{className:"flex-grow overflow-y-auto space-y-3 pr-2",children:t.news.map((H,Z)=>p.jsxs("div",{className:"bg-slate-800 p-4 rounded-xl border border-slate-700 flex justify-between items-start group",children:[p.jsxs("div",{children:[p.jsx("h4",{className:"font-bold text-white text-sm",children:H.title}),p.jsxs("div",{className:"text-[10px] text-slate-400 mt-1",children:[D(H.date)," - ",H.author]})]}),p.jsxs("div",{className:"flex gap-2",children:[p.jsxs("div",{className:"flex flex-col gap-1 mr-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[p.jsx("button",{onClick:()=>L(Z,"up"),disabled:Z===0,className:"text-slate-500 hover:text-white disabled:opacity-20",children:""}),p.jsx("button",{onClick:()=>L(Z,"down"),disabled:Z===t.news.length-1,className:"text-slate-500 hover:text-white disabled:opacity-20",children:""})]}),p.jsxs("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity items-center",children:[p.jsx("button",{onClick:()=>{d(H),m(!0)},className:"p-1 text-blue-400 hover:bg-blue-400/10 rounded",children:"Sa"}),p.jsx("button",{onClick:()=>$(H.id),className:"p-1 text-red-400 hover:bg-red-400/10 rounded",children:"Xa"})]})]})]},H.id))})]})]})]})})]})},Fx=[{id:"CHINESE",name:"Ting Trung",icon:""},{id:"JAPANESE",name:"Ting Nht",icon:""},{id:"KOREAN",name:"Ting Hn",icon:""}],Gx={CHINESE:{batchSize:50,delaySeconds:1,customPrompt:"Dch sang ting Vit phong cch kim hip, xng h huynh-, vn phong c trang, gi nguyn cc danh xng c th.",removeSourceText:!0,autoFixFormat:!0},JAPANESE:{batchSize:40,delaySeconds:1.5,customPrompt:"Dch sang ting Vit phong cch Anime/Manga, gi nguyn cc hu t nh -san, -kun, -sama nu cn thit, dch st ngha nhng t nhin.",removeSourceText:!0,autoFixFormat:!0},KOREAN:{batchSize:45,delaySeconds:1,customPrompt:"Dch sang ting Vit phong cch phim truyn hnh Hn Quc (K-Drama), xng h Oppa/Unnie/Noona ph hp ng cnh, vn phong gn gi.",removeSourceText:!0,autoFixFormat:!0}},Q3=n=>(n=n.replace(/\r\n/g,`
`),n.trim().split(/\n\s*\n/).map(t=>{const i=t.split(`
`);if(i.length<3)return{index:"",timecode:"",text:""};const a=i[0].trim(),l=i[1].trim(),u=i.slice(2).join(`
`).trim();return{index:a,timecode:l,text:u}}).filter(t=>t.index!=="")),J3=n=>n.map(e=>`${e.index}
${e.timecode}
${e.text}
`).join(`
`),X3=(n,e)=>{const t=new Uint8Array([239,187,191]),i=new Blob([t,e],{type:"text/srt;charset=utf-8"}),a=URL.createObjectURL(i),l=document.createElement("a");l.href=a,l.download=n.replace(/\.(srt|txt)$/i,"")+"_VIET.srt",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(a)},Z3=(n,e)=>{let t;switch(e){case"CHINESE":t=/[\u4e00-\u9fa5]/g;break;case"JAPANESE":t=/[\u3040-\u30ff\u4e00-\u9faf]/g;break;case"KOREAN":t=/[\uac00-\ud7af]/g;break;default:t=/$/}return n.replace(t,"").trim()},e5=n=>{const e=(n==null?void 0:n.message)||(n==null?void 0:n.toString())||"";throw e.includes("429")||e.includes("Quota")||e.includes("quota")||e.includes("Resource has been exhausted")?e.includes("quota")||e.includes("Exceeded")?new Error("Ht API key, bn hy nhp thm API key  tip tc cng vic"):new Error("Hy thao tc chm li v api key ca bn khng p ng  x l nhanh"):e.includes("Network")||e.includes("fetch")?new Error("Li kt ni mng. Vui lng kim tra ng truyn."):new Error(`Li h thng: ${e}`)};class t5{constructor(e){this.apiKeys=e}getModel(){if(this.apiKeys.length===0)throw new Error("No API Keys provided");const e=this.apiKeys[Math.floor(Math.random()*this.apiKeys.length)];return new Kd(e).getGenerativeModel({model:"gemini-flash-latest"})}async translateBatch(e,t,i,a){const l=`
Bn l mt chuyn gia dch thut phim nh cao cp t ${t==="CHINESE"?"Ting Trung":t==="JAPANESE"?"Ting Nht":"Ting Hn"} sang Ting Vit.
Nhim v: Dch ni dung cc ph  di y sang Ting Vit.

Yu cu c th:
1. ${i}
2. Gi nguyn nh dng ca tng mc (Index, Timecode).
3. CH tr v bn dch Ting Vit cho phn text ca ph . Khng c bao gm ngn ng gc.
4. KHNG gii thch, KHNG thm li dn.
5. m bo cu trc SRT chnh xc:
Index
Timecode
Ni dung dch

D liu u vo:
${e.map(u=>`${u.index}
${u.timecode}
${u.text}`).join(`

`)}
    `;try{const _=((await(await this.getModel().generateContent({contents:[{role:"user",parts:[{text:l}]}],generationConfig:{temperature:.3,topP:.8}})).response).text()||"").trim().split(/\n\s*\n/);return e.map((w,T)=>{const S=_[T];if(!S)return{...w,text:"[Li dch]"};const N=S.split(`
`),M=N.length>=3?N.slice(2).join(`
`).trim():N.join(`
`).trim();return{...w,text:M||w.text}})}catch(u){console.error("Translation error:",u),e5(u)}}}const Kx=({className:n="w-6 h-6",size:e=24})=>p.jsx("svg",{width:e,height:e,className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})}),n5=({className:n="w-6 h-6",size:e=24})=>p.jsx("svg",{width:e,height:e,className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),s5=({className:n="w-6 h-6",size:e=24})=>p.jsx("svg",{width:e,height:e,className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),xc=({className:n="w-6 h-6",size:e=24})=>p.jsx("svg",{width:e,height:e,className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),i5=({className:n="w-6 h-6",size:e=24})=>p.jsxs("svg",{width:e,height:e,className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]}),Yx=({className:n="w-6 h-6",size:e=24})=>p.jsx("svg",{width:e,height:e,className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),r5=({className:n="w-6 h-6",size:e=24})=>p.jsx("svg",{width:e,height:e,className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),a5=({className:n="w-6 h-6",size:e=24})=>p.jsx("svg",{width:e,height:e,className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),o5=({className:n="w-6 h-6",size:e=24})=>p.jsxs("svg",{width:e,height:e,className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),l5=({className:n="w-6 h-6",size:e=24})=>p.jsx("svg",{width:e,height:e,className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),em=({className:n="w-6 h-6",size:e=24})=>p.jsx("svg",{width:e,height:e,className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),c5=({className:n="w-6 h-6",size:e=24})=>p.jsx("svg",{width:e,height:e,className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),u5=({userId:n})=>{var $;const[e,t]=le.useState(null),[i,a]=le.useState(""),[l,u]=le.useState("CHINESE"),[d,g]=le.useState(!1),[m,_]=le.useState(Gx.CHINESE),[w,T]=le.useState({isProcessing:!1,progress:0,currentBatch:0,totalBatches:0}),[S,N]=le.useState(""),M=le.useRef(null);le.useEffect(()=>{const D=localStorage.getItem(`app_api_keys_${n}`);if(D)try{const q=JSON.parse(D),R=atob(q.gemini||"").split(`
`).map(A=>A.trim()).filter(A=>A!=="");R.length>0&&N(R[0])}catch(q){console.error("Failed to load keys",q)}},[n]);const k=D=>{var J;const q=(J=D.target.files)==null?void 0:J[0];if(q){t(q);const R=new FileReader;R.onload=A=>{var I;a(((I=A.target)==null?void 0:I.result)||"")},R.readAsText(q),T(A=>({...A,result:void 0,error:void 0}))}},V=()=>{e&&(g(!0),_(Gx[l]))},F=async()=>{if(!i)return;if(!S){T(I=>({...I,isProcessing:!1,error:"Cha c API Key. Vui lng cu hnh  trang ch."}));return}const D=Q3(i),q=m.batchSize,J=Math.ceil(D.length/q);T({isProcessing:!0,progress:0,currentBatch:0,totalBatches:J,error:void 0});const R=new t5([S]);let A=[];try{for(let L=0;L<J;L++){const U=L*q,G=Math.min(U+q,D.length),j=D.slice(U,G);T(O=>({...O,currentBatch:L+1,progress:Math.round(L/J*100)}));const Z=(await R.translateBatch(j,l,m.customPrompt,m.autoFixFormat)).map(O=>({...O,text:m.removeSourceText?Z3(O.text,l):O.text}));A=[...A,...Z],L<J-1&&await new Promise(O=>setTimeout(O,m.delaySeconds*1e3))}const I=J3(A);T(L=>({...L,isProcessing:!1,progress:100,result:I}))}catch(I){T(L=>({...L,isProcessing:!1,error:" xy ra li trong qu trnh dch: "+(I.message||"Unknown error")}))}};return S?p.jsx(sS,{children:p.jsxs("div",{className:"min-h-full p-4 md:p-8 flex flex-col items-center bg-transparent",children:[p.jsxs("header",{className:"w-full max-w-4xl text-center mb-12",children:[p.jsx("div",{className:"inline-flex items-center justify-center p-3 bg-indigo-600 rounded-2xl mb-4 text-white shadow-lg",children:p.jsx(Kx,{size:32})}),p.jsx("h1",{className:"text-4xl font-extrabold text-slate-900 mb-2",children:"Dch Thut Chuyn Gia"}),p.jsx("p",{className:"text-slate-500",children:"Nng tm bn dch ph  ca bn vi sc mnh ca AI"})]}),p.jsxs("main",{className:"w-full max-w-4xl bg-white rounded-3xl shadow-xl shadow-slate-200/50 border border-slate-100 overflow-hidden",children:[w.isProcessing&&p.jsx("div",{className:"h-1.5 w-full bg-slate-100 relative",children:p.jsx("div",{className:"absolute top-0 left-0 h-full bg-indigo-600 transition-all duration-500 ease-out",style:{width:`${w.progress}%`}})}),p.jsxs("div",{className:"p-8",children:[!d&&!w.isProcessing&&!w.result&&p.jsxs("div",{className:"space-y-8",children:[p.jsxs("section",{children:[p.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-3",children:"Ti ln file ngun (.srt, .txt)"}),p.jsxs("div",{onClick:()=>{var D;return(D=M.current)==null?void 0:D.click()},className:`border-2 border-dashed rounded-2xl p-10 flex flex-col items-center justify-center cursor-pointer transition-all ${e?"border-indigo-500 bg-indigo-50/30":"border-slate-200 hover:border-indigo-400 hover:bg-slate-50"}`,children:[p.jsx("input",{type:"file",ref:M,onChange:k,accept:".srt,.txt",className:"hidden"}),e?p.jsxs(p.Fragment,{children:[p.jsx(s5,{className:"text-indigo-600 mb-4 w-12 h-12",size:48}),p.jsx("p",{className:"text-indigo-900 font-medium",children:e.name}),p.jsxs("p",{className:"text-slate-500 text-sm mt-1",children:[(e.size/1024).toFixed(2)," KB"]})]}):p.jsxs(p.Fragment,{children:[p.jsx(n5,{className:"text-slate-400 mb-4 w-12 h-12",size:48}),p.jsx("p",{className:"text-slate-600 font-medium text-lg",children:"Ko th hoc nhp  chn file"}),p.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"Ch h tr nh dng .srt v .txt"})]})]})]}),e&&p.jsxs("section",{className:"animate-in fade-in slide-in-from-bottom-4 duration-500",children:[p.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-3",children:"Chn ngn ng ngun"}),p.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:Fx.map(D=>p.jsxs("button",{onClick:()=>u(D.id),className:`flex items-center gap-3 p-4 rounded-xl border-2 transition-all ${l===D.id?"border-indigo-600 bg-indigo-50 text-indigo-700":"border-slate-100 hover:border-slate-200"}`,children:[p.jsx("span",{className:"text-2xl",children:D.icon}),p.jsx("span",{className:"font-semibold",children:D.name}),l===D.id&&p.jsx(xc,{size:20,className:"ml-auto"})]},D.id))})]}),e&&p.jsxs("button",{onClick:V,className:"w-full py-4 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl font-bold text-lg shadow-lg shadow-indigo-200 transition-all flex items-center justify-center gap-2",children:[p.jsx(i5,{size:20}),"Bt u thit lp"]})]}),d&&!w.isProcessing&&!w.result&&p.jsxs("div",{className:"space-y-8 animate-in zoom-in-95 duration-300",children:[p.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[p.jsx("button",{onClick:()=>g(!1),className:"p-2 hover:bg-slate-100 rounded-lg text-slate-500",children:p.jsx(Yx,{size:20})}),p.jsxs("h2",{className:"text-xl font-bold text-slate-800",children:["Cu hnh chuyn gia cho ",($=Fx.find(D=>D.id===l))==null?void 0:$.name]})]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[p.jsxs("div",{className:"space-y-2",children:[p.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700",children:[p.jsx(r5,{size:16,className:"text-indigo-500"}),"S ph  mi gi (Batch Size)"]}),p.jsx("input",{type:"number",value:m.batchSize,onChange:D=>_({...m,batchSize:parseInt(D.target.value)||1}),className:"w-full p-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none transition-all"}),p.jsx("p",{className:"text-xs text-slate-400",children:"Gom nhiu dng gip AI hiu ng cnh tt hn v trnh b ngt qung."})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700",children:[p.jsx(a5,{size:16,className:"text-indigo-500"}),"Thi gian ngh (s)"]}),p.jsx("input",{type:"number",step:"0.5",value:m.delaySeconds,onChange:D=>_({...m,delaySeconds:parseFloat(D.target.value)||.1}),className:"w-full p-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none transition-all"}),p.jsx("p",{className:"text-xs text-slate-400",children:"Thi gian ch gia cc ln gi API  trnh b gii hn bng thng."})]})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700",children:[p.jsx(o5,{size:16,className:"text-indigo-500"}),"Kim sot cht lng dch (Prompt ty chnh)"]}),p.jsx("textarea",{rows:4,value:m.customPrompt,onChange:D=>_({...m,customPrompt:D.target.value}),className:"w-full p-4 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none transition-all resize-none",placeholder:"V d: Dch phong cch kim hip, xng h huynh-..."})]}),p.jsxs("div",{className:"bg-slate-50 p-6 rounded-2xl space-y-4",children:[p.jsx("h3",{className:"font-bold text-slate-800 text-sm uppercase tracking-wider",children:"Hu k chuyn su"}),p.jsxs("div",{className:"space-y-3",children:[p.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[p.jsxs("div",{className:"relative",children:[p.jsx("input",{type:"checkbox",checked:m.removeSourceText,onChange:D=>_({...m,removeSourceText:D.target.checked}),className:"sr-only peer"}),p.jsx("div",{className:"w-10 h-6 bg-slate-200 rounded-full peer peer-checked:bg-indigo-600 transition-all"}),p.jsx("div",{className:"absolute left-1 top-1 w-4 h-4 bg-white rounded-full peer-checked:translate-x-4 transition-all"})]}),p.jsxs("div",{className:"flex flex-col",children:[p.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Loi b k t tha (Regex)"}),p.jsx("span",{className:"text-xs text-slate-400",children:"T ng xa cc k t tng hnh cn st li sau khi dch."})]})]}),p.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[p.jsxs("div",{className:"relative",children:[p.jsx("input",{type:"checkbox",checked:m.autoFixFormat,onChange:D=>_({...m,autoFixFormat:D.target.checked}),className:"sr-only peer"}),p.jsx("div",{className:"w-10 h-6 bg-slate-200 rounded-full peer peer-checked:bg-indigo-600 transition-all"}),p.jsx("div",{className:"absolute left-1 top-1 w-4 h-4 bg-white rounded-full peer-checked:translate-x-4 transition-all"})]}),p.jsxs("div",{className:"flex flex-col",children:[p.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Kim tra & Sa cha nh dng SRT"}),p.jsx("span",{className:"text-xs text-slate-400",children:"m bo m thi gian v s th t chun xc 100%."})]})]})]})]}),p.jsxs("button",{onClick:F,className:"w-full py-4 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl font-bold text-lg shadow-lg shadow-indigo-200 transition-all flex items-center justify-center gap-2",children:[p.jsx(Kx,{size:20}),"Tin hnh dch ngay"]})]}),w.isProcessing&&p.jsxs("div",{className:"py-12 flex flex-col items-center justify-center space-y-6",children:[p.jsxs("div",{className:"relative",children:[p.jsx(c5,{size:64,className:"text-indigo-600 animate-spin w-16 h-16"}),p.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:p.jsxs("span",{className:"text-sm font-bold text-indigo-700",children:[w.progress,"%"]})})]}),p.jsxs("div",{className:"text-center",children:[p.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"ang x l d liu..."}),p.jsxs("p",{className:"text-slate-500 mt-1",children:["ang dch gi ",w.currentBatch," / ",w.totalBatches]}),p.jsxs("div",{className:"mt-6 p-4 bg-amber-50 rounded-xl border border-amber-100 flex items-center gap-3 text-amber-800 text-sm max-w-md",children:[p.jsx(em,{size:18}),"Vui lng khng ng trnh duyt cho n khi qu trnh hon tt."]})]})]}),w.result&&p.jsxs("div",{className:"py-8 flex flex-col items-center space-y-6 animate-in fade-in duration-500",children:[p.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center text-green-600 mb-2",children:p.jsx(xc,{size:40,className:"w-10 h-10"})}),p.jsxs("div",{className:"text-center",children:[p.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Dch thnh cng!"}),p.jsx("p",{className:"text-slate-500 mt-2",children:"File ca bn  c ti u ha v sn sng s dng."})]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 w-full max-w-lg",children:[p.jsxs("button",{onClick:()=>X3((e==null?void 0:e.name)||"translated.srt",w.result),className:"flex items-center justify-center gap-3 p-4 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl font-bold shadow-lg shadow-indigo-200 transition-all",children:[p.jsx(l5,{size:20}),"Ti file (.srt)"]}),p.jsxs("button",{onClick:()=>{t(null),T({isProcessing:!1,progress:0,currentBatch:0,totalBatches:0}),g(!1)},className:"flex items-center justify-center gap-3 p-4 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-bold transition-all",children:[p.jsx(Yx,{size:20}),"Dch file khc"]})]}),p.jsxs("div",{className:"w-full mt-6 space-y-2",children:[p.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest ml-1",children:"Xem trc ni dung"}),p.jsx("div",{className:"w-full h-48 bg-slate-950 rounded-2xl p-4 font-mono text-xs text-slate-300 overflow-y-auto border border-slate-800",children:p.jsxs("pre",{className:"whitespace-pre-wrap",children:[w.result.slice(0,1e3),"..."]})})]})]}),w.error&&p.jsxs("div",{className:"mt-8 p-6 bg-rose-50 border border-rose-100 rounded-2xl flex items-start gap-4 text-rose-800",children:[p.jsx(em,{size:24,className:"flex-shrink-0"}),p.jsxs("div",{children:[p.jsx("h4",{className:"font-bold",children:"Li x l"}),p.jsx("p",{className:"text-sm mt-1",children:w.error}),p.jsx("button",{onClick:()=>T(D=>({...D,error:void 0})),className:"mt-3 text-sm font-bold underline hover:no-underline",children:"Th li"})]})]})]})]}),p.jsxs("footer",{className:"mt-12 text-slate-400 text-sm flex flex-col items-center gap-4",children:[p.jsxs("div",{className:"flex items-center gap-6",children:[p.jsxs("span",{className:"flex items-center gap-1",children:[p.jsx(xc,{size:14})," UTF-8 with BOM"]}),p.jsxs("span",{className:"flex items-center gap-1",children:[p.jsx(xc,{size:14})," Ti u ng cnh"]}),p.jsxs("span",{className:"flex items-center gap-1",children:[p.jsx(xc,{size:14})," T ng sa li"]})]}),p.jsx("p",{children:" 2024 Dch Thut Chuyn Gia  Bn quyn thuc v AI Studio"})]})]})}):p.jsx("div",{className:"flex flex-col items-center justify-center p-10 h-full",children:p.jsxs("div",{className:"bg-red-50 text-red-600 p-6 rounded-xl border border-red-200 text-center shadow-sm",children:[p.jsx(em,{className:"w-12 h-12 mx-auto mb-2 text-red-500"}),p.jsx("h3",{className:"font-bold text-lg mb-2",children:"Cha cu hnh API Key"}),p.jsx("p",{children:"Vui lng nhp Gemini API Key  phn qun l Key pha trn trc khi s dng ng dng ny."})]})})},h5=()=>p.jsxs("div",{className:"w-full h-full min-h-[500px] flex flex-col items-center justify-center p-10 bg-white rounded-3xl shadow-xl border border-dashed border-slate-300",children:[p.jsx("div",{className:"w-20 h-20 bg-indigo-50 rounded-full flex items-center justify-center mb-6",children:p.jsx("svg",{className:"w-10 h-10 text-indigo-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),p.jsx("h2",{className:"text-2xl font-black text-slate-800 uppercase tracking-tighter mb-2",children:"New Application"}),p.jsxs("p",{className:"text-slate-500 text-center max-w-md",children:["This is a placeholder for your future application. ",p.jsx("br",{}),"You can start building your new features here within the ",p.jsx("code",{children:"apps/NewToolApp.tsx"})," file."]}),p.jsx("button",{className:"mt-8 px-6 py-3 bg-indigo-600 text-white font-bold rounded-xl hover:bg-indigo-700 transition-all",children:"Initialize Project"})]}),d5=[{id:"video-viral",label:"Video Viral"},{id:"image-script",label:"Visual Script"},{id:"zenshot-ai",label:"ZenShot AI"},{id:"translation",label:"Translation"},{id:"new-tool",label:"New Tool"}],f5=({onClose:n})=>{const[e,t]=le.useState({}),[i,a]=le.useState(""),l=async()=>{const m=await HD(AD(Xo,"users")),_={};m.forEach(w=>{const T=w.data();_[T.username]={id:T.id,username:T.username,email:T.email,phone:T.phone,role:T.role,allowedApps:T.allowedApps,createdAt:T.createdAt}}),t(_)};le.useEffect(()=>{l()},[]);const u=async(m,_)=>{const w=e[m];if(!w)return;let T=w.allowedApps?[...w.allowedApps]:[];T.includes(_)?T=T.filter(N=>N!==_):T.push(_),t(N=>({...N,[m]:{...N[m],allowedApps:T}}));const S=Lc(Xo,"users",w.id);await km(S,{allowedApps:T})},d=async m=>{const _=e[m];if(!_)return;const w=_.role==="admin"?"user":"admin";t(S=>({...S,[m]:{...S[m],role:w}}));const T=Lc(Xo,"users",_.id);await km(T,{role:w})},g=Object.values(e).filter(m=>m.username.toLowerCase().includes(i.toLowerCase())||m.email&&m.email.toLowerCase().includes(i.toLowerCase()));return p.jsx("div",{className:"fixed inset-0 bg-slate-900/90 backdrop-blur-md flex items-center justify-center z-[400] p-6",children:p.jsxs("div",{className:"bg-white w-full max-w-5xl rounded-3xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh] animate-in zoom-in-95 duration-300",children:[p.jsxs("div",{className:"bg-[#020617] text-white p-8 flex justify-between items-center shrink-0 gap-4",children:[p.jsxs("div",{className:"flex-1",children:[p.jsx("h2",{className:"text-2xl font-black uppercase tracking-tighter",children:"Admin Control Panel (v1.2)"}),p.jsx("p",{className:"text-xs text-indigo-400 font-bold uppercase tracking-[0.3em] mt-1",children:"User & Access Management"})]}),p.jsxs("button",{onClick:l,className:"bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg font-bold text-xs uppercase tracking-widest shadow-lg transition-all flex items-center gap-2",children:[p.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Force Refresh"]}),p.jsx("button",{onClick:n,className:"bg-white/10 hover:bg-white/20 p-3 rounded-xl transition-all",children:p.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),p.jsx("div",{className:"p-6 border-b border-slate-100 bg-slate-50 flex items-center gap-4 shrink-0 justify-between",children:p.jsx("div",{className:"flex items-center gap-4 flex-1",children:p.jsxs("div",{className:"relative flex-1 max-w-md",children:[p.jsx("svg",{className:"w-5 h-5 absolute left-4 top-1/2 -translate-y-1/2 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),p.jsx("input",{type:"text",placeholder:"Search users...",className:"w-full pl-12 pr-4 py-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-indigo-500 outline-none font-medium",value:i,onChange:m=>a(m.target.value)})]})})}),p.jsx("div",{className:"overflow-y-auto flex-1 p-6 bg-slate-100",children:p.jsx("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden",children:p.jsxs("table",{className:"w-full text-left border-collapse",children:[p.jsx("thead",{children:p.jsxs("tr",{className:"bg-slate-50 border-b border-slate-200 text-xs font-black text-slate-500 uppercase tracking-wider",children:[p.jsx("th",{className:"p-4 pl-6",children:"User Identity"}),p.jsx("th",{className:"p-4",children:"Role"}),p.jsx("th",{className:"p-4 text-center",children:"Video Viral"}),p.jsx("th",{className:"p-4 text-center",children:"Visual Script"}),p.jsx("th",{className:"p-4 text-center",children:"ZenShot New"}),p.jsx("th",{className:"p-4 text-center",children:"Translation"}),p.jsx("th",{className:"p-4 text-center",children:"New App"})]})}),p.jsx("tbody",{className:"divide-y divide-slate-100",children:g.map(m=>p.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[p.jsxs("td",{className:"p-4 pl-6",children:[p.jsx("div",{className:"font-bold text-slate-800",children:m.username}),p.jsx("div",{className:"text-xs text-slate-400 font-medium",children:m.email||"No email"})]}),p.jsx("td",{className:"p-4",children:p.jsx("button",{onClick:()=>d(m.username),className:`px-3 py-1 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all ${m.role==="admin"?"bg-indigo-100 text-indigo-700 hover:bg-indigo-200":"bg-slate-100 text-slate-500 hover:bg-slate-200"}`,children:m.role})}),d5.map(_=>{var T;const w=(T=m.allowedApps)==null?void 0:T.includes(_.id);return p.jsx("td",{className:"p-4 text-center",children:p.jsxs("label",{className:"inline-flex items-center cursor-pointer relative",children:[p.jsx("input",{type:"checkbox",className:"peer sr-only",checked:w,onChange:()=>u(m.username,_.id)}),p.jsx("div",{className:"w-11 h-6 bg-slate-200 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-emerald-500"})]})},_.id)})]},m.id))})]})})}),p.jsxs("div",{className:"p-4 bg-black text-xs font-mono text-green-400 overflow-auto h-32 border-t border-slate-700 shrink-0",children:[p.jsx("p",{className:"font-bold text-white mb-2",children:"DEBUG RAW DATA (Search here for username):"}),p.jsx("pre",{className:"whitespace-pre-wrap",children:JSON.stringify(e,null,2)})]})]})})},AS={async getAppNames(){try{const{data:n,error:e}=await Gd.from("app_config").select("*").eq("id","global_names").single();return n&&n.names?n.names:{}}catch(n){return console.warn("App Config Fetch Error (Ignorable if table missing):",n),{}}},async saveAppConfig(n){try{await Gd.from("app_config").upsert({id:"global_names",names:n})}catch(e){throw console.error("Error saving app config:",e),e}}},tm={"video-viral":"Video Viral Engine","image-script":"Visual Script Engine","zenshot-ai":"ZenShot AI (New)",translation:"Translation AI","new-tool":"New Application"},p5=({currentNames:n,onClose:e,onUpdate:t})=>{const[i,a]=le.useState(n),[l,u]=le.useState(!1);le.useEffect(()=>{a({...tm,...n})},[n]);const d=(m,_)=>{a(w=>({...w,[m]:_}))},g=async()=>{u(!0);try{await AS.saveAppConfig(i),t(),e()}catch(m){console.error("Failed to save app names",m),alert("Failed to save changes. Please try again.")}finally{u(!1)}};return p.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[200]",children:p.jsxs("div",{className:"bg-slate-900 rounded-3xl border border-indigo-500/20 shadow-2xl w-full max-w-lg overflow-hidden",children:[p.jsxs("div",{className:"p-6 border-b border-indigo-500/10 bg-indigo-500/5",children:[p.jsxs("h2",{className:"text-xl font-black text-white uppercase tracking-wider flex items-center gap-3",children:[p.jsx("span",{className:"p-2 bg-indigo-500/10 rounded-lg text-indigo-400",children:p.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),"Manage App Names"]}),p.jsx("p",{className:"text-slate-400 text-xs mt-2 ml-14",children:"Customize how application names appear in the navigation bar."})]}),p.jsx("div",{className:"p-6 max-h-[60vh] overflow-y-auto space-y-4 custom-scrollbar",children:Object.keys(tm).map(m=>p.jsxs("div",{className:"group",children:[p.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2 group-hover:text-indigo-400 transition-colors",children:m.replace("-"," ")}),p.jsx("input",{type:"text",value:i[m]||"",onChange:_=>d(m,_.target.value),className:"w-full bg-slate-800/50 border border-slate-700 rounded-xl px-4 py-3 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-500 outline-none transition-all placeholder:text-slate-600",placeholder:tm[m]})]},m))}),p.jsxs("div",{className:"p-6 border-t border-indigo-500/10 bg-slate-800/20 flex justify-end gap-3",children:[p.jsx("button",{onClick:e,className:"px-5 py-2.5 rounded-xl text-slate-400 font-bold text-xs uppercase tracking-wider hover:text-white hover:bg-white/5 transition-all",children:"Cancel"}),p.jsx("button",{onClick:g,disabled:l,className:"px-6 py-2.5 rounded-xl bg-indigo-600 text-white font-bold text-xs uppercase tracking-wider hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg shadow-indigo-500/20 transition-all flex items-center gap-2",children:l?p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"w-3 h-3 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Saving..."]}):"Save Changes"})]})]})})},g5=({user:n,onUpdateUser:e,onClose:t,appNames:i={},onUpdateAppNames:a=()=>{}})=>{const[l,u]=le.useState(n.email||""),[d,g]=le.useState(n.phone||""),[m,_]=le.useState(""),[w,T]=le.useState(""),[S,N]=le.useState(!1),[M,k]=le.useState(!1),V=async()=>{try{await Ta.updateProfile(n.id,{email:l,phone:d}),e({...n,email:l,phone:d}),T("Cp nht thnh cng!"),setTimeout(()=>T(""),3e3)}catch(F){console.error(F),T("Li khi cp nht!")}};return S?p.jsx(f5,{onClose:()=>N(!1)}):M?p.jsx(p5,{currentNames:i,onClose:()=>k(!1),onUpdate:a}):p.jsx("div",{className:"fixed inset-0 bg-slate-900/80 backdrop-blur-sm flex items-center justify-center z-[300] p-4",children:p.jsxs("div",{className:"bg-[#1e293b] w-full max-w-lg rounded-2xl border border-white/10 shadow-2xl p-6 md:p-8 animate-in zoom-in-95 duration-200",children:[p.jsxs("div",{className:"flex justify-between items-center mb-6 border-b border-white/5 pb-4",children:[p.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[p.jsx("svg",{className:"w-5 h-5 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Qun l ti khon"]}),p.jsx("button",{onClick:t,className:"text-slate-400 hover:text-white transition-colors",children:p.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-xl border border-white/5 flex items-center justify-between",children:[p.jsxs("div",{children:[p.jsx("p",{className:"text-[10px] text-slate-400 uppercase font-bold tracking-widest",children:"Tn ng nhp"}),p.jsx("p",{className:"text-lg font-bold text-white",children:n.username})]}),p.jsxs("div",{className:"text-right",children:[p.jsx("p",{className:"text-[10px] text-slate-400 uppercase font-bold tracking-widest",children:"Vai tr"}),p.jsx("span",{className:`inline-block px-2 py-1 rounded text-xs font-bold uppercase ${n.role==="admin"?"bg-indigo-500/20 text-indigo-400":"bg-slate-700 text-slate-300"}`,children:n.role})]})]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400 mb-2",children:"Email"}),p.jsx("input",{type:"email",value:l,onChange:F=>u(F.target.value),className:"w-full bg-[#0f172a] border border-slate-700 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 outline-none text-sm"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400 mb-2",children:"S in thoi"}),p.jsx("input",{type:"tel",value:d,onChange:F=>g(F.target.value),className:"w-full bg-[#0f172a] border border-slate-700 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 outline-none text-sm"})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400 mb-2",children:"i mt khu mi (Nu cn)"}),p.jsx("input",{type:"password",value:m,onChange:F=>_(F.target.value),placeholder:" trng nu khng i",className:"w-full bg-[#0f172a] border border-slate-700 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 outline-none text-sm placeholder-slate-600"})]}),w&&p.jsx("div",{className:"p-3 bg-emerald-500/10 text-emerald-400 text-sm font-bold rounded-lg text-center animate-in fade-in slide-in-from-top-2",children:w}),p.jsxs("div",{className:"pt-4 border-t border-white/5 flex justify-between gap-3 items-center",children:[n.role==="admin"?p.jsxs("div",{className:"flex gap-2",children:[p.jsxs("button",{onClick:()=>N(!0),className:"px-4 py-2 rounded-lg text-sm font-bold bg-amber-500/10 text-amber-500 hover:bg-amber-500/20 transition-all uppercase tracking-wider flex items-center gap-2",children:[p.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})}),"Admin Panel"]}),p.jsxs("button",{onClick:()=>k(!0),className:"px-4 py-2 rounded-lg text-sm font-bold bg-indigo-500/10 text-indigo-400 hover:bg-indigo-500/20 transition-all uppercase tracking-wider flex items-center gap-2",children:[p.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Manage App Names"]})]}):p.jsx("div",{}),p.jsxs("div",{className:"flex gap-3",children:[p.jsx("button",{onClick:t,className:"px-4 py-2 rounded-lg text-sm font-bold text-slate-400 hover:text-white hover:bg-white/5 transition-all",children:"ng"}),p.jsx("button",{onClick:V,className:"px-6 py-2 rounded-lg text-sm font-bold bg-indigo-600 text-white hover:bg-indigo-500 transition-all shadow-lg active:scale-95",children:"Lu Thay i"})]})]})]})]})})},m5=()=>{var k,V,F,$,D;const[n,e]=le.useState(null),[t,i]=le.useState("home"),[a,l]=le.useState(!1),[u,d]=le.useState(!0),[g,m]=le.useState({}),_=async()=>{const q=await AS.getAppNames();m(q)};le.useEffect(()=>{_()},[]),le.useEffect(()=>{const q=lI(vd,async J=>{var R;try{if(J){const A=await Ta.getUserProfile(J.uid);e(A||{id:J.uid,username:J.displayName||((R=J.email)==null?void 0:R.split("@")[0])||"User",email:J.email||"",role:"user",createdAt:Date.now()})}else e(null)}catch(A){console.error("Firebase Auth State Error:",A),e(null)}finally{d(!1)}});return()=>q()},[]);const w=q=>{e(q)},T=q=>{e(q)},S=async()=>{d(!0),await Ta.logoutUser()},[N,M]=le.useState(!1);return le.useEffect(()=>{const q=setTimeout(()=>{u&&(console.warn(" Initialization timed out - Showing Emergency UI"),M(!0),d(!1))},8e3);return()=>clearTimeout(q)},[u]),u?p.jsxs("div",{className:"min-h-screen bg-[#020617] flex items-center justify-center flex-col gap-4",children:[p.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-500"}),p.jsx("p",{className:"text-slate-400 text-xs animate-pulse",children:"Loading App Engine..."})]}):N?p.jsx("div",{className:"min-h-screen bg-[#0f172a] flex items-center justify-center p-6",children:p.jsxs("div",{className:"max-w-md w-full bg-[#1e293b] rounded-2xl p-8 border border-red-500/30 shadow-2xl",children:[p.jsx("h2",{className:"text-2xl font-bold text-red-500 mb-4",children:" Connection Timeout"}),p.jsx("p",{className:"text-slate-300 mb-6",children:"The application is taking too long to load. This might be due to a poor network connection or a paused Supabase project."}),p.jsxs("div",{className:"space-y-4",children:[p.jsx("button",{onClick:()=>window.location.reload(),className:"w-full py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-bold transition-all",children:"Reload Application"}),p.jsx("button",{onClick:()=>{window.confirm("Clear all local data and logout?")&&(localStorage.clear(),sessionStorage.clear(),window.location.reload())},className:"w-full py-3 bg-[#0f172a] border border-slate-600 hover:border-red-500 text-slate-400 hover:text-red-400 rounded-lg font-bold transition-all",children:"Factory Reset (Clear Cache)"}),p.jsx("button",{onClick:()=>{Ta.logoutUser().then(()=>window.location.reload())},className:"w-full py-3 bg-[#0f172a] border border-slate-600 hover:border-white text-white rounded-lg font-bold transition-all",children:"Force Logout"})]}),p.jsx("div",{className:"mt-8 text-center",children:p.jsxs("span",{className:"text-[10px] text-slate-600 font-mono",children:["DEBUG: v2.1-EMERGENCY | ",new Date().toLocaleTimeString()]})})]})}):n?p.jsxs("div",{className:"min-h-screen bg-slate-50 flex flex-col items-center",children:[p.jsx(Z2,{userId:n.id}),p.jsxs("nav",{className:"w-full bg-[#020617] text-white border-b border-white/5 sticky top-0 z-[100] px-6 md:px-12 py-4 backdrop-blur-2xl bg-opacity-95 shadow-2xl flex flex-col md:flex-row items-center justify-between gap-4",children:[p.jsxs("div",{className:"flex items-center gap-6 cursor-pointer",onClick:()=>i("home"),children:[p.jsx("div",{className:"bg-gradient-to-tr from-indigo-500 via-indigo-600 to-violet-600 p-3 rounded-2xl shadow-2xl shadow-indigo-500/30 ring-4 ring-indigo-500/10",children:p.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),p.jsxs("div",{className:"flex flex-col",children:[p.jsxs("h1",{className:"text-2xl font-black tracking-tighter uppercase leading-none",children:["QUANG HUY ",p.jsx("span",{className:"text-indigo-400",children:"STUDIO"})]}),p.jsx("span",{className:"text-[10px] font-black text-indigo-400/70 uppercase tracking-[0.4em] mt-1",children:"Multi-App Engine"})]})]}),p.jsxs("div",{className:"flex items-center bg-white/5 rounded-2xl p-1 border border-white/10",children:[(n.role==="admin"||((k=n.allowedApps)==null?void 0:k.includes("video-viral")))&&p.jsx("button",{onClick:()=>i("video-viral"),className:`px-6 py-2 rounded-xl text-xs font-black uppercase tracking-widest transition-all ${t==="video-viral"?"bg-indigo-600 text-white shadow-lg":"text-slate-400 hover:text-white hover:bg-white/5"}`,children:g["video-viral"]||"Video Viral Engine"}),(n.role==="admin"||((V=n.allowedApps)==null?void 0:V.includes("image-script")))&&p.jsx("button",{onClick:()=>i("image-script"),className:`px-6 py-2 rounded-xl text-xs font-black uppercase tracking-widest transition-all ${t==="image-script"?"bg-indigo-600 text-white shadow-lg":"text-slate-400 hover:text-white hover:bg-white/5"}`,children:g["image-script"]||"Visual Script Engine"}),(n.role==="admin"||((F=n.allowedApps)==null?void 0:F.includes("zenshot-ai")))&&p.jsx("button",{onClick:()=>i("zenshot-ai"),className:`px-6 py-2 rounded-xl text-xs font-black uppercase tracking-widest transition-all ${t==="zenshot-ai"?"bg-indigo-600 text-white shadow-lg":"text-slate-400 hover:text-white hover:bg-white/5"}`,children:g["zenshot-ai"]||"ZenShot AI (New)"}),(n.role==="admin"||(($=n.allowedApps)==null?void 0:$.includes("translation")))&&p.jsx("button",{onClick:()=>i("translation"),className:`px-6 py-2 rounded-xl text-xs font-black uppercase tracking-widest transition-all ${t==="translation"?"bg-indigo-600 text-white shadow-lg":"text-slate-400 hover:text-white hover:bg-white/5"}`,children:g.translation||"Translation AI"}),(n.role==="admin"||((D=n.allowedApps)==null?void 0:D.includes("new-tool")))&&p.jsx("button",{onClick:()=>i("new-tool"),className:`px-6 py-2 rounded-xl text-xs font-black uppercase tracking-widest transition-all ${t==="new-tool"?"bg-indigo-600 text-white shadow-lg":"text-slate-400 hover:text-white hover:bg-white/5"}`,children:g["new-tool"]||"New Application"})]}),p.jsxs("div",{className:"flex items-center gap-6",children:[p.jsxs("div",{className:"text-right hidden md:block",children:[p.jsxs("div",{className:"text-xs font-black uppercase text-indigo-400",children:["Hello, ",n.username]}),p.jsx("button",{onClick:S,className:"text-[10px] uppercase font-bold text-slate-500 hover:text-white transition-colors",children:"Logout"})]}),p.jsx("div",{className:"w-10 h-10 bg-indigo-600 rounded-full flex items-center justify-center font-black text-sm shadow-lg ring-2 ring-indigo-400/20 cursor-pointer hover:ring-indigo-400 hover:scale-105 transition-all",onClick:()=>l(!0),children:n.username.charAt(0).toUpperCase()})]})]}),p.jsxs("div",{className:"w-full h-[calc(100vh-140px)]",children:[t==="home"&&p.jsx(W3,{user:n,onNavigate:i},n.id),t==="video-viral"&&p.jsx(TP,{userId:n.id},n.id),t==="image-script"&&p.jsx(DP,{userId:n.id},n.id),t==="zenshot-ai"&&p.jsx(pM,{userId:n.id},n.id),t==="translation"&&p.jsx(u5,{userId:n.id},n.id),t==="new-tool"&&p.jsx(h5,{},n.id)]}),a&&p.jsx(g5,{user:n,onUpdateUser:T,onClose:()=>l(!1),appNames:g,onUpdateAppNames:_})]}):p.jsx(wP,{onLogin:w})},CS=document.getElementById("root");if(!CS)throw new Error("Could not find root element to mount to");const y5=p2.createRoot(CS);y5.render(p.jsx(Bc.StrictMode,{children:p.jsx(m5,{})}));
