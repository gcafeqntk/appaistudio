(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();function fT(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Ap={exports:{}},Tc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mb;function x2(){if(mb)return Tc;mb=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,a,l){var c=null;if(l!==void 0&&(c=""+l),a.key!==void 0&&(c=""+a.key),"key"in a){l={};for(var d in a)d!=="key"&&(l[d]=a[d])}else l=a;return a=l.ref,{$$typeof:n,type:i,key:c,ref:a!==void 0?a:null,props:l}}return Tc.Fragment=e,Tc.jsx=t,Tc.jsxs=t,Tc}var yb;function T2(){return yb||(yb=1,Ap.exports=x2()),Ap.exports}var f=T2(),Np={exports:{}},je={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vb;function E2(){if(vb)return je;vb=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),b=Symbol.for("react.activity"),x=Symbol.iterator;function S(V){return V===null||typeof V!="object"?null:(V=x&&V[x]||V["@@iterator"],typeof V=="function"?V:null)}var N={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},j=Object.assign,k={};function L(V,te,de){this.props=V,this.context=te,this.refs=k,this.updater=de||N}L.prototype.isReactComponent={},L.prototype.setState=function(V,te){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,te,"setState")},L.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function H(){}H.prototype=L.prototype;function B(V,te,de){this.props=V,this.context=te,this.refs=k,this.updater=de||N}var K=B.prototype=new H;K.constructor=B,j(K,L.prototype),K.isPureReactComponent=!0;var F=Array.isArray;function $(){}var A={H:null,A:null,T:null,S:null},C=Object.prototype.hasOwnProperty;function I(V,te,de){var ge=de.ref;return{$$typeof:n,type:V,key:te,ref:ge!==void 0?ge:null,props:de}}function D(V,te){return I(V.type,te,V.props)}function M(V){return typeof V=="object"&&V!==null&&V.$$typeof===n}function q(V){var te={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(de){return te[de]})}var O=/\/+/g;function ce(V,te){return typeof V=="object"&&V!==null&&V.key!=null?q(""+V.key):te.toString(36)}function ue(V){switch(V.status){case"fulfilled":return V.value;case"rejected":throw V.reason;default:switch(typeof V.status=="string"?V.then($,$):(V.status="pending",V.then(function(te){V.status==="pending"&&(V.status="fulfilled",V.value=te)},function(te){V.status==="pending"&&(V.status="rejected",V.reason=te)})),V.status){case"fulfilled":return V.value;case"rejected":throw V.reason}}throw V}function U(V,te,de,ge,Se){var ke=typeof V;(ke==="undefined"||ke==="boolean")&&(V=null);var Le=!1;if(V===null)Le=!0;else switch(ke){case"bigint":case"string":case"number":Le=!0;break;case"object":switch(V.$$typeof){case n:case e:Le=!0;break;case _:return Le=V._init,U(Le(V._payload),te,de,ge,Se)}}if(Le)return Se=Se(V),Le=ge===""?"."+ce(V,0):ge,F(Se)?(de="",Le!=null&&(de=Le.replace(O,"$&/")+"/"),U(Se,te,de,"",function(ye){return ye})):Se!=null&&(M(Se)&&(Se=D(Se,de+(Se.key==null||V&&V.key===Se.key?"":(""+Se.key).replace(O,"$&/")+"/")+Le)),te.push(Se)),1;Le=0;var ee=ge===""?".":ge+":";if(F(V))for(var he=0;he<V.length;he++)ge=V[he],ke=ee+ce(ge,he),Le+=U(ge,te,de,ke,Se);else if(he=S(V),typeof he=="function")for(V=he.call(V),he=0;!(ge=V.next()).done;)ge=ge.value,ke=ee+ce(ge,he++),Le+=U(ge,te,de,ke,Se);else if(ke==="object"){if(typeof V.then=="function")return U(ue(V),te,de,ge,Se);throw te=String(V),Error("Objects are not valid as a React child (found: "+(te==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":te)+"). If you meant to render a collection of children, use an array instead.")}return Le}function se(V,te,de){if(V==null)return V;var ge=[],Se=0;return U(V,ge,"","",function(ke){return te.call(de,ke,Se++)}),ge}function pe(V){if(V._status===-1){var te=V._result;te=te(),te.then(function(de){(V._status===0||V._status===-1)&&(V._status=1,V._result=de)},function(de){(V._status===0||V._status===-1)&&(V._status=2,V._result=de)}),V._status===-1&&(V._status=0,V._result=te)}if(V._status===1)return V._result.default;throw V._result}var be=typeof reportError=="function"?reportError:function(V){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var te=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof V=="object"&&V!==null&&typeof V.message=="string"?String(V.message):String(V),error:V});if(!window.dispatchEvent(te))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",V);return}console.error(V)},Ve={map:se,forEach:function(V,te,de){se(V,function(){te.apply(this,arguments)},de)},count:function(V){var te=0;return se(V,function(){te++}),te},toArray:function(V){return se(V,function(te){return te})||[]},only:function(V){if(!M(V))throw Error("React.Children.only expected to receive a single React element child.");return V}};return je.Activity=b,je.Children=Ve,je.Component=L,je.Fragment=t,je.Profiler=a,je.PureComponent=B,je.StrictMode=i,je.Suspense=p,je.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,je.__COMPILER_RUNTIME={__proto__:null,c:function(V){return A.H.useMemoCache(V)}},je.cache=function(V){return function(){return V.apply(null,arguments)}},je.cacheSignal=function(){return null},je.cloneElement=function(V,te,de){if(V==null)throw Error("The argument must be a React element, but you passed "+V+".");var ge=j({},V.props),Se=V.key;if(te!=null)for(ke in te.key!==void 0&&(Se=""+te.key),te)!C.call(te,ke)||ke==="key"||ke==="__self"||ke==="__source"||ke==="ref"&&te.ref===void 0||(ge[ke]=te[ke]);var ke=arguments.length-2;if(ke===1)ge.children=de;else if(1<ke){for(var Le=Array(ke),ee=0;ee<ke;ee++)Le[ee]=arguments[ee+2];ge.children=Le}return I(V.type,Se,ge)},je.createContext=function(V){return V={$$typeof:c,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null},V.Provider=V,V.Consumer={$$typeof:l,_context:V},V},je.createElement=function(V,te,de){var ge,Se={},ke=null;if(te!=null)for(ge in te.key!==void 0&&(ke=""+te.key),te)C.call(te,ge)&&ge!=="key"&&ge!=="__self"&&ge!=="__source"&&(Se[ge]=te[ge]);var Le=arguments.length-2;if(Le===1)Se.children=de;else if(1<Le){for(var ee=Array(Le),he=0;he<Le;he++)ee[he]=arguments[he+2];Se.children=ee}if(V&&V.defaultProps)for(ge in Le=V.defaultProps,Le)Se[ge]===void 0&&(Se[ge]=Le[ge]);return I(V,ke,Se)},je.createRef=function(){return{current:null}},je.forwardRef=function(V){return{$$typeof:d,render:V}},je.isValidElement=M,je.lazy=function(V){return{$$typeof:_,_payload:{_status:-1,_result:V},_init:pe}},je.memo=function(V,te){return{$$typeof:m,type:V,compare:te===void 0?null:te}},je.startTransition=function(V){var te=A.T,de={};A.T=de;try{var ge=V(),Se=A.S;Se!==null&&Se(de,ge),typeof ge=="object"&&ge!==null&&typeof ge.then=="function"&&ge.then($,be)}catch(ke){be(ke)}finally{te!==null&&de.types!==null&&(te.types=de.types),A.T=te}},je.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},je.use=function(V){return A.H.use(V)},je.useActionState=function(V,te,de){return A.H.useActionState(V,te,de)},je.useCallback=function(V,te){return A.H.useCallback(V,te)},je.useContext=function(V){return A.H.useContext(V)},je.useDebugValue=function(){},je.useDeferredValue=function(V,te){return A.H.useDeferredValue(V,te)},je.useEffect=function(V,te){return A.H.useEffect(V,te)},je.useEffectEvent=function(V){return A.H.useEffectEvent(V)},je.useId=function(){return A.H.useId()},je.useImperativeHandle=function(V,te,de){return A.H.useImperativeHandle(V,te,de)},je.useInsertionEffect=function(V,te){return A.H.useInsertionEffect(V,te)},je.useLayoutEffect=function(V,te){return A.H.useLayoutEffect(V,te)},je.useMemo=function(V,te){return A.H.useMemo(V,te)},je.useOptimistic=function(V,te){return A.H.useOptimistic(V,te)},je.useReducer=function(V,te,de){return A.H.useReducer(V,te,de)},je.useRef=function(V){return A.H.useRef(V)},je.useState=function(V){return A.H.useState(V)},je.useSyncExternalStore=function(V,te,de){return A.H.useSyncExternalStore(V,te,de)},je.useTransition=function(){return A.H.useTransition()},je.version="19.2.3",je}var _b;function Ym(){return _b||(_b=1,Np.exports=E2()),Np.exports}var le=Ym();const Gc=fT(le);var Cp={exports:{}},Ec={},Rp={exports:{}},Ip={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bb;function S2(){return bb||(bb=1,(function(n){function e(U,se){var pe=U.length;U.push(se);e:for(;0<pe;){var be=pe-1>>>1,Ve=U[be];if(0<a(Ve,se))U[be]=se,U[pe]=Ve,pe=be;else break e}}function t(U){return U.length===0?null:U[0]}function i(U){if(U.length===0)return null;var se=U[0],pe=U.pop();if(pe!==se){U[0]=pe;e:for(var be=0,Ve=U.length,V=Ve>>>1;be<V;){var te=2*(be+1)-1,de=U[te],ge=te+1,Se=U[ge];if(0>a(de,pe))ge<Ve&&0>a(Se,de)?(U[be]=Se,U[ge]=pe,be=ge):(U[be]=de,U[te]=pe,be=te);else if(ge<Ve&&0>a(Se,pe))U[be]=Se,U[ge]=pe,be=ge;else break e}}return se}function a(U,se){var pe=U.sortIndex-se.sortIndex;return pe!==0?pe:U.id-se.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var c=Date,d=c.now();n.unstable_now=function(){return c.now()-d}}var p=[],m=[],_=1,b=null,x=3,S=!1,N=!1,j=!1,k=!1,L=typeof setTimeout=="function"?setTimeout:null,H=typeof clearTimeout=="function"?clearTimeout:null,B=typeof setImmediate<"u"?setImmediate:null;function K(U){for(var se=t(m);se!==null;){if(se.callback===null)i(m);else if(se.startTime<=U)i(m),se.sortIndex=se.expirationTime,e(p,se);else break;se=t(m)}}function F(U){if(j=!1,K(U),!N)if(t(p)!==null)N=!0,$||($=!0,q());else{var se=t(m);se!==null&&ue(F,se.startTime-U)}}var $=!1,A=-1,C=5,I=-1;function D(){return k?!0:!(n.unstable_now()-I<C)}function M(){if(k=!1,$){var U=n.unstable_now();I=U;var se=!0;try{e:{N=!1,j&&(j=!1,H(A),A=-1),S=!0;var pe=x;try{t:{for(K(U),b=t(p);b!==null&&!(b.expirationTime>U&&D());){var be=b.callback;if(typeof be=="function"){b.callback=null,x=b.priorityLevel;var Ve=be(b.expirationTime<=U);if(U=n.unstable_now(),typeof Ve=="function"){b.callback=Ve,K(U),se=!0;break t}b===t(p)&&i(p),K(U)}else i(p);b=t(p)}if(b!==null)se=!0;else{var V=t(m);V!==null&&ue(F,V.startTime-U),se=!1}}break e}finally{b=null,x=pe,S=!1}se=void 0}}finally{se?q():$=!1}}}var q;if(typeof B=="function")q=function(){B(M)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,ce=O.port2;O.port1.onmessage=M,q=function(){ce.postMessage(null)}}else q=function(){L(M,0)};function ue(U,se){A=L(function(){U(n.unstable_now())},se)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(U){U.callback=null},n.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<U?Math.floor(1e3/U):5},n.unstable_getCurrentPriorityLevel=function(){return x},n.unstable_next=function(U){switch(x){case 1:case 2:case 3:var se=3;break;default:se=x}var pe=x;x=se;try{return U()}finally{x=pe}},n.unstable_requestPaint=function(){k=!0},n.unstable_runWithPriority=function(U,se){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var pe=x;x=U;try{return se()}finally{x=pe}},n.unstable_scheduleCallback=function(U,se,pe){var be=n.unstable_now();switch(typeof pe=="object"&&pe!==null?(pe=pe.delay,pe=typeof pe=="number"&&0<pe?be+pe:be):pe=be,U){case 1:var Ve=-1;break;case 2:Ve=250;break;case 5:Ve=1073741823;break;case 4:Ve=1e4;break;default:Ve=5e3}return Ve=pe+Ve,U={id:_++,callback:se,priorityLevel:U,startTime:pe,expirationTime:Ve,sortIndex:-1},pe>be?(U.sortIndex=pe,e(m,U),t(p)===null&&U===t(m)&&(j?(H(A),A=-1):j=!0,ue(F,pe-be))):(U.sortIndex=Ve,e(p,U),N||S||(N=!0,$||($=!0,q()))),U},n.unstable_shouldYield=D,n.unstable_wrapCallback=function(U){var se=x;return function(){var pe=x;x=se;try{return U.apply(this,arguments)}finally{x=pe}}}})(Ip)),Ip}var wb;function A2(){return wb||(wb=1,Rp.exports=S2()),Rp.exports}var kp={exports:{}},ln={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xb;function N2(){if(xb)return ln;xb=1;var n=Ym();function e(p){var m="https://react.dev/errors/"+p;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)m+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+p+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(p,m,_){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:b==null?null:""+b,children:p,containerInfo:m,implementation:_}}var c=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(p,m){if(p==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return ln.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,ln.createPortal=function(p,m){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(e(299));return l(p,m,null,_)},ln.flushSync=function(p){var m=c.T,_=i.p;try{if(c.T=null,i.p=2,p)return p()}finally{c.T=m,i.p=_,i.d.f()}},ln.preconnect=function(p,m){typeof p=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,i.d.C(p,m))},ln.prefetchDNS=function(p){typeof p=="string"&&i.d.D(p)},ln.preinit=function(p,m){if(typeof p=="string"&&m&&typeof m.as=="string"){var _=m.as,b=d(_,m.crossOrigin),x=typeof m.integrity=="string"?m.integrity:void 0,S=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;_==="style"?i.d.S(p,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:b,integrity:x,fetchPriority:S}):_==="script"&&i.d.X(p,{crossOrigin:b,integrity:x,fetchPriority:S,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},ln.preinitModule=function(p,m){if(typeof p=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var _=d(m.as,m.crossOrigin);i.d.M(p,{crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&i.d.M(p)},ln.preload=function(p,m){if(typeof p=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var _=m.as,b=d(_,m.crossOrigin);i.d.L(p,_,{crossOrigin:b,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},ln.preloadModule=function(p,m){if(typeof p=="string")if(m){var _=d(m.as,m.crossOrigin);i.d.m(p,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else i.d.m(p)},ln.requestFormReset=function(p){i.d.r(p)},ln.unstable_batchedUpdates=function(p,m){return p(m)},ln.useFormState=function(p,m,_){return c.H.useFormState(p,m,_)},ln.useFormStatus=function(){return c.H.useHostTransitionStatus()},ln.version="19.2.3",ln}var Tb;function C2(){if(Tb)return kp.exports;Tb=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),kp.exports=N2(),kp.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Eb;function R2(){if(Eb)return Ec;Eb=1;var n=A2(),e=Ym(),t=C2();function i(s){var r="https://react.dev/errors/"+s;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)r+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+s+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function l(s){var r=s,o=s;if(s.alternate)for(;r.return;)r=r.return;else{s=r;do r=s,(r.flags&4098)!==0&&(o=r.return),s=r.return;while(s)}return r.tag===3?o:null}function c(s){if(s.tag===13){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function d(s){if(s.tag===31){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function p(s){if(l(s)!==s)throw Error(i(188))}function m(s){var r=s.alternate;if(!r){if(r=l(s),r===null)throw Error(i(188));return r!==s?null:s}for(var o=s,u=r;;){var g=o.return;if(g===null)break;var y=g.alternate;if(y===null){if(u=g.return,u!==null){o=u;continue}break}if(g.child===y.child){for(y=g.child;y;){if(y===o)return p(g),s;if(y===u)return p(g),r;y=y.sibling}throw Error(i(188))}if(o.return!==u.return)o=g,u=y;else{for(var w=!1,E=g.child;E;){if(E===o){w=!0,o=g,u=y;break}if(E===u){w=!0,u=g,o=y;break}E=E.sibling}if(!w){for(E=y.child;E;){if(E===o){w=!0,o=y,u=g;break}if(E===u){w=!0,u=y,o=g;break}E=E.sibling}if(!w)throw Error(i(189))}}if(o.alternate!==u)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?s:r}function _(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s;for(s=s.child;s!==null;){if(r=_(s),r!==null)return r;s=s.sibling}return null}var b=Object.assign,x=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),N=Symbol.for("react.portal"),j=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),L=Symbol.for("react.profiler"),H=Symbol.for("react.consumer"),B=Symbol.for("react.context"),K=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),$=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),I=Symbol.for("react.activity"),D=Symbol.for("react.memo_cache_sentinel"),M=Symbol.iterator;function q(s){return s===null||typeof s!="object"?null:(s=M&&s[M]||s["@@iterator"],typeof s=="function"?s:null)}var O=Symbol.for("react.client.reference");function ce(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===O?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case j:return"Fragment";case L:return"Profiler";case k:return"StrictMode";case F:return"Suspense";case $:return"SuspenseList";case I:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case N:return"Portal";case B:return s.displayName||"Context";case H:return(s._context.displayName||"Context")+".Consumer";case K:var r=s.render;return s=s.displayName,s||(s=r.displayName||r.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case A:return r=s.displayName||null,r!==null?r:ce(s.type)||"Memo";case C:r=s._payload,s=s._init;try{return ce(s(r))}catch{}}return null}var ue=Array.isArray,U=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,se=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,pe={pending:!1,data:null,method:null,action:null},be=[],Ve=-1;function V(s){return{current:s}}function te(s){0>Ve||(s.current=be[Ve],be[Ve]=null,Ve--)}function de(s,r){Ve++,be[Ve]=s.current,s.current=r}var ge=V(null),Se=V(null),ke=V(null),Le=V(null);function ee(s,r){switch(de(ke,r),de(Se,s),de(ge,null),r.nodeType){case 9:case 11:s=(s=r.documentElement)&&(s=s.namespaceURI)?V_(s):0;break;default:if(s=r.tagName,r=r.namespaceURI)r=V_(r),s=B_(r,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}te(ge),de(ge,s)}function he(){te(ge),te(Se),te(ke)}function ye(s){s.memoizedState!==null&&de(Le,s);var r=ge.current,o=B_(r,s.type);r!==o&&(de(Se,s),de(ge,o))}function wt(s){Se.current===s&&(te(ge),te(Se)),Le.current===s&&(te(Le),_c._currentValue=pe)}var Wt,As;function Ns(s){if(Wt===void 0)try{throw Error()}catch(o){var r=o.stack.trim().match(/\n( *(at )?)/);Wt=r&&r[1]||"",As=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Wt+s+As}var _l=!1;function qr(s,r){if(!s||_l)return"";_l=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(r){var re=function(){throw Error()};if(Object.defineProperty(re.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(re,[])}catch(Z){var J=Z}Reflect.construct(s,[],re)}else{try{re.call()}catch(Z){J=Z}s.call(re.prototype)}}else{try{throw Error()}catch(Z){J=Z}(re=s())&&typeof re.catch=="function"&&re.catch(function(){})}}catch(Z){if(Z&&J&&typeof Z.stack=="string")return[Z.stack,J.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=u.DetermineComponentFrameRoot(),w=y[0],E=y[1];if(w&&E){var P=w.split(`
`),Q=E.split(`
`);for(g=u=0;u<P.length&&!P[u].includes("DetermineComponentFrameRoot");)u++;for(;g<Q.length&&!Q[g].includes("DetermineComponentFrameRoot");)g++;if(u===P.length||g===Q.length)for(u=P.length-1,g=Q.length-1;1<=u&&0<=g&&P[u]!==Q[g];)g--;for(;1<=u&&0<=g;u--,g--)if(P[u]!==Q[g]){if(u!==1||g!==1)do if(u--,g--,0>g||P[u]!==Q[g]){var ne=`
`+P[u].replace(" at new "," at ");return s.displayName&&ne.includes("<anonymous>")&&(ne=ne.replace("<anonymous>",s.displayName)),ne}while(1<=u&&0<=g);break}}}finally{_l=!1,Error.prepareStackTrace=o}return(o=s?s.displayName||s.name:"")?Ns(o):""}function bl(s,r){switch(s.tag){case 26:case 27:case 5:return Ns(s.type);case 16:return Ns("Lazy");case 13:return s.child!==r&&r!==null?Ns("Suspense Fallback"):Ns("Suspense");case 19:return Ns("SuspenseList");case 0:case 15:return qr(s.type,!1);case 11:return qr(s.type.render,!1);case 1:return qr(s.type,!0);case 31:return Ns("Activity");default:return""}}function wl(s){try{var r="",o=null;do r+=bl(s,o),o=s,s=s.return;while(s);return r}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var Ct=Object.prototype.hasOwnProperty,zt=n.unstable_scheduleCallback,Li=n.unstable_cancelCallback,Cf=n.unstable_shouldYield,Eu=n.unstable_requestPaint,gn=n.unstable_now,$r=n.unstable_getCurrentPriorityLevel,xl=n.unstable_ImmediatePriority,Tl=n.unstable_UserBlockingPriority,Ui=n.unstable_NormalPriority,Rf=n.unstable_LowPriority,Su=n.unstable_IdlePriority,Au=n.log,Nu=n.unstable_setDisableYieldValue,as=null,Qt=null;function Hn(s){if(typeof Au=="function"&&Nu(s),Qt&&typeof Qt.setStrictMode=="function")try{Qt.setStrictMode(as,s)}catch{}}var xt=Math.clz32?Math.clz32:Ru,Cu=Math.log,Ga=Math.LN2;function Ru(s){return s>>>=0,s===0?32:31-(Cu(s)/Ga|0)|0}var Cs=256,Gr=262144,Rt=4194304;function Rs(s){var r=s&42;if(r!==0)return r;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Is(s,r,o){var u=s.pendingLanes;if(u===0)return 0;var g=0,y=s.suspendedLanes,w=s.pingedLanes;s=s.warmLanes;var E=u&134217727;return E!==0?(u=E&~y,u!==0?g=Rs(u):(w&=E,w!==0?g=Rs(w):o||(o=E&~s,o!==0&&(g=Rs(o))))):(E=u&~y,E!==0?g=Rs(E):w!==0?g=Rs(w):o||(o=u&~s,o!==0&&(g=Rs(o)))),g===0?0:r!==0&&r!==g&&(r&y)===0&&(y=g&-g,o=r&-r,y>=o||y===32&&(o&4194048)!==0)?r:g}function os(s,r){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&r)===0}function If(s,r){switch(s){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Iu(){var s=Rt;return Rt<<=1,(Rt&62914560)===0&&(Rt=4194304),s}function ks(s){for(var r=[],o=0;31>o;o++)r.push(s);return r}function Fr(s,r){s.pendingLanes|=r,r!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function kf(s,r,o,u,g,y){var w=s.pendingLanes;s.pendingLanes=o,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=o,s.entangledLanes&=o,s.errorRecoveryDisabledLanes&=o,s.shellSuspendCounter=0;var E=s.entanglements,P=s.expirationTimes,Q=s.hiddenUpdates;for(o=w&~o;0<o;){var ne=31-xt(o),re=1<<ne;E[ne]=0,P[ne]=-1;var J=Q[ne];if(J!==null)for(Q[ne]=null,ne=0;ne<J.length;ne++){var Z=J[ne];Z!==null&&(Z.lane&=-536870913)}o&=~re}u!==0&&Kr(s,u,0),y!==0&&g===0&&s.tag!==0&&(s.suspendedLanes|=y&~(w&~r))}function Kr(s,r,o){s.pendingLanes|=r,s.suspendedLanes&=~r;var u=31-xt(r);s.entangledLanes|=r,s.entanglements[u]=s.entanglements[u]|1073741824|o&261930}function El(s,r){var o=s.entangledLanes|=r;for(s=s.entanglements;o;){var u=31-xt(o),g=1<<u;g&r|s[u]&r&&(s[u]|=r),o&=~g}}function Sl(s,r){var o=r&-r;return o=(o&42)!==0?1:Yr(o),(o&(s.suspendedLanes|r))!==0?0:o}function Yr(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function ri(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function ku(){var s=se.p;return s!==0?s:(s=window.event,s===void 0?32:cb(s.type))}function ls(s,r){var o=se.p;try{return se.p=s,r()}finally{se.p=o}}var cs=Math.random().toString(36).slice(2),It="__reactFiber$"+cs,Gt="__reactProps$"+cs,Os="__reactContainer$"+cs,Fa="__reactEvents$"+cs,Of="__reactListeners$"+cs,Ou="__reactHandles$"+cs,ju="__reactResources$"+cs,js="__reactMarker$"+cs;function Ka(s){delete s[It],delete s[Gt],delete s[Fa],delete s[Of],delete s[Ou]}function Ds(s){var r=s[It];if(r)return r;for(var o=s.parentNode;o;){if(r=o[Os]||o[It]){if(o=r.alternate,r.child!==null||o!==null&&o.child!==null)for(s=K_(s);s!==null;){if(o=s[It])return o;s=K_(s)}return r}s=o,o=s.parentNode}return null}function qn(s){if(s=s[It]||s[Os]){var r=s.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return s}return null}function In(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s.stateNode;throw Error(i(33))}function Ps(s){var r=s[ju];return r||(r=s[ju]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function kt(s){s[js]=!0}var Al=new Set,Nl={};function Ms(s,r){Ls(s,r),Ls(s+"Capture",r)}function Ls(s,r){for(Nl[s]=r,s=0;s<r.length;s++)Al.add(r[s])}var Cl=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Rl={},Il={};function Du(s){return Ct.call(Il,s)?!0:Ct.call(Rl,s)?!1:Cl.test(s)?Il[s]=!0:(Rl[s]=!0,!1)}function Ya(s,r,o){if(Du(r))if(o===null)s.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":s.removeAttribute(r);return;case"boolean":var u=r.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){s.removeAttribute(r);return}}s.setAttribute(r,""+o)}}function kn(s,r,o){if(o===null)s.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(r);return}s.setAttribute(r,""+o)}}function Ot(s,r,o,u){if(u===null)s.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttributeNS(r,o,""+u)}}function Ft(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Vi(s){var r=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function kl(s,r,o){var u=Object.getOwnPropertyDescriptor(s.constructor.prototype,r);if(!s.hasOwnProperty(r)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var g=u.get,y=u.set;return Object.defineProperty(s,r,{configurable:!0,get:function(){return g.call(this)},set:function(w){o=""+w,y.call(this,w)}}),Object.defineProperty(s,r,{enumerable:u.enumerable}),{getValue:function(){return o},setValue:function(w){o=""+w},stopTracking:function(){s._valueTracker=null,delete s[r]}}}}function et(s){if(!s._valueTracker){var r=Vi(s)?"checked":"value";s._valueTracker=kl(s,r,""+s[r])}}function Wr(s){if(!s)return!1;var r=s._valueTracker;if(!r)return!0;var o=r.getValue(),u="";return s&&(u=Vi(s)?s.checked?"true":"false":s.value),s=u,s!==o?(r.setValue(s),!0):!1}function Us(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Qr=/[\n"\\]/g;function vn(s){return s.replace(Qr,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function Wa(s,r,o,u,g,y,w,E){s.name="",w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?s.type=w:s.removeAttribute("type"),r!=null?w==="number"?(r===0&&s.value===""||s.value!=r)&&(s.value=""+Ft(r)):s.value!==""+Ft(r)&&(s.value=""+Ft(r)):w!=="submit"&&w!=="reset"||s.removeAttribute("value"),r!=null?Ol(s,w,Ft(r)):o!=null?Ol(s,w,Ft(o)):u!=null&&s.removeAttribute("value"),g==null&&y!=null&&(s.defaultChecked=!!y),g!=null&&(s.checked=g&&typeof g!="function"&&typeof g!="symbol"),E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?s.name=""+Ft(E):s.removeAttribute("name")}function Pu(s,r,o,u,g,y,w,E){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(s.type=y),r!=null||o!=null){if(!(y!=="submit"&&y!=="reset"||r!=null)){et(s);return}o=o!=null?""+Ft(o):"",r=r!=null?""+Ft(r):o,E||r===s.value||(s.value=r),s.defaultValue=r}u=u??g,u=typeof u!="function"&&typeof u!="symbol"&&!!u,s.checked=E?s.checked:!!u,s.defaultChecked=!!u,w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(s.name=w),et(s)}function Ol(s,r,o){r==="number"&&Us(s.ownerDocument)===s||s.defaultValue===""+o||(s.defaultValue=""+o)}function Bi(s,r,o,u){if(s=s.options,r){r={};for(var g=0;g<o.length;g++)r["$"+o[g]]=!0;for(o=0;o<s.length;o++)g=r.hasOwnProperty("$"+s[o].value),s[o].selected!==g&&(s[o].selected=g),g&&u&&(s[o].defaultSelected=!0)}else{for(o=""+Ft(o),r=null,g=0;g<s.length;g++){if(s[g].value===o){s[g].selected=!0,u&&(s[g].defaultSelected=!0);return}r!==null||s[g].disabled||(r=s[g])}r!==null&&(r.selected=!0)}}function Mu(s,r,o){if(r!=null&&(r=""+Ft(r),r!==s.value&&(s.value=r),o==null)){s.defaultValue!==r&&(s.defaultValue=r);return}s.defaultValue=o!=null?""+Ft(o):""}function zi(s,r,o,u){if(r==null){if(u!=null){if(o!=null)throw Error(i(92));if(ue(u)){if(1<u.length)throw Error(i(93));u=u[0]}o=u}o==null&&(o=""),r=o}o=Ft(r),s.defaultValue=o,u=s.textContent,u===o&&u!==""&&u!==null&&(s.value=u),et(s)}function _n(s,r){if(r){var o=s.firstChild;if(o&&o===s.lastChild&&o.nodeType===3){o.nodeValue=r;return}}s.textContent=r}var Lu=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function jl(s,r,o){var u=r.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?u?s.setProperty(r,""):r==="float"?s.cssFloat="":s[r]="":u?s.setProperty(r,o):typeof o!="number"||o===0||Lu.has(r)?r==="float"?s.cssFloat=o:s[r]=(""+o).trim():s[r]=o+"px"}function Dl(s,r,o){if(r!=null&&typeof r!="object")throw Error(i(62));if(s=s.style,o!=null){for(var u in o)!o.hasOwnProperty(u)||r!=null&&r.hasOwnProperty(u)||(u.indexOf("--")===0?s.setProperty(u,""):u==="float"?s.cssFloat="":s[u]="");for(var g in r)u=r[g],r.hasOwnProperty(g)&&o[g]!==u&&jl(s,g,u)}else for(var y in r)r.hasOwnProperty(y)&&jl(s,y,r[y])}function Qa(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Uu=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Hi=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ja(s){return Hi.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function us(){}var Pl=null;function $n(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var qi=null,Vs=null;function Jr(s){var r=qn(s);if(r&&(s=r.stateNode)){var o=s[Gt]||null;e:switch(s=r.stateNode,r.type){case"input":if(Wa(s,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),r=o.name,o.type==="radio"&&r!=null){for(o=s;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+vn(""+r)+'"][type="radio"]'),r=0;r<o.length;r++){var u=o[r];if(u!==s&&u.form===s.form){var g=u[Gt]||null;if(!g)throw Error(i(90));Wa(u,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(r=0;r<o.length;r++)u=o[r],u.form===s.form&&Wr(u)}break e;case"textarea":Mu(s,o.value,o.defaultValue);break e;case"select":r=o.value,r!=null&&Bi(s,!!o.multiple,r,!1)}}}var Xa=!1;function $i(s,r,o){if(Xa)return s(r,o);Xa=!0;try{var u=s(r);return u}finally{if(Xa=!1,(qi!==null||Vs!==null)&&(kh(),qi&&(r=qi,s=Vs,Vs=qi=null,Jr(r),s)))for(r=0;r<s.length;r++)Jr(s[r])}}function hs(s,r){var o=s.stateNode;if(o===null)return null;var u=o[Gt]||null;if(u===null)return null;o=u[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(s=s.type,u=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!u;break e;default:s=!1}if(s)return null;if(o&&typeof o!="function")throw Error(i(231,r,typeof o));return o}var Gn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Xr=!1;if(Gn)try{var st={};Object.defineProperty(st,"passive",{get:function(){Xr=!0}}),window.addEventListener("test",st,st),window.removeEventListener("test",st,st)}catch{Xr=!1}var Bs=null,Ml=null,Zr=null;function Ll(){if(Zr)return Zr;var s,r=Ml,o=r.length,u,g="value"in Bs?Bs.value:Bs.textContent,y=g.length;for(s=0;s<o&&r[s]===g[s];s++);var w=o-s;for(u=1;u<=w&&r[o-u]===g[y-u];u++);return Zr=g.slice(s,1<u?1-u:void 0)}function ea(s){var r=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&r===13&&(s=13)):s=r,s===10&&(s=13),32<=s||s===13?s:0}function ai(){return!0}function ds(){return!1}function Jt(s){function r(o,u,g,y,w){this._reactName=o,this._targetInst=g,this.type=u,this.nativeEvent=y,this.target=w,this.currentTarget=null;for(var E in s)s.hasOwnProperty(E)&&(o=s[E],this[E]=o?o(y):y[E]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?ai:ds,this.isPropagationStopped=ds,this}return b(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=ai)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=ai)},persist:function(){},isPersistent:ai}),r}var oi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},zs=Jt(oi),Gi=b({},oi,{view:0,detail:0}),Ul=Jt(Gi),Fi,Za,Hs,eo=b({},Gi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ki,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Hs&&(Hs&&s.type==="mousemove"?(Fi=s.screenX-Hs.screenX,Za=s.screenY-Hs.screenY):Za=Fi=0,Hs=s),Fi)},movementY:function(s){return"movementY"in s?s.movementY:Za}}),Vl=Jt(eo),ta=b({},eo,{dataTransfer:0}),Vu=Jt(ta),Bu=b({},Gi,{relatedTarget:0}),na=Jt(Bu),Bl=b({},oi,{animationName:0,elapsedTime:0,pseudoElement:0}),zu=Jt(Bl),to=b({},oi,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Hu=Jt(to),qu=b({},oi,{data:0}),qs=Jt(qu),$u={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Gu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Fu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ku(s){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(s):(s=Fu[s])?!!r[s]:!1}function Ki(){return Ku}var pn=b({},Gi,{key:function(s){if(s.key){var r=$u[s.key]||s.key;if(r!=="Unidentified")return r}return s.type==="keypress"?(s=ea(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Gu[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ki,charCode:function(s){return s.type==="keypress"?ea(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?ea(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Yu=Jt(pn),Wu=b({},eo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),li=Jt(Wu),h=b({},Gi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ki}),v=Jt(h),T=b({},oi,{propertyName:0,elapsedTime:0,pseudoElement:0}),R=Jt(T),Y=b({},eo,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),X=Jt(Y),fe=b({},oi,{newState:0,oldState:0}),Pe=Jt(fe),Tt=[9,13,27,32],Je=Gn&&"CompositionEvent"in window,ft=null;Gn&&"documentMode"in document&&(ft=document.documentMode);var Fn=Gn&&"TextEvent"in window&&!ft,$s=Gn&&(!Je||ft&&8<ft&&11>=ft),fs=" ",gs=!1;function sa(s,r){switch(s){case"keyup":return Tt.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function no(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var so=!1;function FS(s,r){switch(s){case"compositionend":return no(r);case"keypress":return r.which!==32?null:(gs=!0,fs);case"textInput":return s=r.data,s===fs&&gs?null:s;default:return null}}function KS(s,r){if(so)return s==="compositionend"||!Je&&sa(s,r)?(s=Ll(),Zr=Ml=Bs=null,so=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return $s&&r.locale!=="ko"?null:r.data;default:return null}}var YS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Q0(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r==="input"?!!YS[s.type]:r==="textarea"}function J0(s,r,o,u){qi?Vs?Vs.push(u):Vs=[u]:qi=u,r=Uh(r,"onChange"),0<r.length&&(o=new zs("onChange","change",null,o,u),s.push({event:o,listeners:r}))}var zl=null,Hl=null;function WS(s){j_(s,0)}function Qu(s){var r=In(s);if(Wr(r))return s}function X0(s,r){if(s==="change")return r}var Z0=!1;if(Gn){var jf;if(Gn){var Df="oninput"in document;if(!Df){var ey=document.createElement("div");ey.setAttribute("oninput","return;"),Df=typeof ey.oninput=="function"}jf=Df}else jf=!1;Z0=jf&&(!document.documentMode||9<document.documentMode)}function ty(){zl&&(zl.detachEvent("onpropertychange",ny),Hl=zl=null)}function ny(s){if(s.propertyName==="value"&&Qu(Hl)){var r=[];J0(r,Hl,s,$n(s)),$i(WS,r)}}function QS(s,r,o){s==="focusin"?(ty(),zl=r,Hl=o,zl.attachEvent("onpropertychange",ny)):s==="focusout"&&ty()}function JS(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Qu(Hl)}function XS(s,r){if(s==="click")return Qu(r)}function ZS(s,r){if(s==="input"||s==="change")return Qu(r)}function eA(s,r){return s===r&&(s!==0||1/s===1/r)||s!==s&&r!==r}var On=typeof Object.is=="function"?Object.is:eA;function ql(s,r){if(On(s,r))return!0;if(typeof s!="object"||s===null||typeof r!="object"||r===null)return!1;var o=Object.keys(s),u=Object.keys(r);if(o.length!==u.length)return!1;for(u=0;u<o.length;u++){var g=o[u];if(!Ct.call(r,g)||!On(s[g],r[g]))return!1}return!0}function sy(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function iy(s,r){var o=sy(s);s=0;for(var u;o;){if(o.nodeType===3){if(u=s+o.textContent.length,s<=r&&u>=r)return{node:o,offset:r-s};s=u}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=sy(o)}}function ry(s,r){return s&&r?s===r?!0:s&&s.nodeType===3?!1:r&&r.nodeType===3?ry(s,r.parentNode):"contains"in s?s.contains(r):s.compareDocumentPosition?!!(s.compareDocumentPosition(r)&16):!1:!1}function ay(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var r=Us(s.document);r instanceof s.HTMLIFrameElement;){try{var o=typeof r.contentWindow.location.href=="string"}catch{o=!1}if(o)s=r.contentWindow;else break;r=Us(s.document)}return r}function Pf(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r&&(r==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||r==="textarea"||s.contentEditable==="true")}var tA=Gn&&"documentMode"in document&&11>=document.documentMode,io=null,Mf=null,$l=null,Lf=!1;function oy(s,r,o){var u=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Lf||io==null||io!==Us(u)||(u=io,"selectionStart"in u&&Pf(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),$l&&ql($l,u)||($l=u,u=Uh(Mf,"onSelect"),0<u.length&&(r=new zs("onSelect","select",null,r,o),s.push({event:r,listeners:u}),r.target=io)))}function ia(s,r){var o={};return o[s.toLowerCase()]=r.toLowerCase(),o["Webkit"+s]="webkit"+r,o["Moz"+s]="moz"+r,o}var ro={animationend:ia("Animation","AnimationEnd"),animationiteration:ia("Animation","AnimationIteration"),animationstart:ia("Animation","AnimationStart"),transitionrun:ia("Transition","TransitionRun"),transitionstart:ia("Transition","TransitionStart"),transitioncancel:ia("Transition","TransitionCancel"),transitionend:ia("Transition","TransitionEnd")},Uf={},ly={};Gn&&(ly=document.createElement("div").style,"AnimationEvent"in window||(delete ro.animationend.animation,delete ro.animationiteration.animation,delete ro.animationstart.animation),"TransitionEvent"in window||delete ro.transitionend.transition);function ra(s){if(Uf[s])return Uf[s];if(!ro[s])return s;var r=ro[s],o;for(o in r)if(r.hasOwnProperty(o)&&o in ly)return Uf[s]=r[o];return s}var cy=ra("animationend"),uy=ra("animationiteration"),hy=ra("animationstart"),nA=ra("transitionrun"),sA=ra("transitionstart"),iA=ra("transitioncancel"),dy=ra("transitionend"),fy=new Map,Vf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Vf.push("scrollEnd");function ps(s,r){fy.set(s,r),Ms(r,[s])}var Ju=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Kn=[],ao=0,Bf=0;function Xu(){for(var s=ao,r=Bf=ao=0;r<s;){var o=Kn[r];Kn[r++]=null;var u=Kn[r];Kn[r++]=null;var g=Kn[r];Kn[r++]=null;var y=Kn[r];if(Kn[r++]=null,u!==null&&g!==null){var w=u.pending;w===null?g.next=g:(g.next=w.next,w.next=g),u.pending=g}y!==0&&gy(o,g,y)}}function Zu(s,r,o,u){Kn[ao++]=s,Kn[ao++]=r,Kn[ao++]=o,Kn[ao++]=u,Bf|=u,s.lanes|=u,s=s.alternate,s!==null&&(s.lanes|=u)}function zf(s,r,o,u){return Zu(s,r,o,u),eh(s)}function aa(s,r){return Zu(s,null,null,r),eh(s)}function gy(s,r,o){s.lanes|=o;var u=s.alternate;u!==null&&(u.lanes|=o);for(var g=!1,y=s.return;y!==null;)y.childLanes|=o,u=y.alternate,u!==null&&(u.childLanes|=o),y.tag===22&&(s=y.stateNode,s===null||s._visibility&1||(g=!0)),s=y,y=y.return;return s.tag===3?(y=s.stateNode,g&&r!==null&&(g=31-xt(o),s=y.hiddenUpdates,u=s[g],u===null?s[g]=[r]:u.push(r),r.lane=o|536870912),y):null}function eh(s){if(50<dc)throw dc=0,Qg=null,Error(i(185));for(var r=s.return;r!==null;)s=r,r=s.return;return s.tag===3?s.stateNode:null}var oo={};function rA(s,r,o,u){this.tag=s,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function jn(s,r,o,u){return new rA(s,r,o,u)}function Hf(s){return s=s.prototype,!(!s||!s.isReactComponent)}function ci(s,r){var o=s.alternate;return o===null?(o=jn(s.tag,r,s.key,s.mode),o.elementType=s.elementType,o.type=s.type,o.stateNode=s.stateNode,o.alternate=s,s.alternate=o):(o.pendingProps=r,o.type=s.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=s.flags&65011712,o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,r=s.dependencies,o.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},o.sibling=s.sibling,o.index=s.index,o.ref=s.ref,o.refCleanup=s.refCleanup,o}function py(s,r){s.flags&=65011714;var o=s.alternate;return o===null?(s.childLanes=0,s.lanes=r,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,r=o.dependencies,s.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),s}function th(s,r,o,u,g,y){var w=0;if(u=s,typeof s=="function")Hf(s)&&(w=1);else if(typeof s=="string")w=u2(s,o,ge.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case I:return s=jn(31,o,r,g),s.elementType=I,s.lanes=y,s;case j:return oa(o.children,g,y,r);case k:w=8,g|=24;break;case L:return s=jn(12,o,r,g|2),s.elementType=L,s.lanes=y,s;case F:return s=jn(13,o,r,g),s.elementType=F,s.lanes=y,s;case $:return s=jn(19,o,r,g),s.elementType=$,s.lanes=y,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case B:w=10;break e;case H:w=9;break e;case K:w=11;break e;case A:w=14;break e;case C:w=16,u=null;break e}w=29,o=Error(i(130,s===null?"null":typeof s,"")),u=null}return r=jn(w,o,r,g),r.elementType=s,r.type=u,r.lanes=y,r}function oa(s,r,o,u){return s=jn(7,s,u,r),s.lanes=o,s}function qf(s,r,o){return s=jn(6,s,null,r),s.lanes=o,s}function my(s){var r=jn(18,null,null,0);return r.stateNode=s,r}function $f(s,r,o){return r=jn(4,s.children!==null?s.children:[],s.key,r),r.lanes=o,r.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},r}var yy=new WeakMap;function Yn(s,r){if(typeof s=="object"&&s!==null){var o=yy.get(s);return o!==void 0?o:(r={value:s,source:r,stack:wl(r)},yy.set(s,r),r)}return{value:s,source:r,stack:wl(r)}}var lo=[],co=0,nh=null,Gl=0,Wn=[],Qn=0,Yi=null,Gs=1,Fs="";function ui(s,r){lo[co++]=Gl,lo[co++]=nh,nh=s,Gl=r}function vy(s,r,o){Wn[Qn++]=Gs,Wn[Qn++]=Fs,Wn[Qn++]=Yi,Yi=s;var u=Gs;s=Fs;var g=32-xt(u)-1;u&=~(1<<g),o+=1;var y=32-xt(r)+g;if(30<y){var w=g-g%5;y=(u&(1<<w)-1).toString(32),u>>=w,g-=w,Gs=1<<32-xt(r)+g|o<<g|u,Fs=y+s}else Gs=1<<y|o<<g|u,Fs=s}function Gf(s){s.return!==null&&(ui(s,1),vy(s,1,0))}function Ff(s){for(;s===nh;)nh=lo[--co],lo[co]=null,Gl=lo[--co],lo[co]=null;for(;s===Yi;)Yi=Wn[--Qn],Wn[Qn]=null,Fs=Wn[--Qn],Wn[Qn]=null,Gs=Wn[--Qn],Wn[Qn]=null}function _y(s,r){Wn[Qn++]=Gs,Wn[Qn++]=Fs,Wn[Qn++]=Yi,Gs=r.id,Fs=r.overflow,Yi=s}var Xt=null,ut=null,Ke=!1,Wi=null,Jn=!1,Kf=Error(i(519));function Qi(s){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Fl(Yn(r,s)),Kf}function by(s){var r=s.stateNode,o=s.type,u=s.memoizedProps;switch(r[It]=s,r[Gt]=u,o){case"dialog":ze("cancel",r),ze("close",r);break;case"iframe":case"object":case"embed":ze("load",r);break;case"video":case"audio":for(o=0;o<gc.length;o++)ze(gc[o],r);break;case"source":ze("error",r);break;case"img":case"image":case"link":ze("error",r),ze("load",r);break;case"details":ze("toggle",r);break;case"input":ze("invalid",r),Pu(r,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":ze("invalid",r);break;case"textarea":ze("invalid",r),zi(r,u.value,u.defaultValue,u.children)}o=u.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||r.textContent===""+o||u.suppressHydrationWarning===!0||L_(r.textContent,o)?(u.popover!=null&&(ze("beforetoggle",r),ze("toggle",r)),u.onScroll!=null&&ze("scroll",r),u.onScrollEnd!=null&&ze("scrollend",r),u.onClick!=null&&(r.onclick=us),r=!0):r=!1,r||Qi(s,!0)}function wy(s){for(Xt=s.return;Xt;)switch(Xt.tag){case 5:case 31:case 13:Jn=!1;return;case 27:case 3:Jn=!0;return;default:Xt=Xt.return}}function uo(s){if(s!==Xt)return!1;if(!Ke)return wy(s),Ke=!0,!1;var r=s.tag,o;if((o=r!==3&&r!==27)&&((o=r===5)&&(o=s.type,o=!(o!=="form"&&o!=="button")||hp(s.type,s.memoizedProps)),o=!o),o&&ut&&Qi(s),wy(s),r===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));ut=F_(s)}else if(r===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));ut=F_(s)}else r===27?(r=ut,ur(s.type)?(s=mp,mp=null,ut=s):ut=r):ut=Xt?Zn(s.stateNode.nextSibling):null;return!0}function la(){ut=Xt=null,Ke=!1}function Yf(){var s=Wi;return s!==null&&(Tn===null?Tn=s:Tn.push.apply(Tn,s),Wi=null),s}function Fl(s){Wi===null?Wi=[s]:Wi.push(s)}var Wf=V(null),ca=null,hi=null;function Ji(s,r,o){de(Wf,r._currentValue),r._currentValue=o}function di(s){s._currentValue=Wf.current,te(Wf)}function Qf(s,r,o){for(;s!==null;){var u=s.alternate;if((s.childLanes&r)!==r?(s.childLanes|=r,u!==null&&(u.childLanes|=r)):u!==null&&(u.childLanes&r)!==r&&(u.childLanes|=r),s===o)break;s=s.return}}function Jf(s,r,o,u){var g=s.child;for(g!==null&&(g.return=s);g!==null;){var y=g.dependencies;if(y!==null){var w=g.child;y=y.firstContext;e:for(;y!==null;){var E=y;y=g;for(var P=0;P<r.length;P++)if(E.context===r[P]){y.lanes|=o,E=y.alternate,E!==null&&(E.lanes|=o),Qf(y.return,o,s),u||(w=null);break e}y=E.next}}else if(g.tag===18){if(w=g.return,w===null)throw Error(i(341));w.lanes|=o,y=w.alternate,y!==null&&(y.lanes|=o),Qf(w,o,s),w=null}else w=g.child;if(w!==null)w.return=g;else for(w=g;w!==null;){if(w===s){w=null;break}if(g=w.sibling,g!==null){g.return=w.return,w=g;break}w=w.return}g=w}}function ho(s,r,o,u){s=null;for(var g=r,y=!1;g!==null;){if(!y){if((g.flags&524288)!==0)y=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var w=g.alternate;if(w===null)throw Error(i(387));if(w=w.memoizedProps,w!==null){var E=g.type;On(g.pendingProps.value,w.value)||(s!==null?s.push(E):s=[E])}}else if(g===Le.current){if(w=g.alternate,w===null)throw Error(i(387));w.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(s!==null?s.push(_c):s=[_c])}g=g.return}s!==null&&Jf(r,s,o,u),r.flags|=262144}function sh(s){for(s=s.firstContext;s!==null;){if(!On(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function ua(s){ca=s,hi=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Zt(s){return xy(ca,s)}function ih(s,r){return ca===null&&ua(s),xy(s,r)}function xy(s,r){var o=r._currentValue;if(r={context:r,memoizedValue:o,next:null},hi===null){if(s===null)throw Error(i(308));hi=r,s.dependencies={lanes:0,firstContext:r},s.flags|=524288}else hi=hi.next=r;return o}var aA=typeof AbortController<"u"?AbortController:function(){var s=[],r=this.signal={aborted:!1,addEventListener:function(o,u){s.push(u)}};this.abort=function(){r.aborted=!0,s.forEach(function(o){return o()})}},oA=n.unstable_scheduleCallback,lA=n.unstable_NormalPriority,jt={$$typeof:B,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Xf(){return{controller:new aA,data:new Map,refCount:0}}function Kl(s){s.refCount--,s.refCount===0&&oA(lA,function(){s.controller.abort()})}var Yl=null,Zf=0,fo=0,go=null;function cA(s,r){if(Yl===null){var o=Yl=[];Zf=0,fo=np(),go={status:"pending",value:void 0,then:function(u){o.push(u)}}}return Zf++,r.then(Ty,Ty),r}function Ty(){if(--Zf===0&&Yl!==null){go!==null&&(go.status="fulfilled");var s=Yl;Yl=null,fo=0,go=null;for(var r=0;r<s.length;r++)(0,s[r])()}}function uA(s,r){var o=[],u={status:"pending",value:null,reason:null,then:function(g){o.push(g)}};return s.then(function(){u.status="fulfilled",u.value=r;for(var g=0;g<o.length;g++)(0,o[g])(r)},function(g){for(u.status="rejected",u.reason=g,g=0;g<o.length;g++)(0,o[g])(void 0)}),u}var Ey=U.S;U.S=function(s,r){o_=gn(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&cA(s,r),Ey!==null&&Ey(s,r)};var ha=V(null);function eg(){var s=ha.current;return s!==null?s:ot.pooledCache}function rh(s,r){r===null?de(ha,ha.current):de(ha,r.pool)}function Sy(){var s=eg();return s===null?null:{parent:jt._currentValue,pool:s}}var po=Error(i(460)),tg=Error(i(474)),ah=Error(i(542)),oh={then:function(){}};function Ay(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Ny(s,r,o){switch(o=s[o],o===void 0?s.push(r):o!==r&&(r.then(us,us),r=o),r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,Ry(s),s;default:if(typeof r.status=="string")r.then(us,us);else{if(s=ot,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=r,s.status="pending",s.then(function(u){if(r.status==="pending"){var g=r;g.status="fulfilled",g.value=u}},function(u){if(r.status==="pending"){var g=r;g.status="rejected",g.reason=u}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,Ry(s),s}throw fa=r,po}}function da(s){try{var r=s._init;return r(s._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(fa=o,po):o}}var fa=null;function Cy(){if(fa===null)throw Error(i(459));var s=fa;return fa=null,s}function Ry(s){if(s===po||s===ah)throw Error(i(483))}var mo=null,Wl=0;function lh(s){var r=Wl;return Wl+=1,mo===null&&(mo=[]),Ny(mo,s,r)}function Ql(s,r){r=r.props.ref,s.ref=r!==void 0?r:null}function ch(s,r){throw r.$$typeof===x?Error(i(525)):(s=Object.prototype.toString.call(r),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":s)))}function Iy(s){function r(G,z){if(s){var W=G.deletions;W===null?(G.deletions=[z],G.flags|=16):W.push(z)}}function o(G,z){if(!s)return null;for(;z!==null;)r(G,z),z=z.sibling;return null}function u(G){for(var z=new Map;G!==null;)G.key!==null?z.set(G.key,G):z.set(G.index,G),G=G.sibling;return z}function g(G,z){return G=ci(G,z),G.index=0,G.sibling=null,G}function y(G,z,W){return G.index=W,s?(W=G.alternate,W!==null?(W=W.index,W<z?(G.flags|=67108866,z):W):(G.flags|=67108866,z)):(G.flags|=1048576,z)}function w(G){return s&&G.alternate===null&&(G.flags|=67108866),G}function E(G,z,W,ie){return z===null||z.tag!==6?(z=qf(W,G.mode,ie),z.return=G,z):(z=g(z,W),z.return=G,z)}function P(G,z,W,ie){var Te=W.type;return Te===j?ne(G,z,W.props.children,ie,W.key):z!==null&&(z.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===C&&da(Te)===z.type)?(z=g(z,W.props),Ql(z,W),z.return=G,z):(z=th(W.type,W.key,W.props,null,G.mode,ie),Ql(z,W),z.return=G,z)}function Q(G,z,W,ie){return z===null||z.tag!==4||z.stateNode.containerInfo!==W.containerInfo||z.stateNode.implementation!==W.implementation?(z=$f(W,G.mode,ie),z.return=G,z):(z=g(z,W.children||[]),z.return=G,z)}function ne(G,z,W,ie,Te){return z===null||z.tag!==7?(z=oa(W,G.mode,ie,Te),z.return=G,z):(z=g(z,W),z.return=G,z)}function re(G,z,W){if(typeof z=="string"&&z!==""||typeof z=="number"||typeof z=="bigint")return z=qf(""+z,G.mode,W),z.return=G,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case S:return W=th(z.type,z.key,z.props,null,G.mode,W),Ql(W,z),W.return=G,W;case N:return z=$f(z,G.mode,W),z.return=G,z;case C:return z=da(z),re(G,z,W)}if(ue(z)||q(z))return z=oa(z,G.mode,W,null),z.return=G,z;if(typeof z.then=="function")return re(G,lh(z),W);if(z.$$typeof===B)return re(G,ih(G,z),W);ch(G,z)}return null}function J(G,z,W,ie){var Te=z!==null?z.key:null;if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return Te!==null?null:E(G,z,""+W,ie);if(typeof W=="object"&&W!==null){switch(W.$$typeof){case S:return W.key===Te?P(G,z,W,ie):null;case N:return W.key===Te?Q(G,z,W,ie):null;case C:return W=da(W),J(G,z,W,ie)}if(ue(W)||q(W))return Te!==null?null:ne(G,z,W,ie,null);if(typeof W.then=="function")return J(G,z,lh(W),ie);if(W.$$typeof===B)return J(G,z,ih(G,W),ie);ch(G,W)}return null}function Z(G,z,W,ie,Te){if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return G=G.get(W)||null,E(z,G,""+ie,Te);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case S:return G=G.get(ie.key===null?W:ie.key)||null,P(z,G,ie,Te);case N:return G=G.get(ie.key===null?W:ie.key)||null,Q(z,G,ie,Te);case C:return ie=da(ie),Z(G,z,W,ie,Te)}if(ue(ie)||q(ie))return G=G.get(W)||null,ne(z,G,ie,Te,null);if(typeof ie.then=="function")return Z(G,z,W,lh(ie),Te);if(ie.$$typeof===B)return Z(G,z,W,ih(z,ie),Te);ch(z,ie)}return null}function _e(G,z,W,ie){for(var Te=null,We=null,we=z,Ue=z=0,qe=null;we!==null&&Ue<W.length;Ue++){we.index>Ue?(qe=we,we=null):qe=we.sibling;var Qe=J(G,we,W[Ue],ie);if(Qe===null){we===null&&(we=qe);break}s&&we&&Qe.alternate===null&&r(G,we),z=y(Qe,z,Ue),We===null?Te=Qe:We.sibling=Qe,We=Qe,we=qe}if(Ue===W.length)return o(G,we),Ke&&ui(G,Ue),Te;if(we===null){for(;Ue<W.length;Ue++)we=re(G,W[Ue],ie),we!==null&&(z=y(we,z,Ue),We===null?Te=we:We.sibling=we,We=we);return Ke&&ui(G,Ue),Te}for(we=u(we);Ue<W.length;Ue++)qe=Z(we,G,Ue,W[Ue],ie),qe!==null&&(s&&qe.alternate!==null&&we.delete(qe.key===null?Ue:qe.key),z=y(qe,z,Ue),We===null?Te=qe:We.sibling=qe,We=qe);return s&&we.forEach(function(pr){return r(G,pr)}),Ke&&ui(G,Ue),Te}function Ae(G,z,W,ie){if(W==null)throw Error(i(151));for(var Te=null,We=null,we=z,Ue=z=0,qe=null,Qe=W.next();we!==null&&!Qe.done;Ue++,Qe=W.next()){we.index>Ue?(qe=we,we=null):qe=we.sibling;var pr=J(G,we,Qe.value,ie);if(pr===null){we===null&&(we=qe);break}s&&we&&pr.alternate===null&&r(G,we),z=y(pr,z,Ue),We===null?Te=pr:We.sibling=pr,We=pr,we=qe}if(Qe.done)return o(G,we),Ke&&ui(G,Ue),Te;if(we===null){for(;!Qe.done;Ue++,Qe=W.next())Qe=re(G,Qe.value,ie),Qe!==null&&(z=y(Qe,z,Ue),We===null?Te=Qe:We.sibling=Qe,We=Qe);return Ke&&ui(G,Ue),Te}for(we=u(we);!Qe.done;Ue++,Qe=W.next())Qe=Z(we,G,Ue,Qe.value,ie),Qe!==null&&(s&&Qe.alternate!==null&&we.delete(Qe.key===null?Ue:Qe.key),z=y(Qe,z,Ue),We===null?Te=Qe:We.sibling=Qe,We=Qe);return s&&we.forEach(function(w2){return r(G,w2)}),Ke&&ui(G,Ue),Te}function at(G,z,W,ie){if(typeof W=="object"&&W!==null&&W.type===j&&W.key===null&&(W=W.props.children),typeof W=="object"&&W!==null){switch(W.$$typeof){case S:e:{for(var Te=W.key;z!==null;){if(z.key===Te){if(Te=W.type,Te===j){if(z.tag===7){o(G,z.sibling),ie=g(z,W.props.children),ie.return=G,G=ie;break e}}else if(z.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===C&&da(Te)===z.type){o(G,z.sibling),ie=g(z,W.props),Ql(ie,W),ie.return=G,G=ie;break e}o(G,z);break}else r(G,z);z=z.sibling}W.type===j?(ie=oa(W.props.children,G.mode,ie,W.key),ie.return=G,G=ie):(ie=th(W.type,W.key,W.props,null,G.mode,ie),Ql(ie,W),ie.return=G,G=ie)}return w(G);case N:e:{for(Te=W.key;z!==null;){if(z.key===Te)if(z.tag===4&&z.stateNode.containerInfo===W.containerInfo&&z.stateNode.implementation===W.implementation){o(G,z.sibling),ie=g(z,W.children||[]),ie.return=G,G=ie;break e}else{o(G,z);break}else r(G,z);z=z.sibling}ie=$f(W,G.mode,ie),ie.return=G,G=ie}return w(G);case C:return W=da(W),at(G,z,W,ie)}if(ue(W))return _e(G,z,W,ie);if(q(W)){if(Te=q(W),typeof Te!="function")throw Error(i(150));return W=Te.call(W),Ae(G,z,W,ie)}if(typeof W.then=="function")return at(G,z,lh(W),ie);if(W.$$typeof===B)return at(G,z,ih(G,W),ie);ch(G,W)}return typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint"?(W=""+W,z!==null&&z.tag===6?(o(G,z.sibling),ie=g(z,W),ie.return=G,G=ie):(o(G,z),ie=qf(W,G.mode,ie),ie.return=G,G=ie),w(G)):o(G,z)}return function(G,z,W,ie){try{Wl=0;var Te=at(G,z,W,ie);return mo=null,Te}catch(we){if(we===po||we===ah)throw we;var We=jn(29,we,null,G.mode);return We.lanes=ie,We.return=G,We}finally{}}}var ga=Iy(!0),ky=Iy(!1),Xi=!1;function ng(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function sg(s,r){s=s.updateQueue,r.updateQueue===s&&(r.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Zi(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function er(s,r,o){var u=s.updateQueue;if(u===null)return null;if(u=u.shared,(Xe&2)!==0){var g=u.pending;return g===null?r.next=r:(r.next=g.next,g.next=r),u.pending=r,r=eh(s),gy(s,null,o),r}return Zu(s,u,r,o),eh(s)}function Jl(s,r,o){if(r=r.updateQueue,r!==null&&(r=r.shared,(o&4194048)!==0)){var u=r.lanes;u&=s.pendingLanes,o|=u,r.lanes=o,El(s,o)}}function ig(s,r){var o=s.updateQueue,u=s.alternate;if(u!==null&&(u=u.updateQueue,o===u)){var g=null,y=null;if(o=o.firstBaseUpdate,o!==null){do{var w={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};y===null?g=y=w:y=y.next=w,o=o.next}while(o!==null);y===null?g=y=r:y=y.next=r}else g=y=r;o={baseState:u.baseState,firstBaseUpdate:g,lastBaseUpdate:y,shared:u.shared,callbacks:u.callbacks},s.updateQueue=o;return}s=o.lastBaseUpdate,s===null?o.firstBaseUpdate=r:s.next=r,o.lastBaseUpdate=r}var rg=!1;function Xl(){if(rg){var s=go;if(s!==null)throw s}}function Zl(s,r,o,u){rg=!1;var g=s.updateQueue;Xi=!1;var y=g.firstBaseUpdate,w=g.lastBaseUpdate,E=g.shared.pending;if(E!==null){g.shared.pending=null;var P=E,Q=P.next;P.next=null,w===null?y=Q:w.next=Q,w=P;var ne=s.alternate;ne!==null&&(ne=ne.updateQueue,E=ne.lastBaseUpdate,E!==w&&(E===null?ne.firstBaseUpdate=Q:E.next=Q,ne.lastBaseUpdate=P))}if(y!==null){var re=g.baseState;w=0,ne=Q=P=null,E=y;do{var J=E.lane&-536870913,Z=J!==E.lane;if(Z?(He&J)===J:(u&J)===J){J!==0&&J===fo&&(rg=!0),ne!==null&&(ne=ne.next={lane:0,tag:E.tag,payload:E.payload,callback:null,next:null});e:{var _e=s,Ae=E;J=r;var at=o;switch(Ae.tag){case 1:if(_e=Ae.payload,typeof _e=="function"){re=_e.call(at,re,J);break e}re=_e;break e;case 3:_e.flags=_e.flags&-65537|128;case 0:if(_e=Ae.payload,J=typeof _e=="function"?_e.call(at,re,J):_e,J==null)break e;re=b({},re,J);break e;case 2:Xi=!0}}J=E.callback,J!==null&&(s.flags|=64,Z&&(s.flags|=8192),Z=g.callbacks,Z===null?g.callbacks=[J]:Z.push(J))}else Z={lane:J,tag:E.tag,payload:E.payload,callback:E.callback,next:null},ne===null?(Q=ne=Z,P=re):ne=ne.next=Z,w|=J;if(E=E.next,E===null){if(E=g.shared.pending,E===null)break;Z=E,E=Z.next,Z.next=null,g.lastBaseUpdate=Z,g.shared.pending=null}}while(!0);ne===null&&(P=re),g.baseState=P,g.firstBaseUpdate=Q,g.lastBaseUpdate=ne,y===null&&(g.shared.lanes=0),rr|=w,s.lanes=w,s.memoizedState=re}}function Oy(s,r){if(typeof s!="function")throw Error(i(191,s));s.call(r)}function jy(s,r){var o=s.callbacks;if(o!==null)for(s.callbacks=null,s=0;s<o.length;s++)Oy(o[s],r)}var yo=V(null),uh=V(0);function Dy(s,r){s=wi,de(uh,s),de(yo,r),wi=s|r.baseLanes}function ag(){de(uh,wi),de(yo,yo.current)}function og(){wi=uh.current,te(yo),te(uh)}var Dn=V(null),Xn=null;function tr(s){var r=s.alternate;de(Et,Et.current&1),de(Dn,s),Xn===null&&(r===null||yo.current!==null||r.memoizedState!==null)&&(Xn=s)}function lg(s){de(Et,Et.current),de(Dn,s),Xn===null&&(Xn=s)}function Py(s){s.tag===22?(de(Et,Et.current),de(Dn,s),Xn===null&&(Xn=s)):nr()}function nr(){de(Et,Et.current),de(Dn,Dn.current)}function Pn(s){te(Dn),Xn===s&&(Xn=null),te(Et)}var Et=V(0);function hh(s){for(var r=s;r!==null;){if(r.tag===13){var o=r.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||gp(o)||pp(o)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var fi=0,Me=null,it=null,Dt=null,dh=!1,vo=!1,pa=!1,fh=0,ec=0,_o=null,hA=0;function vt(){throw Error(i(321))}function cg(s,r){if(r===null)return!1;for(var o=0;o<r.length&&o<s.length;o++)if(!On(s[o],r[o]))return!1;return!0}function ug(s,r,o,u,g,y){return fi=y,Me=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,U.H=s===null||s.memoizedState===null?vv:Sg,pa=!1,y=o(u,g),pa=!1,vo&&(y=Ly(r,o,u,g)),My(s),y}function My(s){U.H=sc;var r=it!==null&&it.next!==null;if(fi=0,Dt=it=Me=null,dh=!1,ec=0,_o=null,r)throw Error(i(300));s===null||Pt||(s=s.dependencies,s!==null&&sh(s)&&(Pt=!0))}function Ly(s,r,o,u){Me=s;var g=0;do{if(vo&&(_o=null),ec=0,vo=!1,25<=g)throw Error(i(301));if(g+=1,Dt=it=null,s.updateQueue!=null){var y=s.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}U.H=_v,y=r(o,u)}while(vo);return y}function dA(){var s=U.H,r=s.useState()[0];return r=typeof r.then=="function"?tc(r):r,s=s.useState()[0],(it!==null?it.memoizedState:null)!==s&&(Me.flags|=1024),r}function hg(){var s=fh!==0;return fh=0,s}function dg(s,r,o){r.updateQueue=s.updateQueue,r.flags&=-2053,s.lanes&=~o}function fg(s){if(dh){for(s=s.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}dh=!1}fi=0,Dt=it=Me=null,vo=!1,ec=fh=0,_o=null}function mn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Dt===null?Me.memoizedState=Dt=s:Dt=Dt.next=s,Dt}function St(){if(it===null){var s=Me.alternate;s=s!==null?s.memoizedState:null}else s=it.next;var r=Dt===null?Me.memoizedState:Dt.next;if(r!==null)Dt=r,it=s;else{if(s===null)throw Me.alternate===null?Error(i(467)):Error(i(310));it=s,s={memoizedState:it.memoizedState,baseState:it.baseState,baseQueue:it.baseQueue,queue:it.queue,next:null},Dt===null?Me.memoizedState=Dt=s:Dt=Dt.next=s}return Dt}function gh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function tc(s){var r=ec;return ec+=1,_o===null&&(_o=[]),s=Ny(_o,s,r),r=Me,(Dt===null?r.memoizedState:Dt.next)===null&&(r=r.alternate,U.H=r===null||r.memoizedState===null?vv:Sg),s}function ph(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return tc(s);if(s.$$typeof===B)return Zt(s)}throw Error(i(438,String(s)))}function gg(s){var r=null,o=Me.updateQueue;if(o!==null&&(r=o.memoCache),r==null){var u=Me.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(r={data:u.data.map(function(g){return g.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),o===null&&(o=gh(),Me.updateQueue=o),o.memoCache=r,o=r.data[r.index],o===void 0)for(o=r.data[r.index]=Array(s),u=0;u<s;u++)o[u]=D;return r.index++,o}function gi(s,r){return typeof r=="function"?r(s):r}function mh(s){var r=St();return pg(r,it,s)}function pg(s,r,o){var u=s.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=o;var g=s.baseQueue,y=u.pending;if(y!==null){if(g!==null){var w=g.next;g.next=y.next,y.next=w}r.baseQueue=g=y,u.pending=null}if(y=s.baseState,g===null)s.memoizedState=y;else{r=g.next;var E=w=null,P=null,Q=r,ne=!1;do{var re=Q.lane&-536870913;if(re!==Q.lane?(He&re)===re:(fi&re)===re){var J=Q.revertLane;if(J===0)P!==null&&(P=P.next={lane:0,revertLane:0,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null}),re===fo&&(ne=!0);else if((fi&J)===J){Q=Q.next,J===fo&&(ne=!0);continue}else re={lane:0,revertLane:Q.revertLane,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},P===null?(E=P=re,w=y):P=P.next=re,Me.lanes|=J,rr|=J;re=Q.action,pa&&o(y,re),y=Q.hasEagerState?Q.eagerState:o(y,re)}else J={lane:re,revertLane:Q.revertLane,gesture:Q.gesture,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},P===null?(E=P=J,w=y):P=P.next=J,Me.lanes|=re,rr|=re;Q=Q.next}while(Q!==null&&Q!==r);if(P===null?w=y:P.next=E,!On(y,s.memoizedState)&&(Pt=!0,ne&&(o=go,o!==null)))throw o;s.memoizedState=y,s.baseState=w,s.baseQueue=P,u.lastRenderedState=y}return g===null&&(u.lanes=0),[s.memoizedState,u.dispatch]}function mg(s){var r=St(),o=r.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=s;var u=o.dispatch,g=o.pending,y=r.memoizedState;if(g!==null){o.pending=null;var w=g=g.next;do y=s(y,w.action),w=w.next;while(w!==g);On(y,r.memoizedState)||(Pt=!0),r.memoizedState=y,r.baseQueue===null&&(r.baseState=y),o.lastRenderedState=y}return[y,u]}function Uy(s,r,o){var u=Me,g=St(),y=Ke;if(y){if(o===void 0)throw Error(i(407));o=o()}else o=r();var w=!On((it||g).memoizedState,o);if(w&&(g.memoizedState=o,Pt=!0),g=g.queue,_g(zy.bind(null,u,g,s),[s]),g.getSnapshot!==r||w||Dt!==null&&Dt.memoizedState.tag&1){if(u.flags|=2048,bo(9,{destroy:void 0},By.bind(null,u,g,o,r),null),ot===null)throw Error(i(349));y||(fi&127)!==0||Vy(u,r,o)}return o}function Vy(s,r,o){s.flags|=16384,s={getSnapshot:r,value:o},r=Me.updateQueue,r===null?(r=gh(),Me.updateQueue=r,r.stores=[s]):(o=r.stores,o===null?r.stores=[s]:o.push(s))}function By(s,r,o,u){r.value=o,r.getSnapshot=u,Hy(r)&&qy(s)}function zy(s,r,o){return o(function(){Hy(r)&&qy(s)})}function Hy(s){var r=s.getSnapshot;s=s.value;try{var o=r();return!On(s,o)}catch{return!0}}function qy(s){var r=aa(s,2);r!==null&&En(r,s,2)}function yg(s){var r=mn();if(typeof s=="function"){var o=s;if(s=o(),pa){Hn(!0);try{o()}finally{Hn(!1)}}}return r.memoizedState=r.baseState=s,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:gi,lastRenderedState:s},r}function $y(s,r,o,u){return s.baseState=o,pg(s,it,typeof u=="function"?u:gi)}function fA(s,r,o,u,g){if(_h(s))throw Error(i(485));if(s=r.action,s!==null){var y={payload:g,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(w){y.listeners.push(w)}};U.T!==null?o(!0):y.isTransition=!1,u(y),o=r.pending,o===null?(y.next=r.pending=y,Gy(r,y)):(y.next=o.next,r.pending=o.next=y)}}function Gy(s,r){var o=r.action,u=r.payload,g=s.state;if(r.isTransition){var y=U.T,w={};U.T=w;try{var E=o(g,u),P=U.S;P!==null&&P(w,E),Fy(s,r,E)}catch(Q){vg(s,r,Q)}finally{y!==null&&w.types!==null&&(y.types=w.types),U.T=y}}else try{y=o(g,u),Fy(s,r,y)}catch(Q){vg(s,r,Q)}}function Fy(s,r,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(u){Ky(s,r,u)},function(u){return vg(s,r,u)}):Ky(s,r,o)}function Ky(s,r,o){r.status="fulfilled",r.value=o,Yy(r),s.state=o,r=s.pending,r!==null&&(o=r.next,o===r?s.pending=null:(o=o.next,r.next=o,Gy(s,o)))}function vg(s,r,o){var u=s.pending;if(s.pending=null,u!==null){u=u.next;do r.status="rejected",r.reason=o,Yy(r),r=r.next;while(r!==u)}s.action=null}function Yy(s){s=s.listeners;for(var r=0;r<s.length;r++)(0,s[r])()}function Wy(s,r){return r}function Qy(s,r){if(Ke){var o=ot.formState;if(o!==null){e:{var u=Me;if(Ke){if(ut){t:{for(var g=ut,y=Jn;g.nodeType!==8;){if(!y){g=null;break t}if(g=Zn(g.nextSibling),g===null){g=null;break t}}y=g.data,g=y==="F!"||y==="F"?g:null}if(g){ut=Zn(g.nextSibling),u=g.data==="F!";break e}}Qi(u)}u=!1}u&&(r=o[0])}}return o=mn(),o.memoizedState=o.baseState=r,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wy,lastRenderedState:r},o.queue=u,o=pv.bind(null,Me,u),u.dispatch=o,u=yg(!1),y=Eg.bind(null,Me,!1,u.queue),u=mn(),g={state:r,dispatch:null,action:s,pending:null},u.queue=g,o=fA.bind(null,Me,g,y,o),g.dispatch=o,u.memoizedState=s,[r,o,!1]}function Jy(s){var r=St();return Xy(r,it,s)}function Xy(s,r,o){if(r=pg(s,r,Wy)[0],s=mh(gi)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var u=tc(r)}catch(w){throw w===po?ah:w}else u=r;r=St();var g=r.queue,y=g.dispatch;return o!==r.memoizedState&&(Me.flags|=2048,bo(9,{destroy:void 0},gA.bind(null,g,o),null)),[u,y,s]}function gA(s,r){s.action=r}function Zy(s){var r=St(),o=it;if(o!==null)return Xy(r,o,s);St(),r=r.memoizedState,o=St();var u=o.queue.dispatch;return o.memoizedState=s,[r,u,!1]}function bo(s,r,o,u){return s={tag:s,create:o,deps:u,inst:r,next:null},r=Me.updateQueue,r===null&&(r=gh(),Me.updateQueue=r),o=r.lastEffect,o===null?r.lastEffect=s.next=s:(u=o.next,o.next=s,s.next=u,r.lastEffect=s),s}function ev(){return St().memoizedState}function yh(s,r,o,u){var g=mn();Me.flags|=s,g.memoizedState=bo(1|r,{destroy:void 0},o,u===void 0?null:u)}function vh(s,r,o,u){var g=St();u=u===void 0?null:u;var y=g.memoizedState.inst;it!==null&&u!==null&&cg(u,it.memoizedState.deps)?g.memoizedState=bo(r,y,o,u):(Me.flags|=s,g.memoizedState=bo(1|r,y,o,u))}function tv(s,r){yh(8390656,8,s,r)}function _g(s,r){vh(2048,8,s,r)}function pA(s){Me.flags|=4;var r=Me.updateQueue;if(r===null)r=gh(),Me.updateQueue=r,r.events=[s];else{var o=r.events;o===null?r.events=[s]:o.push(s)}}function nv(s){var r=St().memoizedState;return pA({ref:r,nextImpl:s}),function(){if((Xe&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function sv(s,r){return vh(4,2,s,r)}function iv(s,r){return vh(4,4,s,r)}function rv(s,r){if(typeof r=="function"){s=s();var o=r(s);return function(){typeof o=="function"?o():r(null)}}if(r!=null)return s=s(),r.current=s,function(){r.current=null}}function av(s,r,o){o=o!=null?o.concat([s]):null,vh(4,4,rv.bind(null,r,s),o)}function bg(){}function ov(s,r){var o=St();r=r===void 0?null:r;var u=o.memoizedState;return r!==null&&cg(r,u[1])?u[0]:(o.memoizedState=[s,r],s)}function lv(s,r){var o=St();r=r===void 0?null:r;var u=o.memoizedState;if(r!==null&&cg(r,u[1]))return u[0];if(u=s(),pa){Hn(!0);try{s()}finally{Hn(!1)}}return o.memoizedState=[u,r],u}function wg(s,r,o){return o===void 0||(fi&1073741824)!==0&&(He&261930)===0?s.memoizedState=r:(s.memoizedState=o,s=c_(),Me.lanes|=s,rr|=s,o)}function cv(s,r,o,u){return On(o,r)?o:yo.current!==null?(s=wg(s,o,u),On(s,r)||(Pt=!0),s):(fi&42)===0||(fi&1073741824)!==0&&(He&261930)===0?(Pt=!0,s.memoizedState=o):(s=c_(),Me.lanes|=s,rr|=s,r)}function uv(s,r,o,u,g){var y=se.p;se.p=y!==0&&8>y?y:8;var w=U.T,E={};U.T=E,Eg(s,!1,r,o);try{var P=g(),Q=U.S;if(Q!==null&&Q(E,P),P!==null&&typeof P=="object"&&typeof P.then=="function"){var ne=uA(P,u);nc(s,r,ne,Un(s))}else nc(s,r,u,Un(s))}catch(re){nc(s,r,{then:function(){},status:"rejected",reason:re},Un())}finally{se.p=y,w!==null&&E.types!==null&&(w.types=E.types),U.T=w}}function mA(){}function xg(s,r,o,u){if(s.tag!==5)throw Error(i(476));var g=hv(s).queue;uv(s,g,r,pe,o===null?mA:function(){return dv(s),o(u)})}function hv(s){var r=s.memoizedState;if(r!==null)return r;r={memoizedState:pe,baseState:pe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:gi,lastRenderedState:pe},next:null};var o={};return r.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:gi,lastRenderedState:o},next:null},s.memoizedState=r,s=s.alternate,s!==null&&(s.memoizedState=r),r}function dv(s){var r=hv(s);r.next===null&&(r=s.alternate.memoizedState),nc(s,r.next.queue,{},Un())}function Tg(){return Zt(_c)}function fv(){return St().memoizedState}function gv(){return St().memoizedState}function yA(s){for(var r=s.return;r!==null;){switch(r.tag){case 24:case 3:var o=Un();s=Zi(o);var u=er(r,s,o);u!==null&&(En(u,r,o),Jl(u,r,o)),r={cache:Xf()},s.payload=r;return}r=r.return}}function vA(s,r,o){var u=Un();o={lane:u,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},_h(s)?mv(r,o):(o=zf(s,r,o,u),o!==null&&(En(o,s,u),yv(o,r,u)))}function pv(s,r,o){var u=Un();nc(s,r,o,u)}function nc(s,r,o,u){var g={lane:u,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(_h(s))mv(r,g);else{var y=s.alternate;if(s.lanes===0&&(y===null||y.lanes===0)&&(y=r.lastRenderedReducer,y!==null))try{var w=r.lastRenderedState,E=y(w,o);if(g.hasEagerState=!0,g.eagerState=E,On(E,w))return Zu(s,r,g,0),ot===null&&Xu(),!1}catch{}finally{}if(o=zf(s,r,g,u),o!==null)return En(o,s,u),yv(o,r,u),!0}return!1}function Eg(s,r,o,u){if(u={lane:2,revertLane:np(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},_h(s)){if(r)throw Error(i(479))}else r=zf(s,o,u,2),r!==null&&En(r,s,2)}function _h(s){var r=s.alternate;return s===Me||r!==null&&r===Me}function mv(s,r){vo=dh=!0;var o=s.pending;o===null?r.next=r:(r.next=o.next,o.next=r),s.pending=r}function yv(s,r,o){if((o&4194048)!==0){var u=r.lanes;u&=s.pendingLanes,o|=u,r.lanes=o,El(s,o)}}var sc={readContext:Zt,use:ph,useCallback:vt,useContext:vt,useEffect:vt,useImperativeHandle:vt,useLayoutEffect:vt,useInsertionEffect:vt,useMemo:vt,useReducer:vt,useRef:vt,useState:vt,useDebugValue:vt,useDeferredValue:vt,useTransition:vt,useSyncExternalStore:vt,useId:vt,useHostTransitionStatus:vt,useFormState:vt,useActionState:vt,useOptimistic:vt,useMemoCache:vt,useCacheRefresh:vt};sc.useEffectEvent=vt;var vv={readContext:Zt,use:ph,useCallback:function(s,r){return mn().memoizedState=[s,r===void 0?null:r],s},useContext:Zt,useEffect:tv,useImperativeHandle:function(s,r,o){o=o!=null?o.concat([s]):null,yh(4194308,4,rv.bind(null,r,s),o)},useLayoutEffect:function(s,r){return yh(4194308,4,s,r)},useInsertionEffect:function(s,r){yh(4,2,s,r)},useMemo:function(s,r){var o=mn();r=r===void 0?null:r;var u=s();if(pa){Hn(!0);try{s()}finally{Hn(!1)}}return o.memoizedState=[u,r],u},useReducer:function(s,r,o){var u=mn();if(o!==void 0){var g=o(r);if(pa){Hn(!0);try{o(r)}finally{Hn(!1)}}}else g=r;return u.memoizedState=u.baseState=g,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:g},u.queue=s,s=s.dispatch=vA.bind(null,Me,s),[u.memoizedState,s]},useRef:function(s){var r=mn();return s={current:s},r.memoizedState=s},useState:function(s){s=yg(s);var r=s.queue,o=pv.bind(null,Me,r);return r.dispatch=o,[s.memoizedState,o]},useDebugValue:bg,useDeferredValue:function(s,r){var o=mn();return wg(o,s,r)},useTransition:function(){var s=yg(!1);return s=uv.bind(null,Me,s.queue,!0,!1),mn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,r,o){var u=Me,g=mn();if(Ke){if(o===void 0)throw Error(i(407));o=o()}else{if(o=r(),ot===null)throw Error(i(349));(He&127)!==0||Vy(u,r,o)}g.memoizedState=o;var y={value:o,getSnapshot:r};return g.queue=y,tv(zy.bind(null,u,y,s),[s]),u.flags|=2048,bo(9,{destroy:void 0},By.bind(null,u,y,o,r),null),o},useId:function(){var s=mn(),r=ot.identifierPrefix;if(Ke){var o=Fs,u=Gs;o=(u&~(1<<32-xt(u)-1)).toString(32)+o,r="_"+r+"R_"+o,o=fh++,0<o&&(r+="H"+o.toString(32)),r+="_"}else o=hA++,r="_"+r+"r_"+o.toString(32)+"_";return s.memoizedState=r},useHostTransitionStatus:Tg,useFormState:Qy,useActionState:Qy,useOptimistic:function(s){var r=mn();r.memoizedState=r.baseState=s;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=o,r=Eg.bind(null,Me,!0,o),o.dispatch=r,[s,r]},useMemoCache:gg,useCacheRefresh:function(){return mn().memoizedState=yA.bind(null,Me)},useEffectEvent:function(s){var r=mn(),o={impl:s};return r.memoizedState=o,function(){if((Xe&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},Sg={readContext:Zt,use:ph,useCallback:ov,useContext:Zt,useEffect:_g,useImperativeHandle:av,useInsertionEffect:sv,useLayoutEffect:iv,useMemo:lv,useReducer:mh,useRef:ev,useState:function(){return mh(gi)},useDebugValue:bg,useDeferredValue:function(s,r){var o=St();return cv(o,it.memoizedState,s,r)},useTransition:function(){var s=mh(gi)[0],r=St().memoizedState;return[typeof s=="boolean"?s:tc(s),r]},useSyncExternalStore:Uy,useId:fv,useHostTransitionStatus:Tg,useFormState:Jy,useActionState:Jy,useOptimistic:function(s,r){var o=St();return $y(o,it,s,r)},useMemoCache:gg,useCacheRefresh:gv};Sg.useEffectEvent=nv;var _v={readContext:Zt,use:ph,useCallback:ov,useContext:Zt,useEffect:_g,useImperativeHandle:av,useInsertionEffect:sv,useLayoutEffect:iv,useMemo:lv,useReducer:mg,useRef:ev,useState:function(){return mg(gi)},useDebugValue:bg,useDeferredValue:function(s,r){var o=St();return it===null?wg(o,s,r):cv(o,it.memoizedState,s,r)},useTransition:function(){var s=mg(gi)[0],r=St().memoizedState;return[typeof s=="boolean"?s:tc(s),r]},useSyncExternalStore:Uy,useId:fv,useHostTransitionStatus:Tg,useFormState:Zy,useActionState:Zy,useOptimistic:function(s,r){var o=St();return it!==null?$y(o,it,s,r):(o.baseState=s,[s,o.queue.dispatch])},useMemoCache:gg,useCacheRefresh:gv};_v.useEffectEvent=nv;function Ag(s,r,o,u){r=s.memoizedState,o=o(u,r),o=o==null?r:b({},r,o),s.memoizedState=o,s.lanes===0&&(s.updateQueue.baseState=o)}var Ng={enqueueSetState:function(s,r,o){s=s._reactInternals;var u=Un(),g=Zi(u);g.payload=r,o!=null&&(g.callback=o),r=er(s,g,u),r!==null&&(En(r,s,u),Jl(r,s,u))},enqueueReplaceState:function(s,r,o){s=s._reactInternals;var u=Un(),g=Zi(u);g.tag=1,g.payload=r,o!=null&&(g.callback=o),r=er(s,g,u),r!==null&&(En(r,s,u),Jl(r,s,u))},enqueueForceUpdate:function(s,r){s=s._reactInternals;var o=Un(),u=Zi(o);u.tag=2,r!=null&&(u.callback=r),r=er(s,u,o),r!==null&&(En(r,s,o),Jl(r,s,o))}};function bv(s,r,o,u,g,y,w){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(u,y,w):r.prototype&&r.prototype.isPureReactComponent?!ql(o,u)||!ql(g,y):!0}function wv(s,r,o,u){s=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(o,u),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(o,u),r.state!==s&&Ng.enqueueReplaceState(r,r.state,null)}function ma(s,r){var o=r;if("ref"in r){o={};for(var u in r)u!=="ref"&&(o[u]=r[u])}if(s=s.defaultProps){o===r&&(o=b({},o));for(var g in s)o[g]===void 0&&(o[g]=s[g])}return o}function xv(s){Ju(s)}function Tv(s){console.error(s)}function Ev(s){Ju(s)}function bh(s,r){try{var o=s.onUncaughtError;o(r.value,{componentStack:r.stack})}catch(u){setTimeout(function(){throw u})}}function Sv(s,r,o){try{var u=s.onCaughtError;u(o.value,{componentStack:o.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function Cg(s,r,o){return o=Zi(o),o.tag=3,o.payload={element:null},o.callback=function(){bh(s,r)},o}function Av(s){return s=Zi(s),s.tag=3,s}function Nv(s,r,o,u){var g=o.type.getDerivedStateFromError;if(typeof g=="function"){var y=u.value;s.payload=function(){return g(y)},s.callback=function(){Sv(r,o,u)}}var w=o.stateNode;w!==null&&typeof w.componentDidCatch=="function"&&(s.callback=function(){Sv(r,o,u),typeof g!="function"&&(ar===null?ar=new Set([this]):ar.add(this));var E=u.stack;this.componentDidCatch(u.value,{componentStack:E!==null?E:""})})}function _A(s,r,o,u,g){if(o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(r=o.alternate,r!==null&&ho(r,o,g,!0),o=Dn.current,o!==null){switch(o.tag){case 31:case 13:return Xn===null?Oh():o.alternate===null&&_t===0&&(_t=3),o.flags&=-257,o.flags|=65536,o.lanes=g,u===oh?o.flags|=16384:(r=o.updateQueue,r===null?o.updateQueue=new Set([u]):r.add(u),Zg(s,u,g)),!1;case 22:return o.flags|=65536,u===oh?o.flags|=16384:(r=o.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([u])},o.updateQueue=r):(o=r.retryQueue,o===null?r.retryQueue=new Set([u]):o.add(u)),Zg(s,u,g)),!1}throw Error(i(435,o.tag))}return Zg(s,u,g),Oh(),!1}if(Ke)return r=Dn.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=g,u!==Kf&&(s=Error(i(422),{cause:u}),Fl(Yn(s,o)))):(u!==Kf&&(r=Error(i(423),{cause:u}),Fl(Yn(r,o))),s=s.current.alternate,s.flags|=65536,g&=-g,s.lanes|=g,u=Yn(u,o),g=Cg(s.stateNode,u,g),ig(s,g),_t!==4&&(_t=2)),!1;var y=Error(i(520),{cause:u});if(y=Yn(y,o),hc===null?hc=[y]:hc.push(y),_t!==4&&(_t=2),r===null)return!0;u=Yn(u,o),o=r;do{switch(o.tag){case 3:return o.flags|=65536,s=g&-g,o.lanes|=s,s=Cg(o.stateNode,u,s),ig(o,s),!1;case 1:if(r=o.type,y=o.stateNode,(o.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(ar===null||!ar.has(y))))return o.flags|=65536,g&=-g,o.lanes|=g,g=Av(g),Nv(g,s,o,u),ig(o,g),!1}o=o.return}while(o!==null);return!1}var Rg=Error(i(461)),Pt=!1;function en(s,r,o,u){r.child=s===null?ky(r,null,o,u):ga(r,s.child,o,u)}function Cv(s,r,o,u,g){o=o.render;var y=r.ref;if("ref"in u){var w={};for(var E in u)E!=="ref"&&(w[E]=u[E])}else w=u;return ua(r),u=ug(s,r,o,w,y,g),E=hg(),s!==null&&!Pt?(dg(s,r,g),pi(s,r,g)):(Ke&&E&&Gf(r),r.flags|=1,en(s,r,u,g),r.child)}function Rv(s,r,o,u,g){if(s===null){var y=o.type;return typeof y=="function"&&!Hf(y)&&y.defaultProps===void 0&&o.compare===null?(r.tag=15,r.type=y,Iv(s,r,y,u,g)):(s=th(o.type,null,u,r,r.mode,g),s.ref=r.ref,s.return=r,r.child=s)}if(y=s.child,!Lg(s,g)){var w=y.memoizedProps;if(o=o.compare,o=o!==null?o:ql,o(w,u)&&s.ref===r.ref)return pi(s,r,g)}return r.flags|=1,s=ci(y,u),s.ref=r.ref,s.return=r,r.child=s}function Iv(s,r,o,u,g){if(s!==null){var y=s.memoizedProps;if(ql(y,u)&&s.ref===r.ref)if(Pt=!1,r.pendingProps=u=y,Lg(s,g))(s.flags&131072)!==0&&(Pt=!0);else return r.lanes=s.lanes,pi(s,r,g)}return Ig(s,r,o,u,g)}function kv(s,r,o,u){var g=u.children,y=s!==null?s.memoizedState:null;if(s===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((r.flags&128)!==0){if(y=y!==null?y.baseLanes|o:o,s!==null){for(u=r.child=s.child,g=0;u!==null;)g=g|u.lanes|u.childLanes,u=u.sibling;u=g&~y}else u=0,r.child=null;return Ov(s,r,y,o,u)}if((o&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},s!==null&&rh(r,y!==null?y.cachePool:null),y!==null?Dy(r,y):ag(),Py(r);else return u=r.lanes=536870912,Ov(s,r,y!==null?y.baseLanes|o:o,o,u)}else y!==null?(rh(r,y.cachePool),Dy(r,y),nr(),r.memoizedState=null):(s!==null&&rh(r,null),ag(),nr());return en(s,r,g,o),r.child}function ic(s,r){return s!==null&&s.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function Ov(s,r,o,u,g){var y=eg();return y=y===null?null:{parent:jt._currentValue,pool:y},r.memoizedState={baseLanes:o,cachePool:y},s!==null&&rh(r,null),ag(),Py(r),s!==null&&ho(s,r,u,!0),r.childLanes=g,null}function wh(s,r){return r=Th({mode:r.mode,children:r.children},s.mode),r.ref=s.ref,s.child=r,r.return=s,r}function jv(s,r,o){return ga(r,s.child,null,o),s=wh(r,r.pendingProps),s.flags|=2,Pn(r),r.memoizedState=null,s}function bA(s,r,o){var u=r.pendingProps,g=(r.flags&128)!==0;if(r.flags&=-129,s===null){if(Ke){if(u.mode==="hidden")return s=wh(r,u),r.lanes=536870912,ic(null,s);if(lg(r),(s=ut)?(s=G_(s,Jn),s=s!==null&&s.data==="&"?s:null,s!==null&&(r.memoizedState={dehydrated:s,treeContext:Yi!==null?{id:Gs,overflow:Fs}:null,retryLane:536870912,hydrationErrors:null},o=my(s),o.return=r,r.child=o,Xt=r,ut=null)):s=null,s===null)throw Qi(r);return r.lanes=536870912,null}return wh(r,u)}var y=s.memoizedState;if(y!==null){var w=y.dehydrated;if(lg(r),g)if(r.flags&256)r.flags&=-257,r=jv(s,r,o);else if(r.memoizedState!==null)r.child=s.child,r.flags|=128,r=null;else throw Error(i(558));else if(Pt||ho(s,r,o,!1),g=(o&s.childLanes)!==0,Pt||g){if(u=ot,u!==null&&(w=Sl(u,o),w!==0&&w!==y.retryLane))throw y.retryLane=w,aa(s,w),En(u,s,w),Rg;Oh(),r=jv(s,r,o)}else s=y.treeContext,ut=Zn(w.nextSibling),Xt=r,Ke=!0,Wi=null,Jn=!1,s!==null&&_y(r,s),r=wh(r,u),r.flags|=4096;return r}return s=ci(s.child,{mode:u.mode,children:u.children}),s.ref=r.ref,r.child=s,s.return=r,s}function xh(s,r){var o=r.ref;if(o===null)s!==null&&s.ref!==null&&(r.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(s===null||s.ref!==o)&&(r.flags|=4194816)}}function Ig(s,r,o,u,g){return ua(r),o=ug(s,r,o,u,void 0,g),u=hg(),s!==null&&!Pt?(dg(s,r,g),pi(s,r,g)):(Ke&&u&&Gf(r),r.flags|=1,en(s,r,o,g),r.child)}function Dv(s,r,o,u,g,y){return ua(r),r.updateQueue=null,o=Ly(r,u,o,g),My(s),u=hg(),s!==null&&!Pt?(dg(s,r,y),pi(s,r,y)):(Ke&&u&&Gf(r),r.flags|=1,en(s,r,o,y),r.child)}function Pv(s,r,o,u,g){if(ua(r),r.stateNode===null){var y=oo,w=o.contextType;typeof w=="object"&&w!==null&&(y=Zt(w)),y=new o(u,y),r.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=Ng,r.stateNode=y,y._reactInternals=r,y=r.stateNode,y.props=u,y.state=r.memoizedState,y.refs={},ng(r),w=o.contextType,y.context=typeof w=="object"&&w!==null?Zt(w):oo,y.state=r.memoizedState,w=o.getDerivedStateFromProps,typeof w=="function"&&(Ag(r,o,w,u),y.state=r.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(w=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),w!==y.state&&Ng.enqueueReplaceState(y,y.state,null),Zl(r,u,y,g),Xl(),y.state=r.memoizedState),typeof y.componentDidMount=="function"&&(r.flags|=4194308),u=!0}else if(s===null){y=r.stateNode;var E=r.memoizedProps,P=ma(o,E);y.props=P;var Q=y.context,ne=o.contextType;w=oo,typeof ne=="object"&&ne!==null&&(w=Zt(ne));var re=o.getDerivedStateFromProps;ne=typeof re=="function"||typeof y.getSnapshotBeforeUpdate=="function",E=r.pendingProps!==E,ne||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(E||Q!==w)&&wv(r,y,u,w),Xi=!1;var J=r.memoizedState;y.state=J,Zl(r,u,y,g),Xl(),Q=r.memoizedState,E||J!==Q||Xi?(typeof re=="function"&&(Ag(r,o,re,u),Q=r.memoizedState),(P=Xi||bv(r,o,P,u,J,Q,w))?(ne||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(r.flags|=4194308)):(typeof y.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=u,r.memoizedState=Q),y.props=u,y.state=Q,y.context=w,u=P):(typeof y.componentDidMount=="function"&&(r.flags|=4194308),u=!1)}else{y=r.stateNode,sg(s,r),w=r.memoizedProps,ne=ma(o,w),y.props=ne,re=r.pendingProps,J=y.context,Q=o.contextType,P=oo,typeof Q=="object"&&Q!==null&&(P=Zt(Q)),E=o.getDerivedStateFromProps,(Q=typeof E=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(w!==re||J!==P)&&wv(r,y,u,P),Xi=!1,J=r.memoizedState,y.state=J,Zl(r,u,y,g),Xl();var Z=r.memoizedState;w!==re||J!==Z||Xi||s!==null&&s.dependencies!==null&&sh(s.dependencies)?(typeof E=="function"&&(Ag(r,o,E,u),Z=r.memoizedState),(ne=Xi||bv(r,o,ne,u,J,Z,P)||s!==null&&s.dependencies!==null&&sh(s.dependencies))?(Q||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(u,Z,P),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(u,Z,P)),typeof y.componentDidUpdate=="function"&&(r.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof y.componentDidUpdate!="function"||w===s.memoizedProps&&J===s.memoizedState||(r.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||w===s.memoizedProps&&J===s.memoizedState||(r.flags|=1024),r.memoizedProps=u,r.memoizedState=Z),y.props=u,y.state=Z,y.context=P,u=ne):(typeof y.componentDidUpdate!="function"||w===s.memoizedProps&&J===s.memoizedState||(r.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||w===s.memoizedProps&&J===s.memoizedState||(r.flags|=1024),u=!1)}return y=u,xh(s,r),u=(r.flags&128)!==0,y||u?(y=r.stateNode,o=u&&typeof o.getDerivedStateFromError!="function"?null:y.render(),r.flags|=1,s!==null&&u?(r.child=ga(r,s.child,null,g),r.child=ga(r,null,o,g)):en(s,r,o,g),r.memoizedState=y.state,s=r.child):s=pi(s,r,g),s}function Mv(s,r,o,u){return la(),r.flags|=256,en(s,r,o,u),r.child}var kg={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Og(s){return{baseLanes:s,cachePool:Sy()}}function jg(s,r,o){return s=s!==null?s.childLanes&~o:0,r&&(s|=Ln),s}function Lv(s,r,o){var u=r.pendingProps,g=!1,y=(r.flags&128)!==0,w;if((w=y)||(w=s!==null&&s.memoizedState===null?!1:(Et.current&2)!==0),w&&(g=!0,r.flags&=-129),w=(r.flags&32)!==0,r.flags&=-33,s===null){if(Ke){if(g?tr(r):nr(),(s=ut)?(s=G_(s,Jn),s=s!==null&&s.data!=="&"?s:null,s!==null&&(r.memoizedState={dehydrated:s,treeContext:Yi!==null?{id:Gs,overflow:Fs}:null,retryLane:536870912,hydrationErrors:null},o=my(s),o.return=r,r.child=o,Xt=r,ut=null)):s=null,s===null)throw Qi(r);return pp(s)?r.lanes=32:r.lanes=536870912,null}var E=u.children;return u=u.fallback,g?(nr(),g=r.mode,E=Th({mode:"hidden",children:E},g),u=oa(u,g,o,null),E.return=r,u.return=r,E.sibling=u,r.child=E,u=r.child,u.memoizedState=Og(o),u.childLanes=jg(s,w,o),r.memoizedState=kg,ic(null,u)):(tr(r),Dg(r,E))}var P=s.memoizedState;if(P!==null&&(E=P.dehydrated,E!==null)){if(y)r.flags&256?(tr(r),r.flags&=-257,r=Pg(s,r,o)):r.memoizedState!==null?(nr(),r.child=s.child,r.flags|=128,r=null):(nr(),E=u.fallback,g=r.mode,u=Th({mode:"visible",children:u.children},g),E=oa(E,g,o,null),E.flags|=2,u.return=r,E.return=r,u.sibling=E,r.child=u,ga(r,s.child,null,o),u=r.child,u.memoizedState=Og(o),u.childLanes=jg(s,w,o),r.memoizedState=kg,r=ic(null,u));else if(tr(r),pp(E)){if(w=E.nextSibling&&E.nextSibling.dataset,w)var Q=w.dgst;w=Q,u=Error(i(419)),u.stack="",u.digest=w,Fl({value:u,source:null,stack:null}),r=Pg(s,r,o)}else if(Pt||ho(s,r,o,!1),w=(o&s.childLanes)!==0,Pt||w){if(w=ot,w!==null&&(u=Sl(w,o),u!==0&&u!==P.retryLane))throw P.retryLane=u,aa(s,u),En(w,s,u),Rg;gp(E)||Oh(),r=Pg(s,r,o)}else gp(E)?(r.flags|=192,r.child=s.child,r=null):(s=P.treeContext,ut=Zn(E.nextSibling),Xt=r,Ke=!0,Wi=null,Jn=!1,s!==null&&_y(r,s),r=Dg(r,u.children),r.flags|=4096);return r}return g?(nr(),E=u.fallback,g=r.mode,P=s.child,Q=P.sibling,u=ci(P,{mode:"hidden",children:u.children}),u.subtreeFlags=P.subtreeFlags&65011712,Q!==null?E=ci(Q,E):(E=oa(E,g,o,null),E.flags|=2),E.return=r,u.return=r,u.sibling=E,r.child=u,ic(null,u),u=r.child,E=s.child.memoizedState,E===null?E=Og(o):(g=E.cachePool,g!==null?(P=jt._currentValue,g=g.parent!==P?{parent:P,pool:P}:g):g=Sy(),E={baseLanes:E.baseLanes|o,cachePool:g}),u.memoizedState=E,u.childLanes=jg(s,w,o),r.memoizedState=kg,ic(s.child,u)):(tr(r),o=s.child,s=o.sibling,o=ci(o,{mode:"visible",children:u.children}),o.return=r,o.sibling=null,s!==null&&(w=r.deletions,w===null?(r.deletions=[s],r.flags|=16):w.push(s)),r.child=o,r.memoizedState=null,o)}function Dg(s,r){return r=Th({mode:"visible",children:r},s.mode),r.return=s,s.child=r}function Th(s,r){return s=jn(22,s,null,r),s.lanes=0,s}function Pg(s,r,o){return ga(r,s.child,null,o),s=Dg(r,r.pendingProps.children),s.flags|=2,r.memoizedState=null,s}function Uv(s,r,o){s.lanes|=r;var u=s.alternate;u!==null&&(u.lanes|=r),Qf(s.return,r,o)}function Mg(s,r,o,u,g,y){var w=s.memoizedState;w===null?s.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:u,tail:o,tailMode:g,treeForkCount:y}:(w.isBackwards=r,w.rendering=null,w.renderingStartTime=0,w.last=u,w.tail=o,w.tailMode=g,w.treeForkCount=y)}function Vv(s,r,o){var u=r.pendingProps,g=u.revealOrder,y=u.tail;u=u.children;var w=Et.current,E=(w&2)!==0;if(E?(w=w&1|2,r.flags|=128):w&=1,de(Et,w),en(s,r,u,o),u=Ke?Gl:0,!E&&s!==null&&(s.flags&128)!==0)e:for(s=r.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Uv(s,o,r);else if(s.tag===19)Uv(s,o,r);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break e;for(;s.sibling===null;){if(s.return===null||s.return===r)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(g){case"forwards":for(o=r.child,g=null;o!==null;)s=o.alternate,s!==null&&hh(s)===null&&(g=o),o=o.sibling;o=g,o===null?(g=r.child,r.child=null):(g=o.sibling,o.sibling=null),Mg(r,!1,g,o,y,u);break;case"backwards":case"unstable_legacy-backwards":for(o=null,g=r.child,r.child=null;g!==null;){if(s=g.alternate,s!==null&&hh(s)===null){r.child=g;break}s=g.sibling,g.sibling=o,o=g,g=s}Mg(r,!0,o,null,y,u);break;case"together":Mg(r,!1,null,null,void 0,u);break;default:r.memoizedState=null}return r.child}function pi(s,r,o){if(s!==null&&(r.dependencies=s.dependencies),rr|=r.lanes,(o&r.childLanes)===0)if(s!==null){if(ho(s,r,o,!1),(o&r.childLanes)===0)return null}else return null;if(s!==null&&r.child!==s.child)throw Error(i(153));if(r.child!==null){for(s=r.child,o=ci(s,s.pendingProps),r.child=o,o.return=r;s.sibling!==null;)s=s.sibling,o=o.sibling=ci(s,s.pendingProps),o.return=r;o.sibling=null}return r.child}function Lg(s,r){return(s.lanes&r)!==0?!0:(s=s.dependencies,!!(s!==null&&sh(s)))}function wA(s,r,o){switch(r.tag){case 3:ee(r,r.stateNode.containerInfo),Ji(r,jt,s.memoizedState.cache),la();break;case 27:case 5:ye(r);break;case 4:ee(r,r.stateNode.containerInfo);break;case 10:Ji(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,lg(r),null;break;case 13:var u=r.memoizedState;if(u!==null)return u.dehydrated!==null?(tr(r),r.flags|=128,null):(o&r.child.childLanes)!==0?Lv(s,r,o):(tr(r),s=pi(s,r,o),s!==null?s.sibling:null);tr(r);break;case 19:var g=(s.flags&128)!==0;if(u=(o&r.childLanes)!==0,u||(ho(s,r,o,!1),u=(o&r.childLanes)!==0),g){if(u)return Vv(s,r,o);r.flags|=128}if(g=r.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),de(Et,Et.current),u)break;return null;case 22:return r.lanes=0,kv(s,r,o,r.pendingProps);case 24:Ji(r,jt,s.memoizedState.cache)}return pi(s,r,o)}function Bv(s,r,o){if(s!==null)if(s.memoizedProps!==r.pendingProps)Pt=!0;else{if(!Lg(s,o)&&(r.flags&128)===0)return Pt=!1,wA(s,r,o);Pt=(s.flags&131072)!==0}else Pt=!1,Ke&&(r.flags&1048576)!==0&&vy(r,Gl,r.index);switch(r.lanes=0,r.tag){case 16:e:{var u=r.pendingProps;if(s=da(r.elementType),r.type=s,typeof s=="function")Hf(s)?(u=ma(s,u),r.tag=1,r=Pv(null,r,s,u,o)):(r.tag=0,r=Ig(null,r,s,u,o));else{if(s!=null){var g=s.$$typeof;if(g===K){r.tag=11,r=Cv(null,r,s,u,o);break e}else if(g===A){r.tag=14,r=Rv(null,r,s,u,o);break e}}throw r=ce(s)||s,Error(i(306,r,""))}}return r;case 0:return Ig(s,r,r.type,r.pendingProps,o);case 1:return u=r.type,g=ma(u,r.pendingProps),Pv(s,r,u,g,o);case 3:e:{if(ee(r,r.stateNode.containerInfo),s===null)throw Error(i(387));u=r.pendingProps;var y=r.memoizedState;g=y.element,sg(s,r),Zl(r,u,null,o);var w=r.memoizedState;if(u=w.cache,Ji(r,jt,u),u!==y.cache&&Jf(r,[jt],o,!0),Xl(),u=w.element,y.isDehydrated)if(y={element:u,isDehydrated:!1,cache:w.cache},r.updateQueue.baseState=y,r.memoizedState=y,r.flags&256){r=Mv(s,r,u,o);break e}else if(u!==g){g=Yn(Error(i(424)),r),Fl(g),r=Mv(s,r,u,o);break e}else{switch(s=r.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(ut=Zn(s.firstChild),Xt=r,Ke=!0,Wi=null,Jn=!0,o=ky(r,null,u,o),r.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling}else{if(la(),u===g){r=pi(s,r,o);break e}en(s,r,u,o)}r=r.child}return r;case 26:return xh(s,r),s===null?(o=J_(r.type,null,r.pendingProps,null))?r.memoizedState=o:Ke||(o=r.type,s=r.pendingProps,u=Vh(ke.current).createElement(o),u[It]=r,u[Gt]=s,tn(u,o,s),kt(u),r.stateNode=u):r.memoizedState=J_(r.type,s.memoizedProps,r.pendingProps,s.memoizedState),null;case 27:return ye(r),s===null&&Ke&&(u=r.stateNode=Y_(r.type,r.pendingProps,ke.current),Xt=r,Jn=!0,g=ut,ur(r.type)?(mp=g,ut=Zn(u.firstChild)):ut=g),en(s,r,r.pendingProps.children,o),xh(s,r),s===null&&(r.flags|=4194304),r.child;case 5:return s===null&&Ke&&((g=u=ut)&&(u=JA(u,r.type,r.pendingProps,Jn),u!==null?(r.stateNode=u,Xt=r,ut=Zn(u.firstChild),Jn=!1,g=!0):g=!1),g||Qi(r)),ye(r),g=r.type,y=r.pendingProps,w=s!==null?s.memoizedProps:null,u=y.children,hp(g,y)?u=null:w!==null&&hp(g,w)&&(r.flags|=32),r.memoizedState!==null&&(g=ug(s,r,dA,null,null,o),_c._currentValue=g),xh(s,r),en(s,r,u,o),r.child;case 6:return s===null&&Ke&&((s=o=ut)&&(o=XA(o,r.pendingProps,Jn),o!==null?(r.stateNode=o,Xt=r,ut=null,s=!0):s=!1),s||Qi(r)),null;case 13:return Lv(s,r,o);case 4:return ee(r,r.stateNode.containerInfo),u=r.pendingProps,s===null?r.child=ga(r,null,u,o):en(s,r,u,o),r.child;case 11:return Cv(s,r,r.type,r.pendingProps,o);case 7:return en(s,r,r.pendingProps,o),r.child;case 8:return en(s,r,r.pendingProps.children,o),r.child;case 12:return en(s,r,r.pendingProps.children,o),r.child;case 10:return u=r.pendingProps,Ji(r,r.type,u.value),en(s,r,u.children,o),r.child;case 9:return g=r.type._context,u=r.pendingProps.children,ua(r),g=Zt(g),u=u(g),r.flags|=1,en(s,r,u,o),r.child;case 14:return Rv(s,r,r.type,r.pendingProps,o);case 15:return Iv(s,r,r.type,r.pendingProps,o);case 19:return Vv(s,r,o);case 31:return bA(s,r,o);case 22:return kv(s,r,o,r.pendingProps);case 24:return ua(r),u=Zt(jt),s===null?(g=eg(),g===null&&(g=ot,y=Xf(),g.pooledCache=y,y.refCount++,y!==null&&(g.pooledCacheLanes|=o),g=y),r.memoizedState={parent:u,cache:g},ng(r),Ji(r,jt,g)):((s.lanes&o)!==0&&(sg(s,r),Zl(r,null,null,o),Xl()),g=s.memoizedState,y=r.memoizedState,g.parent!==u?(g={parent:u,cache:u},r.memoizedState=g,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=g),Ji(r,jt,u)):(u=y.cache,Ji(r,jt,u),u!==g.cache&&Jf(r,[jt],o,!0))),en(s,r,r.pendingProps.children,o),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function mi(s){s.flags|=4}function Ug(s,r,o,u,g){if((r=(s.mode&32)!==0)&&(r=!1),r){if(s.flags|=16777216,(g&335544128)===g)if(s.stateNode.complete)s.flags|=8192;else if(f_())s.flags|=8192;else throw fa=oh,tg}else s.flags&=-16777217}function zv(s,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!nb(r))if(f_())s.flags|=8192;else throw fa=oh,tg}function Eh(s,r){r!==null&&(s.flags|=4),s.flags&16384&&(r=s.tag!==22?Iu():536870912,s.lanes|=r,Eo|=r)}function rc(s,r){if(!Ke)switch(s.tailMode){case"hidden":r=s.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?s.tail=null:o.sibling=null;break;case"collapsed":o=s.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?r||s.tail===null?s.tail=null:s.tail.sibling=null:u.sibling=null}}function ht(s){var r=s.alternate!==null&&s.alternate.child===s.child,o=0,u=0;if(r)for(var g=s.child;g!==null;)o|=g.lanes|g.childLanes,u|=g.subtreeFlags&65011712,u|=g.flags&65011712,g.return=s,g=g.sibling;else for(g=s.child;g!==null;)o|=g.lanes|g.childLanes,u|=g.subtreeFlags,u|=g.flags,g.return=s,g=g.sibling;return s.subtreeFlags|=u,s.childLanes=o,r}function xA(s,r,o){var u=r.pendingProps;switch(Ff(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ht(r),null;case 1:return ht(r),null;case 3:return o=r.stateNode,u=null,s!==null&&(u=s.memoizedState.cache),r.memoizedState.cache!==u&&(r.flags|=2048),di(jt),he(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(s===null||s.child===null)&&(uo(r)?mi(r):s===null||s.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Yf())),ht(r),null;case 26:var g=r.type,y=r.memoizedState;return s===null?(mi(r),y!==null?(ht(r),zv(r,y)):(ht(r),Ug(r,g,null,u,o))):y?y!==s.memoizedState?(mi(r),ht(r),zv(r,y)):(ht(r),r.flags&=-16777217):(s=s.memoizedProps,s!==u&&mi(r),ht(r),Ug(r,g,s,u,o)),null;case 27:if(wt(r),o=ke.current,g=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==u&&mi(r);else{if(!u){if(r.stateNode===null)throw Error(i(166));return ht(r),null}s=ge.current,uo(r)?by(r):(s=Y_(g,u,o),r.stateNode=s,mi(r))}return ht(r),null;case 5:if(wt(r),g=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==u&&mi(r);else{if(!u){if(r.stateNode===null)throw Error(i(166));return ht(r),null}if(y=ge.current,uo(r))by(r);else{var w=Vh(ke.current);switch(y){case 1:y=w.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:y=w.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":y=w.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":y=w.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":y=w.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof u.is=="string"?w.createElement("select",{is:u.is}):w.createElement("select"),u.multiple?y.multiple=!0:u.size&&(y.size=u.size);break;default:y=typeof u.is=="string"?w.createElement(g,{is:u.is}):w.createElement(g)}}y[It]=r,y[Gt]=u;e:for(w=r.child;w!==null;){if(w.tag===5||w.tag===6)y.appendChild(w.stateNode);else if(w.tag!==4&&w.tag!==27&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===r)break e;for(;w.sibling===null;){if(w.return===null||w.return===r)break e;w=w.return}w.sibling.return=w.return,w=w.sibling}r.stateNode=y;e:switch(tn(y,g,u),g){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&mi(r)}}return ht(r),Ug(r,r.type,s===null?null:s.memoizedProps,r.pendingProps,o),null;case 6:if(s&&r.stateNode!=null)s.memoizedProps!==u&&mi(r);else{if(typeof u!="string"&&r.stateNode===null)throw Error(i(166));if(s=ke.current,uo(r)){if(s=r.stateNode,o=r.memoizedProps,u=null,g=Xt,g!==null)switch(g.tag){case 27:case 5:u=g.memoizedProps}s[It]=r,s=!!(s.nodeValue===o||u!==null&&u.suppressHydrationWarning===!0||L_(s.nodeValue,o)),s||Qi(r,!0)}else s=Vh(s).createTextNode(u),s[It]=r,r.stateNode=s}return ht(r),null;case 31:if(o=r.memoizedState,s===null||s.memoizedState!==null){if(u=uo(r),o!==null){if(s===null){if(!u)throw Error(i(318));if(s=r.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[It]=r}else la(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;ht(r),s=!1}else o=Yf(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=o),s=!0;if(!s)return r.flags&256?(Pn(r),r):(Pn(r),null);if((r.flags&128)!==0)throw Error(i(558))}return ht(r),null;case 13:if(u=r.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(g=uo(r),u!==null&&u.dehydrated!==null){if(s===null){if(!g)throw Error(i(318));if(g=r.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(i(317));g[It]=r}else la(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;ht(r),g=!1}else g=Yf(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=g),g=!0;if(!g)return r.flags&256?(Pn(r),r):(Pn(r),null)}return Pn(r),(r.flags&128)!==0?(r.lanes=o,r):(o=u!==null,s=s!==null&&s.memoizedState!==null,o&&(u=r.child,g=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(g=u.alternate.memoizedState.cachePool.pool),y=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(y=u.memoizedState.cachePool.pool),y!==g&&(u.flags|=2048)),o!==s&&o&&(r.child.flags|=8192),Eh(r,r.updateQueue),ht(r),null);case 4:return he(),s===null&&ap(r.stateNode.containerInfo),ht(r),null;case 10:return di(r.type),ht(r),null;case 19:if(te(Et),u=r.memoizedState,u===null)return ht(r),null;if(g=(r.flags&128)!==0,y=u.rendering,y===null)if(g)rc(u,!1);else{if(_t!==0||s!==null&&(s.flags&128)!==0)for(s=r.child;s!==null;){if(y=hh(s),y!==null){for(r.flags|=128,rc(u,!1),s=y.updateQueue,r.updateQueue=s,Eh(r,s),r.subtreeFlags=0,s=o,o=r.child;o!==null;)py(o,s),o=o.sibling;return de(Et,Et.current&1|2),Ke&&ui(r,u.treeForkCount),r.child}s=s.sibling}u.tail!==null&&gn()>Rh&&(r.flags|=128,g=!0,rc(u,!1),r.lanes=4194304)}else{if(!g)if(s=hh(y),s!==null){if(r.flags|=128,g=!0,s=s.updateQueue,r.updateQueue=s,Eh(r,s),rc(u,!0),u.tail===null&&u.tailMode==="hidden"&&!y.alternate&&!Ke)return ht(r),null}else 2*gn()-u.renderingStartTime>Rh&&o!==536870912&&(r.flags|=128,g=!0,rc(u,!1),r.lanes=4194304);u.isBackwards?(y.sibling=r.child,r.child=y):(s=u.last,s!==null?s.sibling=y:r.child=y,u.last=y)}return u.tail!==null?(s=u.tail,u.rendering=s,u.tail=s.sibling,u.renderingStartTime=gn(),s.sibling=null,o=Et.current,de(Et,g?o&1|2:o&1),Ke&&ui(r,u.treeForkCount),s):(ht(r),null);case 22:case 23:return Pn(r),og(),u=r.memoizedState!==null,s!==null?s.memoizedState!==null!==u&&(r.flags|=8192):u&&(r.flags|=8192),u?(o&536870912)!==0&&(r.flags&128)===0&&(ht(r),r.subtreeFlags&6&&(r.flags|=8192)):ht(r),o=r.updateQueue,o!==null&&Eh(r,o.retryQueue),o=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),u=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),u!==o&&(r.flags|=2048),s!==null&&te(ha),null;case 24:return o=null,s!==null&&(o=s.memoizedState.cache),r.memoizedState.cache!==o&&(r.flags|=2048),di(jt),ht(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function TA(s,r){switch(Ff(r),r.tag){case 1:return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 3:return di(jt),he(),s=r.flags,(s&65536)!==0&&(s&128)===0?(r.flags=s&-65537|128,r):null;case 26:case 27:case 5:return wt(r),null;case 31:if(r.memoizedState!==null){if(Pn(r),r.alternate===null)throw Error(i(340));la()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 13:if(Pn(r),s=r.memoizedState,s!==null&&s.dehydrated!==null){if(r.alternate===null)throw Error(i(340));la()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 19:return te(Et),null;case 4:return he(),null;case 10:return di(r.type),null;case 22:case 23:return Pn(r),og(),s!==null&&te(ha),s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 24:return di(jt),null;case 25:return null;default:return null}}function Hv(s,r){switch(Ff(r),r.tag){case 3:di(jt),he();break;case 26:case 27:case 5:wt(r);break;case 4:he();break;case 31:r.memoizedState!==null&&Pn(r);break;case 13:Pn(r);break;case 19:te(Et);break;case 10:di(r.type);break;case 22:case 23:Pn(r),og(),s!==null&&te(ha);break;case 24:di(jt)}}function ac(s,r){try{var o=r.updateQueue,u=o!==null?o.lastEffect:null;if(u!==null){var g=u.next;o=g;do{if((o.tag&s)===s){u=void 0;var y=o.create,w=o.inst;u=y(),w.destroy=u}o=o.next}while(o!==g)}}catch(E){nt(r,r.return,E)}}function sr(s,r,o){try{var u=r.updateQueue,g=u!==null?u.lastEffect:null;if(g!==null){var y=g.next;u=y;do{if((u.tag&s)===s){var w=u.inst,E=w.destroy;if(E!==void 0){w.destroy=void 0,g=r;var P=o,Q=E;try{Q()}catch(ne){nt(g,P,ne)}}}u=u.next}while(u!==y)}}catch(ne){nt(r,r.return,ne)}}function qv(s){var r=s.updateQueue;if(r!==null){var o=s.stateNode;try{jy(r,o)}catch(u){nt(s,s.return,u)}}}function $v(s,r,o){o.props=ma(s.type,s.memoizedProps),o.state=s.memoizedState;try{o.componentWillUnmount()}catch(u){nt(s,r,u)}}function oc(s,r){try{var o=s.ref;if(o!==null){switch(s.tag){case 26:case 27:case 5:var u=s.stateNode;break;case 30:u=s.stateNode;break;default:u=s.stateNode}typeof o=="function"?s.refCleanup=o(u):o.current=u}}catch(g){nt(s,r,g)}}function Ks(s,r){var o=s.ref,u=s.refCleanup;if(o!==null)if(typeof u=="function")try{u()}catch(g){nt(s,r,g)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(g){nt(s,r,g)}else o.current=null}function Gv(s){var r=s.type,o=s.memoizedProps,u=s.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":o.autoFocus&&u.focus();break e;case"img":o.src?u.src=o.src:o.srcSet&&(u.srcset=o.srcSet)}}catch(g){nt(s,s.return,g)}}function Vg(s,r,o){try{var u=s.stateNode;GA(u,s.type,o,r),u[Gt]=r}catch(g){nt(s,s.return,g)}}function Fv(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&ur(s.type)||s.tag===4}function Bg(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Fv(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&ur(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function zg(s,r,o){var u=s.tag;if(u===5||u===6)s=s.stateNode,r?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(s,r):(r=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,r.appendChild(s),o=o._reactRootContainer,o!=null||r.onclick!==null||(r.onclick=us));else if(u!==4&&(u===27&&ur(s.type)&&(o=s.stateNode,r=null),s=s.child,s!==null))for(zg(s,r,o),s=s.sibling;s!==null;)zg(s,r,o),s=s.sibling}function Sh(s,r,o){var u=s.tag;if(u===5||u===6)s=s.stateNode,r?o.insertBefore(s,r):o.appendChild(s);else if(u!==4&&(u===27&&ur(s.type)&&(o=s.stateNode),s=s.child,s!==null))for(Sh(s,r,o),s=s.sibling;s!==null;)Sh(s,r,o),s=s.sibling}function Kv(s){var r=s.stateNode,o=s.memoizedProps;try{for(var u=s.type,g=r.attributes;g.length;)r.removeAttributeNode(g[0]);tn(r,u,o),r[It]=s,r[Gt]=o}catch(y){nt(s,s.return,y)}}var yi=!1,Mt=!1,Hg=!1,Yv=typeof WeakSet=="function"?WeakSet:Set,Kt=null;function EA(s,r){if(s=s.containerInfo,cp=Fh,s=ay(s),Pf(s)){if("selectionStart"in s)var o={start:s.selectionStart,end:s.selectionEnd};else e:{o=(o=s.ownerDocument)&&o.defaultView||window;var u=o.getSelection&&o.getSelection();if(u&&u.rangeCount!==0){o=u.anchorNode;var g=u.anchorOffset,y=u.focusNode;u=u.focusOffset;try{o.nodeType,y.nodeType}catch{o=null;break e}var w=0,E=-1,P=-1,Q=0,ne=0,re=s,J=null;t:for(;;){for(var Z;re!==o||g!==0&&re.nodeType!==3||(E=w+g),re!==y||u!==0&&re.nodeType!==3||(P=w+u),re.nodeType===3&&(w+=re.nodeValue.length),(Z=re.firstChild)!==null;)J=re,re=Z;for(;;){if(re===s)break t;if(J===o&&++Q===g&&(E=w),J===y&&++ne===u&&(P=w),(Z=re.nextSibling)!==null)break;re=J,J=re.parentNode}re=Z}o=E===-1||P===-1?null:{start:E,end:P}}else o=null}o=o||{start:0,end:0}}else o=null;for(up={focusedElem:s,selectionRange:o},Fh=!1,Kt=r;Kt!==null;)if(r=Kt,s=r.child,(r.subtreeFlags&1028)!==0&&s!==null)s.return=r,Kt=s;else for(;Kt!==null;){switch(r=Kt,y=r.alternate,s=r.flags,r.tag){case 0:if((s&4)!==0&&(s=r.updateQueue,s=s!==null?s.events:null,s!==null))for(o=0;o<s.length;o++)g=s[o],g.ref.impl=g.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&y!==null){s=void 0,o=r,g=y.memoizedProps,y=y.memoizedState,u=o.stateNode;try{var _e=ma(o.type,g);s=u.getSnapshotBeforeUpdate(_e,y),u.__reactInternalSnapshotBeforeUpdate=s}catch(Ae){nt(o,o.return,Ae)}}break;case 3:if((s&1024)!==0){if(s=r.stateNode.containerInfo,o=s.nodeType,o===9)fp(s);else if(o===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":fp(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=r.sibling,s!==null){s.return=r.return,Kt=s;break}Kt=r.return}}function Wv(s,r,o){var u=o.flags;switch(o.tag){case 0:case 11:case 15:_i(s,o),u&4&&ac(5,o);break;case 1:if(_i(s,o),u&4)if(s=o.stateNode,r===null)try{s.componentDidMount()}catch(w){nt(o,o.return,w)}else{var g=ma(o.type,r.memoizedProps);r=r.memoizedState;try{s.componentDidUpdate(g,r,s.__reactInternalSnapshotBeforeUpdate)}catch(w){nt(o,o.return,w)}}u&64&&qv(o),u&512&&oc(o,o.return);break;case 3:if(_i(s,o),u&64&&(s=o.updateQueue,s!==null)){if(r=null,o.child!==null)switch(o.child.tag){case 27:case 5:r=o.child.stateNode;break;case 1:r=o.child.stateNode}try{jy(s,r)}catch(w){nt(o,o.return,w)}}break;case 27:r===null&&u&4&&Kv(o);case 26:case 5:_i(s,o),r===null&&u&4&&Gv(o),u&512&&oc(o,o.return);break;case 12:_i(s,o);break;case 31:_i(s,o),u&4&&Xv(s,o);break;case 13:_i(s,o),u&4&&Zv(s,o),u&64&&(s=o.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(o=jA.bind(null,o),ZA(s,o))));break;case 22:if(u=o.memoizedState!==null||yi,!u){r=r!==null&&r.memoizedState!==null||Mt,g=yi;var y=Mt;yi=u,(Mt=r)&&!y?bi(s,o,(o.subtreeFlags&8772)!==0):_i(s,o),yi=g,Mt=y}break;case 30:break;default:_i(s,o)}}function Qv(s){var r=s.alternate;r!==null&&(s.alternate=null,Qv(r)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(r=s.stateNode,r!==null&&Ka(r)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var gt=null,bn=!1;function vi(s,r,o){for(o=o.child;o!==null;)Jv(s,r,o),o=o.sibling}function Jv(s,r,o){if(Qt&&typeof Qt.onCommitFiberUnmount=="function")try{Qt.onCommitFiberUnmount(as,o)}catch{}switch(o.tag){case 26:Mt||Ks(o,r),vi(s,r,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Mt||Ks(o,r);var u=gt,g=bn;ur(o.type)&&(gt=o.stateNode,bn=!1),vi(s,r,o),mc(o.stateNode),gt=u,bn=g;break;case 5:Mt||Ks(o,r);case 6:if(u=gt,g=bn,gt=null,vi(s,r,o),gt=u,bn=g,gt!==null)if(bn)try{(gt.nodeType===9?gt.body:gt.nodeName==="HTML"?gt.ownerDocument.body:gt).removeChild(o.stateNode)}catch(y){nt(o,r,y)}else try{gt.removeChild(o.stateNode)}catch(y){nt(o,r,y)}break;case 18:gt!==null&&(bn?(s=gt,q_(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,o.stateNode),Oo(s)):q_(gt,o.stateNode));break;case 4:u=gt,g=bn,gt=o.stateNode.containerInfo,bn=!0,vi(s,r,o),gt=u,bn=g;break;case 0:case 11:case 14:case 15:sr(2,o,r),Mt||sr(4,o,r),vi(s,r,o);break;case 1:Mt||(Ks(o,r),u=o.stateNode,typeof u.componentWillUnmount=="function"&&$v(o,r,u)),vi(s,r,o);break;case 21:vi(s,r,o);break;case 22:Mt=(u=Mt)||o.memoizedState!==null,vi(s,r,o),Mt=u;break;default:vi(s,r,o)}}function Xv(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Oo(s)}catch(o){nt(r,r.return,o)}}}function Zv(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Oo(s)}catch(o){nt(r,r.return,o)}}function SA(s){switch(s.tag){case 31:case 13:case 19:var r=s.stateNode;return r===null&&(r=s.stateNode=new Yv),r;case 22:return s=s.stateNode,r=s._retryCache,r===null&&(r=s._retryCache=new Yv),r;default:throw Error(i(435,s.tag))}}function Ah(s,r){var o=SA(s);r.forEach(function(u){if(!o.has(u)){o.add(u);var g=DA.bind(null,s,u);u.then(g,g)}})}function wn(s,r){var o=r.deletions;if(o!==null)for(var u=0;u<o.length;u++){var g=o[u],y=s,w=r,E=w;e:for(;E!==null;){switch(E.tag){case 27:if(ur(E.type)){gt=E.stateNode,bn=!1;break e}break;case 5:gt=E.stateNode,bn=!1;break e;case 3:case 4:gt=E.stateNode.containerInfo,bn=!0;break e}E=E.return}if(gt===null)throw Error(i(160));Jv(y,w,g),gt=null,bn=!1,y=g.alternate,y!==null&&(y.return=null),g.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)e_(r,s),r=r.sibling}var ms=null;function e_(s,r){var o=s.alternate,u=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:wn(r,s),xn(s),u&4&&(sr(3,s,s.return),ac(3,s),sr(5,s,s.return));break;case 1:wn(r,s),xn(s),u&512&&(Mt||o===null||Ks(o,o.return)),u&64&&yi&&(s=s.updateQueue,s!==null&&(u=s.callbacks,u!==null&&(o=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=o===null?u:o.concat(u))));break;case 26:var g=ms;if(wn(r,s),xn(s),u&512&&(Mt||o===null||Ks(o,o.return)),u&4){var y=o!==null?o.memoizedState:null;if(u=s.memoizedState,o===null)if(u===null)if(s.stateNode===null){e:{u=s.type,o=s.memoizedProps,g=g.ownerDocument||g;t:switch(u){case"title":y=g.getElementsByTagName("title")[0],(!y||y[js]||y[It]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=g.createElement(u),g.head.insertBefore(y,g.querySelector("head > title"))),tn(y,u,o),y[It]=s,kt(y),u=y;break e;case"link":var w=eb("link","href",g).get(u+(o.href||""));if(w){for(var E=0;E<w.length;E++)if(y=w[E],y.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&y.getAttribute("rel")===(o.rel==null?null:o.rel)&&y.getAttribute("title")===(o.title==null?null:o.title)&&y.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){w.splice(E,1);break t}}y=g.createElement(u),tn(y,u,o),g.head.appendChild(y);break;case"meta":if(w=eb("meta","content",g).get(u+(o.content||""))){for(E=0;E<w.length;E++)if(y=w[E],y.getAttribute("content")===(o.content==null?null:""+o.content)&&y.getAttribute("name")===(o.name==null?null:o.name)&&y.getAttribute("property")===(o.property==null?null:o.property)&&y.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&y.getAttribute("charset")===(o.charSet==null?null:o.charSet)){w.splice(E,1);break t}}y=g.createElement(u),tn(y,u,o),g.head.appendChild(y);break;default:throw Error(i(468,u))}y[It]=s,kt(y),u=y}s.stateNode=u}else tb(g,s.type,s.stateNode);else s.stateNode=Z_(g,u,s.memoizedProps);else y!==u?(y===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):y.count--,u===null?tb(g,s.type,s.stateNode):Z_(g,u,s.memoizedProps)):u===null&&s.stateNode!==null&&Vg(s,s.memoizedProps,o.memoizedProps)}break;case 27:wn(r,s),xn(s),u&512&&(Mt||o===null||Ks(o,o.return)),o!==null&&u&4&&Vg(s,s.memoizedProps,o.memoizedProps);break;case 5:if(wn(r,s),xn(s),u&512&&(Mt||o===null||Ks(o,o.return)),s.flags&32){g=s.stateNode;try{_n(g,"")}catch(_e){nt(s,s.return,_e)}}u&4&&s.stateNode!=null&&(g=s.memoizedProps,Vg(s,g,o!==null?o.memoizedProps:g)),u&1024&&(Hg=!0);break;case 6:if(wn(r,s),xn(s),u&4){if(s.stateNode===null)throw Error(i(162));u=s.memoizedProps,o=s.stateNode;try{o.nodeValue=u}catch(_e){nt(s,s.return,_e)}}break;case 3:if(Hh=null,g=ms,ms=Bh(r.containerInfo),wn(r,s),ms=g,xn(s),u&4&&o!==null&&o.memoizedState.isDehydrated)try{Oo(r.containerInfo)}catch(_e){nt(s,s.return,_e)}Hg&&(Hg=!1,t_(s));break;case 4:u=ms,ms=Bh(s.stateNode.containerInfo),wn(r,s),xn(s),ms=u;break;case 12:wn(r,s),xn(s);break;case 31:wn(r,s),xn(s),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Ah(s,u)));break;case 13:wn(r,s),xn(s),s.child.flags&8192&&s.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Ch=gn()),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Ah(s,u)));break;case 22:g=s.memoizedState!==null;var P=o!==null&&o.memoizedState!==null,Q=yi,ne=Mt;if(yi=Q||g,Mt=ne||P,wn(r,s),Mt=ne,yi=Q,xn(s),u&8192)e:for(r=s.stateNode,r._visibility=g?r._visibility&-2:r._visibility|1,g&&(o===null||P||yi||Mt||ya(s)),o=null,r=s;;){if(r.tag===5||r.tag===26){if(o===null){P=o=r;try{if(y=P.stateNode,g)w=y.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{E=P.stateNode;var re=P.memoizedProps.style,J=re!=null&&re.hasOwnProperty("display")?re.display:null;E.style.display=J==null||typeof J=="boolean"?"":(""+J).trim()}}catch(_e){nt(P,P.return,_e)}}}else if(r.tag===6){if(o===null){P=r;try{P.stateNode.nodeValue=g?"":P.memoizedProps}catch(_e){nt(P,P.return,_e)}}}else if(r.tag===18){if(o===null){P=r;try{var Z=P.stateNode;g?$_(Z,!0):$_(P.stateNode,!1)}catch(_e){nt(P,P.return,_e)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===s)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;o===r&&(o=null),r=r.return}o===r&&(o=null),r.sibling.return=r.return,r=r.sibling}u&4&&(u=s.updateQueue,u!==null&&(o=u.retryQueue,o!==null&&(u.retryQueue=null,Ah(s,o))));break;case 19:wn(r,s),xn(s),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Ah(s,u)));break;case 30:break;case 21:break;default:wn(r,s),xn(s)}}function xn(s){var r=s.flags;if(r&2){try{for(var o,u=s.return;u!==null;){if(Fv(u)){o=u;break}u=u.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var g=o.stateNode,y=Bg(s);Sh(s,y,g);break;case 5:var w=o.stateNode;o.flags&32&&(_n(w,""),o.flags&=-33);var E=Bg(s);Sh(s,E,w);break;case 3:case 4:var P=o.stateNode.containerInfo,Q=Bg(s);zg(s,Q,P);break;default:throw Error(i(161))}}catch(ne){nt(s,s.return,ne)}s.flags&=-3}r&4096&&(s.flags&=-4097)}function t_(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var r=s;t_(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),s=s.sibling}}function _i(s,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)Wv(s,r.alternate,r),r=r.sibling}function ya(s){for(s=s.child;s!==null;){var r=s;switch(r.tag){case 0:case 11:case 14:case 15:sr(4,r,r.return),ya(r);break;case 1:Ks(r,r.return);var o=r.stateNode;typeof o.componentWillUnmount=="function"&&$v(r,r.return,o),ya(r);break;case 27:mc(r.stateNode);case 26:case 5:Ks(r,r.return),ya(r);break;case 22:r.memoizedState===null&&ya(r);break;case 30:ya(r);break;default:ya(r)}s=s.sibling}}function bi(s,r,o){for(o=o&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var u=r.alternate,g=s,y=r,w=y.flags;switch(y.tag){case 0:case 11:case 15:bi(g,y,o),ac(4,y);break;case 1:if(bi(g,y,o),u=y,g=u.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(Q){nt(u,u.return,Q)}if(u=y,g=u.updateQueue,g!==null){var E=u.stateNode;try{var P=g.shared.hiddenCallbacks;if(P!==null)for(g.shared.hiddenCallbacks=null,g=0;g<P.length;g++)Oy(P[g],E)}catch(Q){nt(u,u.return,Q)}}o&&w&64&&qv(y),oc(y,y.return);break;case 27:Kv(y);case 26:case 5:bi(g,y,o),o&&u===null&&w&4&&Gv(y),oc(y,y.return);break;case 12:bi(g,y,o);break;case 31:bi(g,y,o),o&&w&4&&Xv(g,y);break;case 13:bi(g,y,o),o&&w&4&&Zv(g,y);break;case 22:y.memoizedState===null&&bi(g,y,o),oc(y,y.return);break;case 30:break;default:bi(g,y,o)}r=r.sibling}}function qg(s,r){var o=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),s=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(s=r.memoizedState.cachePool.pool),s!==o&&(s!=null&&s.refCount++,o!=null&&Kl(o))}function $g(s,r){s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&Kl(s))}function ys(s,r,o,u){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)n_(s,r,o,u),r=r.sibling}function n_(s,r,o,u){var g=r.flags;switch(r.tag){case 0:case 11:case 15:ys(s,r,o,u),g&2048&&ac(9,r);break;case 1:ys(s,r,o,u);break;case 3:ys(s,r,o,u),g&2048&&(s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&Kl(s)));break;case 12:if(g&2048){ys(s,r,o,u),s=r.stateNode;try{var y=r.memoizedProps,w=y.id,E=y.onPostCommit;typeof E=="function"&&E(w,r.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(P){nt(r,r.return,P)}}else ys(s,r,o,u);break;case 31:ys(s,r,o,u);break;case 13:ys(s,r,o,u);break;case 23:break;case 22:y=r.stateNode,w=r.alternate,r.memoizedState!==null?y._visibility&2?ys(s,r,o,u):lc(s,r):y._visibility&2?ys(s,r,o,u):(y._visibility|=2,wo(s,r,o,u,(r.subtreeFlags&10256)!==0||!1)),g&2048&&qg(w,r);break;case 24:ys(s,r,o,u),g&2048&&$g(r.alternate,r);break;default:ys(s,r,o,u)}}function wo(s,r,o,u,g){for(g=g&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var y=s,w=r,E=o,P=u,Q=w.flags;switch(w.tag){case 0:case 11:case 15:wo(y,w,E,P,g),ac(8,w);break;case 23:break;case 22:var ne=w.stateNode;w.memoizedState!==null?ne._visibility&2?wo(y,w,E,P,g):lc(y,w):(ne._visibility|=2,wo(y,w,E,P,g)),g&&Q&2048&&qg(w.alternate,w);break;case 24:wo(y,w,E,P,g),g&&Q&2048&&$g(w.alternate,w);break;default:wo(y,w,E,P,g)}r=r.sibling}}function lc(s,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var o=s,u=r,g=u.flags;switch(u.tag){case 22:lc(o,u),g&2048&&qg(u.alternate,u);break;case 24:lc(o,u),g&2048&&$g(u.alternate,u);break;default:lc(o,u)}r=r.sibling}}var cc=8192;function xo(s,r,o){if(s.subtreeFlags&cc)for(s=s.child;s!==null;)s_(s,r,o),s=s.sibling}function s_(s,r,o){switch(s.tag){case 26:xo(s,r,o),s.flags&cc&&s.memoizedState!==null&&h2(o,ms,s.memoizedState,s.memoizedProps);break;case 5:xo(s,r,o);break;case 3:case 4:var u=ms;ms=Bh(s.stateNode.containerInfo),xo(s,r,o),ms=u;break;case 22:s.memoizedState===null&&(u=s.alternate,u!==null&&u.memoizedState!==null?(u=cc,cc=16777216,xo(s,r,o),cc=u):xo(s,r,o));break;default:xo(s,r,o)}}function i_(s){var r=s.alternate;if(r!==null&&(s=r.child,s!==null)){r.child=null;do r=s.sibling,s.sibling=null,s=r;while(s!==null)}}function uc(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var u=r[o];Kt=u,a_(u,s)}i_(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)r_(s),s=s.sibling}function r_(s){switch(s.tag){case 0:case 11:case 15:uc(s),s.flags&2048&&sr(9,s,s.return);break;case 3:uc(s);break;case 12:uc(s);break;case 22:var r=s.stateNode;s.memoizedState!==null&&r._visibility&2&&(s.return===null||s.return.tag!==13)?(r._visibility&=-3,Nh(s)):uc(s);break;default:uc(s)}}function Nh(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var u=r[o];Kt=u,a_(u,s)}i_(s)}for(s=s.child;s!==null;){switch(r=s,r.tag){case 0:case 11:case 15:sr(8,r,r.return),Nh(r);break;case 22:o=r.stateNode,o._visibility&2&&(o._visibility&=-3,Nh(r));break;default:Nh(r)}s=s.sibling}}function a_(s,r){for(;Kt!==null;){var o=Kt;switch(o.tag){case 0:case 11:case 15:sr(8,o,r);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var u=o.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:Kl(o.memoizedState.cache)}if(u=o.child,u!==null)u.return=o,Kt=u;else e:for(o=s;Kt!==null;){u=Kt;var g=u.sibling,y=u.return;if(Qv(u),u===o){Kt=null;break e}if(g!==null){g.return=y,Kt=g;break e}Kt=y}}}var AA={getCacheForType:function(s){var r=Zt(jt),o=r.data.get(s);return o===void 0&&(o=s(),r.data.set(s,o)),o},cacheSignal:function(){return Zt(jt).controller.signal}},NA=typeof WeakMap=="function"?WeakMap:Map,Xe=0,ot=null,Be=null,He=0,tt=0,Mn=null,ir=!1,To=!1,Gg=!1,wi=0,_t=0,rr=0,va=0,Fg=0,Ln=0,Eo=0,hc=null,Tn=null,Kg=!1,Ch=0,o_=0,Rh=1/0,Ih=null,ar=null,Ht=0,or=null,So=null,xi=0,Yg=0,Wg=null,l_=null,dc=0,Qg=null;function Un(){return(Xe&2)!==0&&He!==0?He&-He:U.T!==null?np():ku()}function c_(){if(Ln===0)if((He&536870912)===0||Ke){var s=Gr;Gr<<=1,(Gr&3932160)===0&&(Gr=262144),Ln=s}else Ln=536870912;return s=Dn.current,s!==null&&(s.flags|=32),Ln}function En(s,r,o){(s===ot&&(tt===2||tt===9)||s.cancelPendingCommit!==null)&&(Ao(s,0),lr(s,He,Ln,!1)),Fr(s,o),((Xe&2)===0||s!==ot)&&(s===ot&&((Xe&2)===0&&(va|=o),_t===4&&lr(s,He,Ln,!1)),Ys(s))}function u_(s,r,o){if((Xe&6)!==0)throw Error(i(327));var u=!o&&(r&127)===0&&(r&s.expiredLanes)===0||os(s,r),g=u?IA(s,r):Xg(s,r,!0),y=u;do{if(g===0){To&&!u&&lr(s,r,0,!1);break}else{if(o=s.current.alternate,y&&!CA(o)){g=Xg(s,r,!1),y=!1;continue}if(g===2){if(y=r,s.errorRecoveryDisabledLanes&y)var w=0;else w=s.pendingLanes&-536870913,w=w!==0?w:w&536870912?536870912:0;if(w!==0){r=w;e:{var E=s;g=hc;var P=E.current.memoizedState.isDehydrated;if(P&&(Ao(E,w).flags|=256),w=Xg(E,w,!1),w!==2){if(Gg&&!P){E.errorRecoveryDisabledLanes|=y,va|=y,g=4;break e}y=Tn,Tn=g,y!==null&&(Tn===null?Tn=y:Tn.push.apply(Tn,y))}g=w}if(y=!1,g!==2)continue}}if(g===1){Ao(s,0),lr(s,r,0,!0);break}e:{switch(u=s,y=g,y){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:lr(u,r,Ln,!ir);break e;case 2:Tn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(g=Ch+300-gn(),10<g)){if(lr(u,r,Ln,!ir),Is(u,0,!0)!==0)break e;xi=r,u.timeoutHandle=z_(h_.bind(null,u,o,Tn,Ih,Kg,r,Ln,va,Eo,ir,y,"Throttled",-0,0),g);break e}h_(u,o,Tn,Ih,Kg,r,Ln,va,Eo,ir,y,null,-0,0)}}break}while(!0);Ys(s)}function h_(s,r,o,u,g,y,w,E,P,Q,ne,re,J,Z){if(s.timeoutHandle=-1,re=r.subtreeFlags,re&8192||(re&16785408)===16785408){re={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:us},s_(r,y,re);var _e=(y&62914560)===y?Ch-gn():(y&4194048)===y?o_-gn():0;if(_e=d2(re,_e),_e!==null){xi=y,s.cancelPendingCommit=_e(__.bind(null,s,r,y,o,u,g,w,E,P,ne,re,null,J,Z)),lr(s,y,w,!Q);return}}__(s,r,y,o,u,g,w,E,P)}function CA(s){for(var r=s;;){var o=r.tag;if((o===0||o===11||o===15)&&r.flags&16384&&(o=r.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var u=0;u<o.length;u++){var g=o[u],y=g.getSnapshot;g=g.value;try{if(!On(y(),g))return!1}catch{return!1}}if(o=r.child,r.subtreeFlags&16384&&o!==null)o.return=r,r=o;else{if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function lr(s,r,o,u){r&=~Fg,r&=~va,s.suspendedLanes|=r,s.pingedLanes&=~r,u&&(s.warmLanes|=r),u=s.expirationTimes;for(var g=r;0<g;){var y=31-xt(g),w=1<<y;u[y]=-1,g&=~w}o!==0&&Kr(s,o,r)}function kh(){return(Xe&6)===0?(fc(0),!1):!0}function Jg(){if(Be!==null){if(tt===0)var s=Be.return;else s=Be,hi=ca=null,fg(s),mo=null,Wl=0,s=Be;for(;s!==null;)Hv(s.alternate,s),s=s.return;Be=null}}function Ao(s,r){var o=s.timeoutHandle;o!==-1&&(s.timeoutHandle=-1,YA(o)),o=s.cancelPendingCommit,o!==null&&(s.cancelPendingCommit=null,o()),xi=0,Jg(),ot=s,Be=o=ci(s.current,null),He=r,tt=0,Mn=null,ir=!1,To=os(s,r),Gg=!1,Eo=Ln=Fg=va=rr=_t=0,Tn=hc=null,Kg=!1,(r&8)!==0&&(r|=r&32);var u=s.entangledLanes;if(u!==0)for(s=s.entanglements,u&=r;0<u;){var g=31-xt(u),y=1<<g;r|=s[g],u&=~y}return wi=r,Xu(),o}function d_(s,r){Me=null,U.H=sc,r===po||r===ah?(r=Cy(),tt=3):r===tg?(r=Cy(),tt=4):tt=r===Rg?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Mn=r,Be===null&&(_t=1,bh(s,Yn(r,s.current)))}function f_(){var s=Dn.current;return s===null?!0:(He&4194048)===He?Xn===null:(He&62914560)===He||(He&536870912)!==0?s===Xn:!1}function g_(){var s=U.H;return U.H=sc,s===null?sc:s}function p_(){var s=U.A;return U.A=AA,s}function Oh(){_t=4,ir||(He&4194048)!==He&&Dn.current!==null||(To=!0),(rr&134217727)===0&&(va&134217727)===0||ot===null||lr(ot,He,Ln,!1)}function Xg(s,r,o){var u=Xe;Xe|=2;var g=g_(),y=p_();(ot!==s||He!==r)&&(Ih=null,Ao(s,r)),r=!1;var w=_t;e:do try{if(tt!==0&&Be!==null){var E=Be,P=Mn;switch(tt){case 8:Jg(),w=6;break e;case 3:case 2:case 9:case 6:Dn.current===null&&(r=!0);var Q=tt;if(tt=0,Mn=null,No(s,E,P,Q),o&&To){w=0;break e}break;default:Q=tt,tt=0,Mn=null,No(s,E,P,Q)}}RA(),w=_t;break}catch(ne){d_(s,ne)}while(!0);return r&&s.shellSuspendCounter++,hi=ca=null,Xe=u,U.H=g,U.A=y,Be===null&&(ot=null,He=0,Xu()),w}function RA(){for(;Be!==null;)m_(Be)}function IA(s,r){var o=Xe;Xe|=2;var u=g_(),g=p_();ot!==s||He!==r?(Ih=null,Rh=gn()+500,Ao(s,r)):To=os(s,r);e:do try{if(tt!==0&&Be!==null){r=Be;var y=Mn;t:switch(tt){case 1:tt=0,Mn=null,No(s,r,y,1);break;case 2:case 9:if(Ay(y)){tt=0,Mn=null,y_(r);break}r=function(){tt!==2&&tt!==9||ot!==s||(tt=7),Ys(s)},y.then(r,r);break e;case 3:tt=7;break e;case 4:tt=5;break e;case 7:Ay(y)?(tt=0,Mn=null,y_(r)):(tt=0,Mn=null,No(s,r,y,7));break;case 5:var w=null;switch(Be.tag){case 26:w=Be.memoizedState;case 5:case 27:var E=Be;if(w?nb(w):E.stateNode.complete){tt=0,Mn=null;var P=E.sibling;if(P!==null)Be=P;else{var Q=E.return;Q!==null?(Be=Q,jh(Q)):Be=null}break t}}tt=0,Mn=null,No(s,r,y,5);break;case 6:tt=0,Mn=null,No(s,r,y,6);break;case 8:Jg(),_t=6;break e;default:throw Error(i(462))}}kA();break}catch(ne){d_(s,ne)}while(!0);return hi=ca=null,U.H=u,U.A=g,Xe=o,Be!==null?0:(ot=null,He=0,Xu(),_t)}function kA(){for(;Be!==null&&!Cf();)m_(Be)}function m_(s){var r=Bv(s.alternate,s,wi);s.memoizedProps=s.pendingProps,r===null?jh(s):Be=r}function y_(s){var r=s,o=r.alternate;switch(r.tag){case 15:case 0:r=Dv(o,r,r.pendingProps,r.type,void 0,He);break;case 11:r=Dv(o,r,r.pendingProps,r.type.render,r.ref,He);break;case 5:fg(r);default:Hv(o,r),r=Be=py(r,wi),r=Bv(o,r,wi)}s.memoizedProps=s.pendingProps,r===null?jh(s):Be=r}function No(s,r,o,u){hi=ca=null,fg(r),mo=null,Wl=0;var g=r.return;try{if(_A(s,g,r,o,He)){_t=1,bh(s,Yn(o,s.current)),Be=null;return}}catch(y){if(g!==null)throw Be=g,y;_t=1,bh(s,Yn(o,s.current)),Be=null;return}r.flags&32768?(Ke||u===1?s=!0:To||(He&536870912)!==0?s=!1:(ir=s=!0,(u===2||u===9||u===3||u===6)&&(u=Dn.current,u!==null&&u.tag===13&&(u.flags|=16384))),v_(r,s)):jh(r)}function jh(s){var r=s;do{if((r.flags&32768)!==0){v_(r,ir);return}s=r.return;var o=xA(r.alternate,r,wi);if(o!==null){Be=o;return}if(r=r.sibling,r!==null){Be=r;return}Be=r=s}while(r!==null);_t===0&&(_t=5)}function v_(s,r){do{var o=TA(s.alternate,s);if(o!==null){o.flags&=32767,Be=o;return}if(o=s.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!r&&(s=s.sibling,s!==null)){Be=s;return}Be=s=o}while(s!==null);_t=6,Be=null}function __(s,r,o,u,g,y,w,E,P){s.cancelPendingCommit=null;do Dh();while(Ht!==0);if((Xe&6)!==0)throw Error(i(327));if(r!==null){if(r===s.current)throw Error(i(177));if(y=r.lanes|r.childLanes,y|=Bf,kf(s,o,y,w,E,P),s===ot&&(Be=ot=null,He=0),So=r,or=s,xi=o,Yg=y,Wg=g,l_=u,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,PA(Ui,function(){return E_(),null})):(s.callbackNode=null,s.callbackPriority=0),u=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||u){u=U.T,U.T=null,g=se.p,se.p=2,w=Xe,Xe|=4;try{EA(s,r,o)}finally{Xe=w,se.p=g,U.T=u}}Ht=1,b_(),w_(),x_()}}function b_(){if(Ht===1){Ht=0;var s=or,r=So,o=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||o){o=U.T,U.T=null;var u=se.p;se.p=2;var g=Xe;Xe|=4;try{e_(r,s);var y=up,w=ay(s.containerInfo),E=y.focusedElem,P=y.selectionRange;if(w!==E&&E&&E.ownerDocument&&ry(E.ownerDocument.documentElement,E)){if(P!==null&&Pf(E)){var Q=P.start,ne=P.end;if(ne===void 0&&(ne=Q),"selectionStart"in E)E.selectionStart=Q,E.selectionEnd=Math.min(ne,E.value.length);else{var re=E.ownerDocument||document,J=re&&re.defaultView||window;if(J.getSelection){var Z=J.getSelection(),_e=E.textContent.length,Ae=Math.min(P.start,_e),at=P.end===void 0?Ae:Math.min(P.end,_e);!Z.extend&&Ae>at&&(w=at,at=Ae,Ae=w);var G=iy(E,Ae),z=iy(E,at);if(G&&z&&(Z.rangeCount!==1||Z.anchorNode!==G.node||Z.anchorOffset!==G.offset||Z.focusNode!==z.node||Z.focusOffset!==z.offset)){var W=re.createRange();W.setStart(G.node,G.offset),Z.removeAllRanges(),Ae>at?(Z.addRange(W),Z.extend(z.node,z.offset)):(W.setEnd(z.node,z.offset),Z.addRange(W))}}}}for(re=[],Z=E;Z=Z.parentNode;)Z.nodeType===1&&re.push({element:Z,left:Z.scrollLeft,top:Z.scrollTop});for(typeof E.focus=="function"&&E.focus(),E=0;E<re.length;E++){var ie=re[E];ie.element.scrollLeft=ie.left,ie.element.scrollTop=ie.top}}Fh=!!cp,up=cp=null}finally{Xe=g,se.p=u,U.T=o}}s.current=r,Ht=2}}function w_(){if(Ht===2){Ht=0;var s=or,r=So,o=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||o){o=U.T,U.T=null;var u=se.p;se.p=2;var g=Xe;Xe|=4;try{Wv(s,r.alternate,r)}finally{Xe=g,se.p=u,U.T=o}}Ht=3}}function x_(){if(Ht===4||Ht===3){Ht=0,Eu();var s=or,r=So,o=xi,u=l_;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Ht=5:(Ht=0,So=or=null,T_(s,s.pendingLanes));var g=s.pendingLanes;if(g===0&&(ar=null),ri(o),r=r.stateNode,Qt&&typeof Qt.onCommitFiberRoot=="function")try{Qt.onCommitFiberRoot(as,r,void 0,(r.current.flags&128)===128)}catch{}if(u!==null){r=U.T,g=se.p,se.p=2,U.T=null;try{for(var y=s.onRecoverableError,w=0;w<u.length;w++){var E=u[w];y(E.value,{componentStack:E.stack})}}finally{U.T=r,se.p=g}}(xi&3)!==0&&Dh(),Ys(s),g=s.pendingLanes,(o&261930)!==0&&(g&42)!==0?s===Qg?dc++:(dc=0,Qg=s):dc=0,fc(0)}}function T_(s,r){(s.pooledCacheLanes&=r)===0&&(r=s.pooledCache,r!=null&&(s.pooledCache=null,Kl(r)))}function Dh(){return b_(),w_(),x_(),E_()}function E_(){if(Ht!==5)return!1;var s=or,r=Yg;Yg=0;var o=ri(xi),u=U.T,g=se.p;try{se.p=32>o?32:o,U.T=null,o=Wg,Wg=null;var y=or,w=xi;if(Ht=0,So=or=null,xi=0,(Xe&6)!==0)throw Error(i(331));var E=Xe;if(Xe|=4,r_(y.current),n_(y,y.current,w,o),Xe=E,fc(0,!1),Qt&&typeof Qt.onPostCommitFiberRoot=="function")try{Qt.onPostCommitFiberRoot(as,y)}catch{}return!0}finally{se.p=g,U.T=u,T_(s,r)}}function S_(s,r,o){r=Yn(o,r),r=Cg(s.stateNode,r,2),s=er(s,r,2),s!==null&&(Fr(s,2),Ys(s))}function nt(s,r,o){if(s.tag===3)S_(s,s,o);else for(;r!==null;){if(r.tag===3){S_(r,s,o);break}else if(r.tag===1){var u=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(ar===null||!ar.has(u))){s=Yn(o,s),o=Av(2),u=er(r,o,2),u!==null&&(Nv(o,u,r,s),Fr(u,2),Ys(u));break}}r=r.return}}function Zg(s,r,o){var u=s.pingCache;if(u===null){u=s.pingCache=new NA;var g=new Set;u.set(r,g)}else g=u.get(r),g===void 0&&(g=new Set,u.set(r,g));g.has(o)||(Gg=!0,g.add(o),s=OA.bind(null,s,r,o),r.then(s,s))}function OA(s,r,o){var u=s.pingCache;u!==null&&u.delete(r),s.pingedLanes|=s.suspendedLanes&o,s.warmLanes&=~o,ot===s&&(He&o)===o&&(_t===4||_t===3&&(He&62914560)===He&&300>gn()-Ch?(Xe&2)===0&&Ao(s,0):Fg|=o,Eo===He&&(Eo=0)),Ys(s)}function A_(s,r){r===0&&(r=Iu()),s=aa(s,r),s!==null&&(Fr(s,r),Ys(s))}function jA(s){var r=s.memoizedState,o=0;r!==null&&(o=r.retryLane),A_(s,o)}function DA(s,r){var o=0;switch(s.tag){case 31:case 13:var u=s.stateNode,g=s.memoizedState;g!==null&&(o=g.retryLane);break;case 19:u=s.stateNode;break;case 22:u=s.stateNode._retryCache;break;default:throw Error(i(314))}u!==null&&u.delete(r),A_(s,o)}function PA(s,r){return zt(s,r)}var Ph=null,Co=null,ep=!1,Mh=!1,tp=!1,cr=0;function Ys(s){s!==Co&&s.next===null&&(Co===null?Ph=Co=s:Co=Co.next=s),Mh=!0,ep||(ep=!0,LA())}function fc(s,r){if(!tp&&Mh){tp=!0;do for(var o=!1,u=Ph;u!==null;){if(s!==0){var g=u.pendingLanes;if(g===0)var y=0;else{var w=u.suspendedLanes,E=u.pingedLanes;y=(1<<31-xt(42|s)+1)-1,y&=g&~(w&~E),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(o=!0,I_(u,y))}else y=He,y=Is(u,u===ot?y:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(y&3)===0||os(u,y)||(o=!0,I_(u,y));u=u.next}while(o);tp=!1}}function MA(){N_()}function N_(){Mh=ep=!1;var s=0;cr!==0&&KA()&&(s=cr);for(var r=gn(),o=null,u=Ph;u!==null;){var g=u.next,y=C_(u,r);y===0?(u.next=null,o===null?Ph=g:o.next=g,g===null&&(Co=o)):(o=u,(s!==0||(y&3)!==0)&&(Mh=!0)),u=g}Ht!==0&&Ht!==5||fc(s),cr!==0&&(cr=0)}function C_(s,r){for(var o=s.suspendedLanes,u=s.pingedLanes,g=s.expirationTimes,y=s.pendingLanes&-62914561;0<y;){var w=31-xt(y),E=1<<w,P=g[w];P===-1?((E&o)===0||(E&u)!==0)&&(g[w]=If(E,r)):P<=r&&(s.expiredLanes|=E),y&=~E}if(r=ot,o=He,o=Is(s,s===r?o:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u=s.callbackNode,o===0||s===r&&(tt===2||tt===9)||s.cancelPendingCommit!==null)return u!==null&&u!==null&&Li(u),s.callbackNode=null,s.callbackPriority=0;if((o&3)===0||os(s,o)){if(r=o&-o,r===s.callbackPriority)return r;switch(u!==null&&Li(u),ri(o)){case 2:case 8:o=Tl;break;case 32:o=Ui;break;case 268435456:o=Su;break;default:o=Ui}return u=R_.bind(null,s),o=zt(o,u),s.callbackPriority=r,s.callbackNode=o,r}return u!==null&&u!==null&&Li(u),s.callbackPriority=2,s.callbackNode=null,2}function R_(s,r){if(Ht!==0&&Ht!==5)return s.callbackNode=null,s.callbackPriority=0,null;var o=s.callbackNode;if(Dh()&&s.callbackNode!==o)return null;var u=He;return u=Is(s,s===ot?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u===0?null:(u_(s,u,r),C_(s,gn()),s.callbackNode!=null&&s.callbackNode===o?R_.bind(null,s):null)}function I_(s,r){if(Dh())return null;u_(s,r,!0)}function LA(){WA(function(){(Xe&6)!==0?zt(xl,MA):N_()})}function np(){if(cr===0){var s=fo;s===0&&(s=Cs,Cs<<=1,(Cs&261888)===0&&(Cs=256)),cr=s}return cr}function k_(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Ja(""+s)}function O_(s,r){var o=r.ownerDocument.createElement("input");return o.name=r.name,o.value=r.value,s.id&&o.setAttribute("form",s.id),r.parentNode.insertBefore(o,r),s=new FormData(s),o.parentNode.removeChild(o),s}function UA(s,r,o,u,g){if(r==="submit"&&o&&o.stateNode===g){var y=k_((g[Gt]||null).action),w=u.submitter;w&&(r=(r=w[Gt]||null)?k_(r.formAction):w.getAttribute("formAction"),r!==null&&(y=r,w=null));var E=new zs("action","action",null,u,g);s.push({event:E,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(cr!==0){var P=w?O_(g,w):new FormData(g);xg(o,{pending:!0,data:P,method:g.method,action:y},null,P)}}else typeof y=="function"&&(E.preventDefault(),P=w?O_(g,w):new FormData(g),xg(o,{pending:!0,data:P,method:g.method,action:y},y,P))},currentTarget:g}]})}}for(var sp=0;sp<Vf.length;sp++){var ip=Vf[sp],VA=ip.toLowerCase(),BA=ip[0].toUpperCase()+ip.slice(1);ps(VA,"on"+BA)}ps(cy,"onAnimationEnd"),ps(uy,"onAnimationIteration"),ps(hy,"onAnimationStart"),ps("dblclick","onDoubleClick"),ps("focusin","onFocus"),ps("focusout","onBlur"),ps(nA,"onTransitionRun"),ps(sA,"onTransitionStart"),ps(iA,"onTransitionCancel"),ps(dy,"onTransitionEnd"),Ls("onMouseEnter",["mouseout","mouseover"]),Ls("onMouseLeave",["mouseout","mouseover"]),Ls("onPointerEnter",["pointerout","pointerover"]),Ls("onPointerLeave",["pointerout","pointerover"]),Ms("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ms("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ms("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ms("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ms("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ms("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var gc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(gc));function j_(s,r){r=(r&4)!==0;for(var o=0;o<s.length;o++){var u=s[o],g=u.event;u=u.listeners;e:{var y=void 0;if(r)for(var w=u.length-1;0<=w;w--){var E=u[w],P=E.instance,Q=E.currentTarget;if(E=E.listener,P!==y&&g.isPropagationStopped())break e;y=E,g.currentTarget=Q;try{y(g)}catch(ne){Ju(ne)}g.currentTarget=null,y=P}else for(w=0;w<u.length;w++){if(E=u[w],P=E.instance,Q=E.currentTarget,E=E.listener,P!==y&&g.isPropagationStopped())break e;y=E,g.currentTarget=Q;try{y(g)}catch(ne){Ju(ne)}g.currentTarget=null,y=P}}}}function ze(s,r){var o=r[Fa];o===void 0&&(o=r[Fa]=new Set);var u=s+"__bubble";o.has(u)||(D_(r,s,2,!1),o.add(u))}function rp(s,r,o){var u=0;r&&(u|=4),D_(o,s,u,r)}var Lh="_reactListening"+Math.random().toString(36).slice(2);function ap(s){if(!s[Lh]){s[Lh]=!0,Al.forEach(function(o){o!=="selectionchange"&&(zA.has(o)||rp(o,!1,s),rp(o,!0,s))});var r=s.nodeType===9?s:s.ownerDocument;r===null||r[Lh]||(r[Lh]=!0,rp("selectionchange",!1,r))}}function D_(s,r,o,u){switch(cb(r)){case 2:var g=p2;break;case 8:g=m2;break;default:g=wp}o=g.bind(null,r,o,s),g=void 0,!Xr||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(g=!0),u?g!==void 0?s.addEventListener(r,o,{capture:!0,passive:g}):s.addEventListener(r,o,!0):g!==void 0?s.addEventListener(r,o,{passive:g}):s.addEventListener(r,o,!1)}function op(s,r,o,u,g){var y=u;if((r&1)===0&&(r&2)===0&&u!==null)e:for(;;){if(u===null)return;var w=u.tag;if(w===3||w===4){var E=u.stateNode.containerInfo;if(E===g)break;if(w===4)for(w=u.return;w!==null;){var P=w.tag;if((P===3||P===4)&&w.stateNode.containerInfo===g)return;w=w.return}for(;E!==null;){if(w=Ds(E),w===null)return;if(P=w.tag,P===5||P===6||P===26||P===27){u=y=w;continue e}E=E.parentNode}}u=u.return}$i(function(){var Q=y,ne=$n(o),re=[];e:{var J=fy.get(s);if(J!==void 0){var Z=zs,_e=s;switch(s){case"keypress":if(ea(o)===0)break e;case"keydown":case"keyup":Z=Yu;break;case"focusin":_e="focus",Z=na;break;case"focusout":_e="blur",Z=na;break;case"beforeblur":case"afterblur":Z=na;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Z=Vl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Z=Vu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Z=v;break;case cy:case uy:case hy:Z=zu;break;case dy:Z=R;break;case"scroll":case"scrollend":Z=Ul;break;case"wheel":Z=X;break;case"copy":case"cut":case"paste":Z=Hu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Z=li;break;case"toggle":case"beforetoggle":Z=Pe}var Ae=(r&4)!==0,at=!Ae&&(s==="scroll"||s==="scrollend"),G=Ae?J!==null?J+"Capture":null:J;Ae=[];for(var z=Q,W;z!==null;){var ie=z;if(W=ie.stateNode,ie=ie.tag,ie!==5&&ie!==26&&ie!==27||W===null||G===null||(ie=hs(z,G),ie!=null&&Ae.push(pc(z,ie,W))),at)break;z=z.return}0<Ae.length&&(J=new Z(J,_e,null,o,ne),re.push({event:J,listeners:Ae}))}}if((r&7)===0){e:{if(J=s==="mouseover"||s==="pointerover",Z=s==="mouseout"||s==="pointerout",J&&o!==Pl&&(_e=o.relatedTarget||o.fromElement)&&(Ds(_e)||_e[Os]))break e;if((Z||J)&&(J=ne.window===ne?ne:(J=ne.ownerDocument)?J.defaultView||J.parentWindow:window,Z?(_e=o.relatedTarget||o.toElement,Z=Q,_e=_e?Ds(_e):null,_e!==null&&(at=l(_e),Ae=_e.tag,_e!==at||Ae!==5&&Ae!==27&&Ae!==6)&&(_e=null)):(Z=null,_e=Q),Z!==_e)){if(Ae=Vl,ie="onMouseLeave",G="onMouseEnter",z="mouse",(s==="pointerout"||s==="pointerover")&&(Ae=li,ie="onPointerLeave",G="onPointerEnter",z="pointer"),at=Z==null?J:In(Z),W=_e==null?J:In(_e),J=new Ae(ie,z+"leave",Z,o,ne),J.target=at,J.relatedTarget=W,ie=null,Ds(ne)===Q&&(Ae=new Ae(G,z+"enter",_e,o,ne),Ae.target=W,Ae.relatedTarget=at,ie=Ae),at=ie,Z&&_e)t:{for(Ae=HA,G=Z,z=_e,W=0,ie=G;ie;ie=Ae(ie))W++;ie=0;for(var Te=z;Te;Te=Ae(Te))ie++;for(;0<W-ie;)G=Ae(G),W--;for(;0<ie-W;)z=Ae(z),ie--;for(;W--;){if(G===z||z!==null&&G===z.alternate){Ae=G;break t}G=Ae(G),z=Ae(z)}Ae=null}else Ae=null;Z!==null&&P_(re,J,Z,Ae,!1),_e!==null&&at!==null&&P_(re,at,_e,Ae,!0)}}e:{if(J=Q?In(Q):window,Z=J.nodeName&&J.nodeName.toLowerCase(),Z==="select"||Z==="input"&&J.type==="file")var We=X0;else if(Q0(J))if(Z0)We=ZS;else{We=JS;var we=QS}else Z=J.nodeName,!Z||Z.toLowerCase()!=="input"||J.type!=="checkbox"&&J.type!=="radio"?Q&&Qa(Q.elementType)&&(We=X0):We=XS;if(We&&(We=We(s,Q))){J0(re,We,o,ne);break e}we&&we(s,J,Q),s==="focusout"&&Q&&J.type==="number"&&Q.memoizedProps.value!=null&&Ol(J,"number",J.value)}switch(we=Q?In(Q):window,s){case"focusin":(Q0(we)||we.contentEditable==="true")&&(io=we,Mf=Q,$l=null);break;case"focusout":$l=Mf=io=null;break;case"mousedown":Lf=!0;break;case"contextmenu":case"mouseup":case"dragend":Lf=!1,oy(re,o,ne);break;case"selectionchange":if(tA)break;case"keydown":case"keyup":oy(re,o,ne)}var Ue;if(Je)e:{switch(s){case"compositionstart":var qe="onCompositionStart";break e;case"compositionend":qe="onCompositionEnd";break e;case"compositionupdate":qe="onCompositionUpdate";break e}qe=void 0}else so?sa(s,o)&&(qe="onCompositionEnd"):s==="keydown"&&o.keyCode===229&&(qe="onCompositionStart");qe&&($s&&o.locale!=="ko"&&(so||qe!=="onCompositionStart"?qe==="onCompositionEnd"&&so&&(Ue=Ll()):(Bs=ne,Ml="value"in Bs?Bs.value:Bs.textContent,so=!0)),we=Uh(Q,qe),0<we.length&&(qe=new qs(qe,s,null,o,ne),re.push({event:qe,listeners:we}),Ue?qe.data=Ue:(Ue=no(o),Ue!==null&&(qe.data=Ue)))),(Ue=Fn?FS(s,o):KS(s,o))&&(qe=Uh(Q,"onBeforeInput"),0<qe.length&&(we=new qs("onBeforeInput","beforeinput",null,o,ne),re.push({event:we,listeners:qe}),we.data=Ue)),UA(re,s,Q,o,ne)}j_(re,r)})}function pc(s,r,o){return{instance:s,listener:r,currentTarget:o}}function Uh(s,r){for(var o=r+"Capture",u=[];s!==null;){var g=s,y=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||y===null||(g=hs(s,o),g!=null&&u.unshift(pc(s,g,y)),g=hs(s,r),g!=null&&u.push(pc(s,g,y))),s.tag===3)return u;s=s.return}return[]}function HA(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function P_(s,r,o,u,g){for(var y=r._reactName,w=[];o!==null&&o!==u;){var E=o,P=E.alternate,Q=E.stateNode;if(E=E.tag,P!==null&&P===u)break;E!==5&&E!==26&&E!==27||Q===null||(P=Q,g?(Q=hs(o,y),Q!=null&&w.unshift(pc(o,Q,P))):g||(Q=hs(o,y),Q!=null&&w.push(pc(o,Q,P)))),o=o.return}w.length!==0&&s.push({event:r,listeners:w})}var qA=/\r\n?/g,$A=/\u0000|\uFFFD/g;function M_(s){return(typeof s=="string"?s:""+s).replace(qA,`
`).replace($A,"")}function L_(s,r){return r=M_(r),M_(s)===r}function rt(s,r,o,u,g,y){switch(o){case"children":typeof u=="string"?r==="body"||r==="textarea"&&u===""||_n(s,u):(typeof u=="number"||typeof u=="bigint")&&r!=="body"&&_n(s,""+u);break;case"className":kn(s,"class",u);break;case"tabIndex":kn(s,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":kn(s,o,u);break;case"style":Dl(s,u,y);break;case"data":if(r!=="object"){kn(s,"data",u);break}case"src":case"href":if(u===""&&(r!=="a"||o!=="href")){s.removeAttribute(o);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(o);break}u=Ja(""+u),s.setAttribute(o,u);break;case"action":case"formAction":if(typeof u=="function"){s.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(o==="formAction"?(r!=="input"&&rt(s,r,"name",g.name,g,null),rt(s,r,"formEncType",g.formEncType,g,null),rt(s,r,"formMethod",g.formMethod,g,null),rt(s,r,"formTarget",g.formTarget,g,null)):(rt(s,r,"encType",g.encType,g,null),rt(s,r,"method",g.method,g,null),rt(s,r,"target",g.target,g,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(o);break}u=Ja(""+u),s.setAttribute(o,u);break;case"onClick":u!=null&&(s.onclick=us);break;case"onScroll":u!=null&&ze("scroll",s);break;case"onScrollEnd":u!=null&&ze("scrollend",s);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(o=u.__html,o!=null){if(g.children!=null)throw Error(i(60));s.innerHTML=o}}break;case"multiple":s.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":s.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){s.removeAttribute("xlink:href");break}o=Ja(""+u),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(o,""+u):s.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(o,""):s.removeAttribute(o);break;case"capture":case"download":u===!0?s.setAttribute(o,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(o,u):s.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?s.setAttribute(o,u):s.removeAttribute(o);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?s.removeAttribute(o):s.setAttribute(o,u);break;case"popover":ze("beforetoggle",s),ze("toggle",s),Ya(s,"popover",u);break;case"xlinkActuate":Ot(s,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Ot(s,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Ot(s,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Ot(s,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Ot(s,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Ot(s,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Ot(s,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Ot(s,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Ot(s,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Ya(s,"is",u);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Uu.get(o)||o,Ya(s,o,u))}}function lp(s,r,o,u,g,y){switch(o){case"style":Dl(s,u,y);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(o=u.__html,o!=null){if(g.children!=null)throw Error(i(60));s.innerHTML=o}}break;case"children":typeof u=="string"?_n(s,u):(typeof u=="number"||typeof u=="bigint")&&_n(s,""+u);break;case"onScroll":u!=null&&ze("scroll",s);break;case"onScrollEnd":u!=null&&ze("scrollend",s);break;case"onClick":u!=null&&(s.onclick=us);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Nl.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(g=o.endsWith("Capture"),r=o.slice(2,g?o.length-7:void 0),y=s[Gt]||null,y=y!=null?y[o]:null,typeof y=="function"&&s.removeEventListener(r,y,g),typeof u=="function")){typeof y!="function"&&y!==null&&(o in s?s[o]=null:s.hasAttribute(o)&&s.removeAttribute(o)),s.addEventListener(r,u,g);break e}o in s?s[o]=u:u===!0?s.setAttribute(o,""):Ya(s,o,u)}}}function tn(s,r,o){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ze("error",s),ze("load",s);var u=!1,g=!1,y;for(y in o)if(o.hasOwnProperty(y)){var w=o[y];if(w!=null)switch(y){case"src":u=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:rt(s,r,y,w,o,null)}}g&&rt(s,r,"srcSet",o.srcSet,o,null),u&&rt(s,r,"src",o.src,o,null);return;case"input":ze("invalid",s);var E=y=w=g=null,P=null,Q=null;for(u in o)if(o.hasOwnProperty(u)){var ne=o[u];if(ne!=null)switch(u){case"name":g=ne;break;case"type":w=ne;break;case"checked":P=ne;break;case"defaultChecked":Q=ne;break;case"value":y=ne;break;case"defaultValue":E=ne;break;case"children":case"dangerouslySetInnerHTML":if(ne!=null)throw Error(i(137,r));break;default:rt(s,r,u,ne,o,null)}}Pu(s,y,E,P,Q,w,g,!1);return;case"select":ze("invalid",s),u=w=y=null;for(g in o)if(o.hasOwnProperty(g)&&(E=o[g],E!=null))switch(g){case"value":y=E;break;case"defaultValue":w=E;break;case"multiple":u=E;default:rt(s,r,g,E,o,null)}r=y,o=w,s.multiple=!!u,r!=null?Bi(s,!!u,r,!1):o!=null&&Bi(s,!!u,o,!0);return;case"textarea":ze("invalid",s),y=g=u=null;for(w in o)if(o.hasOwnProperty(w)&&(E=o[w],E!=null))switch(w){case"value":u=E;break;case"defaultValue":g=E;break;case"children":y=E;break;case"dangerouslySetInnerHTML":if(E!=null)throw Error(i(91));break;default:rt(s,r,w,E,o,null)}zi(s,u,g,y);return;case"option":for(P in o)if(o.hasOwnProperty(P)&&(u=o[P],u!=null))switch(P){case"selected":s.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:rt(s,r,P,u,o,null)}return;case"dialog":ze("beforetoggle",s),ze("toggle",s),ze("cancel",s),ze("close",s);break;case"iframe":case"object":ze("load",s);break;case"video":case"audio":for(u=0;u<gc.length;u++)ze(gc[u],s);break;case"image":ze("error",s),ze("load",s);break;case"details":ze("toggle",s);break;case"embed":case"source":case"link":ze("error",s),ze("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Q in o)if(o.hasOwnProperty(Q)&&(u=o[Q],u!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:rt(s,r,Q,u,o,null)}return;default:if(Qa(r)){for(ne in o)o.hasOwnProperty(ne)&&(u=o[ne],u!==void 0&&lp(s,r,ne,u,o,void 0));return}}for(E in o)o.hasOwnProperty(E)&&(u=o[E],u!=null&&rt(s,r,E,u,o,null))}function GA(s,r,o,u){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,y=null,w=null,E=null,P=null,Q=null,ne=null;for(Z in o){var re=o[Z];if(o.hasOwnProperty(Z)&&re!=null)switch(Z){case"checked":break;case"value":break;case"defaultValue":P=re;default:u.hasOwnProperty(Z)||rt(s,r,Z,null,u,re)}}for(var J in u){var Z=u[J];if(re=o[J],u.hasOwnProperty(J)&&(Z!=null||re!=null))switch(J){case"type":y=Z;break;case"name":g=Z;break;case"checked":Q=Z;break;case"defaultChecked":ne=Z;break;case"value":w=Z;break;case"defaultValue":E=Z;break;case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(i(137,r));break;default:Z!==re&&rt(s,r,J,Z,u,re)}}Wa(s,w,E,P,Q,ne,y,g);return;case"select":Z=w=E=J=null;for(y in o)if(P=o[y],o.hasOwnProperty(y)&&P!=null)switch(y){case"value":break;case"multiple":Z=P;default:u.hasOwnProperty(y)||rt(s,r,y,null,u,P)}for(g in u)if(y=u[g],P=o[g],u.hasOwnProperty(g)&&(y!=null||P!=null))switch(g){case"value":J=y;break;case"defaultValue":E=y;break;case"multiple":w=y;default:y!==P&&rt(s,r,g,y,u,P)}r=E,o=w,u=Z,J!=null?Bi(s,!!o,J,!1):!!u!=!!o&&(r!=null?Bi(s,!!o,r,!0):Bi(s,!!o,o?[]:"",!1));return;case"textarea":Z=J=null;for(E in o)if(g=o[E],o.hasOwnProperty(E)&&g!=null&&!u.hasOwnProperty(E))switch(E){case"value":break;case"children":break;default:rt(s,r,E,null,u,g)}for(w in u)if(g=u[w],y=o[w],u.hasOwnProperty(w)&&(g!=null||y!=null))switch(w){case"value":J=g;break;case"defaultValue":Z=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(i(91));break;default:g!==y&&rt(s,r,w,g,u,y)}Mu(s,J,Z);return;case"option":for(var _e in o)if(J=o[_e],o.hasOwnProperty(_e)&&J!=null&&!u.hasOwnProperty(_e))switch(_e){case"selected":s.selected=!1;break;default:rt(s,r,_e,null,u,J)}for(P in u)if(J=u[P],Z=o[P],u.hasOwnProperty(P)&&J!==Z&&(J!=null||Z!=null))switch(P){case"selected":s.selected=J&&typeof J!="function"&&typeof J!="symbol";break;default:rt(s,r,P,J,u,Z)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ae in o)J=o[Ae],o.hasOwnProperty(Ae)&&J!=null&&!u.hasOwnProperty(Ae)&&rt(s,r,Ae,null,u,J);for(Q in u)if(J=u[Q],Z=o[Q],u.hasOwnProperty(Q)&&J!==Z&&(J!=null||Z!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":if(J!=null)throw Error(i(137,r));break;default:rt(s,r,Q,J,u,Z)}return;default:if(Qa(r)){for(var at in o)J=o[at],o.hasOwnProperty(at)&&J!==void 0&&!u.hasOwnProperty(at)&&lp(s,r,at,void 0,u,J);for(ne in u)J=u[ne],Z=o[ne],!u.hasOwnProperty(ne)||J===Z||J===void 0&&Z===void 0||lp(s,r,ne,J,u,Z);return}}for(var G in o)J=o[G],o.hasOwnProperty(G)&&J!=null&&!u.hasOwnProperty(G)&&rt(s,r,G,null,u,J);for(re in u)J=u[re],Z=o[re],!u.hasOwnProperty(re)||J===Z||J==null&&Z==null||rt(s,r,re,J,u,Z)}function U_(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function FA(){if(typeof performance.getEntriesByType=="function"){for(var s=0,r=0,o=performance.getEntriesByType("resource"),u=0;u<o.length;u++){var g=o[u],y=g.transferSize,w=g.initiatorType,E=g.duration;if(y&&E&&U_(w)){for(w=0,E=g.responseEnd,u+=1;u<o.length;u++){var P=o[u],Q=P.startTime;if(Q>E)break;var ne=P.transferSize,re=P.initiatorType;ne&&U_(re)&&(P=P.responseEnd,w+=ne*(P<E?1:(E-Q)/(P-Q)))}if(--u,r+=8*(y+w)/(g.duration/1e3),s++,10<s)break}}if(0<s)return r/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var cp=null,up=null;function Vh(s){return s.nodeType===9?s:s.ownerDocument}function V_(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function B_(s,r){if(s===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&r==="foreignObject"?0:s}function hp(s,r){return s==="textarea"||s==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var dp=null;function KA(){var s=window.event;return s&&s.type==="popstate"?s===dp?!1:(dp=s,!0):(dp=null,!1)}var z_=typeof setTimeout=="function"?setTimeout:void 0,YA=typeof clearTimeout=="function"?clearTimeout:void 0,H_=typeof Promise=="function"?Promise:void 0,WA=typeof queueMicrotask=="function"?queueMicrotask:typeof H_<"u"?function(s){return H_.resolve(null).then(s).catch(QA)}:z_;function QA(s){setTimeout(function(){throw s})}function ur(s){return s==="head"}function q_(s,r){var o=r,u=0;do{var g=o.nextSibling;if(s.removeChild(o),g&&g.nodeType===8)if(o=g.data,o==="/$"||o==="/&"){if(u===0){s.removeChild(g),Oo(r);return}u--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")u++;else if(o==="html")mc(s.ownerDocument.documentElement);else if(o==="head"){o=s.ownerDocument.head,mc(o);for(var y=o.firstChild;y;){var w=y.nextSibling,E=y.nodeName;y[js]||E==="SCRIPT"||E==="STYLE"||E==="LINK"&&y.rel.toLowerCase()==="stylesheet"||o.removeChild(y),y=w}}else o==="body"&&mc(s.ownerDocument.body);o=g}while(o);Oo(r)}function $_(s,r){var o=s;s=0;do{var u=o.nextSibling;if(o.nodeType===1?r?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(r?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),u&&u.nodeType===8)if(o=u.data,o==="/$"){if(s===0)break;s--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||s++;o=u}while(o)}function fp(s){var r=s.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var o=r;switch(r=r.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":fp(o),Ka(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}s.removeChild(o)}}function JA(s,r,o,u){for(;s.nodeType===1;){var g=o;if(s.nodeName.toLowerCase()!==r.toLowerCase()){if(!u&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(u){if(!s[js])switch(r){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(y=s.getAttribute("rel"),y==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(y!==g.rel||s.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||s.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||s.getAttribute("title")!==(g.title==null?null:g.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(y=s.getAttribute("src"),(y!==(g.src==null?null:g.src)||s.getAttribute("type")!==(g.type==null?null:g.type)||s.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&y&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(r==="input"&&s.type==="hidden"){var y=g.name==null?null:""+g.name;if(g.type==="hidden"&&s.getAttribute("name")===y)return s}else return s;if(s=Zn(s.nextSibling),s===null)break}return null}function XA(s,r,o){if(r==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!o||(s=Zn(s.nextSibling),s===null))return null;return s}function G_(s,r){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!r||(s=Zn(s.nextSibling),s===null))return null;return s}function gp(s){return s.data==="$?"||s.data==="$~"}function pp(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function ZA(s,r){var o=s.ownerDocument;if(s.data==="$~")s._reactRetry=r;else if(s.data!=="$?"||o.readyState!=="loading")r();else{var u=function(){r(),o.removeEventListener("DOMContentLoaded",u)};o.addEventListener("DOMContentLoaded",u),s._reactRetry=u}}function Zn(s){for(;s!=null;s=s.nextSibling){var r=s.nodeType;if(r===1||r===3)break;if(r===8){if(r=s.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return s}var mp=null;function F_(s){s=s.nextSibling;for(var r=0;s;){if(s.nodeType===8){var o=s.data;if(o==="/$"||o==="/&"){if(r===0)return Zn(s.nextSibling);r--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||r++}s=s.nextSibling}return null}function K_(s){s=s.previousSibling;for(var r=0;s;){if(s.nodeType===8){var o=s.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(r===0)return s;r--}else o!=="/$"&&o!=="/&"||r++}s=s.previousSibling}return null}function Y_(s,r,o){switch(r=Vh(o),s){case"html":if(s=r.documentElement,!s)throw Error(i(452));return s;case"head":if(s=r.head,!s)throw Error(i(453));return s;case"body":if(s=r.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function mc(s){for(var r=s.attributes;r.length;)s.removeAttributeNode(r[0]);Ka(s)}var es=new Map,W_=new Set;function Bh(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Ti=se.d;se.d={f:e2,r:t2,D:n2,C:s2,L:i2,m:r2,X:o2,S:a2,M:l2};function e2(){var s=Ti.f(),r=kh();return s||r}function t2(s){var r=qn(s);r!==null&&r.tag===5&&r.type==="form"?dv(r):Ti.r(s)}var Ro=typeof document>"u"?null:document;function Q_(s,r,o){var u=Ro;if(u&&typeof r=="string"&&r){var g=vn(r);g='link[rel="'+s+'"][href="'+g+'"]',typeof o=="string"&&(g+='[crossorigin="'+o+'"]'),W_.has(g)||(W_.add(g),s={rel:s,crossOrigin:o,href:r},u.querySelector(g)===null&&(r=u.createElement("link"),tn(r,"link",s),kt(r),u.head.appendChild(r)))}}function n2(s){Ti.D(s),Q_("dns-prefetch",s,null)}function s2(s,r){Ti.C(s,r),Q_("preconnect",s,r)}function i2(s,r,o){Ti.L(s,r,o);var u=Ro;if(u&&s&&r){var g='link[rel="preload"][as="'+vn(r)+'"]';r==="image"&&o&&o.imageSrcSet?(g+='[imagesrcset="'+vn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(g+='[imagesizes="'+vn(o.imageSizes)+'"]')):g+='[href="'+vn(s)+'"]';var y=g;switch(r){case"style":y=Io(s);break;case"script":y=ko(s)}es.has(y)||(s=b({rel:"preload",href:r==="image"&&o&&o.imageSrcSet?void 0:s,as:r},o),es.set(y,s),u.querySelector(g)!==null||r==="style"&&u.querySelector(yc(y))||r==="script"&&u.querySelector(vc(y))||(r=u.createElement("link"),tn(r,"link",s),kt(r),u.head.appendChild(r)))}}function r2(s,r){Ti.m(s,r);var o=Ro;if(o&&s){var u=r&&typeof r.as=="string"?r.as:"script",g='link[rel="modulepreload"][as="'+vn(u)+'"][href="'+vn(s)+'"]',y=g;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=ko(s)}if(!es.has(y)&&(s=b({rel:"modulepreload",href:s},r),es.set(y,s),o.querySelector(g)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(vc(y)))return}u=o.createElement("link"),tn(u,"link",s),kt(u),o.head.appendChild(u)}}}function a2(s,r,o){Ti.S(s,r,o);var u=Ro;if(u&&s){var g=Ps(u).hoistableStyles,y=Io(s);r=r||"default";var w=g.get(y);if(!w){var E={loading:0,preload:null};if(w=u.querySelector(yc(y)))E.loading=5;else{s=b({rel:"stylesheet",href:s,"data-precedence":r},o),(o=es.get(y))&&yp(s,o);var P=w=u.createElement("link");kt(P),tn(P,"link",s),P._p=new Promise(function(Q,ne){P.onload=Q,P.onerror=ne}),P.addEventListener("load",function(){E.loading|=1}),P.addEventListener("error",function(){E.loading|=2}),E.loading|=4,zh(w,r,u)}w={type:"stylesheet",instance:w,count:1,state:E},g.set(y,w)}}}function o2(s,r){Ti.X(s,r);var o=Ro;if(o&&s){var u=Ps(o).hoistableScripts,g=ko(s),y=u.get(g);y||(y=o.querySelector(vc(g)),y||(s=b({src:s,async:!0},r),(r=es.get(g))&&vp(s,r),y=o.createElement("script"),kt(y),tn(y,"link",s),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},u.set(g,y))}}function l2(s,r){Ti.M(s,r);var o=Ro;if(o&&s){var u=Ps(o).hoistableScripts,g=ko(s),y=u.get(g);y||(y=o.querySelector(vc(g)),y||(s=b({src:s,async:!0,type:"module"},r),(r=es.get(g))&&vp(s,r),y=o.createElement("script"),kt(y),tn(y,"link",s),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},u.set(g,y))}}function J_(s,r,o,u){var g=(g=ke.current)?Bh(g):null;if(!g)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(r=Io(o.href),o=Ps(g).hoistableStyles,u=o.get(r),u||(u={type:"style",instance:null,count:0,state:null},o.set(r,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){s=Io(o.href);var y=Ps(g).hoistableStyles,w=y.get(s);if(w||(g=g.ownerDocument||g,w={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(s,w),(y=g.querySelector(yc(s)))&&!y._p&&(w.instance=y,w.state.loading=5),es.has(s)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},es.set(s,o),y||c2(g,s,o,w.state))),r&&u===null)throw Error(i(528,""));return w}if(r&&u!==null)throw Error(i(529,""));return null;case"script":return r=o.async,o=o.src,typeof o=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=ko(o),o=Ps(g).hoistableScripts,u=o.get(r),u||(u={type:"script",instance:null,count:0,state:null},o.set(r,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function Io(s){return'href="'+vn(s)+'"'}function yc(s){return'link[rel="stylesheet"]['+s+"]"}function X_(s){return b({},s,{"data-precedence":s.precedence,precedence:null})}function c2(s,r,o,u){s.querySelector('link[rel="preload"][as="style"]['+r+"]")?u.loading=1:(r=s.createElement("link"),u.preload=r,r.addEventListener("load",function(){return u.loading|=1}),r.addEventListener("error",function(){return u.loading|=2}),tn(r,"link",o),kt(r),s.head.appendChild(r))}function ko(s){return'[src="'+vn(s)+'"]'}function vc(s){return"script[async]"+s}function Z_(s,r,o){if(r.count++,r.instance===null)switch(r.type){case"style":var u=s.querySelector('style[data-href~="'+vn(o.href)+'"]');if(u)return r.instance=u,kt(u),u;var g=b({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return u=(s.ownerDocument||s).createElement("style"),kt(u),tn(u,"style",g),zh(u,o.precedence,s),r.instance=u;case"stylesheet":g=Io(o.href);var y=s.querySelector(yc(g));if(y)return r.state.loading|=4,r.instance=y,kt(y),y;u=X_(o),(g=es.get(g))&&yp(u,g),y=(s.ownerDocument||s).createElement("link"),kt(y);var w=y;return w._p=new Promise(function(E,P){w.onload=E,w.onerror=P}),tn(y,"link",u),r.state.loading|=4,zh(y,o.precedence,s),r.instance=y;case"script":return y=ko(o.src),(g=s.querySelector(vc(y)))?(r.instance=g,kt(g),g):(u=o,(g=es.get(y))&&(u=b({},o),vp(u,g)),s=s.ownerDocument||s,g=s.createElement("script"),kt(g),tn(g,"link",u),s.head.appendChild(g),r.instance=g);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(u=r.instance,r.state.loading|=4,zh(u,o.precedence,s));return r.instance}function zh(s,r,o){for(var u=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=u.length?u[u.length-1]:null,y=g,w=0;w<u.length;w++){var E=u[w];if(E.dataset.precedence===r)y=E;else if(y!==g)break}y?y.parentNode.insertBefore(s,y.nextSibling):(r=o.nodeType===9?o.head:o,r.insertBefore(s,r.firstChild))}function yp(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.title==null&&(s.title=r.title)}function vp(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.integrity==null&&(s.integrity=r.integrity)}var Hh=null;function eb(s,r,o){if(Hh===null){var u=new Map,g=Hh=new Map;g.set(o,u)}else g=Hh,u=g.get(o),u||(u=new Map,g.set(o,u));if(u.has(s))return u;for(u.set(s,null),o=o.getElementsByTagName(s),g=0;g<o.length;g++){var y=o[g];if(!(y[js]||y[It]||s==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var w=y.getAttribute(r)||"";w=s+w;var E=u.get(w);E?E.push(y):u.set(w,[y])}}return u}function tb(s,r,o){s=s.ownerDocument||s,s.head.insertBefore(o,r==="title"?s.querySelector("head > title"):null)}function u2(s,r,o){if(o===1||r.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;switch(r.rel){case"stylesheet":return s=r.disabled,typeof r.precedence=="string"&&s==null;default:return!0}case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function nb(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function h2(s,r,o,u){if(o.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var g=Io(u.href),y=r.querySelector(yc(g));if(y){r=y._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(s.count++,s=qh.bind(s),r.then(s,s)),o.state.loading|=4,o.instance=y,kt(y);return}y=r.ownerDocument||r,u=X_(u),(g=es.get(g))&&yp(u,g),y=y.createElement("link"),kt(y);var w=y;w._p=new Promise(function(E,P){w.onload=E,w.onerror=P}),tn(y,"link",u),o.instance=y}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(o,r),(r=o.state.preload)&&(o.state.loading&3)===0&&(s.count++,o=qh.bind(s),r.addEventListener("load",o),r.addEventListener("error",o))}}var _p=0;function d2(s,r){return s.stylesheets&&s.count===0&&Gh(s,s.stylesheets),0<s.count||0<s.imgCount?function(o){var u=setTimeout(function(){if(s.stylesheets&&Gh(s,s.stylesheets),s.unsuspend){var y=s.unsuspend;s.unsuspend=null,y()}},6e4+r);0<s.imgBytes&&_p===0&&(_p=62500*FA());var g=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&Gh(s,s.stylesheets),s.unsuspend)){var y=s.unsuspend;s.unsuspend=null,y()}},(s.imgBytes>_p?50:800)+r);return s.unsuspend=o,function(){s.unsuspend=null,clearTimeout(u),clearTimeout(g)}}:null}function qh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Gh(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var $h=null;function Gh(s,r){s.stylesheets=null,s.unsuspend!==null&&(s.count++,$h=new Map,r.forEach(f2,s),$h=null,qh.call(s))}function f2(s,r){if(!(r.state.loading&4)){var o=$h.get(s);if(o)var u=o.get(null);else{o=new Map,$h.set(s,o);for(var g=s.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<g.length;y++){var w=g[y];(w.nodeName==="LINK"||w.getAttribute("media")!=="not all")&&(o.set(w.dataset.precedence,w),u=w)}u&&o.set(null,u)}g=r.instance,w=g.getAttribute("data-precedence"),y=o.get(w)||u,y===u&&o.set(null,g),o.set(w,g),this.count++,u=qh.bind(this),g.addEventListener("load",u),g.addEventListener("error",u),y?y.parentNode.insertBefore(g,y.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(g,s.firstChild)),r.state.loading|=4}}var _c={$$typeof:B,Provider:null,Consumer:null,_currentValue:pe,_currentValue2:pe,_threadCount:0};function g2(s,r,o,u,g,y,w,E,P){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ks(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ks(0),this.hiddenUpdates=ks(null),this.identifierPrefix=u,this.onUncaughtError=g,this.onCaughtError=y,this.onRecoverableError=w,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=P,this.incompleteTransitions=new Map}function sb(s,r,o,u,g,y,w,E,P,Q,ne,re){return s=new g2(s,r,o,w,P,Q,ne,re,E),r=1,y===!0&&(r|=24),y=jn(3,null,null,r),s.current=y,y.stateNode=s,r=Xf(),r.refCount++,s.pooledCache=r,r.refCount++,y.memoizedState={element:u,isDehydrated:o,cache:r},ng(y),s}function ib(s){return s?(s=oo,s):oo}function rb(s,r,o,u,g,y){g=ib(g),u.context===null?u.context=g:u.pendingContext=g,u=Zi(r),u.payload={element:o},y=y===void 0?null:y,y!==null&&(u.callback=y),o=er(s,u,r),o!==null&&(En(o,s,r),Jl(o,s,r))}function ab(s,r){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var o=s.retryLane;s.retryLane=o!==0&&o<r?o:r}}function bp(s,r){ab(s,r),(s=s.alternate)&&ab(s,r)}function ob(s){if(s.tag===13||s.tag===31){var r=aa(s,67108864);r!==null&&En(r,s,67108864),bp(s,67108864)}}function lb(s){if(s.tag===13||s.tag===31){var r=Un();r=Yr(r);var o=aa(s,r);o!==null&&En(o,s,r),bp(s,r)}}var Fh=!0;function p2(s,r,o,u){var g=U.T;U.T=null;var y=se.p;try{se.p=2,wp(s,r,o,u)}finally{se.p=y,U.T=g}}function m2(s,r,o,u){var g=U.T;U.T=null;var y=se.p;try{se.p=8,wp(s,r,o,u)}finally{se.p=y,U.T=g}}function wp(s,r,o,u){if(Fh){var g=xp(u);if(g===null)op(s,r,u,Kh,o),ub(s,u);else if(v2(g,s,r,o,u))u.stopPropagation();else if(ub(s,u),r&4&&-1<y2.indexOf(s)){for(;g!==null;){var y=qn(g);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var w=Rs(y.pendingLanes);if(w!==0){var E=y;for(E.pendingLanes|=2,E.entangledLanes|=2;w;){var P=1<<31-xt(w);E.entanglements[1]|=P,w&=~P}Ys(y),(Xe&6)===0&&(Rh=gn()+500,fc(0))}}break;case 31:case 13:E=aa(y,2),E!==null&&En(E,y,2),kh(),bp(y,2)}if(y=xp(u),y===null&&op(s,r,u,Kh,o),y===g)break;g=y}g!==null&&u.stopPropagation()}else op(s,r,u,null,o)}}function xp(s){return s=$n(s),Tp(s)}var Kh=null;function Tp(s){if(Kh=null,s=Ds(s),s!==null){var r=l(s);if(r===null)s=null;else{var o=r.tag;if(o===13){if(s=c(r),s!==null)return s;s=null}else if(o===31){if(s=d(r),s!==null)return s;s=null}else if(o===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;s=null}else r!==s&&(s=null)}}return Kh=s,null}function cb(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch($r()){case xl:return 2;case Tl:return 8;case Ui:case Rf:return 32;case Su:return 268435456;default:return 32}default:return 32}}var Ep=!1,hr=null,dr=null,fr=null,bc=new Map,wc=new Map,gr=[],y2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function ub(s,r){switch(s){case"focusin":case"focusout":hr=null;break;case"dragenter":case"dragleave":dr=null;break;case"mouseover":case"mouseout":fr=null;break;case"pointerover":case"pointerout":bc.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":wc.delete(r.pointerId)}}function xc(s,r,o,u,g,y){return s===null||s.nativeEvent!==y?(s={blockedOn:r,domEventName:o,eventSystemFlags:u,nativeEvent:y,targetContainers:[g]},r!==null&&(r=qn(r),r!==null&&ob(r)),s):(s.eventSystemFlags|=u,r=s.targetContainers,g!==null&&r.indexOf(g)===-1&&r.push(g),s)}function v2(s,r,o,u,g){switch(r){case"focusin":return hr=xc(hr,s,r,o,u,g),!0;case"dragenter":return dr=xc(dr,s,r,o,u,g),!0;case"mouseover":return fr=xc(fr,s,r,o,u,g),!0;case"pointerover":var y=g.pointerId;return bc.set(y,xc(bc.get(y)||null,s,r,o,u,g)),!0;case"gotpointercapture":return y=g.pointerId,wc.set(y,xc(wc.get(y)||null,s,r,o,u,g)),!0}return!1}function hb(s){var r=Ds(s.target);if(r!==null){var o=l(r);if(o!==null){if(r=o.tag,r===13){if(r=c(o),r!==null){s.blockedOn=r,ls(s.priority,function(){lb(o)});return}}else if(r===31){if(r=d(o),r!==null){s.blockedOn=r,ls(s.priority,function(){lb(o)});return}}else if(r===3&&o.stateNode.current.memoizedState.isDehydrated){s.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Yh(s){if(s.blockedOn!==null)return!1;for(var r=s.targetContainers;0<r.length;){var o=xp(s.nativeEvent);if(o===null){o=s.nativeEvent;var u=new o.constructor(o.type,o);Pl=u,o.target.dispatchEvent(u),Pl=null}else return r=qn(o),r!==null&&ob(r),s.blockedOn=o,!1;r.shift()}return!0}function db(s,r,o){Yh(s)&&o.delete(r)}function _2(){Ep=!1,hr!==null&&Yh(hr)&&(hr=null),dr!==null&&Yh(dr)&&(dr=null),fr!==null&&Yh(fr)&&(fr=null),bc.forEach(db),wc.forEach(db)}function Wh(s,r){s.blockedOn===r&&(s.blockedOn=null,Ep||(Ep=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,_2)))}var Qh=null;function fb(s){Qh!==s&&(Qh=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Qh===s&&(Qh=null);for(var r=0;r<s.length;r+=3){var o=s[r],u=s[r+1],g=s[r+2];if(typeof u!="function"){if(Tp(u||o)===null)continue;break}var y=qn(o);y!==null&&(s.splice(r,3),r-=3,xg(y,{pending:!0,data:g,method:o.method,action:u},u,g))}}))}function Oo(s){function r(P){return Wh(P,s)}hr!==null&&Wh(hr,s),dr!==null&&Wh(dr,s),fr!==null&&Wh(fr,s),bc.forEach(r),wc.forEach(r);for(var o=0;o<gr.length;o++){var u=gr[o];u.blockedOn===s&&(u.blockedOn=null)}for(;0<gr.length&&(o=gr[0],o.blockedOn===null);)hb(o),o.blockedOn===null&&gr.shift();if(o=(s.ownerDocument||s).$$reactFormReplay,o!=null)for(u=0;u<o.length;u+=3){var g=o[u],y=o[u+1],w=g[Gt]||null;if(typeof y=="function")w||fb(o);else if(w){var E=null;if(y&&y.hasAttribute("formAction")){if(g=y,w=y[Gt]||null)E=w.formAction;else if(Tp(g)!==null)continue}else E=w.action;typeof E=="function"?o[u+1]=E:(o.splice(u,3),u-=3),fb(o)}}}function gb(){function s(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(w){return g=w})},focusReset:"manual",scroll:"manual"})}function r(){g!==null&&(g(),g=null),u||setTimeout(o,20)}function o(){if(!u&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,g=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(o,100),function(){u=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),g!==null&&(g(),g=null)}}}function Sp(s){this._internalRoot=s}Jh.prototype.render=Sp.prototype.render=function(s){var r=this._internalRoot;if(r===null)throw Error(i(409));var o=r.current,u=Un();rb(o,u,s,r,null,null)},Jh.prototype.unmount=Sp.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var r=s.containerInfo;rb(s.current,2,null,s,null,null),kh(),r[Os]=null}};function Jh(s){this._internalRoot=s}Jh.prototype.unstable_scheduleHydration=function(s){if(s){var r=ku();s={blockedOn:null,target:s,priority:r};for(var o=0;o<gr.length&&r!==0&&r<gr[o].priority;o++);gr.splice(o,0,s),o===0&&hb(s)}};var pb=e.version;if(pb!=="19.2.3")throw Error(i(527,pb,"19.2.3"));se.findDOMNode=function(s){var r=s._reactInternals;if(r===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=m(r),s=s!==null?_(s):null,s=s===null?null:s.stateNode,s};var b2={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:U,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xh.isDisabled&&Xh.supportsFiber)try{as=Xh.inject(b2),Qt=Xh}catch{}}return Ec.createRoot=function(s,r){if(!a(s))throw Error(i(299));var o=!1,u="",g=xv,y=Tv,w=Ev;return r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(u=r.identifierPrefix),r.onUncaughtError!==void 0&&(g=r.onUncaughtError),r.onCaughtError!==void 0&&(y=r.onCaughtError),r.onRecoverableError!==void 0&&(w=r.onRecoverableError)),r=sb(s,1,!1,null,null,o,u,null,g,y,w,gb),s[Os]=r.current,ap(s),new Sp(r)},Ec.hydrateRoot=function(s,r,o){if(!a(s))throw Error(i(299));var u=!1,g="",y=xv,w=Tv,E=Ev,P=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(g=o.identifierPrefix),o.onUncaughtError!==void 0&&(y=o.onUncaughtError),o.onCaughtError!==void 0&&(w=o.onCaughtError),o.onRecoverableError!==void 0&&(E=o.onRecoverableError),o.formState!==void 0&&(P=o.formState)),r=sb(s,1,!0,r,o??null,u,g,P,y,w,E,gb),r.context=ib(null),o=r.current,u=Un(),u=Yr(u),g=Zi(u),g.callback=null,er(o,g,u),o=u,r.current.lanes=o,Fr(r,o),Ys(r),s[Os]=r.current,ap(s),new Jh(r)},Ec.version="19.2.3",Ec}var Sb;function I2(){if(Sb)return Cp.exports;Sb=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Cp.exports=R2(),Cp.exports}var k2=I2();const O2=fT(k2);var Ws;(function(n){n.STRING="string",n.NUMBER="number",n.INTEGER="integer",n.BOOLEAN="boolean",n.ARRAY="array",n.OBJECT="object"})(Ws||(Ws={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ab;(function(n){n.LANGUAGE_UNSPECIFIED="language_unspecified",n.PYTHON="python"})(Ab||(Ab={}));var Nb;(function(n){n.OUTCOME_UNSPECIFIED="outcome_unspecified",n.OUTCOME_OK="outcome_ok",n.OUTCOME_FAILED="outcome_failed",n.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"})(Nb||(Nb={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cb=["user","model","function","system"];var Rb;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(Rb||(Rb={}));var Ib;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(Ib||(Ib={}));var kb;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(kb||(kb={}));var Ob;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER"})(Ob||(Ob={}));var Mc;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.OTHER="OTHER"})(Mc||(Mc={}));var jb;(function(n){n.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",n.RETRIEVAL_QUERY="RETRIEVAL_QUERY",n.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",n.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",n.CLASSIFICATION="CLASSIFICATION",n.CLUSTERING="CLUSTERING"})(jb||(jb={}));var Db;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE"})(Db||(Db={}));var Pb;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(Pb||(Pb={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn extends Error{constructor(e){super(`[GoogleGenerativeAI Error]: ${e}`)}}class jo extends dn{constructor(e,t){super(e),this.response=t}}class gT extends dn{constructor(e,t,i,a){super(e),this.status=t,this.statusText=i,this.errorDetails=a}}class Er extends dn{}class pT extends dn{}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j2="https://generativelanguage.googleapis.com",D2="v1beta",P2="0.24.1",M2="genai-js";var Oa;(function(n){n.GENERATE_CONTENT="generateContent",n.STREAM_GENERATE_CONTENT="streamGenerateContent",n.COUNT_TOKENS="countTokens",n.EMBED_CONTENT="embedContent",n.BATCH_EMBED_CONTENTS="batchEmbedContents"})(Oa||(Oa={}));class L2{constructor(e,t,i,a,l){this.model=e,this.task=t,this.apiKey=i,this.stream=a,this.requestOptions=l}toString(){var e,t;const i=((e=this.requestOptions)===null||e===void 0?void 0:e.apiVersion)||D2;let l=`${((t=this.requestOptions)===null||t===void 0?void 0:t.baseUrl)||j2}/${i}/${this.model}:${this.task}`;return this.stream&&(l+="?alt=sse"),l}}function U2(n){const e=[];return n!=null&&n.apiClient&&e.push(n.apiClient),e.push(`${M2}/${P2}`),e.join(" ")}async function V2(n){var e;const t=new Headers;t.append("Content-Type","application/json"),t.append("x-goog-api-client",U2(n.requestOptions)),t.append("x-goog-api-key",n.apiKey);let i=(e=n.requestOptions)===null||e===void 0?void 0:e.customHeaders;if(i){if(!(i instanceof Headers))try{i=new Headers(i)}catch(a){throw new Er(`unable to convert customHeaders value ${JSON.stringify(i)} to Headers: ${a.message}`)}for(const[a,l]of i.entries()){if(a==="x-goog-api-key")throw new Er(`Cannot set reserved header name ${a}`);if(a==="x-goog-api-client")throw new Er(`Header name ${a} can only be set using the apiClient field`);t.append(a,l)}}return t}async function B2(n,e,t,i,a,l){const c=new L2(n,e,t,i,l);return{url:c.toString(),fetchOptions:Object.assign(Object.assign({},$2(l)),{method:"POST",headers:await V2(c),body:a})}}async function lu(n,e,t,i,a,l={},c=fetch){const{url:d,fetchOptions:p}=await B2(n,e,t,i,a,l);return z2(d,p,c)}async function z2(n,e,t=fetch){let i;try{i=await t(n,e)}catch(a){H2(a,n)}return i.ok||await q2(i,n),i}function H2(n,e){let t=n;throw t.name==="AbortError"?(t=new pT(`Request aborted when fetching ${e.toString()}: ${n.message}`),t.stack=n.stack):n instanceof gT||n instanceof Er||(t=new dn(`Error fetching from ${e.toString()}: ${n.message}`),t.stack=n.stack),t}async function q2(n,e){let t="",i;try{const a=await n.json();t=a.error.message,a.error.details&&(t+=` ${JSON.stringify(a.error.details)}`,i=a.error.details)}catch{}throw new gT(`Error fetching from ${e.toString()}: [${n.status} ${n.statusText}] ${t}`,n.status,n.statusText,i)}function $2(n){const e={};if((n==null?void 0:n.signal)!==void 0||(n==null?void 0:n.timeout)>=0){const t=new AbortController;(n==null?void 0:n.timeout)>=0&&setTimeout(()=>t.abort(),n.timeout),n!=null&&n.signal&&n.signal.addEventListener("abort",()=>{t.abort()}),e.signal=t.signal}return e}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wm(n){return n.text=()=>{if(n.candidates&&n.candidates.length>0){if(n.candidates.length>1&&console.warn(`This response had ${n.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),fd(n.candidates[0]))throw new jo(`${yr(n)}`,n);return G2(n)}else if(n.promptFeedback)throw new jo(`Text not available. ${yr(n)}`,n);return""},n.functionCall=()=>{if(n.candidates&&n.candidates.length>0){if(n.candidates.length>1&&console.warn(`This response had ${n.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),fd(n.candidates[0]))throw new jo(`${yr(n)}`,n);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),Mb(n)[0]}else if(n.promptFeedback)throw new jo(`Function call not available. ${yr(n)}`,n)},n.functionCalls=()=>{if(n.candidates&&n.candidates.length>0){if(n.candidates.length>1&&console.warn(`This response had ${n.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),fd(n.candidates[0]))throw new jo(`${yr(n)}`,n);return Mb(n)}else if(n.promptFeedback)throw new jo(`Function call not available. ${yr(n)}`,n)},n}function G2(n){var e,t,i,a;const l=[];if(!((t=(e=n.candidates)===null||e===void 0?void 0:e[0].content)===null||t===void 0)&&t.parts)for(const c of(a=(i=n.candidates)===null||i===void 0?void 0:i[0].content)===null||a===void 0?void 0:a.parts)c.text&&l.push(c.text),c.executableCode&&l.push("\n```"+c.executableCode.language+`
`+c.executableCode.code+"\n```\n"),c.codeExecutionResult&&l.push("\n```\n"+c.codeExecutionResult.output+"\n```\n");return l.length>0?l.join(""):""}function Mb(n){var e,t,i,a;const l=[];if(!((t=(e=n.candidates)===null||e===void 0?void 0:e[0].content)===null||t===void 0)&&t.parts)for(const c of(a=(i=n.candidates)===null||i===void 0?void 0:i[0].content)===null||a===void 0?void 0:a.parts)c.functionCall&&l.push(c.functionCall);if(l.length>0)return l}const F2=[Mc.RECITATION,Mc.SAFETY,Mc.LANGUAGE];function fd(n){return!!n.finishReason&&F2.includes(n.finishReason)}function yr(n){var e,t,i;let a="";if((!n.candidates||n.candidates.length===0)&&n.promptFeedback)a+="Response was blocked",!((e=n.promptFeedback)===null||e===void 0)&&e.blockReason&&(a+=` due to ${n.promptFeedback.blockReason}`),!((t=n.promptFeedback)===null||t===void 0)&&t.blockReasonMessage&&(a+=`: ${n.promptFeedback.blockReasonMessage}`);else if(!((i=n.candidates)===null||i===void 0)&&i[0]){const l=n.candidates[0];fd(l)&&(a+=`Candidate was blocked due to ${l.finishReason}`,l.finishMessage&&(a+=`: ${l.finishMessage}`))}return a}function Fc(n){return this instanceof Fc?(this.v=n,this):new Fc(n)}function K2(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),a,l=[];return a={},c("next"),c("throw"),c("return"),a[Symbol.asyncIterator]=function(){return this},a;function c(x){i[x]&&(a[x]=function(S){return new Promise(function(N,j){l.push([x,S,N,j])>1||d(x,S)})})}function d(x,S){try{p(i[x](S))}catch(N){b(l[0][3],N)}}function p(x){x.value instanceof Fc?Promise.resolve(x.value.v).then(m,_):b(l[0][2],x)}function m(x){d("next",x)}function _(x){d("throw",x)}function b(x,S){x(S),l.shift(),l.length&&d(l[0][0],l[0][1])}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lb=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function Y2(n){const e=n.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),t=J2(e),[i,a]=t.tee();return{stream:Q2(i),response:W2(a)}}async function W2(n){const e=[],t=n.getReader();for(;;){const{done:i,value:a}=await t.read();if(i)return Wm(X2(e));e.push(a)}}function Q2(n){return K2(this,arguments,function*(){const t=n.getReader();for(;;){const{value:i,done:a}=yield Fc(t.read());if(a)break;yield yield Fc(Wm(i))}})}function J2(n){const e=n.getReader();return new ReadableStream({start(i){let a="";return l();function l(){return e.read().then(({value:c,done:d})=>{if(d){if(a.trim()){i.error(new dn("Failed to parse stream"));return}i.close();return}a+=c;let p=a.match(Lb),m;for(;p;){try{m=JSON.parse(p[1])}catch{i.error(new dn(`Error parsing JSON response: "${p[1]}"`));return}i.enqueue(m),a=a.substring(p[0].length),p=a.match(Lb)}return l()}).catch(c=>{let d=c;throw d.stack=c.stack,d.name==="AbortError"?d=new pT("Request aborted when reading from the stream"):d=new dn("Error reading from the stream"),d})}}})}function X2(n){const e=n[n.length-1],t={promptFeedback:e==null?void 0:e.promptFeedback};for(const i of n){if(i.candidates){let a=0;for(const l of i.candidates)if(t.candidates||(t.candidates=[]),t.candidates[a]||(t.candidates[a]={index:a}),t.candidates[a].citationMetadata=l.citationMetadata,t.candidates[a].groundingMetadata=l.groundingMetadata,t.candidates[a].finishReason=l.finishReason,t.candidates[a].finishMessage=l.finishMessage,t.candidates[a].safetyRatings=l.safetyRatings,l.content&&l.content.parts){t.candidates[a].content||(t.candidates[a].content={role:l.content.role||"user",parts:[]});const c={};for(const d of l.content.parts)d.text&&(c.text=d.text),d.functionCall&&(c.functionCall=d.functionCall),d.executableCode&&(c.executableCode=d.executableCode),d.codeExecutionResult&&(c.codeExecutionResult=d.codeExecutionResult),Object.keys(c).length===0&&(c.text=""),t.candidates[a].content.parts.push(c)}a++}i.usageMetadata&&(t.usageMetadata=i.usageMetadata)}return t}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mT(n,e,t,i){const a=await lu(e,Oa.STREAM_GENERATE_CONTENT,n,!0,JSON.stringify(t),i);return Y2(a)}async function yT(n,e,t,i){const l=await(await lu(e,Oa.GENERATE_CONTENT,n,!1,JSON.stringify(t),i)).json();return{response:Wm(l)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vT(n){if(n!=null){if(typeof n=="string")return{role:"system",parts:[{text:n}]};if(n.text)return{role:"system",parts:[n]};if(n.parts)return n.role?n:{role:"system",parts:n.parts}}}function Kc(n){let e=[];if(typeof n=="string")e=[{text:n}];else for(const t of n)typeof t=="string"?e.push({text:t}):e.push(t);return Z2(e)}function Z2(n){const e={role:"user",parts:[]},t={role:"function",parts:[]};let i=!1,a=!1;for(const l of n)"functionResponse"in l?(t.parts.push(l),a=!0):(e.parts.push(l),i=!0);if(i&&a)throw new dn("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!i&&!a)throw new dn("No content is provided for sending chat message.");return i?e:t}function eN(n,e){var t;let i={model:e==null?void 0:e.model,generationConfig:e==null?void 0:e.generationConfig,safetySettings:e==null?void 0:e.safetySettings,tools:e==null?void 0:e.tools,toolConfig:e==null?void 0:e.toolConfig,systemInstruction:e==null?void 0:e.systemInstruction,cachedContent:(t=e==null?void 0:e.cachedContent)===null||t===void 0?void 0:t.name,contents:[]};const a=n.generateContentRequest!=null;if(n.contents){if(a)throw new Er("CountTokensRequest must have one of contents or generateContentRequest, not both.");i.contents=n.contents}else if(a)i=Object.assign(Object.assign({},i),n.generateContentRequest);else{const l=Kc(n);i.contents=[l]}return{generateContentRequest:i}}function Ub(n){let e;return n.contents?e=n:e={contents:[Kc(n)]},n.systemInstruction&&(e.systemInstruction=vT(n.systemInstruction)),e}function tN(n){return typeof n=="string"||Array.isArray(n)?{content:Kc(n)}:n}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vb=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],nN={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function sN(n){let e=!1;for(const t of n){const{role:i,parts:a}=t;if(!e&&i!=="user")throw new dn(`First content should be with role 'user', got ${i}`);if(!Cb.includes(i))throw new dn(`Each item should include role field. Got ${i} but valid roles are: ${JSON.stringify(Cb)}`);if(!Array.isArray(a))throw new dn("Content should have 'parts' property with an array of Parts");if(a.length===0)throw new dn("Each Content should have at least one part");const l={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(const d of a)for(const p of Vb)p in d&&(l[p]+=1);const c=nN[i];for(const d of Vb)if(!c.includes(d)&&l[d]>0)throw new dn(`Content with role '${i}' can't contain '${d}' part`);e=!0}}function Bb(n){var e;if(n.candidates===void 0||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;if(t===void 0||t.parts===void 0||t.parts.length===0)return!1;for(const i of t.parts)if(i===void 0||Object.keys(i).length===0||i.text!==void 0&&i.text==="")return!1;return!0}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zb="SILENT_ERROR";class iN{constructor(e,t,i,a={}){this.model=t,this.params=i,this._requestOptions=a,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=e,i!=null&&i.history&&(sN(i.history),this._history=i.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(e,t={}){var i,a,l,c,d,p;await this._sendPromise;const m=Kc(e),_={safetySettings:(i=this.params)===null||i===void 0?void 0:i.safetySettings,generationConfig:(a=this.params)===null||a===void 0?void 0:a.generationConfig,tools:(l=this.params)===null||l===void 0?void 0:l.tools,toolConfig:(c=this.params)===null||c===void 0?void 0:c.toolConfig,systemInstruction:(d=this.params)===null||d===void 0?void 0:d.systemInstruction,cachedContent:(p=this.params)===null||p===void 0?void 0:p.cachedContent,contents:[...this._history,m]},b=Object.assign(Object.assign({},this._requestOptions),t);let x;return this._sendPromise=this._sendPromise.then(()=>yT(this._apiKey,this.model,_,b)).then(S=>{var N;if(Bb(S.response)){this._history.push(m);const j=Object.assign({parts:[],role:"model"},(N=S.response.candidates)===null||N===void 0?void 0:N[0].content);this._history.push(j)}else{const j=yr(S.response);j&&console.warn(`sendMessage() was unsuccessful. ${j}. Inspect response object for details.`)}x=S}).catch(S=>{throw this._sendPromise=Promise.resolve(),S}),await this._sendPromise,x}async sendMessageStream(e,t={}){var i,a,l,c,d,p;await this._sendPromise;const m=Kc(e),_={safetySettings:(i=this.params)===null||i===void 0?void 0:i.safetySettings,generationConfig:(a=this.params)===null||a===void 0?void 0:a.generationConfig,tools:(l=this.params)===null||l===void 0?void 0:l.tools,toolConfig:(c=this.params)===null||c===void 0?void 0:c.toolConfig,systemInstruction:(d=this.params)===null||d===void 0?void 0:d.systemInstruction,cachedContent:(p=this.params)===null||p===void 0?void 0:p.cachedContent,contents:[...this._history,m]},b=Object.assign(Object.assign({},this._requestOptions),t),x=mT(this._apiKey,this.model,_,b);return this._sendPromise=this._sendPromise.then(()=>x).catch(S=>{throw new Error(zb)}).then(S=>S.response).then(S=>{if(Bb(S)){this._history.push(m);const N=Object.assign({},S.candidates[0].content);N.role||(N.role="model"),this._history.push(N)}else{const N=yr(S);N&&console.warn(`sendMessageStream() was unsuccessful. ${N}. Inspect response object for details.`)}}).catch(S=>{S.message!==zb&&console.error(S)}),x}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rN(n,e,t,i){return(await lu(e,Oa.COUNT_TOKENS,n,!1,JSON.stringify(t),i)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aN(n,e,t,i){return(await lu(e,Oa.EMBED_CONTENT,n,!1,JSON.stringify(t),i)).json()}async function oN(n,e,t,i){const a=t.requests.map(c=>Object.assign(Object.assign({},c),{model:e}));return(await lu(e,Oa.BATCH_EMBED_CONTENTS,n,!1,JSON.stringify({requests:a}),i)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hb{constructor(e,t,i={}){this.apiKey=e,this._requestOptions=i,t.model.includes("/")?this.model=t.model:this.model=`models/${t.model}`,this.generationConfig=t.generationConfig||{},this.safetySettings=t.safetySettings||[],this.tools=t.tools,this.toolConfig=t.toolConfig,this.systemInstruction=vT(t.systemInstruction),this.cachedContent=t.cachedContent}async generateContent(e,t={}){var i;const a=Ub(e),l=Object.assign(Object.assign({},this._requestOptions),t);return yT(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(i=this.cachedContent)===null||i===void 0?void 0:i.name},a),l)}async generateContentStream(e,t={}){var i;const a=Ub(e),l=Object.assign(Object.assign({},this._requestOptions),t);return mT(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(i=this.cachedContent)===null||i===void 0?void 0:i.name},a),l)}startChat(e){var t;return new iN(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(t=this.cachedContent)===null||t===void 0?void 0:t.name},e),this._requestOptions)}async countTokens(e,t={}){const i=eN(e,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),a=Object.assign(Object.assign({},this._requestOptions),t);return rN(this.apiKey,this.model,i,a)}async embedContent(e,t={}){const i=tN(e),a=Object.assign(Object.assign({},this._requestOptions),t);return aN(this.apiKey,this.model,i,a)}async batchEmbedContents(e,t={}){const i=Object.assign(Object.assign({},this._requestOptions),t);return oN(this.apiKey,this.model,e,i)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xd{constructor(e){this.apiKey=e}getGenerativeModel(e,t){if(!e.model)throw new dn("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new Hb(this.apiKey,e,t)}getGenerativeModelFromCachedContent(e,t,i){if(!e.name)throw new Er("Cached content must contain a `name` field.");if(!e.model)throw new Er("Cached content must contain a `model` field.");const a=["model","systemInstruction"];for(const c of a)if(t!=null&&t[c]&&e[c]&&(t==null?void 0:t[c])!==e[c]){if(c==="model"){const d=t.model.startsWith("models/")?t.model.replace("models/",""):t.model,p=e.model.startsWith("models/")?e.model.replace("models/",""):e.model;if(d===p)continue}throw new Er(`Different value for "${c}" specified in modelParams (${t[c]}) and cachedContent (${e[c]})`)}const l=Object.assign(Object.assign({},t),{model:e.model,tools:e.tools,toolConfig:e.toolConfig,systemInstruction:e.systemInstruction,cachedContent:e});return new Hb(this.apiKey,l,i)}}const Op={},lN=["gemini-flash-latest","gemini-1.5-flash","gemini-2.0-flash-lite-preview-02-05","gemini-2.5-flash","gemini-2.0-flash-lite-001","gemini-2.0-flash","gemini-2.5-pro"];let am=[];const om=n=>{am=n.filter(e=>e.trim()!=="")},cN=n=>{let e=[];n&&(e=n.split(/[\n,]+/).map(i=>i.trim()).filter(i=>i));const t=Op==null?void 0:Op.VITE_GEMINI_API_KEY;if(t){const i=t.split(",").map(a=>a.trim()).filter(a=>a);e=[...e,...i]}return am.length>0&&(e=[...e,...am]),[...new Set(e)]},Va=async(n,e)=>{const t=cN(n);if(t.length===0)throw new Error("No API Keys provided. Please configure VITE_GEMINI_API_KEY or enter a key.");let i;for(const a of t){const l=new Xd(a);for(const c of lN)try{const d=l.getGenerativeModel({model:c});return await e(d)}catch(d){console.warn(`Failed: Key(...${a.slice(-4)}) Model(${c}) error: ${d.message}`),i=d}}throw i||new Error("All keys and models failed to generate content.")},uN=async(n,e)=>Va(e,async t=>{const i=`
        c ton b "Kch bn i th" sau v phn tch theo quy tc:
        Kch bn: """${n}"""

        Mc tiu: Rt ra khung xng cu trc cm xc (Hook, Build-up, Value/Twist, CTA).
        
        Yu cu:
        1. Xc nh ranh gii phn theo chc nng cm xc.
        2. Vi tng phn m t: Ni dung chnh, Cm xc ch o, Cch truyn ti cm xc, L do hiu qu.
        3. Rt ra: 3 yu t ct li, c im ngn ng & tit tu (5-8 im), 3 pattern cm xc.
        
        Rng buc: Khng thm nhn vt/bi cnh ngoi script. Khng nh gi cm tnh. 
        KT THC BNG MT ON RING BIT C TIU  "PHONG CCH I TH" lit k cc c im phong cch  bc sau s dng.
      `;return(await t.generateContent(i)).response.text()}),hN=async(n,e)=>Va(e,async t=>{const i=`
        Da trn kt qu phn tch khung xng sau:
        """${n}"""
        
        Nhim v: Sng to ra 5  tng ni dung video mi, gi nguyn "linh hn cm xc" ca kch bn gc.
        
        Mi  tng gm:
        - Tiu  ngn
        - M t ni dung (3-5 cu)
        - Nhn vt/Bi cnh
        - Gi tr ni bt (Cm xc/Thc tin)
        - Kh nng lan truyn

        Response must be a valid JSON array matching the schema:
        [{ "id": number, "title": string, "description": string, "charactersContext": string, "highlightValue": string, "viralPotential": string }]
      `,a=await t.generateContent({contents:[{role:"user",parts:[{text:i}]}],generationConfig:{responseMimeType:"application/json"}});return JSON.parse(a.response.text())}),dN=async(n,e,t,i)=>Va(i,async a=>{const l=`
        Xy dng dn  chi tit da trn:
        - Khung xng gc: """${n}"""
        -  tng chn: """${JSON.stringify(e)}"""
        - Tng s t mc tiu: ${t}

        Cu trc: Gi nguyn form gc (Hook -> Build-up -> Value/Twist -> CTA).
        Yu cu: Vi mi phn nu r: Mc tiu, Cm xc chnh, Ni dung trin khai, Lin kt trc-sau, S t phn b.
      `;return(await a.generateContent(l)).response.text()}),fN=async(n,e,t="VN",i)=>{const l={VN:"Vietnamese",EN:"English",JA:"Japanese",KO:"Korean",ZH:"Chinese"}[t]||t;return Va(i,async c=>{const d=`
        Vit li thoi kch bn hon chnh (voice-ready) da trn dn  v phong cch sau:
        - Dn : """${n}"""
        - Phong cch m phng: """${e}"""

        NGN NG U RA BT BUC: ${l}.
        Ton b ni dung kch bn phi c vit bng ${l}.

        QUY TC NGHIM NGT:
        1. Ch tr v li thoi sch 100%. Khng tiu , khng ch thch, khng ngoc ( ), khng nhc nn.
        2. Vit lin mch theo th t Hook -> Build-up -> Value/Twist -> CTA.
      `;return(await c.generateContent(d)).response.text()})},gN=async(n,e,t)=>Va(t,async i=>{const a=`
        Da trn kch bn video sau:
        """${n}"""
        
        Hy chn ra 1 phong cch hnh nh ph hp nht t danh sch sau:
        ${e.join(", ")}
        
        Ch tr v duy nht tn ID ca phong cch , khng gii thch g thm.
      `;return(await i.generateContent(a)).response.text().trim()}),pN=async(n,e,t)=>Va(t,async i=>{const a=`
        Da trn kch bn sau v phong cch hnh nh [${e}]:
        Kch bn: """${n}"""
        
        Hy thit k chi tit cc nhn vt xut hin trong kch bn. Nu kch bn khng m t r, hy t sng to chi tit  m bo tnh thm m v ng b.
        
        QUY TC BT BUC: 
        1. Phn "bodyType" (Dng ngi): Ghi CC K NGN GN (v d: "Cao gy", "Mp mp", "Cn i", "Vm v").
        2. Phn "facialDetails" (c im khun mt): 
           - Nu kch bn thiu, hy t thm cho y  nhng phi M T GN GNG, KHNG LNG NHNG, KHNG VN HOA. 
           - CH C M T TRNG THI BNH THNG/TRUNG TNH (Neutral expression).
           - TUYT I KHNG a vo cm xc hay tnh hung c th (v d: KHNG ghi "ang khc", "mt lm lem", "ci nham him"). Ch m t cu trc vt l (mt, mi, ming, da, tc...).

        Tr v nh dng JSON mng cc i tng:
        - name: Tn nhn vt
        - gender: Gii tnh
        - country: Quc gia/Chng tc
        - age:  tui
        - bodyType: Dng ngi (ngn gn nht c th)
        - facialDetails: c im chi tit khun mt (cu trc vt l, gn gng, khng cm xc)
      `,l=await i.generateContent({contents:[{role:"user",parts:[{text:a}]}],generationConfig:{responseMimeType:"application/json"}});return JSON.parse(l.response.text())}),mN=async(n,e,t,i="VN",a)=>{const c={VN:"Vietnamese",EN:"English",JA:"Japanese",KO:"Korean",ZH:"Chinese"}[i]||i;return Va(a,async d=>{const p=t.map(b=>`[Nhn vt: ${b.name} | Gii tnh: ${b.gender} | Quc gia: ${b.country} | Tui: ${b.age} | Dng ngi: ${b.bodyType} | Khun mt: ${b.facialDetails}]`).join(`
`),m=`
        Bn l mt CHUYN GIA PHN TCH TNH HUNG v o din hnh nh i ti.
        Nhim v: Phn tch kch bn sau  trch xut cc hnh ng quay (Shot Action).

        Kch bn: """${n}"""
        
        NGN NG U RA BT BUC cho ni dung text (Action, VoiceText): ${c}.

        QUY TC PHN LOI NI DUNG (CC K QUAN TRNG):
        1. "Master Transcript" (voiceText): CH CHA LI THOI CA NHN VT (Dialogue) m nhn vt thc s ni ra (trc tip). Phi dch sang ${c}.
        2. "Shot Execution" (action): Cha m t hnh ng (Visual Action) V li dn chuyn (Narrator/Voiceover) V cc m thanh nn/hnh ng khng li. Phi dch sang ${c}.

        THNG TIN NHN VT GC (BT BUC PHI SAO CHP CHNH XC KHI NHC N):
        ${p}

        NGUYN TC PHN TCH TNH HUNG (SITUATIONAL ANALYSIS):
        1. QUAN ST NG CNH: Da vo ni dung lin trc (nu c) v lin sau ca mi hnh ng, hy suy lun logic xem nhn vt no ANG C MT trong cnh .
        2. D ON NHN VT: Nu kch bn khng nhc tn nhng logic tnh hung cho thy nhn vt  phi   (v d: ang i thoi, ang ng cnh), BT BUC phi a h vo.
        3. HIN TH TRONG 'ACTION': Trong trng 'action' (M t ngn hnh ng), hy lit k tn cc nhn vt c mt u tin t trong du ngoc N ( ), v d: (Nam, Lan): ..., sau  n m t hnh ng.

        QUY TC TO PROMPT (Strict Compliance - Rules Override All):

        1. [VISUAL STYLE]: Lun bt u bng phong cch: [${e}].

        2. [Bi cnh] (Context Memory):
           - Nu kch bn khng nu r, hy thm chi tit (bn gh,  vt, b cc...).
           - QUAN TRNG: Ghi nh bi cnh. Nu cha i cnh, DNG LI m t bi cnh c. Nu i cnh, thit lp bi cnh mi chi tit v ghi nh cho cc shot sau.

        3. [QUY TC] (Safety & Quality):
           - Lun thm vo prompt: [NO duplication, NO mutation, NO anatomical distortion, Any violation of anatomy rules is forbidden]

        4. [CAMERA]: Gc my, chuyn ng my (Cinematic wording).

        5. [ACTION] (Character Consistency):
           - Khi nhc n nhn vt no, BT BUC COPY NGUYN VN "c im nhn vt" (Gii tnh, Tui, Dng, Khun mt) t thng tin gc vo prompt.
           - TUYT I KHNG ghi tt, KHNG tm tt, KHNG dng "nh trn". Phi copy full.
           - Nu shot c nhn vt khc, cng copy full c im ca h vo.

        6. [Trang Phc] (Costume Memory):
           - Nu kch bn khng nu, t thm v ghi r mu sc.
           - QUAN TRNG: Gi nguyn trang phc xuyn sut cc shot nu cha i thi gian/cnh.

        7. [AUDIO/VOICE  LIP SYNC]:
           - Cu trc: [Tn nhn vt ni: "Li thoi trong Master Transcript"] (CH LI THOI TRC TIP).
           - Li dn chuyn (Narrator) phi a vo phn ACTION, KHNG a vo y.

        8. [SPEECH SYNC]:
           - Nu c li thoi  mc trn, BT BUC ghi tag: [Chuyn ng ming nhn vt ng b vi li thoi].

        9. [TECHNICAL]: nh sng, mu sc (Lighting, Color).

        10. [S LNG NHN VT]:
           - Nu trong cnh (Shot) ch c DUY NHT 1 nhn vt xut hin, BT BUC thm cu lnh ny vo cui phn ACTION: "The scene contains EXACTLY ONE character".
           - Nu c t 2 nhn vt tr ln, KHNG C thm cu ny.

        CU TRC PROMPT VIDEO (Video Motion Ai Prompt - Output String):
        [${e}], [Bi cnh chi tit], [NO duplication, NO mutation, NO anatomical distortion, Any violation of anatomy rules is forbidden], [CAMERA], [ACTION: Tn NV + (c im Full Copy) + Hnh ng. (Thm 'The scene contains EXACTLY ONE character' nn ch c 1 NV)], [Trang phc], [AUDIO/VOICE  LIP SYNC], [SPEECH SYNC], [TECHNICAL]

        TR V JSON Array cc object:
        - action: (Tn cc NV c mt): [M t hnh ng]
        - voiceText: Li thoi (nu c - KHNG BAO GM NARRATOR)
        - motionPrompt: Prompt video (Tun th cu trc trn)
      `,_=await d.generateContent({contents:[{role:"user",parts:[{text:m}]}],generationConfig:{responseMimeType:"application/json"}});return JSON.parse(_.response.text())})},yN=({userId:n})=>{const[e,t]=le.useState(!1),[i,a]=le.useState(!1),[l,c]=le.useState({gemini:"",chatgpt:"",openrouter:""}),[d,p]=le.useState(!1),m=k=>{try{return btoa(k)}catch{return k}},_=k=>{try{return atob(k)}catch{return k}},b=`app_api_keys_${n}`;le.useEffect(()=>{const k=localStorage.getItem(b);if(!k){c({gemini:"",chatgpt:"",openrouter:""}),om([]);return}if(k)try{const L=JSON.parse(k),H={gemini:_(L.gemini||""),chatgpt:_(L.chatgpt||""),openrouter:_(L.openrouter||"")};c(H),H.gemini&&x(H.gemini)}catch(L){console.error("Failed to parse keys",L)}},[n]);const x=k=>{const L=k.split(`
`).map(H=>H.trim()).filter(H=>H!=="");om(L)},S=()=>{if(!(l.gemini.trim()!==""||l.chatgpt.trim()!==""||l.openrouter.trim()!=="")){alert("Li: Bn phi nhp t nht 1 API Key vo mt trong 3 mc  tip tc!");return}const L={gemini:m(l.gemini),chatgpt:m(l.chatgpt),openrouter:m(l.openrouter)};localStorage.setItem(b,JSON.stringify(L)),l.gemini&&x(l.gemini),p(!0),setTimeout(()=>p(!1),3e3)},N=(k,L)=>{c(H=>({...H,[k]:L}))},j=()=>f.jsx("div",{className:"absolute inset-0 bg-slate-900/90 backdrop-blur-sm flex items-center justify-center cursor-pointer z-10 rounded-lg border border-slate-700/50",onClick:()=>a(!0),children:f.jsxs("span",{className:"text-slate-400 text-xs font-medium flex items-center gap-2",children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}),"Click to Show Keys"]})});return f.jsxs("div",{className:"w-full bg-[#0f172a] border-b border-white/10 relative z-[200]",children:[f.jsxs("div",{className:"px-6 py-2 flex items-center justify-between cursor-pointer hover:bg-white/5 transition-all text-xs font-bold uppercase tracking-widest text-slate-400",onClick:()=>t(!e),children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("svg",{className:`w-4 h-4 transition-transform ${e?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})}),f.jsxs("span",{children:["API Configuration Manager",f.jsxs("span",{className:"ml-2 text-indigo-400 normal-case tracking-normal opacity-70",children:["(User: ",n.replace("user_","Account ")," - ",i?"Visible":"Hidden",")"]}),d&&f.jsx("span",{className:"text-emerald-400 ml-4 animate-in fade-in slide-in-from-left-2 normal-case tracking-normal",children:" Saved!"})]})]}),f.jsxs("div",{className:"flex gap-4 items-center",children:[f.jsx("button",{onClick:k=>{k.stopPropagation(),a(!i)},className:"text-[10px] bg-slate-800 px-2 py-1 rounded hover:bg-slate-700 transition",children:i?"Hide Keys":"Show Keys"}),f.jsxs("div",{className:"flex gap-4 opacity-50",children:[f.jsxs("span",{children:["Gemini: ",l.gemini?l.gemini.split(`
`).filter(k=>k.trim()).length:0]}),f.jsx("span",{className:"opacity-30",children:"|"}),f.jsxs("span",{children:["GPT: ",l.chatgpt?l.chatgpt.split(`
`).filter(k=>k.trim()).length:0]}),f.jsx("span",{className:"opacity-30",children:"|"}),f.jsxs("span",{children:["OR: ",l.openrouter?l.openrouter.split(`
`).filter(k=>k.trim()).length:0]})]})]})]}),e&&f.jsxs("div",{className:"p-6 grid grid-cols-1 md:grid-cols-3 gap-6 animate-in slide-in-from-top-2 duration-300 bg-black/20",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"text-[10px] uppercase font-black text-indigo-400 tracking-widest",children:"Google Gemini Keys"}),f.jsxs("div",{className:"relative group",children:[!i&&f.jsx(j,{}),f.jsx("textarea",{value:l.gemini,onChange:k=>N("gemini",k.target.value),placeholder:`AIzaSy...
AIzaSy...`,rows:4,disabled:!i,className:`w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 text-white text-xs font-mono focus:border-indigo-500 focus:ring-1 outline-none transition-all resize-y ${i?"":"blur-sm select-none"}`})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"text-[10px] uppercase font-black text-emerald-400 tracking-widest",children:"ChatGPT Keys"}),f.jsxs("div",{className:"relative group",children:[!i&&f.jsx(j,{}),f.jsx("textarea",{value:l.chatgpt,onChange:k=>N("chatgpt",k.target.value),placeholder:`sk-...
sk-...`,rows:4,disabled:!i,className:`w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 text-white text-xs font-mono focus:border-emerald-500 focus:ring-1 outline-none transition-all resize-y ${i?"":"blur-sm select-none"}`})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"text-[10px] uppercase font-black text-rose-400 tracking-widest",children:"OpenRouter Keys"}),f.jsxs("div",{className:"relative group",children:[!i&&f.jsx(j,{}),f.jsx("textarea",{value:l.openrouter,onChange:k=>N("openrouter",k.target.value),placeholder:`sk-or-...
sk-or-...`,rows:4,disabled:!i,className:`w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 text-white text-xs font-mono focus:border-rose-500 focus:ring-1 outline-none transition-all resize-y ${i?"":"blur-sm select-none"}`})]})]}),f.jsxs("div",{className:"md:col-span-3 flex flex-col md:flex-row items-center justify-between mt-2 gap-4",children:[f.jsxs("p",{className:"text-[10px] text-slate-500 italic text-center md:text-left",children:["* Bo mt: Key lu ring cho ti khon ",f.jsx("b",{children:n}),". ",f.jsx("br",{}),"H thng t ng xoay vng key khi chy."]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:async()=>{const k=l.gemini.split(`
`).map(H=>H.trim()).filter(H=>H!=="");if(k.length===0){alert("Vui lng nhp v LU t nht 1 API Key Gemini trc khi test!");return}const L=k[0];try{const B=await(await fetch(`https://generativelanguage.googleapis.com/v1beta/models?key=${L}`)).json();if(B.error)alert(`Li: ${B.error.message}`);else if(B.models){const K=B.models.map(F=>F.name.replace("models/","")).slice(0,10).join(", ");alert(`Kt ni OK! C ${B.models.length} models:
${K}`)}else alert("Phn hi l: "+JSON.stringify(B))}catch(H){alert("Li mng: "+H.message)}},className:"bg-blue-600/20 text-blue-400 font-bold uppercase text-xs px-6 py-3 rounded-xl hover:bg-blue-600/30 transition-all border border-blue-600/30",children:"Test Local"}),f.jsx("button",{onClick:S,className:"bg-white text-slate-900 font-black uppercase text-xs px-8 py-3 rounded-xl hover:bg-slate-200 active:scale-95 transition-all shadow-lg flex items-center gap-2",children:"Lu cu hnh (Save)"})]})]})]})]})},vN=()=>{};var qb={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _T=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let a=n.charCodeAt(i);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(a=65536+((a&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},_N=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const a=n[t++];if(a<128)e[i++]=String.fromCharCode(a);else if(a>191&&a<224){const l=n[t++];e[i++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=n[t++],c=n[t++],d=n[t++],p=((a&7)<<18|(l&63)<<12|(c&63)<<6|d&63)-65536;e[i++]=String.fromCharCode(55296+(p>>10)),e[i++]=String.fromCharCode(56320+(p&1023))}else{const l=n[t++],c=n[t++];e[i++]=String.fromCharCode((a&15)<<12|(l&63)<<6|c&63)}}return e.join("")},bT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let a=0;a<n.length;a+=3){const l=n[a],c=a+1<n.length,d=c?n[a+1]:0,p=a+2<n.length,m=p?n[a+2]:0,_=l>>2,b=(l&3)<<4|d>>4;let x=(d&15)<<2|m>>6,S=m&63;p||(S=64,c||(x=64)),i.push(t[_],t[b],t[x],t[S])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(_T(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):_N(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let a=0;a<n.length;){const l=t[n.charAt(a++)],d=a<n.length?t[n.charAt(a)]:0;++a;const m=a<n.length?t[n.charAt(a)]:64;++a;const b=a<n.length?t[n.charAt(a)]:64;if(++a,l==null||d==null||m==null||b==null)throw new bN;const x=l<<2|d>>4;if(i.push(x),m!==64){const S=d<<4&240|m>>2;if(i.push(S),b!==64){const N=m<<6&192|b;i.push(N)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class bN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const wN=function(n){const e=_T(n);return bT.encodeByteArray(e,!0)},Ed=function(n){return wN(n).replace(/\./g,"")},wT=function(n){try{return bT.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TN=()=>xN().__FIREBASE_DEFAULTS__,EN=()=>{if(typeof process>"u"||typeof qb>"u")return;const n=qb.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},SN=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&wT(n[1]);return e&&JSON.parse(e)},Zd=()=>{try{return vN()||TN()||EN()||SN()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},xT=n=>{var e,t;return(t=(e=Zd())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},TT=n=>{const e=xT(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},ET=()=>{var n;return(n=Zd())==null?void 0:n.config},ST=n=>{var e;return(e=Zd())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let AN=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}};/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ba(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Qm(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AT(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",a=n.iat||0,l=n.sub||n.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c={iss:`https://securetoken.google.com/${i}`,aud:i,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Ed(JSON.stringify(t)),Ed(JSON.stringify(c)),""].join(".")}const Lc={};function NN(){const n={prod:[],emulator:[]};for(const e of Object.keys(Lc))Lc[e]?n.emulator.push(e):n.prod.push(e);return n}function CN(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let $b=!1;function Jm(n,e){if(typeof window>"u"||typeof document>"u"||!Ba(window.location.host)||Lc[n]===e||Lc[n]||$b)return;Lc[n]=e;function t(x){return`__firebase__banner__${x}`}const i="__firebase__banner",l=NN().prod.length>0;function c(){const x=document.getElementById(i);x&&x.remove()}function d(x){x.style.display="flex",x.style.background="#7faaf0",x.style.position="fixed",x.style.bottom="5px",x.style.left="5px",x.style.padding=".5em",x.style.borderRadius="5px",x.style.alignItems="center"}function p(x,S){x.setAttribute("width","24"),x.setAttribute("id",S),x.setAttribute("height","24"),x.setAttribute("viewBox","0 0 24 24"),x.setAttribute("fill","none"),x.style.marginLeft="-6px"}function m(){const x=document.createElement("span");return x.style.cursor="pointer",x.style.marginLeft="16px",x.style.fontSize="24px",x.innerHTML=" &times;",x.onclick=()=>{$b=!0,c()},x}function _(x,S){x.setAttribute("id",S),x.innerText="Learn more",x.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",x.setAttribute("target","__blank"),x.style.paddingLeft="5px",x.style.textDecoration="underline"}function b(){const x=CN(i),S=t("text"),N=document.getElementById(S)||document.createElement("span"),j=t("learnmore"),k=document.getElementById(j)||document.createElement("a"),L=t("preprendIcon"),H=document.getElementById(L)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(x.created){const B=x.element;d(B),_(k,j);const K=m();p(H,L),B.append(H,N,k,K),document.body.appendChild(B)}l?(N.innerText="Preview backend disconnected.",H.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(H.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,N.innerText="Preview backend running in this workspace."),N.setAttribute("id",S)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",b):b()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function RN(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(fn())}function IN(){var e;const n=(e=Zd())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function kN(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function NT(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function ON(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function jN(){const n=fn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function DN(){return!IN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function CT(){try{return typeof indexedDB=="object"}catch{return!1}}function RT(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(i);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{var l;e(((l=a.error)==null?void 0:l.message)||"")}}catch(t){e(t)}})}function PN(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MN="FirebaseError";class rs extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=MN,Object.setPrototypeOf(this,rs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,za.prototype.create)}}class za{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},a=`${this.service}/${e}`,l=this.errors[e],c=l?LN(l,i):"Error",d=`${this.serviceName}: ${c} (${a}).`;return new rs(a,d,i)}}function LN(n,e){return n.replace(UN,(t,i)=>{const a=e[i];return a!=null?String(a):`<${i}?>`})}const UN=/\{\$([^}]+)}/g;function VN(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Ir(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const a of t){if(!i.includes(a))return!1;const l=n[a],c=e[a];if(Gb(l)&&Gb(c)){if(!Ir(l,c))return!1}else if(l!==c)return!1}for(const a of i)if(!t.includes(a))return!1;return!0}function Gb(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cu(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(a=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Cc(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[a,l]=i.split("=");e[decodeURIComponent(a)]=decodeURIComponent(l)}}),e}function Rc(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function BN(n,e){const t=new zN(n,e);return t.subscribe.bind(t)}class zN{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let a;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");HN(e,["next","error","complete"])?a=e:a={next:e,error:t,complete:i},a.next===void 0&&(a.next=jp),a.error===void 0&&(a.error=jp),a.complete===void 0&&(a.complete=jp);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function HN(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function jp(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qN=1e3,$N=2,GN=14400*1e3,FN=.5;function Fb(n,e=qN,t=$N){const i=e*Math.pow(t,n),a=Math.round(FN*i*(Math.random()-.5)*2);return Math.min(GN,i+a)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mt(n){return n&&n._delegate?n._delegate:n}class ss{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wa="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KN{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new AN;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&i.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(a){if(i)return null;throw a}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(WN(e))try{this.getOrInitializeService({instanceIdentifier:wa})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:a});i.resolve(l)}catch{}}}}clearInstance(e=wa){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=wa){return this.instances.has(e)}getOptions(e=wa){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[l,c]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(l);i===d&&c.resolve(a)}return a}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),a=this.onInitCallbacks.get(i)??new Set;a.add(e),this.onInitCallbacks.set(i,a);const l=this.instances.get(i);return l&&e(l,i),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const a of i)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:YN(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=wa){return this.component?this.component.multipleInstances?e:wa:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function YN(n){return n===wa?void 0:n}function WN(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new KN(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $e;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})($e||($e={}));const JN={debug:$e.DEBUG,verbose:$e.VERBOSE,info:$e.INFO,warn:$e.WARN,error:$e.ERROR,silent:$e.SILENT},XN=$e.INFO,ZN={[$e.DEBUG]:"log",[$e.VERBOSE]:"log",[$e.INFO]:"info",[$e.WARN]:"warn",[$e.ERROR]:"error"},eC=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),a=ZN[e];if(a)console[a](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class ef{constructor(e){this.name=e,this._logLevel=XN,this._logHandler=eC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in $e))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?JN[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,$e.DEBUG,...e),this._logHandler(this,$e.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,$e.VERBOSE,...e),this._logHandler(this,$e.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,$e.INFO,...e),this._logHandler(this,$e.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,$e.WARN,...e),this._logHandler(this,$e.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,$e.ERROR,...e),this._logHandler(this,$e.ERROR,...e)}}const tC=(n,e)=>e.some(t=>n instanceof t);let Kb,Yb;function nC(){return Kb||(Kb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function sC(){return Yb||(Yb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const IT=new WeakMap,lm=new WeakMap,kT=new WeakMap,Dp=new WeakMap,Xm=new WeakMap;function iC(n){const e=new Promise((t,i)=>{const a=()=>{n.removeEventListener("success",l),n.removeEventListener("error",c)},l=()=>{t(Sr(n.result)),a()},c=()=>{i(n.error),a()};n.addEventListener("success",l),n.addEventListener("error",c)});return e.then(t=>{t instanceof IDBCursor&&IT.set(t,n)}).catch(()=>{}),Xm.set(e,n),e}function rC(n){if(lm.has(n))return;const e=new Promise((t,i)=>{const a=()=>{n.removeEventListener("complete",l),n.removeEventListener("error",c),n.removeEventListener("abort",c)},l=()=>{t(),a()},c=()=>{i(n.error||new DOMException("AbortError","AbortError")),a()};n.addEventListener("complete",l),n.addEventListener("error",c),n.addEventListener("abort",c)});lm.set(n,e)}let cm={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return lm.get(n);if(e==="objectStoreNames")return n.objectStoreNames||kT.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Sr(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function aC(n){cm=n(cm)}function oC(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Pp(this),e,...t);return kT.set(i,e.sort?e.sort():[e]),Sr(i)}:sC().includes(n)?function(...e){return n.apply(Pp(this),e),Sr(IT.get(this))}:function(...e){return Sr(n.apply(Pp(this),e))}}function lC(n){return typeof n=="function"?oC(n):(n instanceof IDBTransaction&&rC(n),tC(n,nC())?new Proxy(n,cm):n)}function Sr(n){if(n instanceof IDBRequest)return iC(n);if(Dp.has(n))return Dp.get(n);const e=lC(n);return e!==n&&(Dp.set(n,e),Xm.set(e,n)),e}const Pp=n=>Xm.get(n);function OT(n,e,{blocked:t,upgrade:i,blocking:a,terminated:l}={}){const c=indexedDB.open(n,e),d=Sr(c);return i&&c.addEventListener("upgradeneeded",p=>{i(Sr(c.result),p.oldVersion,p.newVersion,Sr(c.transaction),p)}),t&&c.addEventListener("blocked",p=>t(p.oldVersion,p.newVersion,p)),d.then(p=>{l&&p.addEventListener("close",()=>l()),a&&p.addEventListener("versionchange",m=>a(m.oldVersion,m.newVersion,m))}).catch(()=>{}),d}const cC=["get","getKey","getAll","getAllKeys","count"],uC=["put","add","delete","clear"],Mp=new Map;function Wb(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Mp.get(e))return Mp.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,a=uC.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(a||cC.includes(t)))return;const l=async function(c,...d){const p=this.transaction(c,a?"readwrite":"readonly");let m=p.store;return i&&(m=m.index(d.shift())),(await Promise.all([m[t](...d),a&&p.done]))[0]};return Mp.set(e,l),l}aC(n=>({...n,get:(e,t,i)=>Wb(e,t)||n.get(e,t,i),has:(e,t)=>!!Wb(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hC{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(dC(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function dC(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const um="@firebase/app",Qb="0.14.7";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ii=new ef("@firebase/app"),fC="@firebase/app-compat",gC="@firebase/analytics-compat",pC="@firebase/analytics",mC="@firebase/app-check-compat",yC="@firebase/app-check",vC="@firebase/auth",_C="@firebase/auth-compat",bC="@firebase/database",wC="@firebase/data-connect",xC="@firebase/database-compat",TC="@firebase/functions",EC="@firebase/functions-compat",SC="@firebase/installations",AC="@firebase/installations-compat",NC="@firebase/messaging",CC="@firebase/messaging-compat",RC="@firebase/performance",IC="@firebase/performance-compat",kC="@firebase/remote-config",OC="@firebase/remote-config-compat",jC="@firebase/storage",DC="@firebase/storage-compat",PC="@firebase/firestore",MC="@firebase/ai",LC="@firebase/firestore-compat",UC="firebase",VC="12.8.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hm="[DEFAULT]",BC={[um]:"fire-core",[fC]:"fire-core-compat",[pC]:"fire-analytics",[gC]:"fire-analytics-compat",[yC]:"fire-app-check",[mC]:"fire-app-check-compat",[vC]:"fire-auth",[_C]:"fire-auth-compat",[bC]:"fire-rtdb",[wC]:"fire-data-connect",[xC]:"fire-rtdb-compat",[TC]:"fire-fn",[EC]:"fire-fn-compat",[SC]:"fire-iid",[AC]:"fire-iid-compat",[NC]:"fire-fcm",[CC]:"fire-fcm-compat",[RC]:"fire-perf",[IC]:"fire-perf-compat",[kC]:"fire-rc",[OC]:"fire-rc-compat",[jC]:"fire-gcs",[DC]:"fire-gcs-compat",[PC]:"fire-fst",[LC]:"fire-fst-compat",[MC]:"fire-vertex","fire-js":"fire-js",[UC]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sd=new Map,zC=new Map,dm=new Map;function Jb(n,e){try{n.container.addComponent(e)}catch(t){Ii.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Es(n){const e=n.name;if(dm.has(e))return Ii.debug(`There were multiple attempts to register component ${e}.`),!1;dm.set(e,n);for(const t of Sd.values())Jb(t,n);for(const t of zC.values())Jb(t,n);return!0}function Lr(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function An(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HC={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ar=new za("app","Firebase",HC);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qC{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new ss("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ar.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ha=VC;function jT(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:hm,automaticDataCollectionEnabled:!0,...e},a=i.name;if(typeof a!="string"||!a)throw Ar.create("bad-app-name",{appName:String(a)});if(t||(t=ET()),!t)throw Ar.create("no-options");const l=Sd.get(a);if(l){if(Ir(t,l.options)&&Ir(i,l.config))return l;throw Ar.create("duplicate-app",{appName:a})}const c=new QN(a);for(const p of dm.values())c.addComponent(p);const d=new qC(t,i,c);return Sd.set(a,d),d}function tf(n=hm){const e=Sd.get(n);if(!e&&n===hm&&ET())return jT();if(!e)throw Ar.create("no-app",{appName:n});return e}function Cn(n,e,t){let i=BC[n]??n;t&&(i+=`-${t}`);const a=i.match(/\s|\//),l=e.match(/\s|\//);if(a||l){const c=[`Unable to register library "${i}" with version "${e}":`];a&&c.push(`library name "${i}" contains illegal characters (whitespace or "/")`),a&&l&&c.push("and"),l&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ii.warn(c.join(" "));return}Es(new ss(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $C="firebase-heartbeat-database",GC=1,Yc="firebase-heartbeat-store";let Lp=null;function DT(){return Lp||(Lp=OT($C,GC,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Yc)}catch(t){console.warn(t)}}}}).catch(n=>{throw Ar.create("idb-open",{originalErrorMessage:n.message})})),Lp}async function FC(n){try{const t=(await DT()).transaction(Yc),i=await t.objectStore(Yc).get(PT(n));return await t.done,i}catch(e){if(e instanceof rs)Ii.warn(e.message);else{const t=Ar.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ii.warn(t.message)}}}async function Xb(n,e){try{const i=(await DT()).transaction(Yc,"readwrite");await i.objectStore(Yc).put(e,PT(n)),await i.done}catch(t){if(t instanceof rs)Ii.warn(t.message);else{const i=Ar.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Ii.warn(i.message)}}}function PT(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KC=1024,YC=30;class WC{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new JC(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=Zb();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(c=>c.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:a}),this._heartbeatsCache.heartbeats.length>YC){const c=XC(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(c,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){Ii.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Zb(),{heartbeatsToSend:i,unsentEntries:a}=QC(this._heartbeatsCache.heartbeats),l=Ed(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(t){return Ii.warn(t),""}}}function Zb(){return new Date().toISOString().substring(0,10)}function QC(n,e=KC){const t=[];let i=n.slice();for(const a of n){const l=t.find(c=>c.agent===a.agent);if(l){if(l.dates.push(a.date),ew(t)>e){l.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),ew(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class JC{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return CT()?RT().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await FC(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Xb(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Xb(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function ew(n){return Ed(JSON.stringify({version:2,heartbeats:n})).length}function XC(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZC(n){Es(new ss("platform-logger",e=>new hC(e),"PRIVATE")),Es(new ss("heartbeat",e=>new WC(e),"PRIVATE")),Cn(um,Qb,n),Cn(um,Qb,"esm2020"),Cn("fire-js","")}ZC("");var eR="firebase",tR="12.8.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Cn(eR,tR,"app");const MT="@firebase/installations",Zm="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LT=1e4,UT=`w:${Zm}`,VT="FIS_v2",nR="https://firebaseinstallations.googleapis.com/v1",sR=3600*1e3,iR="installations",rR="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aR={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},ja=new za(iR,rR,aR);function BT(n){return n instanceof rs&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zT({projectId:n}){return`${nR}/projects/${n}/installations`}function HT(n){return{token:n.token,requestStatus:2,expiresIn:lR(n.expiresIn),creationTime:Date.now()}}async function qT(n,e){const i=(await e.json()).error;return ja.create("request-failed",{requestName:n,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function $T({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function oR(n,{refreshToken:e}){const t=$T(n);return t.append("Authorization",cR(e)),t}async function GT(n){const e=await n();return e.status>=500&&e.status<600?n():e}function lR(n){return Number(n.replace("s","000"))}function cR(n){return`${VT} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uR({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const i=zT(n),a=$T(n),l=e.getImmediate({optional:!0});if(l){const m=await l.getHeartbeatsHeader();m&&a.append("x-firebase-client",m)}const c={fid:t,authVersion:VT,appId:n.appId,sdkVersion:UT},d={method:"POST",headers:a,body:JSON.stringify(c)},p=await GT(()=>fetch(i,d));if(p.ok){const m=await p.json();return{fid:m.fid||t,registrationStatus:2,refreshToken:m.refreshToken,authToken:HT(m.authToken)}}else throw await qT("Create Installation",p)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FT(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hR(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dR=/^[cdef][\w-]{21}$/,fm="";function fR(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=gR(n);return dR.test(t)?t:fm}catch{return fm}}function gR(n){return hR(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nf(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KT=new Map;function YT(n,e){const t=nf(n);WT(t,e),pR(t,e)}function WT(n,e){const t=KT.get(n);if(t)for(const i of t)i(e)}function pR(n,e){const t=mR();t&&t.postMessage({key:n,fid:e}),yR()}let Aa=null;function mR(){return!Aa&&"BroadcastChannel"in self&&(Aa=new BroadcastChannel("[Firebase] FID Change"),Aa.onmessage=n=>{WT(n.data.key,n.data.fid)}),Aa}function yR(){KT.size===0&&Aa&&(Aa.close(),Aa=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vR="firebase-installations-database",_R=1,Da="firebase-installations-store";let Up=null;function e0(){return Up||(Up=OT(vR,_R,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(Da)}}})),Up}async function Ad(n,e){const t=nf(n),a=(await e0()).transaction(Da,"readwrite"),l=a.objectStore(Da),c=await l.get(t);return await l.put(e,t),await a.done,(!c||c.fid!==e.fid)&&YT(n,e.fid),e}async function QT(n){const e=nf(n),i=(await e0()).transaction(Da,"readwrite");await i.objectStore(Da).delete(e),await i.done}async function sf(n,e){const t=nf(n),a=(await e0()).transaction(Da,"readwrite"),l=a.objectStore(Da),c=await l.get(t),d=e(c);return d===void 0?await l.delete(t):await l.put(d,t),await a.done,d&&(!c||c.fid!==d.fid)&&YT(n,d.fid),d}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t0(n){let e;const t=await sf(n.appConfig,i=>{const a=bR(i),l=wR(n,a);return e=l.registrationPromise,l.installationEntry});return t.fid===fm?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function bR(n){const e=n||{fid:fR(),registrationStatus:0};return JT(e)}function wR(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const a=Promise.reject(ja.create("app-offline"));return{installationEntry:e,registrationPromise:a}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=xR(n,t);return{installationEntry:t,registrationPromise:i}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:TR(n)}:{installationEntry:e}}async function xR(n,e){try{const t=await uR(n,e);return Ad(n.appConfig,t)}catch(t){throw BT(t)&&t.customData.serverCode===409?await QT(n.appConfig):await Ad(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function TR(n){let e=await tw(n.appConfig);for(;e.registrationStatus===1;)await FT(100),e=await tw(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:i}=await t0(n);return i||t}return e}function tw(n){return sf(n,e=>{if(!e)throw ja.create("installation-not-found");return JT(e)})}function JT(n){return ER(n)?{fid:n.fid,registrationStatus:0}:n}function ER(n){return n.registrationStatus===1&&n.registrationTime+LT<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SR({appConfig:n,heartbeatServiceProvider:e},t){const i=AR(n,t),a=oR(n,t),l=e.getImmediate({optional:!0});if(l){const m=await l.getHeartbeatsHeader();m&&a.append("x-firebase-client",m)}const c={installation:{sdkVersion:UT,appId:n.appId}},d={method:"POST",headers:a,body:JSON.stringify(c)},p=await GT(()=>fetch(i,d));if(p.ok){const m=await p.json();return HT(m)}else throw await qT("Generate Auth Token",p)}function AR(n,{fid:e}){return`${zT(n)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function n0(n,e=!1){let t;const i=await sf(n.appConfig,l=>{if(!XT(l))throw ja.create("not-registered");const c=l.authToken;if(!e&&RR(c))return l;if(c.requestStatus===1)return t=NR(n,e),l;{if(!navigator.onLine)throw ja.create("app-offline");const d=kR(l);return t=CR(n,d),d}});return t?await t:i.authToken}async function NR(n,e){let t=await nw(n.appConfig);for(;t.authToken.requestStatus===1;)await FT(100),t=await nw(n.appConfig);const i=t.authToken;return i.requestStatus===0?n0(n,e):i}function nw(n){return sf(n,e=>{if(!XT(e))throw ja.create("not-registered");const t=e.authToken;return OR(t)?{...e,authToken:{requestStatus:0}}:e})}async function CR(n,e){try{const t=await SR(n,e),i={...e,authToken:t};return await Ad(n.appConfig,i),t}catch(t){if(BT(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await QT(n.appConfig);else{const i={...e,authToken:{requestStatus:0}};await Ad(n.appConfig,i)}throw t}}function XT(n){return n!==void 0&&n.registrationStatus===2}function RR(n){return n.requestStatus===2&&!IR(n)}function IR(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+sR}function kR(n){const e={requestStatus:1,requestTime:Date.now()};return{...n,authToken:e}}function OR(n){return n.requestStatus===1&&n.requestTime+LT<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jR(n){const e=n,{installationEntry:t,registrationPromise:i}=await t0(e);return i?i.catch(console.error):n0(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DR(n,e=!1){const t=n;return await PR(t),(await n0(t,e)).token}async function PR(n){const{registrationPromise:e}=await t0(n);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MR(n){if(!n||!n.options)throw Vp("App Configuration");if(!n.name)throw Vp("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw Vp(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function Vp(n){return ja.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZT="installations",LR="installations-internal",UR=n=>{const e=n.getProvider("app").getImmediate(),t=MR(e),i=Lr(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},VR=n=>{const e=n.getProvider("app").getImmediate(),t=Lr(e,ZT).getImmediate();return{getId:()=>jR(t),getToken:a=>DR(t,a)}};function BR(){Es(new ss(ZT,UR,"PUBLIC")),Es(new ss(LR,VR,"PRIVATE"))}BR();Cn(MT,Zm);Cn(MT,Zm,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nd="analytics",zR="firebase_id",HR="origin",qR=60*1e3,$R="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",s0="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yn=new ef("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GR={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},zn=new za("analytics","Analytics",GR);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FR(n){if(!n.startsWith(s0)){const e=zn.create("invalid-gtag-resource",{gtagURL:n});return yn.warn(e.message),""}return n}function eE(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function KR(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function YR(n,e){const t=KR("firebase-js-sdk-policy",{createScriptURL:FR}),i=document.createElement("script"),a=`${s0}?l=${n}&id=${e}`;i.src=t?t==null?void 0:t.createScriptURL(a):a,i.async=!0,document.head.appendChild(i)}function WR(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}async function QR(n,e,t,i,a,l){const c=i[a];try{if(c)await e[c];else{const p=(await eE(t)).find(m=>m.measurementId===a);p&&await e[p.appId]}}catch(d){yn.error(d)}n("config",a,l)}async function JR(n,e,t,i,a){try{let l=[];if(a&&a.send_to){let c=a.send_to;Array.isArray(c)||(c=[c]);const d=await eE(t);for(const p of c){const m=d.find(b=>b.measurementId===p),_=m&&e[m.appId];if(_)l.push(_);else{l=[];break}}}l.length===0&&(l=Object.values(e)),await Promise.all(l),n("event",i,a||{})}catch(l){yn.error(l)}}function XR(n,e,t,i){async function a(l,...c){try{if(l==="event"){const[d,p]=c;await JR(n,e,t,d,p)}else if(l==="config"){const[d,p]=c;await QR(n,e,t,i,d,p)}else if(l==="consent"){const[d,p]=c;n("consent",d,p)}else if(l==="get"){const[d,p,m]=c;n("get",d,p,m)}else if(l==="set"){const[d]=c;n("set",d)}else n(l,...c)}catch(d){yn.error(d)}}return a}function ZR(n,e,t,i,a){let l=function(...c){window[i].push(arguments)};return window[a]&&typeof window[a]=="function"&&(l=window[a]),window[a]=XR(l,n,e,t),{gtagCore:l,wrappedGtag:window[a]}}function eI(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(s0)&&t.src.includes(n))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tI=30,nI=1e3;class sI{constructor(e={},t=nI){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const tE=new sI;function iI(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}async function rI(n){var c;const{appId:e,apiKey:t}=n,i={method:"GET",headers:iI(t)},a=$R.replace("{app-id}",e),l=await fetch(a,i);if(l.status!==200&&l.status!==304){let d="";try{const p=await l.json();(c=p.error)!=null&&c.message&&(d=p.error.message)}catch{}throw zn.create("config-fetch-failed",{httpStatus:l.status,responseMessage:d})}return l.json()}async function aI(n,e=tE,t){const{appId:i,apiKey:a,measurementId:l}=n.options;if(!i)throw zn.create("no-app-id");if(!a){if(l)return{measurementId:l,appId:i};throw zn.create("no-api-key")}const c=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},d=new cI;return setTimeout(async()=>{d.abort()},qR),nE({appId:i,apiKey:a,measurementId:l},c,d,e)}async function nE(n,{throttleEndTimeMillis:e,backoffCount:t},i,a=tE){var d;const{appId:l,measurementId:c}=n;try{await oI(i,e)}catch(p){if(c)return yn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${c} provided in the "measurementId" field in the local Firebase config. [${p==null?void 0:p.message}]`),{appId:l,measurementId:c};throw p}try{const p=await rI(n);return a.deleteThrottleMetadata(l),p}catch(p){const m=p;if(!lI(m)){if(a.deleteThrottleMetadata(l),c)return yn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${c} provided in the "measurementId" field in the local Firebase config. [${m==null?void 0:m.message}]`),{appId:l,measurementId:c};throw p}const _=Number((d=m==null?void 0:m.customData)==null?void 0:d.httpStatus)===503?Fb(t,a.intervalMillis,tI):Fb(t,a.intervalMillis),b={throttleEndTimeMillis:Date.now()+_,backoffCount:t+1};return a.setThrottleMetadata(l,b),yn.debug(`Calling attemptFetch again in ${_} millis`),nE(n,b,i,a)}}function oI(n,e){return new Promise((t,i)=>{const a=Math.max(e-Date.now(),0),l=setTimeout(t,a);n.addEventListener(()=>{clearTimeout(l),i(zn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function lI(n){if(!(n instanceof rs)||!n.customData)return!1;const e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}class cI{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function uI(n,e,t,i,a){if(a&&a.global){n("event",t,i);return}else{const l=await e,c={...i,send_to:l};n("event",t,c)}}async function hI(n,e,t,i){if(i&&i.global){const a={};for(const l of Object.keys(t))a[`user_properties.${l}`]=t[l];return n("set",a),Promise.resolve()}else{const a=await e;n("config",a,{update:!0,user_properties:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dI(){if(CT())try{await RT()}catch(n){return yn.warn(zn.create("indexeddb-unavailable",{errorInfo:n==null?void 0:n.toString()}).message),!1}else return yn.warn(zn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function fI(n,e,t,i,a,l,c){const d=aI(n);d.then(x=>{t[x.measurementId]=x.appId,n.options.measurementId&&x.measurementId!==n.options.measurementId&&yn.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${x.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(x=>yn.error(x)),e.push(d);const p=dI().then(x=>{if(x)return i.getId()}),[m,_]=await Promise.all([d,p]);eI(l)||YR(l,m.measurementId),a("js",new Date);const b=(c==null?void 0:c.config)??{};return b[HR]="firebase",b.update=!0,_!=null&&(b[zR]=_),a("config",m.measurementId,b),m.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gI{constructor(e){this.app=e}_delete(){return delete Wo[this.app.options.appId],Promise.resolve()}}let Wo={},sw=[];const iw={};let Bp="dataLayer",pI="gtag",rw,i0,aw=!1;function mI(){const n=[];if(NT()&&n.push("This is a browser extension environment."),PN()||n.push("Cookies are not available."),n.length>0){const e=n.map((i,a)=>`(${a+1}) ${i}`).join(" "),t=zn.create("invalid-analytics-context",{errorInfo:e});yn.warn(t.message)}}function yI(n,e,t){mI();const i=n.options.appId;if(!i)throw zn.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)yn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw zn.create("no-api-key");if(Wo[i]!=null)throw zn.create("already-exists",{id:i});if(!aw){WR(Bp);const{wrappedGtag:l,gtagCore:c}=ZR(Wo,sw,iw,Bp,pI);i0=l,rw=c,aw=!0}return Wo[i]=fI(n,sw,iw,e,rw,Bp,t),new gI(n)}function vI(n=tf()){n=mt(n);const e=Lr(n,Nd);return e.isInitialized()?e.getImmediate():_I(n)}function _I(n,e={}){const t=Lr(n,Nd);if(t.isInitialized()){const a=t.getImmediate();if(Ir(e,t.getOptions()))return a;throw zn.create("already-initialized")}return t.initialize({options:e})}function bI(n,e,t){n=mt(n),hI(i0,Wo[n.app.options.appId],e,t).catch(i=>yn.error(i))}function wI(n,e,t,i){n=mt(n),uI(i0,Wo[n.app.options.appId],e,t,i).catch(a=>yn.error(a))}const ow="@firebase/analytics",lw="0.10.19";function xI(){Es(new ss(Nd,(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),a=e.getProvider("installations-internal").getImmediate();return yI(i,a,t)},"PUBLIC")),Es(new ss("analytics-internal",n,"PRIVATE")),Cn(ow,lw),Cn(ow,lw,"esm2020");function n(e){try{const t=e.getProvider(Nd).getImmediate();return{logEvent:(i,a,l)=>wI(t,i,a,l),setUserProperties:(i,a)=>bI(t,i,a)}}catch(t){throw zn.create("interop-component-reg-failed",{reason:t})}}}xI();function sE(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const TI=sE,iE=new za("auth","Firebase",sE());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cd=new ef("@firebase/auth");function EI(n,...e){Cd.logLevel<=$e.WARN&&Cd.warn(`Auth (${Ha}): ${n}`,...e)}function gd(n,...e){Cd.logLevel<=$e.ERROR&&Cd.error(`Auth (${Ha}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function is(n,...e){throw a0(n,...e)}function xs(n,...e){return a0(n,...e)}function r0(n,e,t){const i={...TI(),[e]:t};return new za("auth","Firebase",i).create(e,{appName:n.name})}function Ci(n){return r0(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function SI(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&is(n,"argument-error"),r0(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function a0(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return iE.create(n,...e)}function Re(n,e,...t){if(!n)throw a0(e,...t)}function Ai(n){const e="INTERNAL ASSERTION FAILED: "+n;throw gd(e),new Error(e)}function ki(n,e){n||Ai(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gm(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function AI(){return cw()==="http:"||cw()==="https:"}function cw(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NI(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(AI()||NT()||"connection"in navigator)?navigator.onLine:!0}function CI(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uu{constructor(e,t){this.shortDelay=e,this.longDelay=t,ki(t>e,"Short delay should be less than long delay!"),this.isMobile=RN()||ON()}get(){return NI()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o0(n,e){ki(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rE{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ai("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ai("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ai("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RI={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const II=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],kI=new uu(3e4,6e4);function Ur(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Pi(n,e,t,i,a={}){return aE(n,a,async()=>{let l={},c={};i&&(e==="GET"?c=i:l={body:JSON.stringify(i)});const d=cu({key:n.config.apiKey,...c}).slice(1),p=await n._getAdditionalHeaders();p["Content-Type"]="application/json",n.languageCode&&(p["X-Firebase-Locale"]=n.languageCode);const m={method:e,headers:p,...l};return kN()||(m.referrerPolicy="no-referrer"),n.emulatorConfig&&Ba(n.emulatorConfig.host)&&(m.credentials="include"),rE.fetch()(await oE(n,n.config.apiHost,t,d),m)})}async function aE(n,e,t){n._canInitEmulator=!1;const i={...RI,...e};try{const a=new jI(n),l=await Promise.race([t(),a.promise]);a.clearNetworkTimeout();const c=await l.json();if("needConfirmation"in c)throw Zh(n,"account-exists-with-different-credential",c);if(l.ok&&!("errorMessage"in c))return c;{const d=l.ok?c.errorMessage:c.error.message,[p,m]=d.split(" : ");if(p==="FEDERATED_USER_ID_ALREADY_LINKED")throw Zh(n,"credential-already-in-use",c);if(p==="EMAIL_EXISTS")throw Zh(n,"email-already-in-use",c);if(p==="USER_DISABLED")throw Zh(n,"user-disabled",c);const _=i[p]||p.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw r0(n,_,m);is(n,_)}}catch(a){if(a instanceof rs)throw a;is(n,"network-request-failed",{message:String(a)})}}async function hu(n,e,t,i,a={}){const l=await Pi(n,e,t,i,a);return"mfaPendingCredential"in l&&is(n,"multi-factor-auth-required",{_serverResponse:l}),l}async function oE(n,e,t,i){const a=`${e}${t}?${i}`,l=n,c=l.config.emulator?o0(n.config,a):`${n.config.apiScheme}://${a}`;return II.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(c).toString():c}function OI(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class jI{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(xs(this.auth,"network-request-failed")),kI.get())})}}function Zh(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const a=xs(n,e,i);return a.customData._tokenResponse=t,a}function uw(n){return n!==void 0&&n.enterprise!==void 0}class DI{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return OI(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function PI(n,e){return Pi(n,"GET","/v2/recaptchaConfig",Ur(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MI(n,e){return Pi(n,"POST","/v1/accounts:delete",e)}async function Rd(n,e){return Pi(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uc(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function LI(n,e=!1){const t=mt(n),i=await t.getIdToken(e),a=l0(i);Re(a&&a.exp&&a.auth_time&&a.iat,t.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,c=l==null?void 0:l.sign_in_provider;return{claims:a,token:i,authTime:Uc(zp(a.auth_time)),issuedAtTime:Uc(zp(a.iat)),expirationTime:Uc(zp(a.exp)),signInProvider:c||null,signInSecondFactor:(l==null?void 0:l.sign_in_second_factor)||null}}function zp(n){return Number(n)*1e3}function l0(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return gd("JWT malformed, contained fewer than 3 sections"),null;try{const a=wT(t);return a?JSON.parse(a):(gd("Failed to decode base64 JWT payload"),null)}catch(a){return gd("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function hw(n){const e=l0(n);return Re(e,"internal-error"),Re(typeof e.exp<"u","internal-error"),Re(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sl(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof rs&&UI(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function UI({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VI{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pm{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Uc(this.lastLoginAt),this.creationTime=Uc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Id(n){var b;const e=n.auth,t=await n.getIdToken(),i=await sl(n,Rd(e,{idToken:t}));Re(i==null?void 0:i.users.length,e,"internal-error");const a=i.users[0];n._notifyReloadListener(a);const l=(b=a.providerUserInfo)!=null&&b.length?lE(a.providerUserInfo):[],c=zI(n.providerData,l),d=n.isAnonymous,p=!(n.email&&a.passwordHash)&&!(c!=null&&c.length),m=d?p:!1,_={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:c,metadata:new pm(a.createdAt,a.lastLoginAt),isAnonymous:m};Object.assign(n,_)}async function BI(n){const e=mt(n);await Id(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function zI(n,e){return[...n.filter(i=>!e.some(a=>a.providerId===i.providerId)),...e]}function lE(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HI(n,e){const t=await aE(n,{},async()=>{const i=cu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=n.config,c=await oE(n,a,"/v1/token",`key=${l}`),d=await n._getAdditionalHeaders();d["Content-Type"]="application/x-www-form-urlencoded";const p={method:"POST",headers:d,body:i};return n.emulatorConfig&&Ba(n.emulatorConfig.host)&&(p.credentials="include"),rE.fetch()(c,p)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function qI(n,e){return Pi(n,"POST","/v2/accounts:revokeToken",Ur(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Re(e.idToken,"internal-error"),Re(typeof e.idToken<"u","internal-error"),Re(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):hw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Re(e.length!==0,"internal-error");const t=hw(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Re(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:a,expiresIn:l}=await HI(e,t);this.updateTokensAndExpiration(i,a,Number(l))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:a,expirationTime:l}=t,c=new Qo;return i&&(Re(typeof i=="string","internal-error",{appName:e}),c.refreshToken=i),a&&(Re(typeof a=="string","internal-error",{appName:e}),c.accessToken=a),l&&(Re(typeof l=="number","internal-error",{appName:e}),c.expirationTime=l),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Qo,this.toJSON())}_performRefresh(){return Ai("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mr(n,e){Re(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class bs{constructor({uid:e,auth:t,stsTokenManager:i,...a}){this.providerId="firebase",this.proactiveRefresh=new VI(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new pm(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const t=await sl(this,this.stsTokenManager.getToken(this.auth,e));return Re(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return LI(this,e)}reload(){return BI(this)}_assign(e){this!==e&&(Re(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new bs({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Re(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Id(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(An(this.auth.app))return Promise.reject(Ci(this.auth));const e=await this.getIdToken();return await sl(this,MI(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,a=t.email??void 0,l=t.phoneNumber??void 0,c=t.photoURL??void 0,d=t.tenantId??void 0,p=t._redirectEventId??void 0,m=t.createdAt??void 0,_=t.lastLoginAt??void 0,{uid:b,emailVerified:x,isAnonymous:S,providerData:N,stsTokenManager:j}=t;Re(b&&j,e,"internal-error");const k=Qo.fromJSON(this.name,j);Re(typeof b=="string",e,"internal-error"),mr(i,e.name),mr(a,e.name),Re(typeof x=="boolean",e,"internal-error"),Re(typeof S=="boolean",e,"internal-error"),mr(l,e.name),mr(c,e.name),mr(d,e.name),mr(p,e.name),mr(m,e.name),mr(_,e.name);const L=new bs({uid:b,auth:e,email:a,emailVerified:x,displayName:i,isAnonymous:S,photoURL:c,phoneNumber:l,tenantId:d,stsTokenManager:k,createdAt:m,lastLoginAt:_});return N&&Array.isArray(N)&&(L.providerData=N.map(H=>({...H}))),p&&(L._redirectEventId=p),L}static async _fromIdTokenResponse(e,t,i=!1){const a=new Qo;a.updateFromServerResponse(t);const l=new bs({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:i});return await Id(l),l}static async _fromGetAccountInfoResponse(e,t,i){const a=t.users[0];Re(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?lE(a.providerUserInfo):[],c=!(a.email&&a.passwordHash)&&!(l!=null&&l.length),d=new Qo;d.updateFromIdToken(i);const p=new bs({uid:a.localId,auth:e,stsTokenManager:d,isAnonymous:c}),m={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new pm(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(l!=null&&l.length)};return Object.assign(p,m),p}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dw=new Map;function Ni(n){ki(n instanceof Function,"Expected a class definition");let e=dw.get(n);return e?(ki(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,dw.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cE{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}cE.type="NONE";const fw=cE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pd(n,e,t){return`firebase:${n}:${e}:${t}`}class Jo{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:a,name:l}=this.auth;this.fullUserKey=pd(this.userKey,a.apiKey,l),this.fullPersistenceKey=pd("persistence",a.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Rd(this.auth,{idToken:e}).catch(()=>{});return t?bs._fromGetAccountInfoResponse(this.auth,t,e):null}return bs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Jo(Ni(fw),e,i);const a=(await Promise.all(t.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let l=a[0]||Ni(fw);const c=pd(i,e.config.apiKey,e.name);let d=null;for(const m of t)try{const _=await m._get(c);if(_){let b;if(typeof _=="string"){const x=await Rd(e,{idToken:_}).catch(()=>{});if(!x)break;b=await bs._fromGetAccountInfoResponse(e,x,_)}else b=bs._fromJSON(e,_);m!==l&&(d=b),l=m;break}}catch{}const p=a.filter(m=>m._shouldAllowMigration);return!l._shouldAllowMigration||!p.length?new Jo(l,e,i):(l=p[0],d&&await l._set(c,d.toJSON()),await Promise.all(t.map(async m=>{if(m!==l)try{await m._remove(c)}catch{}})),new Jo(l,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gw(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(fE(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(uE(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(pE(e))return"Blackberry";if(mE(e))return"Webos";if(hE(e))return"Safari";if((e.includes("chrome/")||dE(e))&&!e.includes("edge/"))return"Chrome";if(gE(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function uE(n=fn()){return/firefox\//i.test(n)}function hE(n=fn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function dE(n=fn()){return/crios\//i.test(n)}function fE(n=fn()){return/iemobile/i.test(n)}function gE(n=fn()){return/android/i.test(n)}function pE(n=fn()){return/blackberry/i.test(n)}function mE(n=fn()){return/webos/i.test(n)}function c0(n=fn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function $I(n=fn()){var e;return c0(n)&&!!((e=window.navigator)!=null&&e.standalone)}function GI(){return jN()&&document.documentMode===10}function yE(n=fn()){return c0(n)||gE(n)||mE(n)||pE(n)||/windows phone/i.test(n)||fE(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vE(n,e=[]){let t;switch(n){case"Browser":t=gw(fn());break;case"Worker":t=`${gw(fn())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ha}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FI{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=l=>new Promise((c,d)=>{try{const p=e(l);c(p)}catch(p){d(p)}});i.onAbort=t,this.queue.push(i);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const a of t)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KI(n,e={}){return Pi(n,"GET","/v2/passwordPolicy",Ur(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YI=6;class WI{constructor(e){var i;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??YI,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((i=e.allowedNonAlphanumericCharacters)==null?void 0:i.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),a&&(t.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let a=0;a<e.length;a++)i=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QI{constructor(e,t,i,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new pw(this),this.idTokenSubscription=new pw(this),this.beforeStateQueue=new FI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=iE,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ni(t)),this._initializationPromise=this.queue(async()=>{var i,a,l;if(!this._deleted&&(this.persistenceManager=await Jo.create(this,e),(i=this._resolvePersistenceManagerAvailable)==null||i.call(this),!this._deleted)){if((a=this._popupRedirectResolver)!=null&&a._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((l=this.currentUser)==null?void 0:l.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Rd(this,{idToken:e}),i=await bs._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var l;if(An(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=(l=this.redirectUser)==null?void 0:l._redirectEventId,d=i==null?void 0:i._redirectEventId,p=await this.tryRedirectSignIn(e);(!c||c===d)&&(p!=null&&p.user)&&(i=p.user,a=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(i)}catch(c){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Re(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Id(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=CI()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(An(this.app))return Promise.reject(Ci(this));const t=e?mt(e):null;return t&&Re(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Re(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return An(this.app)?Promise.reject(Ci(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return An(this.app)?Promise.reject(Ci(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ni(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await KI(this),t=new WI(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new za("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await qI(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ni(e)||this._popupRedirectResolver;Re(t,this,"argument-error"),this.redirectPersistenceManager=await Jo.create(this,[Ni(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)==null?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,a){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let c=!1;const d=this._isInitialized?Promise.resolve():this._initializationPromise;if(Re(d,this,"internal-error"),d.then(()=>{c||l(this.currentUser)}),typeof t=="function"){const p=e.addObserver(t,i,a);return()=>{c=!0,p()}}else{const p=e.addObserver(t);return()=>{c=!0,p()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Re(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=vE(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var a;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((a=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:a.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){var t;if(An(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&EI(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Vr(n){return mt(n)}class pw{constructor(e){this.auth=e,this.observer=null,this.addObserver=BN(t=>this.observer=t)}get next(){return Re(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function JI(n){rf=n}function _E(n){return rf.loadJS(n)}function XI(){return rf.recaptchaEnterpriseScript}function ZI(){return rf.gapiScript}function ek(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class tk{constructor(){this.enterprise=new nk}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class nk{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const sk="recaptcha-enterprise",bE="NO_RECAPTCHA";class ik{constructor(e){this.type=sk,this.auth=Vr(e)}async verify(e="verify",t=!1){async function i(l){if(!t){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(c,d)=>{PI(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(p=>{if(p.recaptchaKey===void 0)d(new Error("recaptcha Enterprise site key undefined"));else{const m=new DI(p);return l.tenantId==null?l._agentRecaptchaConfig=m:l._tenantRecaptchaConfigs[l.tenantId]=m,c(m.siteKey)}}).catch(p=>{d(p)})})}function a(l,c,d){const p=window.grecaptcha;uw(p)?p.enterprise.ready(()=>{p.enterprise.execute(l,{action:e}).then(m=>{c(m)}).catch(()=>{c(bE)})}):d(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new tk().execute("siteKey",{action:"verify"}):new Promise((l,c)=>{i(this.auth).then(d=>{if(!t&&uw(window.grecaptcha))a(d,l,c);else{if(typeof window>"u"){c(new Error("RecaptchaVerifier is only supported in browser"));return}let p=XI();p.length!==0&&(p+=d),_E(p).then(()=>{a(d,l,c)}).catch(m=>{c(m)})}}).catch(d=>{c(d)})})}}async function mw(n,e,t,i=!1,a=!1){const l=new ik(n);let c;if(a)c=bE;else try{c=await l.verify(t)}catch{c=await l.verify(t,!0)}const d={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in d){const p=d.phoneEnrollmentInfo.phoneNumber,m=d.phoneEnrollmentInfo.recaptchaToken;Object.assign(d,{phoneEnrollmentInfo:{phoneNumber:p,recaptchaToken:m,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in d){const p=d.phoneSignInInfo.recaptchaToken;Object.assign(d,{phoneSignInInfo:{recaptchaToken:p,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return d}return i?Object.assign(d,{captchaResp:c}):Object.assign(d,{captchaResponse:c}),Object.assign(d,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(d,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),d}async function mm(n,e,t,i,a){var l;if((l=n._getRecaptchaConfig())!=null&&l.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const c=await mw(n,e,t,t==="getOobCode");return i(n,c)}else return i(n,e).catch(async c=>{if(c.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await mw(n,e,t,t==="getOobCode");return i(n,d)}else return Promise.reject(c)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rk(n,e){const t=Lr(n,"auth");if(t.isInitialized()){const a=t.getImmediate(),l=t.getOptions();if(Ir(l,e??{}))return a;is(a,"already-initialized")}return t.initialize({options:e})}function ak(n,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map(Ni);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function ok(n,e,t){const i=Vr(n);Re(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const a=!1,l=wE(e),{host:c,port:d}=lk(e),p=d===null?"":`:${d}`,m={url:`${l}//${c}${p}/`},_=Object.freeze({host:c,port:d,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!i._canInitEmulator){Re(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Re(Ir(m,i.config.emulator)&&Ir(_,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=m,i.emulatorConfig=_,i.settings.appVerificationDisabledForTesting=!0,Ba(c)?(Qm(`${l}//${c}${p}`),Jm("Auth",!0)):ck()}function wE(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function lk(n){const e=wE(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(i);if(a){const l=a[1];return{host:l,port:yw(i.substr(l.length+1))}}else{const[l,c]=i.split(":");return{host:l,port:yw(c)}}}function yw(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function ck(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u0{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ai("not implemented")}_getIdTokenResponse(e){return Ai("not implemented")}_linkToIdToken(e,t){return Ai("not implemented")}_getReauthenticationResolver(e){return Ai("not implemented")}}async function uk(n,e){return Pi(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hk(n,e){return hu(n,"POST","/v1/accounts:signInWithPassword",Ur(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dk(n,e){return hu(n,"POST","/v1/accounts:signInWithEmailLink",Ur(n,e))}async function fk(n,e){return hu(n,"POST","/v1/accounts:signInWithEmailLink",Ur(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wc extends u0{constructor(e,t,i,a=null){super("password",i),this._email=e,this._password=t,this._tenantId=a}static _fromEmailAndPassword(e,t){return new Wc(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new Wc(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return mm(e,t,"signInWithPassword",hk);case"emailLink":return dk(e,{email:this._email,oobCode:this._password});default:is(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return mm(e,i,"signUpPassword",uk);case"emailLink":return fk(e,{idToken:t,email:this._email,oobCode:this._password});default:is(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xo(n,e){return hu(n,"POST","/v1/accounts:signInWithIdp",Ur(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gk="http://localhost";class Pa extends u0{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Pa(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):is("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:a,...l}=t;if(!i||!a)return null;const c=new Pa(i,a);return c.idToken=l.idToken||void 0,c.accessToken=l.accessToken||void 0,c.secret=l.secret,c.nonce=l.nonce,c.pendingToken=l.pendingToken||null,c}_getIdTokenResponse(e){const t=this.buildRequest();return Xo(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Xo(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Xo(e,t)}buildRequest(){const e={requestUri:gk,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=cu(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pk(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function mk(n){const e=Cc(Rc(n)).link,t=e?Cc(Rc(e)).deep_link_id:null,i=Cc(Rc(n)).deep_link_id;return(i?Cc(Rc(i)).link:null)||i||t||e||n}class h0{constructor(e){const t=Cc(Rc(e)),i=t.apiKey??null,a=t.oobCode??null,l=pk(t.mode??null);Re(i&&a&&l,"argument-error"),this.apiKey=i,this.operation=l,this.code=a,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=mk(e);try{return new h0(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hl{constructor(){this.providerId=hl.PROVIDER_ID}static credential(e,t){return Wc._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=h0.parseLink(t);return Re(i,"argument-error"),Wc._fromEmailAndCode(e,i.code,i.tenantId)}}hl.PROVIDER_ID="password";hl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";hl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d0{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du extends d0{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r extends du{constructor(){super("facebook.com")}static credential(e){return Pa._fromParams({providerId:_r.PROVIDER_ID,signInMethod:_r.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return _r.credentialFromTaggedObject(e)}static credentialFromError(e){return _r.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return _r.credential(e.oauthAccessToken)}catch{return null}}}_r.FACEBOOK_SIGN_IN_METHOD="facebook.com";_r.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Si extends du{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Pa._fromParams({providerId:Si.PROVIDER_ID,signInMethod:Si.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Si.credentialFromTaggedObject(e)}static credentialFromError(e){return Si.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Si.credential(t,i)}catch{return null}}}Si.GOOGLE_SIGN_IN_METHOD="google.com";Si.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br extends du{constructor(){super("github.com")}static credential(e){return Pa._fromParams({providerId:br.PROVIDER_ID,signInMethod:br.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return br.credentialFromTaggedObject(e)}static credentialFromError(e){return br.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return br.credential(e.oauthAccessToken)}catch{return null}}}br.GITHUB_SIGN_IN_METHOD="github.com";br.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr extends du{constructor(){super("twitter.com")}static credential(e,t){return Pa._fromParams({providerId:wr.PROVIDER_ID,signInMethod:wr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return wr.credentialFromTaggedObject(e)}static credentialFromError(e){return wr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return wr.credential(t,i)}catch{return null}}}wr.TWITTER_SIGN_IN_METHOD="twitter.com";wr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yk(n,e){return hu(n,"POST","/v1/accounts:signUp",Ur(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ma{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,a=!1){const l=await bs._fromIdTokenResponse(e,i,a),c=vw(i);return new Ma({user:l,providerId:c,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const a=vw(i);return new Ma({user:e,providerId:a,_tokenResponse:i,operationType:t})}}function vw(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kd extends rs{constructor(e,t,i,a){super(t.code,t.message),this.operationType=i,this.user=a,Object.setPrototypeOf(this,kd.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,a){return new kd(e,t,i,a)}}function xE(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?kd._fromErrorAndOperation(n,l,e,i):l})}async function vk(n,e,t=!1){const i=await sl(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Ma._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _k(n,e,t=!1){const{auth:i}=n;if(An(i.app))return Promise.reject(Ci(i));const a="reauthenticate";try{const l=await sl(n,xE(i,a,e,n),t);Re(l.idToken,i,"internal-error");const c=l0(l.idToken);Re(c,i,"internal-error");const{sub:d}=c;return Re(n.uid===d,i,"user-mismatch"),Ma._forOperation(n,a,l)}catch(l){throw(l==null?void 0:l.code)==="auth/user-not-found"&&is(i,"user-mismatch"),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TE(n,e,t=!1){if(An(n.app))return Promise.reject(Ci(n));const i="signIn",a=await xE(n,i,e),l=await Ma._fromIdTokenResponse(n,i,a);return t||await n._updateCurrentUser(l.user),l}async function bk(n,e){return TE(Vr(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EE(n){const e=Vr(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function wk(n,e,t){if(An(n.app))return Promise.reject(Ci(n));const i=Vr(n),c=await mm(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",yk).catch(p=>{throw p.code==="auth/password-does-not-meet-requirements"&&EE(n),p}),d=await Ma._fromIdTokenResponse(i,"signIn",c);return await i._updateCurrentUser(d.user),d}function xk(n,e,t){return An(n.app)?Promise.reject(Ci(n)):bk(mt(n),hl.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&EE(n),i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tk(n,e){return Pi(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ek(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const i=mt(n),l={idToken:await i.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},c=await sl(i,Tk(i.auth,l));i.displayName=c.displayName||null,i.photoURL=c.photoUrl||null;const d=i.providerData.find(({providerId:p})=>p==="password");d&&(d.displayName=i.displayName,d.photoURL=i.photoURL),await i._updateTokensIfNecessary(c)}function Sk(n,e,t,i){return mt(n).onIdTokenChanged(e,t,i)}function Ak(n,e,t){return mt(n).beforeAuthStateChanged(e,t)}function Nk(n,e,t,i){return mt(n).onAuthStateChanged(e,t,i)}function Ck(n){return mt(n).signOut()}const Od="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SE{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Od,"1"),this.storage.removeItem(Od),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rk=1e3,Ik=10;class AE extends SE{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=yE(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),a=this.localCache[t];i!==a&&e(t,a,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((c,d,p)=>{this.notifyListeners(c,p)});return}const i=e.key;t?this.detachListener():this.stopPolling();const a=()=>{const c=this.storage.getItem(i);!t&&this.localCache[i]===c||this.notifyListeners(i,c)},l=this.storage.getItem(i);GI()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,Ik):a()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const a of Array.from(i))a(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},Rk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}AE.type="LOCAL";const kk=AE;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NE extends SE{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}NE.type="SESSION";const CE=NE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ok(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class af{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(a=>a.isListeningto(e));if(t)return t;const i=new af(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:a,data:l}=t.data,c=this.handlersMap[a];if(!(c!=null&&c.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:a});const d=Array.from(c).map(async m=>m(t.origin,l)),p=await Ok(d);t.ports[0].postMessage({status:"done",eventId:i,eventType:a,response:p})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}af.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f0(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jk{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,c;return new Promise((d,p)=>{const m=f0("",20);a.port1.start();const _=setTimeout(()=>{p(new Error("unsupported_event"))},i);c={messageChannel:a,onMessage(b){const x=b;if(x.data.eventId===m)switch(x.data.status){case"ack":clearTimeout(_),l=setTimeout(()=>{p(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),d(x.data.response);break;default:clearTimeout(_),clearTimeout(l),p(new Error("invalid_response"));break}}},this.handlers.add(c),a.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:m,data:t},[a.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xs(){return window}function Dk(n){Xs().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RE(){return typeof Xs().WorkerGlobalScope<"u"&&typeof Xs().importScripts=="function"}async function Pk(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Mk(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function Lk(){return RE()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IE="firebaseLocalStorageDb",Uk=1,jd="firebaseLocalStorage",kE="fbase_key";class fu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function of(n,e){return n.transaction([jd],e?"readwrite":"readonly").objectStore(jd)}function Vk(){const n=indexedDB.deleteDatabase(IE);return new fu(n).toPromise()}function ym(){const n=indexedDB.open(IE,Uk);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(jd,{keyPath:kE})}catch(a){t(a)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(jd)?e(i):(i.close(),await Vk(),e(await ym()))})})}async function _w(n,e,t){const i=of(n,!0).put({[kE]:e,value:t});return new fu(i).toPromise()}async function Bk(n,e){const t=of(n,!1).get(e),i=await new fu(t).toPromise();return i===void 0?null:i.value}function bw(n,e){const t=of(n,!0).delete(e);return new fu(t).toPromise()}const zk=800,Hk=3;class OE{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await ym(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>Hk)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return RE()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=af._getInstance(Lk()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,i;if(this.activeServiceWorker=await Pk(),!this.activeServiceWorker)return;this.sender=new jk(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(i=e[0])!=null&&i.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Mk()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await ym();return await _w(e,Od,"1"),await bw(e,Od),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>_w(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>Bk(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>bw(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=of(a,!1).getAll();return new fu(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)i.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!i.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const a of Array.from(i))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),zk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}OE.type="LOCAL";const qk=OE;new uu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jE(n,e){return e?Ni(e):(Re(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g0 extends u0{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Xo(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Xo(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Xo(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function $k(n){return TE(n.auth,new g0(n),n.bypassAuthState)}function Gk(n){const{auth:e,user:t}=n;return Re(t,e,"internal-error"),_k(t,new g0(n),n.bypassAuthState)}async function Fk(n){const{auth:e,user:t}=n;return Re(t,e,"internal-error"),vk(t,new g0(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DE{constructor(e,t,i,a,l=!1){this.auth=e,this.resolver=i,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:a,tenantId:l,error:c,type:d}=e;if(c){this.reject(c);return}const p={auth:this.auth,requestUri:t,sessionId:i,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(d)(p))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return $k;case"linkViaPopup":case"linkViaRedirect":return Fk;case"reauthViaPopup":case"reauthViaRedirect":return Gk;default:is(this.auth,"internal-error")}}resolve(e){ki(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ki(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kk=new uu(2e3,1e4);async function Yk(n,e,t){if(An(n.app))return Promise.reject(xs(n,"operation-not-supported-in-this-environment"));const i=Vr(n);SI(n,e,d0);const a=jE(i,t);return new Na(i,"signInViaPopup",e,a).executeNotNull()}class Na extends DE{constructor(e,t,i,a,l){super(e,t,a,l),this.provider=i,this.authWindow=null,this.pollId=null,Na.currentPopupAction&&Na.currentPopupAction.cancel(),Na.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Re(e,this.auth,"internal-error"),e}async onExecution(){ki(this.filter.length===1,"Popup operations only handle one event");const e=f0();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(xs(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(xs(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Na.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if((i=(t=this.authWindow)==null?void 0:t.window)!=null&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(xs(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Kk.get())};e()}}Na.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wk="pendingRedirect",md=new Map;class Qk extends DE{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=md.get(this.auth._key());if(!e){try{const i=await Jk(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}md.set(this.auth._key(),e)}return this.bypassAuthState||md.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Jk(n,e){const t=eO(e),i=Zk(n);if(!await i._isAvailable())return!1;const a=await i._get(t)==="true";return await i._remove(t),a}function Xk(n,e){md.set(n._key(),e)}function Zk(n){return Ni(n._redirectPersistence)}function eO(n){return pd(Wk,n.config.apiKey,n.name)}async function tO(n,e,t=!1){if(An(n.app))return Promise.reject(Ci(n));const i=Vr(n),a=jE(i,e),c=await new Qk(i,a,t).execute();return c&&!t&&(delete c.user._redirectEventId,await i._persistUserIfCurrent(c.user),await i._setRedirectUser(null,e)),c}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nO=600*1e3;class sO{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!iO(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!PE(e)){const a=((i=e.error.code)==null?void 0:i.split("auth/")[1])||"internal-error";t.onError(xs(this.auth,a))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=nO&&this.cachedEventUids.clear(),this.cachedEventUids.has(ww(e))}saveEventToCache(e){this.cachedEventUids.add(ww(e)),this.lastProcessedEventTime=Date.now()}}function ww(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function PE({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function iO(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return PE(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rO(n,e={}){return Pi(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aO=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,oO=/^https?/;async function lO(n){if(n.config.emulator)return;const{authorizedDomains:e}=await rO(n);for(const t of e)try{if(cO(t))return}catch{}is(n,"unauthorized-domain")}function cO(n){const e=gm(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const c=new URL(n);return c.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&c.hostname===i}if(!oO.test(t))return!1;if(aO.test(n))return i===n;const a=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uO=new uu(3e4,6e4);function xw(){const n=Xs().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function hO(n){return new Promise((e,t)=>{var a,l,c;function i(){xw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{xw(),t(xs(n,"network-request-failed"))},timeout:uO.get()})}if((l=(a=Xs().gapi)==null?void 0:a.iframes)!=null&&l.Iframe)e(gapi.iframes.getContext());else if((c=Xs().gapi)!=null&&c.load)i();else{const d=ek("iframefcb");return Xs()[d]=()=>{gapi.load?i():t(xs(n,"network-request-failed"))},_E(`${ZI()}?onload=${d}`).catch(p=>t(p))}}).catch(e=>{throw yd=null,e})}let yd=null;function dO(n){return yd=yd||hO(n),yd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fO=new uu(5e3,15e3),gO="__/auth/iframe",pO="emulator/auth/iframe",mO={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},yO=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function vO(n){const e=n.config;Re(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?o0(e,pO):`https://${n.config.authDomain}/${gO}`,i={apiKey:e.apiKey,appName:n.name,v:Ha},a=yO.get(n.config.apiHost);a&&(i.eid=a);const l=n._getFrameworks();return l.length&&(i.fw=l.join(",")),`${t}?${cu(i).slice(1)}`}async function _O(n){const e=await dO(n),t=Xs().gapi;return Re(t,n,"internal-error"),e.open({where:document.body,url:vO(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:mO,dontclear:!0},i=>new Promise(async(a,l)=>{await i.restyle({setHideOnLeave:!1});const c=xs(n,"network-request-failed"),d=Xs().setTimeout(()=>{l(c)},fO.get());function p(){Xs().clearTimeout(d),a(i)}i.ping(p).then(p,()=>{l(c)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bO={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},wO=500,xO=600,TO="_blank",EO="http://localhost";class Tw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function SO(n,e,t,i=wO,a=xO){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),c=Math.max((window.screen.availWidth-i)/2,0).toString();let d="";const p={...bO,width:i.toString(),height:a.toString(),top:l,left:c},m=fn().toLowerCase();t&&(d=dE(m)?TO:t),uE(m)&&(e=e||EO,p.scrollbars="yes");const _=Object.entries(p).reduce((x,[S,N])=>`${x}${S}=${N},`,"");if($I(m)&&d!=="_self")return AO(e||"",d),new Tw(null);const b=window.open(e||"",d,_);Re(b,n,"popup-blocked");try{b.focus()}catch{}return new Tw(b)}function AO(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NO="__/auth/handler",CO="emulator/auth/handler",RO=encodeURIComponent("fac");async function Ew(n,e,t,i,a,l){Re(n.config.authDomain,n,"auth-domain-config-required"),Re(n.config.apiKey,n,"invalid-api-key");const c={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Ha,eventId:a};if(e instanceof d0){e.setDefaultLanguage(n.languageCode),c.providerId=e.providerId||"",VN(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,b]of Object.entries({}))c[_]=b}if(e instanceof du){const _=e.getScopes().filter(b=>b!=="");_.length>0&&(c.scopes=_.join(","))}n.tenantId&&(c.tid=n.tenantId);const d=c;for(const _ of Object.keys(d))d[_]===void 0&&delete d[_];const p=await n._getAppCheckToken(),m=p?`#${RO}=${encodeURIComponent(p)}`:"";return`${IO(n)}?${cu(d).slice(1)}${m}`}function IO({config:n}){return n.emulator?o0(n,CO):`https://${n.authDomain}/${NO}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hp="webStorageSupport";class kO{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=CE,this._completeRedirectFn=tO,this._overrideRedirectResult=Xk}async _openPopup(e,t,i,a){var c;ki((c=this.eventManagers[e._key()])==null?void 0:c.manager,"_initialize() not called before _openPopup()");const l=await Ew(e,t,i,gm(),a);return SO(e,l,f0())}async _openRedirect(e,t,i,a){await this._originValidation(e);const l=await Ew(e,t,i,gm(),a);return Dk(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:a,promise:l}=this.eventManagers[t];return a?Promise.resolve(a):(ki(l,"If manager is not set, promise should be"),l)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await _O(e),i=new sO(e);return t.register("authEvent",a=>(Re(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:i.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Hp,{type:Hp},a=>{var c;const l=(c=a==null?void 0:a[0])==null?void 0:c[Hp];l!==void 0&&t(!!l),is(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=lO(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return yE()||hE()||c0()}}const OO=kO;var Sw="@firebase/auth",Aw="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jO{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Re(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DO(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function PO(n){Es(new ss("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:c,authDomain:d}=i.options;Re(c&&!c.includes(":"),"invalid-api-key",{appName:i.name});const p={apiKey:c,authDomain:d,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:vE(n)},m=new QI(i,a,l,p);return ak(m,t),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),Es(new ss("auth-internal",e=>{const t=Vr(e.getProvider("auth").getImmediate());return(i=>new jO(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Cn(Sw,Aw,DO(n)),Cn(Sw,Aw,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MO=300,LO=ST("authIdTokenMaxAge")||MO;let Nw=null;const UO=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>LO)return;const a=t==null?void 0:t.token;Nw!==a&&(Nw=a,await fetch(n,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function VO(n=tf()){const e=Lr(n,"auth");if(e.isInitialized())return e.getImmediate();const t=rk(n,{popupRedirectResolver:OO,persistence:[qk,kk,CE]}),i=ST("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(i,location.origin);if(location.origin===l.origin){const c=UO(l.toString());Ak(t,c,()=>c(t.currentUser)),Sk(t,d=>c(d))}}const a=xT("auth");return a&&ok(t,`http://${a}`),t}function BO(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}JI({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=a=>{const l=xs("internal-error");l.customData=a,t(l)},i.type="text/javascript",i.charset="UTF-8",BO().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});PO("Browser");var Cw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Nr,ME;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(A,C){function I(){}I.prototype=C.prototype,A.F=C.prototype,A.prototype=new I,A.prototype.constructor=A,A.D=function(D,M,q){for(var O=Array(arguments.length-2),ce=2;ce<arguments.length;ce++)O[ce-2]=arguments[ce];return C.prototype[M].apply(D,O)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(A,C,I){I||(I=0);const D=Array(16);if(typeof C=="string")for(var M=0;M<16;++M)D[M]=C.charCodeAt(I++)|C.charCodeAt(I++)<<8|C.charCodeAt(I++)<<16|C.charCodeAt(I++)<<24;else for(M=0;M<16;++M)D[M]=C[I++]|C[I++]<<8|C[I++]<<16|C[I++]<<24;C=A.g[0],I=A.g[1],M=A.g[2];let q=A.g[3],O;O=C+(q^I&(M^q))+D[0]+3614090360&4294967295,C=I+(O<<7&4294967295|O>>>25),O=q+(M^C&(I^M))+D[1]+3905402710&4294967295,q=C+(O<<12&4294967295|O>>>20),O=M+(I^q&(C^I))+D[2]+606105819&4294967295,M=q+(O<<17&4294967295|O>>>15),O=I+(C^M&(q^C))+D[3]+3250441966&4294967295,I=M+(O<<22&4294967295|O>>>10),O=C+(q^I&(M^q))+D[4]+4118548399&4294967295,C=I+(O<<7&4294967295|O>>>25),O=q+(M^C&(I^M))+D[5]+1200080426&4294967295,q=C+(O<<12&4294967295|O>>>20),O=M+(I^q&(C^I))+D[6]+2821735955&4294967295,M=q+(O<<17&4294967295|O>>>15),O=I+(C^M&(q^C))+D[7]+4249261313&4294967295,I=M+(O<<22&4294967295|O>>>10),O=C+(q^I&(M^q))+D[8]+1770035416&4294967295,C=I+(O<<7&4294967295|O>>>25),O=q+(M^C&(I^M))+D[9]+2336552879&4294967295,q=C+(O<<12&4294967295|O>>>20),O=M+(I^q&(C^I))+D[10]+4294925233&4294967295,M=q+(O<<17&4294967295|O>>>15),O=I+(C^M&(q^C))+D[11]+2304563134&4294967295,I=M+(O<<22&4294967295|O>>>10),O=C+(q^I&(M^q))+D[12]+1804603682&4294967295,C=I+(O<<7&4294967295|O>>>25),O=q+(M^C&(I^M))+D[13]+4254626195&4294967295,q=C+(O<<12&4294967295|O>>>20),O=M+(I^q&(C^I))+D[14]+2792965006&4294967295,M=q+(O<<17&4294967295|O>>>15),O=I+(C^M&(q^C))+D[15]+1236535329&4294967295,I=M+(O<<22&4294967295|O>>>10),O=C+(M^q&(I^M))+D[1]+4129170786&4294967295,C=I+(O<<5&4294967295|O>>>27),O=q+(I^M&(C^I))+D[6]+3225465664&4294967295,q=C+(O<<9&4294967295|O>>>23),O=M+(C^I&(q^C))+D[11]+643717713&4294967295,M=q+(O<<14&4294967295|O>>>18),O=I+(q^C&(M^q))+D[0]+3921069994&4294967295,I=M+(O<<20&4294967295|O>>>12),O=C+(M^q&(I^M))+D[5]+3593408605&4294967295,C=I+(O<<5&4294967295|O>>>27),O=q+(I^M&(C^I))+D[10]+38016083&4294967295,q=C+(O<<9&4294967295|O>>>23),O=M+(C^I&(q^C))+D[15]+3634488961&4294967295,M=q+(O<<14&4294967295|O>>>18),O=I+(q^C&(M^q))+D[4]+3889429448&4294967295,I=M+(O<<20&4294967295|O>>>12),O=C+(M^q&(I^M))+D[9]+568446438&4294967295,C=I+(O<<5&4294967295|O>>>27),O=q+(I^M&(C^I))+D[14]+3275163606&4294967295,q=C+(O<<9&4294967295|O>>>23),O=M+(C^I&(q^C))+D[3]+4107603335&4294967295,M=q+(O<<14&4294967295|O>>>18),O=I+(q^C&(M^q))+D[8]+1163531501&4294967295,I=M+(O<<20&4294967295|O>>>12),O=C+(M^q&(I^M))+D[13]+2850285829&4294967295,C=I+(O<<5&4294967295|O>>>27),O=q+(I^M&(C^I))+D[2]+4243563512&4294967295,q=C+(O<<9&4294967295|O>>>23),O=M+(C^I&(q^C))+D[7]+1735328473&4294967295,M=q+(O<<14&4294967295|O>>>18),O=I+(q^C&(M^q))+D[12]+2368359562&4294967295,I=M+(O<<20&4294967295|O>>>12),O=C+(I^M^q)+D[5]+4294588738&4294967295,C=I+(O<<4&4294967295|O>>>28),O=q+(C^I^M)+D[8]+2272392833&4294967295,q=C+(O<<11&4294967295|O>>>21),O=M+(q^C^I)+D[11]+1839030562&4294967295,M=q+(O<<16&4294967295|O>>>16),O=I+(M^q^C)+D[14]+4259657740&4294967295,I=M+(O<<23&4294967295|O>>>9),O=C+(I^M^q)+D[1]+2763975236&4294967295,C=I+(O<<4&4294967295|O>>>28),O=q+(C^I^M)+D[4]+1272893353&4294967295,q=C+(O<<11&4294967295|O>>>21),O=M+(q^C^I)+D[7]+4139469664&4294967295,M=q+(O<<16&4294967295|O>>>16),O=I+(M^q^C)+D[10]+3200236656&4294967295,I=M+(O<<23&4294967295|O>>>9),O=C+(I^M^q)+D[13]+681279174&4294967295,C=I+(O<<4&4294967295|O>>>28),O=q+(C^I^M)+D[0]+3936430074&4294967295,q=C+(O<<11&4294967295|O>>>21),O=M+(q^C^I)+D[3]+3572445317&4294967295,M=q+(O<<16&4294967295|O>>>16),O=I+(M^q^C)+D[6]+76029189&4294967295,I=M+(O<<23&4294967295|O>>>9),O=C+(I^M^q)+D[9]+3654602809&4294967295,C=I+(O<<4&4294967295|O>>>28),O=q+(C^I^M)+D[12]+3873151461&4294967295,q=C+(O<<11&4294967295|O>>>21),O=M+(q^C^I)+D[15]+530742520&4294967295,M=q+(O<<16&4294967295|O>>>16),O=I+(M^q^C)+D[2]+3299628645&4294967295,I=M+(O<<23&4294967295|O>>>9),O=C+(M^(I|~q))+D[0]+4096336452&4294967295,C=I+(O<<6&4294967295|O>>>26),O=q+(I^(C|~M))+D[7]+1126891415&4294967295,q=C+(O<<10&4294967295|O>>>22),O=M+(C^(q|~I))+D[14]+2878612391&4294967295,M=q+(O<<15&4294967295|O>>>17),O=I+(q^(M|~C))+D[5]+4237533241&4294967295,I=M+(O<<21&4294967295|O>>>11),O=C+(M^(I|~q))+D[12]+1700485571&4294967295,C=I+(O<<6&4294967295|O>>>26),O=q+(I^(C|~M))+D[3]+2399980690&4294967295,q=C+(O<<10&4294967295|O>>>22),O=M+(C^(q|~I))+D[10]+4293915773&4294967295,M=q+(O<<15&4294967295|O>>>17),O=I+(q^(M|~C))+D[1]+2240044497&4294967295,I=M+(O<<21&4294967295|O>>>11),O=C+(M^(I|~q))+D[8]+1873313359&4294967295,C=I+(O<<6&4294967295|O>>>26),O=q+(I^(C|~M))+D[15]+4264355552&4294967295,q=C+(O<<10&4294967295|O>>>22),O=M+(C^(q|~I))+D[6]+2734768916&4294967295,M=q+(O<<15&4294967295|O>>>17),O=I+(q^(M|~C))+D[13]+1309151649&4294967295,I=M+(O<<21&4294967295|O>>>11),O=C+(M^(I|~q))+D[4]+4149444226&4294967295,C=I+(O<<6&4294967295|O>>>26),O=q+(I^(C|~M))+D[11]+3174756917&4294967295,q=C+(O<<10&4294967295|O>>>22),O=M+(C^(q|~I))+D[2]+718787259&4294967295,M=q+(O<<15&4294967295|O>>>17),O=I+(q^(M|~C))+D[9]+3951481745&4294967295,A.g[0]=A.g[0]+C&4294967295,A.g[1]=A.g[1]+(M+(O<<21&4294967295|O>>>11))&4294967295,A.g[2]=A.g[2]+M&4294967295,A.g[3]=A.g[3]+q&4294967295}i.prototype.v=function(A,C){C===void 0&&(C=A.length);const I=C-this.blockSize,D=this.C;let M=this.h,q=0;for(;q<C;){if(M==0)for(;q<=I;)a(this,A,q),q+=this.blockSize;if(typeof A=="string"){for(;q<C;)if(D[M++]=A.charCodeAt(q++),M==this.blockSize){a(this,D),M=0;break}}else for(;q<C;)if(D[M++]=A[q++],M==this.blockSize){a(this,D),M=0;break}}this.h=M,this.o+=C},i.prototype.A=function(){var A=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);A[0]=128;for(var C=1;C<A.length-8;++C)A[C]=0;C=this.o*8;for(var I=A.length-8;I<A.length;++I)A[I]=C&255,C/=256;for(this.v(A),A=Array(16),C=0,I=0;I<4;++I)for(let D=0;D<32;D+=8)A[C++]=this.g[I]>>>D&255;return A};function l(A,C){var I=d;return Object.prototype.hasOwnProperty.call(I,A)?I[A]:I[A]=C(A)}function c(A,C){this.h=C;const I=[];let D=!0;for(let M=A.length-1;M>=0;M--){const q=A[M]|0;D&&q==C||(I[M]=q,D=!1)}this.g=I}var d={};function p(A){return-128<=A&&A<128?l(A,function(C){return new c([C|0],C<0?-1:0)}):new c([A|0],A<0?-1:0)}function m(A){if(isNaN(A)||!isFinite(A))return b;if(A<0)return k(m(-A));const C=[];let I=1;for(let D=0;A>=I;D++)C[D]=A/I|0,I*=4294967296;return new c(C,0)}function _(A,C){if(A.length==0)throw Error("number format error: empty string");if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(A.charAt(0)=="-")return k(_(A.substring(1),C));if(A.indexOf("-")>=0)throw Error('number format error: interior "-" character');const I=m(Math.pow(C,8));let D=b;for(let q=0;q<A.length;q+=8){var M=Math.min(8,A.length-q);const O=parseInt(A.substring(q,q+M),C);M<8?(M=m(Math.pow(C,M)),D=D.j(M).add(m(O))):(D=D.j(I),D=D.add(m(O)))}return D}var b=p(0),x=p(1),S=p(16777216);n=c.prototype,n.m=function(){if(j(this))return-k(this).m();let A=0,C=1;for(let I=0;I<this.g.length;I++){const D=this.i(I);A+=(D>=0?D:4294967296+D)*C,C*=4294967296}return A},n.toString=function(A){if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(N(this))return"0";if(j(this))return"-"+k(this).toString(A);const C=m(Math.pow(A,6));var I=this;let D="";for(;;){const M=K(I,C).g;I=L(I,M.j(C));let q=((I.g.length>0?I.g[0]:I.h)>>>0).toString(A);if(I=M,N(I))return q+D;for(;q.length<6;)q="0"+q;D=q+D}},n.i=function(A){return A<0?0:A<this.g.length?this.g[A]:this.h};function N(A){if(A.h!=0)return!1;for(let C=0;C<A.g.length;C++)if(A.g[C]!=0)return!1;return!0}function j(A){return A.h==-1}n.l=function(A){return A=L(this,A),j(A)?-1:N(A)?0:1};function k(A){const C=A.g.length,I=[];for(let D=0;D<C;D++)I[D]=~A.g[D];return new c(I,~A.h).add(x)}n.abs=function(){return j(this)?k(this):this},n.add=function(A){const C=Math.max(this.g.length,A.g.length),I=[];let D=0;for(let M=0;M<=C;M++){let q=D+(this.i(M)&65535)+(A.i(M)&65535),O=(q>>>16)+(this.i(M)>>>16)+(A.i(M)>>>16);D=O>>>16,q&=65535,O&=65535,I[M]=O<<16|q}return new c(I,I[I.length-1]&-2147483648?-1:0)};function L(A,C){return A.add(k(C))}n.j=function(A){if(N(this)||N(A))return b;if(j(this))return j(A)?k(this).j(k(A)):k(k(this).j(A));if(j(A))return k(this.j(k(A)));if(this.l(S)<0&&A.l(S)<0)return m(this.m()*A.m());const C=this.g.length+A.g.length,I=[];for(var D=0;D<2*C;D++)I[D]=0;for(D=0;D<this.g.length;D++)for(let M=0;M<A.g.length;M++){const q=this.i(D)>>>16,O=this.i(D)&65535,ce=A.i(M)>>>16,ue=A.i(M)&65535;I[2*D+2*M]+=O*ue,H(I,2*D+2*M),I[2*D+2*M+1]+=q*ue,H(I,2*D+2*M+1),I[2*D+2*M+1]+=O*ce,H(I,2*D+2*M+1),I[2*D+2*M+2]+=q*ce,H(I,2*D+2*M+2)}for(A=0;A<C;A++)I[A]=I[2*A+1]<<16|I[2*A];for(A=C;A<2*C;A++)I[A]=0;return new c(I,0)};function H(A,C){for(;(A[C]&65535)!=A[C];)A[C+1]+=A[C]>>>16,A[C]&=65535,C++}function B(A,C){this.g=A,this.h=C}function K(A,C){if(N(C))throw Error("division by zero");if(N(A))return new B(b,b);if(j(A))return C=K(k(A),C),new B(k(C.g),k(C.h));if(j(C))return C=K(A,k(C)),new B(k(C.g),C.h);if(A.g.length>30){if(j(A)||j(C))throw Error("slowDivide_ only works with positive integers.");for(var I=x,D=C;D.l(A)<=0;)I=F(I),D=F(D);var M=$(I,1),q=$(D,1);for(D=$(D,2),I=$(I,2);!N(D);){var O=q.add(D);O.l(A)<=0&&(M=M.add(I),q=O),D=$(D,1),I=$(I,1)}return C=L(A,M.j(C)),new B(M,C)}for(M=b;A.l(C)>=0;){for(I=Math.max(1,Math.floor(A.m()/C.m())),D=Math.ceil(Math.log(I)/Math.LN2),D=D<=48?1:Math.pow(2,D-48),q=m(I),O=q.j(C);j(O)||O.l(A)>0;)I-=D,q=m(I),O=q.j(C);N(q)&&(q=x),M=M.add(q),A=L(A,O)}return new B(M,A)}n.B=function(A){return K(this,A).h},n.and=function(A){const C=Math.max(this.g.length,A.g.length),I=[];for(let D=0;D<C;D++)I[D]=this.i(D)&A.i(D);return new c(I,this.h&A.h)},n.or=function(A){const C=Math.max(this.g.length,A.g.length),I=[];for(let D=0;D<C;D++)I[D]=this.i(D)|A.i(D);return new c(I,this.h|A.h)},n.xor=function(A){const C=Math.max(this.g.length,A.g.length),I=[];for(let D=0;D<C;D++)I[D]=this.i(D)^A.i(D);return new c(I,this.h^A.h)};function F(A){const C=A.g.length+1,I=[];for(let D=0;D<C;D++)I[D]=A.i(D)<<1|A.i(D-1)>>>31;return new c(I,A.h)}function $(A,C){const I=C>>5;C%=32;const D=A.g.length-I,M=[];for(let q=0;q<D;q++)M[q]=C>0?A.i(q+I)>>>C|A.i(q+I+1)<<32-C:A.i(q+I);return new c(M,A.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,ME=i,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.B,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=m,c.fromString=_,Nr=c}).apply(typeof Cw<"u"?Cw:typeof self<"u"?self:typeof window<"u"?window:{});var ed=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var LE,Ic,UE,vd,vm,VE,BE,zE;(function(){var n,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof ed=="object"&&ed];for(var v=0;v<h.length;++v){var T=h[v];if(T&&T.Math==Math)return T}throw Error("Cannot find global object")}var i=t(this);function a(h,v){if(v)e:{var T=i;h=h.split(".");for(var R=0;R<h.length-1;R++){var Y=h[R];if(!(Y in T))break e;T=T[Y]}h=h[h.length-1],R=T[h],v=v(R),v!=R&&v!=null&&e(T,h,{configurable:!0,writable:!0,value:v})}}a("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(h){return h||function(v){var T=[],R;for(R in v)Object.prototype.hasOwnProperty.call(v,R)&&T.push([R,v[R]]);return T}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},c=this||self;function d(h){var v=typeof h;return v=="object"&&h!=null||v=="function"}function p(h,v,T){return h.call.apply(h.bind,arguments)}function m(h,v,T){return m=p,m.apply(null,arguments)}function _(h,v){var T=Array.prototype.slice.call(arguments,1);return function(){var R=T.slice();return R.push.apply(R,arguments),h.apply(this,R)}}function b(h,v){function T(){}T.prototype=v.prototype,h.Z=v.prototype,h.prototype=new T,h.prototype.constructor=h,h.Ob=function(R,Y,X){for(var fe=Array(arguments.length-2),Pe=2;Pe<arguments.length;Pe++)fe[Pe-2]=arguments[Pe];return v.prototype[Y].apply(R,fe)}}var x=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function S(h){const v=h.length;if(v>0){const T=Array(v);for(let R=0;R<v;R++)T[R]=h[R];return T}return[]}function N(h,v){for(let R=1;R<arguments.length;R++){const Y=arguments[R];var T=typeof Y;if(T=T!="object"?T:Y?Array.isArray(Y)?"array":T:"null",T=="array"||T=="object"&&typeof Y.length=="number"){T=h.length||0;const X=Y.length||0;h.length=T+X;for(let fe=0;fe<X;fe++)h[T+fe]=Y[fe]}else h.push(Y)}}class j{constructor(v,T){this.i=v,this.j=T,this.h=0,this.g=null}get(){let v;return this.h>0?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function k(h){c.setTimeout(()=>{throw h},0)}function L(){var h=A;let v=null;return h.g&&(v=h.g,h.g=h.g.next,h.g||(h.h=null),v.next=null),v}class H{constructor(){this.h=this.g=null}add(v,T){const R=B.get();R.set(v,T),this.h?this.h.next=R:this.g=R,this.h=R}}var B=new j(()=>new K,h=>h.reset());class K{constructor(){this.next=this.g=this.h=null}set(v,T){this.h=v,this.g=T,this.next=null}reset(){this.next=this.g=this.h=null}}let F,$=!1,A=new H,C=()=>{const h=Promise.resolve(void 0);F=()=>{h.then(I)}};function I(){for(var h;h=L();){try{h.h.call(h.g)}catch(T){k(T)}var v=B;v.j(h),v.h<100&&(v.h++,h.next=v.g,v.g=h)}$=!1}function D(){this.u=this.u,this.C=this.C}D.prototype.u=!1,D.prototype.dispose=function(){this.u||(this.u=!0,this.N())},D.prototype[Symbol.dispose]=function(){this.dispose()},D.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function M(h,v){this.type=h,this.g=this.target=v,this.defaultPrevented=!1}M.prototype.h=function(){this.defaultPrevented=!0};var q=(function(){if(!c.addEventListener||!Object.defineProperty)return!1;var h=!1,v=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const T=()=>{};c.addEventListener("test",T,v),c.removeEventListener("test",T,v)}catch{}return h})();function O(h){return/^[\s\xa0]*$/.test(h)}function ce(h,v){M.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,v)}b(ce,M),ce.prototype.init=function(h,v){const T=this.type=h.type,R=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=v,v=h.relatedTarget,v||(T=="mouseover"?v=h.fromElement:T=="mouseout"&&(v=h.toElement)),this.relatedTarget=v,R?(this.clientX=R.clientX!==void 0?R.clientX:R.pageX,this.clientY=R.clientY!==void 0?R.clientY:R.pageY,this.screenX=R.screenX||0,this.screenY=R.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&ce.Z.h.call(this)},ce.prototype.h=function(){ce.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var ue="closure_listenable_"+(Math.random()*1e6|0),U=0;function se(h,v,T,R,Y){this.listener=h,this.proxy=null,this.src=v,this.type=T,this.capture=!!R,this.ha=Y,this.key=++U,this.da=this.fa=!1}function pe(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function be(h,v,T){for(const R in h)v.call(T,h[R],R,h)}function Ve(h,v){for(const T in h)v.call(void 0,h[T],T,h)}function V(h){const v={};for(const T in h)v[T]=h[T];return v}const te="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function de(h,v){let T,R;for(let Y=1;Y<arguments.length;Y++){R=arguments[Y];for(T in R)h[T]=R[T];for(let X=0;X<te.length;X++)T=te[X],Object.prototype.hasOwnProperty.call(R,T)&&(h[T]=R[T])}}function ge(h){this.src=h,this.g={},this.h=0}ge.prototype.add=function(h,v,T,R,Y){const X=h.toString();h=this.g[X],h||(h=this.g[X]=[],this.h++);const fe=ke(h,v,R,Y);return fe>-1?(v=h[fe],T||(v.fa=!1)):(v=new se(v,this.src,X,!!R,Y),v.fa=T,h.push(v)),v};function Se(h,v){const T=v.type;if(T in h.g){var R=h.g[T],Y=Array.prototype.indexOf.call(R,v,void 0),X;(X=Y>=0)&&Array.prototype.splice.call(R,Y,1),X&&(pe(v),h.g[T].length==0&&(delete h.g[T],h.h--))}}function ke(h,v,T,R){for(let Y=0;Y<h.length;++Y){const X=h[Y];if(!X.da&&X.listener==v&&X.capture==!!T&&X.ha==R)return Y}return-1}var Le="closure_lm_"+(Math.random()*1e6|0),ee={};function he(h,v,T,R,Y){if(Array.isArray(v)){for(let X=0;X<v.length;X++)he(h,v[X],T,R,Y);return null}return T=wl(T),h&&h[ue]?h.J(v,T,d(R)?!!R.capture:!1,Y):ye(h,v,T,!1,R,Y)}function ye(h,v,T,R,Y,X){if(!v)throw Error("Invalid event type");const fe=d(Y)?!!Y.capture:!!Y;let Pe=qr(h);if(Pe||(h[Le]=Pe=new ge(h)),T=Pe.add(v,T,R,fe,X),T.proxy)return T;if(R=wt(),T.proxy=R,R.src=h,R.listener=T,h.addEventListener)q||(Y=fe),Y===void 0&&(Y=!1),h.addEventListener(v.toString(),R,Y);else if(h.attachEvent)h.attachEvent(Ns(v.toString()),R);else if(h.addListener&&h.removeListener)h.addListener(R);else throw Error("addEventListener and attachEvent are unavailable.");return T}function wt(){function h(T){return v.call(h.src,h.listener,T)}const v=_l;return h}function Wt(h,v,T,R,Y){if(Array.isArray(v))for(var X=0;X<v.length;X++)Wt(h,v[X],T,R,Y);else R=d(R)?!!R.capture:!!R,T=wl(T),h&&h[ue]?(h=h.i,X=String(v).toString(),X in h.g&&(v=h.g[X],T=ke(v,T,R,Y),T>-1&&(pe(v[T]),Array.prototype.splice.call(v,T,1),v.length==0&&(delete h.g[X],h.h--)))):h&&(h=qr(h))&&(v=h.g[v.toString()],h=-1,v&&(h=ke(v,T,R,Y)),(T=h>-1?v[h]:null)&&As(T))}function As(h){if(typeof h!="number"&&h&&!h.da){var v=h.src;if(v&&v[ue])Se(v.i,h);else{var T=h.type,R=h.proxy;v.removeEventListener?v.removeEventListener(T,R,h.capture):v.detachEvent?v.detachEvent(Ns(T),R):v.addListener&&v.removeListener&&v.removeListener(R),(T=qr(v))?(Se(T,h),T.h==0&&(T.src=null,v[Le]=null)):pe(h)}}}function Ns(h){return h in ee?ee[h]:ee[h]="on"+h}function _l(h,v){if(h.da)h=!0;else{v=new ce(v,this);const T=h.listener,R=h.ha||h.src;h.fa&&As(h),h=T.call(R,v)}return h}function qr(h){return h=h[Le],h instanceof ge?h:null}var bl="__closure_events_fn_"+(Math.random()*1e9>>>0);function wl(h){return typeof h=="function"?h:(h[bl]||(h[bl]=function(v){return h.handleEvent(v)}),h[bl])}function Ct(){D.call(this),this.i=new ge(this),this.M=this,this.G=null}b(Ct,D),Ct.prototype[ue]=!0,Ct.prototype.removeEventListener=function(h,v,T,R){Wt(this,h,v,T,R)};function zt(h,v){var T,R=h.G;if(R)for(T=[];R;R=R.G)T.push(R);if(h=h.M,R=v.type||v,typeof v=="string")v=new M(v,h);else if(v instanceof M)v.target=v.target||h;else{var Y=v;v=new M(R,h),de(v,Y)}Y=!0;let X,fe;if(T)for(fe=T.length-1;fe>=0;fe--)X=v.g=T[fe],Y=Li(X,R,!0,v)&&Y;if(X=v.g=h,Y=Li(X,R,!0,v)&&Y,Y=Li(X,R,!1,v)&&Y,T)for(fe=0;fe<T.length;fe++)X=v.g=T[fe],Y=Li(X,R,!1,v)&&Y}Ct.prototype.N=function(){if(Ct.Z.N.call(this),this.i){var h=this.i;for(const v in h.g){const T=h.g[v];for(let R=0;R<T.length;R++)pe(T[R]);delete h.g[v],h.h--}}this.G=null},Ct.prototype.J=function(h,v,T,R){return this.i.add(String(h),v,!1,T,R)},Ct.prototype.K=function(h,v,T,R){return this.i.add(String(h),v,!0,T,R)};function Li(h,v,T,R){if(v=h.i.g[String(v)],!v)return!0;v=v.concat();let Y=!0;for(let X=0;X<v.length;++X){const fe=v[X];if(fe&&!fe.da&&fe.capture==T){const Pe=fe.listener,Tt=fe.ha||fe.src;fe.fa&&Se(h.i,fe),Y=Pe.call(Tt,R)!==!1&&Y}}return Y&&!R.defaultPrevented}function Cf(h,v){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=m(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(v)>2147483647?-1:c.setTimeout(h,v||0)}function Eu(h){h.g=Cf(()=>{h.g=null,h.i&&(h.i=!1,Eu(h))},h.l);const v=h.h;h.h=null,h.m.apply(null,v)}class gn extends D{constructor(v,T){super(),this.m=v,this.l=T,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:Eu(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function $r(h){D.call(this),this.h=h,this.g={}}b($r,D);var xl=[];function Tl(h){be(h.g,function(v,T){this.g.hasOwnProperty(T)&&As(v)},h),h.g={}}$r.prototype.N=function(){$r.Z.N.call(this),Tl(this)},$r.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ui=c.JSON.stringify,Rf=c.JSON.parse,Su=class{stringify(h){return c.JSON.stringify(h,void 0)}parse(h){return c.JSON.parse(h,void 0)}};function Au(){}function Nu(){}var as={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Qt(){M.call(this,"d")}b(Qt,M);function Hn(){M.call(this,"c")}b(Hn,M);var xt={},Cu=null;function Ga(){return Cu=Cu||new Ct}xt.Ia="serverreachability";function Ru(h){M.call(this,xt.Ia,h)}b(Ru,M);function Cs(h){const v=Ga();zt(v,new Ru(v))}xt.STAT_EVENT="statevent";function Gr(h,v){M.call(this,xt.STAT_EVENT,h),this.stat=v}b(Gr,M);function Rt(h){const v=Ga();zt(v,new Gr(v,h))}xt.Ja="timingevent";function Rs(h,v){M.call(this,xt.Ja,h),this.size=v}b(Rs,M);function Is(h,v){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){h()},v)}function os(){this.g=!0}os.prototype.ua=function(){this.g=!1};function If(h,v,T,R,Y,X){h.info(function(){if(h.g)if(X){var fe="",Pe=X.split("&");for(let Je=0;Je<Pe.length;Je++){var Tt=Pe[Je].split("=");if(Tt.length>1){const ft=Tt[0];Tt=Tt[1];const Fn=ft.split("_");fe=Fn.length>=2&&Fn[1]=="type"?fe+(ft+"="+Tt+"&"):fe+(ft+"=redacted&")}}}else fe=null;else fe=X;return"XMLHTTP REQ ("+R+") [attempt "+Y+"]: "+v+`
`+T+`
`+fe})}function Iu(h,v,T,R,Y,X,fe){h.info(function(){return"XMLHTTP RESP ("+R+") [ attempt "+Y+"]: "+v+`
`+T+`
`+X+" "+fe})}function ks(h,v,T,R){h.info(function(){return"XMLHTTP TEXT ("+v+"): "+kf(h,T)+(R?" "+R:"")})}function Fr(h,v){h.info(function(){return"TIMEOUT: "+v})}os.prototype.info=function(){};function kf(h,v){if(!h.g)return v;if(!v)return null;try{const X=JSON.parse(v);if(X){for(h=0;h<X.length;h++)if(Array.isArray(X[h])){var T=X[h];if(!(T.length<2)){var R=T[1];if(Array.isArray(R)&&!(R.length<1)){var Y=R[0];if(Y!="noop"&&Y!="stop"&&Y!="close")for(let fe=1;fe<R.length;fe++)R[fe]=""}}}}return Ui(X)}catch{return v}}var Kr={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},El={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Sl;function Yr(){}b(Yr,Au),Yr.prototype.g=function(){return new XMLHttpRequest},Sl=new Yr;function ri(h){return encodeURIComponent(String(h))}function ku(h){var v=1;h=h.split(":");const T=[];for(;v>0&&h.length;)T.push(h.shift()),v--;return h.length&&T.push(h.join(":")),T}function ls(h,v,T,R){this.j=h,this.i=v,this.l=T,this.S=R||1,this.V=new $r(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new cs}function cs(){this.i=null,this.g="",this.h=!1}var It={},Gt={};function Os(h,v,T){h.M=1,h.A=Wr(Ot(v)),h.u=T,h.R=!0,Fa(h,null)}function Fa(h,v){h.F=Date.now(),js(h),h.B=Ot(h.A);var T=h.B,R=h.S;Array.isArray(R)||(R=[String(R)]),Qa(T.i,"t",R),h.C=0,T=h.j.L,h.h=new cs,h.g=Fu(h.j,T?v:null,!h.u),h.P>0&&(h.O=new gn(m(h.Y,h,h.g),h.P)),v=h.V,T=h.g,R=h.ba;var Y="readystatechange";Array.isArray(Y)||(Y&&(xl[0]=Y.toString()),Y=xl);for(let X=0;X<Y.length;X++){const fe=he(T,Y[X],R||v.handleEvent,!1,v.h||v);if(!fe)break;v.g[fe.key]=fe}v=h.J?V(h.J):{},h.u?(h.v||(h.v="POST"),v["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,v)):(h.v="GET",h.g.ea(h.B,h.v,null,v)),Cs(),If(h.i,h.v,h.B,h.l,h.S,h.u)}ls.prototype.ba=function(h){h=h.target;const v=this.O;v&&ds(h)==3?v.j():this.Y(h)},ls.prototype.Y=function(h){try{if(h==this.g)e:{const Pe=ds(this.g),Tt=this.g.ya(),Je=this.g.ca();if(!(Pe<3)&&(Pe!=3||this.g&&(this.h.h||this.g.la()||Jt(this.g)))){this.K||Pe!=4||Tt==7||(Tt==8||Je<=0?Cs(3):Cs(2)),Ds(this);var v=this.g.ca();this.X=v;var T=Of(this);if(this.o=v==200,Iu(this.i,this.v,this.B,this.l,this.S,Pe,v),this.o){if(this.U&&!this.L){t:{if(this.g){var R,Y=this.g;if((R=Y.g?Y.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!O(R)){var X=R;break t}}X=null}if(h=X)ks(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ps(this,h);else{this.o=!1,this.m=3,Rt(12),In(this),qn(this);break e}}if(this.R){h=!0;let ft;for(;!this.K&&this.C<T.length;)if(ft=ju(this,T),ft==Gt){Pe==4&&(this.m=4,Rt(14),h=!1),ks(this.i,this.l,null,"[Incomplete Response]");break}else if(ft==It){this.m=4,Rt(15),ks(this.i,this.l,T,"[Invalid Chunk]"),h=!1;break}else ks(this.i,this.l,ft,null),Ps(this,ft);if(Ou(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Pe!=4||T.length!=0||this.h.h||(this.m=1,Rt(16),h=!1),this.o=this.o&&h,!h)ks(this.i,this.l,T,"[Invalid Chunked Response]"),In(this),qn(this);else if(T.length>0&&!this.W){this.W=!0;var fe=this.j;fe.g==this&&fe.aa&&!fe.P&&(fe.j.info("Great, no buffering proxy detected. Bytes received: "+T.length),Bl(fe),fe.P=!0,Rt(11))}}else ks(this.i,this.l,T,null),Ps(this,T);Pe==4&&In(this),this.o&&!this.K&&(Pe==4?Hu(this.j,this):(this.o=!1,js(this)))}else oi(this.g),v==400&&T.indexOf("Unknown SID")>0?(this.m=3,Rt(12)):(this.m=0,Rt(13)),In(this),qn(this)}}}catch{}finally{}};function Of(h){if(!Ou(h))return h.g.la();const v=Jt(h.g);if(v==="")return"";let T="";const R=v.length,Y=ds(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return In(h),qn(h),"";h.h.i=new c.TextDecoder}for(let X=0;X<R;X++)h.h.h=!0,T+=h.h.i.decode(v[X],{stream:!(Y&&X==R-1)});return v.length=0,h.h.g+=T,h.C=0,h.h.g}function Ou(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function ju(h,v){var T=h.C,R=v.indexOf(`
`,T);return R==-1?Gt:(T=Number(v.substring(T,R)),isNaN(T)?It:(R+=1,R+T>v.length?Gt:(v=v.slice(R,R+T),h.C=R+T,v)))}ls.prototype.cancel=function(){this.K=!0,In(this)};function js(h){h.T=Date.now()+h.H,Ka(h,h.H)}function Ka(h,v){if(h.D!=null)throw Error("WatchDog timer not null");h.D=Is(m(h.aa,h),v)}function Ds(h){h.D&&(c.clearTimeout(h.D),h.D=null)}ls.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(Fr(this.i,this.B),this.M!=2&&(Cs(),Rt(17)),In(this),this.m=2,qn(this)):Ka(this,this.T-h)};function qn(h){h.j.I==0||h.K||Hu(h.j,h)}function In(h){Ds(h);var v=h.O;v&&typeof v.dispose=="function"&&v.dispose(),h.O=null,Tl(h.V),h.g&&(v=h.g,h.g=null,v.abort(),v.dispose())}function Ps(h,v){try{var T=h.j;if(T.I!=0&&(T.g==h||Ls(T.h,h))){if(!h.L&&Ls(T.h,h)&&T.I==3){try{var R=T.Ba.g.parse(v)}catch{R=null}if(Array.isArray(R)&&R.length==3){var Y=R;if(Y[0]==0){e:if(!T.v){if(T.g)if(T.g.F+3e3<h.F)to(T),Fi(T);else break e;na(T),Rt(18)}}else T.xa=Y[1],0<T.xa-T.K&&Y[2]<37500&&T.F&&T.A==0&&!T.C&&(T.C=Is(m(T.Va,T),6e3));Ms(T.h)<=1&&T.ta&&(T.ta=void 0)}else qs(T,11)}else if((h.L||T.g==h)&&to(T),!O(v))for(Y=T.Ba.g.parse(v),v=0;v<Y.length;v++){let Je=Y[v];const ft=Je[0];if(!(ft<=T.K))if(T.K=ft,Je=Je[1],T.I==2)if(Je[0]=="c"){T.M=Je[1],T.ba=Je[2];const Fn=Je[3];Fn!=null&&(T.ka=Fn,T.j.info("VER="+T.ka));const $s=Je[4];$s!=null&&(T.za=$s,T.j.info("SVER="+T.za));const fs=Je[5];fs!=null&&typeof fs=="number"&&fs>0&&(R=1.5*fs,T.O=R,T.j.info("backChannelRequestTimeoutMs_="+R)),R=T;const gs=h.g;if(gs){const sa=gs.g?gs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(sa){var X=R.h;X.g||sa.indexOf("spdy")==-1&&sa.indexOf("quic")==-1&&sa.indexOf("h2")==-1||(X.j=X.l,X.g=new Set,X.h&&(Cl(X,X.h),X.h=null))}if(R.G){const no=gs.g?gs.g.getResponseHeader("X-HTTP-Session-Id"):null;no&&(R.wa=no,et(R.J,R.G,no))}}T.I=3,T.l&&T.l.ra(),T.aa&&(T.T=Date.now()-h.F,T.j.info("Handshake RTT: "+T.T+"ms")),R=T;var fe=h;if(R.na=Gu(R,R.L?R.ba:null,R.W),fe.L){Rl(R.h,fe);var Pe=fe,Tt=R.O;Tt&&(Pe.H=Tt),Pe.D&&(Ds(Pe),js(Pe)),R.g=fe}else Bu(R);T.i.length>0&&Hs(T)}else Je[0]!="stop"&&Je[0]!="close"||qs(T,7);else T.I==3&&(Je[0]=="stop"||Je[0]=="close"?Je[0]=="stop"?qs(T,7):Ul(T):Je[0]!="noop"&&T.l&&T.l.qa(Je),T.A=0)}}Cs(4)}catch{}}var kt=class{constructor(h,v){this.g=h,this.map=v}};function Al(h){this.l=h||10,c.PerformanceNavigationTiming?(h=c.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Nl(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Ms(h){return h.h?1:h.g?h.g.size:0}function Ls(h,v){return h.h?h.h==v:h.g?h.g.has(v):!1}function Cl(h,v){h.g?h.g.add(v):h.h=v}function Rl(h,v){h.h&&h.h==v?h.h=null:h.g&&h.g.has(v)&&h.g.delete(v)}Al.prototype.cancel=function(){if(this.i=Il(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Il(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let v=h.i;for(const T of h.g.values())v=v.concat(T.G);return v}return S(h.i)}var Du=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ya(h,v){if(h){h=h.split("&");for(let T=0;T<h.length;T++){const R=h[T].indexOf("=");let Y,X=null;R>=0?(Y=h[T].substring(0,R),X=h[T].substring(R+1)):Y=h[T],v(Y,X?decodeURIComponent(X.replace(/\+/g," ")):"")}}}function kn(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let v;h instanceof kn?(this.l=h.l,Ft(this,h.j),this.o=h.o,this.g=h.g,Vi(this,h.u),this.h=h.h,kl(this,Uu(h.i)),this.m=h.m):h&&(v=String(h).match(Du))?(this.l=!1,Ft(this,v[1]||"",!0),this.o=Us(v[2]||""),this.g=Us(v[3]||"",!0),Vi(this,v[4]),this.h=Us(v[5]||"",!0),kl(this,v[6]||"",!0),this.m=Us(v[7]||"")):(this.l=!1,this.i=new zi(null,this.l))}kn.prototype.toString=function(){const h=[];var v=this.j;v&&h.push(Qr(v,Wa,!0),":");var T=this.g;return(T||v=="file")&&(h.push("//"),(v=this.o)&&h.push(Qr(v,Wa,!0),"@"),h.push(ri(T).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),T=this.u,T!=null&&h.push(":",String(T))),(T=this.h)&&(this.g&&T.charAt(0)!="/"&&h.push("/"),h.push(Qr(T,T.charAt(0)=="/"?Ol:Pu,!0))),(T=this.i.toString())&&h.push("?",T),(T=this.m)&&h.push("#",Qr(T,Mu)),h.join("")},kn.prototype.resolve=function(h){const v=Ot(this);let T=!!h.j;T?Ft(v,h.j):T=!!h.o,T?v.o=h.o:T=!!h.g,T?v.g=h.g:T=h.u!=null;var R=h.h;if(T)Vi(v,h.u);else if(T=!!h.h){if(R.charAt(0)!="/")if(this.g&&!this.h)R="/"+R;else{var Y=v.h.lastIndexOf("/");Y!=-1&&(R=v.h.slice(0,Y+1)+R)}if(Y=R,Y==".."||Y==".")R="";else if(Y.indexOf("./")!=-1||Y.indexOf("/.")!=-1){R=Y.lastIndexOf("/",0)==0,Y=Y.split("/");const X=[];for(let fe=0;fe<Y.length;){const Pe=Y[fe++];Pe=="."?R&&fe==Y.length&&X.push(""):Pe==".."?((X.length>1||X.length==1&&X[0]!="")&&X.pop(),R&&fe==Y.length&&X.push("")):(X.push(Pe),R=!0)}R=X.join("/")}else R=Y}return T?v.h=R:T=h.i.toString()!=="",T?kl(v,Uu(h.i)):T=!!h.m,T&&(v.m=h.m),v};function Ot(h){return new kn(h)}function Ft(h,v,T){h.j=T?Us(v,!0):v,h.j&&(h.j=h.j.replace(/:$/,""))}function Vi(h,v){if(v){if(v=Number(v),isNaN(v)||v<0)throw Error("Bad port number "+v);h.u=v}else h.u=null}function kl(h,v,T){v instanceof zi?(h.i=v,Ja(h.i,h.l)):(T||(v=Qr(v,Bi)),h.i=new zi(v,h.l))}function et(h,v,T){h.i.set(v,T)}function Wr(h){return et(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function Us(h,v){return h?v?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Qr(h,v,T){return typeof h=="string"?(h=encodeURI(h).replace(v,vn),T&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function vn(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Wa=/[#\/\?@]/g,Pu=/[#\?:]/g,Ol=/[#\?]/g,Bi=/[#\?@]/g,Mu=/#/g;function zi(h,v){this.h=this.g=null,this.i=h||null,this.j=!!v}function _n(h){h.g||(h.g=new Map,h.h=0,h.i&&Ya(h.i,function(v,T){h.add(decodeURIComponent(v.replace(/\+/g," ")),T)}))}n=zi.prototype,n.add=function(h,v){_n(this),this.i=null,h=Hi(this,h);let T=this.g.get(h);return T||this.g.set(h,T=[]),T.push(v),this.h+=1,this};function Lu(h,v){_n(h),v=Hi(h,v),h.g.has(v)&&(h.i=null,h.h-=h.g.get(v).length,h.g.delete(v))}function jl(h,v){return _n(h),v=Hi(h,v),h.g.has(v)}n.forEach=function(h,v){_n(this),this.g.forEach(function(T,R){T.forEach(function(Y){h.call(v,Y,R,this)},this)},this)};function Dl(h,v){_n(h);let T=[];if(typeof v=="string")jl(h,v)&&(T=T.concat(h.g.get(Hi(h,v))));else for(h=Array.from(h.g.values()),v=0;v<h.length;v++)T=T.concat(h[v]);return T}n.set=function(h,v){return _n(this),this.i=null,h=Hi(this,h),jl(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[v]),this.h+=1,this},n.get=function(h,v){return h?(h=Dl(this,h),h.length>0?String(h[0]):v):v};function Qa(h,v,T){Lu(h,v),T.length>0&&(h.i=null,h.g.set(Hi(h,v),S(T)),h.h+=T.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],v=Array.from(this.g.keys());for(let R=0;R<v.length;R++){var T=v[R];const Y=ri(T);T=Dl(this,T);for(let X=0;X<T.length;X++){let fe=Y;T[X]!==""&&(fe+="="+ri(T[X])),h.push(fe)}}return this.i=h.join("&")};function Uu(h){const v=new zi;return v.i=h.i,h.g&&(v.g=new Map(h.g),v.h=h.h),v}function Hi(h,v){return v=String(v),h.j&&(v=v.toLowerCase()),v}function Ja(h,v){v&&!h.j&&(_n(h),h.i=null,h.g.forEach(function(T,R){const Y=R.toLowerCase();R!=Y&&(Lu(this,R),Qa(this,Y,T))},h)),h.j=v}function us(h,v){const T=new os;if(c.Image){const R=new Image;R.onload=_($n,T,"TestLoadImage: loaded",!0,v,R),R.onerror=_($n,T,"TestLoadImage: error",!1,v,R),R.onabort=_($n,T,"TestLoadImage: abort",!1,v,R),R.ontimeout=_($n,T,"TestLoadImage: timeout",!1,v,R),c.setTimeout(function(){R.ontimeout&&R.ontimeout()},1e4),R.src=h}else v(!1)}function Pl(h,v){const T=new os,R=new AbortController,Y=setTimeout(()=>{R.abort(),$n(T,"TestPingServer: timeout",!1,v)},1e4);fetch(h,{signal:R.signal}).then(X=>{clearTimeout(Y),X.ok?$n(T,"TestPingServer: ok",!0,v):$n(T,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(Y),$n(T,"TestPingServer: error",!1,v)})}function $n(h,v,T,R,Y){try{Y&&(Y.onload=null,Y.onerror=null,Y.onabort=null,Y.ontimeout=null),R(T)}catch{}}function qi(){this.g=new Su}function Vs(h){this.i=h.Sb||null,this.h=h.ab||!1}b(Vs,Au),Vs.prototype.g=function(){return new Jr(this.i,this.h)};function Jr(h,v){Ct.call(this),this.H=h,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}b(Jr,Ct),n=Jr.prototype,n.open=function(h,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=v,this.readyState=1,hs(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const v={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(v.body=h),(this.H||c).fetch(new Request(this.D,v)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,$i(this)),this.readyState=0},n.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,hs(this)),this.g&&(this.readyState=3,hs(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Xa(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function Xa(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}n.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var v=h.value?h.value:new Uint8Array(0);(v=this.B.decode(v,{stream:!h.done}))&&(this.response=this.responseText+=v)}h.done?$i(this):hs(this),this.readyState==3&&Xa(this)}},n.Oa=function(h){this.g&&(this.response=this.responseText=h,$i(this))},n.Na=function(h){this.g&&(this.response=h,$i(this))},n.ga=function(){this.g&&$i(this)};function $i(h){h.readyState=4,h.l=null,h.j=null,h.B=null,hs(h)}n.setRequestHeader=function(h,v){this.A.append(h,v)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],v=this.h.entries();for(var T=v.next();!T.done;)T=T.value,h.push(T[0]+": "+T[1]),T=v.next();return h.join(`\r
`)};function hs(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Jr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Gn(h){let v="";return be(h,function(T,R){v+=R,v+=":",v+=T,v+=`\r
`}),v}function Xr(h,v,T){e:{for(R in T){var R=!1;break e}R=!0}R||(T=Gn(T),typeof h=="string"?T!=null&&ri(T):et(h,v,T))}function st(h){Ct.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}b(st,Ct);var Bs=/^https?$/i,Ml=["POST","PUT"];n=st.prototype,n.Fa=function(h){this.H=h},n.ea=function(h,v,T,R){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);v=v?v.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Sl.g(),this.g.onreadystatechange=x(m(this.Ca,this));try{this.B=!0,this.g.open(v,String(h),!0),this.B=!1}catch(X){Zr(this,X);return}if(h=T||"",T=new Map(this.headers),R)if(Object.getPrototypeOf(R)===Object.prototype)for(var Y in R)T.set(Y,R[Y]);else if(typeof R.keys=="function"&&typeof R.get=="function")for(const X of R.keys())T.set(X,R.get(X));else throw Error("Unknown input type for opt_headers: "+String(R));R=Array.from(T.keys()).find(X=>X.toLowerCase()=="content-type"),Y=c.FormData&&h instanceof c.FormData,!(Array.prototype.indexOf.call(Ml,v,void 0)>=0)||R||Y||T.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[X,fe]of T)this.g.setRequestHeader(X,fe);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(X){Zr(this,X)}};function Zr(h,v){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=v,h.o=5,Ll(h),ai(h)}function Ll(h){h.A||(h.A=!0,zt(h,"complete"),zt(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,zt(this,"complete"),zt(this,"abort"),ai(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ai(this,!0)),st.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?ea(this):this.Xa())},n.Xa=function(){ea(this)};function ea(h){if(h.h&&typeof l<"u"){if(h.v&&ds(h)==4)setTimeout(h.Ca.bind(h),0);else if(zt(h,"readystatechange"),ds(h)==4){h.h=!1;try{const X=h.ca();e:switch(X){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var T;if(!(T=v)){var R;if(R=X===0){let fe=String(h.D).match(Du)[1]||null;!fe&&c.self&&c.self.location&&(fe=c.self.location.protocol.slice(0,-1)),R=!Bs.test(fe?fe.toLowerCase():"")}T=R}if(T)zt(h,"complete"),zt(h,"success");else{h.o=6;try{var Y=ds(h)>2?h.g.statusText:""}catch{Y=""}h.l=Y+" ["+h.ca()+"]",Ll(h)}}finally{ai(h)}}}}function ai(h,v){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const T=h.g;h.g=null,v||zt(h,"ready");try{T.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function ds(h){return h.g?h.g.readyState:0}n.ca=function(){try{return ds(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(h){if(this.g){var v=this.g.responseText;return h&&v.indexOf(h)==0&&(v=v.substring(h.length)),Rf(v)}};function Jt(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function oi(h){const v={};h=(h.g&&ds(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let R=0;R<h.length;R++){if(O(h[R]))continue;var T=ku(h[R]);const Y=T[0];if(T=T[1],typeof T!="string")continue;T=T.trim();const X=v[Y]||[];v[Y]=X,X.push(T)}Ve(v,function(R){return R.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function zs(h,v,T){return T&&T.internalChannelParams&&T.internalChannelParams[h]||v}function Gi(h){this.za=0,this.i=[],this.j=new os,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=zs("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=zs("baseRetryDelayMs",5e3,h),this.Za=zs("retryDelaySeedMs",1e4,h),this.Ta=zs("forwardChannelMaxRetries",2,h),this.va=zs("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new Al(h&&h.concurrentRequestLimit),this.Ba=new qi,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Gi.prototype,n.ka=8,n.I=1,n.connect=function(h,v,T,R){Rt(0),this.W=h,this.H=v||{},T&&R!==void 0&&(this.H.OSID=T,this.H.OAID=R),this.F=this.X,this.J=Gu(this,null,this.W),Hs(this)};function Ul(h){if(Za(h),h.I==3){var v=h.V++,T=Ot(h.J);if(et(T,"SID",h.M),et(T,"RID",v),et(T,"TYPE","terminate"),ta(h,T),v=new ls(h,h.j,v),v.M=2,v.A=Wr(Ot(T)),T=!1,c.navigator&&c.navigator.sendBeacon)try{T=c.navigator.sendBeacon(v.A.toString(),"")}catch{}!T&&c.Image&&(new Image().src=v.A,T=!0),T||(v.g=Fu(v.j,null),v.g.ea(v.A)),v.F=Date.now(),js(v)}$u(h)}function Fi(h){h.g&&(Bl(h),h.g.cancel(),h.g=null)}function Za(h){Fi(h),h.v&&(c.clearTimeout(h.v),h.v=null),to(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&c.clearTimeout(h.m),h.m=null)}function Hs(h){if(!Nl(h.h)&&!h.m){h.m=!0;var v=h.Ea;F||C(),$||(F(),$=!0),A.add(v,h),h.D=0}}function eo(h,v){return Ms(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=v.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=Is(m(h.Ea,h,v),qu(h,h.D)),h.D++,!0)}n.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const Y=new ls(this,this.j,h);let X=this.o;if(this.U&&(X?(X=V(X),de(X,this.U)):X=this.U),this.u!==null||this.R||(Y.J=X,X=null),this.S)e:{for(var v=0,T=0;T<this.i.length;T++){t:{var R=this.i[T];if("__data__"in R.map&&(R=R.map.__data__,typeof R=="string")){R=R.length;break t}R=void 0}if(R===void 0)break;if(v+=R,v>4096){v=T;break e}if(v===4096||T===this.i.length-1){v=T+1;break e}}v=1e3}else v=1e3;v=Vu(this,Y,v),T=Ot(this.J),et(T,"RID",h),et(T,"CVER",22),this.G&&et(T,"X-HTTP-Session-Id",this.G),ta(this,T),X&&(this.R?v="headers="+ri(Gn(X))+"&"+v:this.u&&Xr(T,this.u,X)),Cl(this.h,Y),this.Ra&&et(T,"TYPE","init"),this.S?(et(T,"$req",v),et(T,"SID","null"),Y.U=!0,Os(Y,T,null)):Os(Y,T,v),this.I=2}}else this.I==3&&(h?Vl(this,h):this.i.length==0||Nl(this.h)||Vl(this))};function Vl(h,v){var T;v?T=v.l:T=h.V++;const R=Ot(h.J);et(R,"SID",h.M),et(R,"RID",T),et(R,"AID",h.K),ta(h,R),h.u&&h.o&&Xr(R,h.u,h.o),T=new ls(h,h.j,T,h.D+1),h.u===null&&(T.J=h.o),v&&(h.i=v.G.concat(h.i)),v=Vu(h,T,1e3),T.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),Cl(h.h,T),Os(T,R,v)}function ta(h,v){h.H&&be(h.H,function(T,R){et(v,R,T)}),h.l&&be({},function(T,R){et(v,R,T)})}function Vu(h,v,T){T=Math.min(h.i.length,T);const R=h.l?m(h.l.Ka,h.l,h):null;e:{var Y=h.i;let Pe=-1;for(;;){const Tt=["count="+T];Pe==-1?T>0?(Pe=Y[0].g,Tt.push("ofs="+Pe)):Pe=0:Tt.push("ofs="+Pe);let Je=!0;for(let ft=0;ft<T;ft++){var X=Y[ft].g;const Fn=Y[ft].map;if(X-=Pe,X<0)Pe=Math.max(0,Y[ft].g-100),Je=!1;else try{X="req"+X+"_"||"";try{var fe=Fn instanceof Map?Fn:Object.entries(Fn);for(const[$s,fs]of fe){let gs=fs;d(fs)&&(gs=Ui(fs)),Tt.push(X+$s+"="+encodeURIComponent(gs))}}catch($s){throw Tt.push(X+"type="+encodeURIComponent("_badmap")),$s}}catch{R&&R(Fn)}}if(Je){fe=Tt.join("&");break e}}fe=void 0}return h=h.i.splice(0,T),v.G=h,fe}function Bu(h){if(!h.g&&!h.v){h.Y=1;var v=h.Da;F||C(),$||(F(),$=!0),A.add(v,h),h.A=0}}function na(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=Is(m(h.Da,h),qu(h,h.A)),h.A++,!0)}n.Da=function(){if(this.v=null,zu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=Is(m(this.Wa,this),h)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Rt(10),Fi(this),zu(this))};function Bl(h){h.B!=null&&(c.clearTimeout(h.B),h.B=null)}function zu(h){h.g=new ls(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var v=Ot(h.na);et(v,"RID","rpc"),et(v,"SID",h.M),et(v,"AID",h.K),et(v,"CI",h.F?"0":"1"),!h.F&&h.ia&&et(v,"TO",h.ia),et(v,"TYPE","xmlhttp"),ta(h,v),h.u&&h.o&&Xr(v,h.u,h.o),h.O&&(h.g.H=h.O);var T=h.g;h=h.ba,T.M=1,T.A=Wr(Ot(v)),T.u=null,T.R=!0,Fa(T,h)}n.Va=function(){this.C!=null&&(this.C=null,Fi(this),na(this),Rt(19))};function to(h){h.C!=null&&(c.clearTimeout(h.C),h.C=null)}function Hu(h,v){var T=null;if(h.g==v){to(h),Bl(h),h.g=null;var R=2}else if(Ls(h.h,v))T=v.G,Rl(h.h,v),R=1;else return;if(h.I!=0){if(v.o)if(R==1){T=v.u?v.u.length:0,v=Date.now()-v.F;var Y=h.D;R=Ga(),zt(R,new Rs(R,T)),Hs(h)}else Bu(h);else if(Y=v.m,Y==3||Y==0&&v.X>0||!(R==1&&eo(h,v)||R==2&&na(h)))switch(T&&T.length>0&&(v=h.h,v.i=v.i.concat(T)),Y){case 1:qs(h,5);break;case 4:qs(h,10);break;case 3:qs(h,6);break;default:qs(h,2)}}}function qu(h,v){let T=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(T*=2),T*v}function qs(h,v){if(h.j.info("Error code "+v),v==2){var T=m(h.bb,h),R=h.Ua;const Y=!R;R=new kn(R||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||Ft(R,"https"),Wr(R),Y?us(R.toString(),T):Pl(R.toString(),T)}else Rt(2);h.I=0,h.l&&h.l.pa(v),$u(h),Za(h)}n.bb=function(h){h?(this.j.info("Successfully pinged google.com"),Rt(2)):(this.j.info("Failed to ping google.com"),Rt(1))};function $u(h){if(h.I=0,h.ja=[],h.l){const v=Il(h.h);(v.length!=0||h.i.length!=0)&&(N(h.ja,v),N(h.ja,h.i),h.h.i.length=0,S(h.i),h.i.length=0),h.l.oa()}}function Gu(h,v,T){var R=T instanceof kn?Ot(T):new kn(T);if(R.g!="")v&&(R.g=v+"."+R.g),Vi(R,R.u);else{var Y=c.location;R=Y.protocol,v=v?v+"."+Y.hostname:Y.hostname,Y=+Y.port;const X=new kn(null);R&&Ft(X,R),v&&(X.g=v),Y&&Vi(X,Y),T&&(X.h=T),R=X}return T=h.G,v=h.wa,T&&v&&et(R,T,v),et(R,"VER",h.ka),ta(h,R),R}function Fu(h,v,T){if(v&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return v=h.Aa&&!h.ma?new st(new Vs({ab:T})):new st(h.ma),v.Fa(h.L),v}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ku(){}n=Ku.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Ki(){}Ki.prototype.g=function(h,v){return new pn(h,v)};function pn(h,v){Ct.call(this),this.g=new Gi(v),this.l=h,this.h=v&&v.messageUrlParams||null,h=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(h?h["X-WebChannel-Content-Type"]=v.messageContentType:h={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.sa&&(h?h["X-WebChannel-Client-Profile"]=v.sa:h={"X-WebChannel-Client-Profile":v.sa}),this.g.U=h,(h=v&&v.Qb)&&!O(h)&&(this.g.u=h),this.A=v&&v.supportsCrossDomainXhr||!1,this.v=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!O(v)&&(this.g.G=v,h=this.h,h!==null&&v in h&&(h=this.h,v in h&&delete h[v])),this.j=new li(this)}b(pn,Ct),pn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},pn.prototype.close=function(){Ul(this.g)},pn.prototype.o=function(h){var v=this.g;if(typeof h=="string"){var T={};T.__data__=h,h=T}else this.v&&(T={},T.__data__=Ui(h),h=T);v.i.push(new kt(v.Ya++,h)),v.I==3&&Hs(v)},pn.prototype.N=function(){this.g.l=null,delete this.j,Ul(this.g),delete this.g,pn.Z.N.call(this)};function Yu(h){Qt.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var v=h.__sm__;if(v){e:{for(const T in v){h=T;break e}h=void 0}(this.i=h)&&(h=this.i,v=v!==null&&h in v?v[h]:void 0),this.data=v}else this.data=h}b(Yu,Qt);function Wu(){Hn.call(this),this.status=1}b(Wu,Hn);function li(h){this.g=h}b(li,Ku),li.prototype.ra=function(){zt(this.g,"a")},li.prototype.qa=function(h){zt(this.g,new Yu(h))},li.prototype.pa=function(h){zt(this.g,new Wu)},li.prototype.oa=function(){zt(this.g,"b")},Ki.prototype.createWebChannel=Ki.prototype.g,pn.prototype.send=pn.prototype.o,pn.prototype.open=pn.prototype.m,pn.prototype.close=pn.prototype.close,zE=function(){return new Ki},BE=function(){return Ga()},VE=xt,vm={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Kr.NO_ERROR=0,Kr.TIMEOUT=8,Kr.HTTP_ERROR=6,vd=Kr,El.COMPLETE="complete",UE=El,Nu.EventType=as,as.OPEN="a",as.CLOSE="b",as.ERROR="c",as.MESSAGE="d",Ct.prototype.listen=Ct.prototype.J,Ic=Nu,st.prototype.listenOnce=st.prototype.K,st.prototype.getLastError=st.prototype.Ha,st.prototype.getLastErrorCode=st.prototype.ya,st.prototype.getStatus=st.prototype.ca,st.prototype.getResponseJson=st.prototype.La,st.prototype.getResponseText=st.prototype.la,st.prototype.send=st.prototype.ea,st.prototype.setWithCredentials=st.prototype.Fa,LE=st}).apply(typeof ed<"u"?ed:typeof self<"u"?self:typeof window<"u"?window:{});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}un.UNAUTHENTICATED=new un(null),un.GOOGLE_CREDENTIALS=new un("google-credentials-uid"),un.FIRST_PARTY=new un("first-party-uid"),un.MOCK_USER=new un("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dl="12.8.0";function zO(n){dl=n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const La=new ef("@firebase/firestore");function zo(){return La.logLevel}function ve(n,...e){if(La.logLevel<=$e.DEBUG){const t=e.map(p0);La.debug(`Firestore (${dl}): ${n}`,...t)}}function Oi(n,...e){if(La.logLevel<=$e.ERROR){const t=e.map(p0);La.error(`Firestore (${dl}): ${n}`,...t)}}function il(n,...e){if(La.logLevel<=$e.WARN){const t=e.map(p0);La.warn(`Firestore (${dl}): ${n}`,...t)}}function p0(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ie(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,HE(n,i,t)}function HE(n,e,t){let i=`FIRESTORE (${dl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw Oi(i),new Error(i)}function Ze(n,e,t,i){let a="Unexpected state";typeof t=="string"?a=t:i=t,n||HE(e,a,i)}function De(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ae={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class me extends rs{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qE{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class HO{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(un.UNAUTHENTICATED)))}shutdown(){}}class qO{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class $O{constructor(e){this.t=e,this.currentUser=un.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ze(this.o===void 0,42304);let i=this.i;const a=p=>this.i!==i?(i=this.i,t(p)):Promise.resolve();let l=new Ri;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new Ri,e.enqueueRetryable((()=>a(this.currentUser)))};const c=()=>{const p=l;e.enqueueRetryable((async()=>{await p.promise,await a(this.currentUser)}))},d=p=>{ve("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=p,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((p=>d(p))),setTimeout((()=>{if(!this.auth){const p=this.t.getImmediate({optional:!0});p?d(p):(ve("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new Ri)}}),0),c()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(ve("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Ze(typeof i.accessToken=="string",31837,{l:i}),new qE(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ze(e===null||typeof e=="string",2055,{h:e}),new un(e)}}class GO{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=un.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class FO{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new GO(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(un.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Rw{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class KO{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,An(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ze(this.o===void 0,3512);const i=l=>{l.error!=null&&ve("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const c=l.token!==this.m;return this.m=l.token,ve("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>i(l)))};const a=l=>{ve("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):ve("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Rw(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Ze(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Rw(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YO(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const a=YO(40);for(let l=0;l<a.length;++l)i.length<20&&a[l]<t&&(i+=e.charAt(a[l]%62))}return i}}function Ge(n,e){return n<e?-1:n>e?1:0}function _m(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const a=n.charAt(i),l=e.charAt(i);if(a!==l)return qp(a)===qp(l)?Ge(a,l):qp(a)?1:-1}return Ge(n.length,e.length)}const WO=55296,QO=57343;function qp(n){const e=n.charCodeAt(0);return e>=WO&&e<=QO}function rl(n,e,t){return n.length===e.length&&n.every(((i,a)=>t(i,e[a])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iw="__name__";class Qs{constructor(e,t,i){t===void 0?t=0:t>e.length&&Ie(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Ie(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Qs.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Qs?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let a=0;a<i;a++){const l=Qs.compareSegments(e.get(a),t.get(a));if(l!==0)return l}return Ge(e.length,t.length)}static compareSegments(e,t){const i=Qs.isNumericId(e),a=Qs.isNumericId(t);return i&&!a?-1:!i&&a?1:i&&a?Qs.extractNumericId(e).compare(Qs.extractNumericId(t)):_m(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Nr.fromString(e.substring(4,e.length-2))}}class ct extends Qs{construct(e,t,i){return new ct(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new me(ae.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((a=>a.length>0)))}return new ct(t)}static emptyPath(){return new ct([])}}const JO=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class an extends Qs{construct(e,t,i){return new an(e,t,i)}static isValidIdentifier(e){return JO.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),an.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Iw}static keyField(){return new an([Iw])}static fromServerFormat(e){const t=[];let i="",a=0;const l=()=>{if(i.length===0)throw new me(ae.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let c=!1;for(;a<e.length;){const d=e[a];if(d==="\\"){if(a+1===e.length)throw new me(ae.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const p=e[a+1];if(p!=="\\"&&p!=="."&&p!=="`")throw new me(ae.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=p,a+=2}else d==="`"?(c=!c,a++):d!=="."||c?(i+=d,a++):(l(),a++)}if(l(),c)throw new me(ae.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new an(t)}static emptyPath(){return new an([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ee{constructor(e){this.path=e}static fromPath(e){return new Ee(ct.fromString(e))}static fromName(e){return new Ee(ct.fromString(e).popFirst(5))}static empty(){return new Ee(ct.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ct.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ct.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ee(new ct(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $E(n,e,t){if(!t)throw new me(ae.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function XO(n,e,t,i){if(e===!0&&i===!0)throw new me(ae.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function kw(n){if(!Ee.isDocumentKey(n))throw new me(ae.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Ow(n){if(Ee.isDocumentKey(n))throw new me(ae.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function GE(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function lf(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ie(12329,{type:typeof n})}function ji(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new me(ae.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=lf(n);throw new me(ae.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bt(n,e){const t={typeString:n};return e&&(t.value=e),t}function gu(n,e){if(!GE(n))throw new me(ae.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const a=e[i].typeString,l="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const c=n[i];if(a&&typeof c!==a){t=`JSON field '${i}' must be a ${a}.`;break}if(l!==void 0&&c!==l.value){t=`Expected '${i}' field to equal '${l.value}'`;break}}if(t)throw new me(ae.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jw=-62135596800,Dw=1e6;class dt{static now(){return dt.fromMillis(Date.now())}static fromDate(e){return dt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*Dw);return new dt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new me(ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new me(ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<jw)throw new me(ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new me(ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Dw}_compareTo(e){return this.seconds===e.seconds?Ge(this.nanoseconds,e.nanoseconds):Ge(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:dt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(gu(e,dt._jsonSchema))return new dt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-jw;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}dt._jsonSchemaVersion="firestore/timestamp/1.0",dt._jsonSchema={type:Bt("string",dt._jsonSchemaVersion),seconds:Bt("number"),nanoseconds:Bt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oe{static fromTimestamp(e){return new Oe(e)}static min(){return new Oe(new dt(0,0))}static max(){return new Oe(new dt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qc=-1;function ZO(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,a=Oe.fromTimestamp(i===1e9?new dt(t+1,0):new dt(t,i));return new kr(a,Ee.empty(),e)}function ej(n){return new kr(n.readTime,n.key,Qc)}class kr{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new kr(Oe.min(),Ee.empty(),Qc)}static max(){return new kr(Oe.max(),Ee.empty(),Qc)}}function tj(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ee.comparator(n.documentKey,e.documentKey),t!==0?t:Ge(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nj="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class sj{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fl(n){if(n.code!==ae.FAILED_PRECONDITION||n.message!==nj)throw n;ve("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ie(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new oe(((i,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(i,a)},this.catchCallback=l=>{this.wrapFailure(t,l).next(i,a)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof oe?t:oe.resolve(t)}catch(t){return oe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):oe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):oe.reject(t)}static resolve(e){return new oe(((t,i)=>{t(e)}))}static reject(e){return new oe(((t,i)=>{i(e)}))}static waitFor(e){return new oe(((t,i)=>{let a=0,l=0,c=!1;e.forEach((d=>{++a,d.next((()=>{++l,c&&l===a&&t()}),(p=>i(p)))})),c=!0,l===a&&t()}))}static or(e){let t=oe.resolve(!1);for(const i of e)t=t.next((a=>a?oe.resolve(a):i()));return t}static forEach(e,t){const i=[];return e.forEach(((a,l)=>{i.push(t.call(this,a,l))})),this.waitFor(i)}static mapArray(e,t){return new oe(((i,a)=>{const l=e.length,c=new Array(l);let d=0;for(let p=0;p<l;p++){const m=p;t(e[m]).next((_=>{c[m]=_,++d,d===l&&i(c)}),(_=>a(_)))}}))}static doWhile(e,t){return new oe(((i,a)=>{const l=()=>{e()===!0?t().next((()=>{l()}),a):i()};l()}))}}function ij(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function gl(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cf{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}cf.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y0=-1;function uf(n){return n==null}function Dd(n){return n===0&&1/n==-1/0}function rj(n){return typeof n=="number"&&Number.isInteger(n)&&!Dd(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FE="";function aj(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Pw(e)),e=oj(n.get(t),e);return Pw(e)}function oj(n,e){let t=e;const i=n.length;for(let a=0;a<i;a++){const l=n.charAt(a);switch(l){case"\0":t+="";break;case FE:t+="";break;default:t+=l}}return t}function Pw(n){return n+FE+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mw(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Br(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function KE(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yt{constructor(e,t){this.comparator=e,this.root=t||rn.EMPTY}insert(e,t){return new yt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,rn.BLACK,null,null))}remove(e){return new yt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,rn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const a=this.comparator(e,i.key);if(a===0)return t+i.left.size;a<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new td(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new td(this.root,e,this.comparator,!1)}getReverseIterator(){return new td(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new td(this.root,e,this.comparator,!0)}}class td{constructor(e,t,i,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?i(e.key,t):1,t&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class rn{constructor(e,t,i,a,l){this.key=e,this.value=t,this.color=i??rn.RED,this.left=a??rn.EMPTY,this.right=l??rn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,a,l){return new rn(e??this.key,t??this.value,i??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let a=this;const l=i(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,t,i),null):l===0?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,i)),a.fixUp()}removeMin(){if(this.left.isEmpty())return rn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),t(e,a.key)===0){if(a.right.isEmpty())return rn.EMPTY;i=a.right.min(),a=a.copy(i.key,i.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,rn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,rn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ie(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ie(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ie(27949);return e+(this.isRed()?0:1)}}rn.EMPTY=null,rn.RED=!0,rn.BLACK=!1;rn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ie(57766)}get value(){throw Ie(16141)}get color(){throw Ie(16727)}get left(){throw Ie(29726)}get right(){throw Ie(36894)}copy(e,t,i,a,l){return this}insert(e,t,i){return new rn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $t{constructor(e){this.comparator=e,this.data=new yt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const a=i.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Lw(this.data.getIterator())}getIteratorFrom(e){return new Lw(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof $t)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=i.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new $t(this.comparator);return t.data=e,t}}class Lw{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bn{constructor(e){this.fields=e,e.sort(an.comparator)}static empty(){return new Bn([])}unionWith(e){let t=new $t(an.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Bn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return rl(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YE extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new YE("Invalid base64 string: "+l):l}})(e);return new on(t)}static fromUint8Array(e){const t=(function(a){let l="";for(let c=0;c<a.length;++c)l+=String.fromCharCode(a[c]);return l})(e);return new on(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let a=0;a<t.length;a++)i[a]=t.charCodeAt(a);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ge(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}on.EMPTY_BYTE_STRING=new on("");const lj=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Or(n){if(Ze(!!n,39018),typeof n=="string"){let e=0;const t=lj.exec(n);if(Ze(!!t,46558,{timestamp:n}),t[1]){let a=t[1];a=(a+"000000000").substr(0,9),e=Number(a)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:At(n.seconds),nanos:At(n.nanos)}}function At(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function jr(n){return typeof n=="string"?on.fromBase64String(n):on.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WE="server_timestamp",QE="__type__",JE="__previous_value__",XE="__local_write_time__";function v0(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[QE])==null?void 0:i.stringValue)===WE}function hf(n){const e=n.mapValue.fields[JE];return v0(e)?hf(e):e}function Jc(n){const e=Or(n.mapValue.fields[XE].timestampValue);return new dt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cj{constructor(e,t,i,a,l,c,d,p,m,_,b){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=a,this.ssl=l,this.forceLongPolling=c,this.autoDetectLongPolling=d,this.longPollingOptions=p,this.useFetchStreams=m,this.isUsingEmulator=_,this.apiKey=b}}const Pd="(default)";class Xc{constructor(e,t){this.projectId=e,this.database=t||Pd}static empty(){return new Xc("","")}get isDefaultDatabase(){return this.database===Pd}isEqual(e){return e instanceof Xc&&e.projectId===this.projectId&&e.database===this.database}}function uj(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new me(ae.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Xc(n.options.projectId,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZE="__type__",hj="__max__",nd={mapValue:{}},e1="__vector__",Md="value";function Dr(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?v0(n)?4:fj(n)?9007199254740991:dj(n)?10:11:Ie(28295,{value:n})}function si(n,e){if(n===e)return!0;const t=Dr(n);if(t!==Dr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Jc(n).isEqual(Jc(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const c=Or(a.timestampValue),d=Or(l.timestampValue);return c.seconds===d.seconds&&c.nanos===d.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(a,l){return jr(a.bytesValue).isEqual(jr(l.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(a,l){return At(a.geoPointValue.latitude)===At(l.geoPointValue.latitude)&&At(a.geoPointValue.longitude)===At(l.geoPointValue.longitude)})(n,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return At(a.integerValue)===At(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const c=At(a.doubleValue),d=At(l.doubleValue);return c===d?Dd(c)===Dd(d):isNaN(c)&&isNaN(d)}return!1})(n,e);case 9:return rl(n.arrayValue.values||[],e.arrayValue.values||[],si);case 10:case 11:return(function(a,l){const c=a.mapValue.fields||{},d=l.mapValue.fields||{};if(Mw(c)!==Mw(d))return!1;for(const p in c)if(c.hasOwnProperty(p)&&(d[p]===void 0||!si(c[p],d[p])))return!1;return!0})(n,e);default:return Ie(52216,{left:n})}}function Zc(n,e){return(n.values||[]).find((t=>si(t,e)))!==void 0}function al(n,e){if(n===e)return 0;const t=Dr(n),i=Dr(e);if(t!==i)return Ge(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ge(n.booleanValue,e.booleanValue);case 2:return(function(l,c){const d=At(l.integerValue||l.doubleValue),p=At(c.integerValue||c.doubleValue);return d<p?-1:d>p?1:d===p?0:isNaN(d)?isNaN(p)?0:-1:1})(n,e);case 3:return Uw(n.timestampValue,e.timestampValue);case 4:return Uw(Jc(n),Jc(e));case 5:return _m(n.stringValue,e.stringValue);case 6:return(function(l,c){const d=jr(l),p=jr(c);return d.compareTo(p)})(n.bytesValue,e.bytesValue);case 7:return(function(l,c){const d=l.split("/"),p=c.split("/");for(let m=0;m<d.length&&m<p.length;m++){const _=Ge(d[m],p[m]);if(_!==0)return _}return Ge(d.length,p.length)})(n.referenceValue,e.referenceValue);case 8:return(function(l,c){const d=Ge(At(l.latitude),At(c.latitude));return d!==0?d:Ge(At(l.longitude),At(c.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Vw(n.arrayValue,e.arrayValue);case 10:return(function(l,c){var x,S,N,j;const d=l.fields||{},p=c.fields||{},m=(x=d[Md])==null?void 0:x.arrayValue,_=(S=p[Md])==null?void 0:S.arrayValue,b=Ge(((N=m==null?void 0:m.values)==null?void 0:N.length)||0,((j=_==null?void 0:_.values)==null?void 0:j.length)||0);return b!==0?b:Vw(m,_)})(n.mapValue,e.mapValue);case 11:return(function(l,c){if(l===nd.mapValue&&c===nd.mapValue)return 0;if(l===nd.mapValue)return 1;if(c===nd.mapValue)return-1;const d=l.fields||{},p=Object.keys(d),m=c.fields||{},_=Object.keys(m);p.sort(),_.sort();for(let b=0;b<p.length&&b<_.length;++b){const x=_m(p[b],_[b]);if(x!==0)return x;const S=al(d[p[b]],m[_[b]]);if(S!==0)return S}return Ge(p.length,_.length)})(n.mapValue,e.mapValue);default:throw Ie(23264,{he:t})}}function Uw(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Ge(n,e);const t=Or(n),i=Or(e),a=Ge(t.seconds,i.seconds);return a!==0?a:Ge(t.nanos,i.nanos)}function Vw(n,e){const t=n.values||[],i=e.values||[];for(let a=0;a<t.length&&a<i.length;++a){const l=al(t[a],i[a]);if(l)return l}return Ge(t.length,i.length)}function ol(n){return bm(n)}function bm(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=Or(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return jr(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Ee.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",a=!0;for(const l of t.values||[])a?a=!1:i+=",",i+=bm(l);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let a="{",l=!0;for(const c of i)l?l=!1:a+=",",a+=`${c}:${bm(t.fields[c])}`;return a+"}"})(n.mapValue):Ie(61005,{value:n})}function _d(n){switch(Dr(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=hf(n);return e?16+_d(e):16;case 5:return 2*n.stringValue.length;case 6:return jr(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((a,l)=>a+_d(l)),0)})(n.arrayValue);case 10:case 11:return(function(i){let a=0;return Br(i.fields,((l,c)=>{a+=l.length+_d(c)})),a})(n.mapValue);default:throw Ie(13486,{value:n})}}function Bw(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function wm(n){return!!n&&"integerValue"in n}function _0(n){return!!n&&"arrayValue"in n}function zw(n){return!!n&&"nullValue"in n}function Hw(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function bd(n){return!!n&&"mapValue"in n}function dj(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[ZE])==null?void 0:i.stringValue)===e1}function Vc(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Br(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=Vc(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Vc(n.arrayValue.values[t]);return e}return{...n}}function fj(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===hj}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(e){this.value=e}static empty(){return new Nn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!bd(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Vc(t)}setAll(e){let t=an.emptyPath(),i={},a=[];e.forEach(((c,d)=>{if(!t.isImmediateParentOf(d)){const p=this.getFieldsMap(t);this.applyChanges(p,i,a),i={},a=[],t=d.popLast()}c?i[d.lastSegment()]=Vc(c):a.push(d.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,i,a)}delete(e){const t=this.field(e.popLast());bd(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return si(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let a=t.mapValue.fields[e.get(i)];bd(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,i){Br(t,((a,l)=>e[a]=l));for(const a of i)delete e[a]}clone(){return new Nn(Vc(this.value))}}function t1(n){const e=[];return Br(n.fields,((t,i)=>{const a=new an([t]);if(bd(i)){const l=t1(i.mapValue).fields;if(l.length===0)e.push(a);else for(const c of l)e.push(a.child(c))}else e.push(a)})),new Bn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hn{constructor(e,t,i,a,l,c,d){this.key=e,this.documentType=t,this.version=i,this.readTime=a,this.createTime=l,this.data=c,this.documentState=d}static newInvalidDocument(e){return new hn(e,0,Oe.min(),Oe.min(),Oe.min(),Nn.empty(),0)}static newFoundDocument(e,t,i,a){return new hn(e,1,t,Oe.min(),i,a,0)}static newNoDocument(e,t){return new hn(e,2,t,Oe.min(),Oe.min(),Nn.empty(),0)}static newUnknownDocument(e,t){return new hn(e,3,t,Oe.min(),Oe.min(),Nn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Oe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Nn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Nn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Oe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof hn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new hn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ld{constructor(e,t){this.position=e,this.inclusive=t}}function qw(n,e,t){let i=0;for(let a=0;a<n.position.length;a++){const l=e[a],c=n.position[a];if(l.field.isKeyField()?i=Ee.comparator(Ee.fromName(c.referenceValue),t.key):i=al(c,t.data.field(l.field)),l.dir==="desc"&&(i*=-1),i!==0)break}return i}function $w(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!si(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ud{constructor(e,t="asc"){this.field=e,this.dir=t}}function gj(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n1{}class Vt extends n1{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new mj(e,t,i):t==="array-contains"?new _j(e,i):t==="in"?new bj(e,i):t==="not-in"?new wj(e,i):t==="array-contains-any"?new xj(e,i):new Vt(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new yj(e,i):new vj(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(al(t,this.value)):t!==null&&Dr(this.value)===Dr(t)&&this.matchesComparison(al(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ie(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ss extends n1{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Ss(e,t)}matches(e){return s1(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function s1(n){return n.op==="and"}function i1(n){return pj(n)&&s1(n)}function pj(n){for(const e of n.filters)if(e instanceof Ss)return!1;return!0}function xm(n){if(n instanceof Vt)return n.field.canonicalString()+n.op.toString()+ol(n.value);if(i1(n))return n.filters.map((e=>xm(e))).join(",");{const e=n.filters.map((t=>xm(t))).join(",");return`${n.op}(${e})`}}function r1(n,e){return n instanceof Vt?(function(i,a){return a instanceof Vt&&i.op===a.op&&i.field.isEqual(a.field)&&si(i.value,a.value)})(n,e):n instanceof Ss?(function(i,a){return a instanceof Ss&&i.op===a.op&&i.filters.length===a.filters.length?i.filters.reduce(((l,c,d)=>l&&r1(c,a.filters[d])),!0):!1})(n,e):void Ie(19439)}function a1(n){return n instanceof Vt?(function(t){return`${t.field.canonicalString()} ${t.op} ${ol(t.value)}`})(n):n instanceof Ss?(function(t){return t.op.toString()+" {"+t.getFilters().map(a1).join(" ,")+"}"})(n):"Filter"}class mj extends Vt{constructor(e,t,i){super(e,t,i),this.key=Ee.fromName(i.referenceValue)}matches(e){const t=Ee.comparator(e.key,this.key);return this.matchesComparison(t)}}class yj extends Vt{constructor(e,t){super(e,"in",t),this.keys=o1("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class vj extends Vt{constructor(e,t){super(e,"not-in",t),this.keys=o1("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function o1(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((i=>Ee.fromName(i.referenceValue)))}class _j extends Vt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return _0(t)&&Zc(t.arrayValue,this.value)}}class bj extends Vt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Zc(this.value.arrayValue,t)}}class wj extends Vt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Zc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Zc(this.value.arrayValue,t)}}class xj extends Vt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!_0(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Zc(this.value.arrayValue,i)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tj{constructor(e,t=null,i=[],a=[],l=null,c=null,d=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=a,this.limit=l,this.startAt=c,this.endAt=d,this.Te=null}}function Gw(n,e=null,t=[],i=[],a=null,l=null,c=null){return new Tj(n,e,t,i,a,l,c)}function b0(n){const e=De(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>xm(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(l){return l.field.canonicalString()+l.dir})(i))).join(","),uf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>ol(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>ol(i))).join(",")),e.Te=t}return e.Te}function w0(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!gj(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!r1(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!$w(n.startAt,e.startAt)&&$w(n.endAt,e.endAt)}function Tm(n){return Ee.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{constructor(e,t=null,i=[],a=[],l=null,c="F",d=null,p=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=a,this.limit=l,this.limitType=c,this.startAt=d,this.endAt=p,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function Ej(n,e,t,i,a,l,c,d){return new pu(n,e,t,i,a,l,c,d)}function x0(n){return new pu(n)}function Fw(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Sj(n){return Ee.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function l1(n){return n.collectionGroup!==null}function Bc(n){const e=De(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),t.add(l.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let d=new $t(an.comparator);return c.filters.forEach((p=>{p.getFlattenedFilters().forEach((m=>{m.isInequality()&&(d=d.add(m.field))}))})),d})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new Ud(l,i))})),t.has(an.keyField().canonicalString())||e.Ie.push(new Ud(an.keyField(),i))}return e.Ie}function Zs(n){const e=De(n);return e.Ee||(e.Ee=Aj(e,Bc(n))),e.Ee}function Aj(n,e){if(n.limitType==="F")return Gw(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new Ud(a.field,l)}));const t=n.endAt?new Ld(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Ld(n.startAt.position,n.startAt.inclusive):null;return Gw(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function Em(n,e){const t=n.filters.concat([e]);return new pu(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Sm(n,e,t){return new pu(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function df(n,e){return w0(Zs(n),Zs(e))&&n.limitType===e.limitType}function c1(n){return`${b0(Zs(n))}|lt:${n.limitType}`}function Ho(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((a=>a1(a))).join(", ")}]`),uf(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((a=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(a))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((a=>ol(a))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((a=>ol(a))).join(",")),`Target(${i})`})(Zs(n))}; limitType=${n.limitType})`}function ff(n,e){return e.isFoundDocument()&&(function(i,a){const l=a.key.path;return i.collectionGroup!==null?a.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(l):Ee.isDocumentKey(i.path)?i.path.isEqual(l):i.path.isImmediateParentOf(l)})(n,e)&&(function(i,a){for(const l of Bc(i))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(n,e)&&(function(i,a){for(const l of i.filters)if(!l.matches(a))return!1;return!0})(n,e)&&(function(i,a){return!(i.startAt&&!(function(c,d,p){const m=qw(c,d,p);return c.inclusive?m<=0:m<0})(i.startAt,Bc(i),a)||i.endAt&&!(function(c,d,p){const m=qw(c,d,p);return c.inclusive?m>=0:m>0})(i.endAt,Bc(i),a))})(n,e)}function Nj(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function u1(n){return(e,t)=>{let i=!1;for(const a of Bc(n)){const l=Cj(a,e,t);if(l!==0)return l;i=i||a.field.isKeyField()}return 0}}function Cj(n,e,t){const i=n.field.isKeyField()?Ee.comparator(e.key,t.key):(function(l,c,d){const p=c.data.field(l),m=d.data.field(l);return p!==null&&m!==null?al(p,m):Ie(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Ie(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qa{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[a,l]of i)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),a=this.inner[i];if(a===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return i.length===1?delete this.inner[t]:i.splice(a,1),this.innerSize--,!0;return!1}forEach(e){Br(this.inner,((t,i)=>{for(const[a,l]of i)e(a,l)}))}isEmpty(){return KE(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rj=new yt(Ee.comparator);function Di(){return Rj}const h1=new yt(Ee.comparator);function kc(...n){let e=h1;for(const t of n)e=e.insert(t.key,t);return e}function d1(n){let e=h1;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Ca(){return zc()}function f1(){return zc()}function zc(){return new qa((n=>n.toString()),((n,e)=>n.isEqual(e)))}const Ij=new yt(Ee.comparator),kj=new $t(Ee.comparator);function Fe(...n){let e=kj;for(const t of n)e=e.add(t);return e}const Oj=new $t(Ge);function jj(){return Oj}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T0(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Dd(e)?"-0":e}}function g1(n){return{integerValue:""+n}}function Dj(n,e){return rj(e)?g1(e):T0(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gf{constructor(){this._=void 0}}function Pj(n,e,t){return n instanceof Vd?(function(a,l){const c={fields:{[QE]:{stringValue:WE},[XE]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&v0(l)&&(l=hf(l)),l&&(c.fields[JE]=l),{mapValue:c}})(t,e):n instanceof eu?m1(n,e):n instanceof tu?y1(n,e):(function(a,l){const c=p1(a,l),d=Kw(c)+Kw(a.Ae);return wm(c)&&wm(a.Ae)?g1(d):T0(a.serializer,d)})(n,e)}function Mj(n,e,t){return n instanceof eu?m1(n,e):n instanceof tu?y1(n,e):t}function p1(n,e){return n instanceof Bd?(function(i){return wm(i)||(function(l){return!!l&&"doubleValue"in l})(i)})(e)?e:{integerValue:0}:null}class Vd extends gf{}class eu extends gf{constructor(e){super(),this.elements=e}}function m1(n,e){const t=v1(e);for(const i of n.elements)t.some((a=>si(a,i)))||t.push(i);return{arrayValue:{values:t}}}class tu extends gf{constructor(e){super(),this.elements=e}}function y1(n,e){let t=v1(e);for(const i of n.elements)t=t.filter((a=>!si(a,i)));return{arrayValue:{values:t}}}class Bd extends gf{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Kw(n){return At(n.integerValue||n.doubleValue)}function v1(n){return _0(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function Lj(n,e){return n.field.isEqual(e.field)&&(function(i,a){return i instanceof eu&&a instanceof eu||i instanceof tu&&a instanceof tu?rl(i.elements,a.elements,si):i instanceof Bd&&a instanceof Bd?si(i.Ae,a.Ae):i instanceof Vd&&a instanceof Vd})(n.transform,e.transform)}class Uj{constructor(e,t){this.version=e,this.transformResults=t}}class ei{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ei}static exists(e){return new ei(void 0,e)}static updateTime(e){return new ei(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function wd(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class pf{}function _1(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new w1(n.key,ei.none()):new mu(n.key,n.data,ei.none());{const t=n.data,i=Nn.empty();let a=new $t(an.comparator);for(let l of e.fields)if(!a.has(l)){let c=t.field(l);c===null&&l.length>1&&(l=l.popLast(),c=t.field(l)),c===null?i.delete(l):i.set(l,c),a=a.add(l)}return new zr(n.key,i,new Bn(a.toArray()),ei.none())}}function Vj(n,e,t){n instanceof mu?(function(a,l,c){const d=a.value.clone(),p=Ww(a.fieldTransforms,l,c.transformResults);d.setAll(p),l.convertToFoundDocument(c.version,d).setHasCommittedMutations()})(n,e,t):n instanceof zr?(function(a,l,c){if(!wd(a.precondition,l))return void l.convertToUnknownDocument(c.version);const d=Ww(a.fieldTransforms,l,c.transformResults),p=l.data;p.setAll(b1(a)),p.setAll(d),l.convertToFoundDocument(c.version,p).setHasCommittedMutations()})(n,e,t):(function(a,l,c){l.convertToNoDocument(c.version).setHasCommittedMutations()})(0,e,t)}function Hc(n,e,t,i){return n instanceof mu?(function(l,c,d,p){if(!wd(l.precondition,c))return d;const m=l.value.clone(),_=Qw(l.fieldTransforms,p,c);return m.setAll(_),c.convertToFoundDocument(c.version,m).setHasLocalMutations(),null})(n,e,t,i):n instanceof zr?(function(l,c,d,p){if(!wd(l.precondition,c))return d;const m=Qw(l.fieldTransforms,p,c),_=c.data;return _.setAll(b1(l)),_.setAll(m),c.convertToFoundDocument(c.version,_).setHasLocalMutations(),d===null?null:d.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((b=>b.field)))})(n,e,t,i):(function(l,c,d){return wd(l.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):d})(n,e,t)}function Bj(n,e){let t=null;for(const i of n.fieldTransforms){const a=e.data.field(i.field),l=p1(i.transform,a||null);l!=null&&(t===null&&(t=Nn.empty()),t.set(i.field,l))}return t||null}function Yw(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,a){return i===void 0&&a===void 0||!(!i||!a)&&rl(i,a,((l,c)=>Lj(l,c)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class mu extends pf{constructor(e,t,i,a=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class zr extends pf{constructor(e,t,i,a,l=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function b1(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function Ww(n,e,t){const i=new Map;Ze(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let a=0;a<t.length;a++){const l=n[a],c=l.transform,d=e.data.field(l.field);i.set(l.field,Mj(c,d,t[a]))}return i}function Qw(n,e,t){const i=new Map;for(const a of n){const l=a.transform,c=t.data.field(a.field);i.set(a.field,Pj(l,c,e))}return i}class w1 extends pf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class zj extends pf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hj{constructor(e,t,i,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=a}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&Vj(l,e,i[a])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=Hc(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=Hc(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=f1();return this.mutations.forEach((a=>{const l=e.get(a.key),c=l.overlayedDocument;let d=this.applyToLocalView(c,l.mutatedFields);d=t.has(a.key)?null:d;const p=_1(c,d);p!==null&&i.set(a.key,p),c.isValidDocument()||c.convertToNoDocument(Oe.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Fe())}isEqual(e){return this.batchId===e.batchId&&rl(this.mutations,e.mutations,((t,i)=>Yw(t,i)))&&rl(this.baseMutations,e.baseMutations,((t,i)=>Yw(t,i)))}}class E0{constructor(e,t,i,a){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=a}static from(e,t,i){Ze(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let a=(function(){return Ij})();const l=e.mutations;for(let c=0;c<l.length;c++)a=a.insert(l[c].key,i[c].version);return new E0(e,t,i,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qj{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $j{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Lt,Ye;function Gj(n){switch(n){case ae.OK:return Ie(64938);case ae.CANCELLED:case ae.UNKNOWN:case ae.DEADLINE_EXCEEDED:case ae.RESOURCE_EXHAUSTED:case ae.INTERNAL:case ae.UNAVAILABLE:case ae.UNAUTHENTICATED:return!1;case ae.INVALID_ARGUMENT:case ae.NOT_FOUND:case ae.ALREADY_EXISTS:case ae.PERMISSION_DENIED:case ae.FAILED_PRECONDITION:case ae.ABORTED:case ae.OUT_OF_RANGE:case ae.UNIMPLEMENTED:case ae.DATA_LOSS:return!0;default:return Ie(15467,{code:n})}}function x1(n){if(n===void 0)return Oi("GRPC error has no .code"),ae.UNKNOWN;switch(n){case Lt.OK:return ae.OK;case Lt.CANCELLED:return ae.CANCELLED;case Lt.UNKNOWN:return ae.UNKNOWN;case Lt.DEADLINE_EXCEEDED:return ae.DEADLINE_EXCEEDED;case Lt.RESOURCE_EXHAUSTED:return ae.RESOURCE_EXHAUSTED;case Lt.INTERNAL:return ae.INTERNAL;case Lt.UNAVAILABLE:return ae.UNAVAILABLE;case Lt.UNAUTHENTICATED:return ae.UNAUTHENTICATED;case Lt.INVALID_ARGUMENT:return ae.INVALID_ARGUMENT;case Lt.NOT_FOUND:return ae.NOT_FOUND;case Lt.ALREADY_EXISTS:return ae.ALREADY_EXISTS;case Lt.PERMISSION_DENIED:return ae.PERMISSION_DENIED;case Lt.FAILED_PRECONDITION:return ae.FAILED_PRECONDITION;case Lt.ABORTED:return ae.ABORTED;case Lt.OUT_OF_RANGE:return ae.OUT_OF_RANGE;case Lt.UNIMPLEMENTED:return ae.UNIMPLEMENTED;case Lt.DATA_LOSS:return ae.DATA_LOSS;default:return Ie(39323,{code:n})}}(Ye=Lt||(Lt={}))[Ye.OK=0]="OK",Ye[Ye.CANCELLED=1]="CANCELLED",Ye[Ye.UNKNOWN=2]="UNKNOWN",Ye[Ye.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ye[Ye.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ye[Ye.NOT_FOUND=5]="NOT_FOUND",Ye[Ye.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ye[Ye.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ye[Ye.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ye[Ye.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ye[Ye.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ye[Ye.ABORTED=10]="ABORTED",Ye[Ye.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ye[Ye.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ye[Ye.INTERNAL=13]="INTERNAL",Ye[Ye.UNAVAILABLE=14]="UNAVAILABLE",Ye[Ye.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fj(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kj=new Nr([4294967295,4294967295],0);function Jw(n){const e=Fj().encode(n),t=new ME;return t.update(e),new Uint8Array(t.digest())}function Xw(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new Nr([t,i],0),new Nr([a,l],0)]}class S0{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new Oc(`Invalid padding: ${t}`);if(i<0)throw new Oc(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Oc(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new Oc(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Nr.fromNumber(this.ge)}ye(e,t,i){let a=e.add(t.multiply(Nr.fromNumber(i)));return a.compare(Kj)===1&&(a=new Nr([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Jw(e),[i,a]=Xw(t);for(let l=0;l<this.hashCount;l++){const c=this.ye(i,a,l);if(!this.we(c))return!1}return!0}static create(e,t,i){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),c=new S0(l,a,t);return i.forEach((d=>c.insert(d))),c}insert(e){if(this.ge===0)return;const t=Jw(e),[i,a]=Xw(t);for(let l=0;l<this.hashCount;l++){const c=this.ye(i,a,l);this.be(c)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class Oc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mf{constructor(e,t,i,a,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const a=new Map;return a.set(e,yu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new mf(Oe.min(),a,new yt(Ge),Di(),Fe())}}class yu{constructor(e,t,i,a,l){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new yu(i,t,Fe(),Fe(),Fe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xd{constructor(e,t,i,a){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=a}}class T1{constructor(e,t){this.targetId=e,this.Ce=t}}class E1{constructor(e,t,i=on.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=a}}class Zw{constructor(){this.ve=0,this.Fe=ex(),this.Me=on.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Fe(),t=Fe(),i=Fe();return this.Fe.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:i=i.add(a);break;default:Ie(38017,{changeType:l})}})),new yu(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=ex()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Ze(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class Yj{constructor(e){this.Ge=e,this.ze=new Map,this.je=Di(),this.He=sd(),this.Je=sd(),this.Ze=new yt(Ge)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:Ie(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,a)=>{this.rt(a)&&t(a)}))}st(e){const t=e.targetId,i=e.Ce.count,a=this.ot(t);if(a){const l=a.target;if(Tm(l))if(i===0){const c=new Ee(l.path);this.et(t,c,hn.newNoDocument(c,Oe.min()))}else Ze(i===1,20013,{expectedCount:i});else{const c=this._t(t);if(c!==i){const d=this.ut(e),p=d?this.ct(d,e,c):1;if(p!==0){this.it(t);const m=p===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,m)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:a=0},hashCount:l=0}=t;let c,d;try{c=jr(i).toUint8Array()}catch(p){if(p instanceof YE)return il("Decoding the base64 bloom filter in existence filter failed ("+p.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw p}try{d=new S0(c,a,l)}catch(p){return il(p instanceof Oc?"BloomFilter error: ":"Applying bloom filter failed: ",p),null}return d.ge===0?null:d}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let a=0;return i.forEach((l=>{const c=this.Ge.ht(),d=`projects/${c.projectId}/databases/${c.database}/documents/${l.path.canonicalString()}`;e.mightContain(d)||(this.et(t,l,null),a++)})),a}Tt(e){const t=new Map;this.ze.forEach(((l,c)=>{const d=this.ot(c);if(d){if(l.current&&Tm(d.target)){const p=new Ee(d.target.path);this.It(p).has(c)||this.Et(c,p)||this.et(c,p,hn.newNoDocument(p,e))}l.Be&&(t.set(c,l.ke()),l.Ke())}}));let i=Fe();this.Je.forEach(((l,c)=>{let d=!0;c.forEachWhile((p=>{const m=this.ot(p);return!m||m.purpose==="TargetPurposeLimboResolution"||(d=!1,!1)})),d&&(i=i.add(l))})),this.je.forEach(((l,c)=>c.setReadTime(e)));const a=new mf(e,t,this.Ze,this.je,i);return this.je=Di(),this.He=sd(),this.Je=sd(),this.Ze=new yt(Ge),a}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,t)?a.qe(t,1):a.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new Zw,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new $t(Ge),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new $t(Ge),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||ve("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Zw),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function sd(){return new yt(Ee.comparator)}function ex(){return new yt(Ee.comparator)}const Wj={asc:"ASCENDING",desc:"DESCENDING"},Qj={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Jj={and:"AND",or:"OR"};class Xj{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Am(n,e){return n.useProto3Json||uf(e)?e:{value:e}}function zd(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function S1(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Zj(n,e){return zd(n,e.toTimestamp())}function ti(n){return Ze(!!n,49232),Oe.fromTimestamp((function(t){const i=Or(t);return new dt(i.seconds,i.nanos)})(n))}function A0(n,e){return Nm(n,e).canonicalString()}function Nm(n,e){const t=(function(a){return new ct(["projects",a.projectId,"databases",a.database])})(n).child("documents");return e===void 0?t:t.child(e)}function A1(n){const e=ct.fromString(n);return Ze(k1(e),10190,{key:e.toString()}),e}function Cm(n,e){return A0(n.databaseId,e.path)}function $p(n,e){const t=A1(e);if(t.get(1)!==n.databaseId.projectId)throw new me(ae.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new me(ae.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ee(C1(t))}function N1(n,e){return A0(n.databaseId,e)}function e4(n){const e=A1(n);return e.length===4?ct.emptyPath():C1(e)}function Rm(n){return new ct(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function C1(n){return Ze(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function tx(n,e,t){return{name:Cm(n,e),fields:t.value.mapValue.fields}}function t4(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:Ie(39313,{state:m})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(m,_){return m.useProto3Json?(Ze(_===void 0||typeof _=="string",58123),on.fromBase64String(_||"")):(Ze(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),on.fromUint8Array(_||new Uint8Array))})(n,e.targetChange.resumeToken),c=e.targetChange.cause,d=c&&(function(m){const _=m.code===void 0?ae.UNKNOWN:x1(m.code);return new me(_,m.message||"")})(c);t=new E1(i,a,l,d||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const a=$p(n,i.document.name),l=ti(i.document.updateTime),c=i.document.createTime?ti(i.document.createTime):Oe.min(),d=new Nn({mapValue:{fields:i.document.fields}}),p=hn.newFoundDocument(a,l,c,d),m=i.targetIds||[],_=i.removedTargetIds||[];t=new xd(m,_,p.key,p)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const a=$p(n,i.document),l=i.readTime?ti(i.readTime):Oe.min(),c=hn.newNoDocument(a,l),d=i.removedTargetIds||[];t=new xd([],d,c.key,c)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const a=$p(n,i.document),l=i.removedTargetIds||[];t=new xd([],l,a,null)}else{if(!("filter"in e))return Ie(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:a=0,unchangedNames:l}=i,c=new $j(a,l),d=i.targetId;t=new T1(d,c)}}return t}function n4(n,e){let t;if(e instanceof mu)t={update:tx(n,e.key,e.value)};else if(e instanceof w1)t={delete:Cm(n,e.key)};else if(e instanceof zr)t={update:tx(n,e.key,e.data),updateMask:h4(e.fieldMask)};else{if(!(e instanceof zj))return Ie(16599,{dt:e.type});t={verify:Cm(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(l,c){const d=c.transform;if(d instanceof Vd)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(d instanceof eu)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:d.elements}};if(d instanceof tu)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:d.elements}};if(d instanceof Bd)return{fieldPath:c.field.canonicalString(),increment:d.Ae};throw Ie(20930,{transform:c.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:Zj(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:Ie(27497)})(n,e.precondition)),t}function s4(n,e){return n&&n.length>0?(Ze(e!==void 0,14353),n.map((t=>(function(a,l){let c=a.updateTime?ti(a.updateTime):ti(l);return c.isEqual(Oe.min())&&(c=ti(l)),new Uj(c,a.transformResults||[])})(t,e)))):[]}function i4(n,e){return{documents:[N1(n,e.path)]}}function r4(n,e){const t={structuredQuery:{}},i=e.path;let a;e.collectionGroup!==null?(a=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=N1(n,a);const l=(function(m){if(m.length!==0)return I1(Ss.create(m,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const c=(function(m){if(m.length!==0)return m.map((_=>(function(x){return{field:qo(x.field),direction:l4(x.dir)}})(_)))})(e.orderBy);c&&(t.structuredQuery.orderBy=c);const d=Am(n,e.limit);return d!==null&&(t.structuredQuery.limit=d),e.startAt&&(t.structuredQuery.startAt=(function(m){return{before:m.inclusive,values:m.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(m){return{before:!m.inclusive,values:m.position}})(e.endAt)),{ft:t,parent:a}}function a4(n){let e=e4(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let a=null;if(i>0){Ze(i===1,65062);const _=t.from[0];_.allDescendants?a=_.collectionId:e=e.child(_.collectionId)}let l=[];t.where&&(l=(function(b){const x=R1(b);return x instanceof Ss&&i1(x)?x.getFilters():[x]})(t.where));let c=[];t.orderBy&&(c=(function(b){return b.map((x=>(function(N){return new Ud($o(N.field),(function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(N.direction))})(x)))})(t.orderBy));let d=null;t.limit&&(d=(function(b){let x;return x=typeof b=="object"?b.value:b,uf(x)?null:x})(t.limit));let p=null;t.startAt&&(p=(function(b){const x=!!b.before,S=b.values||[];return new Ld(S,x)})(t.startAt));let m=null;return t.endAt&&(m=(function(b){const x=!b.before,S=b.values||[];return new Ld(S,x)})(t.endAt)),Ej(e,a,c,l,d,"F",p,m)}function o4(n,e){const t=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ie(28987,{purpose:a})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function R1(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=$o(t.unaryFilter.field);return Vt.create(i,"==",{doubleValue:NaN});case"IS_NULL":const a=$o(t.unaryFilter.field);return Vt.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=$o(t.unaryFilter.field);return Vt.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=$o(t.unaryFilter.field);return Vt.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ie(61313);default:return Ie(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Vt.create($o(t.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ie(58110);default:return Ie(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Ss.create(t.compositeFilter.filters.map((i=>R1(i))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return Ie(1026)}})(t.compositeFilter.op))})(n):Ie(30097,{filter:n})}function l4(n){return Wj[n]}function c4(n){return Qj[n]}function u4(n){return Jj[n]}function qo(n){return{fieldPath:n.canonicalString()}}function $o(n){return an.fromServerFormat(n.fieldPath)}function I1(n){return n instanceof Vt?(function(t){if(t.op==="=="){if(Hw(t.value))return{unaryFilter:{field:qo(t.field),op:"IS_NAN"}};if(zw(t.value))return{unaryFilter:{field:qo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Hw(t.value))return{unaryFilter:{field:qo(t.field),op:"IS_NOT_NAN"}};if(zw(t.value))return{unaryFilter:{field:qo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:qo(t.field),op:c4(t.op),value:t.value}}})(n):n instanceof Ss?(function(t){const i=t.getFilters().map((a=>I1(a)));return i.length===1?i[0]:{compositeFilter:{op:u4(t.op),filters:i}}})(n):Ie(54877,{filter:n})}function h4(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function k1(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function O1(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(e,t,i,a,l=Oe.min(),c=Oe.min(),d=on.EMPTY_BYTE_STRING,p=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=d,this.expectedCount=p}withSequenceNumber(e){return new Tr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Tr(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Tr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Tr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d4{constructor(e){this.yt=e}}function f4(n){const e=a4({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Sm(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g4{constructor(){this.Sn=new p4}addToCollectionParentIndex(e,t){return this.Sn.add(t),oe.resolve()}getCollectionParents(e,t){return oe.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return oe.resolve()}deleteFieldIndex(e,t){return oe.resolve()}deleteAllFieldIndexes(e){return oe.resolve()}createTargetIndexes(e,t){return oe.resolve()}getDocumentsMatchingTarget(e,t){return oe.resolve(null)}getIndexType(e,t){return oe.resolve(0)}getFieldIndexes(e,t){return oe.resolve([])}getNextCollectionGroupToUpdate(e){return oe.resolve(null)}getMinOffset(e,t){return oe.resolve(kr.min())}getMinOffsetFromCollectionGroup(e,t){return oe.resolve(kr.min())}updateCollectionGroup(e,t,i){return oe.resolve()}updateIndexEntries(e,t){return oe.resolve()}}class p4{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),a=this.index[t]||new $t(ct.comparator),l=!a.has(i);return this.index[t]=a.add(i),l}has(e){const t=e.lastSegment(),i=e.popLast(),a=this.index[t];return a&&a.has(i)}getEntries(e){return(this.index[e]||new $t(ct.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nx={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},j1=41943040;class Sn{static withCacheSize(e){return new Sn(e,Sn.DEFAULT_COLLECTION_PERCENTILE,Sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Sn.DEFAULT_COLLECTION_PERCENTILE=10,Sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Sn.DEFAULT=new Sn(j1,Sn.DEFAULT_COLLECTION_PERCENTILE,Sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Sn.DISABLED=new Sn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ll{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new ll(0)}static ar(){return new ll(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sx="LruGarbageCollector",m4=1048576;function ix([n,e],[t,i]){const a=Ge(n,t);return a===0?Ge(e,i):a}class y4{constructor(e){this.Pr=e,this.buffer=new $t(ix),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();ix(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class v4{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){ve(sx,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){gl(t)?ve(sx,"Ignoring IndexedDB error during garbage collection: ",t):await fl(t)}await this.Ar(3e5)}))}}class _4{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return oe.resolve(cf.ce);const i=new y4(t);return this.Vr.forEachTarget(e,(a=>i.Er(a.sequenceNumber))).next((()=>this.Vr.mr(e,(a=>i.Er(a))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ve("LruGarbageCollector","Garbage collection skipped; disabled"),oe.resolve(nx)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(ve("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),nx):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,a,l,c,d,p,m;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((b=>(b>this.params.maximumSequenceNumbersToCollect?(ve("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${b}`),a=this.params.maximumSequenceNumbersToCollect):a=b,c=Date.now(),this.nthSequenceNumber(e,a)))).next((b=>(i=b,d=Date.now(),this.removeTargets(e,i,t)))).next((b=>(l=b,p=Date.now(),this.removeOrphanedDocuments(e,i)))).next((b=>(m=Date.now(),zo()<=$e.DEBUG&&ve("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-_}ms
	Determined least recently used ${a} in `+(d-c)+`ms
	Removed ${l} targets in `+(p-d)+`ms
	Removed ${b} documents in `+(m-p)+`ms
Total Duration: ${m-_}ms`),oe.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:b}))))}}function b4(n,e){return new _4(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w4{constructor(){this.changes=new qa((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,hn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?oe.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x4{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T4{constructor(e,t,i,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=a}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((a=>(i=a,this.remoteDocumentCache.getEntry(e,t)))).next((a=>(i!==null&&Hc(i.mutation,a,Bn.empty(),dt.now()),a)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Fe()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Fe()){const a=Ca();return this.populateOverlays(e,a,t).next((()=>this.computeViews(e,t,a,i).next((l=>{let c=kc();return l.forEach(((d,p)=>{c=c.insert(d,p.overlayedDocument)})),c}))))}getOverlayedDocuments(e,t){const i=Ca();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Fe())))}populateOverlays(e,t,i){const a=[];return i.forEach((l=>{t.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((c,d)=>{t.set(c,d)}))}))}computeViews(e,t,i,a){let l=Di();const c=zc(),d=(function(){return zc()})();return t.forEach(((p,m)=>{const _=i.get(m.key);a.has(m.key)&&(_===void 0||_.mutation instanceof zr)?l=l.insert(m.key,m):_!==void 0?(c.set(m.key,_.mutation.getFieldMask()),Hc(_.mutation,m,_.mutation.getFieldMask(),dt.now())):c.set(m.key,Bn.empty())})),this.recalculateAndSaveOverlays(e,l).next((p=>(p.forEach(((m,_)=>c.set(m,_))),t.forEach(((m,_)=>d.set(m,new x4(_,c.get(m)??null)))),d)))}recalculateAndSaveOverlays(e,t){const i=zc();let a=new yt(((c,d)=>c-d)),l=Fe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((c=>{for(const d of c)d.keys().forEach((p=>{const m=t.get(p);if(m===null)return;let _=i.get(p)||Bn.empty();_=d.applyToLocalView(m,_),i.set(p,_);const b=(a.get(d.batchId)||Fe()).add(p);a=a.insert(d.batchId,b)}))})).next((()=>{const c=[],d=a.getReverseIterator();for(;d.hasNext();){const p=d.getNext(),m=p.key,_=p.value,b=f1();_.forEach((x=>{if(!l.has(x)){const S=_1(t.get(x),i.get(x));S!==null&&b.set(x,S),l=l.add(x)}})),c.push(this.documentOverlayCache.saveOverlays(e,m,b))}return oe.waitFor(c)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,a){return Sj(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):l1(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,a):this.getDocumentsMatchingCollectionQuery(e,t,i,a)}getNextDocuments(e,t,i,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,a).next((l=>{const c=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,a-l.size):oe.resolve(Ca());let d=Qc,p=l;return c.next((m=>oe.forEach(m,((_,b)=>(d<b.largestBatchId&&(d=b.largestBatchId),l.get(_)?oe.resolve():this.remoteDocumentCache.getEntry(e,_).next((x=>{p=p.insert(_,x)}))))).next((()=>this.populateOverlays(e,m,l))).next((()=>this.computeViews(e,p,m,Fe()))).next((_=>({batchId:d,changes:d1(_)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ee(t)).next((i=>{let a=kc();return i.isFoundDocument()&&(a=a.insert(i.key,i)),a}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,a){const l=t.collectionGroup;let c=kc();return this.indexManager.getCollectionParents(e,l).next((d=>oe.forEach(d,(p=>{const m=(function(b,x){return new pu(x,null,b.explicitOrderBy.slice(),b.filters.slice(),b.limit,b.limitType,b.startAt,b.endAt)})(t,p.child(l));return this.getDocumentsMatchingCollectionQuery(e,m,i,a).next((_=>{_.forEach(((b,x)=>{c=c.insert(b,x)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(e,t,i,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((c=>(l=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,l,a)))).next((c=>{l.forEach(((p,m)=>{const _=m.getKey();c.get(_)===null&&(c=c.insert(_,hn.newInvalidDocument(_)))}));let d=kc();return c.forEach(((p,m)=>{const _=l.get(p);_!==void 0&&Hc(_.mutation,m,Bn.empty(),dt.now()),ff(t,m)&&(d=d.insert(p,m))})),d}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E4{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return oe.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(a){return{id:a.id,version:a.version,createTime:ti(a.createTime)}})(t)),oe.resolve()}getNamedQuery(e,t){return oe.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(a){return{name:a.name,query:f4(a.bundledQuery),readTime:ti(a.readTime)}})(t)),oe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S4{constructor(){this.overlays=new yt(Ee.comparator),this.Lr=new Map}getOverlay(e,t){return oe.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Ca();return oe.forEach(t,(a=>this.getOverlay(e,a).next((l=>{l!==null&&i.set(a,l)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((a,l)=>{this.bt(e,t,l)})),oe.resolve()}removeOverlaysForBatchId(e,t,i){const a=this.Lr.get(i);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.Lr.delete(i)),oe.resolve()}getOverlaysForCollection(e,t,i){const a=Ca(),l=t.length+1,c=new Ee(t.child("")),d=this.overlays.getIteratorFrom(c);for(;d.hasNext();){const p=d.getNext().value,m=p.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===l&&p.largestBatchId>i&&a.set(p.getKey(),p)}return oe.resolve(a)}getOverlaysForCollectionGroup(e,t,i,a){let l=new yt(((m,_)=>m-_));const c=this.overlays.getIterator();for(;c.hasNext();){const m=c.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>i){let _=l.get(m.largestBatchId);_===null&&(_=Ca(),l=l.insert(m.largestBatchId,_)),_.set(m.getKey(),m)}}const d=Ca(),p=l.getIterator();for(;p.hasNext()&&(p.getNext().value.forEach(((m,_)=>d.set(m,_))),!(d.size()>=a)););return oe.resolve(d)}bt(e,t,i){const a=this.overlays.get(i.key);if(a!==null){const c=this.Lr.get(a.largestBatchId).delete(i.key);this.Lr.set(a.largestBatchId,c)}this.overlays=this.overlays.insert(i.key,new qj(t,i));let l=this.Lr.get(t);l===void 0&&(l=Fe(),this.Lr.set(t,l)),this.Lr.set(t,l.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A4{constructor(){this.sessionToken=on.EMPTY_BYTE_STRING}getSessionToken(e){return oe.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,oe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N0{constructor(){this.kr=new $t(Yt.Kr),this.qr=new $t(Yt.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new Yt(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new Yt(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new Ee(new ct([])),i=new Yt(t,e),a=new Yt(t,e+1),l=[];return this.qr.forEachInRange([i,a],(c=>{this.Wr(c),l.push(c.key)})),l}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new Ee(new ct([])),i=new Yt(t,e),a=new Yt(t,e+1);let l=Fe();return this.qr.forEachInRange([i,a],(c=>{l=l.add(c.key)})),l}containsKey(e){const t=new Yt(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Yt{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return Ee.comparator(e.key,t.key)||Ge(e.Hr,t.Hr)}static Ur(e,t){return Ge(e.Hr,t.Hr)||Ee.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N4{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new $t(Yt.Kr)}checkEmpty(e){return oe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,a){const l=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new Hj(l,t,i,a);this.mutationQueue.push(c);for(const d of a)this.Jr=this.Jr.add(new Yt(d.key,l)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return oe.resolve(c)}lookupMutationBatch(e,t){return oe.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,a=this.Xr(i),l=a<0?0:a;return oe.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return oe.resolve(this.mutationQueue.length===0?y0:this.Yn-1)}getAllMutationBatches(e){return oe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Yt(t,0),a=new Yt(t,Number.POSITIVE_INFINITY),l=[];return this.Jr.forEachInRange([i,a],(c=>{const d=this.Zr(c.Hr);l.push(d)})),oe.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new $t(Ge);return t.forEach((a=>{const l=new Yt(a,0),c=new Yt(a,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([l,c],(d=>{i=i.add(d.Hr)}))})),oe.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,a=i.length+1;let l=i;Ee.isDocumentKey(l)||(l=l.child(""));const c=new Yt(new Ee(l),0);let d=new $t(Ge);return this.Jr.forEachWhile((p=>{const m=p.key.path;return!!i.isPrefixOf(m)&&(m.length===a&&(d=d.add(p.Hr)),!0)}),c),oe.resolve(this.Yr(d))}Yr(e){const t=[];return e.forEach((i=>{const a=this.Zr(i);a!==null&&t.push(a)})),t}removeMutationBatch(e,t){Ze(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return oe.forEach(t.mutations,(a=>{const l=new Yt(a.key,t.batchId);return i=i.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new Yt(t,0),a=this.Jr.firstAfterOrEqual(i);return oe.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,oe.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C4{constructor(e){this.ti=e,this.docs=(function(){return new yt(Ee.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,a=this.docs.get(i),l=a?a.size:0,c=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:c}),this.size+=c-l,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return oe.resolve(i?i.document.mutableCopy():hn.newInvalidDocument(t))}getEntries(e,t){let i=Di();return t.forEach((a=>{const l=this.docs.get(a);i=i.insert(a,l?l.document.mutableCopy():hn.newInvalidDocument(a))})),oe.resolve(i)}getDocumentsMatchingQuery(e,t,i,a){let l=Di();const c=t.path,d=new Ee(c.child("__id-9223372036854775808__")),p=this.docs.getIteratorFrom(d);for(;p.hasNext();){const{key:m,value:{document:_}}=p.getNext();if(!c.isPrefixOf(m.path))break;m.path.length>c.length+1||tj(ej(_),i)<=0||(a.has(_.key)||ff(t,_))&&(l=l.insert(_.key,_.mutableCopy()))}return oe.resolve(l)}getAllFromCollectionGroup(e,t,i,a){Ie(9500)}ni(e,t){return oe.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new R4(this)}getSize(e){return oe.resolve(this.size)}}class R4 extends w4{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,a)=>{a.isValidDocument()?t.push(this.Mr.addEntry(e,a)):this.Mr.removeEntry(i)})),oe.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I4{constructor(e){this.persistence=e,this.ri=new qa((t=>b0(t)),w0),this.lastRemoteSnapshotVersion=Oe.min(),this.highestTargetId=0,this.ii=0,this.si=new N0,this.targetCount=0,this.oi=ll._r()}forEachTarget(e,t){return this.ri.forEach(((i,a)=>t(a))),oe.resolve()}getLastRemoteSnapshotVersion(e){return oe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return oe.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),oe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),oe.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new ll(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,oe.resolve()}updateTargetData(e,t){return this.lr(t),oe.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,oe.resolve()}removeTargets(e,t,i){let a=0;const l=[];return this.ri.forEach(((c,d)=>{d.sequenceNumber<=t&&i.get(d.targetId)===null&&(this.ri.delete(c),l.push(this.removeMatchingKeysForTargetId(e,d.targetId)),a++)})),oe.waitFor(l).next((()=>a))}getTargetCount(e){return oe.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return oe.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),oe.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const a=this.persistence.referenceDelegate,l=[];return a&&t.forEach((c=>{l.push(a.markPotentiallyOrphaned(e,c))})),oe.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),oe.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return oe.resolve(i)}containsKey(e,t){return oe.resolve(this.si.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D1{constructor(e,t){this._i={},this.overlays={},this.ai=new cf(0),this.ui=!1,this.ui=!0,this.ci=new A4,this.referenceDelegate=e(this),this.li=new I4(this),this.indexManager=new g4,this.remoteDocumentCache=(function(a){return new C4(a)})((i=>this.referenceDelegate.hi(i))),this.serializer=new d4(t),this.Pi=new E4(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new S4,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new N4(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){ve("MemoryPersistence","Starting transaction:",e);const a=new k4(this.ai.next());return this.referenceDelegate.Ti(),i(a).next((l=>this.referenceDelegate.Ii(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ei(e,t){return oe.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class k4 extends sj{constructor(e){super(),this.currentSequenceNumber=e}}class C0{constructor(e){this.persistence=e,this.Ri=new N0,this.Ai=null}static Vi(e){return new C0(e)}get di(){if(this.Ai)return this.Ai;throw Ie(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),oe.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),oe.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),oe.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((a=>this.di.add(a.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((a=>{a.forEach((l=>this.di.add(l.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return oe.forEach(this.di,(i=>{const a=Ee.fromPath(i);return this.mi(e,a).next((l=>{l||t.removeEntry(a,Oe.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return oe.or([()=>oe.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Hd{constructor(e,t){this.persistence=e,this.fi=new qa((i=>aj(i.path)),((i,a)=>i.isEqual(a))),this.garbageCollector=b4(this,t)}static Vi(e,t){return new Hd(e,t)}Ti(){}Ii(e){return oe.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((a=>i+a))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return oe.forEach(this.fi,((i,a)=>this.wr(e,i,a).next((l=>l?oe.resolve():t(a)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ni(e,(c=>this.wr(e,c,t).next((d=>{d||(i++,l.removeEntry(c,Oe.min()))})))).next((()=>l.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),oe.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),oe.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),oe.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),oe.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=_d(e.data.value)),t}wr(e,t,i){return oe.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const a=this.fi.get(t);return oe.resolve(a!==void 0&&a>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R0{constructor(e,t,i,a){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=a}static Es(e,t){let i=Fe(),a=Fe();for(const l of t.docChanges)switch(l.type){case 0:i=i.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new R0(e,t.fromCache,i,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O4{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j4{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return DN()?8:ij(fn())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,a){const l={result:null};return this.gs(e,t).next((c=>{l.result=c})).next((()=>{if(!l.result)return this.ps(e,t,a,i).next((c=>{l.result=c}))})).next((()=>{if(l.result)return;const c=new O4;return this.ys(e,t,c).next((d=>{if(l.result=d,this.As)return this.ws(e,t,c,d.size)}))})).next((()=>l.result))}ws(e,t,i,a){return i.documentReadCount<this.Vs?(zo()<=$e.DEBUG&&ve("QueryEngine","SDK will not create cache indexes for query:",Ho(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),oe.resolve()):(zo()<=$e.DEBUG&&ve("QueryEngine","Query:",Ho(t),"scans",i.documentReadCount,"local documents and returns",a,"documents as results."),i.documentReadCount>this.ds*a?(zo()<=$e.DEBUG&&ve("QueryEngine","The SDK decides to create cache indexes for query:",Ho(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Zs(t))):oe.resolve())}gs(e,t){if(Fw(t))return oe.resolve(null);let i=Zs(t);return this.indexManager.getIndexType(e,i).next((a=>a===0?null:(t.limit!==null&&a===1&&(t=Sm(t,null,"F"),i=Zs(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((l=>{const c=Fe(...l);return this.fs.getDocuments(e,c).next((d=>this.indexManager.getMinOffset(e,i).next((p=>{const m=this.bs(t,d);return this.Ss(t,m,c,p.readTime)?this.gs(e,Sm(t,null,"F")):this.Ds(e,m,t,p)}))))})))))}ps(e,t,i,a){return Fw(t)||a.isEqual(Oe.min())?oe.resolve(null):this.fs.getDocuments(e,i).next((l=>{const c=this.bs(t,l);return this.Ss(t,c,i,a)?oe.resolve(null):(zo()<=$e.DEBUG&&ve("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),Ho(t)),this.Ds(e,c,t,ZO(a,Qc)).next((d=>d)))}))}bs(e,t){let i=new $t(u1(e));return t.forEach(((a,l)=>{ff(e,l)&&(i=i.add(l))})),i}Ss(e,t,i,a){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}ys(e,t,i){return zo()<=$e.DEBUG&&ve("QueryEngine","Using full collection scan to execute query:",Ho(t)),this.fs.getDocumentsMatchingQuery(e,t,kr.min(),i)}Ds(e,t,i,a){return this.fs.getDocumentsMatchingQuery(e,i,a).next((l=>(t.forEach((c=>{l=l.insert(c.key,c)})),l)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I0="LocalStore",D4=3e8;class P4{constructor(e,t,i,a){this.persistence=e,this.Cs=t,this.serializer=a,this.vs=new yt(Ge),this.Fs=new qa((l=>b0(l)),w0),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new T4(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function M4(n,e,t,i){return new P4(n,e,t,i)}async function P1(n,e){const t=De(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let a;return t.mutationQueue.getAllMutationBatches(i).next((l=>(a=l,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((l=>{const c=[],d=[];let p=Fe();for(const m of a){c.push(m.batchId);for(const _ of m.mutations)p=p.add(_.key)}for(const m of l){d.push(m.batchId);for(const _ of m.mutations)p=p.add(_.key)}return t.localDocuments.getDocuments(i,p).next((m=>({Ns:m,removedBatchIds:c,addedBatchIds:d})))}))}))}function L4(n,e){const t=De(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const a=e.batch.keys(),l=t.xs.newChangeBuffer({trackRemovals:!0});return(function(d,p,m,_){const b=m.batch,x=b.keys();let S=oe.resolve();return x.forEach((N=>{S=S.next((()=>_.getEntry(p,N))).next((j=>{const k=m.docVersions.get(N);Ze(k!==null,48541),j.version.compareTo(k)<0&&(b.applyToRemoteDocument(j,m),j.isValidDocument()&&(j.setReadTime(m.commitVersion),_.addEntry(j)))}))})),S.next((()=>d.mutationQueue.removeMutationBatch(p,b)))})(t,i,e,l).next((()=>l.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,a,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(d){let p=Fe();for(let m=0;m<d.mutationResults.length;++m)d.mutationResults[m].transformResults.length>0&&(p=p.add(d.batch.mutations[m].key));return p})(e)))).next((()=>t.localDocuments.getDocuments(i,a)))}))}function M1(n){const e=De(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function U4(n,e){const t=De(n),i=e.snapshotVersion;let a=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const c=t.xs.newChangeBuffer({trackRemovals:!0});a=t.vs;const d=[];e.targetChanges.forEach(((_,b)=>{const x=a.get(b);if(!x)return;d.push(t.li.removeMatchingKeys(l,_.removedDocuments,b).next((()=>t.li.addMatchingKeys(l,_.addedDocuments,b))));let S=x.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(b)!==null?S=S.withResumeToken(on.EMPTY_BYTE_STRING,Oe.min()).withLastLimboFreeSnapshotVersion(Oe.min()):_.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(_.resumeToken,i)),a=a.insert(b,S),(function(j,k,L){return j.resumeToken.approximateByteSize()===0||k.snapshotVersion.toMicroseconds()-j.snapshotVersion.toMicroseconds()>=D4?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0})(x,S,_)&&d.push(t.li.updateTargetData(l,S))}));let p=Di(),m=Fe();if(e.documentUpdates.forEach((_=>{e.resolvedLimboDocuments.has(_)&&d.push(t.persistence.referenceDelegate.updateLimboDocument(l,_))})),d.push(V4(l,c,e.documentUpdates).next((_=>{p=_.Bs,m=_.Ls}))),!i.isEqual(Oe.min())){const _=t.li.getLastRemoteSnapshotVersion(l).next((b=>t.li.setTargetsMetadata(l,l.currentSequenceNumber,i)));d.push(_)}return oe.waitFor(d).next((()=>c.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,p,m))).next((()=>p))})).then((l=>(t.vs=a,l)))}function V4(n,e,t){let i=Fe(),a=Fe();return t.forEach((l=>i=i.add(l))),e.getEntries(n,i).next((l=>{let c=Di();return t.forEach(((d,p)=>{const m=l.get(d);p.isFoundDocument()!==m.isFoundDocument()&&(a=a.add(d)),p.isNoDocument()&&p.version.isEqual(Oe.min())?(e.removeEntry(d,p.readTime),c=c.insert(d,p)):!m.isValidDocument()||p.version.compareTo(m.version)>0||p.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(p),c=c.insert(d,p)):ve(I0,"Ignoring outdated watch update for ",d,". Current version:",m.version," Watch version:",p.version)})),{Bs:c,Ls:a}}))}function B4(n,e){const t=De(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=y0),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function z4(n,e){const t=De(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let a;return t.li.getTargetData(i,e).next((l=>l?(a=l,oe.resolve(a)):t.li.allocateTargetId(i).next((c=>(a=new Tr(e,c,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,a).next((()=>a)))))))})).then((i=>{const a=t.vs.get(i.targetId);return(a===null||i.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function Im(n,e,t){const i=De(n),a=i.vs.get(e),l=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",l,(c=>i.persistence.referenceDelegate.removeTarget(c,a)))}catch(c){if(!gl(c))throw c;ve(I0,`Failed to update sequence numbers for target ${e}: ${c}`)}i.vs=i.vs.remove(e),i.Fs.delete(a.target)}function rx(n,e,t){const i=De(n);let a=Oe.min(),l=Fe();return i.persistence.runTransaction("Execute query","readwrite",(c=>(function(p,m,_){const b=De(p),x=b.Fs.get(_);return x!==void 0?oe.resolve(b.vs.get(x)):b.li.getTargetData(m,_)})(i,c,Zs(e)).next((d=>{if(d)return a=d.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(c,d.targetId).next((p=>{l=p}))})).next((()=>i.Cs.getDocumentsMatchingQuery(c,e,t?a:Oe.min(),t?l:Fe()))).next((d=>(H4(i,Nj(e),d),{documents:d,ks:l})))))}function H4(n,e,t){let i=n.Ms.get(e)||Oe.min();t.forEach(((a,l)=>{l.readTime.compareTo(i)>0&&(i=l.readTime)})),n.Ms.set(e,i)}class ax{constructor(){this.activeTargetIds=jj()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class q4{constructor(){this.vo=new ax,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new ax,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $4{Mo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ox="ConnectivityMonitor";class lx{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){ve(ox,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){ve(ox,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let id=null;function km(){return id===null?id=(function(){return 268435456+Math.round(2147483648*Math.random())})():id++,"0x"+id.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gp="RestConnection",G4={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class F4{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${a}`,this.$o=this.databaseId.database===Pd?`project_id=${i}`:`project_id=${i}&database_id=${a}`}Wo(e,t,i,a,l){const c=km(),d=this.Qo(e,t.toUriEncodedString());ve(Gp,`Sending RPC '${e}' ${c}:`,d,i);const p={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(p,a,l);const{host:m}=new URL(d),_=Ba(m);return this.zo(e,d,p,i,_).then((b=>(ve(Gp,`Received RPC '${e}' ${c}: `,b),b)),(b=>{throw il(Gp,`RPC '${e}' ${c} failed with error: `,b,"url: ",d,"request:",i),b}))}jo(e,t,i,a,l,c){return this.Wo(e,t,i,a,l)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+dl})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((a,l)=>e[l]=a)),i&&i.headers.forEach(((a,l)=>e[l]=a))}Qo(e,t){const i=G4[e];let a=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(a=`${a}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),a}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K4{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cn="WebChannelConnection",Sc=(n,e,t)=>{n.listen(e,(i=>{try{t(i)}catch(a){setTimeout((()=>{throw a}),0)}}))};class Zo extends F4{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Zo.c_){const e=BE();Sc(e,VE.STAT_EVENT,(t=>{t.stat===vm.PROXY?ve(cn,"STAT_EVENT: detected buffering proxy"):t.stat===vm.NOPROXY&&ve(cn,"STAT_EVENT: detected no buffering proxy")})),Zo.c_=!0}}zo(e,t,i,a,l){const c=km();return new Promise(((d,p)=>{const m=new LE;m.setWithCredentials(!0),m.listenOnce(UE.COMPLETE,(()=>{try{switch(m.getLastErrorCode()){case vd.NO_ERROR:const b=m.getResponseJson();ve(cn,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(b)),d(b);break;case vd.TIMEOUT:ve(cn,`RPC '${e}' ${c} timed out`),p(new me(ae.DEADLINE_EXCEEDED,"Request time out"));break;case vd.HTTP_ERROR:const x=m.getStatus();if(ve(cn,`RPC '${e}' ${c} failed with status:`,x,"response text:",m.getResponseText()),x>0){let S=m.getResponseJson();Array.isArray(S)&&(S=S[0]);const N=S==null?void 0:S.error;if(N&&N.status&&N.message){const j=(function(L){const H=L.toLowerCase().replace(/_/g,"-");return Object.values(ae).indexOf(H)>=0?H:ae.UNKNOWN})(N.status);p(new me(j,N.message))}else p(new me(ae.UNKNOWN,"Server responded with status "+m.getStatus()))}else p(new me(ae.UNAVAILABLE,"Connection failed."));break;default:Ie(9055,{l_:e,streamId:c,h_:m.getLastErrorCode(),P_:m.getLastError()})}}finally{ve(cn,`RPC '${e}' ${c} completed.`)}}));const _=JSON.stringify(a);ve(cn,`RPC '${e}' ${c} sending request:`,a),m.send(t,"POST",_,i,15)}))}T_(e,t,i){const a=km(),l=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=this.createWebChannelTransport(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(d.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(d.useFetchStreams=!0),this.Go(d.initMessageHeaders,t,i),d.encodeInitMessageHeaders=!0;const m=l.join("");ve(cn,`Creating RPC '${e}' stream ${a}: ${m}`,d);const _=c.createWebChannel(m,d);this.I_(_);let b=!1,x=!1;const S=new K4({Ho:N=>{x?ve(cn,`Not sending because RPC '${e}' stream ${a} is closed:`,N):(b||(ve(cn,`Opening RPC '${e}' stream ${a} transport.`),_.open(),b=!0),ve(cn,`RPC '${e}' stream ${a} sending:`,N),_.send(N))},Jo:()=>_.close()});return Sc(_,Ic.EventType.OPEN,(()=>{x||(ve(cn,`RPC '${e}' stream ${a} transport opened.`),S.i_())})),Sc(_,Ic.EventType.CLOSE,(()=>{x||(x=!0,ve(cn,`RPC '${e}' stream ${a} transport closed`),S.o_(),this.E_(_))})),Sc(_,Ic.EventType.ERROR,(N=>{x||(x=!0,il(cn,`RPC '${e}' stream ${a} transport errored. Name:`,N.name,"Message:",N.message),S.o_(new me(ae.UNAVAILABLE,"The operation could not be completed")))})),Sc(_,Ic.EventType.MESSAGE,(N=>{var j;if(!x){const k=N.data[0];Ze(!!k,16349);const L=k,H=(L==null?void 0:L.error)||((j=L[0])==null?void 0:j.error);if(H){ve(cn,`RPC '${e}' stream ${a} received error:`,H);const B=H.status;let K=(function(A){const C=Lt[A];if(C!==void 0)return x1(C)})(B),F=H.message;K===void 0&&(K=ae.INTERNAL,F="Unknown error status: "+B+" with message "+H.message),x=!0,S.o_(new me(K,F)),_.close()}else ve(cn,`RPC '${e}' stream ${a} received:`,k),S.__(k)}})),Zo.u_(),setTimeout((()=>{S.s_()}),0),S}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return zE()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y4(n){return new Zo(n)}function Fp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yf(n){return new Xj(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Zo.c_=!1;class L1{constructor(e,t,i=1e3,a=1.5,l=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=a,this.V_=l,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),a=Math.max(0,t-i);a>0&&ve("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,a,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cx="PersistentStream";class U1{constructor(e,t,i,a,l,c,d,p){this.Ci=e,this.b_=i,this.S_=a,this.connection=l,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=d,this.listener=p,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new L1(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ae.RESOURCE_EXHAUSTED?(Oi(t.toString()),Oi("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ae.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,a])=>{this.D_===t&&this.G_(i,a)}),(i=>{e((()=>{const a=new me(ae.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(a)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((a=>{i((()=>this.z_(a)))})),this.stream.onMessage((a=>{i((()=>++this.F_==1?this.H_(a):this.onNext(a)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ve(cx,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(ve(cx,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class W4 extends U1{constructor(e,t,i,a,l,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,a,c),this.serializer=l}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=t4(this.serializer,e),i=(function(l){if(!("targetChange"in l))return Oe.min();const c=l.targetChange;return c.targetIds&&c.targetIds.length?Oe.min():c.readTime?ti(c.readTime):Oe.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=Rm(this.serializer),t.addTarget=(function(l,c){let d;const p=c.target;if(d=Tm(p)?{documents:i4(l,p)}:{query:r4(l,p).ft},d.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){d.resumeToken=S1(l,c.resumeToken);const m=Am(l,c.expectedCount);m!==null&&(d.expectedCount=m)}else if(c.snapshotVersion.compareTo(Oe.min())>0){d.readTime=zd(l,c.snapshotVersion.toTimestamp());const m=Am(l,c.expectedCount);m!==null&&(d.expectedCount=m)}return d})(this.serializer,e);const i=o4(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=Rm(this.serializer),t.removeTarget=e,this.K_(t)}}class Q4 extends U1{constructor(e,t,i,a,l,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,a,c),this.serializer=l}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return Ze(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ze(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ze(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=s4(e.writeResults,e.commitTime),i=ti(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=Rm(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>n4(this.serializer,i)))};this.K_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J4{}class X4 extends J4{constructor(e,t,i,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new me(ae.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,c])=>this.connection.Wo(e,Nm(t,i),a,l,c))).catch((l=>{throw l.name==="FirebaseError"?(l.code===ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new me(ae.UNKNOWN,l.toString())}))}jo(e,t,i,a,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,d])=>this.connection.jo(e,Nm(t,i),a,c,d,l))).catch((c=>{throw c.name==="FirebaseError"?(c.code===ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new me(ae.UNKNOWN,c.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function Z4(n,e,t,i){return new X4(n,e,t,i)}class eD{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Oi(t),this.aa=!1):ve("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ua="RemoteStore";class tD{constructor(e,t,i,a,l){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=l,this.Aa.Mo((c=>{i.enqueueAndForget((async()=>{$a(this)&&(ve(Ua,"Restarting streams for network reachability change."),await(async function(p){const m=De(p);m.Ea.add(4),await vu(m),m.Va.set("Unknown"),m.Ea.delete(4),await vf(m)})(this))}))})),this.Va=new eD(i,a)}}async function vf(n){if($a(n))for(const e of n.Ra)await e(!0)}async function vu(n){for(const e of n.Ra)await e(!1)}function V1(n,e){const t=De(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),D0(t)?j0(t):pl(t).O_()&&O0(t,e))}function k0(n,e){const t=De(n),i=pl(t);t.Ia.delete(e),i.O_()&&B1(t,e),t.Ia.size===0&&(i.O_()?i.L_():$a(t)&&t.Va.set("Unknown"))}function O0(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Oe.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}pl(n).Z_(e)}function B1(n,e){n.da.$e(e),pl(n).X_(e)}function j0(n){n.da=new Yj({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),pl(n).start(),n.Va.ua()}function D0(n){return $a(n)&&!pl(n).x_()&&n.Ia.size>0}function $a(n){return De(n).Ea.size===0}function z1(n){n.da=void 0}async function nD(n){n.Va.set("Online")}async function sD(n){n.Ia.forEach(((e,t)=>{O0(n,e)}))}async function iD(n,e){z1(n),D0(n)?(n.Va.ha(e),j0(n)):n.Va.set("Unknown")}async function rD(n,e,t){if(n.Va.set("Online"),e instanceof E1&&e.state===2&&e.cause)try{await(async function(a,l){const c=l.cause;for(const d of l.targetIds)a.Ia.has(d)&&(await a.remoteSyncer.rejectListen(d,c),a.Ia.delete(d),a.da.removeTarget(d))})(n,e)}catch(i){ve(Ua,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await qd(n,i)}else if(e instanceof xd?n.da.Xe(e):e instanceof T1?n.da.st(e):n.da.tt(e),!t.isEqual(Oe.min()))try{const i=await M1(n.localStore);t.compareTo(i)>=0&&await(function(l,c){const d=l.da.Tt(c);return d.targetChanges.forEach(((p,m)=>{if(p.resumeToken.approximateByteSize()>0){const _=l.Ia.get(m);_&&l.Ia.set(m,_.withResumeToken(p.resumeToken,c))}})),d.targetMismatches.forEach(((p,m)=>{const _=l.Ia.get(p);if(!_)return;l.Ia.set(p,_.withResumeToken(on.EMPTY_BYTE_STRING,_.snapshotVersion)),B1(l,p);const b=new Tr(_.target,p,m,_.sequenceNumber);O0(l,b)})),l.remoteSyncer.applyRemoteEvent(d)})(n,t)}catch(i){ve(Ua,"Failed to raise snapshot:",i),await qd(n,i)}}async function qd(n,e,t){if(!gl(e))throw e;n.Ea.add(1),await vu(n),n.Va.set("Offline"),t||(t=()=>M1(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{ve(Ua,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await vf(n)}))}function H1(n,e){return e().catch((t=>qd(n,t,e)))}async function _f(n){const e=De(n),t=Pr(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:y0;for(;aD(e);)try{const a=await B4(e.localStore,i);if(a===null){e.Ta.length===0&&t.L_();break}i=a.batchId,oD(e,a)}catch(a){await qd(e,a)}q1(e)&&$1(e)}function aD(n){return $a(n)&&n.Ta.length<10}function oD(n,e){n.Ta.push(e);const t=Pr(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function q1(n){return $a(n)&&!Pr(n).x_()&&n.Ta.length>0}function $1(n){Pr(n).start()}async function lD(n){Pr(n).ra()}async function cD(n){const e=Pr(n);for(const t of n.Ta)e.ea(t.mutations)}async function uD(n,e,t){const i=n.Ta.shift(),a=E0.from(i,e,t);await H1(n,(()=>n.remoteSyncer.applySuccessfulWrite(a))),await _f(n)}async function hD(n,e){e&&Pr(n).Y_&&await(async function(i,a){if((function(c){return Gj(c)&&c!==ae.ABORTED})(a.code)){const l=i.Ta.shift();Pr(i).B_(),await H1(i,(()=>i.remoteSyncer.rejectFailedWrite(l.batchId,a))),await _f(i)}})(n,e),q1(n)&&$1(n)}async function ux(n,e){const t=De(n);t.asyncQueue.verifyOperationInProgress(),ve(Ua,"RemoteStore received new credentials");const i=$a(t);t.Ea.add(3),await vu(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await vf(t)}async function dD(n,e){const t=De(n);e?(t.Ea.delete(2),await vf(t)):e||(t.Ea.add(2),await vu(t),t.Va.set("Unknown"))}function pl(n){return n.ma||(n.ma=(function(t,i,a){const l=De(t);return l.sa(),new W4(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Zo:nD.bind(null,n),Yo:sD.bind(null,n),t_:iD.bind(null,n),J_:rD.bind(null,n)}),n.Ra.push((async e=>{e?(n.ma.B_(),D0(n)?j0(n):n.Va.set("Unknown")):(await n.ma.stop(),z1(n))}))),n.ma}function Pr(n){return n.fa||(n.fa=(function(t,i,a){const l=De(t);return l.sa(),new Q4(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:lD.bind(null,n),t_:hD.bind(null,n),ta:cD.bind(null,n),na:uD.bind(null,n)}),n.Ra.push((async e=>{e?(n.fa.B_(),await _f(n)):(await n.fa.stop(),n.Ta.length>0&&(ve(Ua,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P0{constructor(e,t,i,a,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=a,this.removalCallback=l,this.deferred=new Ri,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,a,l){const c=Date.now()+i,d=new P0(e,t,c,a,l);return d.start(i),d}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new me(ae.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function M0(n,e){if(Oi("AsyncQueue",`${e}: ${n}`),gl(n))return new me(ae.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class el{static emptySet(e){return new el(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Ee.comparator(t.key,i.key):(t,i)=>Ee.comparator(t.key,i.key),this.keyedMap=kc(),this.sortedSet=new yt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof el)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=i.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new el;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hx{constructor(){this.ga=new yt(Ee.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Ie(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class cl{constructor(e,t,i,a,l,c,d,p,m){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=a,this.mutatedKeys=l,this.fromCache=c,this.syncStateChanged=d,this.excludesMetadataChanges=p,this.hasCachedResults=m}static fromInitialDocuments(e,t,i,a,l){const c=[];return t.forEach((d=>{c.push({type:0,doc:d})})),new cl(e,t,el.emptySet(t),c,i,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&df(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==i[a].type||!t[a].doc.isEqual(i[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fD{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class gD{constructor(){this.queries=dx(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const a=De(t),l=a.queries;a.queries=dx(),l.forEach(((c,d)=>{for(const p of d.ba)p.onError(i)}))})(this,new me(ae.ABORTED,"Firestore shutting down"))}}function dx(){return new qa((n=>c1(n)),df)}async function G1(n,e){const t=De(n);let i=3;const a=e.query;let l=t.queries.get(a);l?!l.Sa()&&e.Da()&&(i=2):(l=new fD,i=e.Da()?0:1);try{switch(i){case 0:l.wa=await t.onListen(a,!0);break;case 1:l.wa=await t.onListen(a,!1);break;case 2:await t.onFirstRemoteStoreListen(a)}}catch(c){const d=M0(c,`Initialization of query '${Ho(e.query)}' failed`);return void e.onError(d)}t.queries.set(a,l),l.ba.push(e),e.va(t.onlineState),l.wa&&e.Fa(l.wa)&&L0(t)}async function F1(n,e){const t=De(n),i=e.query;let a=3;const l=t.queries.get(i);if(l){const c=l.ba.indexOf(e);c>=0&&(l.ba.splice(c,1),l.ba.length===0?a=e.Da()?0:1:!l.Sa()&&e.Da()&&(a=2))}switch(a){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function pD(n,e){const t=De(n);let i=!1;for(const a of e){const l=a.query,c=t.queries.get(l);if(c){for(const d of c.ba)d.Fa(a)&&(i=!0);c.wa=a}}i&&L0(t)}function mD(n,e,t){const i=De(n),a=i.queries.get(e);if(a)for(const l of a.ba)l.onError(t);i.queries.delete(e)}function L0(n){n.Ca.forEach((e=>{e.next()}))}var Om,fx;(fx=Om||(Om={})).Ma="default",fx.Cache="cache";class K1{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const a of e.docChanges)a.type!==3&&i.push(a);e=new cl(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=cl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Om.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y1{constructor(e){this.key=e}}class W1{constructor(e){this.key=e}}class yD{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Fe(),this.mutatedKeys=Fe(),this.eu=u1(e),this.tu=new el(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new hx,a=t?t.tu:this.tu;let l=t?t.mutatedKeys:this.mutatedKeys,c=a,d=!1;const p=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,m=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((_,b)=>{const x=a.get(_),S=ff(this.query,b)?b:null,N=!!x&&this.mutatedKeys.has(x.key),j=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations);let k=!1;x&&S?x.data.isEqual(S.data)?N!==j&&(i.track({type:3,doc:S}),k=!0):this.su(x,S)||(i.track({type:2,doc:S}),k=!0,(p&&this.eu(S,p)>0||m&&this.eu(S,m)<0)&&(d=!0)):!x&&S?(i.track({type:0,doc:S}),k=!0):x&&!S&&(i.track({type:1,doc:x}),k=!0,(p||m)&&(d=!0)),k&&(S?(c=c.add(S),l=j?l.add(_):l.delete(_)):(c=c.delete(_),l=l.delete(_)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const _=this.query.limitType==="F"?c.last():c.first();c=c.delete(_.key),l=l.delete(_.key),i.track({type:1,doc:_})}return{tu:c,iu:i,Ss:d,mutatedKeys:l}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,a){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const c=e.iu.ya();c.sort(((_,b)=>(function(S,N){const j=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ie(20277,{Vt:k})}};return j(S)-j(N)})(_.type,b.type)||this.eu(_.doc,b.doc))),this.ou(i),a=a??!1;const d=t&&!a?this._u():[],p=this.Ya.size===0&&this.current&&!a?1:0,m=p!==this.Xa;return this.Xa=p,c.length!==0||m?{snapshot:new cl(this.query,e.tu,l,c,e.mutatedKeys,p===0,m,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:d}:{au:d}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new hx,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=Fe(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new W1(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new Y1(i))})),t}cu(e){this.Za=e.ks,this.Ya=Fe();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return cl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const U0="SyncEngine";class vD{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class _D{constructor(e){this.key=e,this.hu=!1}}class bD{constructor(e,t,i,a,l,c){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=c,this.Pu={},this.Tu=new qa((d=>c1(d)),df),this.Iu=new Map,this.Eu=new Set,this.Ru=new yt(Ee.comparator),this.Au=new Map,this.Vu=new N0,this.du={},this.mu=new Map,this.fu=ll.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function wD(n,e,t=!0){const i=tS(n);let a;const l=i.Tu.get(e);return l?(i.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.lu()):a=await Q1(i,e,t,!0),a}async function xD(n,e){const t=tS(n);await Q1(t,e,!0,!1)}async function Q1(n,e,t,i){const a=await z4(n.localStore,Zs(e)),l=a.targetId,c=n.sharedClientState.addLocalQueryTarget(l,t);let d;return i&&(d=await TD(n,e,l,c==="current",a.resumeToken)),n.isPrimaryClient&&t&&V1(n.remoteStore,a),d}async function TD(n,e,t,i,a){n.pu=(b,x,S)=>(async function(j,k,L,H){let B=k.view.ru(L);B.Ss&&(B=await rx(j.localStore,k.query,!1).then((({documents:A})=>k.view.ru(A,B))));const K=H&&H.targetChanges.get(k.targetId),F=H&&H.targetMismatches.get(k.targetId)!=null,$=k.view.applyChanges(B,j.isPrimaryClient,K,F);return px(j,k.targetId,$.au),$.snapshot})(n,b,x,S);const l=await rx(n.localStore,e,!0),c=new yD(e,l.ks),d=c.ru(l.documents),p=yu.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",a),m=c.applyChanges(d,n.isPrimaryClient,p);px(n,t,m.au);const _=new vD(e,t,c);return n.Tu.set(e,_),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),m.snapshot}async function ED(n,e,t){const i=De(n),a=i.Tu.get(e),l=i.Iu.get(a.targetId);if(l.length>1)return i.Iu.set(a.targetId,l.filter((c=>!df(c,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(a.targetId),i.sharedClientState.isActiveQueryTarget(a.targetId)||await Im(i.localStore,a.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(a.targetId),t&&k0(i.remoteStore,a.targetId),jm(i,a.targetId)})).catch(fl)):(jm(i,a.targetId),await Im(i.localStore,a.targetId,!0))}async function SD(n,e){const t=De(n),i=t.Tu.get(e),a=t.Iu.get(i.targetId);t.isPrimaryClient&&a.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),k0(t.remoteStore,i.targetId))}async function AD(n,e,t){const i=jD(n);try{const a=await(function(c,d){const p=De(c),m=dt.now(),_=d.reduce(((S,N)=>S.add(N.key)),Fe());let b,x;return p.persistence.runTransaction("Locally write mutations","readwrite",(S=>{let N=Di(),j=Fe();return p.xs.getEntries(S,_).next((k=>{N=k,N.forEach(((L,H)=>{H.isValidDocument()||(j=j.add(L))}))})).next((()=>p.localDocuments.getOverlayedDocuments(S,N))).next((k=>{b=k;const L=[];for(const H of d){const B=Bj(H,b.get(H.key).overlayedDocument);B!=null&&L.push(new zr(H.key,B,t1(B.value.mapValue),ei.exists(!0)))}return p.mutationQueue.addMutationBatch(S,m,L,d)})).next((k=>{x=k;const L=k.applyToLocalDocumentSet(b,j);return p.documentOverlayCache.saveOverlays(S,k.batchId,L)}))})).then((()=>({batchId:x.batchId,changes:d1(b)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(a.batchId),(function(c,d,p){let m=c.du[c.currentUser.toKey()];m||(m=new yt(Ge)),m=m.insert(d,p),c.du[c.currentUser.toKey()]=m})(i,a.batchId,t),await _u(i,a.changes),await _f(i.remoteStore)}catch(a){const l=M0(a,"Failed to persist write");t.reject(l)}}async function J1(n,e){const t=De(n);try{const i=await U4(t.localStore,e);e.targetChanges.forEach(((a,l)=>{const c=t.Au.get(l);c&&(Ze(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?c.hu=!0:a.modifiedDocuments.size>0?Ze(c.hu,14607):a.removedDocuments.size>0&&(Ze(c.hu,42227),c.hu=!1))})),await _u(t,i,e)}catch(i){await fl(i)}}function gx(n,e,t){const i=De(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const a=[];i.Tu.forEach(((l,c)=>{const d=c.view.va(e);d.snapshot&&a.push(d.snapshot)})),(function(c,d){const p=De(c);p.onlineState=d;let m=!1;p.queries.forEach(((_,b)=>{for(const x of b.ba)x.va(d)&&(m=!0)})),m&&L0(p)})(i.eventManager,e),a.length&&i.Pu.J_(a),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function ND(n,e,t){const i=De(n);i.sharedClientState.updateQueryState(e,"rejected",t);const a=i.Au.get(e),l=a&&a.key;if(l){let c=new yt(Ee.comparator);c=c.insert(l,hn.newNoDocument(l,Oe.min()));const d=Fe().add(l),p=new mf(Oe.min(),new Map,new yt(Ge),c,d);await J1(i,p),i.Ru=i.Ru.remove(l),i.Au.delete(e),V0(i)}else await Im(i.localStore,e,!1).then((()=>jm(i,e,t))).catch(fl)}async function CD(n,e){const t=De(n),i=e.batch.batchId;try{const a=await L4(t.localStore,e);Z1(t,i,null),X1(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await _u(t,a)}catch(a){await fl(a)}}async function RD(n,e,t){const i=De(n);try{const a=await(function(c,d){const p=De(c);return p.persistence.runTransaction("Reject batch","readwrite-primary",(m=>{let _;return p.mutationQueue.lookupMutationBatch(m,d).next((b=>(Ze(b!==null,37113),_=b.keys(),p.mutationQueue.removeMutationBatch(m,b)))).next((()=>p.mutationQueue.performConsistencyCheck(m))).next((()=>p.documentOverlayCache.removeOverlaysForBatchId(m,_,d))).next((()=>p.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,_))).next((()=>p.localDocuments.getDocuments(m,_)))}))})(i.localStore,e);Z1(i,e,t),X1(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await _u(i,a)}catch(a){await fl(a)}}function X1(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function Z1(n,e,t){const i=De(n);let a=i.du[i.currentUser.toKey()];if(a){const l=a.get(e);l&&(t?l.reject(t):l.resolve(),a=a.remove(e)),i.du[i.currentUser.toKey()]=a}}function jm(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach((i=>{n.Vu.containsKey(i)||eS(n,i)}))}function eS(n,e){n.Eu.delete(e.path.canonicalString());const t=n.Ru.get(e);t!==null&&(k0(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),V0(n))}function px(n,e,t){for(const i of t)i instanceof Y1?(n.Vu.addReference(i.key,e),ID(n,i)):i instanceof W1?(ve(U0,"Document no longer in limbo: "+i.key),n.Vu.removeReference(i.key,e),n.Vu.containsKey(i.key)||eS(n,i.key)):Ie(19791,{wu:i})}function ID(n,e){const t=e.key,i=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(i)||(ve(U0,"New document in limbo: "+t),n.Eu.add(i),V0(n))}function V0(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Ee(ct.fromString(e)),i=n.fu.next();n.Au.set(i,new _D(t)),n.Ru=n.Ru.insert(t,i),V1(n.remoteStore,new Tr(Zs(x0(t.path)),i,"TargetPurposeLimboResolution",cf.ce))}}async function _u(n,e,t){const i=De(n),a=[],l=[],c=[];i.Tu.isEmpty()||(i.Tu.forEach(((d,p)=>{c.push(i.pu(p,e,t).then((m=>{var _;if((m||t)&&i.isPrimaryClient){const b=m?!m.fromCache:(_=t==null?void 0:t.targetChanges.get(p.targetId))==null?void 0:_.current;i.sharedClientState.updateQueryState(p.targetId,b?"current":"not-current")}if(m){a.push(m);const b=R0.Es(p.targetId,m);l.push(b)}})))})),await Promise.all(c),i.Pu.J_(a),await(async function(p,m){const _=De(p);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",(b=>oe.forEach(m,(x=>oe.forEach(x.Ts,(S=>_.persistence.referenceDelegate.addReference(b,x.targetId,S))).next((()=>oe.forEach(x.Is,(S=>_.persistence.referenceDelegate.removeReference(b,x.targetId,S)))))))))}catch(b){if(!gl(b))throw b;ve(I0,"Failed to update sequence numbers: "+b)}for(const b of m){const x=b.targetId;if(!b.fromCache){const S=_.vs.get(x),N=S.snapshotVersion,j=S.withLastLimboFreeSnapshotVersion(N);_.vs=_.vs.insert(x,j)}}})(i.localStore,l))}async function kD(n,e){const t=De(n);if(!t.currentUser.isEqual(e)){ve(U0,"User change. New user:",e.toKey());const i=await P1(t.localStore,e);t.currentUser=e,(function(l,c){l.mu.forEach((d=>{d.forEach((p=>{p.reject(new me(ae.CANCELLED,c))}))})),l.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await _u(t,i.Ns)}}function OD(n,e){const t=De(n),i=t.Au.get(e);if(i&&i.hu)return Fe().add(i.key);{let a=Fe();const l=t.Iu.get(e);if(!l)return a;for(const c of l){const d=t.Tu.get(c);a=a.unionWith(d.view.nu)}return a}}function tS(n){const e=De(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=J1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=OD.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=ND.bind(null,e),e.Pu.J_=pD.bind(null,e.eventManager),e.Pu.yu=mD.bind(null,e.eventManager),e}function jD(n){const e=De(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=CD.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=RD.bind(null,e),e}class $d{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=yf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return M4(this.persistence,new j4,e.initialUser,this.serializer)}Cu(e){return new D1(C0.Vi,this.serializer)}Du(e){return new q4}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}$d.provider={build:()=>new $d};class DD extends $d{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Ze(this.persistence.referenceDelegate instanceof Hd,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new v4(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Sn.withCacheSize(this.cacheSizeBytes):Sn.DEFAULT;return new D1((i=>Hd.Vi(i,t)),this.serializer)}}class Dm{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>gx(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=kD.bind(null,this.syncEngine),await dD(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new gD})()}createDatastore(e){const t=yf(e.databaseInfo.databaseId),i=Y4(e.databaseInfo);return Z4(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,a,l,c,d){return new tD(i,a,l,c,d)})(this.localStore,this.datastore,e.asyncQueue,(t=>gx(this.syncEngine,t,0)),(function(){return lx.v()?new lx:new $4})())}createSyncEngine(e,t){return(function(a,l,c,d,p,m,_){const b=new bD(a,l,c,d,p,m);return _&&(b.gu=!0),b})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(a){const l=De(a);ve(Ua,"RemoteStore shutting down."),l.Ea.add(5),await vu(l),l.Aa.shutdown(),l.Va.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}Dm.provider={build:()=>new Dm};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nS{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Oi("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mr="FirestoreClient";class PD{constructor(e,t,i,a,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=a,this.user=un.UNAUTHENTICATED,this.clientId=m0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(i,(async c=>{ve(Mr,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(i,(c=>(ve(Mr,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ri;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=M0(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Kp(n,e){n.asyncQueue.verifyOperationInProgress(),ve(Mr,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async a=>{i.isEqual(a)||(await P1(e.localStore,a),i=a)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function mx(n,e){n.asyncQueue.verifyOperationInProgress();const t=await MD(n);ve(Mr,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>ux(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,a)=>ux(e.remoteStore,a))),n._onlineComponents=e}async function MD(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ve(Mr,"Using user provided OfflineComponentProvider");try{await Kp(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(a){return a.name==="FirebaseError"?a.code===ae.FAILED_PRECONDITION||a.code===ae.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(t))throw t;il("Error using user provided cache. Falling back to memory cache: "+t),await Kp(n,new $d)}}else ve(Mr,"Using default OfflineComponentProvider"),await Kp(n,new DD(void 0));return n._offlineComponents}async function sS(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ve(Mr,"Using user provided OnlineComponentProvider"),await mx(n,n._uninitializedComponentsProvider._online)):(ve(Mr,"Using default OnlineComponentProvider"),await mx(n,new Dm))),n._onlineComponents}function LD(n){return sS(n).then((e=>e.syncEngine))}async function iS(n){const e=await sS(n),t=e.eventManager;return t.onListen=wD.bind(null,e.syncEngine),t.onUnlisten=ED.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=xD.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=SD.bind(null,e.syncEngine),t}function UD(n,e,t={}){const i=new Ri;return n.asyncQueue.enqueueAndForget((async()=>(function(l,c,d,p,m){const _=new nS({next:x=>{_.Nu(),c.enqueueAndForget((()=>F1(l,b)));const S=x.docs.has(d);!S&&x.fromCache?m.reject(new me(ae.UNAVAILABLE,"Failed to get document because the client is offline.")):S&&x.fromCache&&p&&p.source==="server"?m.reject(new me(ae.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(x)},error:x=>m.reject(x)}),b=new K1(x0(d.path),_,{includeMetadataChanges:!0,Ka:!0});return G1(l,b)})(await iS(n),n.asyncQueue,e,t,i))),i.promise}function VD(n,e,t={}){const i=new Ri;return n.asyncQueue.enqueueAndForget((async()=>(function(l,c,d,p,m){const _=new nS({next:x=>{_.Nu(),c.enqueueAndForget((()=>F1(l,b))),x.fromCache&&p.source==="server"?m.reject(new me(ae.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(x)},error:x=>m.reject(x)}),b=new K1(d,_,{includeMetadataChanges:!0,Ka:!0});return G1(l,b)})(await iS(n),n.asyncQueue,e,t,i))),i.promise}function BD(n,e){const t=new Ri;return n.asyncQueue.enqueueAndForget((async()=>AD(await LD(n),e,t))),t.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rS(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zD="ComponentProvider",yx=new Map;function HD(n,e,t,i,a){return new cj(n,e,t,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,rS(a.experimentalLongPollingOptions),a.useFetchStreams,a.isUsingEmulator,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aS="firestore.googleapis.com",vx=!0;class _x{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new me(ae.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=aS,this.ssl=vx}else this.host=e.host,this.ssl=e.ssl??vx;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=j1;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<m4)throw new me(ae.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}XO("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=rS(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new me(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new me(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new me(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,a){return i.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class bf{constructor(e,t,i,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new _x({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new me(ae.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new me(ae.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new _x(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new HO;switch(i.type){case"firstParty":return new FO(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new me(ae.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=yx.get(t);i&&(ve(zD,"Removing Datastore"),yx.delete(t),i.terminate())})(this),Promise.resolve()}}function qD(n,e,t,i={}){var m;n=ji(n,bf);const a=Ba(e),l=n._getSettings(),c={...l,emulatorOptions:n._getEmulatorOptions()},d=`${e}:${t}`;a&&(Qm(`https://${d}`),Jm("Firestore",!0)),l.host!==aS&&l.host!==d&&il("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const p={...l,host:d,ssl:a,emulatorOptions:i};if(!Ir(p,c)&&(n._setSettings(p),i.mockUserToken)){let _,b;if(typeof i.mockUserToken=="string")_=i.mockUserToken,b=un.MOCK_USER;else{_=AT(i.mockUserToken,(m=n._app)==null?void 0:m.options.projectId);const x=i.mockUserToken.sub||i.mockUserToken.user_id;if(!x)throw new me(ae.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");b=new un(x)}n._authCredentials=new qO(new qE(_,b))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ml{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new ml(this.firestore,e,this._query)}}class Nt{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Cr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Nt(this.firestore,e,this._key)}toJSON(){return{type:Nt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(gu(t,Nt._jsonSchema))return new Nt(e,i||null,new Ee(ct.fromString(t.referencePath)))}}Nt._jsonSchemaVersion="firestore/documentReference/1.0",Nt._jsonSchema={type:Bt("string",Nt._jsonSchemaVersion),referencePath:Bt("string")};class Cr extends ml{constructor(e,t,i){super(e,t,x0(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Nt(this.firestore,null,new Ee(e))}withConverter(e){return new Cr(this.firestore,e,this._path)}}function oS(n,e,...t){if(n=mt(n),$E("collection","path",e),n instanceof bf){const i=ct.fromString(e,...t);return Ow(i),new Cr(n,null,i)}{if(!(n instanceof Nt||n instanceof Cr))throw new me(ae.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(ct.fromString(e,...t));return Ow(i),new Cr(n.firestore,null,i)}}function Js(n,e,...t){if(n=mt(n),arguments.length===1&&(e=m0.newId()),$E("doc","path",e),n instanceof bf){const i=ct.fromString(e,...t);return kw(i),new Nt(n,null,new Ee(i))}{if(!(n instanceof Nt||n instanceof Cr))throw new me(ae.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(ct.fromString(e,...t));return kw(i),new Nt(n.firestore,n instanceof Cr?n.converter:null,new Ee(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bx="AsyncQueue";class wx{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new L1(this,"async_queue_retry"),this._c=()=>{const i=Fp();i&&ve(bx,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Fp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Fp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Ri;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!gl(e))throw e;ve(bx,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Oi("INTERNAL UNHANDLED ERROR: ",xx(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const a=P0.createAndSchedule(this,e,t,i,(l=>this.hc(l)));return this.tc.push(a),a}uc(){this.nc&&Ie(47125,{Pc:xx(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function xx(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class bu extends bf{constructor(e,t,i,a){super(e,t,i,a),this.type="firestore",this._queue=new wx,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new wx(e),this._firestoreClient=void 0,await e}}}function $D(n,e){const t=typeof n=="object"?n:tf(),i=typeof n=="string"?n:Pd,a=Lr(t,"firestore").getImmediate({identifier:i});if(!a._initialized){const l=TT("firestore");l&&qD(a,...l)}return a}function B0(n){if(n._terminated)throw new me(ae.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||GD(n),n._firestoreClient}function GD(n){var i,a,l,c;const e=n._freezeSettings(),t=HD(n._databaseId,((i=n._app)==null?void 0:i.options.appId)||"",n._persistenceKey,(a=n._app)==null?void 0:a.options.apiKey,e);n._componentsProvider||(l=e.localCache)!=null&&l._offlineComponentProvider&&((c=e.localCache)!=null&&c._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new PD(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(p){const m=p==null?void 0:p._online.build();return{_offline:p==null?void 0:p._offline.build(m),_online:m}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ts(on.fromBase64String(e))}catch(t){throw new me(ae.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ts(on.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ts._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(gu(e,ts._jsonSchema))return ts.fromBase64String(e.bytes)}}ts._jsonSchemaVersion="firestore/bytes/1.0",ts._jsonSchema={type:Bt("string",ts._jsonSchemaVersion),bytes:Bt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z0{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new me(ae.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new an(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H0{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new me(ae.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new me(ae.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ge(this._lat,e._lat)||Ge(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ni._jsonSchemaVersion}}static fromJSON(e){if(gu(e,ni._jsonSchema))return new ni(e.latitude,e.longitude)}}ni._jsonSchemaVersion="firestore/geoPoint/1.0",ni._jsonSchema={type:Bt("string",ni._jsonSchemaVersion),latitude:Bt("number"),longitude:Bt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,a){if(i.length!==a.length)return!1;for(let l=0;l<i.length;++l)if(i[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Ts._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(gu(e,Ts._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Ts(e.vectorValues);throw new me(ae.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Ts._jsonSchemaVersion="firestore/vectorValue/1.0",Ts._jsonSchema={type:Bt("string",Ts._jsonSchemaVersion),vectorValues:Bt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FD=/^__.*__$/;class KD{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new zr(e,this.data,this.fieldMask,t,this.fieldTransforms):new mu(e,this.data,t,this.fieldTransforms)}}class lS{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new zr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function cS(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ie(40011,{dataSource:n})}}class q0{constructor(e,t,i,a,l,c){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=a,l===void 0&&this.validatePath(),this.fieldTransforms=l||[],this.fieldMask=c||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new q0({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){var a;const t=(a=this.path)==null?void 0:a.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){var a;const t=(a=this.path)==null?void 0:a.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Gd(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(cS(this.dataSource)&&FD.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class YD{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||yf(e)}createContext(e,t,i,a=!1){return new q0({dataSource:e,methodName:t,targetDoc:i,path:an.emptyPath(),arrayElement:!1,hasConverter:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function $0(n){const e=n._freezeSettings(),t=yf(n._databaseId);return new YD(n._databaseId,!!e.ignoreUndefinedProperties,t)}function WD(n,e,t,i,a,l={}){const c=n.createContext(l.merge||l.mergeFields?2:0,e,t,a);G0("Data must be an object, but it was:",c,i);const d=uS(i,c);let p,m;if(l.merge)p=new Bn(c.fieldMask),m=c.fieldTransforms;else if(l.mergeFields){const _=[];for(const b of l.mergeFields){const x=ul(e,b,t);if(!c.contains(x))throw new me(ae.INVALID_ARGUMENT,`Field '${x}' is specified in your field mask but missing from your input data.`);fS(_,x)||_.push(x)}p=new Bn(_),m=c.fieldTransforms.filter((b=>p.covers(b.field)))}else p=null,m=c.fieldTransforms;return new KD(new Nn(d),p,m)}class wf extends H0{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof wf}}function QD(n,e,t,i){const a=n.createContext(1,e,t);G0("Data must be an object, but it was:",a,i);const l=[],c=Nn.empty();Br(i,((p,m)=>{const _=dS(e,p,t);m=mt(m);const b=a.childContextForFieldPath(_);if(m instanceof wf)l.push(_);else{const x=wu(m,b);x!=null&&(l.push(_),c.set(_,x))}}));const d=new Bn(l);return new lS(c,d,a.fieldTransforms)}function JD(n,e,t,i,a,l){const c=n.createContext(1,e,t),d=[ul(e,i,t)],p=[a];if(l.length%2!=0)throw new me(ae.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let x=0;x<l.length;x+=2)d.push(ul(e,l[x])),p.push(l[x+1]);const m=[],_=Nn.empty();for(let x=d.length-1;x>=0;--x)if(!fS(m,d[x])){const S=d[x];let N=p[x];N=mt(N);const j=c.childContextForFieldPath(S);if(N instanceof wf)m.push(S);else{const k=wu(N,j);k!=null&&(m.push(S),_.set(S,k))}}const b=new Bn(m);return new lS(_,b,c.fieldTransforms)}function XD(n,e,t,i=!1){return wu(t,n.createContext(i?4:3,e))}function wu(n,e){if(hS(n=mt(n)))return G0("Unsupported field value:",e,n),uS(n,e);if(n instanceof H0)return(function(i,a){if(!cS(a.dataSource))throw a.createError(`${i._methodName}() can only be used with update() and set()`);if(!a.path)throw a.createError(`${i._methodName}() is not currently supported inside arrays`);const l=i._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,a){const l=[];let c=0;for(const d of i){let p=wu(d,a.childContextForArray(c));p==null&&(p={nullValue:"NULL_VALUE"}),l.push(p),c++}return{arrayValue:{values:l}}})(n,e)}return(function(i,a){if((i=mt(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return Dj(a.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const l=dt.fromDate(i);return{timestampValue:zd(a.serializer,l)}}if(i instanceof dt){const l=new dt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:zd(a.serializer,l)}}if(i instanceof ni)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof ts)return{bytesValue:S1(a.serializer,i._byteString)};if(i instanceof Nt){const l=a.databaseId,c=i.firestore._databaseId;if(!c.isEqual(l))throw a.createError(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:A0(i.firestore._databaseId||a.databaseId,i._key.path)}}if(i instanceof Ts)return(function(c,d){const p=c instanceof Ts?c.toArray():c;return{mapValue:{fields:{[ZE]:{stringValue:e1},[Md]:{arrayValue:{values:p.map((_=>{if(typeof _!="number")throw d.createError("VectorValues must only contain numeric values.");return T0(d.serializer,_)}))}}}}}})(i,a);if(O1(i))return i._toProto(a.serializer);throw a.createError(`Unsupported field value: ${lf(i)}`)})(n,e)}function uS(n,e){const t={};return KE(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Br(n,((i,a)=>{const l=wu(a,e.childContextForField(i));l!=null&&(t[i]=l)})),{mapValue:{fields:t}}}function hS(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof dt||n instanceof ni||n instanceof ts||n instanceof Nt||n instanceof H0||n instanceof Ts||O1(n))}function G0(n,e,t){if(!hS(t)||!GE(t)){const i=lf(t);throw i==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+i)}}function ul(n,e,t){if((e=mt(e))instanceof z0)return e._internalPath;if(typeof e=="string")return dS(n,e);throw Gd("Field path arguments must be of type string or ",n,!1,void 0,t)}const ZD=new RegExp("[~\\*/\\[\\]]");function dS(n,e,t){if(e.search(ZD)>=0)throw Gd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new z0(...e.split("."))._internalPath}catch{throw Gd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Gd(n,e,t,i,a){const l=i&&!i.isEmpty(),c=a!==void 0;let d=`Function ${e}() called with invalid data`;t&&(d+=" (via `toFirestore()`)"),d+=". ";let p="";return(l||c)&&(p+=" (found",l&&(p+=` in field ${i}`),c&&(p+=` in document ${a}`),p+=")"),new me(ae.INVALID_ARGUMENT,d+n+p)}function fS(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eP{convertValue(e,t="none"){switch(Dr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return At(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(jr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ie(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return Br(e,((a,l)=>{i[a]=this.convertValue(l,t)})),i}convertVectorValue(e){var i,a,l;const t=(l=(a=(i=e.fields)==null?void 0:i[Md].arrayValue)==null?void 0:a.values)==null?void 0:l.map((c=>At(c.doubleValue)));return new Ts(t)}convertGeoPoint(e){return new ni(At(e.latitude),At(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=hf(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Jc(e));default:return null}}convertTimestamp(e){const t=Or(e);return new dt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=ct.fromString(e);Ze(k1(i),9688,{name:e});const a=new Xc(i.get(1),i.get(3)),l=new Ee(i.popFirst(5));return a.isEqual(t)||Oi(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gS extends eP{constructor(e){super(),this.firestore=e}convertBytes(e){return new ts(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Nt(this.firestore,null,t)}}const Tx="@firebase/firestore",Ex="4.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pS{constructor(e,t,i,a,l){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new Nt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new tP(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){var e;return((e=this._document)==null?void 0:e.data.clone().value.mapValue.fields)??void 0}get(e){if(this._document){const t=this._document.data.field(ul("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class tP extends pS{data(){return super.data()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nP(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new me(ae.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class F0{}class sP extends F0{}function Sx(n,e,...t){let i=[];e instanceof F0&&i.push(e),i=i.concat(t),(function(l){const c=l.filter((p=>p instanceof K0)).length,d=l.filter((p=>p instanceof xf)).length;if(c>1||c>0&&d>0)throw new me(ae.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const a of i)n=a._apply(n);return n}class xf extends sP{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new xf(e,t,i)}_apply(e){const t=this._parse(e);return mS(e._query,t),new ml(e.firestore,e.converter,Em(e._query,t))}_parse(e){const t=$0(e.firestore);return(function(l,c,d,p,m,_,b){let x;if(m.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new me(ae.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){Cx(b,_);const N=[];for(const j of b)N.push(Nx(p,l,j));x={arrayValue:{values:N}}}else x=Nx(p,l,b)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||Cx(b,_),x=XD(d,c,b,_==="in"||_==="not-in");return Vt.create(m,_,x)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Ax(n,e,t){const i=e,a=ul("where",n);return xf._create(a,i,t)}class K0 extends F0{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new K0(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:Ss.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(a,l){let c=a;const d=l.getFlattenedFilters();for(const p of d)mS(c,p),c=Em(c,p)})(e._query,t),new ml(e.firestore,e.converter,Em(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Nx(n,e,t){if(typeof(t=mt(t))=="string"){if(t==="")throw new me(ae.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!l1(e)&&t.indexOf("/")!==-1)throw new me(ae.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(ct.fromString(t));if(!Ee.isDocumentKey(i))throw new me(ae.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Bw(n,new Ee(i))}if(t instanceof Nt)return Bw(n,t._key);throw new me(ae.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${lf(t)}.`)}function Cx(n,e){if(!Array.isArray(n)||n.length===0)throw new me(ae.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function mS(n,e){const t=(function(a,l){for(const c of a)for(const d of c.getFlattenedFilters())if(l.indexOf(d.op)>=0)return d.op;return null})(n.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new me(ae.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new me(ae.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function iP(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class jc{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ka extends pS{constructor(e,t,i,a,l,c){super(e,t,i,a,c),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Td(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(ul("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new me(ae.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=ka._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}ka._jsonSchemaVersion="firestore/documentSnapshot/1.0",ka._jsonSchema={type:Bt("string",ka._jsonSchemaVersion),bundleSource:Bt("string","DocumentSnapshot"),bundleName:Bt("string"),bundle:Bt("string")};class Td extends ka{data(e={}){return super.data(e)}}class tl{constructor(e,t,i,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new jc(a.hasPendingWrites,a.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Td(this._firestore,this._userDataWriter,i.key,i,new jc(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new me(ae.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let c=0;return a._snapshot.docChanges.map((d=>{const p=new Td(a._firestore,a._userDataWriter,d.doc.key,d.doc,new jc(a._snapshot.mutatedKeys.has(d.doc.key),a._snapshot.fromCache),a.query.converter);return d.doc,{type:"added",doc:p,oldIndex:-1,newIndex:c++}}))}{let c=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((d=>l||d.type!==3)).map((d=>{const p=new Td(a._firestore,a._userDataWriter,d.doc.key,d.doc,new jc(a._snapshot.mutatedKeys.has(d.doc.key),a._snapshot.fromCache),a.query.converter);let m=-1,_=-1;return d.type!==0&&(m=c.indexOf(d.doc.key),c=c.delete(d.doc.key)),d.type!==1&&(c=c.add(d.doc),_=c.indexOf(d.doc.key)),{type:rP(d.type),doc:p,oldIndex:m,newIndex:_}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new me(ae.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=tl._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=m0.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),i.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function rP(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ie(61501,{type:n})}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */tl._jsonSchemaVersion="firestore/querySnapshot/1.0",tl._jsonSchema={type:Bt("string",tl._jsonSchemaVersion),bundleSource:Bt("string","QuerySnapshot"),bundleName:Bt("string"),bundle:Bt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pm(n){n=ji(n,Nt);const e=ji(n.firestore,bu),t=B0(e);return UD(t,n._key).then((i=>aP(e,n,i)))}function Mm(n){n=ji(n,ml);const e=ji(n.firestore,bu),t=B0(e),i=new gS(e);return nP(n._query),VD(t,n._query).then((a=>new tl(e,i,n,a)))}function Fd(n,e,t){n=ji(n,Nt);const i=ji(n.firestore,bu),a=iP(n.converter,e,t),l=$0(i);return yS(i,[WD(l,"setDoc",n._key,a,n.converter!==null,t).toMutation(n._key,ei.none())])}function Lm(n,e,t,...i){n=ji(n,Nt);const a=ji(n.firestore,bu),l=$0(a);let c;return c=typeof(e=mt(e))=="string"||e instanceof z0?JD(l,"updateDoc",n._key,e,t,i):QD(l,"updateDoc",n._key,e),yS(a,[c.toMutation(n._key,ei.exists(!0))])}function yS(n,e){const t=B0(n);return BD(t,e)}function aP(n,e,t){const i=t.docs.get(e._key),a=new gS(n);return new ka(n,a,e._key,i,new jc(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){zO(Ha),Es(new ss("firestore",((i,{instanceIdentifier:a,options:l})=>{const c=i.getProvider("app").getImmediate(),d=new bu(new $O(i.getProvider("auth-internal")),new KO(c,i.getProvider("app-check-internal")),uj(c,a),c);return l={useFetchStreams:t,...l},d._setSettings(l),d}),"PUBLIC").setMultipleInstances(!0)),Cn(Tx,Ex,e),Cn(Tx,Ex,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vS="firebasestorage.googleapis.com",oP="storageBucket",lP=120*1e3,cP=600*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Hr=class _S extends rs{constructor(e,t,i=0){super(Yp(e),`Firebase Storage: ${t} (${Yp(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,_S.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Yp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}};var ii;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ii||(ii={}));function Yp(n){return"storage/"+n}function uP(){const n="An unknown error occurred, please check the error payload for server response.";return new Hr(ii.UNKNOWN,n)}function hP(){return new Hr(ii.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function dP(){return new Hr(ii.CANCELED,"User canceled the upload/download.")}function fP(n){return new Hr(ii.INVALID_URL,"Invalid URL '"+n+"'.")}function gP(n){return new Hr(ii.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function Rx(n){return new Hr(ii.INVALID_ARGUMENT,n)}function bS(){return new Hr(ii.APP_DELETED,"The Firebase app was deleted.")}function pP(n){return new Hr(ii.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=ws.makeFromUrl(e,t)}catch{return new ws(e,"")}if(i.path==="")return i;throw gP(e)}static makeFromUrl(e,t){let i=null;const a="([A-Za-z0-9.\\-_]+)";function l(K){K.path.charAt(K.path.length-1)==="/"&&(K.path_=K.path_.slice(0,-1))}const c="(/(.*))?$",d=new RegExp("^gs://"+a+c,"i"),p={bucket:1,path:3};function m(K){K.path_=decodeURIComponent(K.path)}const _="v[A-Za-z0-9_]+",b=t.replace(/[.]/g,"\\."),x="(/([^?#]*).*)?$",S=new RegExp(`^https?://${b}/${_}/b/${a}/o${x}`,"i"),N={bucket:1,path:3},j=t===vS?"(?:storage.googleapis.com|storage.cloud.google.com)":t,k="([^?#]*)",L=new RegExp(`^https?://${j}/${a}/${k}`,"i"),B=[{regex:d,indices:p,postModify:l},{regex:S,indices:N,postModify:m},{regex:L,indices:{bucket:1,path:2},postModify:m}];for(let K=0;K<B.length;K++){const F=B[K],$=F.regex.exec(e);if($){const A=$[F.indices.bucket];let C=$[F.indices.path];C||(C=""),i=new ws(A,C),F.postModify(i);break}}if(i==null)throw fP(e);return i}}class mP{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yP(n,e,t){let i=1,a=null,l=null,c=!1,d=0;function p(){return d===2}let m=!1;function _(...k){m||(m=!0,e.apply(null,k))}function b(k){a=setTimeout(()=>{a=null,n(S,p())},k)}function x(){l&&clearTimeout(l)}function S(k,...L){if(m){x();return}if(k){x(),_.call(null,k,...L);return}if(p()||c){x(),_.call(null,k,...L);return}i<64&&(i*=2);let B;d===1?(d=2,B=0):B=(i+Math.random())*1e3,b(B)}let N=!1;function j(k){N||(N=!0,x(),!m&&(a!==null?(k||(d=2),clearTimeout(a),b(0)):k||(d=1)))}return b(0),l=setTimeout(()=>{c=!0,j(!0)},t),j}function vP(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _P(n){return n!==void 0}function Ix(n,e,t,i){if(i<e)throw Rx(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw Rx(`Invalid value for '${n}'. Expected ${t} or less.`)}function bP(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const a=e(i)+"="+e(n[i]);t=t+a+"&"}return t=t.slice(0,-1),t}var Kd;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Kd||(Kd={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wP(n,e){const t=n>=500&&n<600,a=[408,429].indexOf(n)!==-1,l=e.indexOf(n)!==-1;return t||a||l}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xP{constructor(e,t,i,a,l,c,d,p,m,_,b,x=!0,S=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=a,this.successCodes_=l,this.additionalRetryCodes_=c,this.callback_=d,this.errorCallback_=p,this.timeout_=m,this.progressCallback_=_,this.connectionFactory_=b,this.retry=x,this.isUsingEmulator=S,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((N,j)=>{this.resolve_=N,this.reject_=j,this.start_()})}start_(){const e=(i,a)=>{if(a){i(!1,new rd(!1,null,!0));return}const l=this.connectionFactory_();this.pendingConnection_=l;const c=d=>{const p=d.loaded,m=d.lengthComputable?d.total:-1;this.progressCallback_!==null&&this.progressCallback_(p,m)};this.progressCallback_!==null&&l.addUploadProgressListener(c),l.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&l.removeUploadProgressListener(c),this.pendingConnection_=null;const d=l.getErrorCode()===Kd.NO_ERROR,p=l.getStatus();if(!d||wP(p,this.additionalRetryCodes_)&&this.retry){const _=l.getErrorCode()===Kd.ABORT;i(!1,new rd(!1,null,_));return}const m=this.successCodes_.indexOf(p)!==-1;i(!0,new rd(m,l))})},t=(i,a)=>{const l=this.resolve_,c=this.reject_,d=a.connection;if(a.wasSuccessCode)try{const p=this.callback_(d,d.getResponse());_P(p)?l(p):l()}catch(p){c(p)}else if(d!==null){const p=uP();p.serverResponse=d.getErrorText(),this.errorCallback_?c(this.errorCallback_(d,p)):c(p)}else if(a.canceled){const p=this.appDelete_?bS():dP();c(p)}else{const p=hP();c(p)}};this.canceled_?t(!1,new rd(!1,null,!0)):this.backoffId_=yP(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&vP(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class rd{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function TP(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function EP(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function SP(n,e){e&&(n["X-Firebase-GMPID"]=e)}function AP(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function NP(n,e,t,i,a,l,c=!0,d=!1){const p=bP(n.urlParams),m=n.url+p,_=Object.assign({},n.headers);return SP(_,e),TP(_,t),EP(_,l),AP(_,i),new xP(m,n.method,_,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,a,c,d)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CP(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function RP(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yd{constructor(e,t){this._service=e,t instanceof ws?this._location=t:this._location=ws.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Yd(e,t)}get root(){const e=new ws(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return RP(this._location.path)}get storage(){return this._service}get parent(){const e=CP(this._location.path);if(e===null)return null;const t=new ws(this._location.bucket,e);return new Yd(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw pP(e)}}function kx(n,e){const t=e==null?void 0:e[oP];return t==null?null:ws.makeFromBucketSpec(t,n)}function IP(n,e,t,i={}){n.host=`${e}:${t}`;const a=Ba(e);a&&(Qm(`https://${n.host}/b`),Jm("Storage",!0)),n._isUsingEmulator=!0,n._protocol=a?"https":"http";const{mockUserToken:l}=i;l&&(n._overrideAuthToken=typeof l=="string"?l:AT(l,n.app.options.projectId))}class kP{constructor(e,t,i,a,l,c=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=a,this._firebaseVersion=l,this._isUsingEmulator=c,this._bucket=null,this._host=vS,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=lP,this._maxUploadRetryTime=cP,this._requests=new Set,a!=null?this._bucket=ws.makeFromBucketSpec(a,this._host):this._bucket=kx(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=ws.makeFromBucketSpec(this._url,e):this._bucket=kx(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Ix("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Ix("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(An(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Yd(this,e)}_makeRequest(e,t,i,a,l=!0){if(this._deleted)return new mP(bS());{const c=NP(e,this._appId,i,a,t,this._firebaseVersion,l,this._isUsingEmulator);return this._requests.add(c),c.getPromise().then(()=>this._requests.delete(c),()=>this._requests.delete(c)),c}}async makeRequestWithTokens(e,t){const[i,a]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,a).getPromise()}}const Ox="@firebase/storage",jx="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wS="storage";function OP(n=tf(),e){n=mt(n);const i=Lr(n,wS).getImmediate({identifier:e}),a=TT("storage");return a&&jP(i,...a),i}function jP(n,e,t,i={}){IP(n,e,t,i)}function DP(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),a=n.getProvider("app-check-internal");return new kP(t,i,a,e,Ha)}function PP(){Es(new ss(wS,DP,"PUBLIC").setMultipleInstances(!0)),Cn(Ox,jx,""),Cn(Ox,jx,"esm2020")}PP();const MP={apiKey:"AIzaSyAGphhC3qC1qLA_ErvpWk9QAaHc0N3ovQM",authDomain:"appaistudio-55b77.firebaseapp.com",projectId:"appaistudio-55b77",storageBucket:"appaistudio-55b77.firebasestorage.app",messagingSenderId:"98616437820",appId:"1:98616437820:web:10b78e2f4718d35b3ee739",measurementId:"G-Q8Q00T026N"},Tf=jT(MP);vI(Tf);const Dc=VO(Tf),ns=$D(Tf);OP(Tf);const Rr={registerUser:async(n,e,t,i,a="user")=>{try{const l=oS(ns,"users"),c=Sx(l,Ax("username","==",t));if(!(await Mm(c)).empty)throw new Error("Tn hin th  tn ti. Vui lng chn tn khc.");const p=Sx(l,Ax("phone","==",i));if(!(await Mm(p)).empty)throw new Error("S in thoi  c ng k bi ti khon khc.");const b=(await wk(Dc,n,e)).user;await Ek(b,{displayName:t});let x="user";a==="admin"&&(x=a);let S=["video-viral","image-script","zenshot-ai","translation"];const N={id:b.uid,username:t,email:n,phone:i,role:x,allowedApps:S,createdAt:Date.now()};return await Fd(Js(ns,"users",b.uid),N),N}catch(l){throw console.error("Firebase Registration Error:",l),l.code==="auth/email-already-in-use"?new Error("Email ny  c ng k."):l}},loginUser:async(n,e)=>{try{const i=(await xk(Dc,n,e)).user,a=await Rr.getUserProfile(i.uid);return a||{id:i.uid,username:i.displayName||n.split("@")[0],email:n,phone:"",role:"user",allowedApps:[],createdAt:Date.now()}}catch(t){throw console.error("Firebase Login Error:",t),t}},loginWithGoogle:async()=>{var n;try{const e=new Si,i=(await Yk(Dc,e)).user;let a=await Rr.getUserProfile(i.uid);return a||(a={id:i.uid,username:i.displayName||((n=i.email)==null?void 0:n.split("@")[0])||"Google User",email:i.email||"",phone:i.phoneNumber||"",role:"user",allowedApps:["video-viral","image-script","zenshot-ai","translation"],createdAt:Date.now()},await Fd(Js(ns,"users",i.uid),a)),a}catch(e){throw console.error("Google Login Error:",e),e}},getUserProfile:async n=>{try{const e=Js(ns,"users",n),t=await Pm(e);return t.exists()?t.data():(console.warn("No such document!"),null)}catch(e){return console.error("Error getting user profile:",e),null}},logoutUser:async()=>{try{await Ck(Dc)}catch(n){throw console.error("Logout Error:",n),n}},updateProfile:async(n,e)=>{try{const t=Js(ns,"users",n);await Lm(t,e)}catch(t){throw console.error("Update Profile Error:",t),t}}},LP=({onLogin:n})=>{const[e,t]=le.useState(!1),[i,a]=le.useState(""),[l,c]=le.useState(""),[d,p]=le.useState(""),[m,_]=le.useState(""),[b,x]=le.useState(""),[S,N]=le.useState(""),[j,k]=le.useState(!1),L=Gc.useRef(!0);Gc.useEffect(()=>(L.current=!0,()=>{L.current=!1}),[]);const H=async()=>{if(N(""),k(!0),!m||!l){N("Vui lng nhp Email v Mt khu"),k(!1);return}try{console.log("Starting Auth...");const B=new Promise((F,$)=>setTimeout(()=>$(new Error("Request timed out (15s)")),15e3));let K;if(e){if(!i||!b){N("Vui lng nhp y  Tn v ST"),k(!1);return}if(l!==d){N("Mt khu nhp li khng khp"),k(!1);return}K=await Promise.race([Rr.registerUser(m,l,i,b),B])}else K=await Promise.race([Rr.loginUser(m,l),B]);console.log("Auth Success:",K),n(K)}catch(B){if(console.error(B),B.message.includes("timed out"))N("Mng qu chm hoc b chn. Vui lng th li!"),alert("Li: Qu thi gian ch (Timeout). Kim tra kt ni mng.");else if(B.code==="auth/email-already-in-use")N("Email ny  c ng k. Vui lng s dng Email khc hoc ng nhp.");else if(B.message.includes("Tn hin th  tn ti"))N("Tn hin th ny  tn ti. Vui lng chn tn khc.");else if(B.message.includes("S in thoi  c ng k"))N("S in thoi ny  c ng k. Vui lng s dng s khc.");else if(B.code==="auth/invalid-email")N("a ch Email khng hp l (V d: ten@gmail.com).");else if(B.code==="auth/wrong-password"||B.code==="auth/user-not-found")N("Ti khon hoc mt khu khng chnh xc.");else if(B.code==="auth/too-many-requests")N("Qu nhiu ln th ng nhp sai. Vui lng th li sau t pht.");else if(B.code==="auth/network-request-failed")N("Li kt ni mng. Vui lng kim tra ng truyn.");else if(B.code==="auth/unauthorized-domain")N("Tn min trang web cha c cp php trong Firebase Auth (Authorized Domains).");else{let K=B.message||"Li khng xc nh";K.includes("Missing or insufficient permissions")?K="Li quyn truy cp h thng (Firestore). Vui lng bo Admin kim tra Security Rules.":K.includes("quota")?K="H thng qu ti (Quota Exceeded).":K.includes("internal")&&(K="Li ni b h thng (Internal Error)."),N("Li: "+K),!K.includes(" c ngi dng")&&!K.includes("Email ny  c s dng")&&alert("Thng bo t h thng: "+K)}}finally{L.current&&k(!1)}};return f.jsx("div",{className:"min-h-screen bg-[#020617] flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-[#1e293b] p-8 rounded-2xl shadow-xl w-full max-w-md border border-white/10",children:[f.jsx("h2",{className:"text-2xl font-bold text-white mb-6 text-center",children:e?"ng K Ti Khon":"ng Nhp"}),f.jsxs("div",{className:"space-y-4",children:[e&&f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400 mb-2",children:"Tn hin th"}),f.jsx("input",{type:"text",value:i,onChange:B=>a(B.target.value),className:"w-full bg-[#0f172a] border border-slate-700 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 outline-none"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400 mb-2",children:"Email"}),f.jsx("input",{type:"email",value:m,onChange:B=>_(B.target.value),className:"w-full bg-[#0f172a] border border-slate-700 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 outline-none"})]}),e&&f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400 mb-2",children:"S in thoi"}),f.jsx("input",{type:"tel",value:b,onChange:B=>x(B.target.value),className:"w-full bg-[#0f172a] border border-slate-700 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 outline-none"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400 mb-2",children:"Mt khu"}),f.jsx("input",{type:"password",value:l,onChange:B=>c(B.target.value),className:"w-full bg-[#0f172a] border border-slate-700 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 outline-none"})]}),e&&f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400 mb-2",children:"Nhp li mt khu"}),f.jsx("input",{type:"password",value:d,onChange:B=>p(B.target.value),className:"w-full bg-[#0f172a] border border-slate-700 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 outline-none"})]}),S&&f.jsx("p",{className:"text-red-400 text-sm text-center",children:S}),f.jsx("button",{onClick:H,disabled:j,className:`w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 rounded-lg transition-colors mt-4 ${j?"opacity-50 cursor-not-allowed":""}`,children:j?"ang x l...":e?"ng K":"ng Nhp"}),f.jsxs("div",{className:"relative flex py-2 items-center",children:[f.jsx("div",{className:"flex-grow border-t border-white/10"}),f.jsx("span",{className:"flex-shrink-0 mx-4 text-slate-500 text-xs uppercase",children:"Hoc"}),f.jsx("div",{className:"flex-grow border-t border-white/10"})]}),f.jsxs("button",{onClick:async()=>{N(""),k(!0);try{const B=await Rr.loginWithGoogle();n(B)}catch(B){console.error(B),B.code==="auth/popup-closed-by-user"?N("Bn  hy ng nhp Google."):N("Li ng nhp Google: "+B.message)}finally{L.current&&k(!1)}},disabled:j,className:"w-full bg-white text-slate-900 hover:bg-slate-100 font-bold py-3 rounded-lg transition-colors flex items-center justify-center gap-2",children:[f.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[f.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),f.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),f.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),f.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Tip tc vi Google"]}),f.jsx("p",{className:"text-center text-slate-400 text-sm mt-4 cursor-pointer hover:text-white",onClick:()=>t(!e),children:e?" c ti khon? ng nhp ngay":"Cha c ti khon? ng k mi"}),f.jsx("div",{className:"mt-6 pt-4 border-t border-white/5 text-center",children:f.jsx("span",{className:"text-[10px] uppercase font-black tracking-widest text-orange-500/50",children:"System: Firebase V2 (Fast) + Supabase Storage"})})]}),f.jsxs("div",{className:"mt-8 pt-6 border-t border-white/10 text-center",children:[f.jsx("p",{className:"text-slate-500 text-xs mb-3",children:"Gp s c ng nhp?"}),f.jsx("button",{onClick:()=>{window.confirm("Thao tc ny s xa ton b d liu tm (Cache/Storage) v ti li trang. Bn c chc chn?")&&(localStorage.clear(),sessionStorage.clear(),window.location.reload())},className:"text-xs font-bold text-slate-400 hover:text-red-400 uppercase tracking-wider underline decoration-slate-700 hover:decoration-red-400 underline-offset-4 transition-all",children:"Xa Cache & Ti Li App"}),f.jsx("div",{className:"mt-2 text-[10px] text-slate-600",children:'S dng khi b li "Timeout" hoc treo logo'})]})]})})},ad=[{id:"Cinematic Realistic",label:"Cinematic High-End Realistic (in nh thc t cao cp)"},{id:"3D Pixar Animation",label:"3D Pixar/Disney Style Animation (Hot hnh 3D Pixar/Disney)"},{id:"Japanese Anime 90s",label:"Classic 90s Japanese Anime (Hot hnh Nht Bn thp nin 90)"},{id:"Modern Makoto Shinkai",label:"Makoto Shinkai Cinematic Style (Phong cch Makoto Shinkai hin i)"},{id:"Studio Ghibli Aesthetic",label:"Studio Ghibli Hand-painted Aesthetic (Phong cch v tay Ghibli)"},{id:"Cyberpunk Neon 2077",label:"Cyberpunk Neon / Sci-Fi Futurism (Tng lai vin tng Neon)"},{id:"Hyper-realistic 8K Photo",label:"Hyper-realistic 8K RAW Photography (Nhip nh siu thc 8K)"},{id:"Spider-Verse Vibrant Comic",label:"Into the Spider-Verse Vibrant Comic (Truyn tranh phong cch Spider-Verse)"},{id:"Vintage 16mm Film",label:"Vintage 16mm Grainy Film Style (Phim nha 16mm c in)"},{id:"Noir Black and White",label:"Classic Film Noir / Moody Black & White (Phim en trng Noir su lng)"},{id:"Oil Painting Impressionism",label:"Classic Oil Painting / Impressionist Art (Tranh sn du n tng)"},{id:"Lo-fi Aesthetic Retro",label:"Lo-fi / Vaporwave Retro Aesthetic (Phong cch Lo-fi c in)"},{id:"Claymation Stop Motion",label:"Claymation Claymation Style (Hot hnh t st)"},{id:"Minimalist Vector Art",label:"Clean Minimalist Vector Illustration (Minh ha Vector ti gin)"},{id:"Dark Fantasy Gothic",label:"Dark Fantasy / Gothic Horror Style (Gi tng en ti / Gothic)"},{id:"Ukiyo-e Woodblock",label:"Traditional Japanese Ukiyo-e Woodblock (Tranh khc g Nht Bn)"},{id:"Surrealist Dreamscape",label:"Surrealist / Dreamlike Visual Art (Ngh thut siu thc o mng)"},{id:"Paper Cutout Collage",label:"Hand-crafted Paper Cutout Collage (Ct dn giy th cng)"},{id:"Sketch Graphite Art",label:"Detailed Graphite Pencil Sketch (Phc tho bt ch chi tit)"},{id:"Glitch Art Digital",label:"Experimental Glitch Art / Digital Distortion (Ngh thut li k thut s)"}];let UP=class extends le.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("ErrorBoundary caught error:",e,t)}render(){var e;return this.state.hasError?f.jsxs("div",{className:"p-8 m-8 bg-slate-900 border border-slate-700 rounded-3xl space-y-4 text-center text-white",children:[f.jsx("h2",{className:"text-xl font-bold text-rose-500",children:" xy ra li hin th"}),f.jsx("p",{className:"text-slate-300",children:(e=this.state.error)==null?void 0:e.message}),f.jsx("button",{onClick:()=>this.setState({hasError:!1}),className:"px-6 py-3 bg-white text-slate-900 font-bold rounded-xl hover:bg-slate-200 transition-all",children:"Th li"}),f.jsx("p",{className:"text-xs text-slate-500",children:"D liu vn c lu trong b nh tm."})]}):this.props.children}};const VP=({userId:n})=>{const[e,t]=le.useState({opponentScript:"",skeleton:null,ideas:[],selectedIdeaIndex:null,outlines:{},finalScripts:{},selectedStyle:ad[0].id,characters:[],tags:{},showCharacterSection:!1,loading:{analysis:!1,ideas:!1,outline:!1,script:!1,characters:!1},outputLanguage:"VN"}),[i,a]=le.useState("");le.useEffect(()=>{if(!n)return;const F=`app_api_keys_${n}`,$=localStorage.getItem(F);if($)try{const A=JSON.parse($),I=atob(A.gemini||"").split(`
`).map(D=>D.trim()).filter(D=>D);I.length>0&&(a(I.join(`
`)),om(I))}catch(A){console.error("Failed to load Gemini keys",A)}},[n]);const[l,c]=le.useState(null),d=(F,$="info")=>{c({message:F,type:$}),setTimeout(()=>c(null),5e3)},p=le.useRef(null),m=F=>/[\u3040-\u30ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff\uff66-\uff9f\uac00-\ud7af]/.test(F)?F.replace(/\s/g,"").length:F.trim().split(/\s+/).filter(Boolean).length,_=async()=>{if(e.opponentScript.trim()){t(F=>({...F,loading:{...F.loading,analysis:!0}}));try{const F=await uN(e.opponentScript,i),$=m(e.opponentScript),A=F.split(/PHONG CCH I TH/i),C=A.length>1?A[1].trim():"T nhin, viral";t(I=>({...I,skeleton:{content:F,wordCount:$,style:C},loading:{...I.loading,analysis:!1}}))}catch(F){console.error(F),d("Li Phn tch: "+(F instanceof Error?F.message:String(F)),"error"),t($=>({...$,loading:{...$.loading,analysis:!1}}))}}},b=async()=>{if(e.skeleton){t(F=>({...F,loading:{...F.loading,ideas:!0}}));try{const F=await hN(e.skeleton.content,i);t($=>({...$,ideas:F,loading:{...$.loading,ideas:!1}}))}catch(F){console.error(F),d("Li Sinh  tng: "+(F instanceof Error?F.message:String(F)),"error"),t($=>({...$,loading:{...$.loading,ideas:!1}}))}}},x=async F=>{if(!(!e.skeleton||!e.ideas[F])){t($=>({...$,selectedIdeaIndex:F,loading:{...$.loading,outline:!0}}));try{const $=await dN(e.skeleton.content,e.ideas[F],e.skeleton.wordCount,i);t(A=>({...A,outlines:{...A.outlines,[F]:$},loading:{...A.loading,outline:!1}}))}catch($){console.error($),d("Li Lp dn : "+($ instanceof Error?$.message:String($)),"error"),t(A=>({...A,loading:{...A.loading,outline:!1}}))}}},S=async F=>{if(!(!e.outlines[F]||!e.skeleton)){t($=>({...$,loading:{...$.loading,script:!0}}));try{const $=await fN(e.outlines[F],e.skeleton.style,e.outputLanguage,i);t(A=>({...A,finalScripts:{...A.finalScripts,[F]:$},loading:{...A.loading,script:!1}}))}catch($){console.error($),d("Li Vit kch bn: "+($ instanceof Error?$.message:String($)),"error"),t(A=>({...A,loading:{...A.loading,script:!1}}))}}},N=async()=>{const F=e.selectedIdeaIndex,$=F!==null?e.finalScripts[F]:null;if(t(A=>({...A,showCharacterSection:!0})),setTimeout(()=>{var A;(A=p.current)==null||A.scrollIntoView({behavior:"smooth",block:"start"})},100),$)try{const A=await gN($,ad.map(I=>I.id),i),C=ad.find(I=>I.id===A||A.includes(I.id));C&&t(I=>({...I,selectedStyle:C.id}))}catch(A){console.error("Style recommendation failed",A)}},j=async()=>{const F=e.selectedIdeaIndex;if(!(F===null||!e.finalScripts[F])){t($=>({...$,loading:{...$.loading,characters:!0}}));try{const $=await pN(e.finalScripts[F],e.selectedStyle,i);t(A=>({...A,characters:$,loading:{...A.loading,characters:!1}}))}catch($){console.error($),d("Li Thit k NV: "+($ instanceof Error?$.message:String($)),"error"),t(A=>({...A,loading:{...A.loading,characters:!1}}))}}},k=F=>{const $=e.finalScripts[F];if(!$)return;const A=2e3;let C=[];if($.length<=A)C=[$];else{let D=$;for(;D.length>0;){let M=D.lastIndexOf(`
`,A);(M===-1||M<500)&&(M=A),C.push(D.substring(0,M).trim()),D=D.substring(M).trim()}}const I=C.map(D=>({content:D,actions:[],isAnalyzing:!1}));t(D=>({...D,tags:{...D.tags,[F]:I}}))},L=(F,$,A)=>{t(C=>{const I={...C.tags},D=[...I[F]||[]];return D[$]&&(D[$]={...D[$],content:A}),I[F]=D,{...C,tags:I}})},H=async(F,$)=>{var C;const A=(C=e.tags[F])==null?void 0:C[$];if(!A||!e.characters.length){d("Vui lng thc hin bc 'Thit k Nhn Vt' trc khi phn tch hnh ng.","info");return}t(I=>{const D={...I.tags},M=[...D[F]||[]];return M[$]&&(M[$]={...M[$],isAnalyzing:!0}),D[F]=M,{...I,tags:D}});try{const I=await mN(A.content,e.selectedStyle,e.characters,e.outputLanguage,i);t(D=>{const M={...D.tags},q=[...M[F]||[]];return q[$]&&(q[$]={...q[$],actions:I,isAnalyzing:!1}),M[F]=q,{...D,tags:M}})}catch(I){console.error(I),d("Li Phn tch Tag: "+(I instanceof Error?I.message:String(I)),"error"),t(D=>{const M={...D.tags},q=[...M[F]||[]];return q[$]&&(q[$]={...q[$],isAnalyzing:!1}),M[F]=q,{...D,tags:M}})}},B=F=>{navigator.clipboard.writeText(F),d(" sao chp prompt!","success")},K=F=>{const $=F.map(A=>A.motionPrompt).join(`
`);navigator.clipboard.writeText($),d(" sao chp tt c prompt video!","success")};return f.jsx(UP,{children:f.jsxs(Gc.Fragment,{children:[l&&f.jsx("div",{className:"fixed top-4 right-4 z-50 animate-in slide-in-from-right fade-in duration-300",children:f.jsxs("div",{className:`px-6 py-4 rounded-2xl shadow-2xl flex items-center gap-3 font-bold text-sm ${l.type==="error"?"bg-rose-50 text-rose-600 border border-rose-100":l.type==="success"?"bg-emerald-50 text-emerald-600 border border-emerald-100":"bg-white text-slate-700 border border-slate-100"}`,children:[l.type==="success"&&f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),l.type==="error"&&f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),l.message]})}),f.jsxs("main",{className:"w-full grid grid-cols-1 md:grid-cols-10 gap-8 p-4 md:p-10",children:[f.jsxs("div",{className:"md:col-span-3 space-y-10",children:[f.jsxs("section",{className:"bg-white rounded-3xl shadow-xl shadow-slate-200/50 border border-slate-100 p-8 group transition-all",children:[f.jsxs("h2",{className:"text-xl font-black text-slate-800 uppercase tracking-tighter mb-6 flex items-center gap-3",children:[f.jsx("span",{className:"w-2 h-6 bg-indigo-600 rounded-full"}),"Kch bn i th"]}),f.jsx("textarea",{className:"w-full h-80 p-6 bg-slate-50 border border-slate-100 rounded-2xl focus:ring-8 focus:ring-indigo-600/5 focus:border-indigo-600/20 focus:bg-white outline-none transition-all text-sm leading-relaxed placeholder:text-slate-300 font-medium custom-scrollbar mb-6",placeholder:"Dn kch bn i th vo y...",value:e.opponentScript,onChange:F=>t($=>({...$,opponentScript:F.target.value}))}),f.jsx("button",{onClick:_,disabled:e.loading.analysis||!e.opponentScript,className:"w-full bg-[#020617] hover:bg-indigo-700 disabled:bg-slate-100 disabled:text-slate-300 text-white font-black py-6 rounded-2xl transition-all shadow-2xl hover:scale-[1.02] active:scale-95 flex justify-center items-center gap-4 text-sm uppercase tracking-widest",children:e.loading.analysis?"ang x l...":"Phn tch Cu trc & Phong cch"})]}),e.skeleton&&f.jsxs("div",{className:"space-y-8 animate-in slide-in-from-left-8 duration-700",children:[f.jsxs("div",{className:"bg-gradient-to-br from-indigo-600 to-indigo-800 rounded-3xl p-8 text-white shadow-2xl relative overflow-hidden",children:[f.jsx("h3",{className:"text-[10px] font-black uppercase opacity-60 mb-2 tracking-[0.3em]",children:"Quantitative Data"}),f.jsxs("div",{className:"text-5xl font-black italic tracking-tighter",children:[e.skeleton.wordCount," ",f.jsx("span",{className:"text-xs font-bold uppercase opacity-60",children:"Units"})]})]}),f.jsxs("section",{className:"bg-white rounded-3xl shadow-xl border border-slate-100 p-8",children:[f.jsx("h2",{className:"text-lg font-black text-slate-800 uppercase tracking-tighter mb-6",children:"Khung xng Logic"}),f.jsx("div",{className:"max-h-96 overflow-y-auto pr-4 text-sm text-slate-600 leading-relaxed whitespace-pre-wrap font-medium custom-scrollbar",children:e.skeleton.content}),f.jsx("button",{onClick:b,disabled:e.loading.ideas,className:"w-full mt-8 bg-rose-500 hover:bg-rose-600 disabled:bg-slate-100 text-white font-black py-6 rounded-2xl transition-all shadow-xl hover:scale-[1.02] active:scale-95 uppercase tracking-widest text-xs",children:"SINH 5  TNG LIN QUAN"})]})]}),e.showCharacterSection&&f.jsxs("div",{ref:p,className:"animate-in fade-in slide-in-from-bottom-12 duration-1000 space-y-8",children:[f.jsxs("section",{className:"bg-white rounded-3xl shadow-xl border border-slate-100 p-8",children:[f.jsx("h2",{className:"text-lg font-black text-slate-800 uppercase tracking-tighter mb-6",children:"B lc Phong cch"}),f.jsxs("div",{className:"space-y-6 mb-8",children:[f.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400 tracking-widest px-1",children:"Visual Architecture"}),f.jsx("select",{value:e.selectedStyle,onChange:F=>t($=>({...$,selectedStyle:F.target.value})),className:"w-full p-5 bg-slate-50 border border-slate-200 rounded-xl focus:ring-4 focus:ring-amber-500/10 outline-none text-sm font-bold text-slate-800 transition-all cursor-pointer",children:ad.map(F=>f.jsx("option",{value:F.id,children:F.label},F.id))})]}),f.jsx("button",{onClick:j,disabled:e.loading.characters,className:"w-full bg-amber-500 hover:bg-amber-600 disabled:bg-slate-100 text-white font-black py-6 rounded-2xl shadow-xl transition-all hover:scale-[1.02] active:scale-95 uppercase tracking-widest text-xs",children:"Thit k Nhn Vt"})]}),e.characters.length>0&&f.jsx("div",{className:"space-y-6",children:e.characters.map((F,$)=>f.jsxs("div",{className:"bg-[#020617] text-white p-8 rounded-[2rem] border-l-[10px] border-amber-500 shadow-3xl",children:[f.jsx("input",{className:"bg-transparent border-none text-2xl font-black text-white tracking-tighter mb-1 w-full focus:ring-0 placeholder-white/30",value:F.name,onChange:A=>{const C=[...e.characters];C[$].name=A.target.value,t(I=>({...I,characters:C}))},placeholder:"Tn nhn vt"}),f.jsx("div",{className:"text-[10px] font-bold text-amber-500/60 uppercase tracking-widest mb-4",children:"Neural Casting Profile"}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 text-[11px] mb-4",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"opacity-40 uppercase whitespace-nowrap",children:"G.Tnh:"}),f.jsx("input",{className:"bg-white/10 rounded px-2 py-1 w-full border-none focus:ring-1 focus:ring-amber-500 text-white",value:F.gender,onChange:A=>{const C=[...e.characters];C[$].gender=A.target.value,t(I=>({...I,characters:C}))}})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"opacity-40 uppercase whitespace-nowrap",children:"Tui:"}),f.jsx("input",{className:"bg-white/10 rounded px-2 py-1 w-full border-none focus:ring-1 focus:ring-amber-500 text-white",value:F.age,onChange:A=>{const C=[...e.characters];C[$].age=A.target.value,t(I=>({...I,characters:C}))}})]}),f.jsxs("div",{className:"flex items-center gap-2 col-span-2",children:[f.jsx("span",{className:"opacity-40 uppercase whitespace-nowrap",children:"Quc tch:"}),f.jsx("input",{className:"bg-white/10 rounded px-2 py-1 w-full border-none focus:ring-1 focus:ring-amber-500 text-white",value:F.country,onChange:A=>{const C=[...e.characters];C[$].country=A.target.value,t(I=>({...I,characters:C}))}})]}),f.jsxs("div",{className:"flex items-center gap-2 col-span-2",children:[f.jsx("span",{className:"opacity-40 uppercase whitespace-nowrap",children:"Dng ngi:"}),f.jsx("input",{className:"bg-white/10 rounded px-2 py-1 w-full border-none focus:ring-1 focus:ring-amber-500 text-white",value:F.bodyType,onChange:A=>{const C=[...e.characters];C[$].bodyType=A.target.value,t(I=>({...I,characters:C}))}})]})]}),f.jsxs("div",{className:"mt-4 pt-4 border-t border-white/10",children:[f.jsx("label",{className:"text-[10px] text-slate-400 uppercase tracking-widest block mb-1",children:"c im khun mt (Trung tnh)"}),f.jsx("textarea",{className:"w-full bg-white/5 rounded-xl p-3 text-xs text-slate-300 italic leading-relaxed border border-white/10 focus:ring-1 focus:ring-amber-500 outline-none resize-none h-24",value:F.facialDetails,onChange:A=>{const C=[...e.characters];C[$].facialDetails=A.target.value,t(I=>({...I,characters:C}))}})]})]},$))})]})]}),f.jsx("div",{className:"md:col-span-7 space-y-12",children:e.ideas.length>0?f.jsxs("div",{className:"space-y-16 animate-in fade-in zoom-in-95 duration-1000",children:[f.jsx("div",{className:"flex items-center justify-between border-b-4 border-slate-100 pb-8",children:f.jsxs("div",{className:"flex items-center gap-6",children:[f.jsx("div",{className:"bg-[#020617] text-white w-14 h-14 rounded-2xl flex items-center justify-center text-3xl font-black shadow-2xl",children:"#"}),f.jsx("h2",{className:"text-4xl font-black text-slate-900 tracking-tighter uppercase",children:"Production Suite"})]})}),e.ideas.map((F,$)=>f.jsxs("div",{className:"bg-white rounded-[3rem] shadow-2xl border border-slate-100 p-10 md:p-16 space-y-12 transition-all hover:border-indigo-200",children:[f.jsxs("div",{className:"space-y-8",children:[f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsxs("span",{className:"bg-indigo-600 text-white text-[11px] font-black px-6 py-2 rounded-full uppercase",children:["Module ",$+1]}),f.jsx("span",{className:"text-rose-500 text-xs font-black uppercase tracking-widest",children:F.highlightValue})]}),f.jsx("h3",{className:"text-5xl font-black text-slate-900 tracking-tighter leading-none",children:F.title}),f.jsx("p",{className:"text-xl text-slate-500 leading-relaxed font-medium",children:F.description}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 pt-4",children:[f.jsxs("div",{className:"bg-slate-50 p-8 rounded-3xl border border-slate-100",children:[f.jsx("div",{className:"text-[10px] font-black text-slate-400 uppercase mb-2 tracking-widest",children:"Environment Context"}),f.jsx("p",{className:"font-bold text-slate-700",children:F.charactersContext})]}),f.jsxs("div",{className:"bg-slate-50 p-8 rounded-3xl border border-slate-100",children:[f.jsx("div",{className:"text-[10px] font-black text-slate-400 uppercase mb-2 tracking-widest",children:"Growth Potential"}),f.jsx("p",{className:"font-bold text-slate-700",children:F.viralPotential})]})]})]}),f.jsx("div",{className:"pt-12 border-t-2 border-slate-50 space-y-12",children:e.outlines[$]?f.jsxs("div",{className:"space-y-16",children:[f.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-[2.5rem] p-12 shadow-inner",children:[f.jsxs("h4",{className:"text-slate-900 font-black mb-8 uppercase tracking-[0.4em] text-[10px] flex items-center gap-3",children:[f.jsx("span",{className:"w-2 h-2 bg-indigo-500 rounded-full animate-ping"})," Structural Protocol"]}),f.jsx("div",{className:"whitespace-pre-wrap text-base text-slate-600 leading-[2] font-medium opacity-80 max-h-[500px] overflow-y-auto pr-8 custom-scrollbar",children:e.outlines[$]}),!e.finalScripts[$]&&f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"mb-6 bg-slate-100 p-4 rounded-2xl border border-slate-200",children:[f.jsx("label",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest block mb-3",children:"Chn ngn ng u ra"}),f.jsxs("select",{value:e.outputLanguage||"VN",onChange:A=>t(C=>({...C,outputLanguage:A.target.value})),className:"w-full bg-white text-slate-800 font-bold text-sm px-4 py-3 rounded-xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-all cursor-pointer",children:[f.jsx("option",{value:"VN",children:"Ting Vit (VN)"}),f.jsx("option",{value:"EN",children:"English (EN)"}),f.jsx("option",{value:"JA",children:"Japanese (JA)"}),f.jsx("option",{value:"KO",children:"Korean (KO)"}),f.jsx("option",{value:"ZH",children:"Chinese (ZH)"})]})]}),f.jsx("button",{onClick:()=>S($),disabled:e.loading.script,className:`w-full bg-emerald-600 hover:bg-emerald-700 text-white font-black px-12 py-8 rounded-2xl shadow-2xl transition-all uppercase tracking-widest text-xs ${e.loading.script?"opacity-30 cursor-not-allowed":"hover:scale-[1.02] active:scale-95"}`,children:e.loading.script?"ang vit...":"Vit kch bn hon chnh"})]})]}),e.finalScripts[$]&&f.jsxs("div",{className:"space-y-12 animate-in zoom-in-95 duration-[1200ms]",children:[f.jsxs("div",{className:"bg-[#020617] text-white rounded-[3.5rem] p-16 lg:p-24 shadow-[0_50px_100px_-20px_rgba(0,0,0,0.5)]",children:[f.jsx("h4",{className:"text-indigo-400 font-black uppercase text-xs tracking-[0.5em] border-b border-white/5 pb-8 mb-12",children:"Final Master Copy"}),f.jsx("div",{className:"whitespace-pre-wrap text-lg lg:text-xl font-bold tracking-tight leading-relaxed text-slate-100",children:e.finalScripts[$]})]}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-8",children:[f.jsxs("button",{onClick:N,className:"bg-amber-500 hover:bg-amber-600 text-white font-black px-12 py-10 rounded-3xl shadow-2xl transition-all hover:scale-[1.03] active:scale-95 flex flex-col items-center gap-4 text-center group",children:[f.jsx("svg",{className:"w-8 h-8 group-hover:rotate-45 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})}),f.jsxs("div",{children:[f.jsx("div",{className:"text-xl",children:"Thit lp Styles & NV"}),f.jsx("div",{className:"text-[10px] opacity-60 mt-2 uppercase tracking-widest",children:"Tip tc thit k hnh nh"})]})]}),f.jsxs("button",{onClick:()=>k($),className:"bg-indigo-600 hover:bg-indigo-700 text-white font-black px-12 py-10 rounded-3xl shadow-2xl transition-all hover:scale-[1.03] active:scale-95 flex flex-col items-center gap-4 text-center group",children:[f.jsx("svg",{className:"w-8 h-8 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),f.jsxs("div",{children:[f.jsx("div",{className:"text-xl",children:"Bt u Chia TAGS"}),f.jsx("div",{className:"text-[10px] opacity-60 mt-2 uppercase tracking-widest",children:"Shot Decomposition"})]})]})]}),e.tags[$]&&f.jsxs("div",{className:"space-y-16 pt-24 border-t-8 border-slate-100",children:[f.jsx("h3",{className:"text-5xl font-black text-slate-900 tracking-tighter italic",children:"Alpha Production Tags"}),e.tags[$].map((A,C)=>f.jsxs("div",{className:"bg-white border-4 border-slate-50 rounded-[4rem] p-12 md:p-16 space-y-12 shadow-sm transition-all animate-in slide-in-from-bottom-16 duration-700",children:[f.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-8",children:[f.jsxs("div",{className:"flex items-center gap-6",children:[f.jsxs("div",{className:"bg-[#020617] text-white px-6 py-2 rounded-xl text-xs font-black uppercase tracking-widest",children:["TAG #",C+1]}),f.jsxs("div",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest",children:[m(A.content)," units identified"]})]}),f.jsxs("div",{className:"flex gap-4",children:[f.jsx("button",{onClick:()=>K(A.actions),disabled:A.actions.length===0,className:"bg-indigo-50 hover:bg-indigo-100 text-indigo-600 px-6 py-3 rounded-xl text-xs font-black uppercase tracking-widest transition-all shadow-sm border border-indigo-100 disabled:opacity-30",children:"Copy All Video"}),f.jsx("button",{onClick:()=>H($,C),disabled:A.isAnalyzing,className:"bg-indigo-600 hover:bg-indigo-700 disabled:bg-slate-100 text-white font-black px-10 py-4 rounded-xl text-xs transition-all shadow-xl uppercase tracking-widest",children:A.isAnalyzing?"Processing...":"To Motion Prompts"})]})]}),f.jsxs("div",{className:"relative group",children:[f.jsx("textarea",{className:"w-full min-h-[150px] p-8 bg-slate-50 rounded-[2.5rem] text-slate-600 text-lg italic font-medium leading-relaxed border-2 border-slate-100 outline-none focus:border-indigo-300 focus:bg-white transition-all resize-y custom-scrollbar",value:A.content,onChange:I=>L($,C,I.target.value)}),f.jsx("div",{className:"absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity",children:f.jsx("div",{className:"bg-white/90 backdrop-blur text-[10px] font-black text-indigo-500 px-3 py-1.5 rounded-full border border-indigo-100 shadow-sm uppercase tracking-widest cursor-default",children:"Editable"})})]}),A.actions.length>0&&f.jsx("div",{className:"grid grid-cols-1 gap-12 mt-12",children:A.actions.map((I,D)=>f.jsxs("div",{className:"space-y-8 animate-in slide-in-from-bottom-12 duration-1000",children:[f.jsxs("div",{className:"flex items-center gap-6",children:[f.jsx("div",{className:"w-10 h-10 bg-slate-900 text-white rounded-lg flex items-center justify-center font-black text-sm",children:D+1}),f.jsx("div",{className:"h-px flex-1 bg-slate-100"})]}),f.jsxs("div",{className:"grid grid-cols-1 gap-8",children:[f.jsxs("div",{className:"bg-[#020617] text-white p-10 rounded-[2.5rem] shadow-3xl",children:[f.jsx("div",{className:"text-[10px] font-black uppercase text-indigo-400 mb-4 tracking-widest",children:"Shot Execution"}),f.jsx("div",{className:"text-xl font-bold leading-relaxed",children:I.action})]}),f.jsxs("div",{className:"bg-indigo-50 border-l-[10px] border-indigo-400 p-10 rounded-[2.5rem] shadow-inner",children:[f.jsx("div",{className:"text-[10px] font-black text-indigo-400 uppercase tracking-widest mb-4",children:"Master Transcript"}),f.jsx("div",{className:"text-xl font-bold text-indigo-900 italic font-serif",children:I.voiceText?`"${I.voiceText}"`:"--- Instrumental Segment ---"})]}),f.jsxs("div",{className:"bg-[#FFF1F2] border-l-[10px] border-rose-400 p-10 rounded-[2.5rem] relative group shadow-lg",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx("div",{className:"text-[10px] font-black text-rose-400 uppercase tracking-[0.3em]",children:"Video Motion AI Prompt"}),f.jsx("button",{onClick:()=>B(I.motionPrompt),className:"bg-white/80 hover:bg-white p-2 rounded-lg text-rose-500 shadow-sm transition-all active:scale-90",children:f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"})})})]}),f.jsx("div",{className:"text-sm font-bold text-rose-950 leading-relaxed italic bg-white/40 p-6 rounded-2xl border border-rose-200",children:I.motionPrompt})]})]})]},D))})]},C))]})]})]}):f.jsx("button",{onClick:()=>x($),disabled:e.loading.outline,className:"bg-[#020617] text-white px-12 py-8 rounded-2xl font-black shadow-2xl hover:bg-indigo-700 hover:scale-[1.02] active:scale-95 transition-all text-sm uppercase tracking-widest",children:e.loading.outline&&e.selectedIdeaIndex===$?"Kin trc...":"Chn & Lp dn "})})]},$))]}):f.jsxs("div",{className:"h-full min-h-[900px] flex flex-col items-center justify-center text-slate-200 space-y-16 border-8 border-dashed border-slate-100 rounded-[6rem] bg-white/50 backdrop-blur-3xl group hover:border-indigo-100 transition-all duration-[2000ms]",children:[f.jsx("div",{className:"relative",children:f.jsx("div",{className:"w-56 h-56 bg-white rounded-[4.5rem] flex items-center justify-center shadow-3xl group-hover:rotate-12 transition-all",children:f.jsx("svg",{className:"w-24 h-24 text-slate-100",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})})})}),f.jsxs("div",{className:"text-center space-y-6",children:[f.jsx("h3",{className:"text-4xl font-black italic uppercase tracking-[0.5em] text-slate-300",children:"Quang Huy Production"}),f.jsx("p",{className:"text-sm font-bold text-slate-400 uppercase tracking-widest opacity-40 italic",children:"Waiting for initial data analysis to start production sequence..."})]})]})})]}),f.jsxs("footer",{className:"w-full p-20 text-center border-t border-slate-100 bg-white mt-40",children:[f.jsxs("h4",{className:"text-2xl font-black tracking-tighter uppercase text-[#020617]",children:["QUANG HUY ",f.jsx("span",{className:"text-indigo-600",children:"VIDEO"})]}),f.jsx("p",{className:"text-[10px] font-black uppercase tracking-[0.5em] text-slate-400 mt-4",children:"AI Viral Content Engine  2024 - v1.5 (Multi-Lang)"})]})]})})},Wp={},BP=n=>{let e=[];if(n&&(e=n.split(`
`).map(t=>t.trim()).filter(t=>t)),e.length===0){const t=Wp==null?void 0:Wp.VITE_GEMINI_API_KEY;t&&e.push(t)}return e},zP=["gemini-2.0-flash-lite-preview-02-05","gemini-2.5-flash","gemini-2.0-flash-lite-001","gemini-2.0-flash-exp","gemini-2.0-flash-001","gemini-2.0-flash","gemini-2.5-pro","gemini-flash-latest"],xu=async(n,e)=>{const t=BP(n);if(t.length===0)throw new Error("No API Keys provided.");let i;for(const a of t){const l=new Xd(a);for(const c of zP)try{const d=l.getGenerativeModel({model:c});return await e(d)}catch(d){console.warn(`Failed: Key(...${a.slice(-4)}) Model(${c}) error: ${d.message}`),i=d}}throw i||new Error("All keys and models failed to generate content.")},HP=async(n,e)=>xu(e,async t=>(await t.generateContent([{inlineData:{mimeType:"image/jpeg",data:n}},{text:"Hy phn tch chi tit phong cch hnh nh trong bc nh ny: nh sng, mu sc, gc my, cht liu ngh thut (medium), tm trng v cc c im hnh nh c trng khc. Tr v m t ngn gn nhng sc tch bng ting Vit."}])).response.text()||"Khng th phn tch phong cch."),qP=async(n,e)=>xu(e,async t=>{const i=`Nhim v: c kch bn di y v chia tch thnh cc phn cnh hnh nh tiu biu (Scene Breakdown). Mi phn on phi i din cho mt thng ip hoc giai on cm xc. Sau  hy m tng s phn on.
      
      Kch bn: "${n}"
      
      Tr v JSON: { "breakdown": string, "count": number }`,a={responseMimeType:"application/json"},l=await t.generateContent({contents:[{role:"user",parts:[{text:i}]}],generationConfig:a}),c=JSON.parse(l.response.text()||"{}");let d=c.breakdown||"";return typeof d!="string"&&(d=JSON.stringify(d)),{breakdown:d,count:Number(c.count)||0}}),$P=async(n,e,t,i)=>xu(i,async a=>{const l=`Da vo phn tch phn cnh: "${e}" v s lng ${t} phn on. Hy chia ni dung kch bn gc di y thnh ng ${t} hng tng ng vi cc phn on.
        
        QUY TC CC K QUAN TRNG:
        - KHNG C XO B BT C K T NO ca kch bn gc.
        - Ch c thm xung dng  phn tch cc on.
        - Tr v danh sch cc chui tng ng vi mi phn cnh.
        
        Kch bn gc: "${n}"`,c=await a.generateContent({contents:[{role:"user",parts:[{text:l}]}],generationConfig:{responseMimeType:"application/json"}}),d=JSON.parse(c.response.text()||"[]");return Array.isArray(d)?d.map(p=>typeof p=="string"?p:typeof p=="object"&&p!==null?p.content||p.text||p.description||p.script_content||p.row||JSON.stringify(p):String(p)):[]}),GP=async(n,e,t)=>xu(t,async i=>{const a=`Hy to ra Image Prompts cho Midjourney/Stable Diffusion da trn cc on kch bn sau v phong cch hnh nh c cung cp.
        
        Phong cch (Style): ${e}
        
        Cu trc Prompt (Ting Anh): [Subject], [Action], [Environment], [Lighting/Atmosphere], [Camera Angle/Lens], [Style].
        
        Cc on kch bn cn to prompt:
        ${n.map((c,d)=>`${d+1}. ${c}`).join(`
`)}
        
        Tr v mng JSON cha cc prompt tng ng theo th t (mng string).`,l=await i.generateContent({contents:[{role:"user",parts:[{text:a}]}],generationConfig:{responseMimeType:"application/json"}});return JSON.parse(l.response.text()||"[]")}),FP=async(n,e,t)=>xu(t,async i=>{const a=`Da vo ni dung kch bn v cc prompt nh  c, hy to ra cc "Video Motion Prompts" (Prompt chuyn ng cho video) tng ng.
        
        Yu cu:
        - Mi prompt video phi m t chuyn ng ca ch th v my nh (Camera motion, subject action, dynamic transitions).
        - Ngn ng: Ting Anh.
        - Kt qu phi l mt mng chui, mi chui tng ng vi mt hng kch bn.
        
        Kch bn & Prompt nh:
        ${n.map((c,d)=>`Hng ${d+1}: [Kch bn: ${c}] [Prompt nh: ${e[d]||"N/A"}]`).join(`
`)}
        
        Tr v mng JSON (mng string).`,l=await i.generateContent({contents:[{role:"user",parts:[{text:a}]}],generationConfig:{responseMimeType:"application/json"}});return JSON.parse(l.response.text()||"[]")});let xS=class extends Gc.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("ErrorBoundary caught error:",e,t)}render(){var e;return this.state.hasError?f.jsxs("div",{className:"p-8 m-8 bg-red-50 border border-red-200 rounded-xl space-y-4 text-center",children:[f.jsx("h2",{className:"text-xl font-bold text-red-700",children:" xy ra li hin th"}),f.jsx("p",{className:"text-red-600",children:(e=this.state.error)==null?void 0:e.message}),f.jsx("button",{onClick:()=>this.setState({hasError:!1}),className:"px-4 py-2 bg-white border border-red-200 text-red-600 rounded-lg hover:bg-red-50",children:"Th li"}),f.jsx("p",{className:"text-xs text-slate-500",children:"D liu vn c lu trong b nh tm."})]}):this.props.children}};const KP=le.forwardRef(({tag:n,style:e,index:t,apiKey:i,onNotify:a},l)=>{const[c,d]=le.useState(n),p=le.useRef(c);le.useEffect(()=>{p.current=c},[c]);const[m,_]=le.useState({}),b=L=>new Promise(H=>setTimeout(H,L)),x=async()=>{_(L=>({...L,analyze:!0}));try{const L=await qP(c.content,i);return d(H=>({...H,analysis:L.breakdown,sceneCount:L.count})),L}catch(L){throw console.error(L),a("Li khi phn tch phn cnh","error"),L}finally{_(L=>({...L,analyze:!1}))}},S=async(L,H)=>{const B=L||c.analysis,K=H||c.sceneCount;if(!B||!K){a("Cn phn tch phn cnh trc","info");return}_(F=>({...F,split:!0}));try{const F=await $P(c.content,B,K,i);return d($=>({...$,rows:F})),F}catch(F){throw console.error(F),a("Li khi chia hng","error"),F}finally{_(F=>({...F,split:!1}))}},N=async L=>{const H=L||c.rows;if(!H||H.length===0){a("Cn chia hng trc","info");return}_(B=>({...B,prompt:!0}));try{const B=await GP(H,e,i);return d(K=>({...K,prompts:B})),B}catch(B){throw console.error(B),a("Li khi to prompt","error"),B}finally{_(B=>({...B,prompt:!1}))}},j=async()=>{if(!c.rows||c.rows.length===0){a("Cn chia hng trc","info");return}_(L=>({...L,videoPrompt:!0}));try{const L=await FP(c.rows,c.prompts||[],i);d(H=>({...H,videoPrompts:L}))}catch(L){console.error(L),a("Li khi to prompt video","error")}finally{_(L=>({...L,videoPrompt:!1}))}},k=L=>{if(!L||L.length===0)return;const H=L.map(B=>B.trim()).filter(B=>B.length>0).map(B=>B.replace(/\r?\n|\r/g," ")).map(B=>B.replace(/^["']+|["']+$/g,"")).join(`
`);navigator.clipboard.writeText(H),a(" sao chp ni dung chnh xc theo tng hng!","success")};return le.useImperativeHandle(l,()=>({runAutoSequence:async()=>{const L=await x();await b(5e3);const H=await S(L.breakdown,L.count);await b(5e3),await N(H)},getRows:()=>p.current.rows||[],getPrompts:()=>p.current.prompts||[]}),[]),f.jsxs("div",{className:`bg-white rounded-2xl shadow-sm border p-6 space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500 transition-colors ${Object.values(m).some(L=>L)?"border-indigo-300 ring-1 ring-indigo-100":"border-gray-100"}`,children:[f.jsxs("div",{className:"flex items-center justify-between border-b border-gray-50 pb-4",children:[f.jsxs("h3",{className:"font-bold text-gray-800 flex items-center gap-2",children:[f.jsxs("span",{className:"w-10 h-10 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center text-xs font-bold",children:["TAG ",t+1]}),"Phn kch bn"]}),c.sceneCount!==void 0&&f.jsxs("span",{className:"px-3 py-1 bg-green-100 text-green-700 rounded-full text-xs font-bold",children:[c.sceneCount," Phn on"]})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"space-y-1",children:[f.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Ni dung kch bn"}),f.jsx("div",{className:"p-4 bg-gray-50 rounded-xl border border-gray-100 text-sm text-gray-700 max-h-48 overflow-y-auto whitespace-pre-wrap leading-relaxed",children:c.content})]}),f.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[f.jsx("button",{onClick:()=>x(),disabled:m.analyze,className:`py-2.5 px-3 rounded-xl text-xs font-semibold transition-all flex items-center justify-center gap-2 ${m.analyze?"bg-gray-100 text-gray-400":"bg-blue-50 text-blue-700 hover:bg-blue-100 active:scale-95"}`,children:m.analyze?"...":"Phn Tch"}),f.jsx("button",{onClick:()=>S(),disabled:m.split||!c.analysis,className:`py-2.5 px-3 rounded-xl text-xs font-semibold transition-all flex items-center justify-center gap-2 ${m.split||!c.analysis?"bg-gray-100 text-gray-400":"bg-teal-50 text-teal-700 hover:bg-teal-100 active:scale-95"}`,children:m.split?"...":"Chia hng"}),f.jsx("button",{onClick:()=>N(),disabled:m.prompt||!c.rows,className:`py-2.5 px-3 rounded-xl text-xs font-semibold transition-all flex items-center justify-center gap-2 ${m.prompt||!c.rows?"bg-gray-100 text-gray-400":"bg-purple-50 text-purple-700 hover:bg-purple-100 active:scale-95"}`,children:m.prompt?"...":"Prompt nh"}),f.jsx("button",{onClick:()=>j(),disabled:m.videoPrompt||!c.rows,className:`py-2.5 px-3 rounded-xl text-xs font-semibold transition-all flex items-center justify-center gap-2 ${m.videoPrompt||!c.rows?"bg-gray-100 text-gray-400":"bg-rose-50 text-rose-700 hover:bg-rose-100 active:scale-95"}`,children:m.videoPrompt?"...":"Prompt Video"})]}),c.analysis&&f.jsxs("div",{className:"p-4 bg-indigo-50 border border-indigo-100 rounded-xl space-y-2",children:[f.jsx("h4",{className:"text-xs font-bold text-indigo-700 uppercase",children:"Phn tch phn cnh"}),f.jsx("p",{className:"text-sm text-indigo-900 leading-relaxed whitespace-pre-wrap",children:c.analysis})]}),c.rows&&c.rows.length>0&&f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:["Kch bn  chia hng (",c.rows.length,")"]}),f.jsx("button",{onClick:()=>k(c.rows||[]),className:"text-[10px] font-bold text-indigo-500 hover:text-indigo-700 uppercase flex items-center gap-1",children:"Copy All"})]}),f.jsx("div",{className:"space-y-2",children:c.rows.map((L,H)=>f.jsxs("div",{className:"p-3 bg-white border border-gray-100 rounded-lg text-sm flex gap-3",children:[f.jsx("span",{className:"text-indigo-300 font-mono text-xs",children:H+1}),f.jsxs("span",{className:"text-gray-700 italic",children:['"',L,'"']})]},H))})]}),c.prompts&&c.prompts.length>0&&f.jsxs("div",{className:"space-y-3 pt-4 border-t border-gray-50",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h4",{className:"text-xs font-bold text-purple-700 uppercase tracking-wider",children:"Image Prompts"}),f.jsx("button",{onClick:()=>k(c.prompts||[]),className:"text-[10px] font-bold text-purple-500 hover:text-purple-700 uppercase flex items-center gap-1",children:"Copy All"})]}),f.jsx("div",{className:"space-y-3",children:c.prompts.map((L,H)=>f.jsxs("div",{className:"p-4 bg-purple-50 border border-purple-100 rounded-xl text-sm font-mono text-purple-900 leading-relaxed",children:[f.jsxs("div",{className:"text-[10px] font-bold text-purple-400 mb-1",children:["PROMPT #",H+1]}),L]},H))})]})]})]})}),YP=({onStyleChange:n,onSplitScript:e,apiKey:t})=>{const[i,a]=le.useState(null),[l,c]=le.useState(""),[d,p]=le.useState(""),[m,_]=le.useState(!1),b=async S=>{var k;const N=(k=S.target.files)==null?void 0:k[0];if(!N)return;const j=new FileReader;j.onloadend=async()=>{const L=j.result.split(",")[1];a(j.result),_(!0);try{const H=await HP(L,t);c(H),n(H)}catch(H){console.error(H),alert("Li khi phn tch nh: "+(H instanceof Error?H.message:String(H)))}finally{_(!1)}},j.readAsDataURL(N)},x=()=>{d.trim()&&e(d)};return f.jsxs("div",{className:"flex flex-col h-full space-y-6 p-6 border-r border-gray-200 bg-white",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx("h2",{className:"text-xl font-bold text-indigo-700",children:"HOT AI Visual Director"}),f.jsx("p",{className:"text-xs text-gray-500 italic",children:"Professional image direction & analysis"})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Ti nh phong cch"}),f.jsxs("div",{className:"relative group",children:[f.jsxs("div",{className:`border-2 border-dashed rounded-xl p-4 transition-all duration-300 flex flex-col items-center justify-center cursor-pointer ${i?"border-indigo-400 bg-indigo-50":"border-gray-300 hover:border-indigo-500 hover:bg-gray-50"}`,children:[f.jsx("input",{type:"file",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",onChange:b,accept:"image/*"}),i?f.jsx("img",{src:i,alt:"Reference",className:"w-full h-32 object-cover rounded-lg shadow-sm"}):f.jsxs("div",{className:"text-center",children:[f.jsx("svg",{className:"mx-auto h-10 w-10 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),f.jsx("span",{className:"mt-2 block text-xs font-medium text-gray-600",children:"Click hoc ko th nh vo y"})]})]}),m&&f.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-70 flex items-center justify-center rounded-xl",children:f.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Phong cch phn tch"}),f.jsx("textarea",{value:l,onChange:S=>{c(S.target.value),n(S.target.value)},className:"w-full h-32 p-3 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent resize-none bg-gray-50",placeholder:"c im phong cch s hin  y..."})]}),f.jsxs("div",{className:"flex-grow flex flex-col space-y-2",children:[f.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Nhp kch bn"}),f.jsx("textarea",{value:d,onChange:S=>p(S.target.value),className:"flex-grow w-full p-3 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent resize-none",placeholder:"Dn kch bn ca bn vo y..."})]}),f.jsx("button",{onClick:x,className:"w-full py-3 px-4 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-xl shadow-lg transform transition-all active:scale-95 focus:outline-none focus:ring-4 focus:ring-indigo-200",children:"Chia Kch Bn"}),f.jsx("div",{className:"text-[10px] text-gray-400 text-center uppercase tracking-widest",children:" 2024 HOT AI Studio"})]})},WP=({tags:n,style:e,apiKey:t,onNotify:i})=>{const a=le.useRef([]),[l,c]=le.useState(!1),[d,p]=le.useState(""),m=async()=>{if(n.length!==0){c(!0),p("ang x l...");try{for(let x=0;x<a.current.length;x++){const S=a.current[x];S&&(p(`ang x l Tag ${x+1}/${n.length}...`),console.log(`Auto processing tag ${x+1}/${n.length}...`),await S.runAutoSequence())}p("Hon tt!")}catch(x){console.error(x),p("C li xy ra!"),i("Qu trnh t ng b gin on do li.","error")}finally{c(!1),setTimeout(()=>p(""),5e3)}}},_=()=>{const x=[];if(a.current.forEach(S=>{if(S){const j=S.getRows().map(k=>k.trim()).filter(k=>k.length>0).map(k=>k.replace(/\r?\n|\r/g," ")).map(k=>k.replace(/^["']+|["']+$/g,""));x.push(...j)}}),x.length===0){i("Khng c kch bn  chia hng  copy!","info");return}navigator.clipboard.writeText(x.join(`
`)),i(` copy chnh xc ${x.length} hng kch bn!`,"success")},b=()=>{const x=[];if(a.current.forEach(S=>{if(S){const j=S.getPrompts().map(k=>k.trim()).filter(k=>k.length>0).map(k=>k.replace(/\r?\n|\r/g," ")).map(k=>k.replace(/^["']+|["']+$/g,""));x.push(...j)}}),x.length===0){i("Khng c prompt  copy!","info");return}navigator.clipboard.writeText(x.join(`
`)),i(` copy chnh xc ${x.length} prompt!`,"success")};return n.length===0?f.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-gray-400 space-y-4 p-12 bg-white rounded-3xl border border-gray-100 border-dashed",children:[f.jsx("svg",{className:"w-16 h-16 opacity-20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),f.jsx("p",{className:"text-lg font-medium",children:"Cha c kch bn c chia"}),f.jsx("p",{className:"text-sm",children:'Vui lng nhp kch bn v nhn "Chia Kch Bn"  ct tri'})]}):(a.current.length!==n.length&&(a.current=new Array(n.length).fill(null)),f.jsxs("div",{className:"space-y-8 pb-12",children:[f.jsxs("div",{className:"flex flex-wrap items-center gap-3 p-4 bg-gray-100 rounded-2xl sticky top-4 z-10 shadow-sm border border-gray-200",children:[f.jsx("button",{onClick:m,disabled:l,className:`px-6 py-2.5 rounded-xl font-bold text-sm transition-all flex items-center gap-2 ${l?"bg-gray-400 text-white cursor-not-allowed":"bg-gradient-to-r from-indigo-600 to-blue-600 hover:from-indigo-700 hover:to-blue-700 text-white shadow-md active:scale-95"}`,children:l?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"ang T ng..."]}):f.jsxs(f.Fragment,{children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"T ng Hon Ton"]})}),f.jsxs("button",{onClick:_,className:"px-5 py-2.5 bg-white border border-gray-200 text-gray-700 rounded-xl font-bold text-sm hover:bg-gray-50 transition-all shadow-sm active:scale-95 flex items-center gap-2",children:[f.jsx("svg",{className:"w-4 h-4 text-teal-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),"Copy All Kch Bn"]}),f.jsxs("button",{onClick:b,className:"px-5 py-2.5 bg-white border border-gray-200 text-gray-700 rounded-xl font-bold text-sm hover:bg-gray-50 transition-all shadow-sm active:scale-95 flex items-center gap-2",children:[f.jsx("svg",{className:"w-4 h-4 text-purple-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Copy All Prompt Anh"]})]}),d&&f.jsxs("div",{className:`mx-4 mt-2 p-3 rounded-xl text-sm font-bold flex items-center gap-2 ${d==="C li xy ra!"?"bg-red-50 text-red-600":"bg-green-50 text-green-700 border border-green-200"}`,children:[d==="Hon tt!"?f.jsx("svg",{className:"w-5 h-5 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}):f.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-current border-t-transparent animate-spin"}),d]}),f.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[f.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Bng iu Khin Tags"}),f.jsx("div",{className:"h-px flex-grow bg-gray-100"}),f.jsxs("span",{className:"text-sm font-medium text-gray-400",children:[n.length," TAGS SN SNG"]})]}),f.jsx("div",{className:"space-y-8",children:n.map((x,S)=>f.jsx(KP,{tag:x,style:e,index:S,apiKey:t,ref:N=>{a.current[S]=N},onNotify:i},x.id))})]}))},QP=({userId:n})=>{const[e,t]=le.useState(""),[i,a]=le.useState([]),[l,c]=le.useState(""),[d,p]=le.useState(null),m=(x,S="info")=>{p({message:x,type:S}),setTimeout(()=>p(null),5e3)};le.useEffect(()=>{if(n)try{const x=`app_api_keys_${n}`,S=localStorage.getItem(x);if(S){const N=JSON.parse(S),k=atob(N.gemini||"").split(`
`).map(L=>L.trim()).filter(L=>L);c(k.join(`
`))}}catch(x){console.error("Failed to load API key",x)}},[n]);const _=le.useCallback(x=>{const S=/[\u3040-\u30ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff\uff66-\uff9f]/.test(x);let N=[];if(S)for(let k=0;k<x.length;k+=2e3)N.push(x.substring(k,k+2e3));else{const k=x.split(/\s+/),L=1400;for(let H=0;H<k.length;H+=L)N.push(k.slice(H,H+L).join(" "))}const j=N.map((k,L)=>({id:crypto.randomUUID(),content:k}));a(j)},[]),b=x=>{t(x)};return f.jsxs("div",{className:"flex h-screen w-full overflow-hidden bg-gray-50",children:[f.jsx("aside",{className:"w-[30%] min-w-[320px] max-w-[450px] flex-shrink-0 h-full",children:f.jsx(YP,{onStyleChange:b,onSplitScript:_,apiKey:l})}),f.jsx("main",{className:"flex-grow h-full overflow-y-auto p-8 lg:p-12 scroll-smooth",children:f.jsxs("div",{className:"max-w-4xl mx-auto",children:[f.jsxs("header",{className:"mb-12",children:[f.jsxs("h1",{className:"text-4xl font-extrabold text-gray-900 tracking-tight",children:["HOT ",f.jsx("span",{className:"text-indigo-600",children:"AI"})]}),f.jsx("p",{className:"mt-2 text-gray-500 font-medium",children:"H thng sn xut Visual Prompts chuyn nghip"})]}),f.jsx(xS,{children:f.jsxs("div",{className:"relative",children:[d&&f.jsx("div",{className:"fixed top-4 right-4 z-50 animate-in slide-in-from-right fade-in duration-300",children:f.jsxs("div",{className:`px-6 py-4 rounded-2xl shadow-2xl flex items-center gap-3 font-bold text-sm ${d.type==="error"?"bg-rose-50 text-rose-600 border border-rose-100":d.type==="success"?"bg-emerald-50 text-emerald-600 border border-emerald-100":"bg-white text-slate-700 border border-slate-100"}`,children:[d.type==="success"&&f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),d.type==="error"&&f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),d.message]})}),f.jsx(WP,{tags:i,style:e,apiKey:l,onNotify:m})]})})]})})]})};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JP=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),XP=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),Dx=n=>{const e=XP(n);return e.charAt(0).toUpperCase()+e.slice(1)},TS=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim(),ZP=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var eM={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tM=le.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:a="",children:l,iconNode:c,...d},p)=>le.createElement("svg",{ref:p,...eM,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:TS("lucide",a),...!l&&!ZP(d)&&{"aria-hidden":"true"},...d},[...c.map(([m,_])=>le.createElement(m,_)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rn=(n,e)=>{const t=le.forwardRef(({className:i,...a},l)=>le.createElement(tM,{ref:l,iconNode:e,className:TS(`lucide-${JP(Dx(n))}`,`lucide-${n}`,i),...a}));return t.displayName=Dx(n),t};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nM=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],sM=Rn("activity",nM);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iM=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],rM=Rn("camera",iM);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aM=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],ES=Rn("circle-check",aM);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oM=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],lM=Rn("clipboard-list",oM);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cM=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],SS=Rn("copy",cM);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uM=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],Px=Rn("image",uM);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hM=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],dM=Rn("layers",hM);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fM=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Ra=Rn("loader-circle",fM);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gM=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],AS=Rn("play",gM);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pM=[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]],NS=Rn("scissors",pM);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mM=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],CS=Rn("trash-2",mM);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yM=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Mx=Rn("upload",yM);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vM=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],_M=Rn("video",vM);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bM=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Lx=Rn("zap",bM),Qp={},wM=n=>{let e=[];if(n&&(e=n.split(`
`).map(t=>t.trim()).filter(t=>t)),e.length===0){const t=Qp==null?void 0:Qp.VITE_GEMINI_API_KEY;t&&e.push(t)}return e},xM=["gemini-2.0-flash-lite-preview-02-05","gemini-2.5-flash","gemini-2.0-flash-lite-001","gemini-2.0-flash-exp","gemini-2.0-flash-001","gemini-2.0-flash","gemini-2.5-pro","gemini-flash-latest"],yl=async(n,e)=>{const t=wM(n);if(t.length===0)throw new Error("No API Keys provided.");let i;for(const a of t){const l=new Xd(a);for(const c of xM)try{const d=l.getGenerativeModel({model:c});return await e(d)}catch(d){console.warn(`Failed: Key(...${a.slice(-4)}) Model(${c}) error: ${d.message}`),i=d}}throw i||new Error("All keys and models failed to generate content.")},TM=async(n,e)=>yl(e,async t=>(await t.generateContent([{inlineData:{mimeType:"image/jpeg",data:n}},{text:"Analyze this image and describe its visual style in detail (lighting, color palette, texture, composition, atmosphere). Provide a concise but comprehensive paragraph suitable for an image generation prompt style reference."}])).response.text()||"No analysis found."),EM=async(n,e)=>yl(e,async t=>{const i={type:Ws.ARRAY,items:{type:Ws.OBJECT,properties:{name:{type:Ws.STRING},gender:{type:Ws.STRING},country:{type:Ws.STRING},age:{type:Ws.STRING},physique:{type:Ws.STRING},features:{type:Ws.STRING}},required:["name","gender","country","age","physique","features"]}},a=`Analyze the following script and extract/create characters. For each character, provide: Name, Gender, Country, Age, Physique, and Detailed Facial Features. 
        
        CRITICAL RULES:
        1. If details are missing in the script (Gender, Country, Age, Physique, or Face), you MUST creatively generate them to make the character visually distinct.
        2. Focus HEAVILY on specific facial features: eye shape/color, nose shape, skin texture, wrinkles, hair style/texture/color, and any unique facial markings.
        3. ABSOLUTELY NO clothing, NO personality traits, and NO equipment.
        4. Format the 'features' field as descriptive sentences about the face and hair only.
        
        Example structure: "Mi tc en bng mt vi nhng si bc thanh lch c bi cht thnh kiu tc truyn thng gn gng. Ln da mn mng. i mt nu sm hnh qu hnh m p, np nhn nh quanh khe mt, chic mi nh nhn, thanh t."
        
        Output in JSON format as an array of objects. Script: ${n}`,l=await t.generateContent({contents:[{role:"user",parts:[{text:a}]}],generationConfig:{responseMimeType:"application/json",responseSchema:i}});return JSON.parse(l.response.text()||"[]")}),SM=async(n,e)=>yl(e,async t=>{var c;const i=`Bn l chuyn gia phn tch kch bn. Hy m s lng "hnh ng th gic" (visual actions) chnh trong kch bn di y.
        
        QUY TC:
        1. Ch m cc hnh ng c th c th dng thnh hnh nh (v d: "chy", "cm bento", "nhn xa xm").
        2. B qua cc li dn truyn (narration) mang tnh suy tng v cc suy ngh ni tm khng th hin qua hnh ng/biu cm.
        3. Tr v DUY NHT mt con s.
        
        KCH BN:
        ${n}`,a=await t.generateContent(i),l=parseInt(((c=a.response.text())==null?void 0:c.trim())||"0");return isNaN(l)?0:l}),AM=async(n,e,t)=>yl(t,async i=>{const a=`Bn l mt cng c chia kch bn chuyn nghip. Hy chia kch bn di y thnh ng ${e} hng.
        
        CC QUY TC TI THNG:
        1. CH TR V CC HNG KCH BN. Khng c bt k cu dn nhp no.
        2. GI NGUYN 100% VN BN GC. Tuyt i khng xa b, khng chnh sa, khng thm bt bt k k t no.
        3. Tr v ng ${e} dng, mi dng l mt phn on logic.
        
        KCH BN:
        ${n}`;return((await i.generateContent(a)).response.text()||"").trim().split(`
`).filter(d=>d.trim().length>0)}),NM=async(n,e,t,i,a)=>yl(a,async l=>{const d=`Bn l ZenShot AI - Mt Visual Director k lut st . Nhim v ca bn l chuyn i kch bn thnh Image Prompts cho Midjourney.
    
    QUY TC CT LI (BT BUC TUN TH 100%):
    1. NH DNG: Mi prompt phi nm trn MT HNG DUY NHT (Single line). Khng xung dng bn trong mt prompt.
    2. KHNG TM TT: Copy-paste NGUYN VN m t nhn vt t d liu bn di.
    3. B NH TRNG THI:
       - Nu c thng tin cnh trc (Previous Context), hy k tha trang phc v bi cnh t  tr khi kch bn thay i.
       - Lun duy tr tnh nht qun v qun o v bi cnh cho cc phn on lin tip.
    4. CU TRC PROMPT (Vit lin thnh 1 on vn): 
       [Phong cch/Gc my] + [Hnh ng/Biu cm] + [Tn nhn vt: M t chi tit nguyn vn] + [Trang phc hin ti] + [Bi cnh chi tit] + --ar 16:9
    
    D LIU NHN VT:
    ${t.map(_=>`${_.name}: ${_.gender}, ${_.country}, ${_.age}, ${_.physique}. ${_.features}`).join(`
`)}
    
    PHONG CCH VISUAL:
    ${e}
    
    BI CNH/TRANG PHC CA CC TAG TRC (NU C):
    ${i||"Khng c cnh trc."}
    
    HY TO PROMPT CHO CC PHN ON SAU (Mi prompt 1 hng):
    ${n.map((_,b)=>`Row ${b+1}: ${_}`).join(`
`)}
    
    Ch tr v danh sch cc prompt. Mi prompt l 1 hng.`;return{prompts:((await l.generateContent(d)).response.text()||"").split(`
`).filter(_=>_.trim().length>0)}}),CM=async(n,e,t,i,a)=>yl(a,async l=>{const d=`Bn l o din hnh nh (Visual Director) chuyn v Video/Cinematic. Nhim v ca bn l phn tch ni dung on "Hook" v to Video Prompts (din t chuyn ng).
    
    YU CU CHI TIT:
    1. PHN TCH HNH NG: Mi hnh ng c th trong on Hook phi c mt prompt ring bit.
    2. NG B NHN VT: Copy-paste NGUYN VN m t nhn vt t d liu bn di khi nhn vt  xut hin trong hnh ng.
    3. CHUYN NG (MOTION): M t r loi chuyn ng (v d: "Slo-mo walking", "Cinematic drone shot following", "Close-up of facial expression change").
    4. BI CNH/TRANG PHC: K tha t thng tin bi cnh  cung cp.
    5. NH DNG: Mi prompt l 1 hng duy nht.
    
    CU TRC PROMPT:
    [Loi chuyn ng/Gc my] + [Hnh ng nhn vt] + [M t nhn vt chi tit] + [Trang phc & Bi cnh]
    
    D LIU NHN VT:
    ${t.map(m=>`${m.name}: ${m.gender}, ${m.country}, ${m.age}, ${m.physique}. ${m.features}`).join(`
`)}
    
    PHONG CCH VISUAL:
    ${e}
    
    BI CNH/TRANG PHC K THA:
    ${i||"T do sng to da trn khng kh chung."}
    
    NI DUNG ON HOOK CN X L:
    ${n}
    
    Ch tr v danh sch cc prompt video, mi prompt mt hng.`;return((await l.generateContent(d)).response.text()||"").split(`
`).filter(m=>m.trim().length>0)});class RM extends le.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("ErrorBoundary caught error:",e,t)}render(){var e;return this.state.hasError?f.jsxs("div",{className:"p-8 m-8 bg-slate-900 border border-slate-700 rounded-3xl space-y-4 text-center text-white",children:[f.jsx("h2",{className:"text-xl font-bold text-rose-500",children:" xy ra li hin th"}),f.jsx("p",{className:"text-slate-300",children:(e=this.state.error)==null?void 0:e.message}),f.jsx("button",{onClick:()=>this.setState({hasError:!1}),className:"px-6 py-3 bg-white text-slate-900 font-bold rounded-xl hover:bg-slate-200 transition-all",children:"Th li"}),f.jsx("p",{className:"text-xs text-slate-500",children:"D liu vn c lu trong b nh tm."})]}):this.props.children}}const IM=({userId:n})=>{const[e,t]=le.useState({visualStyle:"",script:"",characters:[],tags:[],hook:"",hookPrompts:[],isAnalyzing:!1,isProcessingScript:!1,isGeneratingHook:!1}),[i,a]=le.useState(!1),[l,c]=le.useState(!1),[d,p]=le.useState(""),[m,_]=le.useState(null),[b,x]=le.useState(null),S=(ce,ue="info")=>{x({message:ce,type:ue}),setTimeout(()=>x(null),5e3)};le.useEffect(()=>{if(n)try{const ce=`app_api_keys_${n}`,ue=localStorage.getItem(ce);if(ue){const U=JSON.parse(ue),pe=atob(U.gemini||"").split(`
`).map(be=>be.trim()).filter(be=>be);p(pe.join(`
`))}}catch(ce){console.error("Failed to load API key",ce)}},[n]);const N=le.useRef(e.tags);le.useEffect(()=>{N.current=e.tags},[e.tags]);const j=ce=>new Promise(ue=>setTimeout(ue,ce)),k=async ce=>{var se;const ue=(se=ce.target.files)==null?void 0:se[0];if(!ue)return;a(!0);const U=new FileReader;U.onload=async pe=>{var V;const be=(V=pe.target)==null?void 0:V.result;_(be);const Ve=be.split(",")[1];try{const te=await TM(Ve,d);t(de=>({...de,visualStyle:te}))}catch(te){S(`Li phn tch style: ${te.message||te}`,"error")}finally{a(!1)}},U.readAsDataURL(ue)},L=async()=>{if(e.script){t(ce=>({...ce,isProcessingScript:!0}));try{const ce=await EM(e.script,d);t(ue=>({...ue,characters:ce,isProcessingScript:!1}))}catch(ce){S(`Li x l kch bn: ${ce.message||ce}`,"error"),t(ue=>({...ue,isProcessingScript:!1}))}}},H=ce=>{const ue=/[\u3000-\u303f\u3040-\u309f\u30a0-\u30ff\uff00-\uff9f\u4e00-\u9faf\u3400-\u4dbf\uac00-\ud7af]/.test(ce),U=[];let se=ce;const pe=ue?1800:1200,be=ue?2e3:1500,Ve=ue?[`
`,"","","",".","!","?"]:[`
`,".","!","?"];for(;se.length>0;)if(ue){if(se.length<=be){U.push(se);break}let V=se.slice(pe,be),te=-1;for(const de of Ve){const ge=V.lastIndexOf(de);ge>te&&(te=ge)}if(te!==-1){const de=pe+te+1;U.push(se.slice(0,de)),se=se.slice(de)}else U.push(se.slice(0,be)),se=se.slice(be)}else{const V=se.split(/(\s+)/);let te=0,de=0,ge=-1,Se=!1;for(let ke=0;ke<V.length;ke++){const Le=V[ke];/\S/.test(Le)&&te++;const he=de;if(de+=Le.length,te>=pe&&te<=be&&Ve.some(ye=>Le.includes(ye))&&(ge=de),te>be){const ye=ge!==-1?ge:he;U.push(se.slice(0,ye)),se=se.slice(ye),Se=!0;break}}if(!Se){U.push(se);break}}return U},B=()=>{if(!e.script)return;const ue=H(e.script).map((U,se)=>({id:`tag-${Date.now()}-${se}`,originalContent:U,rows:[U],imageCount:10,prompts:[],status:"idle"}));t(U=>({...U,tags:ue}))},K=(ce,ue)=>{t(U=>({...U,tags:U.tags.map(se=>se.id===ce?{...se,...ue}:se)}))},F=(ce,ue)=>{t(U=>({...U,characters:U.characters.map((se,pe)=>pe===ce?{...se,...ue}:se)}))},$=async ce=>{const ue=N.current.find(U=>U.id===ce);if(!ue)return!1;K(ce,{status:"splitting"});try{const U=await AM(ue.originalContent,ue.imageCount,d);return K(ce,{rows:U,status:"ready"}),!0}catch(U){return console.error(`Error splitting rows for TAG: ${ce}`,U),S(`Li chia hng: ${U.message||U}`,"error"),K(ce,{status:"idle"}),!1}},A=async ce=>{const ue=N.current,U=ue.findIndex(be=>be.id===ce);if(U===-1)return!1;const se=ue[U];let pe="";if(U>0){const be=ue[U-1];be&&be.prompts.length>0&&(pe=`y l prompt cui ca Tag trc  bn k tha bi cnh v trang phc: ${be.prompts[be.prompts.length-1]}`)}K(ce,{status:"generating"});try{const be=await NM(se.rows,e.visualStyle,e.characters,pe,d);if(!be.prompts||be.prompts.length===0)throw new Error("Empty prompts generated");return K(ce,{prompts:be.prompts,status:"ready"}),!0}catch(be){return console.error(`Error generating prompts for TAG: ${ce}`,be),K(ce,{status:"ready"}),!1}},C=async()=>{if(!e.hook||e.characters.length===0){S("Vui lng nhp ni dung Hook v m bo  phn tch nhn vt.","info");return}t(U=>({...U,isGeneratingHook:!0}));let ce="";const ue=e.tags[e.tags.length-1];ue&&ue.prompts.length>0&&(ce=`K tha bi cnh t prompt ny: ${ue.prompts[ue.prompts.length-1]}`);try{const U=await CM(e.hook,e.visualStyle,e.characters,ce,d);t(se=>({...se,hookPrompts:U,isGeneratingHook:!1}))}catch(U){S(`Li to Prompt Video Hook: ${U.message||U}`,"error"),t(se=>({...se,isGeneratingHook:!1}))}},I=async ce=>{const ue=e.tags.find(U=>U.id===ce);if(ue){K(ce,{status:"analyzing"});try{const U=await SM(ue.originalContent,d);K(ce,{actionCount:U,status:"idle"})}catch(U){S(`Li phn tch hnh ng: ${U.message||U}`,"error"),K(ce,{status:"idle"})}}},D=async()=>{if(e.tags.length===0)return;c(!0);const ce=e.tags.map(ue=>ue.id);for(const ue of ce){if(!await $(ue)&&!await $(ue))break;await j(1e4);let se=await A(ue);if(se||(await j(1e4),se=await A(ue)),!se&&!confirm(`TAG ${ue} khng th to prompt sau 2 ln th. Bn c mun tip tc cc TAG sau khng?`))break;await j(1e4)}c(!1),S("Hon thnh quy trnh t ng cho tt c cc TAG!","success")},M=()=>{const ue=e.tags.flatMap(U=>(U.status==="ready"||U.status==="generating"?U.rows.join(`
`):U.originalContent).split(`
`).map(pe=>pe.trim()).filter(pe=>pe.length>0)).join(`
`);navigator.clipboard.writeText(ue),S(" copy ton b kch bn ca tt c cc TAG!","success")},q=()=>{const ce=e.tags.flatMap(ue=>ue.prompts).map(ue=>ue.trim()).filter(ue=>ue.length>0).join(`
`);navigator.clipboard.writeText(ce),S(" copy ton b Prompt ca tt c cc TAG!","success")},O=()=>{const ce=e.hookPrompts.join(`
`);navigator.clipboard.writeText(ce),S(" copy Prompt Video cho Hook!","success")};return f.jsx(RM,{children:f.jsxs("div",{className:"flex h-screen bg-slate-50 overflow-hidden text-slate-900 w-full relative",children:[b&&f.jsx("div",{className:"absolute top-4 right-4 z-50 animate-in slide-in-from-right fade-in duration-300",children:f.jsxs("div",{className:`px-6 py-4 rounded-2xl shadow-2xl flex items-center gap-3 font-bold text-sm ${b.type==="error"?"bg-rose-50 text-rose-600 border border-rose-100":b.type==="success"?"bg-emerald-50 text-emerald-600 border border-emerald-100":"bg-white text-slate-700 border border-slate-100"}`,children:[b.type==="success"&&f.jsx(ES,{className:"w-5 h-5"}),b.type==="error"&&f.jsx(CS,{className:"w-5 h-5"}),b.message]})}),f.jsxs("aside",{className:"w-[30%] bg-white border-r border-slate-200 overflow-y-auto p-6 space-y-8 flex flex-col shrink-0",children:[f.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[f.jsx("div",{className:"bg-indigo-600 p-2 rounded-lg",children:f.jsx(rM,{className:"text-white w-6 h-6"})}),f.jsx("h1",{className:"text-xl font-black text-slate-800 tracking-tight uppercase",children:"ZenShot AI"})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("label",{className:"flex items-center gap-2 text-xs font-bold text-slate-500 uppercase tracking-widest",children:[f.jsx(Px,{className:"w-3.5 h-3.5"})," Phong cch hnh nh"]}),f.jsxs("div",{className:`border-2 border-dashed border-slate-200 rounded-xl p-4 transition hover:border-indigo-400 bg-slate-50/50 relative group overflow-hidden ${m?"border-none p-0":""}`,children:[f.jsx("input",{type:"file",accept:"image/*",onChange:k,className:"hidden",id:"image-upload"}),f.jsx("label",{htmlFor:"image-upload",className:`cursor-pointer flex flex-col items-center justify-center gap-2 py-2 w-full h-full ${m?"p-0":""}`,children:i?f.jsxs("div",{className:"py-8 flex flex-col items-center",children:[f.jsx(Ra,{className:"animate-spin text-indigo-500 w-8 h-8"}),f.jsx("span",{className:"text-[10px] text-indigo-500 font-bold mt-2 uppercase tracking-wider",children:"ang phn tch..."})]}):m?f.jsxs("div",{className:"relative w-full h-48",children:[f.jsx("img",{src:m,alt:"Style Reference",className:"w-full h-full object-cover rounded-lg shadow-sm"}),f.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity rounded-lg",children:f.jsxs("div",{className:"flex items-center gap-2 text-white text-xs font-bold uppercase tracking-widest bg-black/50 px-3 py-2 rounded-full backdrop-blur-sm border border-white/20",children:[f.jsx(Mx,{className:"w-3 h-3"})," Thay i nh"]})})]}):f.jsxs(f.Fragment,{children:[f.jsx(Mx,{className:"text-slate-400 w-6 h-6"}),f.jsx("span",{className:"text-[10px] text-slate-400 font-bold uppercase tracking-tighter",children:"Phn tch phong cch qua nh"})]})})]}),f.jsx("textarea",{className:"w-full h-24 p-3 text-sm bg-white border border-slate-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none transition placeholder:italic",placeholder:"Phong cch chi tit s hin  y...",value:e.visualStyle,onChange:ce=>t(ue=>({...ue,visualStyle:ce.target.value}))})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsx("label",{className:"flex items-center gap-2 text-xs font-bold text-slate-500 uppercase tracking-widest",children:"Nhp kch bn chnh"}),f.jsx("textarea",{className:"w-full h-40 p-3 text-sm border border-slate-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none transition leading-relaxed",placeholder:"Dn kch bn ca bn vo y...",value:e.script,onChange:ce=>t(ue=>({...ue,script:ce.target.value}))}),f.jsxs("button",{onClick:L,disabled:e.isProcessingScript||!e.script,className:"w-full flex items-center justify-center gap-2 bg-indigo-600 hover:bg-indigo-700 disabled:bg-slate-300 text-white font-bold py-3.5 px-4 rounded-xl transition shadow-lg shadow-indigo-100 uppercase text-xs tracking-widest",children:[e.isProcessingScript?f.jsx(Ra,{className:"animate-spin w-4 h-4"}):f.jsx(AS,{className:"w-4 h-4 fill-current"}),"Bt u phn tch kch bn"]})]}),e.characters.length>0&&f.jsxs("div",{className:"space-y-4 pt-4 border-t border-slate-100",children:[f.jsx("label",{className:"flex items-center gap-2 text-xs font-bold text-slate-500 uppercase tracking-widest",children:"Thng tin nhn vt (C th chnh sa)"}),f.jsx("div",{className:"space-y-4 max-h-[500px] overflow-y-auto pr-1",children:e.characters.map((ce,ue)=>f.jsxs("div",{className:"p-4 bg-white rounded-xl border border-slate-200 shadow-sm relative overflow-hidden transition hover:border-indigo-300 group",children:[f.jsx("div",{className:"absolute top-0 left-0 w-1 h-full bg-indigo-500"}),f.jsxs("div",{className:"flex flex-col gap-2",children:[f.jsx("input",{className:"font-black text-slate-800 text-[11px] uppercase bg-transparent border-none p-0 focus:ring-0",value:ce.name,onChange:U=>F(ue,{name:U.target.value})}),f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsx("input",{className:"text-[10px] bg-slate-50 border border-slate-100 rounded px-2 py-1 focus:ring-1 focus:ring-indigo-400",value:ce.gender,placeholder:"Gender",onChange:U=>F(ue,{gender:U.target.value})}),f.jsx("input",{className:"text-[10px] bg-slate-50 border border-slate-100 rounded px-2 py-1 focus:ring-1 focus:ring-indigo-400",value:ce.age,placeholder:"Age",onChange:U=>F(ue,{age:U.target.value})})]}),f.jsx("textarea",{className:"text-[10px] text-slate-700 leading-relaxed font-medium bg-slate-50 border border-slate-100 rounded p-2 focus:ring-1 focus:ring-indigo-400 resize-none h-20",value:ce.features,onChange:U=>F(ue,{features:U.target.value})})]})]},ue))})]}),f.jsx("div",{className:"mt-auto pt-6",children:f.jsxs("button",{onClick:B,disabled:!e.script,className:"w-full flex items-center justify-center gap-2 bg-slate-800 hover:bg-slate-900 text-white font-bold py-3.5 px-4 rounded-xl transition uppercase text-xs tracking-widest",children:[f.jsx(NS,{className:"w-4 h-4"}),"Chia kch bn sang TAG"]})})]}),f.jsxs("main",{className:"flex-1 overflow-y-auto bg-slate-50 scroll-smooth flex flex-col",children:[e.tags.length>0&&f.jsxs("div",{className:"sticky top-0 z-10 bg-white/80 backdrop-blur-md border-b border-slate-200 px-8 py-4 flex items-center justify-between shadow-sm",children:[f.jsx("div",{className:"flex items-center gap-3",children:f.jsxs("button",{onClick:D,disabled:l,className:"flex items-center gap-2 bg-indigo-600 hover:bg-indigo-700 disabled:bg-indigo-300 text-white px-5 py-2.5 rounded-xl font-black text-[11px] uppercase tracking-widest shadow-lg shadow-indigo-100 transition-all active:scale-95",children:[l?f.jsx(Ra,{className:"animate-spin w-4 h-4"}):f.jsx(Lx,{className:"w-4 h-4 fill-amber-400 text-amber-400"}),"T ng Hon Ton"]})}),f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsxs("button",{onClick:M,className:"flex items-center gap-2 bg-slate-800 hover:bg-slate-900 text-white px-5 py-2.5 rounded-xl font-black text-[11px] uppercase tracking-widest transition-all active:scale-95",children:[f.jsx(lM,{className:"w-4 h-4"}),"Copy All Kch Bn"]}),f.jsxs("button",{onClick:q,className:"flex items-center gap-2 bg-slate-800 hover:bg-slate-900 text-white px-5 py-2.5 rounded-xl font-black text-[11px] uppercase tracking-widest transition-all active:scale-95",children:[f.jsx(dM,{className:"w-4 h-4"}),"Copy All Prompt nh"]})]})]}),f.jsx("div",{className:"max-w-4xl mx-auto space-y-8 p-8 w-full",children:e.tags.length===0?f.jsxs("div",{className:"h-[70vh] flex flex-col items-center justify-center text-slate-300 space-y-6",children:[f.jsx("div",{className:"w-24 h-24 bg-white rounded-full flex items-center justify-center shadow-sm border border-slate-100",children:f.jsx(Px,{className:"w-10 h-10 opacity-40"})}),f.jsxs("div",{className:"text-center",children:[f.jsx("p",{className:"text-xl font-bold text-slate-400",children:"ZenShot Visual Director"}),f.jsx("p",{className:"text-sm text-slate-400 mt-1 uppercase tracking-widest font-bold opacity-60",children:"Split script and start generating prompts"})]})]}):f.jsxs(f.Fragment,{children:[e.tags.map((ce,ue)=>f.jsx(kM,{tag:ce,index:ue,onSplit:()=>$(ce.id),onAnalyze:()=>I(ce.id),onGenerate:()=>A(ce.id),onUpdateCount:U=>K(ce.id,{imageCount:U}),onCopy:()=>{const U=ce.prompts.map(se=>se.trim()).join(`
`);navigator.clipboard.writeText(U),S("Copied prompts for this TAG!","success")},onUpdateContent:U=>K(ce.id,{originalContent:U}),onDelete:()=>t(U=>({...U,tags:U.tags.filter(se=>se.id!==ce.id)}))},ce.id)),f.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden transition hover:shadow-lg mt-12 mb-20 p-8 space-y-6",children:[f.jsxs("div",{className:"flex items-center justify-between border-b border-slate-50 pb-4",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("span",{className:"bg-amber-500 text-white text-[10px] font-black px-3 py-1 rounded-full uppercase tracking-widest",children:"VIDEO HOOK"}),f.jsx("h2",{className:"text-sm font-black text-slate-800 uppercase tracking-widest",children:"Phn tch chuyn ng"})]}),f.jsx(_M,{className:"w-5 h-5 text-slate-300"})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Ni dung on Hook"}),f.jsx("textarea",{className:"w-full h-40 p-4 text-sm bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:outline-none resize-none leading-relaxed transition font-medium",placeholder:"Nhp ni dung on Hook kch bn ti y...",value:e.hook,onChange:ce=>t(ue=>({...ue,hook:ce.target.value}))})]}),e.hookPrompts.length>0&&f.jsxs("div",{className:"space-y-4 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Prompts Video Chuyn ng"}),f.jsxs("button",{onClick:O,className:"flex items-center gap-1.5 text-amber-600 hover:text-amber-700 text-[10px] font-black px-4 py-2 bg-amber-50 rounded-xl transition uppercase tracking-widest shadow-sm shadow-amber-50",children:[f.jsx(SS,{className:"w-3.5 h-3.5"})," Copy Hook Prompts"]})]}),f.jsx("div",{className:"space-y-4",children:e.hookPrompts.map((ce,ue)=>f.jsxs("div",{className:"p-4 bg-slate-900 rounded-xl border border-slate-800 relative group transition hover:border-amber-500 shadow-lg",children:[f.jsx("div",{className:"absolute -left-3 top-4 w-7 h-7 bg-amber-500 text-white flex items-center justify-center text-[10px] font-black rounded-full border-2 border-slate-50 shadow-md",children:ue+1}),f.jsx("p",{className:"text-slate-300 text-[11px] font-mono break-words leading-relaxed pl-4",children:ce})]},ue))})]}),f.jsxs("button",{onClick:C,disabled:e.isGeneratingHook||!e.hook,className:"w-full flex items-center justify-center gap-2 bg-slate-800 hover:bg-slate-900 disabled:bg-slate-300 text-white font-black py-4.5 rounded-2xl transition shadow-xl shadow-slate-200 uppercase text-xs tracking-[0.2em]",children:[e.isGeneratingHook?f.jsx(Ra,{className:"animate-spin w-5 h-5"}):f.jsx(Lx,{className:"w-5 h-5 fill-amber-400 text-amber-400"}),"To Prompt Video"]})]})]})})]})]})})},kM=({tag:n,index:e,onSplit:t,onAnalyze:i,onGenerate:a,onUpdateCount:l,onCopy:c,onUpdateContent:d,onDelete:p})=>f.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden transition hover:shadow-lg",children:[f.jsxs("div",{className:"px-6 py-4 bg-slate-50/80 border-b border-slate-100 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsxs("span",{className:"bg-slate-800 text-white text-[10px] font-black px-3 py-1 rounded-full uppercase tracking-widest",children:["TAG ",e+1]}),f.jsxs("span",{className:"text-[10px] text-slate-400 font-black uppercase tracking-widest",children:[n.originalContent.length," k t"]})]}),f.jsx("button",{onClick:p,className:"text-slate-300 hover:text-red-500 transition p-1",children:f.jsx(CS,{className:"w-4 h-4"})})]}),f.jsxs("div",{className:"p-6 space-y-6",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Kch bn phn on"}),f.jsxs("div",{className:"relative group",children:[f.jsx("textarea",{className:"w-full h-40 p-4 text-sm bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:outline-none resize-none leading-relaxed transition font-medium",value:n.status==="ready"||n.status==="generating"?n.rows.join(`
`):n.originalContent,readOnly:n.status==="ready"||n.status==="generating",onChange:m=>d(m.target.value)}),(n.status==="ready"||n.status==="generating")&&n.rows.length>1&&f.jsxs("div",{className:"absolute top-2 right-2 flex items-center gap-1.5 bg-white text-emerald-600 px-3 py-1.5 rounded-lg text-[10px] font-black border border-emerald-100 shadow-sm uppercase",children:[f.jsx(ES,{className:"w-3 h-3"})," Chia hng xong"]})]})]}),f.jsxs("div",{className:"flex flex-wrap gap-6 items-end border-y border-slate-50 py-4",children:[f.jsxs("div",{className:"flex-1 space-y-2",children:[f.jsxs("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest flex items-center gap-2",children:[f.jsx(sM,{className:"w-3 h-3"})," Phn tch hnh ng"]}),f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("button",{onClick:i,disabled:n.status==="analyzing",className:"flex items-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-800 text-[10px] font-black rounded-lg transition uppercase tracking-widest",children:n.status==="analyzing"?f.jsx(Ra,{className:"animate-spin w-3 h-3"}):"Phn tch"}),n.actionCount!==void 0&&f.jsxs("div",{className:"flex items-center gap-1.5 text-indigo-600 font-black text-sm",children:[f.jsx("span",{className:"text-[10px] text-slate-400 font-bold",children:"S hnh ng:"})," ",n.actionCount]})]})]}),f.jsxs("div",{className:"w-40 space-y-2",children:[f.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"S lng nh"}),f.jsxs("div",{className:"relative flex items-center",children:[f.jsx("button",{onClick:()=>l(Math.max(1,n.imageCount-1)),className:"absolute left-1 w-7 h-7 flex items-center justify-center bg-slate-100 hover:bg-slate-200 text-slate-600 rounded-lg font-bold",children:"-"}),f.jsx("input",{type:"number",min:"1",max:"100",className:"w-full h-10 px-8 text-center border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:outline-none font-bold text-slate-700",value:n.imageCount,onChange:m=>l(parseInt(m.target.value)||1)}),f.jsx("button",{onClick:()=>l(n.imageCount+1),className:"absolute right-1 w-7 h-7 flex items-center justify-center bg-slate-100 hover:bg-slate-200 text-slate-600 rounded-lg font-bold",children:"+"})]})]}),f.jsxs("button",{onClick:t,disabled:n.status==="splitting",className:"h-10 px-6 flex items-center justify-center gap-2 bg-slate-800 hover:bg-slate-900 text-white font-bold rounded-xl transition uppercase text-[10px] tracking-widest shadow-sm",children:[n.status==="splitting"?f.jsx(Ra,{className:"animate-spin w-3 h-3"}):f.jsx(NS,{className:"w-3 h-3"}),"Chia hng"]})]}),n.prompts.length>0&&f.jsxs("div",{className:"space-y-4 pt-6",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Prompts Midjourney"}),f.jsxs("button",{onClick:c,className:"flex items-center gap-1.5 text-indigo-600 hover:text-indigo-700 text-[10px] font-black px-4 py-2 bg-indigo-50 rounded-xl transition uppercase tracking-widest shadow-sm shadow-indigo-50",children:[f.jsx(SS,{className:"w-3.5 h-3.5"})," Sao chp Tag ny"]})]}),f.jsx("div",{className:"space-y-4 max-h-[600px] overflow-y-auto pr-2 custom-scrollbar",children:n.prompts.map((m,_)=>f.jsxs("div",{className:"p-4 bg-slate-900 rounded-xl border border-slate-800 relative group transition hover:border-indigo-500 shadow-lg",children:[f.jsx("div",{className:"absolute -left-3 top-4 w-7 h-7 bg-indigo-600 text-white flex items-center justify-center text-[10px] font-black rounded-full border-2 border-slate-50 shadow-md",children:_+1}),f.jsx("p",{className:"text-slate-300 text-[11px] font-mono break-words leading-relaxed pl-4",children:m})]},_))})]}),f.jsxs("button",{onClick:a,disabled:n.status==="generating",className:"w-full flex items-center justify-center gap-2 bg-indigo-600 hover:bg-indigo-700 disabled:bg-indigo-300 text-white font-black py-4.5 rounded-2xl transition shadow-xl shadow-indigo-200 uppercase text-xs tracking-[0.2em]",children:[n.status==="generating"?f.jsx(Ra,{className:"animate-spin w-5 h-5"}):f.jsx(AS,{className:"w-5 h-5 fill-current"}),"To Prompt nh"]})]})]});function Ef(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t}function OM(n,e,t,i){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function d(_){try{m(i.next(_))}catch(b){c(b)}}function p(_){try{m(i.throw(_))}catch(b){c(b)}}function m(_){_.done?l(_.value):a(_.value).then(d,p)}m((i=i.apply(n,e||[])).next())})}const jM=n=>n?(...e)=>n(...e):(...e)=>fetch(...e);class Y0 extends Error{constructor(e,t="FunctionsError",i){super(e),this.name=t,this.context=i}}class DM extends Y0{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Ux extends Y0{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Vx extends Y0{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Um;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(Um||(Um={}));class PM{constructor(e,{headers:t={},customFetch:i,region:a=Um.Any}={}){this.url=e,this.headers=t,this.region=a,this.fetch=jM(i)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return OM(this,arguments,void 0,function*(t,i={}){var a;let l,c;try{const{headers:d,method:p,body:m,signal:_,timeout:b}=i;let x={},{region:S}=i;S||(S=this.region);const N=new URL(`${this.url}/${t}`);S&&S!=="any"&&(x["x-region"]=S,N.searchParams.set("forceFunctionRegion",S));let j;m&&(d&&!Object.prototype.hasOwnProperty.call(d,"Content-Type")||!d)?typeof Blob<"u"&&m instanceof Blob||m instanceof ArrayBuffer?(x["Content-Type"]="application/octet-stream",j=m):typeof m=="string"?(x["Content-Type"]="text/plain",j=m):typeof FormData<"u"&&m instanceof FormData?j=m:(x["Content-Type"]="application/json",j=JSON.stringify(m)):m&&typeof m!="string"&&!(typeof Blob<"u"&&m instanceof Blob)&&!(m instanceof ArrayBuffer)&&!(typeof FormData<"u"&&m instanceof FormData)?j=JSON.stringify(m):j=m;let k=_;b&&(c=new AbortController,l=setTimeout(()=>c.abort(),b),_?(k=c.signal,_.addEventListener("abort",()=>c.abort())):k=c.signal);const L=yield this.fetch(N.toString(),{method:p||"POST",headers:Object.assign(Object.assign(Object.assign({},x),this.headers),d),body:j,signal:k}).catch(F=>{throw new DM(F)}),H=L.headers.get("x-relay-error");if(H&&H==="true")throw new Ux(L);if(!L.ok)throw new Vx(L);let B=((a=L.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),K;return B==="application/json"?K=yield L.json():B==="application/octet-stream"||B==="application/pdf"?K=yield L.blob():B==="text/event-stream"?K=L:B==="multipart/form-data"?K=yield L.formData():K=yield L.text(),{data:K,error:null,response:L}}catch(d){return{data:null,error:d,response:d instanceof Vx||d instanceof Ux?d.context:void 0}}finally{l&&clearTimeout(l)}})}}var MM=class extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}},LM=class{constructor(n){var e,t;this.shouldThrowOnError=!1,this.method=n.method,this.url=n.url,this.headers=new Headers(n.headers),this.schema=n.schema,this.body=n.body,this.shouldThrowOnError=(e=n.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=n.signal,this.isMaybeSingle=(t=n.isMaybeSingle)!==null&&t!==void 0?t:!1,n.fetch?this.fetch=n.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(n,e){return this.headers=new Headers(this.headers),this.headers.set(n,e),this}then(n,e){var t=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const i=this.fetch;let a=i(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async l=>{let c=null,d=null,p=null,m=l.status,_=l.statusText;if(l.ok){var b,x;if(t.method!=="HEAD"){var S;const L=await l.text();L===""||(t.headers.get("Accept")==="text/csv"||t.headers.get("Accept")&&(!((S=t.headers.get("Accept"))===null||S===void 0)&&S.includes("application/vnd.pgrst.plan+text"))?d=L:d=JSON.parse(L))}const j=(b=t.headers.get("Prefer"))===null||b===void 0?void 0:b.match(/count=(exact|planned|estimated)/),k=(x=l.headers.get("content-range"))===null||x===void 0?void 0:x.split("/");j&&k&&k.length>1&&(p=parseInt(k[1])),t.isMaybeSingle&&t.method==="GET"&&Array.isArray(d)&&(d.length>1?(c={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,p=null,m=406,_="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{var N;const j=await l.text();try{c=JSON.parse(j),Array.isArray(c)&&l.status===404&&(d=[],c=null,m=200,_="OK")}catch{l.status===404&&j===""?(m=204,_="No Content"):c={message:j}}if(c&&t.isMaybeSingle&&(!(c==null||(N=c.details)===null||N===void 0)&&N.includes("0 rows"))&&(c=null,m=200,_="OK"),c&&t.shouldThrowOnError)throw new MM(c)}return{error:c,data:d,count:p,status:m,statusText:_}});return this.shouldThrowOnError||(a=a.catch(l=>{var c;let d="";const p=l==null?void 0:l.cause;if(p){var m,_,b,x;const N=(m=p==null?void 0:p.message)!==null&&m!==void 0?m:"",j=(_=p==null?void 0:p.code)!==null&&_!==void 0?_:"";d=`${(b=l==null?void 0:l.name)!==null&&b!==void 0?b:"FetchError"}: ${l==null?void 0:l.message}`,d+=`

Caused by: ${(x=p==null?void 0:p.name)!==null&&x!==void 0?x:"Error"}: ${N}`,j&&(d+=` (${j})`),p!=null&&p.stack&&(d+=`
${p.stack}`)}else{var S;d=(S=l==null?void 0:l.stack)!==null&&S!==void 0?S:""}return{error:{message:`${(c=l==null?void 0:l.name)!==null&&c!==void 0?c:"FetchError"}: ${l==null?void 0:l.message}`,details:d,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),a.then(n,e)}returns(){return this}overrideTypes(){return this}},UM=class extends LM{select(n){let e=!1;const t=(n??"*").split("").map(i=>/\s/.test(i)&&!e?"":(i==='"'&&(e=!e),i)).join("");return this.url.searchParams.set("select",t),this.headers.append("Prefer","return=representation"),this}order(n,{ascending:e=!0,nullsFirst:t,foreignTable:i,referencedTable:a=i}={}){const l=a?`${a}.order`:"order",c=this.url.searchParams.get(l);return this.url.searchParams.set(l,`${c?`${c},`:""}${n}.${e?"asc":"desc"}${t===void 0?"":t?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:e,referencedTable:t=e}={}){const i=typeof t>"u"?"limit":`${t}.limit`;return this.url.searchParams.set(i,`${n}`),this}range(n,e,{foreignTable:t,referencedTable:i=t}={}){const a=typeof i>"u"?"offset":`${i}.offset`,l=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(a,`${n}`),this.url.searchParams.set(l,`${e-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:n=!1,verbose:e=!1,settings:t=!1,buffers:i=!1,wal:a=!1,format:l="text"}={}){var c;const d=[n?"analyze":null,e?"verbose":null,t?"settings":null,i?"buffers":null,a?"wal":null].filter(Boolean).join("|"),p=(c=this.headers.get("Accept"))!==null&&c!==void 0?c:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${l}; for="${p}"; options=${d};`),l==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(n){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${n}`),this}};const Bx=new RegExp("[,()]");var Go=class extends UM{eq(n,e){return this.url.searchParams.append(n,`eq.${e}`),this}neq(n,e){return this.url.searchParams.append(n,`neq.${e}`),this}gt(n,e){return this.url.searchParams.append(n,`gt.${e}`),this}gte(n,e){return this.url.searchParams.append(n,`gte.${e}`),this}lt(n,e){return this.url.searchParams.append(n,`lt.${e}`),this}lte(n,e){return this.url.searchParams.append(n,`lte.${e}`),this}like(n,e){return this.url.searchParams.append(n,`like.${e}`),this}likeAllOf(n,e){return this.url.searchParams.append(n,`like(all).{${e.join(",")}}`),this}likeAnyOf(n,e){return this.url.searchParams.append(n,`like(any).{${e.join(",")}}`),this}ilike(n,e){return this.url.searchParams.append(n,`ilike.${e}`),this}ilikeAllOf(n,e){return this.url.searchParams.append(n,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(n,e){return this.url.searchParams.append(n,`ilike(any).{${e.join(",")}}`),this}regexMatch(n,e){return this.url.searchParams.append(n,`match.${e}`),this}regexIMatch(n,e){return this.url.searchParams.append(n,`imatch.${e}`),this}is(n,e){return this.url.searchParams.append(n,`is.${e}`),this}isDistinct(n,e){return this.url.searchParams.append(n,`isdistinct.${e}`),this}in(n,e){const t=Array.from(new Set(e)).map(i=>typeof i=="string"&&Bx.test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(n,`in.(${t})`),this}notIn(n,e){const t=Array.from(new Set(e)).map(i=>typeof i=="string"&&Bx.test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(n,`not.in.(${t})`),this}contains(n,e){return typeof e=="string"?this.url.searchParams.append(n,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(n,`cs.{${e.join(",")}}`):this.url.searchParams.append(n,`cs.${JSON.stringify(e)}`),this}containedBy(n,e){return typeof e=="string"?this.url.searchParams.append(n,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(n,`cd.{${e.join(",")}}`):this.url.searchParams.append(n,`cd.${JSON.stringify(e)}`),this}rangeGt(n,e){return this.url.searchParams.append(n,`sr.${e}`),this}rangeGte(n,e){return this.url.searchParams.append(n,`nxl.${e}`),this}rangeLt(n,e){return this.url.searchParams.append(n,`sl.${e}`),this}rangeLte(n,e){return this.url.searchParams.append(n,`nxr.${e}`),this}rangeAdjacent(n,e){return this.url.searchParams.append(n,`adj.${e}`),this}overlaps(n,e){return typeof e=="string"?this.url.searchParams.append(n,`ov.${e}`):this.url.searchParams.append(n,`ov.{${e.join(",")}}`),this}textSearch(n,e,{config:t,type:i}={}){let a="";i==="plain"?a="pl":i==="phrase"?a="ph":i==="websearch"&&(a="w");const l=t===void 0?"":`(${t})`;return this.url.searchParams.append(n,`${a}fts${l}.${e}`),this}match(n){return Object.entries(n).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(n,e,t){return this.url.searchParams.append(n,`not.${e}.${t}`),this}or(n,{foreignTable:e,referencedTable:t=e}={}){const i=t?`${t}.or`:"or";return this.url.searchParams.append(i,`(${n})`),this}filter(n,e,t){return this.url.searchParams.append(n,`${e}.${t}`),this}},VM=class{constructor(n,{headers:e={},schema:t,fetch:i}){this.url=n,this.headers=new Headers(e),this.schema=t,this.fetch=i}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(n,e){const{head:t=!1,count:i}=e??{},a=t?"HEAD":"GET";let l=!1;const c=(n??"*").split("").map(m=>/\s/.test(m)&&!l?"":(m==='"'&&(l=!l),m)).join(""),{url:d,headers:p}=this.cloneRequestState();return d.searchParams.set("select",c),i&&p.append("Prefer",`count=${i}`),new Go({method:a,url:d,headers:p,schema:this.schema,fetch:this.fetch})}insert(n,{count:e,defaultToNull:t=!0}={}){var i;const a="POST",{url:l,headers:c}=this.cloneRequestState();if(e&&c.append("Prefer",`count=${e}`),t||c.append("Prefer","missing=default"),Array.isArray(n)){const d=n.reduce((p,m)=>p.concat(Object.keys(m)),[]);if(d.length>0){const p=[...new Set(d)].map(m=>`"${m}"`);l.searchParams.set("columns",p.join(","))}}return new Go({method:a,url:l,headers:c,schema:this.schema,body:n,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}upsert(n,{onConflict:e,ignoreDuplicates:t=!1,count:i,defaultToNull:a=!0}={}){var l;const c="POST",{url:d,headers:p}=this.cloneRequestState();if(p.append("Prefer",`resolution=${t?"ignore":"merge"}-duplicates`),e!==void 0&&d.searchParams.set("on_conflict",e),i&&p.append("Prefer",`count=${i}`),a||p.append("Prefer","missing=default"),Array.isArray(n)){const m=n.reduce((_,b)=>_.concat(Object.keys(b)),[]);if(m.length>0){const _=[...new Set(m)].map(b=>`"${b}"`);d.searchParams.set("columns",_.join(","))}}return new Go({method:c,url:d,headers:p,schema:this.schema,body:n,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}update(n,{count:e}={}){var t;const i="PATCH",{url:a,headers:l}=this.cloneRequestState();return e&&l.append("Prefer",`count=${e}`),new Go({method:i,url:a,headers:l,schema:this.schema,body:n,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}delete({count:n}={}){var e;const t="DELETE",{url:i,headers:a}=this.cloneRequestState();return n&&a.append("Prefer",`count=${n}`),new Go({method:t,url:i,headers:a,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}},BM=class RS{constructor(e,{headers:t={},schema:i,fetch:a}={}){this.url=e,this.headers=new Headers(t),this.schemaName=i,this.fetch=a}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new VM(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new RS(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:i=!1,get:a=!1,count:l}={}){var c;let d;const p=new URL(`${this.url}/rpc/${e}`);let m;const _=S=>S!==null&&typeof S=="object"&&(!Array.isArray(S)||S.some(_)),b=i&&Object.values(t).some(_);b?(d="POST",m=t):i||a?(d=i?"HEAD":"GET",Object.entries(t).filter(([S,N])=>N!==void 0).map(([S,N])=>[S,Array.isArray(N)?`{${N.join(",")}}`:`${N}`]).forEach(([S,N])=>{p.searchParams.append(S,N)})):(d="POST",m=t);const x=new Headers(this.headers);return b?x.set("Prefer",l?`count=${l},return=minimal`:"return=minimal"):l&&x.set("Prefer",`count=${l}`),new Go({method:d,url:p,headers:x,schema:this.schemaName,body:m,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}};class zM{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const t=globalThis.process;if(t){const i=t.versions;if(i&&i.node){const a=i.node,l=parseInt(a.replace(/^v/,"").split(".")[0]);return l>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${l} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${l} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const i=this.getWebSocketConstructor();return new i(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const HM="2.93.2",qM=`realtime-js/${HM}`,$M="1.0.0",IS="2.0.0",zx=IS,Vm=1e4,GM=1e3,FM=100;var vr;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(vr||(vr={}));var qt;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(qt||(qt={}));var _s;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(_s||(_s={}));var Bm;(function(n){n.websocket="websocket"})(Bm||(Bm={}));var Ta;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Ta||(Ta={}));class KM{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,t){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return t(this._binaryEncodeUserBroadcastPush(e));let i=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(i))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer((t=e.payload)===null||t===void 0?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,i;const a=(i=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&i!==void 0?i:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,a)}_encodeJsonUserBroadcastPush(e){var t,i;const a=(i=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&i!==void 0?i:{},c=new TextEncoder().encode(JSON.stringify(a)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,c)}_encodeUserBroadcastPush(e,t,i){var a,l;const c=e.topic,d=(a=e.ref)!==null&&a!==void 0?a:"",p=(l=e.join_ref)!==null&&l!==void 0?l:"",m=e.payload.event,_=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},b=Object.keys(_).length===0?"":JSON.stringify(_);if(p.length>255)throw new Error(`joinRef length ${p.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`ref length ${d.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`topic length ${c.length} exceeds maximum of 255`);if(m.length>255)throw new Error(`userEvent length ${m.length} exceeds maximum of 255`);if(b.length>255)throw new Error(`metadata length ${b.length} exceeds maximum of 255`);const x=this.USER_BROADCAST_PUSH_META_LENGTH+p.length+d.length+c.length+m.length+b.length,S=new ArrayBuffer(this.HEADER_LENGTH+x);let N=new DataView(S),j=0;N.setUint8(j++,this.KINDS.userBroadcastPush),N.setUint8(j++,p.length),N.setUint8(j++,d.length),N.setUint8(j++,c.length),N.setUint8(j++,m.length),N.setUint8(j++,b.length),N.setUint8(j++,t),Array.from(p,L=>N.setUint8(j++,L.charCodeAt(0))),Array.from(d,L=>N.setUint8(j++,L.charCodeAt(0))),Array.from(c,L=>N.setUint8(j++,L.charCodeAt(0))),Array.from(m,L=>N.setUint8(j++,L.charCodeAt(0))),Array.from(b,L=>N.setUint8(j++,L.charCodeAt(0)));var k=new Uint8Array(S.byteLength+i.byteLength);return k.set(new Uint8Array(S),0),k.set(new Uint8Array(i),S.byteLength),k.buffer}decode(e,t){if(this._isArrayBuffer(e)){let i=this._binaryDecode(e);return t(i)}if(typeof e=="string"){const i=JSON.parse(e),[a,l,c,d,p]=i;return t({join_ref:a,ref:l,topic:c,event:d,payload:p})}return t({})}_binaryDecode(e){const t=new DataView(e),i=t.getUint8(0),a=new TextDecoder;switch(i){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,t,a)}}_decodeUserBroadcast(e,t,i){const a=t.getUint8(1),l=t.getUint8(2),c=t.getUint8(3),d=t.getUint8(4);let p=this.HEADER_LENGTH+4;const m=i.decode(e.slice(p,p+a));p=p+a;const _=i.decode(e.slice(p,p+l));p=p+l;const b=i.decode(e.slice(p,p+c));p=p+c;const x=e.slice(p,e.byteLength),S=d===this.JSON_ENCODING?JSON.parse(i.decode(x)):x,N={type:this.BROADCAST_EVENT,event:_,payload:S};return c>0&&(N.meta=JSON.parse(b)),{join_ref:null,ref:null,topic:m,event:this.BROADCAST_EVENT,payload:N}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||((t=e==null?void 0:e.constructor)===null||t===void 0?void 0:t.name)==="ArrayBuffer"}_pick(e,t){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([i])=>t.includes(i)))}}class kS{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var lt;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(lt||(lt={}));const Hx=(n,e,t={})=>{var i;const a=(i=t.skipTypes)!==null&&i!==void 0?i:[];return e?Object.keys(e).reduce((l,c)=>(l[c]=YM(c,n,e,a),l),{}):{}},YM=(n,e,t,i)=>{const a=e.find(d=>d.name===n),l=a==null?void 0:a.type,c=t[n];return l&&!i.includes(l)?OS(l,c):zm(c)},OS=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return XM(e,t)}switch(n){case lt.bool:return WM(e);case lt.float4:case lt.float8:case lt.int2:case lt.int4:case lt.int8:case lt.numeric:case lt.oid:return QM(e);case lt.json:case lt.jsonb:return JM(e);case lt.timestamp:return ZM(e);case lt.abstime:case lt.date:case lt.daterange:case lt.int4range:case lt.int8range:case lt.money:case lt.reltime:case lt.text:case lt.time:case lt.timestamptz:case lt.timetz:case lt.tsrange:case lt.tstzrange:return zm(e);default:return zm(e)}},zm=n=>n,WM=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},QM=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},JM=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch{return n}return n},XM=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,i=n[t];if(n[0]==="{"&&i==="}"){let l;const c=n.slice(1,t);try{l=JSON.parse("["+c+"]")}catch{l=c?c.split(","):[]}return l.map(d=>OS(e,d))}return n},ZM=n=>typeof n=="string"?n.replace(" ","T"):n,jS=n=>{const e=new URL(n);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Jp{constructor(e,t,i={},a=Vm){this.channel=e,this.event=t,this.payload=i,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var i;return this._hasReceived(e)&&t((i=this.receivedResp)===null||i===void 0?void 0:i.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(i=>i.status===e).forEach(i=>i.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var qx;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(qx||(qx={}));class qc{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const i=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},a=>{const{onJoin:l,onLeave:c,onSync:d}=this.caller;this.joinRef=this.channel._joinRef(),this.state=qc.syncState(this.state,a,l,c),this.pendingDiffs.forEach(p=>{this.state=qc.syncDiff(this.state,p,l,c)}),this.pendingDiffs=[],d()}),this.channel._on(i.diff,{},a=>{const{onJoin:l,onLeave:c,onSync:d}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=qc.syncDiff(this.state,a,l,c),d())}),this.onJoin((a,l,c)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:l,newPresences:c})}),this.onLeave((a,l,c)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:l,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,i,a){const l=this.cloneDeep(e),c=this.transformState(t),d={},p={};return this.map(l,(m,_)=>{c[m]||(p[m]=_)}),this.map(c,(m,_)=>{const b=l[m];if(b){const x=_.map(k=>k.presence_ref),S=b.map(k=>k.presence_ref),N=_.filter(k=>S.indexOf(k.presence_ref)<0),j=b.filter(k=>x.indexOf(k.presence_ref)<0);N.length>0&&(d[m]=N),j.length>0&&(p[m]=j)}else d[m]=_}),this.syncDiff(l,{joins:d,leaves:p},i,a)}static syncDiff(e,t,i,a){const{joins:l,leaves:c}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return i||(i=()=>{}),a||(a=()=>{}),this.map(l,(d,p)=>{var m;const _=(m=e[d])!==null&&m!==void 0?m:[];if(e[d]=this.cloneDeep(p),_.length>0){const b=e[d].map(S=>S.presence_ref),x=_.filter(S=>b.indexOf(S.presence_ref)<0);e[d].unshift(...x)}i(d,_,p)}),this.map(c,(d,p)=>{let m=e[d];if(!m)return;const _=p.map(b=>b.presence_ref);m=m.filter(b=>_.indexOf(b.presence_ref)<0),e[d]=m,a(d,m,p),m.length===0&&delete e[d]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(i=>t(i,e[i]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,i)=>{const a=e[i];return"metas"in a?t[i]=a.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):t[i]=a,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var $x;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})($x||($x={}));var $c;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})($c||($c={}));var Ei;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(Ei||(Ei={}));class Yo{constructor(e,t={config:{}},i){var a,l;if(this.topic=e,this.params=t,this.socket=i,this.bindings={},this.state=qt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Jp(this,_s.join,this.params,this.timeout),this.rejoinTimer=new kS(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=qt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(c=>c.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=qt.closed,this.socket._remove(this)}),this._onError(c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=qt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=qt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=qt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(_s.reply,{},(c,d)=>{this._trigger(this._replyEventName(d),c)}),this.presence=new qc(this),this.broadcastEndpointURL=jS(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((l=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var i,a,l;if(this.socket.isConnected()||this.socket.connect(),this.state==qt.closed){const{config:{broadcast:c,presence:d,private:p}}=this.params,m=(a=(i=this.bindings.postgres_changes)===null||i===void 0?void 0:i.map(S=>S.filter))!==null&&a!==void 0?a:[],_=!!this.bindings[$c.PRESENCE]&&this.bindings[$c.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,b={},x={broadcast:c,presence:Object.assign(Object.assign({},d),{enabled:_}),postgres_changes:m,private:p};this.socket.accessTokenValue&&(b.access_token=this.socket.accessTokenValue),this._onError(S=>e==null?void 0:e(Ei.CHANNEL_ERROR,S)),this._onClose(()=>e==null?void 0:e(Ei.CLOSED)),this.updateJoinPayload(Object.assign({config:x},b)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:S})=>{var N;if(this.socket._isManualToken()||this.socket.setAuth(),S===void 0){e==null||e(Ei.SUBSCRIBED);return}else{const j=this.bindings.postgres_changes,k=(N=j==null?void 0:j.length)!==null&&N!==void 0?N:0,L=[];for(let H=0;H<k;H++){const B=j[H],{filter:{event:K,schema:F,table:$,filter:A}}=B,C=S&&S[H];if(C&&C.event===K&&Yo.isFilterValueEqual(C.schema,F)&&Yo.isFilterValueEqual(C.table,$)&&Yo.isFilterValueEqual(C.filter,A))L.push(Object.assign(Object.assign({},B),{id:C.id}));else{this.unsubscribe(),this.state=qt.errored,e==null||e(Ei.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=L,e&&e(Ei.SUBSCRIBED);return}}).receive("error",S=>{this.state=qt.errored,e==null||e(Ei.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(S).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Ei.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,i){return this.state===qt.joined&&e===$c.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,t,i)}async httpSend(e,t,i={}){var a;if(t==null)return Promise.reject("Payload is required for httpSend()");const l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const c={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(a=i.timeout)!==null&&a!==void 0?a:this.timeout);if(d.status===202)return{success:!0};let p=d.statusText;try{const m=await d.json();p=m.error||m.message||p}catch{}return Promise.reject(new Error(p))}async send(e,t={}){var i,a;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:l,payload:c}=e,d={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(d.Authorization=`Bearer ${this.socket.accessTokenValue}`);const p={method:"POST",headers:d,body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:c,private:this.private}]})};try{const m=await this._fetchWithTimeout(this.broadcastEndpointURL,p,(i=t.timeout)!==null&&i!==void 0?i:this.timeout);return await((a=m.body)===null||a===void 0?void 0:a.cancel()),m.ok?"ok":"error"}catch(m){return m.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var c,d,p;const m=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((p=(d=(c=this.params)===null||c===void 0?void 0:c.config)===null||d===void 0?void 0:d.broadcast)===null||p===void 0)&&p.ack)&&l("ok"),m.receive("ok",()=>l("ok")),m.receive("error",()=>l("error")),m.receive("timeout",()=>l("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=qt.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(_s.close,"leave",this._joinRef())};this.joinPush.destroy();let i=null;return new Promise(a=>{i=new Jp(this,_s.leave,{},e),i.receive("ok",()=>{t(),a("ok")}).receive("timeout",()=>{t(),a("timed out")}).receive("error",()=>{a("error")}),i.send(),this._canPush()||i.trigger("ok",{})}).finally(()=>{i==null||i.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=qt.closed,this.bindings={}}async _fetchWithTimeout(e,t,i){const a=new AbortController,l=setTimeout(()=>a.abort(),i),c=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:a.signal}));return clearTimeout(l),c}_push(e,t,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Jp(this,e,t,i);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>FM){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,i){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,i){var a,l;const c=e.toLocaleLowerCase(),{close:d,error:p,leave:m,join:_}=_s;if(i&&[d,p,m,_].indexOf(c)>=0&&i!==this._joinRef())return;let x=this._onMessage(c,t,i);if(t&&!x)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(S=>{var N,j,k;return((N=S.filter)===null||N===void 0?void 0:N.event)==="*"||((k=(j=S.filter)===null||j===void 0?void 0:j.event)===null||k===void 0?void 0:k.toLocaleLowerCase())===c}).map(S=>S.callback(x,i)):(l=this.bindings[c])===null||l===void 0||l.filter(S=>{var N,j,k,L,H,B;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in S){const K=S.id,F=(N=S.filter)===null||N===void 0?void 0:N.event;return K&&((j=t.ids)===null||j===void 0?void 0:j.includes(K))&&(F==="*"||(F==null?void 0:F.toLocaleLowerCase())===((k=t.data)===null||k===void 0?void 0:k.type.toLocaleLowerCase()))}else{const K=(H=(L=S==null?void 0:S.filter)===null||L===void 0?void 0:L.event)===null||H===void 0?void 0:H.toLocaleLowerCase();return K==="*"||K===((B=t==null?void 0:t.event)===null||B===void 0?void 0:B.toLocaleLowerCase())}else return S.type.toLocaleLowerCase()===c}).map(S=>{if(typeof x=="object"&&"ids"in x){const N=x.data,{schema:j,table:k,commit_timestamp:L,type:H,errors:B}=N;x=Object.assign(Object.assign({},{schema:j,table:k,commit_timestamp:L,eventType:H,new:{},old:{},errors:B}),this._getPayloadRecords(N))}S.callback(x,i)})}_isClosed(){return this.state===qt.closed}_isJoined(){return this.state===qt.joined}_isJoining(){return this.state===qt.joining}_isLeaving(){return this.state===qt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,i){const a=e.toLocaleLowerCase(),l={type:a,filter:t,callback:i};return this.bindings[a]?this.bindings[a].push(l):this.bindings[a]=[l],this}_off(e,t){const i=e.toLocaleLowerCase();return this.bindings[i]&&(this.bindings[i]=this.bindings[i].filter(a=>{var l;return!(((l=a.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===i&&Yo.isEqual(a.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(e[i]!==t[i])return!1;return!0}static isFilterValueEqual(e,t){return(e??void 0)===(t??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(_s.close,{},e)}_onError(e){this._on(_s.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=qt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Hx(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Hx(e.columns,e.old_record)),t}}const Xp=()=>{},od={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},e6=[1e3,2e3,5e3,1e4],t6=1e4,n6=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class s6{constructor(e,t){var i;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Vm,this.transport=null,this.heartbeatIntervalMs=od.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Xp,this.ref=0,this.reconnectTimer=null,this.vsn=zx,this.logger=Xp,this.conn=null,this.sendBuffer=[],this.serializer=new KM,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=a=>a?(...l)=>a(...l):(...l)=>fetch(...l),!(!((i=t==null?void 0:t.params)===null||i===void 0)&&i.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${Bm.websocket}`,this.httpEndpoint=jS(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=zM.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const i=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(i),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,t??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,i){this.logger(e,t,i)}connectionState(){switch(this.conn&&this.conn.readyState){case vr.connecting:return Ta.Connecting;case vr.open:return Ta.Open;case vr.closing:return Ta.Closing;default:return Ta.Closed}}isConnected(){return this.connectionState()===Ta.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const i=`realtime:${e}`,a=this.getChannels().find(l=>l.topic===i);if(a)return a;{const l=new Yo(`realtime:${e}`,t,this);return this.channels.push(l),l}}push(e){const{topic:t,event:i,payload:a,ref:l}=e,c=()=>{this.encode(e,d=>{var p;(p=this.conn)===null||p===void 0||p.send(d)})};this.log("push",`${t} ${i} (${l})`,a),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(GM,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},od.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(i=>i.topic===e&&(i._isJoined()||i._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply"&&t.ref&&t.ref===this.pendingHeartbeatRef){const m=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error",m)}catch(_){this.log("error","error in heartbeat callback",_)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:i,event:a,payload:l,ref:c}=t,d=c?`(${c})`:"",p=l.status||"";this.log("receive",`${p} ${i} ${a} ${d}`.trim(),l),this.channels.filter(m=>m._isMember(i)).forEach(m=>m._trigger(a,l,c)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===vr.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===vr.open||this.conn.readyState===vr.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(t=>{this.log("error","error waiting for auth on connect",t),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this._terminateWorker()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e);try{this.heartbeatCallback("error")}catch(t){this.log("error","error in heartbeat callback",t)}}_triggerChanError(){this.channels.forEach(e=>e._trigger(_s.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const i=e.match(/\?/)?"&":"?",a=new URLSearchParams(t);return`${e}${i}${a}`}_workerObjectUrl(e){let t;if(e)t=e;else{const i=new Blob([n6],{type:"application/javascript"});t=URL.createObjectURL(i)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t,i=!1;if(e)t=e,i=!0;else if(this.accessToken)try{t=await this.accessToken()}catch(a){this.log("error","Error fetching access token from callback",a),t=this.accessTokenValue}else t=this.accessTokenValue;i?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(a=>{const l={access_token:t,version:qM};t&&a.updateJoinPayload(l),a.joinedOnce&&a._isJoined()&&a._push(_s.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(t=>{this.log("error",`Error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(i=>{try{i(t)}catch(a){this.log("error",`error in ${e} callback`,a)}})}catch(i){this.log("error",`error triggering ${e} callbacks`,i)}}_setupReconnectionTimer(){this.reconnectTimer=new kS(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},od.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,i,a,l,c,d,p,m,_,b,x,S;switch(this.transport=(t=e==null?void 0:e.transport)!==null&&t!==void 0?t:null,this.timeout=(i=e==null?void 0:e.timeout)!==null&&i!==void 0?i:Vm,this.heartbeatIntervalMs=(a=e==null?void 0:e.heartbeatIntervalMs)!==null&&a!==void 0?a:od.HEARTBEAT_INTERVAL,this.worker=(l=e==null?void 0:e.worker)!==null&&l!==void 0?l:!1,this.accessToken=(c=e==null?void 0:e.accessToken)!==null&&c!==void 0?c:null,this.heartbeatCallback=(d=e==null?void 0:e.heartbeatCallback)!==null&&d!==void 0?d:Xp,this.vsn=(p=e==null?void 0:e.vsn)!==null&&p!==void 0?p:zx,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(m=e==null?void 0:e.reconnectAfterMs)!==null&&m!==void 0?m:(N=>e6[N-1]||t6),this.vsn){case $M:this.encode=(_=e==null?void 0:e.encode)!==null&&_!==void 0?_:((N,j)=>j(JSON.stringify(N))),this.decode=(b=e==null?void 0:e.decode)!==null&&b!==void 0?b:((N,j)=>j(JSON.parse(N)));break;case IS:this.encode=(x=e==null?void 0:e.encode)!==null&&x!==void 0?x:this.serializer.encode.bind(this.serializer),this.decode=(S=e==null?void 0:e.decode)!==null&&S!==void 0?S:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}var nu=class extends Error{constructor(n,e){var t;super(n),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&((t=e.icebergType)==null?void 0:t.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function i6(n,e,t){const i=new URL(e,n);if(t)for(const[a,l]of Object.entries(t))l!==void 0&&i.searchParams.set(a,l);return i.toString()}async function r6(n){return!n||n.type==="none"?{}:n.type==="bearer"?{Authorization:`Bearer ${n.token}`}:n.type==="header"?{[n.name]:n.value}:n.type==="custom"?await n.getHeaders():{}}function a6(n){const e=n.fetchImpl??globalThis.fetch;return{async request({method:t,path:i,query:a,body:l,headers:c}){const d=i6(n.baseUrl,i,a),p=await r6(n.auth),m=await e(d,{method:t,headers:{...l?{"Content-Type":"application/json"}:{},...p,...c},body:l?JSON.stringify(l):void 0}),_=await m.text(),b=(m.headers.get("content-type")||"").includes("application/json"),x=b&&_?JSON.parse(_):_;if(!m.ok){const S=b?x:void 0,N=S==null?void 0:S.error;throw new nu((N==null?void 0:N.message)??`Request failed with status ${m.status}`,{status:m.status,icebergType:N==null?void 0:N.type,icebergCode:N==null?void 0:N.code,details:S})}return{status:m.status,headers:m.headers,data:x}}}}function ld(n){return n.join("")}var o6=class{constructor(n,e=""){this.client=n,this.prefix=e}async listNamespaces(n){const e=n?{parent:ld(n.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(i=>({namespace:i}))}async createNamespace(n,e){const t={namespace:n.namespace,properties:e==null?void 0:e.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:t})).data}async dropNamespace(n){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${ld(n.namespace)}`})}async loadNamespaceMetadata(n){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ld(n.namespace)}`})).data.properties}}async namespaceExists(n){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${ld(n.namespace)}`}),!0}catch(e){if(e instanceof nu&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(n,e){try{return await this.createNamespace(n,e)}catch(t){if(t instanceof nu&&t.status===409)return;throw t}}};function Do(n){return n.join("")}var l6=class{constructor(n,e="",t){this.client=n,this.prefix=e,this.accessDelegation=t}async listTables(n){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Do(n.namespace)}/tables`})).data.identifiers}async createTable(n,e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Do(n.namespace)}/tables`,body:e,headers:t})).data.metadata}async updateTable(n,e){const t=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Do(n.namespace)}/tables/${n.name}`,body:e});return{"metadata-location":t.data["metadata-location"],metadata:t.data.metadata}}async dropTable(n,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Do(n.namespace)}/tables/${n.name}`,query:{purgeRequested:String((e==null?void 0:e.purge)??!1)}})}async loadTable(n){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Do(n.namespace)}/tables/${n.name}`,headers:e})).data.metadata}async tableExists(n){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Do(n.namespace)}/tables/${n.name}`,headers:e}),!0}catch(t){if(t instanceof nu&&t.status===404)return!1;throw t}}async createTableIfNotExists(n,e){try{return await this.createTable(n,e)}catch(t){if(t instanceof nu&&t.status===409)return await this.loadTable({namespace:n.namespace,name:e.name});throw t}}},c6=class{constructor(n){var i;let e="v1";n.catalogName&&(e+=`/${n.catalogName}`);const t=n.baseUrl.endsWith("/")?n.baseUrl:`${n.baseUrl}/`;this.client=a6({baseUrl:t,auth:n.auth,fetchImpl:n.fetch}),this.accessDelegation=(i=n.accessDelegation)==null?void 0:i.join(","),this.namespaceOps=new o6(this.client,e),this.tableOps=new l6(this.client,e,this.accessDelegation)}async listNamespaces(n){return this.namespaceOps.listNamespaces(n)}async createNamespace(n,e){return this.namespaceOps.createNamespace(n,e)}async dropNamespace(n){await this.namespaceOps.dropNamespace(n)}async loadNamespaceMetadata(n){return this.namespaceOps.loadNamespaceMetadata(n)}async listTables(n){return this.tableOps.listTables(n)}async createTable(n,e){return this.tableOps.createTable(n,e)}async updateTable(n,e){return this.tableOps.updateTable(n,e)}async dropTable(n,e){await this.tableOps.dropTable(n,e)}async loadTable(n){return this.tableOps.loadTable(n)}async namespaceExists(n){return this.namespaceOps.namespaceExists(n)}async tableExists(n){return this.tableOps.tableExists(n)}async createNamespaceIfNotExists(n,e){return this.namespaceOps.createNamespaceIfNotExists(n,e)}async createTableIfNotExists(n,e){return this.tableOps.createTableIfNotExists(n,e)}},Sf=class extends Error{constructor(n,e="storage",t,i){super(n),this.__isStorageError=!0,this.namespace=e,this.name=e==="vectors"?"StorageVectorsError":"StorageError",this.status=t,this.statusCode=i}};function Af(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}var cd=class extends Sf{constructor(n,e,t,i="storage"){super(n,i,e,t),this.name=i==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=e,this.statusCode=t}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},DS=class extends Sf{constructor(n,e,t="storage"){super(n,t),this.name=t==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=e}};const u6=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),h6=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},Hm=n=>{if(Array.isArray(n))return n.map(t=>Hm(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,i])=>{const a=t.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));e[a]=Hm(i)}),e},d6=n=>!n||typeof n!="string"||n.length===0||n.length>100||n.trim()!==n||n.includes("/")||n.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(n);function su(n){"@babel/helpers - typeof";return su=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},su(n)}function f6(n,e){if(su(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(su(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function g6(n){var e=f6(n,"string");return su(e)=="symbol"?e:e+""}function p6(n,e,t){return(e=g6(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Gx(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,i)}return t}function Ce(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Gx(Object(t),!0).forEach(function(i){p6(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Gx(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}const Fx=n=>{var e;return n.msg||n.message||n.error_description||(typeof n.error=="string"?n.error:(e=n.error)===null||e===void 0?void 0:e.message)||JSON.stringify(n)},m6=async(n,e,t,i)=>{if(n&&typeof n=="object"&&"status"in n&&"ok"in n&&typeof n.status=="number"&&!(t!=null&&t.noResolveJson)){const a=n,l=a.status||500;if(typeof a.json=="function")a.json().then(c=>{const d=(c==null?void 0:c.statusCode)||(c==null?void 0:c.code)||l+"";e(new cd(Fx(c),l,d,i))}).catch(()=>{if(i==="vectors"){const c=l+"";e(new cd(a.statusText||`HTTP ${l} error`,l,c,i))}else{const c=l+"";e(new cd(a.statusText||`HTTP ${l} error`,l,c,i))}});else{const c=l+"";e(new cd(a.statusText||`HTTP ${l} error`,l,c,i))}}else e(new DS(Fx(n),n,i))},y6=(n,e,t,i)=>{const a={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"||n==="HEAD"||!i?Ce(Ce({},a),t):(h6(i)?(a.headers=Ce({"Content-Type":"application/json"},e==null?void 0:e.headers),a.body=JSON.stringify(i)):a.body=i,e!=null&&e.duplex&&(a.duplex=e.duplex),Ce(Ce({},a),t))};async function Ac(n,e,t,i,a,l,c){return new Promise((d,p)=>{n(t,y6(e,i,a,l)).then(m=>{if(!m.ok)throw m;if(i!=null&&i.noResolveJson)return m;if(c==="vectors"){const _=m.headers.get("content-type");if(!_||!_.includes("application/json"))return{}}return m.json()}).then(m=>d(m)).catch(m=>m6(m,p,i,c))})}function v6(n="storage"){return{get:async(e,t,i,a)=>Ac(e,"GET",t,i,a,void 0,n),post:async(e,t,i,a,l)=>Ac(e,"POST",t,a,l,i,n),put:async(e,t,i,a,l)=>Ac(e,"PUT",t,a,l,i,n),head:async(e,t,i,a)=>Ac(e,"HEAD",t,Ce(Ce({},i),{},{noResolveJson:!0}),a,void 0,n),remove:async(e,t,i,a,l)=>Ac(e,"DELETE",t,a,l,i,n)}}const _6=v6("storage"),{get:iu,post:pt,put:qm,head:b6,remove:W0}=_6;var vl=class{constructor(n,e={},t,i="storage"){this.shouldThrowOnError=!1,this.url=n,this.headers=e,this.fetch=u6(t),this.namespace=i}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(n){var e=this;try{return{data:await n(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Af(t))return{data:null,error:t};throw t}}},w6=class{constructor(n,e){this.downloadFn=n,this.shouldThrowOnError=e}then(n,e){return this.execute().then(n,e)}async execute(){var n=this;try{return{data:(await n.downloadFn()).body,error:null}}catch(e){if(n.shouldThrowOnError)throw e;if(Af(e))return{data:null,error:e};throw e}}};let PS;PS=Symbol.toStringTag;var x6=class{constructor(n,e){this.downloadFn=n,this.shouldThrowOnError=e,this[PS]="BlobDownloadBuilder",this.promise=null}asStream(){return new w6(this.downloadFn,this.shouldThrowOnError)}then(n,e){return this.getPromise().then(n,e)}catch(n){return this.getPromise().catch(n)}finally(n){return this.getPromise().finally(n)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var n=this;try{return{data:await(await n.downloadFn()).blob(),error:null}}catch(e){if(n.shouldThrowOnError)throw e;if(Af(e))return{data:null,error:e};throw e}}};const T6={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Kx={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var E6=class extends vl{constructor(n,e={},t,i){super(n,e,i,"storage"),this.bucketId=t}async uploadOrUpdate(n,e,t,i){var a=this;return a.handleOperation(async()=>{let l;const c=Ce(Ce({},Kx),i);let d=Ce(Ce({},a.headers),n==="POST"&&{"x-upsert":String(c.upsert)});const p=c.metadata;typeof Blob<"u"&&t instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),p&&l.append("metadata",a.encodeMetadata(p)),l.append("",t)):typeof FormData<"u"&&t instanceof FormData?(l=t,l.has("cacheControl")||l.append("cacheControl",c.cacheControl),p&&!l.has("metadata")&&l.append("metadata",a.encodeMetadata(p))):(l=t,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType,p&&(d["x-metadata"]=a.toBase64(a.encodeMetadata(p))),(typeof ReadableStream<"u"&&l instanceof ReadableStream||l&&typeof l=="object"&&"pipe"in l&&typeof l.pipe=="function")&&!c.duplex&&(c.duplex="half")),i!=null&&i.headers&&(d=Ce(Ce({},d),i.headers));const m=a._removeEmptyFolders(e),_=a._getFinalPath(m),b=await(n=="PUT"?qm:pt)(a.fetch,`${a.url}/object/${_}`,l,Ce({headers:d},c!=null&&c.duplex?{duplex:c.duplex}:{}));return{path:m,id:b.Id,fullPath:b.Key}})}async upload(n,e,t){return this.uploadOrUpdate("POST",n,e,t)}async uploadToSignedUrl(n,e,t,i){var a=this;const l=a._removeEmptyFolders(n),c=a._getFinalPath(l),d=new URL(a.url+`/object/upload/sign/${c}`);return d.searchParams.set("token",e),a.handleOperation(async()=>{let p;const m=Ce({upsert:Kx.upsert},i),_=Ce(Ce({},a.headers),{"x-upsert":String(m.upsert)});return typeof Blob<"u"&&t instanceof Blob?(p=new FormData,p.append("cacheControl",m.cacheControl),p.append("",t)):typeof FormData<"u"&&t instanceof FormData?(p=t,p.append("cacheControl",m.cacheControl)):(p=t,_["cache-control"]=`max-age=${m.cacheControl}`,_["content-type"]=m.contentType),{path:l,fullPath:(await qm(a.fetch,d.toString(),p,{headers:_})).Key}})}async createSignedUploadUrl(n,e){var t=this;return t.handleOperation(async()=>{let i=t._getFinalPath(n);const a=Ce({},t.headers);e!=null&&e.upsert&&(a["x-upsert"]="true");const l=await pt(t.fetch,`${t.url}/object/upload/sign/${i}`,{},{headers:a}),c=new URL(t.url+l.url),d=c.searchParams.get("token");if(!d)throw new Sf("No token returned by API");return{signedUrl:c.toString(),path:n,token:d}})}async update(n,e,t){return this.uploadOrUpdate("PUT",n,e,t)}async move(n,e,t){var i=this;return i.handleOperation(async()=>await pt(i.fetch,`${i.url}/object/move`,{bucketId:i.bucketId,sourceKey:n,destinationKey:e,destinationBucket:t==null?void 0:t.destinationBucket},{headers:i.headers}))}async copy(n,e,t){var i=this;return i.handleOperation(async()=>({path:(await pt(i.fetch,`${i.url}/object/copy`,{bucketId:i.bucketId,sourceKey:n,destinationKey:e,destinationBucket:t==null?void 0:t.destinationBucket},{headers:i.headers})).Key}))}async createSignedUrl(n,e,t){var i=this;return i.handleOperation(async()=>{let a=i._getFinalPath(n),l=await pt(i.fetch,`${i.url}/object/sign/${a}`,Ce({expiresIn:e},t!=null&&t.transform?{transform:t.transform}:{}),{headers:i.headers});const c=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return{signedUrl:encodeURI(`${i.url}${l.signedURL}${c}`)}})}async createSignedUrls(n,e,t){var i=this;return i.handleOperation(async()=>{const a=await pt(i.fetch,`${i.url}/object/sign/${i.bucketId}`,{expiresIn:e,paths:n},{headers:i.headers}),l=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return a.map(c=>Ce(Ce({},c),{},{signedUrl:c.signedURL?encodeURI(`${i.url}${c.signedURL}${l}`):null}))})}download(n,e){const t=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),a=i?`?${i}`:"",l=this._getFinalPath(n),c=()=>iu(this.fetch,`${this.url}/${t}/${l}${a}`,{headers:this.headers,noResolveJson:!0});return new x6(c,this.shouldThrowOnError)}async info(n){var e=this;const t=e._getFinalPath(n);return e.handleOperation(async()=>Hm(await iu(e.fetch,`${e.url}/object/info/${t}`,{headers:e.headers})))}async exists(n){var e=this;const t=e._getFinalPath(n);try{return await b6(e.fetch,`${e.url}/object/${t}`,{headers:e.headers}),{data:!0,error:null}}catch(i){if(e.shouldThrowOnError)throw i;if(Af(i)&&i instanceof DS){const a=i.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:i}}throw i}}getPublicUrl(n,e){const t=this._getFinalPath(n),i=[],a=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";a!==""&&i.push(a);const l=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});c!==""&&i.push(c);let d=i.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${t}${d}`)}}}async remove(n){var e=this;return e.handleOperation(async()=>await W0(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:n},{headers:e.headers}))}async list(n,e,t){var i=this;return i.handleOperation(async()=>{const a=Ce(Ce(Ce({},T6),e),{},{prefix:n||""});return await pt(i.fetch,`${i.url}/object/list/${i.bucketId}`,a,{headers:i.headers},t)})}async listV2(n,e){var t=this;return t.handleOperation(async()=>{const i=Ce({},n);return await pt(t.fetch,`${t.url}/object/list-v2/${t.bucketId}`,i,{headers:t.headers},e)})}encodeMetadata(n){return JSON.stringify(n)}toBase64(n){return typeof Buffer<"u"?Buffer.from(n).toString("base64"):btoa(n)}_getFinalPath(n){return`${this.bucketId}/${n.replace(/^\/+/,"")}`}_removeEmptyFolders(n){return n.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(n){const e=[];return n.width&&e.push(`width=${n.width}`),n.height&&e.push(`height=${n.height}`),n.resize&&e.push(`resize=${n.resize}`),n.format&&e.push(`format=${n.format}`),n.quality&&e.push(`quality=${n.quality}`),e.join("&")}};const S6="2.93.2",Tu={"X-Client-Info":`storage-js/${S6}`};var A6=class extends vl{constructor(n,e={},t,i){const a=new URL(n);i!=null&&i.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase."));const l=a.href.replace(/\/$/,""),c=Ce(Ce({},Tu),e);super(l,c,t,"storage")}async listBuckets(n){var e=this;return e.handleOperation(async()=>{const t=e.listBucketOptionsToQueryString(n);return await iu(e.fetch,`${e.url}/bucket${t}`,{headers:e.headers})})}async getBucket(n){var e=this;return e.handleOperation(async()=>await iu(e.fetch,`${e.url}/bucket/${n}`,{headers:e.headers}))}async createBucket(n,e={public:!1}){var t=this;return t.handleOperation(async()=>await pt(t.fetch,`${t.url}/bucket`,{id:n,name:n,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}))}async updateBucket(n,e){var t=this;return t.handleOperation(async()=>await qm(t.fetch,`${t.url}/bucket/${n}`,{id:n,name:n,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}))}async emptyBucket(n){var e=this;return e.handleOperation(async()=>await pt(e.fetch,`${e.url}/bucket/${n}/empty`,{},{headers:e.headers}))}async deleteBucket(n){var e=this;return e.handleOperation(async()=>await W0(e.fetch,`${e.url}/bucket/${n}`,{},{headers:e.headers}))}listBucketOptionsToQueryString(n){const e={};return n&&("limit"in n&&(e.limit=String(n.limit)),"offset"in n&&(e.offset=String(n.offset)),n.search&&(e.search=n.search),n.sortColumn&&(e.sortColumn=n.sortColumn),n.sortOrder&&(e.sortOrder=n.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},N6=class extends vl{constructor(n,e={},t){const i=n.replace(/\/$/,""),a=Ce(Ce({},Tu),e);super(i,a,t,"storage")}async createBucket(n){var e=this;return e.handleOperation(async()=>await pt(e.fetch,`${e.url}/bucket`,{name:n},{headers:e.headers}))}async listBuckets(n){var e=this;return e.handleOperation(async()=>{const t=new URLSearchParams;(n==null?void 0:n.limit)!==void 0&&t.set("limit",n.limit.toString()),(n==null?void 0:n.offset)!==void 0&&t.set("offset",n.offset.toString()),n!=null&&n.sortColumn&&t.set("sortColumn",n.sortColumn),n!=null&&n.sortOrder&&t.set("sortOrder",n.sortOrder),n!=null&&n.search&&t.set("search",n.search);const i=t.toString(),a=i?`${e.url}/bucket?${i}`:`${e.url}/bucket`;return await iu(e.fetch,a,{headers:e.headers})})}async deleteBucket(n){var e=this;return e.handleOperation(async()=>await W0(e.fetch,`${e.url}/bucket/${n}`,{},{headers:e.headers}))}from(n){var e=this;if(!d6(n))throw new Sf("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const t=new c6({baseUrl:this.url,catalogName:n,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),i=this.shouldThrowOnError;return new Proxy(t,{get(a,l){const c=a[l];return typeof c!="function"?c:async(...d)=>{try{return{data:await c.apply(a,d),error:null}}catch(p){if(i)throw p;return{data:null,error:p}}}}})}},C6=class extends vl{constructor(n,e={},t){const i=n.replace(/\/$/,""),a=Ce(Ce({},Tu),{},{"Content-Type":"application/json"},e);super(i,a,t,"vectors")}async createIndex(n){var e=this;return e.handleOperation(async()=>await pt(e.fetch,`${e.url}/CreateIndex`,n,{headers:e.headers})||{})}async getIndex(n,e){var t=this;return t.handleOperation(async()=>await pt(t.fetch,`${t.url}/GetIndex`,{vectorBucketName:n,indexName:e},{headers:t.headers}))}async listIndexes(n){var e=this;return e.handleOperation(async()=>await pt(e.fetch,`${e.url}/ListIndexes`,n,{headers:e.headers}))}async deleteIndex(n,e){var t=this;return t.handleOperation(async()=>await pt(t.fetch,`${t.url}/DeleteIndex`,{vectorBucketName:n,indexName:e},{headers:t.headers})||{})}},R6=class extends vl{constructor(n,e={},t){const i=n.replace(/\/$/,""),a=Ce(Ce({},Tu),{},{"Content-Type":"application/json"},e);super(i,a,t,"vectors")}async putVectors(n){var e=this;if(n.vectors.length<1||n.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return e.handleOperation(async()=>await pt(e.fetch,`${e.url}/PutVectors`,n,{headers:e.headers})||{})}async getVectors(n){var e=this;return e.handleOperation(async()=>await pt(e.fetch,`${e.url}/GetVectors`,n,{headers:e.headers}))}async listVectors(n){var e=this;if(n.segmentCount!==void 0){if(n.segmentCount<1||n.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(n.segmentIndex!==void 0&&(n.segmentIndex<0||n.segmentIndex>=n.segmentCount))throw new Error(`segmentIndex must be between 0 and ${n.segmentCount-1}`)}return e.handleOperation(async()=>await pt(e.fetch,`${e.url}/ListVectors`,n,{headers:e.headers}))}async queryVectors(n){var e=this;return e.handleOperation(async()=>await pt(e.fetch,`${e.url}/QueryVectors`,n,{headers:e.headers}))}async deleteVectors(n){var e=this;if(n.keys.length<1||n.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return e.handleOperation(async()=>await pt(e.fetch,`${e.url}/DeleteVectors`,n,{headers:e.headers})||{})}},I6=class extends vl{constructor(n,e={},t){const i=n.replace(/\/$/,""),a=Ce(Ce({},Tu),{},{"Content-Type":"application/json"},e);super(i,a,t,"vectors")}async createBucket(n){var e=this;return e.handleOperation(async()=>await pt(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:n},{headers:e.headers})||{})}async getBucket(n){var e=this;return e.handleOperation(async()=>await pt(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:n},{headers:e.headers}))}async listBuckets(n={}){var e=this;return e.handleOperation(async()=>await pt(e.fetch,`${e.url}/ListVectorBuckets`,n,{headers:e.headers}))}async deleteBucket(n){var e=this;return e.handleOperation(async()=>await pt(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:n},{headers:e.headers})||{})}},k6=class extends I6{constructor(n,e={}){super(n,e.headers||{},e.fetch)}from(n){return new O6(this.url,this.headers,n,this.fetch)}async createBucket(n){var e=()=>super.createBucket,t=this;return e().call(t,n)}async getBucket(n){var e=()=>super.getBucket,t=this;return e().call(t,n)}async listBuckets(n={}){var e=()=>super.listBuckets,t=this;return e().call(t,n)}async deleteBucket(n){var e=()=>super.deleteBucket,t=this;return e().call(t,n)}},O6=class extends C6{constructor(n,e,t,i){super(n,e,i),this.vectorBucketName=t}async createIndex(n){var e=()=>super.createIndex,t=this;return e().call(t,Ce(Ce({},n),{},{vectorBucketName:t.vectorBucketName}))}async listIndexes(n={}){var e=()=>super.listIndexes,t=this;return e().call(t,Ce(Ce({},n),{},{vectorBucketName:t.vectorBucketName}))}async getIndex(n){var e=()=>super.getIndex,t=this;return e().call(t,t.vectorBucketName,n)}async deleteIndex(n){var e=()=>super.deleteIndex,t=this;return e().call(t,t.vectorBucketName,n)}index(n){return new j6(this.url,this.headers,this.vectorBucketName,n,this.fetch)}},j6=class extends R6{constructor(n,e,t,i,a){super(n,e,a),this.vectorBucketName=t,this.indexName=i}async putVectors(n){var e=()=>super.putVectors,t=this;return e().call(t,Ce(Ce({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async getVectors(n){var e=()=>super.getVectors,t=this;return e().call(t,Ce(Ce({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async listVectors(n={}){var e=()=>super.listVectors,t=this;return e().call(t,Ce(Ce({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async queryVectors(n){var e=()=>super.queryVectors,t=this;return e().call(t,Ce(Ce({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async deleteVectors(n){var e=()=>super.deleteVectors,t=this;return e().call(t,Ce(Ce({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}},D6=class extends A6{constructor(n,e={},t,i){super(n,e,t,i)}from(n){return new E6(this.url,this.headers,n,this.fetch)}get vectors(){return new k6(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new N6(this.url+"/iceberg",this.headers,this.fetch)}};const MS="2.93.2",Fo=30*1e3,$m=3,Zp=$m*Fo,P6="http://localhost:9999",M6="supabase.auth.token",L6={"X-Client-Info":`gotrue-js/${MS}`},Gm="X-Supabase-Api-Version",LS={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},U6=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,V6=600*1e3;class ru extends Error{constructor(e,t,i){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=i}}function xe(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class B6 extends ru{constructor(e,t,i){super(e,t,i),this.name="AuthApiError",this.status=t,this.code=i}}function z6(n){return xe(n)&&n.name==="AuthApiError"}class Ea extends ru{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Mi extends ru{constructor(e,t,i,a){super(e,i,a),this.name=t,this.status=i}}class Vn extends Mi{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function em(n){return xe(n)&&n.name==="AuthSessionMissingError"}class Po extends Mi{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ud extends Mi{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class hd extends Mi{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function H6(n){return xe(n)&&n.name==="AuthImplicitGrantRedirectError"}class Yx extends Mi{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class q6 extends Mi{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Fm extends Mi{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function tm(n){return xe(n)&&n.name==="AuthRetryableFetchError"}class Wx extends Mi{constructor(e,t,i){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=i}}class Km extends Mi{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Wd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Qx=` 	
\r=`.split(""),$6=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<Qx.length;e+=1)n[Qx[e].charCodeAt(0)]=-2;for(let e=0;e<Wd.length;e+=1)n[Wd[e].charCodeAt(0)]=e;return n})();function Jx(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;t(Wd[i]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;t(Wd[i]),e.queuedBits-=6}}function US(n,e,t){const i=$6[n];if(i>-1)for(e.queue=e.queue<<6|i,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(i===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function Xx(n){const e=[],t=c=>{e.push(String.fromCodePoint(c))},i={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},l=c=>{K6(c,i,t)};for(let c=0;c<n.length;c+=1)US(n.charCodeAt(c),a,l);return e.join("")}function G6(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function F6(n,e){for(let t=0;t<n.length;t+=1){let i=n.charCodeAt(t);if(i>55295&&i<=56319){const a=(i-55296)*1024&65535;i=(n.charCodeAt(t+1)-56320&65535|a)+65536,t+=1}G6(i,e)}}function K6(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let i=1;i<6;i+=1)if((n>>7-i&1)===0){e.utf8seq=i;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function nl(n){const e=[],t={queue:0,queuedBits:0},i=a=>{e.push(a)};for(let a=0;a<n.length;a+=1)US(n.charCodeAt(a),t,i);return new Uint8Array(e)}function Y6(n){const e=[];return F6(n,t=>e.push(t)),new Uint8Array(e)}function Ia(n){const e=[],t={queue:0,queuedBits:0},i=a=>{e.push(a)};return n.forEach(a=>Jx(a,t,i)),Jx(null,t,i),e.join("")}function W6(n){return Math.round(Date.now()/1e3)+n}function Q6(){return Symbol("auth-callback")}const sn=()=>typeof window<"u"&&typeof document<"u",_a={tested:!1,writable:!1},VS=()=>{if(!sn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(_a.tested)return _a.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),_a.tested=!0,_a.writable=!0}catch{_a.tested=!0,_a.writable=!1}return _a.writable};function J6(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((a,l)=>{e[l]=a})}catch{}return t.searchParams.forEach((i,a)=>{e[a]=i}),e}const BS=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),X6=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",Ko=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},ba=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},nn=async(n,e)=>{await n.removeItem(e)};class Nf{constructor(){this.promise=new Nf.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Nf.promiseConstructor=Promise;function dd(n){const e=n.split(".");if(e.length!==3)throw new Km("Invalid JWT structure");for(let i=0;i<e.length;i++)if(!U6.test(e[i]))throw new Km("JWT not in base64url format");return{header:JSON.parse(Xx(e[0])),payload:JSON.parse(Xx(e[1])),signature:nl(e[2]),raw:{header:e[0],payload:e[1]}}}async function Z6(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function e3(n,e){return new Promise((i,a)=>{(async()=>{for(let l=0;l<1/0;l++)try{const c=await n(l);if(!e(l,null,c)){i(c);return}}catch(c){if(!e(l,c)){a(c);return}}})()})}function t3(n){return("0"+n.toString(16)).substr(-2)}function n3(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",i=t.length;let a="";for(let l=0;l<56;l++)a+=t.charAt(Math.floor(Math.random()*i));return a}return crypto.getRandomValues(e),Array.from(e,t3).join("")}async function s3(n){const t=new TextEncoder().encode(n),i=await crypto.subtle.digest("SHA-256",t),a=new Uint8Array(i);return Array.from(a).map(l=>String.fromCharCode(l)).join("")}async function i3(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await s3(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Mo(n,e,t=!1){const i=n3();let a=i;t&&(a+="/PASSWORD_RECOVERY"),await Ko(n,`${e}-code-verifier`,a);const l=await i3(i);return[l,i===l?"plain":"s256"]}const r3=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function a3(n){const e=n.headers.get(Gm);if(!e||!e.match(r3))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function o3(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function l3(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const c3=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Lo(n){if(!c3.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function nm(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const i=t.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function u3(n,e){return new Proxy(n,{get:(t,i,a)=>{if(i==="__isInsecureUserWarningProxy")return!0;if(typeof i=="symbol"){const l=i.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)"||l==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,i,a)}return!e.value&&typeof i=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(t,i,a)}})}function Zx(n){return JSON.parse(JSON.stringify(n))}const xa=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),h3=[502,503,504];async function eT(n){var e;if(!X6(n))throw new Fm(xa(n),0);if(h3.includes(n.status))throw new Fm(xa(n),n.status);let t;try{t=await n.json()}catch(l){throw new Ea(xa(l),l)}let i;const a=a3(n);if(a&&a.getTime()>=LS["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?i=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(i=t.error_code),i){if(i==="weak_password")throw new Wx(xa(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(i==="session_not_found")throw new Vn}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((l,c)=>l&&typeof c=="string",!0))throw new Wx(xa(t),n.status,t.weak_password.reasons);throw new B6(xa(t),n.status||500,i)}const d3=(n,e,t,i)=>{const a={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),a.body=JSON.stringify(i),Object.assign(Object.assign({},a),t))};async function Ne(n,e,t,i){var a;const l=Object.assign({},i==null?void 0:i.headers);l[Gm]||(l[Gm]=LS["2024-01-01"].name),i!=null&&i.jwt&&(l.Authorization=`Bearer ${i.jwt}`);const c=(a=i==null?void 0:i.query)!==null&&a!==void 0?a:{};i!=null&&i.redirectTo&&(c.redirect_to=i.redirectTo);const d=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",p=await f3(n,e,t+d,{headers:l,noResolveJson:i==null?void 0:i.noResolveJson},{},i==null?void 0:i.body);return i!=null&&i.xform?i==null?void 0:i.xform(p):{data:Object.assign({},p),error:null}}async function f3(n,e,t,i,a,l){const c=d3(e,i,a,l);let d;try{d=await n(t,Object.assign({},c))}catch(p){throw console.error(p),new Fm(xa(p),0)}if(d.ok||await eT(d),i!=null&&i.noResolveJson)return d;try{return await d.json()}catch(p){await eT(p)}}function vs(n){var e;let t=null;m3(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=W6(n.expires_in)));const i=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:i},error:null}}function tT(n){const e=vs(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,i)=>t&&typeof i=="string",!0)&&(e.data.weak_password=n.weak_password),e}function xr(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function g3(n){return{data:n,error:null}}function p3(n){const{action_link:e,email_otp:t,hashed_token:i,redirect_to:a,verification_type:l}=n,c=Ef(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),d={action_link:e,email_otp:t,hashed_token:i,redirect_to:a,verification_type:l},p=Object.assign({},c);return{data:{properties:d,user:p},error:null}}function nT(n){return n}function m3(n){return n.access_token&&n.refresh_token&&n.expires_in}const sm=["global","local","others"];class y3{constructor({url:e="",headers:t={},fetch:i}){this.url=e,this.headers=t,this.fetch=BS(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=sm[0]){if(sm.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${sm.join(", ")}`);try{return await Ne(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(i){if(xe(i))return{data:null,error:i};throw i}}async inviteUserByEmail(e,t={}){try{return await Ne(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:xr})}catch(i){if(xe(i))return{data:{user:null},error:i};throw i}}async generateLink(e){try{const{options:t}=e,i=Ef(e,["options"]),a=Object.assign(Object.assign({},i),t);return"newEmail"in i&&(a.new_email=i==null?void 0:i.newEmail,delete a.newEmail),await Ne(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:p3,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(xe(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Ne(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:xr})}catch(t){if(xe(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,i,a,l,c,d,p;try{const m={nextPage:null,lastPage:0,total:0},_=await Ne(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:"",per_page:(l=(a=e==null?void 0:e.perPage)===null||a===void 0?void 0:a.toString())!==null&&l!==void 0?l:""},xform:nT});if(_.error)throw _.error;const b=await _.json(),x=(c=_.headers.get("x-total-count"))!==null&&c!==void 0?c:0,S=(p=(d=_.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&p!==void 0?p:[];return S.length>0&&(S.forEach(N=>{const j=parseInt(N.split(";")[0].split("=")[1].substring(0,1)),k=JSON.parse(N.split(";")[1].split("=")[1]);m[`${k}Page`]=j}),m.total=parseInt(x)),{data:Object.assign(Object.assign({},b),m),error:null}}catch(m){if(xe(m))return{data:{users:[]},error:m};throw m}}async getUserById(e){Lo(e);try{return await Ne(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:xr})}catch(t){if(xe(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Lo(e);try{return await Ne(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:xr})}catch(i){if(xe(i))return{data:{user:null},error:i};throw i}}async deleteUser(e,t=!1){Lo(e);try{return await Ne(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:xr})}catch(i){if(xe(i))return{data:{user:null},error:i};throw i}}async _listFactors(e){Lo(e.userId);try{const{data:t,error:i}=await Ne(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:t,error:i}}catch(t){if(xe(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Lo(e.userId),Lo(e.id);try{return{data:await Ne(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(xe(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,i,a,l,c,d,p;try{const m={nextPage:null,lastPage:0,total:0},_=await Ne(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:"",per_page:(l=(a=e==null?void 0:e.perPage)===null||a===void 0?void 0:a.toString())!==null&&l!==void 0?l:""},xform:nT});if(_.error)throw _.error;const b=await _.json(),x=(c=_.headers.get("x-total-count"))!==null&&c!==void 0?c:0,S=(p=(d=_.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&p!==void 0?p:[];return S.length>0&&(S.forEach(N=>{const j=parseInt(N.split(";")[0].split("=")[1].substring(0,1)),k=JSON.parse(N.split(";")[1].split("=")[1]);m[`${k}Page`]=j}),m.total=parseInt(x)),{data:Object.assign(Object.assign({},b),m),error:null}}catch(m){if(xe(m))return{data:{clients:[]},error:m};throw m}}async _createOAuthClient(e){try{return await Ne(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(xe(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await Ne(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(xe(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await Ne(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:i=>({data:i,error:null})})}catch(i){if(xe(i))return{data:null,error:i};throw i}}async _deleteOAuthClient(e){try{return await Ne(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(xe(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await Ne(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(xe(t))return{data:null,error:t};throw t}}}function sT(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}const Uo={debug:!!(globalThis&&VS()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class zS extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class v3 extends zS{}async function _3(n,e,t){Uo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const i=new globalThis.AbortController;return e>0&&setTimeout(()=>{i.abort(),Uo.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},async a=>{if(a){Uo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,a.name);try{return await t()}finally{Uo.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,a.name)}}else{if(e===0)throw Uo.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new v3(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(Uo.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}function b3(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function HS(n){if(!/^0x[a-fA-F0-9]{40}$/.test(n))throw new Error(`@supabase/auth-js: Address "${n}" is invalid.`);return n.toLowerCase()}function w3(n){return parseInt(n,16)}function x3(n){const e=new TextEncoder().encode(n);return"0x"+Array.from(e,i=>i.toString(16).padStart(2,"0")).join("")}function T3(n){var e;const{chainId:t,domain:i,expirationTime:a,issuedAt:l=new Date,nonce:c,notBefore:d,requestId:p,resources:m,scheme:_,uri:b,version:x}=n;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!i)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(c&&c.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${c}`);if(!b)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(x!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${x}`);if(!((e=n.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${n.statement}`)}const S=HS(n.address),N=_?`${_}://${i}`:i,j=n.statement?`${n.statement}
`:"",k=`${N} wants you to sign in with your Ethereum account:
${S}

${j}`;let L=`URI: ${b}
Version: ${x}
Chain ID: ${t}${c?`
Nonce: ${c}`:""}
Issued At: ${l.toISOString()}`;if(a&&(L+=`
Expiration Time: ${a.toISOString()}`),d&&(L+=`
Not Before: ${d.toISOString()}`),p&&(L+=`
Request ID: ${p}`),m){let H=`
Resources:`;for(const B of m){if(!B||typeof B!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${B}`);H+=`
- ${B}`}L+=H}return`${k}
${L}`}class Ut extends Error{constructor({message:e,code:t,cause:i,name:a}){var l;super(e,{cause:i}),this.__isWebAuthnError=!0,this.name=(l=a??(i instanceof Error?i.name:void 0))!==null&&l!==void 0?l:"Unknown Error",this.code=t}}class Qd extends Ut{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function E3({error:n,options:e}){var t,i,a;const{publicKey:l}=e;if(!l)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Ut({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else if(n.name==="ConstraintError"){if(((t=l.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new Ut({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:n});if(e.mediation==="conditional"&&((i=l.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new Ut({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:n});if(((a=l.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new Ut({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:n})}else{if(n.name==="InvalidStateError")return new Ut({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:n});if(n.name==="NotAllowedError")return new Ut({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="NotSupportedError")return l.pubKeyCredParams.filter(d=>d.type==="public-key").length===0?new Ut({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:n}):new Ut({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:n});if(n.name==="SecurityError"){const c=window.location.hostname;if(qS(c)){if(l.rp.id!==c)return new Ut({message:`The RP ID "${l.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new Ut({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="TypeError"){if(l.user.id.byteLength<1||l.user.id.byteLength>64)return new Ut({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:n})}else if(n.name==="UnknownError")return new Ut({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new Ut({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}function S3({error:n,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Ut({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else{if(n.name==="NotAllowedError")return new Ut({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="SecurityError"){const i=window.location.hostname;if(qS(i)){if(t.rpId!==i)return new Ut({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new Ut({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="UnknownError")return new Ut({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new Ut({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}class A3{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const N3=new A3;function C3(n){if(!n)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(n);const{challenge:e,user:t,excludeCredentials:i}=n,a=Ef(n,["challenge","user","excludeCredentials"]),l=nl(e).buffer,c=Object.assign(Object.assign({},t),{id:nl(t.id).buffer}),d=Object.assign(Object.assign({},a),{challenge:l,user:c});if(i&&i.length>0){d.excludeCredentials=new Array(i.length);for(let p=0;p<i.length;p++){const m=i[p];d.excludeCredentials[p]=Object.assign(Object.assign({},m),{id:nl(m.id).buffer,type:m.type||"public-key",transports:m.transports})}}return d}function R3(n){if(!n)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(n);const{challenge:e,allowCredentials:t}=n,i=Ef(n,["challenge","allowCredentials"]),a=nl(e).buffer,l=Object.assign(Object.assign({},i),{challenge:a});if(t&&t.length>0){l.allowCredentials=new Array(t.length);for(let c=0;c<t.length;c++){const d=t[c];l.allowCredentials[c]=Object.assign(Object.assign({},d),{id:nl(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function I3(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n;return{id:n.id,rawId:n.id,response:{attestationObject:Ia(new Uint8Array(n.response.attestationObject)),clientDataJSON:Ia(new Uint8Array(n.response.clientDataJSON))},type:"public-key",clientExtensionResults:n.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function k3(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n,i=n.getClientExtensionResults(),a=n.response;return{id:n.id,rawId:n.id,response:{authenticatorData:Ia(new Uint8Array(a.authenticatorData)),clientDataJSON:Ia(new Uint8Array(a.clientDataJSON)),signature:Ia(new Uint8Array(a.signature)),userHandle:a.userHandle?Ia(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:i,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function qS(n){return n==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(n)}function iT(){var n,e;return!!(sn()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((n=navigator==null?void 0:navigator.credentials)===null||n===void 0?void 0:n.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function O3(n){try{const e=await navigator.credentials.create(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Qd("Browser returned unexpected credential type",e)}:{data:null,error:new Qd("Empty credential response",e)}}catch(e){return{data:null,error:E3({error:e,options:n})}}}async function j3(n){try{const e=await navigator.credentials.get(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Qd("Browser returned unexpected credential type",e)}:{data:null,error:new Qd("Empty credential response",e)}}catch(e){return{data:null,error:S3({error:e,options:n})}}}const D3={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},P3={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Jd(...n){const e=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),t=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),i={};for(const a of n)if(a)for(const l in a){const c=a[l];if(c!==void 0)if(Array.isArray(c))i[l]=c;else if(t(c))i[l]=c;else if(e(c)){const d=i[l];e(d)?i[l]=Jd(d,c):i[l]=Jd(c)}else i[l]=c}return i}function M3(n,e){return Jd(D3,n,e||{})}function L3(n,e){return Jd(P3,n,e||{})}class U3{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:i,signal:a},l){try{const{data:c,error:d}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!c)return{data:null,error:d};const p=a??N3.createNewAbortSignal();if(c.webauthn.type==="create"){const{user:m}=c.webauthn.credential_options.publicKey;m.name||(m.name=`${m.id}:${i}`),m.displayName||(m.displayName=m.name)}switch(c.webauthn.type){case"create":{const m=M3(c.webauthn.credential_options.publicKey,l==null?void 0:l.create),{data:_,error:b}=await O3({publicKey:m,signal:p});return _?{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:_}},error:null}:{data:null,error:b}}case"request":{const m=L3(c.webauthn.credential_options.publicKey,l==null?void 0:l.request),{data:_,error:b}=await j3(Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:m,signal:p}));return _?{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:_}},error:null}:{data:null,error:b}}}}catch(c){return xe(c)?{data:null,error:c}:{data:null,error:new Ea("Unexpected error in challenge",c)}}}async _verify({challengeId:e,factorId:t,webauthn:i}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:i})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},l){if(!t)return{data:null,error:new ru("rpId is required for WebAuthn authentication")};try{if(!iT())return{data:null,error:new Ea("Browser does not support WebAuthn",null)};const{data:c,error:d}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:i},signal:a},{request:l});if(!c)return{data:null,error:d};const{webauthn:p}=c;return this._verify({factorId:e,challengeId:c.challengeId,webauthn:{type:p.type,rpId:t,rpOrigins:i,credential_response:p.credential_response}})}catch(c){return xe(c)?{data:null,error:c}:{data:null,error:new Ea("Unexpected error in authenticate",c)}}}async _register({friendlyName:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},l){if(!t)return{data:null,error:new ru("rpId is required for WebAuthn registration")};try{if(!iT())return{data:null,error:new Ea("Browser does not support WebAuthn",null)};const{data:c,error:d}=await this._enroll({friendlyName:e});if(!c)return await this.client.mfa.listFactors().then(_=>{var b;return(b=_.data)===null||b===void 0?void 0:b.all.find(x=>x.factor_type==="webauthn"&&x.friendly_name===e&&x.status!=="unverified")}).then(_=>_?this.client.mfa.unenroll({factorId:_==null?void 0:_.id}):void 0),{data:null,error:d};const{data:p,error:m}=await this._challenge({factorId:c.id,friendlyName:c.friendly_name,webauthn:{rpId:t,rpOrigins:i},signal:a},{create:l});return p?this._verify({factorId:c.id,challengeId:p.challengeId,webauthn:{rpId:t,rpOrigins:i,type:p.webauthn.type,credential_response:p.webauthn.credential_response}}):{data:null,error:m}}catch(c){return xe(c)?{data:null,error:c}:{data:null,error:new Ea("Unexpected error in register",c)}}}}b3();const V3={url:P6,storageKey:M6,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:L6,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function rT(n,e,t){return await t()}const Vo={};class au{get jwks(){var e,t;return(t=(e=Vo[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Vo[this.storageKey]=Object.assign(Object.assign({},Vo[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Vo[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Vo[this.storageKey]=Object.assign(Object.assign({},Vo[this.storageKey]),{cachedAt:e})}constructor(e){var t,i,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const l=Object.assign(Object.assign({},V3),e);if(this.storageKey=l.storageKey,this.instanceID=(t=au.nextInstanceID[this.storageKey])!==null&&t!==void 0?t:0,au.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!l.debug,typeof l.debug=="function"&&(this.logger=l.debug),this.instanceID>0&&sn()){const c=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(c),this.logDebugMessages&&console.trace(c)}if(this.persistSession=l.persistSession,this.autoRefreshToken=l.autoRefreshToken,this.admin=new y3({url:l.url,headers:l.headers,fetch:l.fetch}),this.url=l.url,this.headers=l.headers,this.fetch=BS(l.fetch),this.lock=l.lock||rT,this.detectSessionInUrl=l.detectSessionInUrl,this.flowType=l.flowType,this.hasCustomAuthorizationHeader=l.hasCustomAuthorizationHeader,this.throwOnError=l.throwOnError,this.lockAcquireTimeout=l.lockAcquireTimeout,l.lock?this.lock=l.lock:this.persistSession&&sn()&&(!((i=globalThis==null?void 0:globalThis.navigator)===null||i===void 0)&&i.locks)?this.lock=_3:this.lock=rT,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new U3(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(l.storage?this.storage=l.storage:VS()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=sT(this.memoryStorage)),l.userStorage&&(this.userStorage=l.userStorage)):(this.memoryStorage={},this.storage=sT(this.memoryStorage)),sn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(c){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",c)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async c=>{this._debug("received broadcast notification from other tab or client",c);try{await this._notifyAllSubscribers(c.data.event,c.data.session,!1)}catch(d){this._debug("#broadcastChannel","error",d)}})}this.initialize().catch(c=>{this._debug("#initialize()","error",c)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${MS}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let t={},i="none";if(sn()&&(t=J6(window.location.href),this._isImplicitGrantCallback(t)?i="implicit":await this._isPKCECallback(t)&&(i="pkce")),sn()&&this.detectSessionInUrl&&i!=="none"){const{data:a,error:l}=await this._getSessionFromURL(t,i);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),H6(l)){const p=(e=l.details)===null||e===void 0?void 0:e.code;if(p==="identity_already_exists"||p==="identity_not_found"||p==="single_identity_not_deletable")return{error:l}}return{error:l}}const{session:c,redirectType:d}=a;return this._debug("#_initialize()","detected session in URL",c,"redirect type",d),await this._saveSession(c),setTimeout(async()=>{d==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return xe(t)?this._returnResult({error:t}):this._returnResult({error:new Ea("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,i,a;try{const l=await Ne(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(i=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:(a=e==null?void 0:e.options)===null||a===void 0?void 0:a.captchaToken}},xform:vs}),{data:c,error:d}=l;if(d||!c)return this._returnResult({data:{user:null,session:null},error:d});const p=c.session,m=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",p)),this._returnResult({data:{user:m,session:p},error:null})}catch(l){if(xe(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signUp(e){var t,i,a;try{let l;if("email"in e){const{email:_,password:b,options:x}=e;let S=null,N=null;this.flowType==="pkce"&&([S,N]=await Mo(this.storage,this.storageKey)),l=await Ne(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:x==null?void 0:x.emailRedirectTo,body:{email:_,password:b,data:(t=x==null?void 0:x.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:x==null?void 0:x.captchaToken},code_challenge:S,code_challenge_method:N},xform:vs})}else if("phone"in e){const{phone:_,password:b,options:x}=e;l=await Ne(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:_,password:b,data:(i=x==null?void 0:x.data)!==null&&i!==void 0?i:{},channel:(a=x==null?void 0:x.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:x==null?void 0:x.captchaToken}},xform:vs})}else throw new ud("You must provide either an email or phone number and a password");const{data:c,error:d}=l;if(d||!c)return await nn(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:d});const p=c.session,m=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",p)),this._returnResult({data:{user:m,session:p},error:null})}catch(l){if(await nn(this.storage,`${this.storageKey}-code-verifier`),xe(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signInWithPassword(e){try{let t;if("email"in e){const{email:l,password:c,options:d}=e;t=await Ne(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:c,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:tT})}else if("phone"in e){const{phone:l,password:c,options:d}=e;t=await Ne(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:c,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:tT})}else throw new ud("You must provide either an email or phone number and a password");const{data:i,error:a}=t;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!i||!i.session||!i.user){const l=new Po;return this._returnResult({data:{user:null,session:null},error:l})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:a})}catch(t){if(xe(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,i,a,l;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(i=e.options)===null||i===void 0?void 0:i.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(l=e.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,i,a,l,c,d,p,m,_,b,x;let S,N;if("message"in e)S=e.message,N=e.signature;else{const{chain:j,wallet:k,statement:L,options:H}=e;let B;if(sn())if(typeof k=="object")B=k;else{const I=window;if("ethereum"in I&&typeof I.ethereum=="object"&&"request"in I.ethereum&&typeof I.ethereum.request=="function")B=I.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof k!="object"||!(H!=null&&H.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");B=k}const K=new URL((t=H==null?void 0:H.url)!==null&&t!==void 0?t:window.location.href),F=await B.request({method:"eth_requestAccounts"}).then(I=>I).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!F||F.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const $=HS(F[0]);let A=(i=H==null?void 0:H.signInWithEthereum)===null||i===void 0?void 0:i.chainId;if(!A){const I=await B.request({method:"eth_chainId"});A=w3(I)}const C={domain:K.host,address:$,statement:L,uri:K.href,version:"1",chainId:A,nonce:(a=H==null?void 0:H.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(c=(l=H==null?void 0:H.signInWithEthereum)===null||l===void 0?void 0:l.issuedAt)!==null&&c!==void 0?c:new Date,expirationTime:(d=H==null?void 0:H.signInWithEthereum)===null||d===void 0?void 0:d.expirationTime,notBefore:(p=H==null?void 0:H.signInWithEthereum)===null||p===void 0?void 0:p.notBefore,requestId:(m=H==null?void 0:H.signInWithEthereum)===null||m===void 0?void 0:m.requestId,resources:(_=H==null?void 0:H.signInWithEthereum)===null||_===void 0?void 0:_.resources};S=T3(C),N=await B.request({method:"personal_sign",params:[x3(S),$]})}try{const{data:j,error:k}=await Ne(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:S,signature:N},!((b=e.options)===null||b===void 0)&&b.captchaToken?{gotrue_meta_security:{captcha_token:(x=e.options)===null||x===void 0?void 0:x.captchaToken}}:null),xform:vs});if(k)throw k;if(!j||!j.session||!j.user){const L=new Po;return this._returnResult({data:{user:null,session:null},error:L})}return j.session&&(await this._saveSession(j.session),await this._notifyAllSubscribers("SIGNED_IN",j.session)),this._returnResult({data:Object.assign({},j),error:k})}catch(j){if(xe(j))return this._returnResult({data:{user:null,session:null},error:j});throw j}}async signInWithSolana(e){var t,i,a,l,c,d,p,m,_,b,x,S;let N,j;if("message"in e)N=e.message,j=e.signature;else{const{chain:k,wallet:L,statement:H,options:B}=e;let K;if(sn())if(typeof L=="object")K=L;else{const $=window;if("solana"in $&&typeof $.solana=="object"&&("signIn"in $.solana&&typeof $.solana.signIn=="function"||"signMessage"in $.solana&&typeof $.solana.signMessage=="function"))K=$.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof L!="object"||!(B!=null&&B.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");K=L}const F=new URL((t=B==null?void 0:B.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in K&&K.signIn){const $=await K.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},B==null?void 0:B.signInWithSolana),{version:"1",domain:F.host,uri:F.href}),H?{statement:H}:null));let A;if(Array.isArray($)&&$[0]&&typeof $[0]=="object")A=$[0];else if($&&typeof $=="object"&&"signedMessage"in $&&"signature"in $)A=$;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in A&&"signature"in A&&(typeof A.signedMessage=="string"||A.signedMessage instanceof Uint8Array)&&A.signature instanceof Uint8Array)N=typeof A.signedMessage=="string"?A.signedMessage:new TextDecoder().decode(A.signedMessage),j=A.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in K)||typeof K.signMessage!="function"||!("publicKey"in K)||typeof K!="object"||!K.publicKey||!("toBase58"in K.publicKey)||typeof K.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");N=[`${F.host} wants you to sign in with your Solana account:`,K.publicKey.toBase58(),...H?["",H,""]:[""],"Version: 1",`URI: ${F.href}`,`Issued At: ${(a=(i=B==null?void 0:B.signInWithSolana)===null||i===void 0?void 0:i.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((l=B==null?void 0:B.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${B.signInWithSolana.notBefore}`]:[],...!((c=B==null?void 0:B.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${B.signInWithSolana.expirationTime}`]:[],...!((d=B==null?void 0:B.signInWithSolana)===null||d===void 0)&&d.chainId?[`Chain ID: ${B.signInWithSolana.chainId}`]:[],...!((p=B==null?void 0:B.signInWithSolana)===null||p===void 0)&&p.nonce?[`Nonce: ${B.signInWithSolana.nonce}`]:[],...!((m=B==null?void 0:B.signInWithSolana)===null||m===void 0)&&m.requestId?[`Request ID: ${B.signInWithSolana.requestId}`]:[],...!((b=(_=B==null?void 0:B.signInWithSolana)===null||_===void 0?void 0:_.resources)===null||b===void 0)&&b.length?["Resources",...B.signInWithSolana.resources.map(A=>`- ${A}`)]:[]].join(`
`);const $=await K.signMessage(new TextEncoder().encode(N),"utf8");if(!$||!($ instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");j=$}}try{const{data:k,error:L}=await Ne(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:N,signature:Ia(j)},!((x=e.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(S=e.options)===null||S===void 0?void 0:S.captchaToken}}:null),xform:vs});if(L)throw L;if(!k||!k.session||!k.user){const H=new Po;return this._returnResult({data:{user:null,session:null},error:H})}return k.session&&(await this._saveSession(k.session),await this._notifyAllSubscribers("SIGNED_IN",k.session)),this._returnResult({data:Object.assign({},k),error:L})}catch(k){if(xe(k))return this._returnResult({data:{user:null,session:null},error:k});throw k}}async _exchangeCodeForSession(e){const t=await ba(this.storage,`${this.storageKey}-code-verifier`),[i,a]=(t??"").split("/");try{if(!i&&this.flowType==="pkce")throw new q6;const{data:l,error:c}=await Ne(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:i},xform:vs});if(await nn(this.storage,`${this.storageKey}-code-verifier`),c)throw c;if(!l||!l.session||!l.user){const d=new Po;return this._returnResult({data:{user:null,session:null,redirectType:null},error:d})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign(Object.assign({},l),{redirectType:a??null}),error:c})}catch(l){if(await nn(this.storage,`${this.storageKey}-code-verifier`),xe(l))return this._returnResult({data:{user:null,session:null,redirectType:null},error:l});throw l}}async signInWithIdToken(e){try{const{options:t,provider:i,token:a,access_token:l,nonce:c}=e,d=await Ne(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:a,access_token:l,nonce:c,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:vs}),{data:p,error:m}=d;if(m)return this._returnResult({data:{user:null,session:null},error:m});if(!p||!p.session||!p.user){const _=new Po;return this._returnResult({data:{user:null,session:null},error:_})}return p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),this._returnResult({data:p,error:m})}catch(t){if(xe(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,i,a,l,c;try{if("email"in e){const{email:d,options:p}=e;let m=null,_=null;this.flowType==="pkce"&&([m,_]=await Mo(this.storage,this.storageKey));const{error:b}=await Ne(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:d,data:(t=p==null?void 0:p.data)!==null&&t!==void 0?t:{},create_user:(i=p==null?void 0:p.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:m,code_challenge_method:_},redirectTo:p==null?void 0:p.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:b})}if("phone"in e){const{phone:d,options:p}=e,{data:m,error:_}=await Ne(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:d,data:(a=p==null?void 0:p.data)!==null&&a!==void 0?a:{},create_user:(l=p==null?void 0:p.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},channel:(c=p==null?void 0:p.channel)!==null&&c!==void 0?c:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:m==null?void 0:m.message_id},error:_})}throw new ud("You must provide either an email or phone number.")}catch(d){if(await nn(this.storage,`${this.storageKey}-code-verifier`),xe(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async verifyOtp(e){var t,i;try{let a,l;"options"in e&&(a=(t=e.options)===null||t===void 0?void 0:t.redirectTo,l=(i=e.options)===null||i===void 0?void 0:i.captchaToken);const{data:c,error:d}=await Ne(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:l}}),redirectTo:a,xform:vs});if(d)throw d;if(!c)throw new Error("An error occurred on token verification.");const p=c.session,m=c.user;return p!=null&&p.access_token&&(await this._saveSession(p),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",p)),this._returnResult({data:{user:m,session:p},error:null})}catch(a){if(xe(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(e){var t,i,a,l,c;try{let d=null,p=null;this.flowType==="pkce"&&([d,p]=await Mo(this.storage,this.storageKey));const m=await Ne(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(i=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&i!==void 0?i:void 0}),!((a=e==null?void 0:e.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:d,code_challenge_method:p}),headers:this.headers,xform:g3});return!((l=m.data)===null||l===void 0)&&l.url&&sn()&&!(!((c=e.options)===null||c===void 0)&&c.skipBrowserRedirect)&&window.location.assign(m.data.url),this._returnResult(m)}catch(d){if(await nn(this.storage,`${this.storageKey}-code-verifier`),xe(d))return this._returnResult({data:null,error:d});throw d}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:i}=e;if(i)throw i;if(!t)throw new Vn;const{error:a}=await Ne(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(e){if(xe(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:i,type:a,options:l}=e,{error:c}=await Ne(this.fetch,"POST",t,{headers:this.headers,body:{email:i,type:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},redirectTo:l==null?void 0:l.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:c})}else if("phone"in e){const{phone:i,type:a,options:l}=e,{data:c,error:d}=await Ne(this.fetch,"POST",t,{headers:this.headers,body:{phone:i,type:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:d})}throw new ud("You must provide either an email or phone number and a type")}catch(t){if(xe(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const i=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await i,await t()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const i=t();for(this.pendingInLock.push((async()=>{try{await i}catch{}})()),await i;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await i}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await ba(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const i=e.expires_at?e.expires_at*1e3-Date.now()<Zp:!1;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",e.expires_at),!i){if(this.userStorage){const c=await ba(this.userStorage,this.storageKey+"-user");c!=null&&c.user?e.user=c.user:e.user=nm()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const c={value:this.suppressGetSessionWarning};e.user=u3(e.user,c),c.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:a,error:l}=await this._callRefreshToken(e.refresh_token);return l?this._returnResult({data:{session:null},error:l}):this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const t=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(e){try{return e?await Ne(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:xr}):await this._useSession(async t=>{var i,a,l;const{data:c,error:d}=t;if(d)throw d;return!(!((i=c.session)===null||i===void 0)&&i.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Vn}:await Ne(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(a=c.session)===null||a===void 0?void 0:a.access_token)!==null&&l!==void 0?l:void 0,xform:xr})})}catch(t){if(xe(t))return em(t)&&(await this._removeSession(),await nn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async i=>{const{data:a,error:l}=i;if(l)throw l;if(!a.session)throw new Vn;const c=a.session;let d=null,p=null;this.flowType==="pkce"&&e.email!=null&&([d,p]=await Mo(this.storage,this.storageKey));const{data:m,error:_}=await Ne(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:d,code_challenge_method:p}),jwt:c.access_token,xform:xr});if(_)throw _;return c.user=m.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),this._returnResult({data:{user:c.user},error:null})})}catch(i){if(await nn(this.storage,`${this.storageKey}-code-verifier`),xe(i))return this._returnResult({data:{user:null},error:i});throw i}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Vn;const t=Date.now()/1e3;let i=t,a=!0,l=null;const{payload:c}=dd(e.access_token);if(c.exp&&(i=c.exp,a=i<=t),a){const{data:d,error:p}=await this._callRefreshToken(e.refresh_token);if(p)return this._returnResult({data:{user:null,session:null},error:p});if(!d)return{data:{user:null,session:null},error:null};l=d}else{const{data:d,error:p}=await this._getUser(e.access_token);if(p)return this._returnResult({data:{user:null,session:null},error:p});l={access_token:e.access_token,refresh_token:e.refresh_token,user:d.user,token_type:"bearer",expires_in:i-t,expires_at:i},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return this._returnResult({data:{user:l.user,session:l},error:null})}catch(t){if(xe(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var i;if(!e){const{data:c,error:d}=t;if(d)throw d;e=(i=c.session)!==null&&i!==void 0?i:void 0}if(!(e!=null&&e.refresh_token))throw new Vn;const{data:a,error:l}=await this._callRefreshToken(e.refresh_token);return l?this._returnResult({data:{user:null,session:null},error:l}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(xe(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!sn())throw new hd("No browser detected.");if(e.error||e.error_description||e.error_code)throw new hd(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Yx("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new hd("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Yx("No code detected.");const{data:H,error:B}=await this._exchangeCodeForSession(e.code);if(B)throw B;const K=new URL(window.location.href);return K.searchParams.delete("code"),window.history.replaceState(window.history.state,"",K.toString()),{data:{session:H.session,redirectType:null},error:null}}const{provider_token:i,provider_refresh_token:a,access_token:l,refresh_token:c,expires_in:d,expires_at:p,token_type:m}=e;if(!l||!d||!c||!m)throw new hd("No session defined in URL");const _=Math.round(Date.now()/1e3),b=parseInt(d);let x=_+b;p&&(x=parseInt(p));const S=x-_;S*1e3<=Fo&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${S}s, should have been closer to ${b}s`);const N=x-b;_-N>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",N,x,_):_-N<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",N,x,_);const{data:j,error:k}=await this._getUser(l);if(k)throw k;const L={provider_token:i,provider_refresh_token:a,access_token:l,expires_in:b,expires_at:x,refresh_token:c,token_type:m,user:j.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:L,redirectType:e.type},error:null})}catch(i){if(xe(i))return this._returnResult({data:{session:null,redirectType:null},error:i});throw i}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await ba(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var i;const{data:a,error:l}=t;if(l&&!em(l))return this._returnResult({error:l});const c=(i=a.session)===null||i===void 0?void 0:i.access_token;if(c){const{error:d}=await this.admin.signOut(c,e);if(d&&!(z6(d)&&(d.status===404||d.status===401||d.status===403)||em(d)))return this._returnResult({error:d})}return e!=="others"&&(await this._removeSession(),await nn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=Q6(),i={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,i),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:i}}}async _emitInitialSession(e){return await this._useSession(async t=>{var i,a;try{const{data:{session:l},error:c}=t;if(c)throw c;await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",e,"session",l)}catch(l){await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",l),console.error(l)}})}async resetPasswordForEmail(e,t={}){let i=null,a=null;this.flowType==="pkce"&&([i,a]=await Mo(this.storage,this.storageKey,!0));try{return await Ne(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:i,code_challenge_method:a,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(l){if(await nn(this.storage,`${this.storageKey}-code-verifier`),xe(l))return this._returnResult({data:null,error:l});throw l}}async getUserIdentities(){var e;try{const{data:t,error:i}=await this.getUser();if(i)throw i;return this._returnResult({data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(t){if(xe(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:i,error:a}=await this._useSession(async l=>{var c,d,p,m,_;const{data:b,error:x}=l;if(x)throw x;const S=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(c=e.options)===null||c===void 0?void 0:c.redirectTo,scopes:(d=e.options)===null||d===void 0?void 0:d.scopes,queryParams:(p=e.options)===null||p===void 0?void 0:p.queryParams,skipBrowserRedirect:!0});return await Ne(this.fetch,"GET",S,{headers:this.headers,jwt:(_=(m=b.session)===null||m===void 0?void 0:m.access_token)!==null&&_!==void 0?_:void 0})});if(a)throw a;return sn()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(i==null?void 0:i.url),this._returnResult({data:{provider:e.provider,url:i==null?void 0:i.url},error:null})}catch(i){if(xe(i))return this._returnResult({data:{provider:e.provider,url:null},error:i});throw i}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var i;try{const{error:a,data:{session:l}}=t;if(a)throw a;const{options:c,provider:d,token:p,access_token:m,nonce:_}=e,b=await Ne(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(i=l==null?void 0:l.access_token)!==null&&i!==void 0?i:void 0,body:{provider:d,id_token:p,access_token:m,nonce:_,link_identity:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:vs}),{data:x,error:S}=b;return S?this._returnResult({data:{user:null,session:null},error:S}):!x||!x.session||!x.user?this._returnResult({data:{user:null,session:null},error:new Po}):(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("USER_UPDATED",x.session)),this._returnResult({data:x,error:S}))}catch(a){if(await nn(this.storage,`${this.storageKey}-code-verifier`),xe(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var i,a;const{data:l,error:c}=t;if(c)throw c;return await Ne(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(a=(i=l.session)===null||i===void 0?void 0:i.access_token)!==null&&a!==void 0?a:void 0})})}catch(t){if(xe(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const i=Date.now();return await e3(async a=>(a>0&&await Z6(200*Math.pow(2,a-1)),this._debug(t,"refreshing attempt",a),await Ne(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:vs})),(a,l)=>{const c=200*Math.pow(2,a);return l&&tm(l)&&Date.now()+c-i<Fo})}catch(i){if(this._debug(t,"error",i),xe(i))return this._returnResult({data:{session:null,user:null},error:i});throw i}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const i=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",i),sn()&&!t.skipBrowserRedirect&&window.location.assign(i),{data:{provider:e,url:i},error:null}}async _recoverAndRefresh(){var e,t;const i="#_recoverAndRefresh()";this._debug(i,"begin");try{const a=await ba(this.storage,this.storageKey);if(a&&this.userStorage){let c=await ba(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:a.user},await Ko(this.userStorage,this.storageKey+"-user",c)),a.user=(e=c==null?void 0:c.user)!==null&&e!==void 0?e:nm()}else if(a&&!a.user&&!a.user){const c=await ba(this.storage,this.storageKey+"-user");c&&(c!=null&&c.user)?(a.user=c.user,await nn(this.storage,this.storageKey+"-user"),await Ko(this.storage,this.storageKey,a)):a.user=nm()}if(this._debug(i,"session from storage",a),!this._isValidSession(a)){this._debug(i,"session is not valid"),a!==null&&await this._removeSession();return}const l=((t=a.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Zp;if(this._debug(i,`session has${l?"":" not"} expired with margin of ${Zp}s`),l){if(this.autoRefreshToken&&a.refresh_token){const{error:c}=await this._callRefreshToken(a.refresh_token);c&&(console.error(c),tm(c)||(this._debug(i,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:d}=await this._getUser(a.access_token);!d&&(c!=null&&c.user)?(a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(i,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(i,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(i,"error",a),console.error(a);return}finally{this._debug(i,"end")}}async _callRefreshToken(e){var t,i;if(!e)throw new Vn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Nf;const{data:l,error:c}=await this._refreshAccessToken(e);if(c)throw c;if(!l.session)throw new Vn;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const d={data:l.session,error:null};return this.refreshingDeferred.resolve(d),d}catch(l){if(this._debug(a,"error",l),xe(l)){const c={data:null,error:l};return tm(l)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(c),c}throw(i=this.refreshingDeferred)===null||i===void 0||i.reject(l),l}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,t,i=!0){const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",t,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:e,session:t});const l=[],c=Array.from(this.stateChangeEmitters.values()).map(async d=>{try{await d.callback(e,t)}catch(p){l.push(p)}});if(await Promise.all(c),l.length>0){for(let d=0;d<l.length;d+=1)console.error(l[d]);throw l[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await nn(this.storage,`${this.storageKey}-code-verifier`);const t=Object.assign({},e),i=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!i&&t.user&&await Ko(this.userStorage,this.storageKey+"-user",{user:t.user});const a=Object.assign({},t);delete a.user;const l=Zx(a);await Ko(this.storage,this.storageKey,l)}else{const a=Zx(t);await Ko(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await nn(this.storage,this.storageKey),await nn(this.storage,this.storageKey+"-code-verifier"),await nn(this.storage,this.storageKey+"-user"),this.userStorage&&await nn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&sn()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Fo);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e);const t=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const t=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,t&&clearTimeout(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:i}}=t;if(!i||!i.refresh_token||!i.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((i.expires_at*1e3-e)/Fo);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Fo}ms, refresh threshold is ${$m} ticks`),a<=$m&&await this._callRefreshToken(i.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof zS)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!sn()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(e){this._debug("#visibilityChangedCallback","error",e)}},window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,i){const a=[`provider=${encodeURIComponent(t)}`];if(i!=null&&i.redirectTo&&a.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),i!=null&&i.scopes&&a.push(`scopes=${encodeURIComponent(i.scopes)}`),this.flowType==="pkce"){const[l,c]=await Mo(this.storage,this.storageKey),d=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(c)}`});a.push(d.toString())}if(i!=null&&i.queryParams){const l=new URLSearchParams(i.queryParams);a.push(l.toString())}return i!=null&&i.skipBrowserRedirect&&a.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var i;const{data:a,error:l}=t;return l?this._returnResult({data:null,error:l}):await Ne(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(i=a==null?void 0:a.session)===null||i===void 0?void 0:i.access_token})})}catch(t){if(xe(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var i,a;const{data:l,error:c}=t;if(c)return this._returnResult({data:null,error:c});const d=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:p,error:m}=await Ne(this.fetch,"POST",`${this.url}/factors`,{body:d,headers:this.headers,jwt:(i=l==null?void 0:l.session)===null||i===void 0?void 0:i.access_token});return m?this._returnResult({data:null,error:m}):(e.factorType==="totp"&&p.type==="totp"&&(!((a=p==null?void 0:p.totp)===null||a===void 0)&&a.qr_code)&&(p.totp.qr_code=`data:image/svg+xml;utf-8,${p.totp.qr_code}`),this._returnResult({data:p,error:null}))})}catch(t){if(xe(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var i;const{data:a,error:l}=t;if(l)return this._returnResult({data:null,error:l});const c=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?I3(e.webauthn.credential_response):k3(e.webauthn.credential_response)})}:{code:e.code}),{data:d,error:p}=await Ne(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:c,headers:this.headers,jwt:(i=a==null?void 0:a.session)===null||i===void 0?void 0:i.access_token});return p?this._returnResult({data:null,error:p}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+d.expires_in},d)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",d),this._returnResult({data:d,error:p}))})}catch(t){if(xe(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var i;const{data:a,error:l}=t;if(l)return this._returnResult({data:null,error:l});const c=await Ne(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(i=a==null?void 0:a.session)===null||i===void 0?void 0:i.access_token});if(c.error)return c;const{data:d}=c;if(d.type!=="webauthn")return{data:d,error:null};switch(d.webauthn.type){case"create":return{data:Object.assign(Object.assign({},d),{webauthn:Object.assign(Object.assign({},d.webauthn),{credential_options:Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:C3(d.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},d),{webauthn:Object.assign(Object.assign({},d.webauthn),{credential_options:Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:R3(d.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(xe(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:i}=await this._challenge({factorId:e.factorId});return i?this._returnResult({data:null,error:i}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:i}=await this.getUser();if(i)return{data:null,error:i};const a={all:[],phone:[],totp:[],webauthn:[]};for(const l of(e=t==null?void 0:t.factors)!==null&&e!==void 0?e:[])a.all.push(l),l.status==="verified"&&a[l.factor_type].push(l);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(e){var t,i,a,l;if(e)try{const{payload:S}=dd(e);let N=null;S.aal&&(N=S.aal);let j=N;const{data:{user:k},error:L}=await this.getUser(e);if(L)return this._returnResult({data:null,error:L});((i=(t=k==null?void 0:k.factors)===null||t===void 0?void 0:t.filter(K=>K.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(j="aal2");const B=S.amr||[];return{data:{currentLevel:N,nextLevel:j,currentAuthenticationMethods:B},error:null}}catch(S){if(xe(S))return this._returnResult({data:null,error:S});throw S}const{data:{session:c},error:d}=await this.getSession();if(d)return this._returnResult({data:null,error:d});if(!c)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:p}=dd(c.access_token);let m=null;p.aal&&(m=p.aal);let _=m;((l=(a=c.user.factors)===null||a===void 0?void 0:a.filter(S=>S.status==="verified"))!==null&&l!==void 0?l:[]).length>0&&(_="aal2");const x=p.amr||[];return{data:{currentLevel:m,nextLevel:_,currentAuthenticationMethods:x},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:i},error:a}=t;return a?this._returnResult({data:null,error:a}):i?await Ne(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:i.access_token,xform:l=>({data:l,error:null})}):this._returnResult({data:null,error:new Vn})})}catch(t){if(xe(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async i=>{const{data:{session:a},error:l}=i;if(l)return this._returnResult({data:null,error:l});if(!a)return this._returnResult({data:null,error:new Vn});const c=await Ne(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:d=>({data:d,error:null})});return c.data&&c.data.redirect_url&&sn()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(c.data.redirect_url),c})}catch(i){if(xe(i))return this._returnResult({data:null,error:i});throw i}}async _denyAuthorization(e,t){try{return await this._useSession(async i=>{const{data:{session:a},error:l}=i;if(l)return this._returnResult({data:null,error:l});if(!a)return this._returnResult({data:null,error:new Vn});const c=await Ne(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:d=>({data:d,error:null})});return c.data&&c.data.redirect_url&&sn()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(c.data.redirect_url),c})}catch(i){if(xe(i))return this._returnResult({data:null,error:i});throw i}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:t},error:i}=e;return i?this._returnResult({data:null,error:i}):t?await Ne(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new Vn})})}catch(e){if(xe(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{const{data:{session:i},error:a}=t;return a?this._returnResult({data:null,error:a}):i?(await Ne(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:i.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Vn})})}catch(t){if(xe(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(e,t={keys:[]}){let i=t.keys.find(d=>d.kid===e);if(i)return i;const a=Date.now();if(i=this.jwks.keys.find(d=>d.kid===e),i&&this.jwks_cached_at+V6>a)return i;const{data:l,error:c}=await Ne(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=a,i=l.keys.find(d=>d.kid===e),!i)?null:i}async getClaims(e,t={}){try{let i=e;if(!i){const{data:S,error:N}=await this.getSession();if(N||!S.session)return this._returnResult({data:null,error:N});i=S.session.access_token}const{header:a,payload:l,signature:c,raw:{header:d,payload:p}}=dd(i);t!=null&&t.allowExpired||o3(l.exp);const m=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,t!=null&&t.keys?{keys:t.keys}:t==null?void 0:t.jwks);if(!m){const{error:S}=await this.getUser(i);if(S)throw S;return{data:{claims:l,header:a,signature:c},error:null}}const _=l3(a.alg),b=await crypto.subtle.importKey("jwk",m,_,!0,["verify"]);if(!await crypto.subtle.verify(_,b,c,Y6(`${d}.${p}`)))throw new Km("Invalid JWT signature");return{data:{claims:l,header:a,signature:c},error:null}}catch(i){if(xe(i))return this._returnResult({data:null,error:i});throw i}}}au.nextInstanceID={};const B3=au,z3="2.93.2";let Pc="";typeof Deno<"u"?Pc="deno":typeof document<"u"?Pc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Pc="react-native":Pc="node";const H3={"X-Client-Info":`supabase-js-${Pc}/${z3}`},q3={headers:H3},$3={schema:"public"},G3={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},F3={};function ou(n){"@babel/helpers - typeof";return ou=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ou(n)}function K3(n,e){if(ou(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(ou(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Y3(n){var e=K3(n,"string");return ou(e)=="symbol"?e:e+""}function W3(n,e,t){return(e=Y3(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function aT(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,i)}return t}function bt(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?aT(Object(t),!0).forEach(function(i){W3(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):aT(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}const Q3=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),J3=()=>Headers,X3=(n,e,t)=>{const i=Q3(t),a=J3();return async(l,c)=>{var d;const p=(d=await e())!==null&&d!==void 0?d:n;let m=new a(c==null?void 0:c.headers);return m.has("apikey")||m.set("apikey",n),m.has("Authorization")||m.set("Authorization",`Bearer ${p}`),i(l,bt(bt({},c),{},{headers:m}))}};function Z3(n){return n.endsWith("/")?n:n+"/"}function e5(n,e){var t,i;const{db:a,auth:l,realtime:c,global:d}=n,{db:p,auth:m,realtime:_,global:b}=e,x={db:bt(bt({},p),a),auth:bt(bt({},m),l),realtime:bt(bt({},_),c),storage:{},global:bt(bt(bt({},b),d),{},{headers:bt(bt({},(t=b==null?void 0:b.headers)!==null&&t!==void 0?t:{}),(i=d==null?void 0:d.headers)!==null&&i!==void 0?i:{})}),accessToken:async()=>""};return n.accessToken?x.accessToken=n.accessToken:delete x.accessToken,x}function t5(n){const e=n==null?void 0:n.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Z3(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var n5=class extends B3{constructor(n){super(n)}},s5=class{constructor(n,e,t){var i,a;this.supabaseUrl=n,this.supabaseKey=e;const l=t5(n);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:$3,realtime:F3,auth:bt(bt({},G3),{},{storageKey:c}),global:q3},p=e5(t??{},d);if(this.storageKey=(i=p.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(a=p.global.headers)!==null&&a!==void 0?a:{},p.accessToken)this.accessToken=p.accessToken,this.auth=new Proxy({},{get:(_,b)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(b)} is not possible`)}});else{var m;this.auth=this._initSupabaseAuthClient((m=p.auth)!==null&&m!==void 0?m:{},this.headers,p.global.fetch)}this.fetch=X3(e,this._getAccessToken.bind(this),p.global.fetch),this.realtime=this._initRealtimeClient(bt({headers:this.headers,accessToken:this._getAccessToken.bind(this)},p.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(_=>this.realtime.setAuth(_)).catch(_=>console.warn("Failed to set initial Realtime auth token:",_)),this.rest=new BM(new URL("rest/v1",l).href,{headers:this.headers,schema:p.db.schema,fetch:this.fetch}),this.storage=new D6(this.storageUrl.href,this.headers,this.fetch,t==null?void 0:t.storage),p.accessToken||this._listenForAuthEvents()}get functions(){return new PM(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(n){return this.rest.from(n)}schema(n){return this.rest.schema(n)}rpc(n,e={},t={head:!1,get:!1,count:void 0}){return this.rest.rpc(n,e,t)}channel(n,e={config:{}}){return this.realtime.channel(n,e)}getChannels(){return this.realtime.getChannels()}removeChannel(n){return this.realtime.removeChannel(n)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var n=this,e,t;if(n.accessToken)return await n.accessToken();const{data:i}=await n.auth.getSession();return(e=(t=i.session)===null||t===void 0?void 0:t.access_token)!==null&&e!==void 0?e:n.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:n,persistSession:e,detectSessionInUrl:t,storage:i,userStorage:a,storageKey:l,flowType:c,lock:d,debug:p,throwOnError:m},_,b){const x={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new n5({url:this.authUrl.href,headers:bt(bt({},x),_),storageKey:l,autoRefreshToken:n,persistSession:e,detectSessionInUrl:t,storage:i,userStorage:a,flowType:c,lock:d,debug:p,throwOnError:m,fetch:b,hasCustomAuthorizationHeader:Object.keys(this.headers).some(S=>S.toLowerCase()==="authorization")})}_initRealtimeClient(n){return new s6(this.realtimeUrl.href,bt(bt({},n),{},{params:bt(bt({},{apikey:this.supabaseKey}),n==null?void 0:n.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,e)=>{this._handleTokenChanged(n,"CLIENT",e==null?void 0:e.access_token)})}_handleTokenChanged(n,e,t){(n==="TOKEN_REFRESHED"||n==="SIGNED_IN")&&this.changedAccessToken!==t?(this.changedAccessToken=t,this.realtime.setAuth(t)):n==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const i5=(n,e,t)=>new s5(n,e,t);function r5(){if(typeof window<"u")return!1;const n=globalThis.process;if(!n)return!1;const e=n.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}r5()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const a5="https://prrldyvdefoyloqtrhfw.supabase.co",o5="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBycmxkeXZkZWZveWxvcXRyaGZ3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk1OTQ5NzUsImV4cCI6MjA4NTE3MDk3NX0.ANRkpfrxGKefAW3-2-WXfB7RRmQbTFIYd2VcW24OeWk",oT=i5(a5,o5),$S=async(n,e="images")=>{try{const t=n.name.split(".").pop(),a=`${`${Date.now()}_${Math.random().toString(36).substring(2)}.${t}`}`,{data:l,error:c}=await oT.storage.from(e).upload(a,n,{cacheControl:"3600",upsert:!1});if(c)throw c;const{data:d}=oT.storage.from(e).getPublicUrl(a);return d.publicUrl}catch(t){throw console.error("Supabase Upload Error:",t),new Error(t.message||"Upload failed")}},lT=le.forwardRef(({value:n,onChange:e,className:t=""},i)=>{const a=le.useRef(null),l=le.useRef(null),c=le.useRef(null),[d,p]=le.useState(!1);le.useEffect(()=>{a.current&&a.current.innerHTML!==n&&(n===""&&a.current.innerHTML!==""?a.current.innerHTML="":a.current.innerHTML===""&&n&&(a.current.innerHTML=n))},[n]),le.useImperativeHandle(i,()=>({insertText:N=>{document.activeElement===a.current||_(),document.execCommand("insertText",!1,N),x()},insertHtml:N=>{document.activeElement===a.current||_(),document.execCommand("insertHTML",!1,N),x()}}));const m=()=>{const N=window.getSelection();N&&N.rangeCount>0&&a.current&&a.current.contains(N.anchorNode)&&(l.current=N.getRangeAt(0))},_=()=>{var j;const N=window.getSelection();if(N&&!(N.rangeCount>0&&a.current&&a.current.contains(N.anchorNode))){if(l.current&&((j=a.current)!=null&&j.contains(l.current.commonAncestorContainer)))N.removeAllRanges(),N.addRange(l.current);else if(a.current){a.current.focus();const k=document.createRange();k.selectNodeContents(a.current),k.collapse(!1),N.removeAllRanges(),N.addRange(k),l.current=k}}},b=(N,j=void 0)=>{document.activeElement!==a.current&&_(),document.execCommand(N,!1,j),x()},x=()=>{a.current&&e(a.current.innerHTML),m()},S=async N=>{if(N.target.files&&N.target.files[0]){const j=N.target.files[0];p(!0);try{m();const k=await $S(j,"images");_(),document.execCommand("insertHTML",!1,`<img src="${k}" style="max-width:100%; border-radius: 8px;" />`),x()}catch(k){alert("Upload fail: "+k.message)}finally{p(!1),c.current&&(c.current.value="")}}};return f.jsxs("div",{className:`border border-slate-700 rounded-lg overflow-hidden flex flex-col ${t}`,children:[f.jsxs("div",{className:"bg-slate-800 border-b border-slate-700 p-2 flex gap-1 flex-wrap items-center",children:[f.jsx("button",{onMouseDown:N=>{N.preventDefault(),b("bold")},className:"p-1 px-2 text-slate-300 hover:bg-white/10 rounded font-bold",type:"button",title:"Bold",children:"B"}),f.jsx("button",{onMouseDown:N=>{N.preventDefault(),b("italic")},className:"p-1 px-2 text-slate-300 hover:bg-white/10 rounded italic",type:"button",title:"Italic",children:"I"}),f.jsx("button",{onMouseDown:N=>{N.preventDefault(),b("underline")},className:"p-1 px-2 text-slate-300 hover:bg-white/10 rounded underline",type:"button",title:"Underline",children:"U"}),f.jsx("div",{className:"w-px h-6 bg-slate-600 mx-1 self-center"}),f.jsx("button",{onMouseDown:N=>{N.preventDefault(),b("justifyLeft")},className:"p-1 px-2 text-slate-300 hover:bg-white/10 rounded",type:"button",title:"Align Left",children:""}),f.jsx("button",{onMouseDown:N=>{N.preventDefault(),b("justifyCenter")},className:"p-1 px-2 text-slate-300 hover:bg-white/10 rounded",type:"button",title:"Align Center",children:""}),f.jsx("button",{onMouseDown:N=>{N.preventDefault(),b("justifyRight")},className:"p-1 px-2 text-slate-300 hover:bg-white/10 rounded",type:"button",title:"Align Right",children:""}),f.jsx("div",{className:"w-px h-6 bg-slate-600 mx-1 self-center"}),f.jsx("button",{onMouseDown:N=>{N.preventDefault();const j=prompt("Nhp ng dn URL:");j&&b("createLink",j)},className:"p-1 px-2 text-slate-300 hover:bg-white/10 rounded text-blue-400",type:"button",title:"Chn Link",children:"Link"}),f.jsx("button",{onMouseDown:N=>{var j;N.preventDefault(),(j=c.current)==null||j.click()},className:"p-1 px-2 text-slate-300 hover:bg-white/10 rounded text-emerald-400 flex items-center gap-1",type:"button",title:"Upload nh (Chn ngay)",children:d?"...":f.jsxs(f.Fragment,{children:["Img",f.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})})]})}),f.jsx("input",{type:"file",ref:c,onChange:S,className:"hidden",accept:"image/*"}),f.jsxs("select",{onChange:N=>b("formatBlock",N.target.value),className:"bg-slate-700 text-white text-xs rounded px-2 py-1 outline-none border border-slate-600 ml-2",children:[f.jsx("option",{value:"p",children:"Normal"}),f.jsx("option",{value:"h3",children:"Heading 1"}),f.jsx("option",{value:"h4",children:"Heading 2"}),f.jsx("option",{value:"blockquote",children:"Quote"})]})]}),f.jsx("div",{ref:a,contentEditable:!0,onInput:x,onBlur:m,onMouseUp:m,onKeyUp:m,className:"flex-grow bg-slate-900 text-white p-4 outline-none min-h-[150px] overflow-auto prose prose-invert prose-sm max-w-none"})]})}),l5=({currentImage:n,onImageUploaded:e,onClear:t})=>{const[i,a]=le.useState(n||null),[l,c]=le.useState(!1),[d,p]=le.useState(null),m=le.useRef(null),_=le.useRef(null);le.useEffect(()=>{a(n||null)},[n]),le.useEffect(()=>{const k=L=>{if(L.clipboardData&&L.clipboardData.items){const H=L.clipboardData.items;for(let B=0;B<H.length;B++)if(H[B].type.indexOf("image")!==-1){const K=H[B].getAsFile();K&&x(K);break}}};return window.addEventListener("paste",k),()=>window.removeEventListener("paste",k)},[]);const b=k=>k.type.startsWith("image/")?k.size>5*1024*1024?(p("Dung lng hnh nh phi di 5MB."),!1):!0:(p("Ch chp nhn file hnh nh (JPG, PNG, GIF, WEBP)."),!1),x=async k=>{if(p(null),!b(k))return;const L=URL.createObjectURL(k);a(L),c(!0);try{const H=await $S(k,"images");e(H),c(!1)}catch(H){console.error("Upload error:",H);let B="C li xy ra khi ti nh ln.";H.message&&(B=H.message),p(B),c(!1)}},S=k=>{k.target.files&&k.target.files[0]&&x(k.target.files[0])},N=k=>{k.preventDefault(),k.stopPropagation(),k.dataTransfer.files&&k.dataTransfer.files[0]&&x(k.dataTransfer.files[0])},j=k=>{k.preventDefault(),k.stopPropagation()};return f.jsxs("div",{className:"space-y-3",children:[f.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400",children:"Hnh nh i din (Ti a 5MB)"}),i?f.jsxs("div",{className:"relative group rounded-xl overflow-hidden border border-slate-700 bg-slate-900",children:[f.jsx("img",{src:i,alt:"Preview",className:"w-full h-48 object-cover opacity-80 group-hover:opacity-100 transition-opacity"}),f.jsxs("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-3",children:[f.jsx("button",{onClick:()=>{var k;return(k=m.current)==null?void 0:k.click()},className:"bg-indigo-600 hover:bg-indigo-700 text-white px-3 py-1.5 rounded text-xs font-bold",children:"Thay i"}),f.jsx("button",{onClick:()=>{a(null),t()},className:"bg-red-600 hover:bg-red-700 text-white px-3 py-1.5 rounded text-xs font-bold",children:"Xa"})]}),l&&f.jsxs("div",{className:"absolute inset-0 bg-black/70 flex flex-col items-center justify-center z-10",children:[f.jsx("div",{className:"w-12 h-12 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin mb-2"}),f.jsx("span",{className:"text-white text-xs font-bold mb-2",children:"ang ti ln Supabase..."})]})]}):f.jsxs("div",{ref:_,onDrop:N,onDragOver:j,className:"border-2 border-dashed border-slate-700 hover:border-indigo-500 bg-slate-800/50 hover:bg-slate-800 rounded-xl p-8 text-center cursor-pointer transition-all flex flex-col items-center justify-center gap-2 group",onClick:()=>{var k;return(k=m.current)==null?void 0:k.click()},tabIndex:0,children:[f.jsx("svg",{className:"w-8 h-8 text-slate-500 group-hover:text-indigo-400 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),f.jsxs("div",{children:[f.jsx("span",{className:"text-indigo-400 font-bold text-sm",children:"Upload File"}),f.jsx("span",{className:"text-slate-500 text-sm",children:" hoc ko th vo y"})]}),f.jsx("div",{className:"text-[10px] text-slate-500 uppercase font-bold tracking-widest mt-1",children:"H tr Paste (Ctrl+V)"})]}),d&&f.jsx("div",{className:"text-red-400 text-xs font-bold bg-red-400/10 p-2 rounded",children:d}),f.jsx("input",{type:"file",ref:m,onChange:S,accept:"image/*",className:"hidden"})]})},Sa={async getAppNames(){try{const n=Js(ns,"system_config","app_names"),e=await Pm(n);return e.exists()?e.data().names||{}:{}}catch(n){return console.warn("App Config Fetch Error:",n),{}}},async saveAppConfig(n){try{const e=Js(ns,"system_config","app_names");await Fd(e,{names:n},{merge:!0})}catch(e){throw console.error("Error saving app config:",e),e}},async getLandingPageSettings(){try{const n=Js(ns,"system_config","landing_page"),e=await Pm(n);return e.exists()?e.data().settings:null}catch(n){return console.warn("Landing Page Config Fetch Error:",n),null}},cleanData(n){if(n==null)return null;if(Array.isArray(n))return n.map(e=>this.cleanData(e));if(typeof n=="object"){const e={};for(const t in n){const i=n[t];i!==void 0?e[t]=this.cleanData(i):e[t]=null}return e}return n},async saveLandingPageSettings(n){try{const e=Js(ns,"system_config","landing_page"),t=this.cleanData(n);console.log("Saving sanitized settings:",t),await Fd(e,{settings:t},{merge:!0})}catch(e){throw console.error("Error saving landing page config:",e),e}}},c5=({news:n,formatDate:e,onImageClick:t})=>{const[i,a]=le.useState(!1),d=(m=>{const _=document.createElement("DIV");return _.innerHTML=m,_.textContent||_.innerText||""})(n.content).split(/\s+/).filter(m=>m.length>0),p=d.length>50;return f.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-shadow",children:[f.jsx("h3",{className:"text-xl font-bold text-indigo-700 mb-2",children:n.title}),f.jsxs("div",{className:"text-xs text-gray-400 mb-4",children:[e(n.date)," | Bi ",n.author]}),n.imageUrl&&f.jsx("div",{className:"mb-4 rounded-xl overflow-hidden cursor-zoom-in shadow-sm hover:shadow-md transition-all",children:f.jsx("img",{src:n.imageUrl,alt:n.title,className:"w-full h-auto object-cover hover:scale-105 transition-transform duration-500",onClick:m=>{m.stopPropagation(),t(n.imageUrl)}})}),f.jsx("div",{className:`prose prose-slate max-w-none ${!i&&p?"line-clamp-3":""}`,onClick:m=>{const _=m.target;_.tagName==="IMG"&&(m.stopPropagation(),t(_.src))},children:i||!p?f.jsx("div",{dangerouslySetInnerHTML:{__html:n.content},className:"[&_img]:cursor-zoom-in [&_img]:rounded-lg [&_img]:shadow-sm hover:[&_img]:shadow-md [&_img]:transition-all"}):f.jsx("div",{children:f.jsxs("p",{children:[d.slice(0,50).join(" "),"..."]})})}),p&&f.jsx("button",{onClick:()=>a(!i),className:"mt-3 text-sm font-bold text-indigo-600 hover:text-indigo-800 underline decoration-2 underline-offset-4",children:i?"Thu gn":"Xem thm"})]})},u5=({user:n,onNavigate:e})=>{var de,ge,Se,ke,Le;const[t,i]=le.useState({layout:"modern",news:[],welcomeTitle:"",welcomeMessage:"",statusTitle:"",statusMessage:""}),[a,l]=le.useState(!1),[c,d]=le.useState({}),[p,m]=le.useState(!1),_=le.useRef(null),[b,x]=le.useState(null),[S,N]=le.useState(null),[j,k]=le.useState(null),[L,H]=le.useState("news"),[B,K]=le.useState(null);le.useEffect(()=>{(async()=>{try{let he=await Sa.getLandingPageSettings();if(!he){const ye=localStorage.getItem("app_settings");if(ye){console.log("Migrating local settings to cloud...");const wt=JSON.parse(ye);he=wt,await Sa.saveLandingPageSettings(wt)}}if(he)i(he),localStorage.setItem("app_settings",JSON.stringify(he));else{const ye=[{id:"1",title:"Cho mng n vi Quang Huy Studio",content:"<p>H thng <b>Multi-App Engine</b>  chnh thc vn hnh. Hy chn ng dng  bt u!</p>",date:Date.now(),author:"System"}];i({layout:"modern",news:ye,welcomeTitle:"Cho mng, {username}!",welcomeMessage:"H thng AI Studio cung cp cc cng c ti tn nht  t ng ha quy trnh sng to ni dung ca bn.",statusTitle:"Stable",statusMessage:"Tt c dch v API ang hot ng bnh thng.",zaloPhone:"0987654321",sidebarWidgets:[{id:"w1",type:"status",title:"Trng thi",order:0},{id:"w2",type:"shortcuts",title:"Li tt",order:1}]})}}catch(he){console.error("Error fetching settings:",he)}})()},[]),le.useEffect(()=>{a&&x(t)},[a]);const[F,$]=le.useState(!1),A=async ee=>{$(!0);try{const he=JSON.stringify(ee),wt=new Blob([he]).size/(1024*1024);wt>.95&&alert(` NGUY HIM: D liu ca bn nng ${wt.toFixed(2)} MB (Gn gii hn 1MB ca Database).

C th bn  copy-paste nh trc tip vo bi vit?
Hy xa nh  v dng nt "Img" (Upload)  gim dung lng.`),i(ee),a&&x(ee),localStorage.setItem("app_settings",JSON.stringify(ee)),await Sa.saveLandingPageSettings(ee)}catch(he){console.error("Failed to save:",he);const ye=(he==null?void 0:he.message)||JSON.stringify(he)||"Unknown error";alert(`Li: Khng th lu ln m my (Database).
Chi tit: ${ye}

D liu vn c lu tm  my ny.`)}finally{$(!1)}},C=async()=>{if(b){$(!0);try{const ee={...b,news:t.news};await A(ee),alert(" lu cu hnh giao din thnh cng!")}catch{}finally{$(!1)}}},I=(ee,he)=>{b&&x({...b,[ee]:he})},D=async()=>{if(!c.title||!c.content)return;const ee={id:c.id||crypto.randomUUID(),title:c.title,content:c.content,imageUrl:c.imageUrl,date:c.date||Date.now(),author:n.username};let ye=[...t.news||[]];c.id?ye=ye.map(Wt=>Wt.id===c.id?ee:Wt):ye=[ee,...ye],await A({...a&&b?b:t,news:ye}),m(!1),d({})},M=async ee=>{if(confirm("Bn c chc mun xa tin tc ny?")){const ye=(t.news||[]).filter(Wt=>Wt.id!==ee);await A({...a&&b?b:t,news:ye})}},q=ee=>new Date(ee).toLocaleDateString("vi-VN",{year:"numeric",month:"long",day:"numeric"}),O=ee=>ee?ee.replace("{username}",n.username||"User"):"",ce=(ee,he)=>{if(!b)return;const ye=[...b.sidebarWidgets||[]];he==="up"&&ee>0?[ye[ee],ye[ee-1]]=[ye[ee-1],ye[ee]]:he==="down"&&ee<ye.length-1&&([ye[ee],ye[ee+1]]=[ye[ee+1],ye[ee]]),I("sidebarWidgets",ye)},ue=()=>{var he;if(!b)return;const ee={id:crypto.randomUUID(),type:"custom",title:"Tiu  mi",content:"<p>Ni dung ty chnh...</p>",order:((he=b.sidebarWidgets)==null?void 0:he.length)||0};I("sidebarWidgets",[...b.sidebarWidgets||[],ee])},U=ee=>{var he;if(b&&confirm("Xa widget ny?")){const ye=((he=b.sidebarWidgets)==null?void 0:he.filter(wt=>wt.id!==ee))||[];I("sidebarWidgets",ye)}},se=(ee,he,ye)=>{var Wt;if(!b)return;const wt=((Wt=b.sidebarWidgets)==null?void 0:Wt.map(As=>As.id===ee?{...As,[he]:ye}:As))||[];I("sidebarWidgets",wt)},pe=ee=>{H("widget"),K(ee.id)},be=()=>{H("news"),K(null)},Ve=(ee,he)=>{const ye=[...t.news];he==="up"&&ee>0?[ye[ee],ye[ee-1]]=[ye[ee-1],ye[ee]]:he==="down"&&ee<ye.length-1&&([ye[ee],ye[ee+1]]=[ye[ee+1],ye[ee]]),A({...t,news:ye})},V=()=>f.jsx("div",{className:"flex flex-col h-full overflow-y-auto",children:j?f.jsxs("div",{className:"max-w-5xl mx-auto w-full px-6 py-12 animate-in fade-in slide-in-from-right-8",children:[f.jsxs("button",{onClick:()=>k(null),className:"mb-8 flex items-center gap-2 text-indigo-600 font-bold hover:underline",children:[f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Quay li Trang ch"]}),f.jsxs("div",{className:"bg-white rounded-3xl p-10 shadow-xl border border-indigo-100",children:[f.jsx("h1",{className:"text-4xl font-black text-gray-900 mb-8 border-b pb-4",children:j.title}),f.jsx("div",{className:"prose prose-lg max-w-none text-gray-600 [&_img]:rounded-xl [&_img]:shadow-lg [&_a]:text-blue-600 [&_a]:underline hover:[&_a]:text-blue-800",children:j.type==="custom"?f.jsx("div",{dangerouslySetInnerHTML:{__html:j.content||""}}):f.jsx("div",{children:"This widget content is dynamic."})})]})]}):f.jsxs(f.Fragment,{children:[t.zaloPhone&&f.jsxs("a",{href:`https://zalo.me/${t.zaloPhone}`,target:"_blank",rel:"noreferrer",className:"fixed bottom-24 right-6 z-40 bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-full shadow-lg flex items-center gap-2 animate-bounce transition-transform hover:scale-110",title:"Chat Zalo",children:[f.jsx("svg",{className:"w-6 h-6",viewBox:"0 0 24 24",fill:"currentColor",children:f.jsx("path",{d:"M12 2C6.48 2 2 5.92 2 10.5c0 2.37 1.17 4.54 3.12 6.13-.15.86-.54 1.95-1.42 2.62-.23.18-.08.57.21.57 2.39 0 4.19-1.29 4.88-1.93.7.13 1.43.21 2.21.21 5.52 0 10-3.92 10-8.5S17.52 2 12 2zm0 15c-.71 0-1.39-.07-2.04-.2-.27-.05-.54.04-.73.23-.74.72-2.12 1.58-3.73 1.66.44-.8 1.05-2.22 1.05-2.22.06-.16.03-.35-.09-.48C4.94 14.54 4 12.63 4 10.5 4 7.02 7.7 4 12 4s8 3.02 8 6.5-3.7 6.5-8 6.5z"})}),f.jsx("span",{className:"font-bold text-xs",children:t.zaloPhone})]}),f.jsxs("div",{className:"relative py-24 px-6 md:px-12 text-center overflow-hidden",children:[f.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-900 via-[#0f172a] to-slate-900 z-0"}),f.jsx("div",{className:"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-20 z-0"}),f.jsxs("div",{className:"relative z-10 space-y-6 max-w-4xl mx-auto",children:[f.jsx("span",{className:"inline-block py-1 px-3 rounded-full bg-indigo-500/20 border border-indigo-400/30 text-indigo-300 text-xs font-bold uppercase tracking-widest animate-in fade-in slide-in-from-bottom-4",children:"H thng iu hnh AI tp trung"}),f.jsx("h1",{className:"text-5xl md:text-7xl font-black text-transparent bg-clip-text bg-gradient-to-r from-white via-indigo-200 to-indigo-400 leading-tight drop-shadow-2xl animate-in zoom-in-95 duration-700",children:t.welcomeTitle?O(t.welcomeTitle):"QUANG HUY AI STUDIO"}),f.jsx("p",{className:"text-lg md:text-xl text-slate-400 font-light max-w-2xl mx-auto leading-relaxed animate-in fade-in slide-in-from-bottom-6 delay-200",children:t.welcomeMessage||"Nn tng tch hp a cng c mnh m, gip bn ti u ha quy trnh sng to Video v Hnh nh Viral ch vi mt c click."}),f.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-4 pt-8 animate-in fade-in slide-in-from-bottom-8 delay-300",children:[f.jsxs("button",{onClick:()=>e("video-viral"),className:"group relative px-8 py-4 bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded-2xl shadow-xl shadow-indigo-600/20 transition-all hover:-translate-y-1 active:scale-95 overflow-hidden",children:[f.jsx("div",{className:"absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform duration-300 transform skew-y-12"}),"VIDEO VIRAL ENGINE"]}),f.jsx("button",{onClick:()=>e("image-script"),className:"px-8 py-4 bg-slate-800 hover:bg-slate-700 border border-slate-700 text-white font-bold rounded-2xl shadow-xl transition-all hover:-translate-y-1 active:scale-95",children:"VISUAL SCRIPT ENGINE"})]})]})]}),f.jsxs("div",{className:"max-w-5xl mx-auto w-full px-6 py-16 space-y-12",children:[f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("h2",{className:"text-2xl font-bold text-gray-800 border-l-4 border-indigo-600 pl-4 uppercase tracking-wider",children:"Tin Tc Mi Nht"}),f.jsx("div",{className:"h-px bg-gray-200 flex-grow"})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[t.news.map(ee=>f.jsxs("div",{className:"group bg-white rounded-2xl p-6 shadow-lg border border-gray-100 hover:shadow-2xl hover:border-indigo-100 transition-all",children:[f.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-400 mb-4 font-bold uppercase tracking-wider",children:[f.jsx("span",{children:q(ee.date)}),f.jsx("span",{className:"text-indigo-500",children:ee.author})]}),ee.imageUrl&&f.jsx("div",{className:"mb-3 rounded-lg overflow-hidden h-40 w-full relative",children:f.jsx("img",{src:ee.imageUrl,alt:ee.title,className:"absolute inset-0 w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-500 cursor-zoom-in",onClick:()=>N(ee.imageUrl)})}),f.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-3 group-hover:text-indigo-600 transition-colors line-clamp-2",children:ee.title}),f.jsx("div",{className:"prose prose-sm text-gray-500 line-clamp-4 [&_img]:cursor-zoom-in",dangerouslySetInnerHTML:{__html:ee.content},onClick:he=>{const ye=he.target;ye.tagName==="IMG"&&(he.stopPropagation(),N(ye.src))}}),f.jsxs("button",{className:"mt-6 text-sm font-bold text-indigo-600 hover:text-indigo-800 flex items-center gap-2 group/btn",children:["Xem chi tit",f.jsx("svg",{className:"w-4 h-4 group-hover/btn:translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 8l4 4m0 0l-4 4m4-4H3"})})]})]},ee.id)),t.news.length===0&&f.jsx("p",{className:"text-gray-400 italic",children:"Cha c tin tc no."})]})]})]})}),te=()=>{var ee;return f.jsxs("div",{className:"h-full overflow-y-auto bg-gray-50",children:[t.zaloPhone&&f.jsxs("a",{href:`https://zalo.me/${t.zaloPhone}`,target:"_blank",rel:"noreferrer",className:"fixed bottom-24 right-6 z-40 bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-full shadow-lg flex items-center gap-2 animate-bounce transition-transform hover:scale-110",title:"Chat Zalo",children:[f.jsx("svg",{className:"w-6 h-6",viewBox:"0 0 24 24",fill:"currentColor",children:f.jsx("path",{d:"M12 2C6.48 2 2 5.92 2 10.5c0 2.37 1.17 4.54 3.12 6.13-.15.86-.54 1.95-1.42 2.62-.23.18-.08.57.21.57 2.39 0 4.19-1.29 4.88-1.93.7.13 1.43.21 2.21.21 5.52 0 10-3.92 10-8.5S17.52 2 12 2zm0 15c-.71 0-1.39-.07-2.04-.2-.27-.05-.54.04-.73.23-.74.72-2.12 1.58-3.73 1.66.44-.8 1.05-2.22 1.05-2.22.06-.16.03-.35-.09-.48C4.94 14.54 4 12.63 4 10.5 4 7.02 7.7 4 12 4s8 3.02 8 6.5-3.7 6.5-8 6.5z"})}),f.jsxs("span",{className:"font-bold text-sm",children:["H tr: ",t.zaloPhone]})]}),f.jsx("div",{className:"max-w-6xl mx-auto px-6 py-12",children:f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-12",children:[f.jsx("div",{className:"lg:col-span-2 space-y-8",children:j?f.jsxs("div",{className:"bg-white rounded-3xl p-10 shadow-xl border border-gray-100 animate-in fade-in slide-in-from-bottom-4",children:[f.jsx("button",{onClick:()=>k(null),className:"mb-6 text-sm text-slate-500 font-bold uppercase tracking-wider hover:text-indigo-600 flex items-center gap-2",children:" Quay li"}),f.jsx("h1",{className:"text-3xl font-black text-gray-900 mb-6",children:j.title}),f.jsx("div",{className:"prose max-w-none text-gray-600 [&_a]:text-blue-600 [&_a]:underline hover:[&_a]:text-blue-800",dangerouslySetInnerHTML:{__html:j.content||""}})]}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"bg-white rounded-3xl p-10 shadow-xl border border-gray-100 relative overflow-hidden",children:[f.jsx("div",{className:"absolute top-0 right-0 p-8 w-64 opacity-10",children:f.jsx("svg",{fill:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5zm0 9l2.5-1.25L12 8.5l-2.5 1.25L12 11zm0 2.5l-5-2.5-5 2.5L12 22l10-8.5-5-2.5-5 2.5z"})})}),f.jsx("h1",{className:"text-4xl font-black text-gray-900 mb-6",children:O(t.welcomeTitle)||`Cho mng, ${n.username}!`}),f.jsx("p",{className:"text-lg text-gray-600 mb-8 leading-relaxed",children:t.welcomeMessage||"H thng AI Studio cung cp cc cng c ti tn nht  t ng ha quy trnh sng to ni dung ca bn."}),f.jsx("div",{className:"flex flex-wrap gap-4"})]}),f.jsxs("div",{className:"space-y-6",children:[f.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Cp nht h thng"}),t.news.map(he=>f.jsx(c5,{news:he,formatDate:q,onImageClick:N},he.id))]})]})}),f.jsx("div",{className:"space-y-6",children:(ee=t.sidebarWidgets)==null?void 0:ee.map(he=>f.jsxs("div",{className:`${he.type==="status"?"bg-gradient-to-br from-indigo-500 to-purple-600 text-white":"bg-white text-gray-800 border-gray-100"} rounded-3xl p-8 shadow-xl border transition-all cursor-pointer hover:scale-[1.02] hover:shadow-2xl active:scale-95`,onClick:ye=>{if(he.type!=="custom")return;const Wt=ye.target.closest("a");if(Wt){ye.preventDefault(),ye.stopPropagation(),window.open(Wt.href,"_blank");return}k(he)},children:[f.jsxs("div",{className:"flex justify-between items-center mb-4 opacity-80",children:[f.jsx("h3",{className:"text-lg font-bold uppercase tracking-widest",children:he.title}),he.type==="custom"&&f.jsx("span",{className:"text-xs bg-black/10 px-2 py-1 rounded",children:"M xem"})]}),he.type==="status"&&f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"text-4xl font-black mb-4",children:t.statusTitle||"Stable"}),f.jsx("p",{className:"text-sm opacity-90",children:t.statusMessage||"Tt c dch v API ang hot ng bnh thng."})]}),he.type==="shortcuts"&&f.jsxs("ul",{className:"space-y-3 text-sm text-gray-600",children:[f.jsxs("li",{className:"flex items-center gap-2 cursor-pointer hover:text-indigo-600",children:[f.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500"})," User Guide"]}),f.jsxs("li",{className:"flex items-center gap-2 cursor-pointer hover:text-indigo-600",children:[f.jsx("span",{className:"w-2 h-2 rounded-full bg-blue-500"})," API Docs"]}),f.jsxs("li",{className:"flex items-center gap-2 cursor-pointer hover:text-indigo-600",children:[f.jsx("span",{className:"w-2 h-2 rounded-full bg-orange-500"})," Support"]})]}),he.type==="custom"&&he.content&&f.jsx("div",{className:"prose prose-sm max-w-none line-clamp-3 [&_a]:text-blue-600 [&_a]:underline hover:[&_a]:text-blue-800 relative z-10",dangerouslySetInnerHTML:{__html:he.content}})]},he.id))})]})})]})};return f.jsxs("div",{className:"relative h-full w-full bg-slate-50",children:[t.layout==="modern"&&f.jsx(V,{}),t.layout==="classic"&&f.jsx(te,{}),t.layout==="news-focus"&&f.jsx(te,{})," ",n.role==="admin"&&f.jsx("div",{className:"fixed bottom-6 right-6 z-50",children:f.jsx("button",{onClick:()=>l(!0),className:"w-14 h-14 bg-red-600 hover:bg-red-700 text-white rounded-full shadow-2xl flex items-center justify-center transition-transform hover:scale-110 active:scale-95",title:"Qun tr trang ch",children:f.jsxs("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})})}),S&&f.jsx("div",{className:"fixed inset-0 z-[300] bg-black/95 backdrop-blur-md flex items-center justify-center p-4 md:p-10 animate-in fade-in duration-300",onClick:()=>N(null),children:f.jsxs("div",{className:"relative max-w-full max-h-full flex flex-col items-center",children:[f.jsx("img",{src:S,alt:"Full View",className:"max-w-full max-h-[85vh] object-contain rounded-lg shadow-2xl",onClick:ee=>ee.stopPropagation()}),f.jsxs("button",{onClick:()=>N(null),className:"mt-6 bg-white/10 hover:bg-white/20 text-white px-6 py-2 rounded-full backdrop-blur-md border border-white/20 font-bold transition-all hover:scale-105 active:scale-95 flex items-center gap-2",children:[f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),"ng hnh nh"]})]})}),a&&f.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-[200] flex items-center justify-center p-6",children:f.jsxs("div",{className:"bg-[#1e293b] w-full max-w-4xl h-[90vh] rounded-2xl border border-white/10 shadow-2xl flex flex-col animate-in zoom-in-95",children:[f.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-white/10",children:[f.jsx("h2",{className:"text-xl font-bold text-white uppercase tracking-widest",children:"Cu hnh Trang Ch"}),f.jsxs("div",{className:"flex gap-4",children:[f.jsx("button",{onClick:async()=>{try{alert("ang kim tra kt ni Database..."),await Sa.saveLandingPageSettings({...t,_test:Date.now()});const ee=await Sa.getLandingPageSettings();ee&&ee._test?alert(` KT NI OK! Database ang hot ng tt.
 ghi v c thnh cng lc: ${new Date(ee._test).toLocaleTimeString()}`):alert(` GHI THNH CNG NHNG C THT BI.
C th do quyn truy cp (Rules) chn c.`)}catch(ee){alert(` LI KT NI: ${ee.message}
Bn khng c quyn Ghi vo Database hoc mng li.`),console.error(ee)}},className:"px-3 py-1 bg-blue-600/20 text-blue-400 border border-blue-600/30 rounded hover:bg-blue-600 hover:text-white text-xs font-bold transition-all",children:"Test Database"}),f.jsx("button",{onClick:()=>l(!1),className:"text-slate-400 hover:text-white",children:f.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})]}),f.jsxs("div",{className:"flex-grow flex overflow-hidden",children:[f.jsxs("div",{className:"w-1/3 bg-black/20 p-6 border-r border-white/5 space-y-8 overflow-y-auto flex flex-col",children:[f.jsxs("div",{className:"flex-grow space-y-8",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400 mb-3",children:"Chn B Cc (Layout)"}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{onClick:()=>I("layout","modern"),className:`p-4 rounded-xl border-2 cursor-pointer transition-all ${(b==null?void 0:b.layout)==="modern"?"border-indigo-500 bg-indigo-500/10":"border-slate-700 hover:border-slate-500"}`,children:[f.jsx("div",{className:"font-bold text-white text-sm mb-1",children:"Modern Visual (Default)"}),f.jsx("div",{className:"text-xs text-slate-400",children:"Hero ln, nn ng, card trong sut."})]}),f.jsxs("div",{onClick:()=>I("layout","classic"),className:`p-4 rounded-xl border-2 cursor-pointer transition-all ${(b==null?void 0:b.layout)==="classic"?"border-indigo-500 bg-indigo-500/10":"border-slate-700 hover:border-slate-500"}`,children:[f.jsx("div",{className:"font-bold text-white text-sm mb-1",children:"Classic Dashboard"}),f.jsx("div",{className:"text-xs text-slate-400",children:"Gn gng, tp trung thng tin."})]})]})]}),f.jsx("hr",{className:"border-white/10"}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400 mb-3",children:"Thng tin Zalo (0 n)"}),f.jsx("input",{type:"text",value:(b==null?void 0:b.zaloPhone)||"",onChange:ee=>I("zaloPhone",ee.target.value),placeholder:"ST Zalo (V d: 0987654321)",className:"w-full bg-slate-800 border-slate-700 text-white p-2 rounded text-sm"})]}),f.jsx("hr",{className:"border-white/10"}),f.jsxs("div",{children:[f.jsxs("div",{className:"flex justify-between items-center mb-3",children:[f.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400",children:"Qun l Ct Bn Phi"}),f.jsx("button",{onClick:ue,className:"text-xs bg-indigo-600 px-2 py-1 rounded text-white hover:bg-indigo-700",children:"+ Thm Ct"})]}),f.jsx("div",{className:"space-y-3",children:(de=b==null?void 0:b.sidebarWidgets)==null?void 0:de.map((ee,he)=>{var ye;return f.jsxs("div",{className:"bg-slate-800 p-3 rounded-lg border border-slate-700",children:[f.jsxs("div",{className:"flex justify-between items-center mb-2",children:[f.jsxs("span",{className:"text-xs font-bold text-slate-300",children:["#",he+1," - ",ee.type==="custom"?"Ty chnh":ee.title]}),f.jsxs("div",{className:"flex gap-1",children:[f.jsx("button",{onClick:()=>ce(he,"up"),disabled:he===0,className:"p-1 text-slate-400 hover:text-white disabled:opacity-30",children:""}),f.jsx("button",{onClick:()=>ce(he,"down"),disabled:he===(((ye=b.sidebarWidgets)==null?void 0:ye.length)||0)-1,className:"p-1 text-slate-400 hover:text-white disabled:opacity-30",children:""}),f.jsx("button",{onClick:()=>U(ee.id),className:"p-1 text-red-400 hover:text-red-300",children:""})]})]}),f.jsx("input",{type:"text",value:ee.title,onChange:wt=>se(ee.id,"title",wt.target.value),className:"w-full bg-slate-900 border border-slate-700 text-white p-1 rounded text-xs mb-2",placeholder:"Tiu  widget..."}),ee.type==="custom"&&f.jsx("button",{onClick:()=>pe(ee),className:"w-full mt-2 bg-indigo-600/50 hover:bg-indigo-600 text-white text-xs py-2 rounded border border-indigo-500/50",children:"Chnh sa ni dung (Full Editor)"})]},ee.id)})})]}),f.jsx("hr",{className:"border-white/10"}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400 mb-3",children:"Ni dung Cho mng"}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsxs("label",{className:"text-xs text-slate-500 block mb-1",children:["Tiu  (dng ","{username}","  chn tn)"]}),f.jsx("input",{type:"text",value:(b==null?void 0:b.welcomeTitle)||"",onChange:ee=>I("welcomeTitle",ee.target.value),placeholder:"Cho mng, {username}!",className:"w-full bg-slate-800 border-slate-700 text-white p-2 rounded text-sm"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-slate-500 block mb-1",children:"M t"}),f.jsx("textarea",{value:(b==null?void 0:b.welcomeMessage)||"",onChange:ee=>I("welcomeMessage",ee.target.value),placeholder:"M t ngn...",className:"w-full bg-slate-800 border-slate-700 text-white p-2 rounded text-sm h-20"})]})]})]})]}),f.jsx("div",{className:"pt-6 border-t border-white/10",children:f.jsx("button",{onClick:C,className:"w-full py-3 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-xl shadow-lg transition-all",children:"Lu Cu Hnh"})})]}),L==="news"?f.jsxs("div",{className:"w-2/3 p-6 flex flex-col bg-[#0f172a]",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsx("h3",{className:"font-bold text-white",children:"Qun l Tin Tc"}),f.jsx("button",{onClick:()=>{m(!0),d({})},className:"bg-indigo-600 hover:bg-indigo-700 text-white text-xs font-bold px-4 py-2 rounded-lg",children:"+ Thm Tin Mi"})]}),p?f.jsxs("div",{className:"flex-grow flex flex-col min-h-0",children:[f.jsxs("div",{className:"flex-grow overflow-y-auto pr-2 space-y-4",children:[f.jsx("input",{type:"text",placeholder:"Tiu  bi vit...",value:c.title||"",onChange:ee=>d({...c,title:ee.target.value}),className:"bg-slate-800 border-slate-700 text-white p-3 rounded-lg outline-none focus:border-indigo-500 w-full"}),f.jsx("div",{className:"flex flex-col min-h-[300px]",children:f.jsx(lT,{ref:_,value:c.content||"",onChange:ee=>d({...c,content:ee}),className:"flex-grow h-full"})}),f.jsxs("div",{className:"flex gap-2 flex-wrap pt-2 pb-2",children:[["","","","","","","","","","","","","","Ok",""].map(ee=>f.jsx("button",{type:"button",onMouseDown:he=>{var ye;he.preventDefault(),(ye=_.current)==null||ye.insertText(ee)},className:"bg-slate-700 hover:bg-slate-600 text-white px-2 py-1 rounded text-sm transition-colors",title:"Chn vo ni dung",children:ee},ee)),f.jsx("span",{className:"text-[10px] text-slate-500 self-center ml-2 uppercase font-bold tracking-wider opacity-60",children:"Click  chn vo ni dung"})]}),f.jsx("div",{className:"pt-2",children:f.jsx(l5,{currentImage:c.imageUrl,onImageUploaded:ee=>d({...c,imageUrl:ee}),onClear:()=>d({...c,imageUrl:void 0})})})]}),f.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-700 mt-2 flex-shrink-0 bg-[#0f172a]",children:[f.jsx("button",{onClick:()=>m(!1),className:"px-4 py-2 text-slate-400 hover:text-white",children:"Hy"}),f.jsx("button",{onClick:D,className:"px-6 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-bold",children:"Lu Tin"})]})]}):f.jsx("div",{className:"flex-grow overflow-y-auto space-y-3 pr-2",children:t.news.map((ee,he)=>f.jsxs("div",{className:"bg-slate-800 p-4 rounded-xl border border-slate-700 flex justify-between items-start group",children:[f.jsxs("div",{children:[f.jsx("h4",{className:"font-bold text-white text-sm",children:ee.title}),f.jsxs("div",{className:"text-[10px] text-slate-400 mt-1",children:[q(ee.date)," - ",ee.author]})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsxs("div",{className:"flex flex-col gap-1 mr-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[f.jsx("button",{onClick:()=>Ve(he,"up"),disabled:he===0,className:"text-slate-500 hover:text-white disabled:opacity-20",children:""}),f.jsx("button",{onClick:()=>Ve(he,"down"),disabled:he===t.news.length-1,className:"text-slate-500 hover:text-white disabled:opacity-20",children:""})]}),f.jsxs("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity items-center",children:[f.jsx("button",{onClick:()=>{d(ee),m(!0)},className:"p-1 text-blue-400 hover:bg-blue-400/10 rounded",children:"Sa"}),f.jsx("button",{onClick:()=>M(ee.id),className:"p-1 text-red-400 hover:bg-red-400/10 rounded",children:"Xa"})]})]})]},ee.id))})]}):f.jsxs("div",{className:"w-2/3 p-6 flex flex-col bg-[#0f172a]",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsxs("h3",{className:"font-bold text-white uppercase",children:["Chnh sa Widget: ",f.jsx("span",{className:"text-indigo-400",children:(Se=(ge=b==null?void 0:b.sidebarWidgets)==null?void 0:ge.find(ee=>ee.id===B))==null?void 0:Se.title})]}),f.jsx("button",{onClick:be,className:"bg-indigo-600 hover:bg-indigo-700 text-white text-xs font-bold px-4 py-2 rounded-lg",children:"Xong"})]}),f.jsxs("div",{className:"flex-grow flex flex-col min-h-0 pb-4",children:[f.jsx("label",{className:"text-xs text-slate-400 font-bold uppercase mb-2",children:"Ni dung (HTML Supported)"}),f.jsx("div",{className:"flex-grow bg-white rounded-lg overflow-hidden flex flex-col",children:f.jsx(lT,{ref:_,value:((Le=(ke=b==null?void 0:b.sidebarWidgets)==null?void 0:ke.find(ee=>ee.id===B))==null?void 0:Le.content)||"",onChange:ee=>{B&&se(B,"content",ee)},className:"flex-grow h-full text-black"})}),f.jsx("div",{className:"flex gap-2 flex-wrap pt-4",children:["","","","","","","","","","","","","","Ok",""].map(ee=>f.jsx("button",{type:"button",onMouseDown:he=>{var ye;he.preventDefault(),(ye=_.current)==null||ye.insertText(ee)},className:"bg-slate-700 hover:bg-slate-600 text-white px-2 py-1 rounded text-sm transition-colors",title:"Chn vo ni dung",children:ee},ee))})]})]})]})]})})]})},cT=[{id:"CHINESE",name:"Ting Trung",icon:""},{id:"JAPANESE",name:"Ting Nht",icon:""},{id:"KOREAN",name:"Ting Hn",icon:""}],uT={CHINESE:{batchSize:50,delaySeconds:1,customPrompt:"Dch sang ting Vit phong cch kim hip, xng h huynh-, vn phong c trang, gi nguyn cc danh xng c th.",removeSourceText:!0,autoFixFormat:!0},JAPANESE:{batchSize:40,delaySeconds:1.5,customPrompt:"Dch sang ting Vit phong cch Anime/Manga, gi nguyn cc hu t nh -san, -kun, -sama nu cn thit, dch st ngha nhng t nhin.",removeSourceText:!0,autoFixFormat:!0},KOREAN:{batchSize:45,delaySeconds:1,customPrompt:"Dch sang ting Vit phong cch phim truyn hnh Hn Quc (K-Drama), xng h Oppa/Unnie/Noona ph hp ng cnh, vn phong gn gi.",removeSourceText:!0,autoFixFormat:!0}},h5=n=>(n=n.replace(/\r\n/g,`
`),n.trim().split(/\n\s*\n/).map(t=>{const i=t.split(`
`);if(i.length<3)return{index:"",timecode:"",text:""};const a=i[0].trim(),l=i[1].trim(),c=i.slice(2).join(`
`).trim();return{index:a,timecode:l,text:c}}).filter(t=>t.index!=="")),d5=n=>n.map(e=>`${e.index}
${e.timecode}
${e.text}
`).join(`
`),f5=(n,e)=>{const t=new Uint8Array([239,187,191]),i=new Blob([t,e],{type:"text/srt;charset=utf-8"}),a=URL.createObjectURL(i),l=document.createElement("a");l.href=a,l.download=n.replace(/\.(srt|txt)$/i,"")+"_VIET.srt",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(a)},g5=(n,e)=>{let t;switch(e){case"CHINESE":t=/[\u4e00-\u9fa5]/g;break;case"JAPANESE":t=/[\u3040-\u30ff\u4e00-\u9faf]/g;break;case"KOREAN":t=/[\uac00-\ud7af]/g;break;default:t=/$/}return n.replace(t,"").trim()},p5=n=>{const e=(n==null?void 0:n.message)||(n==null?void 0:n.toString())||"";throw e.includes("429")||e.includes("Quota")||e.includes("quota")||e.includes("Resource has been exhausted")?e.includes("quota")||e.includes("Exceeded")?new Error("Ht API key, bn hy nhp thm API key  tip tc cng vic"):new Error("Hy thao tc chm li v api key ca bn khng p ng  x l nhanh"):e.includes("Network")||e.includes("fetch")?new Error("Li kt ni mng. Vui lng kim tra ng truyn."):new Error(`Li h thng: ${e}`)};class m5{constructor(e){this.apiKeys=e}getModel(){if(this.apiKeys.length===0)throw new Error("No API Keys provided");const e=this.apiKeys[Math.floor(Math.random()*this.apiKeys.length)];return new Xd(e).getGenerativeModel({model:"gemini-flash-latest"})}async translateBatch(e,t,i,a){const l=`
Bn l mt chuyn gia dch thut phim nh cao cp t ${t==="CHINESE"?"Ting Trung":t==="JAPANESE"?"Ting Nht":"Ting Hn"} sang Ting Vit.
Nhim v: Dch ni dung cc ph  di y sang Ting Vit.

Yu cu c th:
1. ${i}
2. Gi nguyn nh dng ca tng mc (Index, Timecode).
3. CH tr v bn dch Ting Vit cho phn text ca ph . Khng c bao gm ngn ng gc.
4. KHNG gii thch, KHNG thm li dn.
5. m bo cu trc SRT chnh xc:
Index
Timecode
Ni dung dch

D liu u vo:
${e.map(c=>`${c.index}
${c.timecode}
${c.text}`).join(`

`)}
    `;try{const _=((await(await this.getModel().generateContent({contents:[{role:"user",parts:[{text:l}]}],generationConfig:{temperature:.3,topP:.8}})).response).text()||"").trim().split(/\n\s*\n/);return e.map((b,x)=>{const S=_[x];if(!S)return{...b,text:"[Li dch]"};const N=S.split(`
`),j=N.length>=3?N.slice(2).join(`
`).trim():N.join(`
`).trim();return{...b,text:j||b.text}})}catch(c){console.error("Translation error:",c),p5(c)}}}const hT=({className:n="w-6 h-6",size:e=24})=>f.jsx("svg",{width:e,height:e,className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})}),y5=({className:n="w-6 h-6",size:e=24})=>f.jsx("svg",{width:e,height:e,className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),v5=({className:n="w-6 h-6",size:e=24})=>f.jsx("svg",{width:e,height:e,className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),Nc=({className:n="w-6 h-6",size:e=24})=>f.jsx("svg",{width:e,height:e,className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),_5=({className:n="w-6 h-6",size:e=24})=>f.jsxs("svg",{width:e,height:e,className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]}),dT=({className:n="w-6 h-6",size:e=24})=>f.jsx("svg",{width:e,height:e,className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),b5=({className:n="w-6 h-6",size:e=24})=>f.jsx("svg",{width:e,height:e,className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),w5=({className:n="w-6 h-6",size:e=24})=>f.jsx("svg",{width:e,height:e,className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),x5=({className:n="w-6 h-6",size:e=24})=>f.jsxs("svg",{width:e,height:e,className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),T5=({className:n="w-6 h-6",size:e=24})=>f.jsx("svg",{width:e,height:e,className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),im=({className:n="w-6 h-6",size:e=24})=>f.jsx("svg",{width:e,height:e,className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),E5=({className:n="w-6 h-6",size:e=24})=>f.jsx("svg",{width:e,height:e,className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),S5=({userId:n})=>{var B;const[e,t]=le.useState(null),[i,a]=le.useState(""),[l,c]=le.useState("CHINESE"),[d,p]=le.useState(!1),[m,_]=le.useState(uT.CHINESE),[b,x]=le.useState({isProcessing:!1,progress:0,currentBatch:0,totalBatches:0}),[S,N]=le.useState(""),j=le.useRef(null);le.useEffect(()=>{const K=localStorage.getItem(`app_api_keys_${n}`);if(K)try{const F=JSON.parse(K),A=atob(F.gemini||"").split(`
`).map(C=>C.trim()).filter(C=>C!=="");A.length>0&&N(A[0])}catch(F){console.error("Failed to load keys",F)}},[n]);const k=K=>{var $;const F=($=K.target.files)==null?void 0:$[0];if(F){t(F);const A=new FileReader;A.onload=C=>{var I;a(((I=C.target)==null?void 0:I.result)||"")},A.readAsText(F),x(C=>({...C,result:void 0,error:void 0}))}},L=()=>{e&&(p(!0),_(uT[l]))},H=async()=>{if(!i)return;if(!S){x(I=>({...I,isProcessing:!1,error:"Cha c API Key. Vui lng cu hnh  trang ch."}));return}const K=h5(i),F=m.batchSize,$=Math.ceil(K.length/F);x({isProcessing:!0,progress:0,currentBatch:0,totalBatches:$,error:void 0});const A=new m5([S]);let C=[];try{for(let D=0;D<$;D++){const M=D*F,q=Math.min(M+F,K.length),O=K.slice(M,q);x(U=>({...U,currentBatch:D+1,progress:Math.round(D/$*100)}));const ue=(await A.translateBatch(O,l,m.customPrompt,m.autoFixFormat)).map(U=>({...U,text:m.removeSourceText?g5(U.text,l):U.text}));C=[...C,...ue],D<$-1&&await new Promise(U=>setTimeout(U,m.delaySeconds*1e3))}const I=d5(C);x(D=>({...D,isProcessing:!1,progress:100,result:I}))}catch(I){x(D=>({...D,isProcessing:!1,error:" xy ra li trong qu trnh dch: "+(I.message||"Unknown error")}))}};return S?f.jsx(xS,{children:f.jsxs("div",{className:"min-h-full p-4 md:p-8 flex flex-col items-center bg-transparent",children:[f.jsxs("header",{className:"w-full max-w-4xl text-center mb-12",children:[f.jsx("div",{className:"inline-flex items-center justify-center p-3 bg-indigo-600 rounded-2xl mb-4 text-white shadow-lg",children:f.jsx(hT,{size:32})}),f.jsx("h1",{className:"text-4xl font-extrabold text-slate-900 mb-2",children:"Dch Thut Chuyn Gia"}),f.jsx("p",{className:"text-slate-500",children:"Nng tm bn dch ph  ca bn vi sc mnh ca AI"})]}),f.jsxs("main",{className:"w-full max-w-4xl bg-white rounded-3xl shadow-xl shadow-slate-200/50 border border-slate-100 overflow-hidden",children:[b.isProcessing&&f.jsx("div",{className:"h-1.5 w-full bg-slate-100 relative",children:f.jsx("div",{className:"absolute top-0 left-0 h-full bg-indigo-600 transition-all duration-500 ease-out",style:{width:`${b.progress}%`}})}),f.jsxs("div",{className:"p-8",children:[!d&&!b.isProcessing&&!b.result&&f.jsxs("div",{className:"space-y-8",children:[f.jsxs("section",{children:[f.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-3",children:"Ti ln file ngun (.srt, .txt)"}),f.jsxs("div",{onClick:()=>{var K;return(K=j.current)==null?void 0:K.click()},className:`border-2 border-dashed rounded-2xl p-10 flex flex-col items-center justify-center cursor-pointer transition-all ${e?"border-indigo-500 bg-indigo-50/30":"border-slate-200 hover:border-indigo-400 hover:bg-slate-50"}`,children:[f.jsx("input",{type:"file",ref:j,onChange:k,accept:".srt,.txt",className:"hidden"}),e?f.jsxs(f.Fragment,{children:[f.jsx(v5,{className:"text-indigo-600 mb-4 w-12 h-12",size:48}),f.jsx("p",{className:"text-indigo-900 font-medium",children:e.name}),f.jsxs("p",{className:"text-slate-500 text-sm mt-1",children:[(e.size/1024).toFixed(2)," KB"]})]}):f.jsxs(f.Fragment,{children:[f.jsx(y5,{className:"text-slate-400 mb-4 w-12 h-12",size:48}),f.jsx("p",{className:"text-slate-600 font-medium text-lg",children:"Ko th hoc nhp  chn file"}),f.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"Ch h tr nh dng .srt v .txt"})]})]})]}),e&&f.jsxs("section",{className:"animate-in fade-in slide-in-from-bottom-4 duration-500",children:[f.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-3",children:"Chn ngn ng ngun"}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:cT.map(K=>f.jsxs("button",{onClick:()=>c(K.id),className:`flex items-center gap-3 p-4 rounded-xl border-2 transition-all ${l===K.id?"border-indigo-600 bg-indigo-50 text-indigo-700":"border-slate-100 hover:border-slate-200"}`,children:[f.jsx("span",{className:"text-2xl",children:K.icon}),f.jsx("span",{className:"font-semibold",children:K.name}),l===K.id&&f.jsx(Nc,{size:20,className:"ml-auto"})]},K.id))})]}),e&&f.jsxs("button",{onClick:L,className:"w-full py-4 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl font-bold text-lg shadow-lg shadow-indigo-200 transition-all flex items-center justify-center gap-2",children:[f.jsx(_5,{size:20}),"Bt u thit lp"]})]}),d&&!b.isProcessing&&!b.result&&f.jsxs("div",{className:"space-y-8 animate-in zoom-in-95 duration-300",children:[f.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[f.jsx("button",{onClick:()=>p(!1),className:"p-2 hover:bg-slate-100 rounded-lg text-slate-500",children:f.jsx(dT,{size:20})}),f.jsxs("h2",{className:"text-xl font-bold text-slate-800",children:["Cu hnh chuyn gia cho ",(B=cT.find(K=>K.id===l))==null?void 0:B.name]})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700",children:[f.jsx(b5,{size:16,className:"text-indigo-500"}),"S ph  mi gi (Batch Size)"]}),f.jsx("input",{type:"number",value:m.batchSize,onChange:K=>_({...m,batchSize:parseInt(K.target.value)||1}),className:"w-full p-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none transition-all"}),f.jsx("p",{className:"text-xs text-slate-400",children:"Gom nhiu dng gip AI hiu ng cnh tt hn v trnh b ngt qung."})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700",children:[f.jsx(w5,{size:16,className:"text-indigo-500"}),"Thi gian ngh (s)"]}),f.jsx("input",{type:"number",step:"0.5",value:m.delaySeconds,onChange:K=>_({...m,delaySeconds:parseFloat(K.target.value)||.1}),className:"w-full p-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none transition-all"}),f.jsx("p",{className:"text-xs text-slate-400",children:"Thi gian ch gia cc ln gi API  trnh b gii hn bng thng."})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700",children:[f.jsx(x5,{size:16,className:"text-indigo-500"}),"Kim sot cht lng dch (Prompt ty chnh)"]}),f.jsx("textarea",{rows:4,value:m.customPrompt,onChange:K=>_({...m,customPrompt:K.target.value}),className:"w-full p-4 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none transition-all resize-none",placeholder:"V d: Dch phong cch kim hip, xng h huynh-..."})]}),f.jsxs("div",{className:"bg-slate-50 p-6 rounded-2xl space-y-4",children:[f.jsx("h3",{className:"font-bold text-slate-800 text-sm uppercase tracking-wider",children:"Hu k chuyn su"}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[f.jsxs("div",{className:"relative",children:[f.jsx("input",{type:"checkbox",checked:m.removeSourceText,onChange:K=>_({...m,removeSourceText:K.target.checked}),className:"sr-only peer"}),f.jsx("div",{className:"w-10 h-6 bg-slate-200 rounded-full peer peer-checked:bg-indigo-600 transition-all"}),f.jsx("div",{className:"absolute left-1 top-1 w-4 h-4 bg-white rounded-full peer-checked:translate-x-4 transition-all"})]}),f.jsxs("div",{className:"flex flex-col",children:[f.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Loi b k t tha (Regex)"}),f.jsx("span",{className:"text-xs text-slate-400",children:"T ng xa cc k t tng hnh cn st li sau khi dch."})]})]}),f.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[f.jsxs("div",{className:"relative",children:[f.jsx("input",{type:"checkbox",checked:m.autoFixFormat,onChange:K=>_({...m,autoFixFormat:K.target.checked}),className:"sr-only peer"}),f.jsx("div",{className:"w-10 h-6 bg-slate-200 rounded-full peer peer-checked:bg-indigo-600 transition-all"}),f.jsx("div",{className:"absolute left-1 top-1 w-4 h-4 bg-white rounded-full peer-checked:translate-x-4 transition-all"})]}),f.jsxs("div",{className:"flex flex-col",children:[f.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Kim tra & Sa cha nh dng SRT"}),f.jsx("span",{className:"text-xs text-slate-400",children:"m bo m thi gian v s th t chun xc 100%."})]})]})]})]}),f.jsxs("button",{onClick:H,className:"w-full py-4 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl font-bold text-lg shadow-lg shadow-indigo-200 transition-all flex items-center justify-center gap-2",children:[f.jsx(hT,{size:20}),"Tin hnh dch ngay"]})]}),b.isProcessing&&f.jsxs("div",{className:"py-12 flex flex-col items-center justify-center space-y-6",children:[f.jsxs("div",{className:"relative",children:[f.jsx(E5,{size:64,className:"text-indigo-600 animate-spin w-16 h-16"}),f.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:f.jsxs("span",{className:"text-sm font-bold text-indigo-700",children:[b.progress,"%"]})})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"ang x l d liu..."}),f.jsxs("p",{className:"text-slate-500 mt-1",children:["ang dch gi ",b.currentBatch," / ",b.totalBatches]}),f.jsxs("div",{className:"mt-6 p-4 bg-amber-50 rounded-xl border border-amber-100 flex items-center gap-3 text-amber-800 text-sm max-w-md",children:[f.jsx(im,{size:18}),"Vui lng khng ng trnh duyt cho n khi qu trnh hon tt."]})]})]}),b.result&&f.jsxs("div",{className:"py-8 flex flex-col items-center space-y-6 animate-in fade-in duration-500",children:[f.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center text-green-600 mb-2",children:f.jsx(Nc,{size:40,className:"w-10 h-10"})}),f.jsxs("div",{className:"text-center",children:[f.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Dch thnh cng!"}),f.jsx("p",{className:"text-slate-500 mt-2",children:"File ca bn  c ti u ha v sn sng s dng."})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 w-full max-w-lg",children:[f.jsxs("button",{onClick:()=>f5((e==null?void 0:e.name)||"translated.srt",b.result),className:"flex items-center justify-center gap-3 p-4 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl font-bold shadow-lg shadow-indigo-200 transition-all",children:[f.jsx(T5,{size:20}),"Ti file (.srt)"]}),f.jsxs("button",{onClick:()=>{t(null),x({isProcessing:!1,progress:0,currentBatch:0,totalBatches:0}),p(!1)},className:"flex items-center justify-center gap-3 p-4 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-bold transition-all",children:[f.jsx(dT,{size:20}),"Dch file khc"]})]}),f.jsxs("div",{className:"w-full mt-6 space-y-2",children:[f.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest ml-1",children:"Xem trc ni dung"}),f.jsx("div",{className:"w-full h-48 bg-slate-950 rounded-2xl p-4 font-mono text-xs text-slate-300 overflow-y-auto border border-slate-800",children:f.jsxs("pre",{className:"whitespace-pre-wrap",children:[b.result.slice(0,1e3),"..."]})})]})]}),b.error&&f.jsxs("div",{className:"mt-8 p-6 bg-rose-50 border border-rose-100 rounded-2xl flex items-start gap-4 text-rose-800",children:[f.jsx(im,{size:24,className:"flex-shrink-0"}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-bold",children:"Li x l"}),f.jsx("p",{className:"text-sm mt-1",children:b.error}),f.jsx("button",{onClick:()=>x(K=>({...K,error:void 0})),className:"mt-3 text-sm font-bold underline hover:no-underline",children:"Th li"})]})]})]})]}),f.jsxs("footer",{className:"mt-12 text-slate-400 text-sm flex flex-col items-center gap-4",children:[f.jsxs("div",{className:"flex items-center gap-6",children:[f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx(Nc,{size:14})," UTF-8 with BOM"]}),f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx(Nc,{size:14})," Ti u ng cnh"]}),f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx(Nc,{size:14})," T ng sa li"]})]}),f.jsx("p",{children:" 2024 Dch Thut Chuyn Gia  Bn quyn thuc v AI Studio"})]})]})}):f.jsx("div",{className:"flex flex-col items-center justify-center p-10 h-full",children:f.jsxs("div",{className:"bg-red-50 text-red-600 p-6 rounded-xl border border-red-200 text-center shadow-sm",children:[f.jsx(im,{className:"w-12 h-12 mx-auto mb-2 text-red-500"}),f.jsx("h3",{className:"font-bold text-lg mb-2",children:"Cha cu hnh API Key"}),f.jsx("p",{children:"Vui lng nhp Gemini API Key  phn qun l Key pha trn trc khi s dng ng dng ny."})]})})},A5=()=>f.jsxs("div",{className:"w-full h-full min-h-[500px] flex flex-col items-center justify-center p-10 bg-white rounded-3xl shadow-xl border border-dashed border-slate-300",children:[f.jsx("div",{className:"w-20 h-20 bg-indigo-50 rounded-full flex items-center justify-center mb-6",children:f.jsx("svg",{className:"w-10 h-10 text-indigo-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),f.jsx("h2",{className:"text-2xl font-black text-slate-800 uppercase tracking-tighter mb-2",children:"New Application"}),f.jsxs("p",{className:"text-slate-500 text-center max-w-md",children:["This is a placeholder for your future application. ",f.jsx("br",{}),"You can start building your new features here within the ",f.jsx("code",{children:"apps/NewToolApp.tsx"})," file."]}),f.jsx("button",{className:"mt-8 px-6 py-3 bg-indigo-600 text-white font-bold rounded-xl hover:bg-indigo-700 transition-all",children:"Initialize Project"})]}),N5=[{id:"video-viral",label:"Video Viral"},{id:"image-script",label:"Visual Script"},{id:"zenshot-ai",label:"ZenShot AI"},{id:"translation",label:"Translation"},{id:"new-tool",label:"New Tool"}],C5=({onClose:n})=>{const[e,t]=le.useState({}),[i,a]=le.useState(""),l=async()=>{const m=await Mm(oS(ns,"users")),_={};m.forEach(b=>{const x=b.data();_[x.username]={id:x.id,username:x.username,email:x.email,phone:x.phone,role:x.role,allowedApps:x.allowedApps,createdAt:x.createdAt}}),t(_)};le.useEffect(()=>{l()},[]);const c=async(m,_)=>{const b=e[m];if(!b)return;let x=b.allowedApps?[...b.allowedApps]:[];x.includes(_)?x=x.filter(N=>N!==_):x.push(_),t(N=>({...N,[m]:{...N[m],allowedApps:x}}));const S=Js(ns,"users",b.id);await Lm(S,{allowedApps:x})},d=async m=>{const _=e[m];if(!_)return;const b=_.role==="admin"?"user":"admin";t(S=>({...S,[m]:{...S[m],role:b}}));const x=Js(ns,"users",_.id);await Lm(x,{role:b})},p=Object.values(e).filter(m=>m.username.toLowerCase().includes(i.toLowerCase())||m.email&&m.email.toLowerCase().includes(i.toLowerCase()));return f.jsx("div",{className:"fixed inset-0 bg-slate-900/90 backdrop-blur-md flex items-center justify-center z-[400] p-6",children:f.jsxs("div",{className:"bg-white w-full max-w-5xl rounded-3xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh] animate-in zoom-in-95 duration-300",children:[f.jsxs("div",{className:"bg-[#020617] text-white p-8 flex justify-between items-center shrink-0 gap-4",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("h2",{className:"text-2xl font-black uppercase tracking-tighter",children:"Admin Control Panel (v1.2)"}),f.jsx("p",{className:"text-xs text-indigo-400 font-bold uppercase tracking-[0.3em] mt-1",children:"User & Access Management"})]}),f.jsxs("button",{onClick:l,className:"bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg font-bold text-xs uppercase tracking-widest shadow-lg transition-all flex items-center gap-2",children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Force Refresh"]}),f.jsx("button",{onClick:n,className:"bg-white/10 hover:bg-white/20 p-3 rounded-xl transition-all",children:f.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),f.jsx("div",{className:"p-6 border-b border-slate-100 bg-slate-50 flex items-center gap-4 shrink-0 justify-between",children:f.jsx("div",{className:"flex items-center gap-4 flex-1",children:f.jsxs("div",{className:"relative flex-1 max-w-md",children:[f.jsx("svg",{className:"w-5 h-5 absolute left-4 top-1/2 -translate-y-1/2 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),f.jsx("input",{type:"text",placeholder:"Search users...",className:"w-full pl-12 pr-4 py-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-indigo-500 outline-none font-medium",value:i,onChange:m=>a(m.target.value)})]})})}),f.jsx("div",{className:"overflow-y-auto flex-1 p-6 bg-slate-100",children:f.jsx("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden",children:f.jsxs("table",{className:"w-full text-left border-collapse",children:[f.jsx("thead",{children:f.jsxs("tr",{className:"bg-slate-50 border-b border-slate-200 text-xs font-black text-slate-500 uppercase tracking-wider",children:[f.jsx("th",{className:"p-4 pl-6",children:"User Identity"}),f.jsx("th",{className:"p-4",children:"Role"}),f.jsx("th",{className:"p-4 text-center",children:"Video Viral"}),f.jsx("th",{className:"p-4 text-center",children:"Visual Script"}),f.jsx("th",{className:"p-4 text-center",children:"ZenShot New"}),f.jsx("th",{className:"p-4 text-center",children:"Translation"}),f.jsx("th",{className:"p-4 text-center",children:"New App"})]})}),f.jsx("tbody",{className:"divide-y divide-slate-100",children:p.map(m=>f.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[f.jsxs("td",{className:"p-4 pl-6",children:[f.jsx("div",{className:"font-bold text-slate-800",children:m.username}),f.jsx("div",{className:"text-xs text-slate-400 font-medium",children:m.email||"No email"})]}),f.jsx("td",{className:"p-4",children:f.jsx("button",{onClick:()=>d(m.username),className:`px-3 py-1 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all ${m.role==="admin"?"bg-indigo-100 text-indigo-700 hover:bg-indigo-200":"bg-slate-100 text-slate-500 hover:bg-slate-200"}`,children:m.role})}),N5.map(_=>{var x;const b=(x=m.allowedApps)==null?void 0:x.includes(_.id);return f.jsx("td",{className:"p-4 text-center",children:f.jsxs("label",{className:"inline-flex items-center cursor-pointer relative",children:[f.jsx("input",{type:"checkbox",className:"peer sr-only",checked:b,onChange:()=>c(m.username,_.id)}),f.jsx("div",{className:"w-11 h-6 bg-slate-200 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-emerald-500"})]})},_.id)})]},m.id))})]})})}),f.jsxs("div",{className:"p-4 bg-black text-xs font-mono text-green-400 overflow-auto h-32 border-t border-slate-700 shrink-0",children:[f.jsx("p",{className:"font-bold text-white mb-2",children:"DEBUG RAW DATA (Search here for username):"}),f.jsx("pre",{className:"whitespace-pre-wrap",children:JSON.stringify(e,null,2)})]})]})})},rm={"video-viral":"Video Viral Engine","image-script":"Visual Script Engine","zenshot-ai":"ZenShot AI (New)",translation:"Translation AI","new-tool":"New Application"},R5=({currentNames:n,onClose:e,onUpdate:t})=>{const[i,a]=le.useState(n),[l,c]=le.useState(!1);le.useEffect(()=>{a({...rm,...n})},[n]);const d=(m,_)=>{a(b=>({...b,[m]:_}))},p=async()=>{c(!0);try{await Sa.saveAppConfig(i),t(),e()}catch(m){console.error("Failed to save app names",m),alert("Failed to save changes. Please try again.")}finally{c(!1)}};return f.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[200]",children:f.jsxs("div",{className:"bg-slate-900 rounded-3xl border border-indigo-500/20 shadow-2xl w-full max-w-lg overflow-hidden",children:[f.jsxs("div",{className:"p-6 border-b border-indigo-500/10 bg-indigo-500/5",children:[f.jsxs("h2",{className:"text-xl font-black text-white uppercase tracking-wider flex items-center gap-3",children:[f.jsx("span",{className:"p-2 bg-indigo-500/10 rounded-lg text-indigo-400",children:f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),"Manage App Names"]}),f.jsx("p",{className:"text-slate-400 text-xs mt-2 ml-14",children:"Customize how application names appear in the navigation bar."})]}),f.jsx("div",{className:"p-6 max-h-[60vh] overflow-y-auto space-y-4 custom-scrollbar",children:Object.keys(rm).map(m=>f.jsxs("div",{className:"group",children:[f.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2 group-hover:text-indigo-400 transition-colors",children:m.replace("-"," ")}),f.jsx("input",{type:"text",value:i[m]||"",onChange:_=>d(m,_.target.value),className:"w-full bg-slate-800/50 border border-slate-700 rounded-xl px-4 py-3 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-500 outline-none transition-all placeholder:text-slate-600",placeholder:rm[m]})]},m))}),f.jsxs("div",{className:"p-6 border-t border-indigo-500/10 bg-slate-800/20 flex justify-end gap-3",children:[f.jsx("button",{onClick:e,className:"px-5 py-2.5 rounded-xl text-slate-400 font-bold text-xs uppercase tracking-wider hover:text-white hover:bg-white/5 transition-all",children:"Cancel"}),f.jsx("button",{onClick:p,disabled:l,className:"px-6 py-2.5 rounded-xl bg-indigo-600 text-white font-bold text-xs uppercase tracking-wider hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg shadow-indigo-500/20 transition-all flex items-center gap-2",children:l?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"w-3 h-3 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Saving..."]}):"Save Changes"})]})]})})},I5=({user:n,onUpdateUser:e,onClose:t,appNames:i={},onUpdateAppNames:a=()=>{}})=>{const[l,c]=le.useState(n.email||""),[d,p]=le.useState(n.phone||""),[m,_]=le.useState(""),[b,x]=le.useState(""),[S,N]=le.useState(!1),[j,k]=le.useState(!1),L=async()=>{try{await Rr.updateProfile(n.id,{email:l,phone:d}),e({...n,email:l,phone:d}),x("Cp nht thnh cng!"),setTimeout(()=>x(""),3e3)}catch(H){console.error(H),x("Li khi cp nht!")}};return S?f.jsx(C5,{onClose:()=>N(!1)}):j?f.jsx(R5,{currentNames:i,onClose:()=>k(!1),onUpdate:a}):f.jsx("div",{className:"fixed inset-0 bg-slate-900/80 backdrop-blur-sm flex items-center justify-center z-[300] p-4",children:f.jsxs("div",{className:"bg-[#1e293b] w-full max-w-lg rounded-2xl border border-white/10 shadow-2xl p-6 md:p-8 animate-in zoom-in-95 duration-200",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6 border-b border-white/5 pb-4",children:[f.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[f.jsx("svg",{className:"w-5 h-5 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Qun l ti khon"]}),f.jsx("button",{onClick:t,className:"text-slate-400 hover:text-white transition-colors",children:f.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-xl border border-white/5 flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-[10px] text-slate-400 uppercase font-bold tracking-widest",children:"Tn ng nhp"}),f.jsx("p",{className:"text-lg font-bold text-white",children:n.username})]}),f.jsxs("div",{className:"text-right",children:[f.jsx("p",{className:"text-[10px] text-slate-400 uppercase font-bold tracking-widest",children:"Vai tr"}),f.jsx("span",{className:`inline-block px-2 py-1 rounded text-xs font-bold uppercase ${n.role==="admin"?"bg-indigo-500/20 text-indigo-400":"bg-slate-700 text-slate-300"}`,children:n.role})]})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400 mb-2",children:"Email"}),f.jsx("input",{type:"email",value:l,onChange:H=>c(H.target.value),className:"w-full bg-[#0f172a] border border-slate-700 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 outline-none text-sm"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400 mb-2",children:"S in thoi"}),f.jsx("input",{type:"tel",value:d,onChange:H=>p(H.target.value),className:"w-full bg-[#0f172a] border border-slate-700 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 outline-none text-sm"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400 mb-2",children:"i mt khu mi (Nu cn)"}),f.jsx("input",{type:"password",value:m,onChange:H=>_(H.target.value),placeholder:" trng nu khng i",className:"w-full bg-[#0f172a] border border-slate-700 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 outline-none text-sm placeholder-slate-600"})]}),b&&f.jsx("div",{className:"p-3 bg-emerald-500/10 text-emerald-400 text-sm font-bold rounded-lg text-center animate-in fade-in slide-in-from-top-2",children:b}),f.jsxs("div",{className:"pt-4 border-t border-white/5 flex justify-between gap-3 items-center",children:[n.role==="admin"?f.jsxs("div",{className:"flex gap-2",children:[f.jsxs("button",{onClick:()=>N(!0),className:"px-4 py-2 rounded-lg text-sm font-bold bg-amber-500/10 text-amber-500 hover:bg-amber-500/20 transition-all uppercase tracking-wider flex items-center gap-2",children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})}),"Admin Panel"]}),f.jsxs("button",{onClick:()=>k(!0),className:"px-4 py-2 rounded-lg text-sm font-bold bg-indigo-500/10 text-indigo-400 hover:bg-indigo-500/20 transition-all uppercase tracking-wider flex items-center gap-2",children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Manage App Names"]})]}):f.jsx("div",{}),f.jsxs("div",{className:"flex gap-3",children:[f.jsx("button",{onClick:t,className:"px-4 py-2 rounded-lg text-sm font-bold text-slate-400 hover:text-white hover:bg-white/5 transition-all",children:"ng"}),f.jsx("button",{onClick:L,className:"px-6 py-2 rounded-lg text-sm font-bold bg-indigo-600 text-white hover:bg-indigo-500 transition-all shadow-lg active:scale-95",children:"Lu Thay i"})]})]})]})]})})},Bo=(n,e)=>n?n.role==="admin"?{allowed:!0}:n.allowedApps&&n.allowedApps.includes(e)?{allowed:!0}:{allowed:!1,reason:"disabled"}:{allowed:!1,reason:"guest"},k5=()=>{const[n,e]=le.useState(null),[t,i]=le.useState("home"),[a,l]=le.useState(!1),[c,d]=le.useState(!0),[p,m]=le.useState({}),[_,b]=le.useState(!1),x=async()=>{const L=await Sa.getAppNames();m(L)};le.useEffect(()=>{x()},[]),le.useEffect(()=>{const L=Nk(Dc,async H=>{var B;try{if(H){const K=await Rr.getUserProfile(H.uid);e(K||{id:H.uid,username:H.displayName||((B=H.email)==null?void 0:B.split("@")[0])||"User",email:H.email||"",role:"user",allowedApps:["video-viral","image-script","zenshot-ai","translation"],createdAt:Date.now()}),b(!1)}else e(null)}catch(K){console.error("Firebase Auth State Error:",K),e(null)}finally{d(!1)}});return()=>L()},[]);const S=L=>{e(L),b(!1)},N=async()=>{await Rr.logoutUser(),i("home")},j=L=>{if(L==="home"){i("home");return}if(n){const K=localStorage.getItem(`app_api_keys_${n.id}`);let F=!1;if(K)try{const $=JSON.parse(K),C=(I=>{try{return atob(I)}catch{return I}})($.gemini||"");C&&C.trim().length>0&&(F=!0)}catch($){console.error("Error checking keys",$)}if(!F){alert("Hy nhp nhiu API key Gemini vo  s dng");return}}const{allowed:H,reason:B}=Bo(n,L);H?i(L):B==="guest"?(alert("App ny ch dnh cho thnh vin, hy ng k."),b(!0)):B==="disabled"&&alert("Bn cha c cp quyn truy cp ng dng ny. Vui lng lin h Admin.")},k=L=>{e(L)};return c?f.jsxs("div",{className:"min-h-screen bg-[#020617] flex items-center justify-center flex-col gap-4",children:[f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-500"}),f.jsx("p",{className:"text-slate-400 text-xs animate-pulse",children:"Loading App Engine..."})]}):_&&!n?f.jsxs("div",{className:"relative z-50",children:[f.jsx("button",{onClick:()=>b(!1),className:"fixed top-4 right-4 z-[60] text-white bg-slate-800/50 hover:bg-slate-700 p-2 rounded-full",children:" Close"}),f.jsx(LP,{onLogin:S})]}):f.jsxs("div",{className:"min-h-screen bg-slate-50 flex flex-col items-center relative",children:[n&&f.jsx(yN,{userId:n.id}),f.jsxs("nav",{className:"w-full bg-[#020617] text-white border-b border-white/5 sticky top-0 z-[100] px-6 md:px-12 py-4 backdrop-blur-2xl bg-opacity-95 shadow-2xl flex flex-col md:flex-row items-center justify-between gap-4",children:[f.jsxs("div",{className:"flex items-center gap-6 cursor-pointer",onClick:()=>j("home"),children:[f.jsx("div",{className:"bg-gradient-to-tr from-indigo-500 via-indigo-600 to-violet-600 p-3 rounded-2xl shadow-2xl shadow-indigo-500/30 ring-4 ring-indigo-500/10",children:f.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),f.jsxs("div",{className:"flex flex-col",children:[f.jsxs("h1",{className:"text-2xl font-black tracking-tighter uppercase leading-none",children:["QUANG HUY ",f.jsx("span",{className:"text-indigo-400",children:"STUDIO"})]}),f.jsx("span",{className:"text-[10px] font-black text-indigo-400/70 uppercase tracking-[0.4em] mt-1",children:"Multi-App Engine"})]})]}),f.jsx("div",{className:"flex items-center bg-white/5 rounded-2xl p-1 border border-white/10 overflow-x-auto max-w-full",children:[{id:"video-viral",defaultName:"Video Viral Engine"},{id:"image-script",defaultName:"Visual Script Engine"},{id:"zenshot-ai",defaultName:"ZenShot AI (New)"},{id:"translation",defaultName:"Translation AI"},{id:"new-tool",defaultName:"New Application"}].map(L=>f.jsx("button",{onClick:()=>j(L.id),className:`px-4 md:px-6 py-2 rounded-xl text-xs font-black uppercase tracking-widest transition-all whitespace-nowrap ${t===L.id?"bg-indigo-600 text-white shadow-lg":"text-slate-400 hover:text-white hover:bg-white/5"}`,children:p[L.id]||L.defaultName},L.id))}),f.jsx("div",{className:"flex items-center gap-6",children:n?f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"text-right hidden md:block",children:[f.jsxs("div",{className:"text-xs font-black uppercase text-indigo-400",children:["Hello, ",n.username]}),f.jsx("button",{onClick:N,className:"text-[10px] uppercase font-bold text-slate-500 hover:text-white transition-colors",children:"Logout"})]}),f.jsx("div",{className:"w-10 h-10 bg-indigo-600 rounded-full flex items-center justify-center font-black text-sm shadow-lg ring-2 ring-indigo-400/20 cursor-pointer hover:ring-indigo-400 hover:scale-105 transition-all",onClick:()=>l(!0),children:n.username.charAt(0).toUpperCase()})]}):f.jsx("button",{onClick:()=>b(!0),className:"bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2 rounded-xl font-bold text-xs uppercase tracking-widest transition-all shadow-lg shadow-indigo-500/20",children:"ng Nhp"})})]}),f.jsxs("div",{className:"w-full h-[calc(100vh-140px)]",children:[t==="home"&&f.jsx(u5,{user:n||{id:"guest",username:"Guest",role:"user",createdAt:0},onNavigate:j},(n==null?void 0:n.id)||"guest"),n&&Bo(n,"video-viral").allowed&&t==="video-viral"&&f.jsx(VP,{userId:n.id},n.id),n&&Bo(n,"image-script").allowed&&t==="image-script"&&f.jsx(QP,{userId:n.id},n.id),n&&Bo(n,"zenshot-ai").allowed&&t==="zenshot-ai"&&f.jsx(IM,{userId:n.id},n.id),n&&Bo(n,"translation").allowed&&t==="translation"&&f.jsx(S5,{userId:n.id},n.id),n&&Bo(n,"new-tool").allowed&&t==="new-tool"&&f.jsx(A5,{},n.id)]}),a&&n&&f.jsx(I5,{user:n,onUpdateUser:k,onClose:()=>l(!1),appNames:p,onUpdateAppNames:x})]})},GS=document.getElementById("root");if(!GS)throw new Error("Could not find root element to mount to");const O5=O2.createRoot(GS);O5.render(f.jsx(Gc.StrictMode,{children:f.jsx(k5,{})}));
