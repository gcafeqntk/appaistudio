(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();function hT(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Eg={exports:{}},xc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pb;function x2(){if(pb)return xc;pb=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,a,l){var c=null;if(l!==void 0&&(c=""+l),a.key!==void 0&&(c=""+a.key),"key"in a){l={};for(var d in a)d!=="key"&&(l[d]=a[d])}else l=a;return a=l.ref,{$$typeof:n,type:i,key:c,ref:a!==void 0?a:null,props:l}}return xc.Fragment=e,xc.jsx=t,xc.jsxs=t,xc}var gb;function T2(){return gb||(gb=1,Eg.exports=x2()),Eg.exports}var f=T2(),Sg={exports:{}},Oe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mb;function E2(){if(mb)return Oe;mb=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),w=Symbol.for("react.activity"),x=Symbol.iterator;function S(V){return V===null||typeof V!="object"?null:(V=x&&V[x]||V["@@iterator"],typeof V=="function"?V:null)}var A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},D=Object.assign,I={};function U(V,te,de){this.props=V,this.context=te,this.refs=I,this.updater=de||A}U.prototype.isReactComponent={},U.prototype.setState=function(V,te){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,te,"setState")},U.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function q(){}q.prototype=U.prototype;function z(V,te,de){this.props=V,this.context=te,this.refs=I,this.updater=de||A}var O=z.prototype=new q;O.constructor=z,D(O,U.prototype),O.isPureReactComponent=!0;var $=Array.isArray;function Q(){}var R={H:null,A:null,T:null,S:null},N=Object.prototype.hasOwnProperty;function k(V,te,de){var pe=de.ref;return{$$typeof:n,type:V,key:te,ref:pe!==void 0?pe:null,props:de}}function M(V,te){return k(V.type,te,V.props)}function L(V){return typeof V=="object"&&V!==null&&V.$$typeof===n}function F(V){var te={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(de){return te[de]})}var j=/\/+/g;function ce(V,te){return typeof V=="object"&&V!==null&&V.key!=null?F(""+V.key):te.toString(36)}function ue(V){switch(V.status){case"fulfilled":return V.value;case"rejected":throw V.reason;default:switch(typeof V.status=="string"?V.then(Q,Q):(V.status="pending",V.then(function(te){V.status==="pending"&&(V.status="fulfilled",V.value=te)},function(te){V.status==="pending"&&(V.status="rejected",V.reason=te)})),V.status){case"fulfilled":return V.value;case"rejected":throw V.reason}}throw V}function B(V,te,de,pe,Se){var X=typeof V;(X==="undefined"||X==="boolean")&&(V=null);var he=!1;if(V===null)he=!0;else switch(X){case"bigint":case"string":case"number":he=!0;break;case"object":switch(V.$$typeof){case n:case e:he=!0;break;case _:return he=V._init,B(he(V._payload),te,de,pe,Se)}}if(he)return Se=Se(V),he=pe===""?"."+ce(V,0):pe,$(Se)?(de="",he!=null&&(de=he.replace(j,"$&/")+"/"),B(Se,te,de,"",function(qt){return qt})):Se!=null&&(L(Se)&&(Se=M(Se,de+(Se.key==null||V&&V.key===Se.key?"":(""+Se.key).replace(j,"$&/")+"/")+he)),te.push(Se)),1;he=0;var ve=pe===""?".":pe+":";if($(V))for(var Ke=0;Ke<V.length;Ke++)pe=V[Ke],X=ve+ce(pe,Ke),he+=B(pe,te,de,X,Se);else if(Ke=S(V),typeof Ke=="function")for(V=Ke.call(V),Ke=0;!(pe=V.next()).done;)pe=pe.value,X=ve+ce(pe,Ke++),he+=B(pe,te,de,X,Se);else if(X==="object"){if(typeof V.then=="function")return B(ue(V),te,de,pe,Se);throw te=String(V),Error("Objects are not valid as a React child (found: "+(te==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":te)+"). If you meant to render a collection of children, use an array instead.")}return he}function se(V,te,de){if(V==null)return V;var pe=[],Se=0;return B(V,pe,"","",function(X){return te.call(de,X,Se++)}),pe}function ge(V){if(V._status===-1){var te=V._result;te=te(),te.then(function(de){(V._status===0||V._status===-1)&&(V._status=1,V._result=de)},function(de){(V._status===0||V._status===-1)&&(V._status=2,V._result=de)}),V._status===-1&&(V._status=0,V._result=te)}if(V._status===1)return V._result.default;throw V._result}var be=typeof reportError=="function"?reportError:function(V){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var te=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof V=="object"&&V!==null&&typeof V.message=="string"?String(V.message):String(V),error:V});if(!window.dispatchEvent(te))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",V);return}console.error(V)},Le={map:se,forEach:function(V,te,de){se(V,function(){te.apply(this,arguments)},de)},count:function(V){var te=0;return se(V,function(){te++}),te},toArray:function(V){return se(V,function(te){return te})||[]},only:function(V){if(!L(V))throw Error("React.Children.only expected to receive a single React element child.");return V}};return Oe.Activity=w,Oe.Children=Le,Oe.Component=U,Oe.Fragment=t,Oe.Profiler=a,Oe.PureComponent=z,Oe.StrictMode=i,Oe.Suspense=g,Oe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,Oe.__COMPILER_RUNTIME={__proto__:null,c:function(V){return R.H.useMemoCache(V)}},Oe.cache=function(V){return function(){return V.apply(null,arguments)}},Oe.cacheSignal=function(){return null},Oe.cloneElement=function(V,te,de){if(V==null)throw Error("The argument must be a React element, but you passed "+V+".");var pe=D({},V.props),Se=V.key;if(te!=null)for(X in te.key!==void 0&&(Se=""+te.key),te)!N.call(te,X)||X==="key"||X==="__self"||X==="__source"||X==="ref"&&te.ref===void 0||(pe[X]=te[X]);var X=arguments.length-2;if(X===1)pe.children=de;else if(1<X){for(var he=Array(X),ve=0;ve<X;ve++)he[ve]=arguments[ve+2];pe.children=he}return k(V.type,Se,pe)},Oe.createContext=function(V){return V={$$typeof:c,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null},V.Provider=V,V.Consumer={$$typeof:l,_context:V},V},Oe.createElement=function(V,te,de){var pe,Se={},X=null;if(te!=null)for(pe in te.key!==void 0&&(X=""+te.key),te)N.call(te,pe)&&pe!=="key"&&pe!=="__self"&&pe!=="__source"&&(Se[pe]=te[pe]);var he=arguments.length-2;if(he===1)Se.children=de;else if(1<he){for(var ve=Array(he),Ke=0;Ke<he;Ke++)ve[Ke]=arguments[Ke+2];Se.children=ve}if(V&&V.defaultProps)for(pe in he=V.defaultProps,he)Se[pe]===void 0&&(Se[pe]=he[pe]);return k(V,X,Se)},Oe.createRef=function(){return{current:null}},Oe.forwardRef=function(V){return{$$typeof:d,render:V}},Oe.isValidElement=L,Oe.lazy=function(V){return{$$typeof:_,_payload:{_status:-1,_result:V},_init:ge}},Oe.memo=function(V,te){return{$$typeof:m,type:V,compare:te===void 0?null:te}},Oe.startTransition=function(V){var te=R.T,de={};R.T=de;try{var pe=V(),Se=R.S;Se!==null&&Se(de,pe),typeof pe=="object"&&pe!==null&&typeof pe.then=="function"&&pe.then(Q,be)}catch(X){be(X)}finally{te!==null&&de.types!==null&&(te.types=de.types),R.T=te}},Oe.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},Oe.use=function(V){return R.H.use(V)},Oe.useActionState=function(V,te,de){return R.H.useActionState(V,te,de)},Oe.useCallback=function(V,te){return R.H.useCallback(V,te)},Oe.useContext=function(V){return R.H.useContext(V)},Oe.useDebugValue=function(){},Oe.useDeferredValue=function(V,te){return R.H.useDeferredValue(V,te)},Oe.useEffect=function(V,te){return R.H.useEffect(V,te)},Oe.useEffectEvent=function(V){return R.H.useEffectEvent(V)},Oe.useId=function(){return R.H.useId()},Oe.useImperativeHandle=function(V,te,de){return R.H.useImperativeHandle(V,te,de)},Oe.useInsertionEffect=function(V,te){return R.H.useInsertionEffect(V,te)},Oe.useLayoutEffect=function(V,te){return R.H.useLayoutEffect(V,te)},Oe.useMemo=function(V,te){return R.H.useMemo(V,te)},Oe.useOptimistic=function(V,te){return R.H.useOptimistic(V,te)},Oe.useReducer=function(V,te,de){return R.H.useReducer(V,te,de)},Oe.useRef=function(V){return R.H.useRef(V)},Oe.useState=function(V){return R.H.useState(V)},Oe.useSyncExternalStore=function(V,te,de){return R.H.useSyncExternalStore(V,te,de)},Oe.useTransition=function(){return R.H.useTransition()},Oe.version="19.2.3",Oe}var yb;function Gm(){return yb||(yb=1,Sg.exports=E2()),Sg.exports}var le=Gm();const $c=hT(le);var Ag={exports:{}},Tc={},Ng={exports:{}},Cg={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vb;function S2(){return vb||(vb=1,(function(n){function e(B,se){var ge=B.length;B.push(se);e:for(;0<ge;){var be=ge-1>>>1,Le=B[be];if(0<a(Le,se))B[be]=se,B[ge]=Le,ge=be;else break e}}function t(B){return B.length===0?null:B[0]}function i(B){if(B.length===0)return null;var se=B[0],ge=B.pop();if(ge!==se){B[0]=ge;e:for(var be=0,Le=B.length,V=Le>>>1;be<V;){var te=2*(be+1)-1,de=B[te],pe=te+1,Se=B[pe];if(0>a(de,ge))pe<Le&&0>a(Se,de)?(B[be]=Se,B[pe]=ge,be=pe):(B[be]=de,B[te]=ge,be=te);else if(pe<Le&&0>a(Se,ge))B[be]=Se,B[pe]=ge,be=pe;else break e}}return se}function a(B,se){var ge=B.sortIndex-se.sortIndex;return ge!==0?ge:B.id-se.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var c=Date,d=c.now();n.unstable_now=function(){return c.now()-d}}var g=[],m=[],_=1,w=null,x=3,S=!1,A=!1,D=!1,I=!1,U=typeof setTimeout=="function"?setTimeout:null,q=typeof clearTimeout=="function"?clearTimeout:null,z=typeof setImmediate<"u"?setImmediate:null;function O(B){for(var se=t(m);se!==null;){if(se.callback===null)i(m);else if(se.startTime<=B)i(m),se.sortIndex=se.expirationTime,e(g,se);else break;se=t(m)}}function $(B){if(D=!1,O(B),!A)if(t(g)!==null)A=!0,Q||(Q=!0,F());else{var se=t(m);se!==null&&ue($,se.startTime-B)}}var Q=!1,R=-1,N=5,k=-1;function M(){return I?!0:!(n.unstable_now()-k<N)}function L(){if(I=!1,Q){var B=n.unstable_now();k=B;var se=!0;try{e:{A=!1,D&&(D=!1,q(R),R=-1),S=!0;var ge=x;try{t:{for(O(B),w=t(g);w!==null&&!(w.expirationTime>B&&M());){var be=w.callback;if(typeof be=="function"){w.callback=null,x=w.priorityLevel;var Le=be(w.expirationTime<=B);if(B=n.unstable_now(),typeof Le=="function"){w.callback=Le,O(B),se=!0;break t}w===t(g)&&i(g),O(B)}else i(g);w=t(g)}if(w!==null)se=!0;else{var V=t(m);V!==null&&ue($,V.startTime-B),se=!1}}break e}finally{w=null,x=ge,S=!1}se=void 0}}finally{se?F():Q=!1}}}var F;if(typeof z=="function")F=function(){z(L)};else if(typeof MessageChannel<"u"){var j=new MessageChannel,ce=j.port2;j.port1.onmessage=L,F=function(){ce.postMessage(null)}}else F=function(){U(L,0)};function ue(B,se){R=U(function(){B(n.unstable_now())},se)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(B){B.callback=null},n.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<B?Math.floor(1e3/B):5},n.unstable_getCurrentPriorityLevel=function(){return x},n.unstable_next=function(B){switch(x){case 1:case 2:case 3:var se=3;break;default:se=x}var ge=x;x=se;try{return B()}finally{x=ge}},n.unstable_requestPaint=function(){I=!0},n.unstable_runWithPriority=function(B,se){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var ge=x;x=B;try{return se()}finally{x=ge}},n.unstable_scheduleCallback=function(B,se,ge){var be=n.unstable_now();switch(typeof ge=="object"&&ge!==null?(ge=ge.delay,ge=typeof ge=="number"&&0<ge?be+ge:be):ge=be,B){case 1:var Le=-1;break;case 2:Le=250;break;case 5:Le=1073741823;break;case 4:Le=1e4;break;default:Le=5e3}return Le=ge+Le,B={id:_++,callback:se,priorityLevel:B,startTime:ge,expirationTime:Le,sortIndex:-1},ge>be?(B.sortIndex=ge,e(m,B),t(g)===null&&B===t(m)&&(D?(q(R),R=-1):D=!0,ue($,ge-be))):(B.sortIndex=Le,e(g,B),A||S||(A=!0,Q||(Q=!0,F()))),B},n.unstable_shouldYield=M,n.unstable_wrapCallback=function(B){var se=x;return function(){var ge=x;x=se;try{return B.apply(this,arguments)}finally{x=ge}}}})(Cg)),Cg}var _b;function A2(){return _b||(_b=1,Ng.exports=S2()),Ng.exports}var Rg={exports:{}},an={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bb;function N2(){if(bb)return an;bb=1;var n=Gm();function e(g){var m="https://react.dev/errors/"+g;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)m+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+g+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(g,m,_){var w=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:w==null?null:""+w,children:g,containerInfo:m,implementation:_}}var c=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(g,m){if(g==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return an.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,an.createPortal=function(g,m){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(e(299));return l(g,m,null,_)},an.flushSync=function(g){var m=c.T,_=i.p;try{if(c.T=null,i.p=2,g)return g()}finally{c.T=m,i.p=_,i.d.f()}},an.preconnect=function(g,m){typeof g=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,i.d.C(g,m))},an.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},an.preinit=function(g,m){if(typeof g=="string"&&m&&typeof m.as=="string"){var _=m.as,w=d(_,m.crossOrigin),x=typeof m.integrity=="string"?m.integrity:void 0,S=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;_==="style"?i.d.S(g,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:w,integrity:x,fetchPriority:S}):_==="script"&&i.d.X(g,{crossOrigin:w,integrity:x,fetchPriority:S,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},an.preinitModule=function(g,m){if(typeof g=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var _=d(m.as,m.crossOrigin);i.d.M(g,{crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&i.d.M(g)},an.preload=function(g,m){if(typeof g=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var _=m.as,w=d(_,m.crossOrigin);i.d.L(g,_,{crossOrigin:w,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},an.preloadModule=function(g,m){if(typeof g=="string")if(m){var _=d(m.as,m.crossOrigin);i.d.m(g,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else i.d.m(g)},an.requestFormReset=function(g){i.d.r(g)},an.unstable_batchedUpdates=function(g,m){return g(m)},an.useFormState=function(g,m,_){return c.H.useFormState(g,m,_)},an.useFormStatus=function(){return c.H.useHostTransitionStatus()},an.version="19.2.3",an}var wb;function C2(){if(wb)return Rg.exports;wb=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Rg.exports=N2(),Rg.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xb;function R2(){if(xb)return Tc;xb=1;var n=A2(),e=Gm(),t=C2();function i(s){var r="https://react.dev/errors/"+s;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)r+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+s+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function l(s){var r=s,o=s;if(s.alternate)for(;r.return;)r=r.return;else{s=r;do r=s,(r.flags&4098)!==0&&(o=r.return),s=r.return;while(s)}return r.tag===3?o:null}function c(s){if(s.tag===13){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function d(s){if(s.tag===31){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function g(s){if(l(s)!==s)throw Error(i(188))}function m(s){var r=s.alternate;if(!r){if(r=l(s),r===null)throw Error(i(188));return r!==s?null:s}for(var o=s,u=r;;){var p=o.return;if(p===null)break;var y=p.alternate;if(y===null){if(u=p.return,u!==null){o=u;continue}break}if(p.child===y.child){for(y=p.child;y;){if(y===o)return g(p),s;if(y===u)return g(p),r;y=y.sibling}throw Error(i(188))}if(o.return!==u.return)o=p,u=y;else{for(var b=!1,E=p.child;E;){if(E===o){b=!0,o=p,u=y;break}if(E===u){b=!0,u=p,o=y;break}E=E.sibling}if(!b){for(E=y.child;E;){if(E===o){b=!0,o=y,u=p;break}if(E===u){b=!0,u=y,o=p;break}E=E.sibling}if(!b)throw Error(i(189))}}if(o.alternate!==u)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?s:r}function _(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s;for(s=s.child;s!==null;){if(r=_(s),r!==null)return r;s=s.sibling}return null}var w=Object.assign,x=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),A=Symbol.for("react.portal"),D=Symbol.for("react.fragment"),I=Symbol.for("react.strict_mode"),U=Symbol.for("react.profiler"),q=Symbol.for("react.consumer"),z=Symbol.for("react.context"),O=Symbol.for("react.forward_ref"),$=Symbol.for("react.suspense"),Q=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),N=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),M=Symbol.for("react.memo_cache_sentinel"),L=Symbol.iterator;function F(s){return s===null||typeof s!="object"?null:(s=L&&s[L]||s["@@iterator"],typeof s=="function"?s:null)}var j=Symbol.for("react.client.reference");function ce(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===j?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case D:return"Fragment";case U:return"Profiler";case I:return"StrictMode";case $:return"Suspense";case Q:return"SuspenseList";case k:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case A:return"Portal";case z:return s.displayName||"Context";case q:return(s._context.displayName||"Context")+".Consumer";case O:var r=s.render;return s=s.displayName,s||(s=r.displayName||r.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case R:return r=s.displayName||null,r!==null?r:ce(s.type)||"Memo";case N:r=s._payload,s=s._init;try{return ce(s(r))}catch{}}return null}var ue=Array.isArray,B=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,se=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ge={pending:!1,data:null,method:null,action:null},be=[],Le=-1;function V(s){return{current:s}}function te(s){0>Le||(s.current=be[Le],be[Le]=null,Le--)}function de(s,r){Le++,be[Le]=s.current,s.current=r}var pe=V(null),Se=V(null),X=V(null),he=V(null);function ve(s,r){switch(de(X,r),de(Se,s),de(pe,null),r.nodeType){case 9:case 11:s=(s=r.documentElement)&&(s=s.namespaceURI)?L_(s):0;break;default:if(s=r.tagName,r=r.namespaceURI)r=L_(r),s=U_(r,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}te(pe),de(pe,s)}function Ke(){te(pe),te(Se),te(X)}function qt(s){s.memoizedState!==null&&de(he,s);var r=pe.current,o=U_(r,s.type);r!==o&&(de(Se,s),de(pe,o))}function Ts(s){Se.current===s&&(te(pe),te(Se)),he.current===s&&(te(he),vc._currentValue=ge)}var Ha,qa;function Es(s){if(Ha===void 0)try{throw Error()}catch(o){var r=o.stack.trim().match(/\n( *(at )?)/);Ha=r&&r[1]||"",qa=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ha+s+qa}var vl=!1;function zr(s,r){if(!s||vl)return"";vl=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(r){var re=function(){throw Error()};if(Object.defineProperty(re.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(re,[])}catch(ee){var J=ee}Reflect.construct(s,[],re)}else{try{re.call()}catch(ee){J=ee}s.call(re.prototype)}}else{try{throw Error()}catch(ee){J=ee}(re=s())&&typeof re.catch=="function"&&re.catch(function(){})}}catch(ee){if(ee&&J&&typeof ee.stack=="string")return[ee.stack,J.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=u.DetermineComponentFrameRoot(),b=y[0],E=y[1];if(b&&E){var P=b.split(`
`),W=E.split(`
`);for(p=u=0;u<P.length&&!P[u].includes("DetermineComponentFrameRoot");)u++;for(;p<W.length&&!W[p].includes("DetermineComponentFrameRoot");)p++;if(u===P.length||p===W.length)for(u=P.length-1,p=W.length-1;1<=u&&0<=p&&P[u]!==W[p];)p--;for(;1<=u&&0<=p;u--,p--)if(P[u]!==W[p]){if(u!==1||p!==1)do if(u--,p--,0>p||P[u]!==W[p]){var ne=`
`+P[u].replace(" at new "," at ");return s.displayName&&ne.includes("<anonymous>")&&(ne=ne.replace("<anonymous>",s.displayName)),ne}while(1<=u&&0<=p);break}}}finally{vl=!1,Error.prepareStackTrace=o}return(o=s?s.displayName||s.name:"")?Es(o):""}function _l(s,r){switch(s.tag){case 26:case 27:case 5:return Es(s.type);case 16:return Es("Lazy");case 13:return s.child!==r&&r!==null?Es("Suspense Fallback"):Es("Suspense");case 19:return Es("SuspenseList");case 0:case 15:return zr(s.type,!1);case 11:return zr(s.type.render,!1);case 1:return zr(s.type,!0);case 31:return Es("Activity");default:return""}}function bl(s){try{var r="",o=null;do r+=_l(s,o),o=s,s=s.return;while(s);return r}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var At=Object.prototype.hasOwnProperty,Vt=n.unstable_scheduleCallback,Di=n.unstable_cancelCallback,Af=n.unstable_shouldYield,Tu=n.unstable_requestPaint,dn=n.unstable_now,Hr=n.unstable_getCurrentPriorityLevel,wl=n.unstable_ImmediatePriority,xl=n.unstable_UserBlockingPriority,Pi=n.unstable_NormalPriority,Nf=n.unstable_LowPriority,Eu=n.unstable_IdlePriority,Su=n.log,Au=n.unstable_setDisableYieldValue,ss=null,Yt=null;function Bn(s){if(typeof Su=="function"&&Au(s),Yt&&typeof Yt.setStrictMode=="function")try{Yt.setStrictMode(ss,s)}catch{}}var bt=Math.clz32?Math.clz32:Cu,Nu=Math.log,$a=Math.LN2;function Cu(s){return s>>>=0,s===0?32:31-(Nu(s)/$a|0)|0}var Ss=256,qr=262144,Nt=4194304;function As(s){var r=s&42;if(r!==0)return r;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Ns(s,r,o){var u=s.pendingLanes;if(u===0)return 0;var p=0,y=s.suspendedLanes,b=s.pingedLanes;s=s.warmLanes;var E=u&134217727;return E!==0?(u=E&~y,u!==0?p=As(u):(b&=E,b!==0?p=As(b):o||(o=E&~s,o!==0&&(p=As(o))))):(E=u&~y,E!==0?p=As(E):b!==0?p=As(b):o||(o=u&~s,o!==0&&(p=As(o)))),p===0?0:r!==0&&r!==p&&(r&y)===0&&(y=p&-p,o=r&-r,y>=o||y===32&&(o&4194048)!==0)?r:p}function is(s,r){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&r)===0}function Cf(s,r){switch(s){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ru(){var s=Nt;return Nt<<=1,(Nt&62914560)===0&&(Nt=4194304),s}function Cs(s){for(var r=[],o=0;31>o;o++)r.push(s);return r}function $r(s,r){s.pendingLanes|=r,r!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Rf(s,r,o,u,p,y){var b=s.pendingLanes;s.pendingLanes=o,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=o,s.entangledLanes&=o,s.errorRecoveryDisabledLanes&=o,s.shellSuspendCounter=0;var E=s.entanglements,P=s.expirationTimes,W=s.hiddenUpdates;for(o=b&~o;0<o;){var ne=31-bt(o),re=1<<ne;E[ne]=0,P[ne]=-1;var J=W[ne];if(J!==null)for(W[ne]=null,ne=0;ne<J.length;ne++){var ee=J[ne];ee!==null&&(ee.lane&=-536870913)}o&=~re}u!==0&&Fr(s,u,0),y!==0&&p===0&&s.tag!==0&&(s.suspendedLanes|=y&~(b&~r))}function Fr(s,r,o){s.pendingLanes|=r,s.suspendedLanes&=~r;var u=31-bt(r);s.entangledLanes|=r,s.entanglements[u]=s.entanglements[u]|1073741824|o&261930}function Tl(s,r){var o=s.entangledLanes|=r;for(s=s.entanglements;o;){var u=31-bt(o),p=1<<u;p&r|s[u]&r&&(s[u]|=r),o&=~p}}function El(s,r){var o=r&-r;return o=(o&42)!==0?1:Gr(o),(o&(s.suspendedLanes|r))!==0?0:o}function Gr(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function ni(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Iu(){var s=se.p;return s!==0?s:(s=window.event,s===void 0?32:ob(s.type))}function rs(s,r){var o=se.p;try{return se.p=s,r()}finally{se.p=o}}var as=Math.random().toString(36).slice(2),Ct="__reactFiber$"+as,$t="__reactProps$"+as,Rs="__reactContainer$"+as,Fa="__reactEvents$"+as,If="__reactListeners$"+as,ku="__reactHandles$"+as,Ou="__reactResources$"+as,Is="__reactMarker$"+as;function Ga(s){delete s[Ct],delete s[$t],delete s[Fa],delete s[If],delete s[ku]}function ks(s){var r=s[Ct];if(r)return r;for(var o=s.parentNode;o;){if(r=o[Rs]||o[Ct]){if(o=r.alternate,r.child!==null||o!==null&&o.child!==null)for(s=F_(s);s!==null;){if(o=s[Ct])return o;s=F_(s)}return r}s=o,o=s.parentNode}return null}function zn(s){if(s=s[Ct]||s[Rs]){var r=s.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return s}return null}function Cn(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s.stateNode;throw Error(i(33))}function Os(s){var r=s[Ou];return r||(r=s[Ou]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function Rt(s){s[Is]=!0}var Sl=new Set,Al={};function js(s,r){Ds(s,r),Ds(s+"Capture",r)}function Ds(s,r){for(Al[s]=r,s=0;s<r.length;s++)Sl.add(r[s])}var Nl=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Cl={},Rl={};function ju(s){return At.call(Rl,s)?!0:At.call(Cl,s)?!1:Nl.test(s)?Rl[s]=!0:(Cl[s]=!0,!1)}function Ka(s,r,o){if(ju(r))if(o===null)s.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":s.removeAttribute(r);return;case"boolean":var u=r.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){s.removeAttribute(r);return}}s.setAttribute(r,""+o)}}function Rn(s,r,o){if(o===null)s.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(r);return}s.setAttribute(r,""+o)}}function It(s,r,o,u){if(u===null)s.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttributeNS(r,o,""+u)}}function Ft(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Mi(s){var r=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function Il(s,r,o){var u=Object.getOwnPropertyDescriptor(s.constructor.prototype,r);if(!s.hasOwnProperty(r)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var p=u.get,y=u.set;return Object.defineProperty(s,r,{configurable:!0,get:function(){return p.call(this)},set:function(b){o=""+b,y.call(this,b)}}),Object.defineProperty(s,r,{enumerable:u.enumerable}),{getValue:function(){return o},setValue:function(b){o=""+b},stopTracking:function(){s._valueTracker=null,delete s[r]}}}}function Ze(s){if(!s._valueTracker){var r=Mi(s)?"checked":"value";s._valueTracker=Il(s,r,""+s[r])}}function Kr(s){if(!s)return!1;var r=s._valueTracker;if(!r)return!0;var o=r.getValue(),u="";return s&&(u=Mi(s)?s.checked?"true":"false":s.value),s=u,s!==o?(r.setValue(s),!0):!1}function Ps(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Yr=/[\n"\\]/g;function mn(s){return s.replace(Yr,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function Ya(s,r,o,u,p,y,b,E){s.name="",b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?s.type=b:s.removeAttribute("type"),r!=null?b==="number"?(r===0&&s.value===""||s.value!=r)&&(s.value=""+Ft(r)):s.value!==""+Ft(r)&&(s.value=""+Ft(r)):b!=="submit"&&b!=="reset"||s.removeAttribute("value"),r!=null?kl(s,b,Ft(r)):o!=null?kl(s,b,Ft(o)):u!=null&&s.removeAttribute("value"),p==null&&y!=null&&(s.defaultChecked=!!y),p!=null&&(s.checked=p&&typeof p!="function"&&typeof p!="symbol"),E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?s.name=""+Ft(E):s.removeAttribute("name")}function Du(s,r,o,u,p,y,b,E){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(s.type=y),r!=null||o!=null){if(!(y!=="submit"&&y!=="reset"||r!=null)){Ze(s);return}o=o!=null?""+Ft(o):"",r=r!=null?""+Ft(r):o,E||r===s.value||(s.value=r),s.defaultValue=r}u=u??p,u=typeof u!="function"&&typeof u!="symbol"&&!!u,s.checked=E?s.checked:!!u,s.defaultChecked=!!u,b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(s.name=b),Ze(s)}function kl(s,r,o){r==="number"&&Ps(s.ownerDocument)===s||s.defaultValue===""+o||(s.defaultValue=""+o)}function Li(s,r,o,u){if(s=s.options,r){r={};for(var p=0;p<o.length;p++)r["$"+o[p]]=!0;for(o=0;o<s.length;o++)p=r.hasOwnProperty("$"+s[o].value),s[o].selected!==p&&(s[o].selected=p),p&&u&&(s[o].defaultSelected=!0)}else{for(o=""+Ft(o),r=null,p=0;p<s.length;p++){if(s[p].value===o){s[p].selected=!0,u&&(s[p].defaultSelected=!0);return}r!==null||s[p].disabled||(r=s[p])}r!==null&&(r.selected=!0)}}function Pu(s,r,o){if(r!=null&&(r=""+Ft(r),r!==s.value&&(s.value=r),o==null)){s.defaultValue!==r&&(s.defaultValue=r);return}s.defaultValue=o!=null?""+Ft(o):""}function Ui(s,r,o,u){if(r==null){if(u!=null){if(o!=null)throw Error(i(92));if(ue(u)){if(1<u.length)throw Error(i(93));u=u[0]}o=u}o==null&&(o=""),r=o}o=Ft(r),s.defaultValue=o,u=s.textContent,u===o&&u!==""&&u!==null&&(s.value=u),Ze(s)}function yn(s,r){if(r){var o=s.firstChild;if(o&&o===s.lastChild&&o.nodeType===3){o.nodeValue=r;return}}s.textContent=r}var Mu=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ol(s,r,o){var u=r.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?u?s.setProperty(r,""):r==="float"?s.cssFloat="":s[r]="":u?s.setProperty(r,o):typeof o!="number"||o===0||Mu.has(r)?r==="float"?s.cssFloat=o:s[r]=(""+o).trim():s[r]=o+"px"}function jl(s,r,o){if(r!=null&&typeof r!="object")throw Error(i(62));if(s=s.style,o!=null){for(var u in o)!o.hasOwnProperty(u)||r!=null&&r.hasOwnProperty(u)||(u.indexOf("--")===0?s.setProperty(u,""):u==="float"?s.cssFloat="":s[u]="");for(var p in r)u=r[p],r.hasOwnProperty(p)&&o[p]!==u&&Ol(s,p,u)}else for(var y in r)r.hasOwnProperty(y)&&Ol(s,y,r[y])}function Wa(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Lu=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Vi=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Qa(s){return Vi.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function os(){}var Dl=null;function Hn(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Bi=null,Ms=null;function Wr(s){var r=zn(s);if(r&&(s=r.stateNode)){var o=s[$t]||null;e:switch(s=r.stateNode,r.type){case"input":if(Ya(s,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),r=o.name,o.type==="radio"&&r!=null){for(o=s;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+mn(""+r)+'"][type="radio"]'),r=0;r<o.length;r++){var u=o[r];if(u!==s&&u.form===s.form){var p=u[$t]||null;if(!p)throw Error(i(90));Ya(u,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(r=0;r<o.length;r++)u=o[r],u.form===s.form&&Kr(u)}break e;case"textarea":Pu(s,o.value,o.defaultValue);break e;case"select":r=o.value,r!=null&&Li(s,!!o.multiple,r,!1)}}}var Ja=!1;function zi(s,r,o){if(Ja)return s(r,o);Ja=!0;try{var u=s(r);return u}finally{if(Ja=!1,(Bi!==null||Ms!==null)&&(Ih(),Bi&&(r=Bi,s=Ms,Ms=Bi=null,Wr(r),s)))for(r=0;r<s.length;r++)Wr(s[r])}}function ls(s,r){var o=s.stateNode;if(o===null)return null;var u=o[$t]||null;if(u===null)return null;o=u[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(s=s.type,u=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!u;break e;default:s=!1}if(s)return null;if(o&&typeof o!="function")throw Error(i(231,r,typeof o));return o}var qn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Qr=!1;if(qn)try{var nt={};Object.defineProperty(nt,"passive",{get:function(){Qr=!0}}),window.addEventListener("test",nt,nt),window.removeEventListener("test",nt,nt)}catch{Qr=!1}var Ls=null,Pl=null,Jr=null;function Ml(){if(Jr)return Jr;var s,r=Pl,o=r.length,u,p="value"in Ls?Ls.value:Ls.textContent,y=p.length;for(s=0;s<o&&r[s]===p[s];s++);var b=o-s;for(u=1;u<=b&&r[o-u]===p[y-u];u++);return Jr=p.slice(s,1<u?1-u:void 0)}function Xr(s){var r=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&r===13&&(s=13)):s=r,s===10&&(s=13),32<=s||s===13?s:0}function si(){return!0}function cs(){return!1}function Wt(s){function r(o,u,p,y,b){this._reactName=o,this._targetInst=p,this.type=u,this.nativeEvent=y,this.target=b,this.currentTarget=null;for(var E in s)s.hasOwnProperty(E)&&(o=s[E],this[E]=o?o(y):y[E]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?si:cs,this.isPropagationStopped=cs,this}return w(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=si)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=si)},persist:function(){},isPersistent:si}),r}var ii={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Us=Wt(ii),Hi=w({},ii,{view:0,detail:0}),Ll=Wt(Hi),qi,Xa,Vs,Za=w({},Hi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:$i,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Vs&&(Vs&&s.type==="mousemove"?(qi=s.screenX-Vs.screenX,Xa=s.screenY-Vs.screenY):Xa=qi=0,Vs=s),qi)},movementY:function(s){return"movementY"in s?s.movementY:Xa}}),Ul=Wt(Za),Zr=w({},Za,{dataTransfer:0}),Uu=Wt(Zr),Vu=w({},Hi,{relatedTarget:0}),ea=Wt(Vu),Vl=w({},ii,{animationName:0,elapsedTime:0,pseudoElement:0}),Bu=Wt(Vl),eo=w({},ii,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),zu=Wt(eo),Hu=w({},ii,{data:0}),Bs=Wt(Hu),qu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$u={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Fu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Gu(s){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(s):(s=Fu[s])?!!r[s]:!1}function $i(){return Gu}var fn=w({},Hi,{key:function(s){if(s.key){var r=qu[s.key]||s.key;if(r!=="Unidentified")return r}return s.type==="keypress"?(s=Xr(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?$u[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:$i,charCode:function(s){return s.type==="keypress"?Xr(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Xr(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Ku=Wt(fn),Yu=w({},Za,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ri=Wt(Yu),h=w({},Hi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:$i}),v=Wt(h),T=w({},ii,{propertyName:0,elapsedTime:0,pseudoElement:0}),C=Wt(T),K=w({},Za,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Z=Wt(K),fe=w({},ii,{newState:0,oldState:0}),De=Wt(fe),wt=[9,13,27,32],Qe=qn&&"CompositionEvent"in window,dt=null;qn&&"documentMode"in document&&(dt=document.documentMode);var $n=qn&&"TextEvent"in window&&!dt,zs=qn&&(!Qe||dt&&8<dt&&11>=dt),us=" ",hs=!1;function ta(s,r){switch(s){case"keyup":return wt.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function to(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var no=!1;function GS(s,r){switch(s){case"compositionend":return to(r);case"keypress":return r.which!==32?null:(hs=!0,us);case"textInput":return s=r.data,s===us&&hs?null:s;default:return null}}function KS(s,r){if(no)return s==="compositionend"||!Qe&&ta(s,r)?(s=Ml(),Jr=Pl=Ls=null,no=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return zs&&r.locale!=="ko"?null:r.data;default:return null}}var YS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Y0(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r==="input"?!!YS[s.type]:r==="textarea"}function W0(s,r,o,u){Bi?Ms?Ms.push(u):Ms=[u]:Bi=u,r=Lh(r,"onChange"),0<r.length&&(o=new Us("onChange","change",null,o,u),s.push({event:o,listeners:r}))}var Bl=null,zl=null;function WS(s){k_(s,0)}function Wu(s){var r=Cn(s);if(Kr(r))return s}function Q0(s,r){if(s==="change")return r}var J0=!1;if(qn){var kf;if(qn){var Of="oninput"in document;if(!Of){var X0=document.createElement("div");X0.setAttribute("oninput","return;"),Of=typeof X0.oninput=="function"}kf=Of}else kf=!1;J0=kf&&(!document.documentMode||9<document.documentMode)}function Z0(){Bl&&(Bl.detachEvent("onpropertychange",ey),zl=Bl=null)}function ey(s){if(s.propertyName==="value"&&Wu(zl)){var r=[];W0(r,zl,s,Hn(s)),zi(WS,r)}}function QS(s,r,o){s==="focusin"?(Z0(),Bl=r,zl=o,Bl.attachEvent("onpropertychange",ey)):s==="focusout"&&Z0()}function JS(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Wu(zl)}function XS(s,r){if(s==="click")return Wu(r)}function ZS(s,r){if(s==="input"||s==="change")return Wu(r)}function eA(s,r){return s===r&&(s!==0||1/s===1/r)||s!==s&&r!==r}var In=typeof Object.is=="function"?Object.is:eA;function Hl(s,r){if(In(s,r))return!0;if(typeof s!="object"||s===null||typeof r!="object"||r===null)return!1;var o=Object.keys(s),u=Object.keys(r);if(o.length!==u.length)return!1;for(u=0;u<o.length;u++){var p=o[u];if(!At.call(r,p)||!In(s[p],r[p]))return!1}return!0}function ty(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function ny(s,r){var o=ty(s);s=0;for(var u;o;){if(o.nodeType===3){if(u=s+o.textContent.length,s<=r&&u>=r)return{node:o,offset:r-s};s=u}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=ty(o)}}function sy(s,r){return s&&r?s===r?!0:s&&s.nodeType===3?!1:r&&r.nodeType===3?sy(s,r.parentNode):"contains"in s?s.contains(r):s.compareDocumentPosition?!!(s.compareDocumentPosition(r)&16):!1:!1}function iy(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var r=Ps(s.document);r instanceof s.HTMLIFrameElement;){try{var o=typeof r.contentWindow.location.href=="string"}catch{o=!1}if(o)s=r.contentWindow;else break;r=Ps(s.document)}return r}function jf(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r&&(r==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||r==="textarea"||s.contentEditable==="true")}var tA=qn&&"documentMode"in document&&11>=document.documentMode,so=null,Df=null,ql=null,Pf=!1;function ry(s,r,o){var u=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Pf||so==null||so!==Ps(u)||(u=so,"selectionStart"in u&&jf(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),ql&&Hl(ql,u)||(ql=u,u=Lh(Df,"onSelect"),0<u.length&&(r=new Us("onSelect","select",null,r,o),s.push({event:r,listeners:u}),r.target=so)))}function na(s,r){var o={};return o[s.toLowerCase()]=r.toLowerCase(),o["Webkit"+s]="webkit"+r,o["Moz"+s]="moz"+r,o}var io={animationend:na("Animation","AnimationEnd"),animationiteration:na("Animation","AnimationIteration"),animationstart:na("Animation","AnimationStart"),transitionrun:na("Transition","TransitionRun"),transitionstart:na("Transition","TransitionStart"),transitioncancel:na("Transition","TransitionCancel"),transitionend:na("Transition","TransitionEnd")},Mf={},ay={};qn&&(ay=document.createElement("div").style,"AnimationEvent"in window||(delete io.animationend.animation,delete io.animationiteration.animation,delete io.animationstart.animation),"TransitionEvent"in window||delete io.transitionend.transition);function sa(s){if(Mf[s])return Mf[s];if(!io[s])return s;var r=io[s],o;for(o in r)if(r.hasOwnProperty(o)&&o in ay)return Mf[s]=r[o];return s}var oy=sa("animationend"),ly=sa("animationiteration"),cy=sa("animationstart"),nA=sa("transitionrun"),sA=sa("transitionstart"),iA=sa("transitioncancel"),uy=sa("transitionend"),hy=new Map,Lf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Lf.push("scrollEnd");function ds(s,r){hy.set(s,r),js(r,[s])}var Qu=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Fn=[],ro=0,Uf=0;function Ju(){for(var s=ro,r=Uf=ro=0;r<s;){var o=Fn[r];Fn[r++]=null;var u=Fn[r];Fn[r++]=null;var p=Fn[r];Fn[r++]=null;var y=Fn[r];if(Fn[r++]=null,u!==null&&p!==null){var b=u.pending;b===null?p.next=p:(p.next=b.next,b.next=p),u.pending=p}y!==0&&dy(o,p,y)}}function Xu(s,r,o,u){Fn[ro++]=s,Fn[ro++]=r,Fn[ro++]=o,Fn[ro++]=u,Uf|=u,s.lanes|=u,s=s.alternate,s!==null&&(s.lanes|=u)}function Vf(s,r,o,u){return Xu(s,r,o,u),Zu(s)}function ia(s,r){return Xu(s,null,null,r),Zu(s)}function dy(s,r,o){s.lanes|=o;var u=s.alternate;u!==null&&(u.lanes|=o);for(var p=!1,y=s.return;y!==null;)y.childLanes|=o,u=y.alternate,u!==null&&(u.childLanes|=o),y.tag===22&&(s=y.stateNode,s===null||s._visibility&1||(p=!0)),s=y,y=y.return;return s.tag===3?(y=s.stateNode,p&&r!==null&&(p=31-bt(o),s=y.hiddenUpdates,u=s[p],u===null?s[p]=[r]:u.push(r),r.lane=o|536870912),y):null}function Zu(s){if(50<hc)throw hc=0,Yp=null,Error(i(185));for(var r=s.return;r!==null;)s=r,r=s.return;return s.tag===3?s.stateNode:null}var ao={};function rA(s,r,o,u){this.tag=s,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kn(s,r,o,u){return new rA(s,r,o,u)}function Bf(s){return s=s.prototype,!(!s||!s.isReactComponent)}function ai(s,r){var o=s.alternate;return o===null?(o=kn(s.tag,r,s.key,s.mode),o.elementType=s.elementType,o.type=s.type,o.stateNode=s.stateNode,o.alternate=s,s.alternate=o):(o.pendingProps=r,o.type=s.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=s.flags&65011712,o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,r=s.dependencies,o.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},o.sibling=s.sibling,o.index=s.index,o.ref=s.ref,o.refCleanup=s.refCleanup,o}function fy(s,r){s.flags&=65011714;var o=s.alternate;return o===null?(s.childLanes=0,s.lanes=r,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,r=o.dependencies,s.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),s}function eh(s,r,o,u,p,y){var b=0;if(u=s,typeof s=="function")Bf(s)&&(b=1);else if(typeof s=="string")b=u2(s,o,pe.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case k:return s=kn(31,o,r,p),s.elementType=k,s.lanes=y,s;case D:return ra(o.children,p,y,r);case I:b=8,p|=24;break;case U:return s=kn(12,o,r,p|2),s.elementType=U,s.lanes=y,s;case $:return s=kn(13,o,r,p),s.elementType=$,s.lanes=y,s;case Q:return s=kn(19,o,r,p),s.elementType=Q,s.lanes=y,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case z:b=10;break e;case q:b=9;break e;case O:b=11;break e;case R:b=14;break e;case N:b=16,u=null;break e}b=29,o=Error(i(130,s===null?"null":typeof s,"")),u=null}return r=kn(b,o,r,p),r.elementType=s,r.type=u,r.lanes=y,r}function ra(s,r,o,u){return s=kn(7,s,u,r),s.lanes=o,s}function zf(s,r,o){return s=kn(6,s,null,r),s.lanes=o,s}function py(s){var r=kn(18,null,null,0);return r.stateNode=s,r}function Hf(s,r,o){return r=kn(4,s.children!==null?s.children:[],s.key,r),r.lanes=o,r.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},r}var gy=new WeakMap;function Gn(s,r){if(typeof s=="object"&&s!==null){var o=gy.get(s);return o!==void 0?o:(r={value:s,source:r,stack:bl(r)},gy.set(s,r),r)}return{value:s,source:r,stack:bl(r)}}var oo=[],lo=0,th=null,$l=0,Kn=[],Yn=0,Fi=null,Hs=1,qs="";function oi(s,r){oo[lo++]=$l,oo[lo++]=th,th=s,$l=r}function my(s,r,o){Kn[Yn++]=Hs,Kn[Yn++]=qs,Kn[Yn++]=Fi,Fi=s;var u=Hs;s=qs;var p=32-bt(u)-1;u&=~(1<<p),o+=1;var y=32-bt(r)+p;if(30<y){var b=p-p%5;y=(u&(1<<b)-1).toString(32),u>>=b,p-=b,Hs=1<<32-bt(r)+p|o<<p|u,qs=y+s}else Hs=1<<y|o<<p|u,qs=s}function qf(s){s.return!==null&&(oi(s,1),my(s,1,0))}function $f(s){for(;s===th;)th=oo[--lo],oo[lo]=null,$l=oo[--lo],oo[lo]=null;for(;s===Fi;)Fi=Kn[--Yn],Kn[Yn]=null,qs=Kn[--Yn],Kn[Yn]=null,Hs=Kn[--Yn],Kn[Yn]=null}function yy(s,r){Kn[Yn++]=Hs,Kn[Yn++]=qs,Kn[Yn++]=Fi,Hs=r.id,qs=r.overflow,Fi=s}var Qt=null,ct=null,Fe=!1,Gi=null,Wn=!1,Ff=Error(i(519));function Ki(s){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Fl(Gn(r,s)),Ff}function vy(s){var r=s.stateNode,o=s.type,u=s.memoizedProps;switch(r[Ct]=s,r[$t]=u,o){case"dialog":Ve("cancel",r),Ve("close",r);break;case"iframe":case"object":case"embed":Ve("load",r);break;case"video":case"audio":for(o=0;o<fc.length;o++)Ve(fc[o],r);break;case"source":Ve("error",r);break;case"img":case"image":case"link":Ve("error",r),Ve("load",r);break;case"details":Ve("toggle",r);break;case"input":Ve("invalid",r),Du(r,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":Ve("invalid",r);break;case"textarea":Ve("invalid",r),Ui(r,u.value,u.defaultValue,u.children)}o=u.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||r.textContent===""+o||u.suppressHydrationWarning===!0||P_(r.textContent,o)?(u.popover!=null&&(Ve("beforetoggle",r),Ve("toggle",r)),u.onScroll!=null&&Ve("scroll",r),u.onScrollEnd!=null&&Ve("scrollend",r),u.onClick!=null&&(r.onclick=os),r=!0):r=!1,r||Ki(s,!0)}function _y(s){for(Qt=s.return;Qt;)switch(Qt.tag){case 5:case 31:case 13:Wn=!1;return;case 27:case 3:Wn=!0;return;default:Qt=Qt.return}}function co(s){if(s!==Qt)return!1;if(!Fe)return _y(s),Fe=!0,!1;var r=s.tag,o;if((o=r!==3&&r!==27)&&((o=r===5)&&(o=s.type,o=!(o!=="form"&&o!=="button")||cg(s.type,s.memoizedProps)),o=!o),o&&ct&&Ki(s),_y(s),r===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));ct=$_(s)}else if(r===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));ct=$_(s)}else r===27?(r=ct,or(s.type)?(s=pg,pg=null,ct=s):ct=r):ct=Qt?Jn(s.stateNode.nextSibling):null;return!0}function aa(){ct=Qt=null,Fe=!1}function Gf(){var s=Gi;return s!==null&&(wn===null?wn=s:wn.push.apply(wn,s),Gi=null),s}function Fl(s){Gi===null?Gi=[s]:Gi.push(s)}var Kf=V(null),oa=null,li=null;function Yi(s,r,o){de(Kf,r._currentValue),r._currentValue=o}function ci(s){s._currentValue=Kf.current,te(Kf)}function Yf(s,r,o){for(;s!==null;){var u=s.alternate;if((s.childLanes&r)!==r?(s.childLanes|=r,u!==null&&(u.childLanes|=r)):u!==null&&(u.childLanes&r)!==r&&(u.childLanes|=r),s===o)break;s=s.return}}function Wf(s,r,o,u){var p=s.child;for(p!==null&&(p.return=s);p!==null;){var y=p.dependencies;if(y!==null){var b=p.child;y=y.firstContext;e:for(;y!==null;){var E=y;y=p;for(var P=0;P<r.length;P++)if(E.context===r[P]){y.lanes|=o,E=y.alternate,E!==null&&(E.lanes|=o),Yf(y.return,o,s),u||(b=null);break e}y=E.next}}else if(p.tag===18){if(b=p.return,b===null)throw Error(i(341));b.lanes|=o,y=b.alternate,y!==null&&(y.lanes|=o),Yf(b,o,s),b=null}else b=p.child;if(b!==null)b.return=p;else for(b=p;b!==null;){if(b===s){b=null;break}if(p=b.sibling,p!==null){p.return=b.return,b=p;break}b=b.return}p=b}}function uo(s,r,o,u){s=null;for(var p=r,y=!1;p!==null;){if(!y){if((p.flags&524288)!==0)y=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var b=p.alternate;if(b===null)throw Error(i(387));if(b=b.memoizedProps,b!==null){var E=p.type;In(p.pendingProps.value,b.value)||(s!==null?s.push(E):s=[E])}}else if(p===he.current){if(b=p.alternate,b===null)throw Error(i(387));b.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(s!==null?s.push(vc):s=[vc])}p=p.return}s!==null&&Wf(r,s,o,u),r.flags|=262144}function nh(s){for(s=s.firstContext;s!==null;){if(!In(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function la(s){oa=s,li=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Jt(s){return by(oa,s)}function sh(s,r){return oa===null&&la(s),by(s,r)}function by(s,r){var o=r._currentValue;if(r={context:r,memoizedValue:o,next:null},li===null){if(s===null)throw Error(i(308));li=r,s.dependencies={lanes:0,firstContext:r},s.flags|=524288}else li=li.next=r;return o}var aA=typeof AbortController<"u"?AbortController:function(){var s=[],r=this.signal={aborted:!1,addEventListener:function(o,u){s.push(u)}};this.abort=function(){r.aborted=!0,s.forEach(function(o){return o()})}},oA=n.unstable_scheduleCallback,lA=n.unstable_NormalPriority,kt={$$typeof:z,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Qf(){return{controller:new aA,data:new Map,refCount:0}}function Gl(s){s.refCount--,s.refCount===0&&oA(lA,function(){s.controller.abort()})}var Kl=null,Jf=0,ho=0,fo=null;function cA(s,r){if(Kl===null){var o=Kl=[];Jf=0,ho=eg(),fo={status:"pending",value:void 0,then:function(u){o.push(u)}}}return Jf++,r.then(wy,wy),r}function wy(){if(--Jf===0&&Kl!==null){fo!==null&&(fo.status="fulfilled");var s=Kl;Kl=null,ho=0,fo=null;for(var r=0;r<s.length;r++)(0,s[r])()}}function uA(s,r){var o=[],u={status:"pending",value:null,reason:null,then:function(p){o.push(p)}};return s.then(function(){u.status="fulfilled",u.value=r;for(var p=0;p<o.length;p++)(0,o[p])(r)},function(p){for(u.status="rejected",u.reason=p,p=0;p<o.length;p++)(0,o[p])(void 0)}),u}var xy=B.S;B.S=function(s,r){r_=dn(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&cA(s,r),xy!==null&&xy(s,r)};var ca=V(null);function Xf(){var s=ca.current;return s!==null?s:at.pooledCache}function ih(s,r){r===null?de(ca,ca.current):de(ca,r.pool)}function Ty(){var s=Xf();return s===null?null:{parent:kt._currentValue,pool:s}}var po=Error(i(460)),Zf=Error(i(474)),rh=Error(i(542)),ah={then:function(){}};function Ey(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Sy(s,r,o){switch(o=s[o],o===void 0?s.push(r):o!==r&&(r.then(os,os),r=o),r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,Ny(s),s;default:if(typeof r.status=="string")r.then(os,os);else{if(s=at,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=r,s.status="pending",s.then(function(u){if(r.status==="pending"){var p=r;p.status="fulfilled",p.value=u}},function(u){if(r.status==="pending"){var p=r;p.status="rejected",p.reason=u}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,Ny(s),s}throw ha=r,po}}function ua(s){try{var r=s._init;return r(s._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(ha=o,po):o}}var ha=null;function Ay(){if(ha===null)throw Error(i(459));var s=ha;return ha=null,s}function Ny(s){if(s===po||s===rh)throw Error(i(483))}var go=null,Yl=0;function oh(s){var r=Yl;return Yl+=1,go===null&&(go=[]),Sy(go,s,r)}function Wl(s,r){r=r.props.ref,s.ref=r!==void 0?r:null}function lh(s,r){throw r.$$typeof===x?Error(i(525)):(s=Object.prototype.toString.call(r),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":s)))}function Cy(s){function r(G,H){if(s){var Y=G.deletions;Y===null?(G.deletions=[H],G.flags|=16):Y.push(H)}}function o(G,H){if(!s)return null;for(;H!==null;)r(G,H),H=H.sibling;return null}function u(G){for(var H=new Map;G!==null;)G.key!==null?H.set(G.key,G):H.set(G.index,G),G=G.sibling;return H}function p(G,H){return G=ai(G,H),G.index=0,G.sibling=null,G}function y(G,H,Y){return G.index=Y,s?(Y=G.alternate,Y!==null?(Y=Y.index,Y<H?(G.flags|=67108866,H):Y):(G.flags|=67108866,H)):(G.flags|=1048576,H)}function b(G){return s&&G.alternate===null&&(G.flags|=67108866),G}function E(G,H,Y,ie){return H===null||H.tag!==6?(H=zf(Y,G.mode,ie),H.return=G,H):(H=p(H,Y),H.return=G,H)}function P(G,H,Y,ie){var Te=Y.type;return Te===D?ne(G,H,Y.props.children,ie,Y.key):H!==null&&(H.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===N&&ua(Te)===H.type)?(H=p(H,Y.props),Wl(H,Y),H.return=G,H):(H=eh(Y.type,Y.key,Y.props,null,G.mode,ie),Wl(H,Y),H.return=G,H)}function W(G,H,Y,ie){return H===null||H.tag!==4||H.stateNode.containerInfo!==Y.containerInfo||H.stateNode.implementation!==Y.implementation?(H=Hf(Y,G.mode,ie),H.return=G,H):(H=p(H,Y.children||[]),H.return=G,H)}function ne(G,H,Y,ie,Te){return H===null||H.tag!==7?(H=ra(Y,G.mode,ie,Te),H.return=G,H):(H=p(H,Y),H.return=G,H)}function re(G,H,Y){if(typeof H=="string"&&H!==""||typeof H=="number"||typeof H=="bigint")return H=zf(""+H,G.mode,Y),H.return=G,H;if(typeof H=="object"&&H!==null){switch(H.$$typeof){case S:return Y=eh(H.type,H.key,H.props,null,G.mode,Y),Wl(Y,H),Y.return=G,Y;case A:return H=Hf(H,G.mode,Y),H.return=G,H;case N:return H=ua(H),re(G,H,Y)}if(ue(H)||F(H))return H=ra(H,G.mode,Y,null),H.return=G,H;if(typeof H.then=="function")return re(G,oh(H),Y);if(H.$$typeof===z)return re(G,sh(G,H),Y);lh(G,H)}return null}function J(G,H,Y,ie){var Te=H!==null?H.key:null;if(typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint")return Te!==null?null:E(G,H,""+Y,ie);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case S:return Y.key===Te?P(G,H,Y,ie):null;case A:return Y.key===Te?W(G,H,Y,ie):null;case N:return Y=ua(Y),J(G,H,Y,ie)}if(ue(Y)||F(Y))return Te!==null?null:ne(G,H,Y,ie,null);if(typeof Y.then=="function")return J(G,H,oh(Y),ie);if(Y.$$typeof===z)return J(G,H,sh(G,Y),ie);lh(G,Y)}return null}function ee(G,H,Y,ie,Te){if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return G=G.get(Y)||null,E(H,G,""+ie,Te);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case S:return G=G.get(ie.key===null?Y:ie.key)||null,P(H,G,ie,Te);case A:return G=G.get(ie.key===null?Y:ie.key)||null,W(H,G,ie,Te);case N:return ie=ua(ie),ee(G,H,Y,ie,Te)}if(ue(ie)||F(ie))return G=G.get(Y)||null,ne(H,G,ie,Te,null);if(typeof ie.then=="function")return ee(G,H,Y,oh(ie),Te);if(ie.$$typeof===z)return ee(G,H,Y,sh(H,ie),Te);lh(H,ie)}return null}function _e(G,H,Y,ie){for(var Te=null,Ye=null,we=H,Me=H=0,ze=null;we!==null&&Me<Y.length;Me++){we.index>Me?(ze=we,we=null):ze=we.sibling;var We=J(G,we,Y[Me],ie);if(We===null){we===null&&(we=ze);break}s&&we&&We.alternate===null&&r(G,we),H=y(We,H,Me),Ye===null?Te=We:Ye.sibling=We,Ye=We,we=ze}if(Me===Y.length)return o(G,we),Fe&&oi(G,Me),Te;if(we===null){for(;Me<Y.length;Me++)we=re(G,Y[Me],ie),we!==null&&(H=y(we,H,Me),Ye===null?Te=we:Ye.sibling=we,Ye=we);return Fe&&oi(G,Me),Te}for(we=u(we);Me<Y.length;Me++)ze=ee(we,G,Me,Y[Me],ie),ze!==null&&(s&&ze.alternate!==null&&we.delete(ze.key===null?Me:ze.key),H=y(ze,H,Me),Ye===null?Te=ze:Ye.sibling=ze,Ye=ze);return s&&we.forEach(function(dr){return r(G,dr)}),Fe&&oi(G,Me),Te}function Ae(G,H,Y,ie){if(Y==null)throw Error(i(151));for(var Te=null,Ye=null,we=H,Me=H=0,ze=null,We=Y.next();we!==null&&!We.done;Me++,We=Y.next()){we.index>Me?(ze=we,we=null):ze=we.sibling;var dr=J(G,we,We.value,ie);if(dr===null){we===null&&(we=ze);break}s&&we&&dr.alternate===null&&r(G,we),H=y(dr,H,Me),Ye===null?Te=dr:Ye.sibling=dr,Ye=dr,we=ze}if(We.done)return o(G,we),Fe&&oi(G,Me),Te;if(we===null){for(;!We.done;Me++,We=Y.next())We=re(G,We.value,ie),We!==null&&(H=y(We,H,Me),Ye===null?Te=We:Ye.sibling=We,Ye=We);return Fe&&oi(G,Me),Te}for(we=u(we);!We.done;Me++,We=Y.next())We=ee(we,G,Me,We.value,ie),We!==null&&(s&&We.alternate!==null&&we.delete(We.key===null?Me:We.key),H=y(We,H,Me),Ye===null?Te=We:Ye.sibling=We,Ye=We);return s&&we.forEach(function(w2){return r(G,w2)}),Fe&&oi(G,Me),Te}function rt(G,H,Y,ie){if(typeof Y=="object"&&Y!==null&&Y.type===D&&Y.key===null&&(Y=Y.props.children),typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case S:e:{for(var Te=Y.key;H!==null;){if(H.key===Te){if(Te=Y.type,Te===D){if(H.tag===7){o(G,H.sibling),ie=p(H,Y.props.children),ie.return=G,G=ie;break e}}else if(H.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===N&&ua(Te)===H.type){o(G,H.sibling),ie=p(H,Y.props),Wl(ie,Y),ie.return=G,G=ie;break e}o(G,H);break}else r(G,H);H=H.sibling}Y.type===D?(ie=ra(Y.props.children,G.mode,ie,Y.key),ie.return=G,G=ie):(ie=eh(Y.type,Y.key,Y.props,null,G.mode,ie),Wl(ie,Y),ie.return=G,G=ie)}return b(G);case A:e:{for(Te=Y.key;H!==null;){if(H.key===Te)if(H.tag===4&&H.stateNode.containerInfo===Y.containerInfo&&H.stateNode.implementation===Y.implementation){o(G,H.sibling),ie=p(H,Y.children||[]),ie.return=G,G=ie;break e}else{o(G,H);break}else r(G,H);H=H.sibling}ie=Hf(Y,G.mode,ie),ie.return=G,G=ie}return b(G);case N:return Y=ua(Y),rt(G,H,Y,ie)}if(ue(Y))return _e(G,H,Y,ie);if(F(Y)){if(Te=F(Y),typeof Te!="function")throw Error(i(150));return Y=Te.call(Y),Ae(G,H,Y,ie)}if(typeof Y.then=="function")return rt(G,H,oh(Y),ie);if(Y.$$typeof===z)return rt(G,H,sh(G,Y),ie);lh(G,Y)}return typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint"?(Y=""+Y,H!==null&&H.tag===6?(o(G,H.sibling),ie=p(H,Y),ie.return=G,G=ie):(o(G,H),ie=zf(Y,G.mode,ie),ie.return=G,G=ie),b(G)):o(G,H)}return function(G,H,Y,ie){try{Yl=0;var Te=rt(G,H,Y,ie);return go=null,Te}catch(we){if(we===po||we===rh)throw we;var Ye=kn(29,we,null,G.mode);return Ye.lanes=ie,Ye.return=G,Ye}finally{}}}var da=Cy(!0),Ry=Cy(!1),Wi=!1;function ep(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function tp(s,r){s=s.updateQueue,r.updateQueue===s&&(r.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Qi(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Ji(s,r,o){var u=s.updateQueue;if(u===null)return null;if(u=u.shared,(Je&2)!==0){var p=u.pending;return p===null?r.next=r:(r.next=p.next,p.next=r),u.pending=r,r=Zu(s),dy(s,null,o),r}return Xu(s,u,r,o),Zu(s)}function Ql(s,r,o){if(r=r.updateQueue,r!==null&&(r=r.shared,(o&4194048)!==0)){var u=r.lanes;u&=s.pendingLanes,o|=u,r.lanes=o,Tl(s,o)}}function np(s,r){var o=s.updateQueue,u=s.alternate;if(u!==null&&(u=u.updateQueue,o===u)){var p=null,y=null;if(o=o.firstBaseUpdate,o!==null){do{var b={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};y===null?p=y=b:y=y.next=b,o=o.next}while(o!==null);y===null?p=y=r:y=y.next=r}else p=y=r;o={baseState:u.baseState,firstBaseUpdate:p,lastBaseUpdate:y,shared:u.shared,callbacks:u.callbacks},s.updateQueue=o;return}s=o.lastBaseUpdate,s===null?o.firstBaseUpdate=r:s.next=r,o.lastBaseUpdate=r}var sp=!1;function Jl(){if(sp){var s=fo;if(s!==null)throw s}}function Xl(s,r,o,u){sp=!1;var p=s.updateQueue;Wi=!1;var y=p.firstBaseUpdate,b=p.lastBaseUpdate,E=p.shared.pending;if(E!==null){p.shared.pending=null;var P=E,W=P.next;P.next=null,b===null?y=W:b.next=W,b=P;var ne=s.alternate;ne!==null&&(ne=ne.updateQueue,E=ne.lastBaseUpdate,E!==b&&(E===null?ne.firstBaseUpdate=W:E.next=W,ne.lastBaseUpdate=P))}if(y!==null){var re=p.baseState;b=0,ne=W=P=null,E=y;do{var J=E.lane&-536870913,ee=J!==E.lane;if(ee?(Be&J)===J:(u&J)===J){J!==0&&J===ho&&(sp=!0),ne!==null&&(ne=ne.next={lane:0,tag:E.tag,payload:E.payload,callback:null,next:null});e:{var _e=s,Ae=E;J=r;var rt=o;switch(Ae.tag){case 1:if(_e=Ae.payload,typeof _e=="function"){re=_e.call(rt,re,J);break e}re=_e;break e;case 3:_e.flags=_e.flags&-65537|128;case 0:if(_e=Ae.payload,J=typeof _e=="function"?_e.call(rt,re,J):_e,J==null)break e;re=w({},re,J);break e;case 2:Wi=!0}}J=E.callback,J!==null&&(s.flags|=64,ee&&(s.flags|=8192),ee=p.callbacks,ee===null?p.callbacks=[J]:ee.push(J))}else ee={lane:J,tag:E.tag,payload:E.payload,callback:E.callback,next:null},ne===null?(W=ne=ee,P=re):ne=ne.next=ee,b|=J;if(E=E.next,E===null){if(E=p.shared.pending,E===null)break;ee=E,E=ee.next,ee.next=null,p.lastBaseUpdate=ee,p.shared.pending=null}}while(!0);ne===null&&(P=re),p.baseState=P,p.firstBaseUpdate=W,p.lastBaseUpdate=ne,y===null&&(p.shared.lanes=0),nr|=b,s.lanes=b,s.memoizedState=re}}function Iy(s,r){if(typeof s!="function")throw Error(i(191,s));s.call(r)}function ky(s,r){var o=s.callbacks;if(o!==null)for(s.callbacks=null,s=0;s<o.length;s++)Iy(o[s],r)}var mo=V(null),ch=V(0);function Oy(s,r){s=vi,de(ch,s),de(mo,r),vi=s|r.baseLanes}function ip(){de(ch,vi),de(mo,mo.current)}function rp(){vi=ch.current,te(mo),te(ch)}var On=V(null),Qn=null;function Xi(s){var r=s.alternate;de(xt,xt.current&1),de(On,s),Qn===null&&(r===null||mo.current!==null||r.memoizedState!==null)&&(Qn=s)}function ap(s){de(xt,xt.current),de(On,s),Qn===null&&(Qn=s)}function jy(s){s.tag===22?(de(xt,xt.current),de(On,s),Qn===null&&(Qn=s)):Zi()}function Zi(){de(xt,xt.current),de(On,On.current)}function jn(s){te(On),Qn===s&&(Qn=null),te(xt)}var xt=V(0);function uh(s){for(var r=s;r!==null;){if(r.tag===13){var o=r.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||dg(o)||fg(o)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var ui=0,Pe=null,st=null,Ot=null,hh=!1,yo=!1,fa=!1,dh=0,Zl=0,vo=null,hA=0;function yt(){throw Error(i(321))}function op(s,r){if(r===null)return!1;for(var o=0;o<r.length&&o<s.length;o++)if(!In(s[o],r[o]))return!1;return!0}function lp(s,r,o,u,p,y){return ui=y,Pe=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,B.H=s===null||s.memoizedState===null?mv:Tp,fa=!1,y=o(u,p),fa=!1,yo&&(y=Py(r,o,u,p)),Dy(s),y}function Dy(s){B.H=nc;var r=st!==null&&st.next!==null;if(ui=0,Ot=st=Pe=null,hh=!1,Zl=0,vo=null,r)throw Error(i(300));s===null||jt||(s=s.dependencies,s!==null&&nh(s)&&(jt=!0))}function Py(s,r,o,u){Pe=s;var p=0;do{if(yo&&(vo=null),Zl=0,yo=!1,25<=p)throw Error(i(301));if(p+=1,Ot=st=null,s.updateQueue!=null){var y=s.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}B.H=yv,y=r(o,u)}while(yo);return y}function dA(){var s=B.H,r=s.useState()[0];return r=typeof r.then=="function"?ec(r):r,s=s.useState()[0],(st!==null?st.memoizedState:null)!==s&&(Pe.flags|=1024),r}function cp(){var s=dh!==0;return dh=0,s}function up(s,r,o){r.updateQueue=s.updateQueue,r.flags&=-2053,s.lanes&=~o}function hp(s){if(hh){for(s=s.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}hh=!1}ui=0,Ot=st=Pe=null,yo=!1,Zl=dh=0,vo=null}function pn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ot===null?Pe.memoizedState=Ot=s:Ot=Ot.next=s,Ot}function Tt(){if(st===null){var s=Pe.alternate;s=s!==null?s.memoizedState:null}else s=st.next;var r=Ot===null?Pe.memoizedState:Ot.next;if(r!==null)Ot=r,st=s;else{if(s===null)throw Pe.alternate===null?Error(i(467)):Error(i(310));st=s,s={memoizedState:st.memoizedState,baseState:st.baseState,baseQueue:st.baseQueue,queue:st.queue,next:null},Ot===null?Pe.memoizedState=Ot=s:Ot=Ot.next=s}return Ot}function fh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ec(s){var r=Zl;return Zl+=1,vo===null&&(vo=[]),s=Sy(vo,s,r),r=Pe,(Ot===null?r.memoizedState:Ot.next)===null&&(r=r.alternate,B.H=r===null||r.memoizedState===null?mv:Tp),s}function ph(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return ec(s);if(s.$$typeof===z)return Jt(s)}throw Error(i(438,String(s)))}function dp(s){var r=null,o=Pe.updateQueue;if(o!==null&&(r=o.memoCache),r==null){var u=Pe.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(r={data:u.data.map(function(p){return p.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),o===null&&(o=fh(),Pe.updateQueue=o),o.memoCache=r,o=r.data[r.index],o===void 0)for(o=r.data[r.index]=Array(s),u=0;u<s;u++)o[u]=M;return r.index++,o}function hi(s,r){return typeof r=="function"?r(s):r}function gh(s){var r=Tt();return fp(r,st,s)}function fp(s,r,o){var u=s.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=o;var p=s.baseQueue,y=u.pending;if(y!==null){if(p!==null){var b=p.next;p.next=y.next,y.next=b}r.baseQueue=p=y,u.pending=null}if(y=s.baseState,p===null)s.memoizedState=y;else{r=p.next;var E=b=null,P=null,W=r,ne=!1;do{var re=W.lane&-536870913;if(re!==W.lane?(Be&re)===re:(ui&re)===re){var J=W.revertLane;if(J===0)P!==null&&(P=P.next={lane:0,revertLane:0,gesture:null,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null}),re===ho&&(ne=!0);else if((ui&J)===J){W=W.next,J===ho&&(ne=!0);continue}else re={lane:0,revertLane:W.revertLane,gesture:null,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null},P===null?(E=P=re,b=y):P=P.next=re,Pe.lanes|=J,nr|=J;re=W.action,fa&&o(y,re),y=W.hasEagerState?W.eagerState:o(y,re)}else J={lane:re,revertLane:W.revertLane,gesture:W.gesture,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null},P===null?(E=P=J,b=y):P=P.next=J,Pe.lanes|=re,nr|=re;W=W.next}while(W!==null&&W!==r);if(P===null?b=y:P.next=E,!In(y,s.memoizedState)&&(jt=!0,ne&&(o=fo,o!==null)))throw o;s.memoizedState=y,s.baseState=b,s.baseQueue=P,u.lastRenderedState=y}return p===null&&(u.lanes=0),[s.memoizedState,u.dispatch]}function pp(s){var r=Tt(),o=r.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=s;var u=o.dispatch,p=o.pending,y=r.memoizedState;if(p!==null){o.pending=null;var b=p=p.next;do y=s(y,b.action),b=b.next;while(b!==p);In(y,r.memoizedState)||(jt=!0),r.memoizedState=y,r.baseQueue===null&&(r.baseState=y),o.lastRenderedState=y}return[y,u]}function My(s,r,o){var u=Pe,p=Tt(),y=Fe;if(y){if(o===void 0)throw Error(i(407));o=o()}else o=r();var b=!In((st||p).memoizedState,o);if(b&&(p.memoizedState=o,jt=!0),p=p.queue,yp(Vy.bind(null,u,p,s),[s]),p.getSnapshot!==r||b||Ot!==null&&Ot.memoizedState.tag&1){if(u.flags|=2048,_o(9,{destroy:void 0},Uy.bind(null,u,p,o,r),null),at===null)throw Error(i(349));y||(ui&127)!==0||Ly(u,r,o)}return o}function Ly(s,r,o){s.flags|=16384,s={getSnapshot:r,value:o},r=Pe.updateQueue,r===null?(r=fh(),Pe.updateQueue=r,r.stores=[s]):(o=r.stores,o===null?r.stores=[s]:o.push(s))}function Uy(s,r,o,u){r.value=o,r.getSnapshot=u,By(r)&&zy(s)}function Vy(s,r,o){return o(function(){By(r)&&zy(s)})}function By(s){var r=s.getSnapshot;s=s.value;try{var o=r();return!In(s,o)}catch{return!0}}function zy(s){var r=ia(s,2);r!==null&&xn(r,s,2)}function gp(s){var r=pn();if(typeof s=="function"){var o=s;if(s=o(),fa){Bn(!0);try{o()}finally{Bn(!1)}}}return r.memoizedState=r.baseState=s,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:hi,lastRenderedState:s},r}function Hy(s,r,o,u){return s.baseState=o,fp(s,st,typeof u=="function"?u:hi)}function fA(s,r,o,u,p){if(vh(s))throw Error(i(485));if(s=r.action,s!==null){var y={payload:p,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(b){y.listeners.push(b)}};B.T!==null?o(!0):y.isTransition=!1,u(y),o=r.pending,o===null?(y.next=r.pending=y,qy(r,y)):(y.next=o.next,r.pending=o.next=y)}}function qy(s,r){var o=r.action,u=r.payload,p=s.state;if(r.isTransition){var y=B.T,b={};B.T=b;try{var E=o(p,u),P=B.S;P!==null&&P(b,E),$y(s,r,E)}catch(W){mp(s,r,W)}finally{y!==null&&b.types!==null&&(y.types=b.types),B.T=y}}else try{y=o(p,u),$y(s,r,y)}catch(W){mp(s,r,W)}}function $y(s,r,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(u){Fy(s,r,u)},function(u){return mp(s,r,u)}):Fy(s,r,o)}function Fy(s,r,o){r.status="fulfilled",r.value=o,Gy(r),s.state=o,r=s.pending,r!==null&&(o=r.next,o===r?s.pending=null:(o=o.next,r.next=o,qy(s,o)))}function mp(s,r,o){var u=s.pending;if(s.pending=null,u!==null){u=u.next;do r.status="rejected",r.reason=o,Gy(r),r=r.next;while(r!==u)}s.action=null}function Gy(s){s=s.listeners;for(var r=0;r<s.length;r++)(0,s[r])()}function Ky(s,r){return r}function Yy(s,r){if(Fe){var o=at.formState;if(o!==null){e:{var u=Pe;if(Fe){if(ct){t:{for(var p=ct,y=Wn;p.nodeType!==8;){if(!y){p=null;break t}if(p=Jn(p.nextSibling),p===null){p=null;break t}}y=p.data,p=y==="F!"||y==="F"?p:null}if(p){ct=Jn(p.nextSibling),u=p.data==="F!";break e}}Ki(u)}u=!1}u&&(r=o[0])}}return o=pn(),o.memoizedState=o.baseState=r,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ky,lastRenderedState:r},o.queue=u,o=fv.bind(null,Pe,u),u.dispatch=o,u=gp(!1),y=xp.bind(null,Pe,!1,u.queue),u=pn(),p={state:r,dispatch:null,action:s,pending:null},u.queue=p,o=fA.bind(null,Pe,p,y,o),p.dispatch=o,u.memoizedState=s,[r,o,!1]}function Wy(s){var r=Tt();return Qy(r,st,s)}function Qy(s,r,o){if(r=fp(s,r,Ky)[0],s=gh(hi)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var u=ec(r)}catch(b){throw b===po?rh:b}else u=r;r=Tt();var p=r.queue,y=p.dispatch;return o!==r.memoizedState&&(Pe.flags|=2048,_o(9,{destroy:void 0},pA.bind(null,p,o),null)),[u,y,s]}function pA(s,r){s.action=r}function Jy(s){var r=Tt(),o=st;if(o!==null)return Qy(r,o,s);Tt(),r=r.memoizedState,o=Tt();var u=o.queue.dispatch;return o.memoizedState=s,[r,u,!1]}function _o(s,r,o,u){return s={tag:s,create:o,deps:u,inst:r,next:null},r=Pe.updateQueue,r===null&&(r=fh(),Pe.updateQueue=r),o=r.lastEffect,o===null?r.lastEffect=s.next=s:(u=o.next,o.next=s,s.next=u,r.lastEffect=s),s}function Xy(){return Tt().memoizedState}function mh(s,r,o,u){var p=pn();Pe.flags|=s,p.memoizedState=_o(1|r,{destroy:void 0},o,u===void 0?null:u)}function yh(s,r,o,u){var p=Tt();u=u===void 0?null:u;var y=p.memoizedState.inst;st!==null&&u!==null&&op(u,st.memoizedState.deps)?p.memoizedState=_o(r,y,o,u):(Pe.flags|=s,p.memoizedState=_o(1|r,y,o,u))}function Zy(s,r){mh(8390656,8,s,r)}function yp(s,r){yh(2048,8,s,r)}function gA(s){Pe.flags|=4;var r=Pe.updateQueue;if(r===null)r=fh(),Pe.updateQueue=r,r.events=[s];else{var o=r.events;o===null?r.events=[s]:o.push(s)}}function ev(s){var r=Tt().memoizedState;return gA({ref:r,nextImpl:s}),function(){if((Je&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function tv(s,r){return yh(4,2,s,r)}function nv(s,r){return yh(4,4,s,r)}function sv(s,r){if(typeof r=="function"){s=s();var o=r(s);return function(){typeof o=="function"?o():r(null)}}if(r!=null)return s=s(),r.current=s,function(){r.current=null}}function iv(s,r,o){o=o!=null?o.concat([s]):null,yh(4,4,sv.bind(null,r,s),o)}function vp(){}function rv(s,r){var o=Tt();r=r===void 0?null:r;var u=o.memoizedState;return r!==null&&op(r,u[1])?u[0]:(o.memoizedState=[s,r],s)}function av(s,r){var o=Tt();r=r===void 0?null:r;var u=o.memoizedState;if(r!==null&&op(r,u[1]))return u[0];if(u=s(),fa){Bn(!0);try{s()}finally{Bn(!1)}}return o.memoizedState=[u,r],u}function _p(s,r,o){return o===void 0||(ui&1073741824)!==0&&(Be&261930)===0?s.memoizedState=r:(s.memoizedState=o,s=o_(),Pe.lanes|=s,nr|=s,o)}function ov(s,r,o,u){return In(o,r)?o:mo.current!==null?(s=_p(s,o,u),In(s,r)||(jt=!0),s):(ui&42)===0||(ui&1073741824)!==0&&(Be&261930)===0?(jt=!0,s.memoizedState=o):(s=o_(),Pe.lanes|=s,nr|=s,r)}function lv(s,r,o,u,p){var y=se.p;se.p=y!==0&&8>y?y:8;var b=B.T,E={};B.T=E,xp(s,!1,r,o);try{var P=p(),W=B.S;if(W!==null&&W(E,P),P!==null&&typeof P=="object"&&typeof P.then=="function"){var ne=uA(P,u);tc(s,r,ne,Mn(s))}else tc(s,r,u,Mn(s))}catch(re){tc(s,r,{then:function(){},status:"rejected",reason:re},Mn())}finally{se.p=y,b!==null&&E.types!==null&&(b.types=E.types),B.T=b}}function mA(){}function bp(s,r,o,u){if(s.tag!==5)throw Error(i(476));var p=cv(s).queue;lv(s,p,r,ge,o===null?mA:function(){return uv(s),o(u)})}function cv(s){var r=s.memoizedState;if(r!==null)return r;r={memoizedState:ge,baseState:ge,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hi,lastRenderedState:ge},next:null};var o={};return r.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hi,lastRenderedState:o},next:null},s.memoizedState=r,s=s.alternate,s!==null&&(s.memoizedState=r),r}function uv(s){var r=cv(s);r.next===null&&(r=s.alternate.memoizedState),tc(s,r.next.queue,{},Mn())}function wp(){return Jt(vc)}function hv(){return Tt().memoizedState}function dv(){return Tt().memoizedState}function yA(s){for(var r=s.return;r!==null;){switch(r.tag){case 24:case 3:var o=Mn();s=Qi(o);var u=Ji(r,s,o);u!==null&&(xn(u,r,o),Ql(u,r,o)),r={cache:Qf()},s.payload=r;return}r=r.return}}function vA(s,r,o){var u=Mn();o={lane:u,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},vh(s)?pv(r,o):(o=Vf(s,r,o,u),o!==null&&(xn(o,s,u),gv(o,r,u)))}function fv(s,r,o){var u=Mn();tc(s,r,o,u)}function tc(s,r,o,u){var p={lane:u,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(vh(s))pv(r,p);else{var y=s.alternate;if(s.lanes===0&&(y===null||y.lanes===0)&&(y=r.lastRenderedReducer,y!==null))try{var b=r.lastRenderedState,E=y(b,o);if(p.hasEagerState=!0,p.eagerState=E,In(E,b))return Xu(s,r,p,0),at===null&&Ju(),!1}catch{}finally{}if(o=Vf(s,r,p,u),o!==null)return xn(o,s,u),gv(o,r,u),!0}return!1}function xp(s,r,o,u){if(u={lane:2,revertLane:eg(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},vh(s)){if(r)throw Error(i(479))}else r=Vf(s,o,u,2),r!==null&&xn(r,s,2)}function vh(s){var r=s.alternate;return s===Pe||r!==null&&r===Pe}function pv(s,r){yo=hh=!0;var o=s.pending;o===null?r.next=r:(r.next=o.next,o.next=r),s.pending=r}function gv(s,r,o){if((o&4194048)!==0){var u=r.lanes;u&=s.pendingLanes,o|=u,r.lanes=o,Tl(s,o)}}var nc={readContext:Jt,use:ph,useCallback:yt,useContext:yt,useEffect:yt,useImperativeHandle:yt,useLayoutEffect:yt,useInsertionEffect:yt,useMemo:yt,useReducer:yt,useRef:yt,useState:yt,useDebugValue:yt,useDeferredValue:yt,useTransition:yt,useSyncExternalStore:yt,useId:yt,useHostTransitionStatus:yt,useFormState:yt,useActionState:yt,useOptimistic:yt,useMemoCache:yt,useCacheRefresh:yt};nc.useEffectEvent=yt;var mv={readContext:Jt,use:ph,useCallback:function(s,r){return pn().memoizedState=[s,r===void 0?null:r],s},useContext:Jt,useEffect:Zy,useImperativeHandle:function(s,r,o){o=o!=null?o.concat([s]):null,mh(4194308,4,sv.bind(null,r,s),o)},useLayoutEffect:function(s,r){return mh(4194308,4,s,r)},useInsertionEffect:function(s,r){mh(4,2,s,r)},useMemo:function(s,r){var o=pn();r=r===void 0?null:r;var u=s();if(fa){Bn(!0);try{s()}finally{Bn(!1)}}return o.memoizedState=[u,r],u},useReducer:function(s,r,o){var u=pn();if(o!==void 0){var p=o(r);if(fa){Bn(!0);try{o(r)}finally{Bn(!1)}}}else p=r;return u.memoizedState=u.baseState=p,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:p},u.queue=s,s=s.dispatch=vA.bind(null,Pe,s),[u.memoizedState,s]},useRef:function(s){var r=pn();return s={current:s},r.memoizedState=s},useState:function(s){s=gp(s);var r=s.queue,o=fv.bind(null,Pe,r);return r.dispatch=o,[s.memoizedState,o]},useDebugValue:vp,useDeferredValue:function(s,r){var o=pn();return _p(o,s,r)},useTransition:function(){var s=gp(!1);return s=lv.bind(null,Pe,s.queue,!0,!1),pn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,r,o){var u=Pe,p=pn();if(Fe){if(o===void 0)throw Error(i(407));o=o()}else{if(o=r(),at===null)throw Error(i(349));(Be&127)!==0||Ly(u,r,o)}p.memoizedState=o;var y={value:o,getSnapshot:r};return p.queue=y,Zy(Vy.bind(null,u,y,s),[s]),u.flags|=2048,_o(9,{destroy:void 0},Uy.bind(null,u,y,o,r),null),o},useId:function(){var s=pn(),r=at.identifierPrefix;if(Fe){var o=qs,u=Hs;o=(u&~(1<<32-bt(u)-1)).toString(32)+o,r="_"+r+"R_"+o,o=dh++,0<o&&(r+="H"+o.toString(32)),r+="_"}else o=hA++,r="_"+r+"r_"+o.toString(32)+"_";return s.memoizedState=r},useHostTransitionStatus:wp,useFormState:Yy,useActionState:Yy,useOptimistic:function(s){var r=pn();r.memoizedState=r.baseState=s;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=o,r=xp.bind(null,Pe,!0,o),o.dispatch=r,[s,r]},useMemoCache:dp,useCacheRefresh:function(){return pn().memoizedState=yA.bind(null,Pe)},useEffectEvent:function(s){var r=pn(),o={impl:s};return r.memoizedState=o,function(){if((Je&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},Tp={readContext:Jt,use:ph,useCallback:rv,useContext:Jt,useEffect:yp,useImperativeHandle:iv,useInsertionEffect:tv,useLayoutEffect:nv,useMemo:av,useReducer:gh,useRef:Xy,useState:function(){return gh(hi)},useDebugValue:vp,useDeferredValue:function(s,r){var o=Tt();return ov(o,st.memoizedState,s,r)},useTransition:function(){var s=gh(hi)[0],r=Tt().memoizedState;return[typeof s=="boolean"?s:ec(s),r]},useSyncExternalStore:My,useId:hv,useHostTransitionStatus:wp,useFormState:Wy,useActionState:Wy,useOptimistic:function(s,r){var o=Tt();return Hy(o,st,s,r)},useMemoCache:dp,useCacheRefresh:dv};Tp.useEffectEvent=ev;var yv={readContext:Jt,use:ph,useCallback:rv,useContext:Jt,useEffect:yp,useImperativeHandle:iv,useInsertionEffect:tv,useLayoutEffect:nv,useMemo:av,useReducer:pp,useRef:Xy,useState:function(){return pp(hi)},useDebugValue:vp,useDeferredValue:function(s,r){var o=Tt();return st===null?_p(o,s,r):ov(o,st.memoizedState,s,r)},useTransition:function(){var s=pp(hi)[0],r=Tt().memoizedState;return[typeof s=="boolean"?s:ec(s),r]},useSyncExternalStore:My,useId:hv,useHostTransitionStatus:wp,useFormState:Jy,useActionState:Jy,useOptimistic:function(s,r){var o=Tt();return st!==null?Hy(o,st,s,r):(o.baseState=s,[s,o.queue.dispatch])},useMemoCache:dp,useCacheRefresh:dv};yv.useEffectEvent=ev;function Ep(s,r,o,u){r=s.memoizedState,o=o(u,r),o=o==null?r:w({},r,o),s.memoizedState=o,s.lanes===0&&(s.updateQueue.baseState=o)}var Sp={enqueueSetState:function(s,r,o){s=s._reactInternals;var u=Mn(),p=Qi(u);p.payload=r,o!=null&&(p.callback=o),r=Ji(s,p,u),r!==null&&(xn(r,s,u),Ql(r,s,u))},enqueueReplaceState:function(s,r,o){s=s._reactInternals;var u=Mn(),p=Qi(u);p.tag=1,p.payload=r,o!=null&&(p.callback=o),r=Ji(s,p,u),r!==null&&(xn(r,s,u),Ql(r,s,u))},enqueueForceUpdate:function(s,r){s=s._reactInternals;var o=Mn(),u=Qi(o);u.tag=2,r!=null&&(u.callback=r),r=Ji(s,u,o),r!==null&&(xn(r,s,o),Ql(r,s,o))}};function vv(s,r,o,u,p,y,b){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(u,y,b):r.prototype&&r.prototype.isPureReactComponent?!Hl(o,u)||!Hl(p,y):!0}function _v(s,r,o,u){s=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(o,u),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(o,u),r.state!==s&&Sp.enqueueReplaceState(r,r.state,null)}function pa(s,r){var o=r;if("ref"in r){o={};for(var u in r)u!=="ref"&&(o[u]=r[u])}if(s=s.defaultProps){o===r&&(o=w({},o));for(var p in s)o[p]===void 0&&(o[p]=s[p])}return o}function bv(s){Qu(s)}function wv(s){console.error(s)}function xv(s){Qu(s)}function _h(s,r){try{var o=s.onUncaughtError;o(r.value,{componentStack:r.stack})}catch(u){setTimeout(function(){throw u})}}function Tv(s,r,o){try{var u=s.onCaughtError;u(o.value,{componentStack:o.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function Ap(s,r,o){return o=Qi(o),o.tag=3,o.payload={element:null},o.callback=function(){_h(s,r)},o}function Ev(s){return s=Qi(s),s.tag=3,s}function Sv(s,r,o,u){var p=o.type.getDerivedStateFromError;if(typeof p=="function"){var y=u.value;s.payload=function(){return p(y)},s.callback=function(){Tv(r,o,u)}}var b=o.stateNode;b!==null&&typeof b.componentDidCatch=="function"&&(s.callback=function(){Tv(r,o,u),typeof p!="function"&&(sr===null?sr=new Set([this]):sr.add(this));var E=u.stack;this.componentDidCatch(u.value,{componentStack:E!==null?E:""})})}function _A(s,r,o,u,p){if(o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(r=o.alternate,r!==null&&uo(r,o,p,!0),o=On.current,o!==null){switch(o.tag){case 31:case 13:return Qn===null?kh():o.alternate===null&&vt===0&&(vt=3),o.flags&=-257,o.flags|=65536,o.lanes=p,u===ah?o.flags|=16384:(r=o.updateQueue,r===null?o.updateQueue=new Set([u]):r.add(u),Jp(s,u,p)),!1;case 22:return o.flags|=65536,u===ah?o.flags|=16384:(r=o.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([u])},o.updateQueue=r):(o=r.retryQueue,o===null?r.retryQueue=new Set([u]):o.add(u)),Jp(s,u,p)),!1}throw Error(i(435,o.tag))}return Jp(s,u,p),kh(),!1}if(Fe)return r=On.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=p,u!==Ff&&(s=Error(i(422),{cause:u}),Fl(Gn(s,o)))):(u!==Ff&&(r=Error(i(423),{cause:u}),Fl(Gn(r,o))),s=s.current.alternate,s.flags|=65536,p&=-p,s.lanes|=p,u=Gn(u,o),p=Ap(s.stateNode,u,p),np(s,p),vt!==4&&(vt=2)),!1;var y=Error(i(520),{cause:u});if(y=Gn(y,o),uc===null?uc=[y]:uc.push(y),vt!==4&&(vt=2),r===null)return!0;u=Gn(u,o),o=r;do{switch(o.tag){case 3:return o.flags|=65536,s=p&-p,o.lanes|=s,s=Ap(o.stateNode,u,s),np(o,s),!1;case 1:if(r=o.type,y=o.stateNode,(o.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(sr===null||!sr.has(y))))return o.flags|=65536,p&=-p,o.lanes|=p,p=Ev(p),Sv(p,s,o,u),np(o,p),!1}o=o.return}while(o!==null);return!1}var Np=Error(i(461)),jt=!1;function Xt(s,r,o,u){r.child=s===null?Ry(r,null,o,u):da(r,s.child,o,u)}function Av(s,r,o,u,p){o=o.render;var y=r.ref;if("ref"in u){var b={};for(var E in u)E!=="ref"&&(b[E]=u[E])}else b=u;return la(r),u=lp(s,r,o,b,y,p),E=cp(),s!==null&&!jt?(up(s,r,p),di(s,r,p)):(Fe&&E&&qf(r),r.flags|=1,Xt(s,r,u,p),r.child)}function Nv(s,r,o,u,p){if(s===null){var y=o.type;return typeof y=="function"&&!Bf(y)&&y.defaultProps===void 0&&o.compare===null?(r.tag=15,r.type=y,Cv(s,r,y,u,p)):(s=eh(o.type,null,u,r,r.mode,p),s.ref=r.ref,s.return=r,r.child=s)}if(y=s.child,!Pp(s,p)){var b=y.memoizedProps;if(o=o.compare,o=o!==null?o:Hl,o(b,u)&&s.ref===r.ref)return di(s,r,p)}return r.flags|=1,s=ai(y,u),s.ref=r.ref,s.return=r,r.child=s}function Cv(s,r,o,u,p){if(s!==null){var y=s.memoizedProps;if(Hl(y,u)&&s.ref===r.ref)if(jt=!1,r.pendingProps=u=y,Pp(s,p))(s.flags&131072)!==0&&(jt=!0);else return r.lanes=s.lanes,di(s,r,p)}return Cp(s,r,o,u,p)}function Rv(s,r,o,u){var p=u.children,y=s!==null?s.memoizedState:null;if(s===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((r.flags&128)!==0){if(y=y!==null?y.baseLanes|o:o,s!==null){for(u=r.child=s.child,p=0;u!==null;)p=p|u.lanes|u.childLanes,u=u.sibling;u=p&~y}else u=0,r.child=null;return Iv(s,r,y,o,u)}if((o&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},s!==null&&ih(r,y!==null?y.cachePool:null),y!==null?Oy(r,y):ip(),jy(r);else return u=r.lanes=536870912,Iv(s,r,y!==null?y.baseLanes|o:o,o,u)}else y!==null?(ih(r,y.cachePool),Oy(r,y),Zi(),r.memoizedState=null):(s!==null&&ih(r,null),ip(),Zi());return Xt(s,r,p,o),r.child}function sc(s,r){return s!==null&&s.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function Iv(s,r,o,u,p){var y=Xf();return y=y===null?null:{parent:kt._currentValue,pool:y},r.memoizedState={baseLanes:o,cachePool:y},s!==null&&ih(r,null),ip(),jy(r),s!==null&&uo(s,r,u,!0),r.childLanes=p,null}function bh(s,r){return r=xh({mode:r.mode,children:r.children},s.mode),r.ref=s.ref,s.child=r,r.return=s,r}function kv(s,r,o){return da(r,s.child,null,o),s=bh(r,r.pendingProps),s.flags|=2,jn(r),r.memoizedState=null,s}function bA(s,r,o){var u=r.pendingProps,p=(r.flags&128)!==0;if(r.flags&=-129,s===null){if(Fe){if(u.mode==="hidden")return s=bh(r,u),r.lanes=536870912,sc(null,s);if(ap(r),(s=ct)?(s=q_(s,Wn),s=s!==null&&s.data==="&"?s:null,s!==null&&(r.memoizedState={dehydrated:s,treeContext:Fi!==null?{id:Hs,overflow:qs}:null,retryLane:536870912,hydrationErrors:null},o=py(s),o.return=r,r.child=o,Qt=r,ct=null)):s=null,s===null)throw Ki(r);return r.lanes=536870912,null}return bh(r,u)}var y=s.memoizedState;if(y!==null){var b=y.dehydrated;if(ap(r),p)if(r.flags&256)r.flags&=-257,r=kv(s,r,o);else if(r.memoizedState!==null)r.child=s.child,r.flags|=128,r=null;else throw Error(i(558));else if(jt||uo(s,r,o,!1),p=(o&s.childLanes)!==0,jt||p){if(u=at,u!==null&&(b=El(u,o),b!==0&&b!==y.retryLane))throw y.retryLane=b,ia(s,b),xn(u,s,b),Np;kh(),r=kv(s,r,o)}else s=y.treeContext,ct=Jn(b.nextSibling),Qt=r,Fe=!0,Gi=null,Wn=!1,s!==null&&yy(r,s),r=bh(r,u),r.flags|=4096;return r}return s=ai(s.child,{mode:u.mode,children:u.children}),s.ref=r.ref,r.child=s,s.return=r,s}function wh(s,r){var o=r.ref;if(o===null)s!==null&&s.ref!==null&&(r.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(s===null||s.ref!==o)&&(r.flags|=4194816)}}function Cp(s,r,o,u,p){return la(r),o=lp(s,r,o,u,void 0,p),u=cp(),s!==null&&!jt?(up(s,r,p),di(s,r,p)):(Fe&&u&&qf(r),r.flags|=1,Xt(s,r,o,p),r.child)}function Ov(s,r,o,u,p,y){return la(r),r.updateQueue=null,o=Py(r,u,o,p),Dy(s),u=cp(),s!==null&&!jt?(up(s,r,y),di(s,r,y)):(Fe&&u&&qf(r),r.flags|=1,Xt(s,r,o,y),r.child)}function jv(s,r,o,u,p){if(la(r),r.stateNode===null){var y=ao,b=o.contextType;typeof b=="object"&&b!==null&&(y=Jt(b)),y=new o(u,y),r.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=Sp,r.stateNode=y,y._reactInternals=r,y=r.stateNode,y.props=u,y.state=r.memoizedState,y.refs={},ep(r),b=o.contextType,y.context=typeof b=="object"&&b!==null?Jt(b):ao,y.state=r.memoizedState,b=o.getDerivedStateFromProps,typeof b=="function"&&(Ep(r,o,b,u),y.state=r.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(b=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),b!==y.state&&Sp.enqueueReplaceState(y,y.state,null),Xl(r,u,y,p),Jl(),y.state=r.memoizedState),typeof y.componentDidMount=="function"&&(r.flags|=4194308),u=!0}else if(s===null){y=r.stateNode;var E=r.memoizedProps,P=pa(o,E);y.props=P;var W=y.context,ne=o.contextType;b=ao,typeof ne=="object"&&ne!==null&&(b=Jt(ne));var re=o.getDerivedStateFromProps;ne=typeof re=="function"||typeof y.getSnapshotBeforeUpdate=="function",E=r.pendingProps!==E,ne||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(E||W!==b)&&_v(r,y,u,b),Wi=!1;var J=r.memoizedState;y.state=J,Xl(r,u,y,p),Jl(),W=r.memoizedState,E||J!==W||Wi?(typeof re=="function"&&(Ep(r,o,re,u),W=r.memoizedState),(P=Wi||vv(r,o,P,u,J,W,b))?(ne||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(r.flags|=4194308)):(typeof y.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=u,r.memoizedState=W),y.props=u,y.state=W,y.context=b,u=P):(typeof y.componentDidMount=="function"&&(r.flags|=4194308),u=!1)}else{y=r.stateNode,tp(s,r),b=r.memoizedProps,ne=pa(o,b),y.props=ne,re=r.pendingProps,J=y.context,W=o.contextType,P=ao,typeof W=="object"&&W!==null&&(P=Jt(W)),E=o.getDerivedStateFromProps,(W=typeof E=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(b!==re||J!==P)&&_v(r,y,u,P),Wi=!1,J=r.memoizedState,y.state=J,Xl(r,u,y,p),Jl();var ee=r.memoizedState;b!==re||J!==ee||Wi||s!==null&&s.dependencies!==null&&nh(s.dependencies)?(typeof E=="function"&&(Ep(r,o,E,u),ee=r.memoizedState),(ne=Wi||vv(r,o,ne,u,J,ee,P)||s!==null&&s.dependencies!==null&&nh(s.dependencies))?(W||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(u,ee,P),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(u,ee,P)),typeof y.componentDidUpdate=="function"&&(r.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof y.componentDidUpdate!="function"||b===s.memoizedProps&&J===s.memoizedState||(r.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||b===s.memoizedProps&&J===s.memoizedState||(r.flags|=1024),r.memoizedProps=u,r.memoizedState=ee),y.props=u,y.state=ee,y.context=P,u=ne):(typeof y.componentDidUpdate!="function"||b===s.memoizedProps&&J===s.memoizedState||(r.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||b===s.memoizedProps&&J===s.memoizedState||(r.flags|=1024),u=!1)}return y=u,wh(s,r),u=(r.flags&128)!==0,y||u?(y=r.stateNode,o=u&&typeof o.getDerivedStateFromError!="function"?null:y.render(),r.flags|=1,s!==null&&u?(r.child=da(r,s.child,null,p),r.child=da(r,null,o,p)):Xt(s,r,o,p),r.memoizedState=y.state,s=r.child):s=di(s,r,p),s}function Dv(s,r,o,u){return aa(),r.flags|=256,Xt(s,r,o,u),r.child}var Rp={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ip(s){return{baseLanes:s,cachePool:Ty()}}function kp(s,r,o){return s=s!==null?s.childLanes&~o:0,r&&(s|=Pn),s}function Pv(s,r,o){var u=r.pendingProps,p=!1,y=(r.flags&128)!==0,b;if((b=y)||(b=s!==null&&s.memoizedState===null?!1:(xt.current&2)!==0),b&&(p=!0,r.flags&=-129),b=(r.flags&32)!==0,r.flags&=-33,s===null){if(Fe){if(p?Xi(r):Zi(),(s=ct)?(s=q_(s,Wn),s=s!==null&&s.data!=="&"?s:null,s!==null&&(r.memoizedState={dehydrated:s,treeContext:Fi!==null?{id:Hs,overflow:qs}:null,retryLane:536870912,hydrationErrors:null},o=py(s),o.return=r,r.child=o,Qt=r,ct=null)):s=null,s===null)throw Ki(r);return fg(s)?r.lanes=32:r.lanes=536870912,null}var E=u.children;return u=u.fallback,p?(Zi(),p=r.mode,E=xh({mode:"hidden",children:E},p),u=ra(u,p,o,null),E.return=r,u.return=r,E.sibling=u,r.child=E,u=r.child,u.memoizedState=Ip(o),u.childLanes=kp(s,b,o),r.memoizedState=Rp,sc(null,u)):(Xi(r),Op(r,E))}var P=s.memoizedState;if(P!==null&&(E=P.dehydrated,E!==null)){if(y)r.flags&256?(Xi(r),r.flags&=-257,r=jp(s,r,o)):r.memoizedState!==null?(Zi(),r.child=s.child,r.flags|=128,r=null):(Zi(),E=u.fallback,p=r.mode,u=xh({mode:"visible",children:u.children},p),E=ra(E,p,o,null),E.flags|=2,u.return=r,E.return=r,u.sibling=E,r.child=u,da(r,s.child,null,o),u=r.child,u.memoizedState=Ip(o),u.childLanes=kp(s,b,o),r.memoizedState=Rp,r=sc(null,u));else if(Xi(r),fg(E)){if(b=E.nextSibling&&E.nextSibling.dataset,b)var W=b.dgst;b=W,u=Error(i(419)),u.stack="",u.digest=b,Fl({value:u,source:null,stack:null}),r=jp(s,r,o)}else if(jt||uo(s,r,o,!1),b=(o&s.childLanes)!==0,jt||b){if(b=at,b!==null&&(u=El(b,o),u!==0&&u!==P.retryLane))throw P.retryLane=u,ia(s,u),xn(b,s,u),Np;dg(E)||kh(),r=jp(s,r,o)}else dg(E)?(r.flags|=192,r.child=s.child,r=null):(s=P.treeContext,ct=Jn(E.nextSibling),Qt=r,Fe=!0,Gi=null,Wn=!1,s!==null&&yy(r,s),r=Op(r,u.children),r.flags|=4096);return r}return p?(Zi(),E=u.fallback,p=r.mode,P=s.child,W=P.sibling,u=ai(P,{mode:"hidden",children:u.children}),u.subtreeFlags=P.subtreeFlags&65011712,W!==null?E=ai(W,E):(E=ra(E,p,o,null),E.flags|=2),E.return=r,u.return=r,u.sibling=E,r.child=u,sc(null,u),u=r.child,E=s.child.memoizedState,E===null?E=Ip(o):(p=E.cachePool,p!==null?(P=kt._currentValue,p=p.parent!==P?{parent:P,pool:P}:p):p=Ty(),E={baseLanes:E.baseLanes|o,cachePool:p}),u.memoizedState=E,u.childLanes=kp(s,b,o),r.memoizedState=Rp,sc(s.child,u)):(Xi(r),o=s.child,s=o.sibling,o=ai(o,{mode:"visible",children:u.children}),o.return=r,o.sibling=null,s!==null&&(b=r.deletions,b===null?(r.deletions=[s],r.flags|=16):b.push(s)),r.child=o,r.memoizedState=null,o)}function Op(s,r){return r=xh({mode:"visible",children:r},s.mode),r.return=s,s.child=r}function xh(s,r){return s=kn(22,s,null,r),s.lanes=0,s}function jp(s,r,o){return da(r,s.child,null,o),s=Op(r,r.pendingProps.children),s.flags|=2,r.memoizedState=null,s}function Mv(s,r,o){s.lanes|=r;var u=s.alternate;u!==null&&(u.lanes|=r),Yf(s.return,r,o)}function Dp(s,r,o,u,p,y){var b=s.memoizedState;b===null?s.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:u,tail:o,tailMode:p,treeForkCount:y}:(b.isBackwards=r,b.rendering=null,b.renderingStartTime=0,b.last=u,b.tail=o,b.tailMode=p,b.treeForkCount=y)}function Lv(s,r,o){var u=r.pendingProps,p=u.revealOrder,y=u.tail;u=u.children;var b=xt.current,E=(b&2)!==0;if(E?(b=b&1|2,r.flags|=128):b&=1,de(xt,b),Xt(s,r,u,o),u=Fe?$l:0,!E&&s!==null&&(s.flags&128)!==0)e:for(s=r.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Mv(s,o,r);else if(s.tag===19)Mv(s,o,r);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break e;for(;s.sibling===null;){if(s.return===null||s.return===r)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(p){case"forwards":for(o=r.child,p=null;o!==null;)s=o.alternate,s!==null&&uh(s)===null&&(p=o),o=o.sibling;o=p,o===null?(p=r.child,r.child=null):(p=o.sibling,o.sibling=null),Dp(r,!1,p,o,y,u);break;case"backwards":case"unstable_legacy-backwards":for(o=null,p=r.child,r.child=null;p!==null;){if(s=p.alternate,s!==null&&uh(s)===null){r.child=p;break}s=p.sibling,p.sibling=o,o=p,p=s}Dp(r,!0,o,null,y,u);break;case"together":Dp(r,!1,null,null,void 0,u);break;default:r.memoizedState=null}return r.child}function di(s,r,o){if(s!==null&&(r.dependencies=s.dependencies),nr|=r.lanes,(o&r.childLanes)===0)if(s!==null){if(uo(s,r,o,!1),(o&r.childLanes)===0)return null}else return null;if(s!==null&&r.child!==s.child)throw Error(i(153));if(r.child!==null){for(s=r.child,o=ai(s,s.pendingProps),r.child=o,o.return=r;s.sibling!==null;)s=s.sibling,o=o.sibling=ai(s,s.pendingProps),o.return=r;o.sibling=null}return r.child}function Pp(s,r){return(s.lanes&r)!==0?!0:(s=s.dependencies,!!(s!==null&&nh(s)))}function wA(s,r,o){switch(r.tag){case 3:ve(r,r.stateNode.containerInfo),Yi(r,kt,s.memoizedState.cache),aa();break;case 27:case 5:qt(r);break;case 4:ve(r,r.stateNode.containerInfo);break;case 10:Yi(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,ap(r),null;break;case 13:var u=r.memoizedState;if(u!==null)return u.dehydrated!==null?(Xi(r),r.flags|=128,null):(o&r.child.childLanes)!==0?Pv(s,r,o):(Xi(r),s=di(s,r,o),s!==null?s.sibling:null);Xi(r);break;case 19:var p=(s.flags&128)!==0;if(u=(o&r.childLanes)!==0,u||(uo(s,r,o,!1),u=(o&r.childLanes)!==0),p){if(u)return Lv(s,r,o);r.flags|=128}if(p=r.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),de(xt,xt.current),u)break;return null;case 22:return r.lanes=0,Rv(s,r,o,r.pendingProps);case 24:Yi(r,kt,s.memoizedState.cache)}return di(s,r,o)}function Uv(s,r,o){if(s!==null)if(s.memoizedProps!==r.pendingProps)jt=!0;else{if(!Pp(s,o)&&(r.flags&128)===0)return jt=!1,wA(s,r,o);jt=(s.flags&131072)!==0}else jt=!1,Fe&&(r.flags&1048576)!==0&&my(r,$l,r.index);switch(r.lanes=0,r.tag){case 16:e:{var u=r.pendingProps;if(s=ua(r.elementType),r.type=s,typeof s=="function")Bf(s)?(u=pa(s,u),r.tag=1,r=jv(null,r,s,u,o)):(r.tag=0,r=Cp(null,r,s,u,o));else{if(s!=null){var p=s.$$typeof;if(p===O){r.tag=11,r=Av(null,r,s,u,o);break e}else if(p===R){r.tag=14,r=Nv(null,r,s,u,o);break e}}throw r=ce(s)||s,Error(i(306,r,""))}}return r;case 0:return Cp(s,r,r.type,r.pendingProps,o);case 1:return u=r.type,p=pa(u,r.pendingProps),jv(s,r,u,p,o);case 3:e:{if(ve(r,r.stateNode.containerInfo),s===null)throw Error(i(387));u=r.pendingProps;var y=r.memoizedState;p=y.element,tp(s,r),Xl(r,u,null,o);var b=r.memoizedState;if(u=b.cache,Yi(r,kt,u),u!==y.cache&&Wf(r,[kt],o,!0),Jl(),u=b.element,y.isDehydrated)if(y={element:u,isDehydrated:!1,cache:b.cache},r.updateQueue.baseState=y,r.memoizedState=y,r.flags&256){r=Dv(s,r,u,o);break e}else if(u!==p){p=Gn(Error(i(424)),r),Fl(p),r=Dv(s,r,u,o);break e}else{switch(s=r.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(ct=Jn(s.firstChild),Qt=r,Fe=!0,Gi=null,Wn=!0,o=Ry(r,null,u,o),r.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling}else{if(aa(),u===p){r=di(s,r,o);break e}Xt(s,r,u,o)}r=r.child}return r;case 26:return wh(s,r),s===null?(o=W_(r.type,null,r.pendingProps,null))?r.memoizedState=o:Fe||(o=r.type,s=r.pendingProps,u=Uh(X.current).createElement(o),u[Ct]=r,u[$t]=s,Zt(u,o,s),Rt(u),r.stateNode=u):r.memoizedState=W_(r.type,s.memoizedProps,r.pendingProps,s.memoizedState),null;case 27:return qt(r),s===null&&Fe&&(u=r.stateNode=G_(r.type,r.pendingProps,X.current),Qt=r,Wn=!0,p=ct,or(r.type)?(pg=p,ct=Jn(u.firstChild)):ct=p),Xt(s,r,r.pendingProps.children,o),wh(s,r),s===null&&(r.flags|=4194304),r.child;case 5:return s===null&&Fe&&((p=u=ct)&&(u=JA(u,r.type,r.pendingProps,Wn),u!==null?(r.stateNode=u,Qt=r,ct=Jn(u.firstChild),Wn=!1,p=!0):p=!1),p||Ki(r)),qt(r),p=r.type,y=r.pendingProps,b=s!==null?s.memoizedProps:null,u=y.children,cg(p,y)?u=null:b!==null&&cg(p,b)&&(r.flags|=32),r.memoizedState!==null&&(p=lp(s,r,dA,null,null,o),vc._currentValue=p),wh(s,r),Xt(s,r,u,o),r.child;case 6:return s===null&&Fe&&((s=o=ct)&&(o=XA(o,r.pendingProps,Wn),o!==null?(r.stateNode=o,Qt=r,ct=null,s=!0):s=!1),s||Ki(r)),null;case 13:return Pv(s,r,o);case 4:return ve(r,r.stateNode.containerInfo),u=r.pendingProps,s===null?r.child=da(r,null,u,o):Xt(s,r,u,o),r.child;case 11:return Av(s,r,r.type,r.pendingProps,o);case 7:return Xt(s,r,r.pendingProps,o),r.child;case 8:return Xt(s,r,r.pendingProps.children,o),r.child;case 12:return Xt(s,r,r.pendingProps.children,o),r.child;case 10:return u=r.pendingProps,Yi(r,r.type,u.value),Xt(s,r,u.children,o),r.child;case 9:return p=r.type._context,u=r.pendingProps.children,la(r),p=Jt(p),u=u(p),r.flags|=1,Xt(s,r,u,o),r.child;case 14:return Nv(s,r,r.type,r.pendingProps,o);case 15:return Cv(s,r,r.type,r.pendingProps,o);case 19:return Lv(s,r,o);case 31:return bA(s,r,o);case 22:return Rv(s,r,o,r.pendingProps);case 24:return la(r),u=Jt(kt),s===null?(p=Xf(),p===null&&(p=at,y=Qf(),p.pooledCache=y,y.refCount++,y!==null&&(p.pooledCacheLanes|=o),p=y),r.memoizedState={parent:u,cache:p},ep(r),Yi(r,kt,p)):((s.lanes&o)!==0&&(tp(s,r),Xl(r,null,null,o),Jl()),p=s.memoizedState,y=r.memoizedState,p.parent!==u?(p={parent:u,cache:u},r.memoizedState=p,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=p),Yi(r,kt,u)):(u=y.cache,Yi(r,kt,u),u!==p.cache&&Wf(r,[kt],o,!0))),Xt(s,r,r.pendingProps.children,o),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function fi(s){s.flags|=4}function Mp(s,r,o,u,p){if((r=(s.mode&32)!==0)&&(r=!1),r){if(s.flags|=16777216,(p&335544128)===p)if(s.stateNode.complete)s.flags|=8192;else if(h_())s.flags|=8192;else throw ha=ah,Zf}else s.flags&=-16777217}function Vv(s,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!eb(r))if(h_())s.flags|=8192;else throw ha=ah,Zf}function Th(s,r){r!==null&&(s.flags|=4),s.flags&16384&&(r=s.tag!==22?Ru():536870912,s.lanes|=r,To|=r)}function ic(s,r){if(!Fe)switch(s.tailMode){case"hidden":r=s.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?s.tail=null:o.sibling=null;break;case"collapsed":o=s.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?r||s.tail===null?s.tail=null:s.tail.sibling=null:u.sibling=null}}function ut(s){var r=s.alternate!==null&&s.alternate.child===s.child,o=0,u=0;if(r)for(var p=s.child;p!==null;)o|=p.lanes|p.childLanes,u|=p.subtreeFlags&65011712,u|=p.flags&65011712,p.return=s,p=p.sibling;else for(p=s.child;p!==null;)o|=p.lanes|p.childLanes,u|=p.subtreeFlags,u|=p.flags,p.return=s,p=p.sibling;return s.subtreeFlags|=u,s.childLanes=o,r}function xA(s,r,o){var u=r.pendingProps;switch($f(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ut(r),null;case 1:return ut(r),null;case 3:return o=r.stateNode,u=null,s!==null&&(u=s.memoizedState.cache),r.memoizedState.cache!==u&&(r.flags|=2048),ci(kt),Ke(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(s===null||s.child===null)&&(co(r)?fi(r):s===null||s.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Gf())),ut(r),null;case 26:var p=r.type,y=r.memoizedState;return s===null?(fi(r),y!==null?(ut(r),Vv(r,y)):(ut(r),Mp(r,p,null,u,o))):y?y!==s.memoizedState?(fi(r),ut(r),Vv(r,y)):(ut(r),r.flags&=-16777217):(s=s.memoizedProps,s!==u&&fi(r),ut(r),Mp(r,p,s,u,o)),null;case 27:if(Ts(r),o=X.current,p=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==u&&fi(r);else{if(!u){if(r.stateNode===null)throw Error(i(166));return ut(r),null}s=pe.current,co(r)?vy(r):(s=G_(p,u,o),r.stateNode=s,fi(r))}return ut(r),null;case 5:if(Ts(r),p=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==u&&fi(r);else{if(!u){if(r.stateNode===null)throw Error(i(166));return ut(r),null}if(y=pe.current,co(r))vy(r);else{var b=Uh(X.current);switch(y){case 1:y=b.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:y=b.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":y=b.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":y=b.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":y=b.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof u.is=="string"?b.createElement("select",{is:u.is}):b.createElement("select"),u.multiple?y.multiple=!0:u.size&&(y.size=u.size);break;default:y=typeof u.is=="string"?b.createElement(p,{is:u.is}):b.createElement(p)}}y[Ct]=r,y[$t]=u;e:for(b=r.child;b!==null;){if(b.tag===5||b.tag===6)y.appendChild(b.stateNode);else if(b.tag!==4&&b.tag!==27&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===r)break e;for(;b.sibling===null;){if(b.return===null||b.return===r)break e;b=b.return}b.sibling.return=b.return,b=b.sibling}r.stateNode=y;e:switch(Zt(y,p,u),p){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&fi(r)}}return ut(r),Mp(r,r.type,s===null?null:s.memoizedProps,r.pendingProps,o),null;case 6:if(s&&r.stateNode!=null)s.memoizedProps!==u&&fi(r);else{if(typeof u!="string"&&r.stateNode===null)throw Error(i(166));if(s=X.current,co(r)){if(s=r.stateNode,o=r.memoizedProps,u=null,p=Qt,p!==null)switch(p.tag){case 27:case 5:u=p.memoizedProps}s[Ct]=r,s=!!(s.nodeValue===o||u!==null&&u.suppressHydrationWarning===!0||P_(s.nodeValue,o)),s||Ki(r,!0)}else s=Uh(s).createTextNode(u),s[Ct]=r,r.stateNode=s}return ut(r),null;case 31:if(o=r.memoizedState,s===null||s.memoizedState!==null){if(u=co(r),o!==null){if(s===null){if(!u)throw Error(i(318));if(s=r.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[Ct]=r}else aa(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;ut(r),s=!1}else o=Gf(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=o),s=!0;if(!s)return r.flags&256?(jn(r),r):(jn(r),null);if((r.flags&128)!==0)throw Error(i(558))}return ut(r),null;case 13:if(u=r.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(p=co(r),u!==null&&u.dehydrated!==null){if(s===null){if(!p)throw Error(i(318));if(p=r.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(i(317));p[Ct]=r}else aa(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;ut(r),p=!1}else p=Gf(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=p),p=!0;if(!p)return r.flags&256?(jn(r),r):(jn(r),null)}return jn(r),(r.flags&128)!==0?(r.lanes=o,r):(o=u!==null,s=s!==null&&s.memoizedState!==null,o&&(u=r.child,p=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(p=u.alternate.memoizedState.cachePool.pool),y=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(y=u.memoizedState.cachePool.pool),y!==p&&(u.flags|=2048)),o!==s&&o&&(r.child.flags|=8192),Th(r,r.updateQueue),ut(r),null);case 4:return Ke(),s===null&&ig(r.stateNode.containerInfo),ut(r),null;case 10:return ci(r.type),ut(r),null;case 19:if(te(xt),u=r.memoizedState,u===null)return ut(r),null;if(p=(r.flags&128)!==0,y=u.rendering,y===null)if(p)ic(u,!1);else{if(vt!==0||s!==null&&(s.flags&128)!==0)for(s=r.child;s!==null;){if(y=uh(s),y!==null){for(r.flags|=128,ic(u,!1),s=y.updateQueue,r.updateQueue=s,Th(r,s),r.subtreeFlags=0,s=o,o=r.child;o!==null;)fy(o,s),o=o.sibling;return de(xt,xt.current&1|2),Fe&&oi(r,u.treeForkCount),r.child}s=s.sibling}u.tail!==null&&dn()>Ch&&(r.flags|=128,p=!0,ic(u,!1),r.lanes=4194304)}else{if(!p)if(s=uh(y),s!==null){if(r.flags|=128,p=!0,s=s.updateQueue,r.updateQueue=s,Th(r,s),ic(u,!0),u.tail===null&&u.tailMode==="hidden"&&!y.alternate&&!Fe)return ut(r),null}else 2*dn()-u.renderingStartTime>Ch&&o!==536870912&&(r.flags|=128,p=!0,ic(u,!1),r.lanes=4194304);u.isBackwards?(y.sibling=r.child,r.child=y):(s=u.last,s!==null?s.sibling=y:r.child=y,u.last=y)}return u.tail!==null?(s=u.tail,u.rendering=s,u.tail=s.sibling,u.renderingStartTime=dn(),s.sibling=null,o=xt.current,de(xt,p?o&1|2:o&1),Fe&&oi(r,u.treeForkCount),s):(ut(r),null);case 22:case 23:return jn(r),rp(),u=r.memoizedState!==null,s!==null?s.memoizedState!==null!==u&&(r.flags|=8192):u&&(r.flags|=8192),u?(o&536870912)!==0&&(r.flags&128)===0&&(ut(r),r.subtreeFlags&6&&(r.flags|=8192)):ut(r),o=r.updateQueue,o!==null&&Th(r,o.retryQueue),o=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),u=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),u!==o&&(r.flags|=2048),s!==null&&te(ca),null;case 24:return o=null,s!==null&&(o=s.memoizedState.cache),r.memoizedState.cache!==o&&(r.flags|=2048),ci(kt),ut(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function TA(s,r){switch($f(r),r.tag){case 1:return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 3:return ci(kt),Ke(),s=r.flags,(s&65536)!==0&&(s&128)===0?(r.flags=s&-65537|128,r):null;case 26:case 27:case 5:return Ts(r),null;case 31:if(r.memoizedState!==null){if(jn(r),r.alternate===null)throw Error(i(340));aa()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 13:if(jn(r),s=r.memoizedState,s!==null&&s.dehydrated!==null){if(r.alternate===null)throw Error(i(340));aa()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 19:return te(xt),null;case 4:return Ke(),null;case 10:return ci(r.type),null;case 22:case 23:return jn(r),rp(),s!==null&&te(ca),s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 24:return ci(kt),null;case 25:return null;default:return null}}function Bv(s,r){switch($f(r),r.tag){case 3:ci(kt),Ke();break;case 26:case 27:case 5:Ts(r);break;case 4:Ke();break;case 31:r.memoizedState!==null&&jn(r);break;case 13:jn(r);break;case 19:te(xt);break;case 10:ci(r.type);break;case 22:case 23:jn(r),rp(),s!==null&&te(ca);break;case 24:ci(kt)}}function rc(s,r){try{var o=r.updateQueue,u=o!==null?o.lastEffect:null;if(u!==null){var p=u.next;o=p;do{if((o.tag&s)===s){u=void 0;var y=o.create,b=o.inst;u=y(),b.destroy=u}o=o.next}while(o!==p)}}catch(E){tt(r,r.return,E)}}function er(s,r,o){try{var u=r.updateQueue,p=u!==null?u.lastEffect:null;if(p!==null){var y=p.next;u=y;do{if((u.tag&s)===s){var b=u.inst,E=b.destroy;if(E!==void 0){b.destroy=void 0,p=r;var P=o,W=E;try{W()}catch(ne){tt(p,P,ne)}}}u=u.next}while(u!==y)}}catch(ne){tt(r,r.return,ne)}}function zv(s){var r=s.updateQueue;if(r!==null){var o=s.stateNode;try{ky(r,o)}catch(u){tt(s,s.return,u)}}}function Hv(s,r,o){o.props=pa(s.type,s.memoizedProps),o.state=s.memoizedState;try{o.componentWillUnmount()}catch(u){tt(s,r,u)}}function ac(s,r){try{var o=s.ref;if(o!==null){switch(s.tag){case 26:case 27:case 5:var u=s.stateNode;break;case 30:u=s.stateNode;break;default:u=s.stateNode}typeof o=="function"?s.refCleanup=o(u):o.current=u}}catch(p){tt(s,r,p)}}function $s(s,r){var o=s.ref,u=s.refCleanup;if(o!==null)if(typeof u=="function")try{u()}catch(p){tt(s,r,p)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(p){tt(s,r,p)}else o.current=null}function qv(s){var r=s.type,o=s.memoizedProps,u=s.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":o.autoFocus&&u.focus();break e;case"img":o.src?u.src=o.src:o.srcSet&&(u.srcset=o.srcSet)}}catch(p){tt(s,s.return,p)}}function Lp(s,r,o){try{var u=s.stateNode;FA(u,s.type,o,r),u[$t]=r}catch(p){tt(s,s.return,p)}}function $v(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&or(s.type)||s.tag===4}function Up(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||$v(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&or(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Vp(s,r,o){var u=s.tag;if(u===5||u===6)s=s.stateNode,r?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(s,r):(r=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,r.appendChild(s),o=o._reactRootContainer,o!=null||r.onclick!==null||(r.onclick=os));else if(u!==4&&(u===27&&or(s.type)&&(o=s.stateNode,r=null),s=s.child,s!==null))for(Vp(s,r,o),s=s.sibling;s!==null;)Vp(s,r,o),s=s.sibling}function Eh(s,r,o){var u=s.tag;if(u===5||u===6)s=s.stateNode,r?o.insertBefore(s,r):o.appendChild(s);else if(u!==4&&(u===27&&or(s.type)&&(o=s.stateNode),s=s.child,s!==null))for(Eh(s,r,o),s=s.sibling;s!==null;)Eh(s,r,o),s=s.sibling}function Fv(s){var r=s.stateNode,o=s.memoizedProps;try{for(var u=s.type,p=r.attributes;p.length;)r.removeAttributeNode(p[0]);Zt(r,u,o),r[Ct]=s,r[$t]=o}catch(y){tt(s,s.return,y)}}var pi=!1,Dt=!1,Bp=!1,Gv=typeof WeakSet=="function"?WeakSet:Set,Gt=null;function EA(s,r){if(s=s.containerInfo,og=Fh,s=iy(s),jf(s)){if("selectionStart"in s)var o={start:s.selectionStart,end:s.selectionEnd};else e:{o=(o=s.ownerDocument)&&o.defaultView||window;var u=o.getSelection&&o.getSelection();if(u&&u.rangeCount!==0){o=u.anchorNode;var p=u.anchorOffset,y=u.focusNode;u=u.focusOffset;try{o.nodeType,y.nodeType}catch{o=null;break e}var b=0,E=-1,P=-1,W=0,ne=0,re=s,J=null;t:for(;;){for(var ee;re!==o||p!==0&&re.nodeType!==3||(E=b+p),re!==y||u!==0&&re.nodeType!==3||(P=b+u),re.nodeType===3&&(b+=re.nodeValue.length),(ee=re.firstChild)!==null;)J=re,re=ee;for(;;){if(re===s)break t;if(J===o&&++W===p&&(E=b),J===y&&++ne===u&&(P=b),(ee=re.nextSibling)!==null)break;re=J,J=re.parentNode}re=ee}o=E===-1||P===-1?null:{start:E,end:P}}else o=null}o=o||{start:0,end:0}}else o=null;for(lg={focusedElem:s,selectionRange:o},Fh=!1,Gt=r;Gt!==null;)if(r=Gt,s=r.child,(r.subtreeFlags&1028)!==0&&s!==null)s.return=r,Gt=s;else for(;Gt!==null;){switch(r=Gt,y=r.alternate,s=r.flags,r.tag){case 0:if((s&4)!==0&&(s=r.updateQueue,s=s!==null?s.events:null,s!==null))for(o=0;o<s.length;o++)p=s[o],p.ref.impl=p.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&y!==null){s=void 0,o=r,p=y.memoizedProps,y=y.memoizedState,u=o.stateNode;try{var _e=pa(o.type,p);s=u.getSnapshotBeforeUpdate(_e,y),u.__reactInternalSnapshotBeforeUpdate=s}catch(Ae){tt(o,o.return,Ae)}}break;case 3:if((s&1024)!==0){if(s=r.stateNode.containerInfo,o=s.nodeType,o===9)hg(s);else if(o===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":hg(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=r.sibling,s!==null){s.return=r.return,Gt=s;break}Gt=r.return}}function Kv(s,r,o){var u=o.flags;switch(o.tag){case 0:case 11:case 15:mi(s,o),u&4&&rc(5,o);break;case 1:if(mi(s,o),u&4)if(s=o.stateNode,r===null)try{s.componentDidMount()}catch(b){tt(o,o.return,b)}else{var p=pa(o.type,r.memoizedProps);r=r.memoizedState;try{s.componentDidUpdate(p,r,s.__reactInternalSnapshotBeforeUpdate)}catch(b){tt(o,o.return,b)}}u&64&&zv(o),u&512&&ac(o,o.return);break;case 3:if(mi(s,o),u&64&&(s=o.updateQueue,s!==null)){if(r=null,o.child!==null)switch(o.child.tag){case 27:case 5:r=o.child.stateNode;break;case 1:r=o.child.stateNode}try{ky(s,r)}catch(b){tt(o,o.return,b)}}break;case 27:r===null&&u&4&&Fv(o);case 26:case 5:mi(s,o),r===null&&u&4&&qv(o),u&512&&ac(o,o.return);break;case 12:mi(s,o);break;case 31:mi(s,o),u&4&&Qv(s,o);break;case 13:mi(s,o),u&4&&Jv(s,o),u&64&&(s=o.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(o=jA.bind(null,o),ZA(s,o))));break;case 22:if(u=o.memoizedState!==null||pi,!u){r=r!==null&&r.memoizedState!==null||Dt,p=pi;var y=Dt;pi=u,(Dt=r)&&!y?yi(s,o,(o.subtreeFlags&8772)!==0):mi(s,o),pi=p,Dt=y}break;case 30:break;default:mi(s,o)}}function Yv(s){var r=s.alternate;r!==null&&(s.alternate=null,Yv(r)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(r=s.stateNode,r!==null&&Ga(r)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var ft=null,vn=!1;function gi(s,r,o){for(o=o.child;o!==null;)Wv(s,r,o),o=o.sibling}function Wv(s,r,o){if(Yt&&typeof Yt.onCommitFiberUnmount=="function")try{Yt.onCommitFiberUnmount(ss,o)}catch{}switch(o.tag){case 26:Dt||$s(o,r),gi(s,r,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Dt||$s(o,r);var u=ft,p=vn;or(o.type)&&(ft=o.stateNode,vn=!1),gi(s,r,o),gc(o.stateNode),ft=u,vn=p;break;case 5:Dt||$s(o,r);case 6:if(u=ft,p=vn,ft=null,gi(s,r,o),ft=u,vn=p,ft!==null)if(vn)try{(ft.nodeType===9?ft.body:ft.nodeName==="HTML"?ft.ownerDocument.body:ft).removeChild(o.stateNode)}catch(y){tt(o,r,y)}else try{ft.removeChild(o.stateNode)}catch(y){tt(o,r,y)}break;case 18:ft!==null&&(vn?(s=ft,z_(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,o.stateNode),ko(s)):z_(ft,o.stateNode));break;case 4:u=ft,p=vn,ft=o.stateNode.containerInfo,vn=!0,gi(s,r,o),ft=u,vn=p;break;case 0:case 11:case 14:case 15:er(2,o,r),Dt||er(4,o,r),gi(s,r,o);break;case 1:Dt||($s(o,r),u=o.stateNode,typeof u.componentWillUnmount=="function"&&Hv(o,r,u)),gi(s,r,o);break;case 21:gi(s,r,o);break;case 22:Dt=(u=Dt)||o.memoizedState!==null,gi(s,r,o),Dt=u;break;default:gi(s,r,o)}}function Qv(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{ko(s)}catch(o){tt(r,r.return,o)}}}function Jv(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{ko(s)}catch(o){tt(r,r.return,o)}}function SA(s){switch(s.tag){case 31:case 13:case 19:var r=s.stateNode;return r===null&&(r=s.stateNode=new Gv),r;case 22:return s=s.stateNode,r=s._retryCache,r===null&&(r=s._retryCache=new Gv),r;default:throw Error(i(435,s.tag))}}function Sh(s,r){var o=SA(s);r.forEach(function(u){if(!o.has(u)){o.add(u);var p=DA.bind(null,s,u);u.then(p,p)}})}function _n(s,r){var o=r.deletions;if(o!==null)for(var u=0;u<o.length;u++){var p=o[u],y=s,b=r,E=b;e:for(;E!==null;){switch(E.tag){case 27:if(or(E.type)){ft=E.stateNode,vn=!1;break e}break;case 5:ft=E.stateNode,vn=!1;break e;case 3:case 4:ft=E.stateNode.containerInfo,vn=!0;break e}E=E.return}if(ft===null)throw Error(i(160));Wv(y,b,p),ft=null,vn=!1,y=p.alternate,y!==null&&(y.return=null),p.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)Xv(r,s),r=r.sibling}var fs=null;function Xv(s,r){var o=s.alternate,u=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:_n(r,s),bn(s),u&4&&(er(3,s,s.return),rc(3,s),er(5,s,s.return));break;case 1:_n(r,s),bn(s),u&512&&(Dt||o===null||$s(o,o.return)),u&64&&pi&&(s=s.updateQueue,s!==null&&(u=s.callbacks,u!==null&&(o=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=o===null?u:o.concat(u))));break;case 26:var p=fs;if(_n(r,s),bn(s),u&512&&(Dt||o===null||$s(o,o.return)),u&4){var y=o!==null?o.memoizedState:null;if(u=s.memoizedState,o===null)if(u===null)if(s.stateNode===null){e:{u=s.type,o=s.memoizedProps,p=p.ownerDocument||p;t:switch(u){case"title":y=p.getElementsByTagName("title")[0],(!y||y[Is]||y[Ct]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=p.createElement(u),p.head.insertBefore(y,p.querySelector("head > title"))),Zt(y,u,o),y[Ct]=s,Rt(y),u=y;break e;case"link":var b=X_("link","href",p).get(u+(o.href||""));if(b){for(var E=0;E<b.length;E++)if(y=b[E],y.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&y.getAttribute("rel")===(o.rel==null?null:o.rel)&&y.getAttribute("title")===(o.title==null?null:o.title)&&y.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){b.splice(E,1);break t}}y=p.createElement(u),Zt(y,u,o),p.head.appendChild(y);break;case"meta":if(b=X_("meta","content",p).get(u+(o.content||""))){for(E=0;E<b.length;E++)if(y=b[E],y.getAttribute("content")===(o.content==null?null:""+o.content)&&y.getAttribute("name")===(o.name==null?null:o.name)&&y.getAttribute("property")===(o.property==null?null:o.property)&&y.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&y.getAttribute("charset")===(o.charSet==null?null:o.charSet)){b.splice(E,1);break t}}y=p.createElement(u),Zt(y,u,o),p.head.appendChild(y);break;default:throw Error(i(468,u))}y[Ct]=s,Rt(y),u=y}s.stateNode=u}else Z_(p,s.type,s.stateNode);else s.stateNode=J_(p,u,s.memoizedProps);else y!==u?(y===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):y.count--,u===null?Z_(p,s.type,s.stateNode):J_(p,u,s.memoizedProps)):u===null&&s.stateNode!==null&&Lp(s,s.memoizedProps,o.memoizedProps)}break;case 27:_n(r,s),bn(s),u&512&&(Dt||o===null||$s(o,o.return)),o!==null&&u&4&&Lp(s,s.memoizedProps,o.memoizedProps);break;case 5:if(_n(r,s),bn(s),u&512&&(Dt||o===null||$s(o,o.return)),s.flags&32){p=s.stateNode;try{yn(p,"")}catch(_e){tt(s,s.return,_e)}}u&4&&s.stateNode!=null&&(p=s.memoizedProps,Lp(s,p,o!==null?o.memoizedProps:p)),u&1024&&(Bp=!0);break;case 6:if(_n(r,s),bn(s),u&4){if(s.stateNode===null)throw Error(i(162));u=s.memoizedProps,o=s.stateNode;try{o.nodeValue=u}catch(_e){tt(s,s.return,_e)}}break;case 3:if(zh=null,p=fs,fs=Vh(r.containerInfo),_n(r,s),fs=p,bn(s),u&4&&o!==null&&o.memoizedState.isDehydrated)try{ko(r.containerInfo)}catch(_e){tt(s,s.return,_e)}Bp&&(Bp=!1,Zv(s));break;case 4:u=fs,fs=Vh(s.stateNode.containerInfo),_n(r,s),bn(s),fs=u;break;case 12:_n(r,s),bn(s);break;case 31:_n(r,s),bn(s),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Sh(s,u)));break;case 13:_n(r,s),bn(s),s.child.flags&8192&&s.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Nh=dn()),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Sh(s,u)));break;case 22:p=s.memoizedState!==null;var P=o!==null&&o.memoizedState!==null,W=pi,ne=Dt;if(pi=W||p,Dt=ne||P,_n(r,s),Dt=ne,pi=W,bn(s),u&8192)e:for(r=s.stateNode,r._visibility=p?r._visibility&-2:r._visibility|1,p&&(o===null||P||pi||Dt||ga(s)),o=null,r=s;;){if(r.tag===5||r.tag===26){if(o===null){P=o=r;try{if(y=P.stateNode,p)b=y.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none";else{E=P.stateNode;var re=P.memoizedProps.style,J=re!=null&&re.hasOwnProperty("display")?re.display:null;E.style.display=J==null||typeof J=="boolean"?"":(""+J).trim()}}catch(_e){tt(P,P.return,_e)}}}else if(r.tag===6){if(o===null){P=r;try{P.stateNode.nodeValue=p?"":P.memoizedProps}catch(_e){tt(P,P.return,_e)}}}else if(r.tag===18){if(o===null){P=r;try{var ee=P.stateNode;p?H_(ee,!0):H_(P.stateNode,!1)}catch(_e){tt(P,P.return,_e)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===s)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;o===r&&(o=null),r=r.return}o===r&&(o=null),r.sibling.return=r.return,r=r.sibling}u&4&&(u=s.updateQueue,u!==null&&(o=u.retryQueue,o!==null&&(u.retryQueue=null,Sh(s,o))));break;case 19:_n(r,s),bn(s),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Sh(s,u)));break;case 30:break;case 21:break;default:_n(r,s),bn(s)}}function bn(s){var r=s.flags;if(r&2){try{for(var o,u=s.return;u!==null;){if($v(u)){o=u;break}u=u.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var p=o.stateNode,y=Up(s);Eh(s,y,p);break;case 5:var b=o.stateNode;o.flags&32&&(yn(b,""),o.flags&=-33);var E=Up(s);Eh(s,E,b);break;case 3:case 4:var P=o.stateNode.containerInfo,W=Up(s);Vp(s,W,P);break;default:throw Error(i(161))}}catch(ne){tt(s,s.return,ne)}s.flags&=-3}r&4096&&(s.flags&=-4097)}function Zv(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var r=s;Zv(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),s=s.sibling}}function mi(s,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)Kv(s,r.alternate,r),r=r.sibling}function ga(s){for(s=s.child;s!==null;){var r=s;switch(r.tag){case 0:case 11:case 14:case 15:er(4,r,r.return),ga(r);break;case 1:$s(r,r.return);var o=r.stateNode;typeof o.componentWillUnmount=="function"&&Hv(r,r.return,o),ga(r);break;case 27:gc(r.stateNode);case 26:case 5:$s(r,r.return),ga(r);break;case 22:r.memoizedState===null&&ga(r);break;case 30:ga(r);break;default:ga(r)}s=s.sibling}}function yi(s,r,o){for(o=o&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var u=r.alternate,p=s,y=r,b=y.flags;switch(y.tag){case 0:case 11:case 15:yi(p,y,o),rc(4,y);break;case 1:if(yi(p,y,o),u=y,p=u.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(W){tt(u,u.return,W)}if(u=y,p=u.updateQueue,p!==null){var E=u.stateNode;try{var P=p.shared.hiddenCallbacks;if(P!==null)for(p.shared.hiddenCallbacks=null,p=0;p<P.length;p++)Iy(P[p],E)}catch(W){tt(u,u.return,W)}}o&&b&64&&zv(y),ac(y,y.return);break;case 27:Fv(y);case 26:case 5:yi(p,y,o),o&&u===null&&b&4&&qv(y),ac(y,y.return);break;case 12:yi(p,y,o);break;case 31:yi(p,y,o),o&&b&4&&Qv(p,y);break;case 13:yi(p,y,o),o&&b&4&&Jv(p,y);break;case 22:y.memoizedState===null&&yi(p,y,o),ac(y,y.return);break;case 30:break;default:yi(p,y,o)}r=r.sibling}}function zp(s,r){var o=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),s=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(s=r.memoizedState.cachePool.pool),s!==o&&(s!=null&&s.refCount++,o!=null&&Gl(o))}function Hp(s,r){s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&Gl(s))}function ps(s,r,o,u){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)e_(s,r,o,u),r=r.sibling}function e_(s,r,o,u){var p=r.flags;switch(r.tag){case 0:case 11:case 15:ps(s,r,o,u),p&2048&&rc(9,r);break;case 1:ps(s,r,o,u);break;case 3:ps(s,r,o,u),p&2048&&(s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&Gl(s)));break;case 12:if(p&2048){ps(s,r,o,u),s=r.stateNode;try{var y=r.memoizedProps,b=y.id,E=y.onPostCommit;typeof E=="function"&&E(b,r.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(P){tt(r,r.return,P)}}else ps(s,r,o,u);break;case 31:ps(s,r,o,u);break;case 13:ps(s,r,o,u);break;case 23:break;case 22:y=r.stateNode,b=r.alternate,r.memoizedState!==null?y._visibility&2?ps(s,r,o,u):oc(s,r):y._visibility&2?ps(s,r,o,u):(y._visibility|=2,bo(s,r,o,u,(r.subtreeFlags&10256)!==0||!1)),p&2048&&zp(b,r);break;case 24:ps(s,r,o,u),p&2048&&Hp(r.alternate,r);break;default:ps(s,r,o,u)}}function bo(s,r,o,u,p){for(p=p&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var y=s,b=r,E=o,P=u,W=b.flags;switch(b.tag){case 0:case 11:case 15:bo(y,b,E,P,p),rc(8,b);break;case 23:break;case 22:var ne=b.stateNode;b.memoizedState!==null?ne._visibility&2?bo(y,b,E,P,p):oc(y,b):(ne._visibility|=2,bo(y,b,E,P,p)),p&&W&2048&&zp(b.alternate,b);break;case 24:bo(y,b,E,P,p),p&&W&2048&&Hp(b.alternate,b);break;default:bo(y,b,E,P,p)}r=r.sibling}}function oc(s,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var o=s,u=r,p=u.flags;switch(u.tag){case 22:oc(o,u),p&2048&&zp(u.alternate,u);break;case 24:oc(o,u),p&2048&&Hp(u.alternate,u);break;default:oc(o,u)}r=r.sibling}}var lc=8192;function wo(s,r,o){if(s.subtreeFlags&lc)for(s=s.child;s!==null;)t_(s,r,o),s=s.sibling}function t_(s,r,o){switch(s.tag){case 26:wo(s,r,o),s.flags&lc&&s.memoizedState!==null&&h2(o,fs,s.memoizedState,s.memoizedProps);break;case 5:wo(s,r,o);break;case 3:case 4:var u=fs;fs=Vh(s.stateNode.containerInfo),wo(s,r,o),fs=u;break;case 22:s.memoizedState===null&&(u=s.alternate,u!==null&&u.memoizedState!==null?(u=lc,lc=16777216,wo(s,r,o),lc=u):wo(s,r,o));break;default:wo(s,r,o)}}function n_(s){var r=s.alternate;if(r!==null&&(s=r.child,s!==null)){r.child=null;do r=s.sibling,s.sibling=null,s=r;while(s!==null)}}function cc(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var u=r[o];Gt=u,i_(u,s)}n_(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)s_(s),s=s.sibling}function s_(s){switch(s.tag){case 0:case 11:case 15:cc(s),s.flags&2048&&er(9,s,s.return);break;case 3:cc(s);break;case 12:cc(s);break;case 22:var r=s.stateNode;s.memoizedState!==null&&r._visibility&2&&(s.return===null||s.return.tag!==13)?(r._visibility&=-3,Ah(s)):cc(s);break;default:cc(s)}}function Ah(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var u=r[o];Gt=u,i_(u,s)}n_(s)}for(s=s.child;s!==null;){switch(r=s,r.tag){case 0:case 11:case 15:er(8,r,r.return),Ah(r);break;case 22:o=r.stateNode,o._visibility&2&&(o._visibility&=-3,Ah(r));break;default:Ah(r)}s=s.sibling}}function i_(s,r){for(;Gt!==null;){var o=Gt;switch(o.tag){case 0:case 11:case 15:er(8,o,r);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var u=o.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:Gl(o.memoizedState.cache)}if(u=o.child,u!==null)u.return=o,Gt=u;else e:for(o=s;Gt!==null;){u=Gt;var p=u.sibling,y=u.return;if(Yv(u),u===o){Gt=null;break e}if(p!==null){p.return=y,Gt=p;break e}Gt=y}}}var AA={getCacheForType:function(s){var r=Jt(kt),o=r.data.get(s);return o===void 0&&(o=s(),r.data.set(s,o)),o},cacheSignal:function(){return Jt(kt).controller.signal}},NA=typeof WeakMap=="function"?WeakMap:Map,Je=0,at=null,Ue=null,Be=0,et=0,Dn=null,tr=!1,xo=!1,qp=!1,vi=0,vt=0,nr=0,ma=0,$p=0,Pn=0,To=0,uc=null,wn=null,Fp=!1,Nh=0,r_=0,Ch=1/0,Rh=null,sr=null,Bt=0,ir=null,Eo=null,_i=0,Gp=0,Kp=null,a_=null,hc=0,Yp=null;function Mn(){return(Je&2)!==0&&Be!==0?Be&-Be:B.T!==null?eg():Iu()}function o_(){if(Pn===0)if((Be&536870912)===0||Fe){var s=qr;qr<<=1,(qr&3932160)===0&&(qr=262144),Pn=s}else Pn=536870912;return s=On.current,s!==null&&(s.flags|=32),Pn}function xn(s,r,o){(s===at&&(et===2||et===9)||s.cancelPendingCommit!==null)&&(So(s,0),rr(s,Be,Pn,!1)),$r(s,o),((Je&2)===0||s!==at)&&(s===at&&((Je&2)===0&&(ma|=o),vt===4&&rr(s,Be,Pn,!1)),Fs(s))}function l_(s,r,o){if((Je&6)!==0)throw Error(i(327));var u=!o&&(r&127)===0&&(r&s.expiredLanes)===0||is(s,r),p=u?IA(s,r):Qp(s,r,!0),y=u;do{if(p===0){xo&&!u&&rr(s,r,0,!1);break}else{if(o=s.current.alternate,y&&!CA(o)){p=Qp(s,r,!1),y=!1;continue}if(p===2){if(y=r,s.errorRecoveryDisabledLanes&y)var b=0;else b=s.pendingLanes&-536870913,b=b!==0?b:b&536870912?536870912:0;if(b!==0){r=b;e:{var E=s;p=uc;var P=E.current.memoizedState.isDehydrated;if(P&&(So(E,b).flags|=256),b=Qp(E,b,!1),b!==2){if(qp&&!P){E.errorRecoveryDisabledLanes|=y,ma|=y,p=4;break e}y=wn,wn=p,y!==null&&(wn===null?wn=y:wn.push.apply(wn,y))}p=b}if(y=!1,p!==2)continue}}if(p===1){So(s,0),rr(s,r,0,!0);break}e:{switch(u=s,y=p,y){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:rr(u,r,Pn,!tr);break e;case 2:wn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(p=Nh+300-dn(),10<p)){if(rr(u,r,Pn,!tr),Ns(u,0,!0)!==0)break e;_i=r,u.timeoutHandle=V_(c_.bind(null,u,o,wn,Rh,Fp,r,Pn,ma,To,tr,y,"Throttled",-0,0),p);break e}c_(u,o,wn,Rh,Fp,r,Pn,ma,To,tr,y,null,-0,0)}}break}while(!0);Fs(s)}function c_(s,r,o,u,p,y,b,E,P,W,ne,re,J,ee){if(s.timeoutHandle=-1,re=r.subtreeFlags,re&8192||(re&16785408)===16785408){re={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:os},t_(r,y,re);var _e=(y&62914560)===y?Nh-dn():(y&4194048)===y?r_-dn():0;if(_e=d2(re,_e),_e!==null){_i=y,s.cancelPendingCommit=_e(y_.bind(null,s,r,y,o,u,p,b,E,P,ne,re,null,J,ee)),rr(s,y,b,!W);return}}y_(s,r,y,o,u,p,b,E,P)}function CA(s){for(var r=s;;){var o=r.tag;if((o===0||o===11||o===15)&&r.flags&16384&&(o=r.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var u=0;u<o.length;u++){var p=o[u],y=p.getSnapshot;p=p.value;try{if(!In(y(),p))return!1}catch{return!1}}if(o=r.child,r.subtreeFlags&16384&&o!==null)o.return=r,r=o;else{if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function rr(s,r,o,u){r&=~$p,r&=~ma,s.suspendedLanes|=r,s.pingedLanes&=~r,u&&(s.warmLanes|=r),u=s.expirationTimes;for(var p=r;0<p;){var y=31-bt(p),b=1<<y;u[y]=-1,p&=~b}o!==0&&Fr(s,o,r)}function Ih(){return(Je&6)===0?(dc(0),!1):!0}function Wp(){if(Ue!==null){if(et===0)var s=Ue.return;else s=Ue,li=oa=null,hp(s),go=null,Yl=0,s=Ue;for(;s!==null;)Bv(s.alternate,s),s=s.return;Ue=null}}function So(s,r){var o=s.timeoutHandle;o!==-1&&(s.timeoutHandle=-1,YA(o)),o=s.cancelPendingCommit,o!==null&&(s.cancelPendingCommit=null,o()),_i=0,Wp(),at=s,Ue=o=ai(s.current,null),Be=r,et=0,Dn=null,tr=!1,xo=is(s,r),qp=!1,To=Pn=$p=ma=nr=vt=0,wn=uc=null,Fp=!1,(r&8)!==0&&(r|=r&32);var u=s.entangledLanes;if(u!==0)for(s=s.entanglements,u&=r;0<u;){var p=31-bt(u),y=1<<p;r|=s[p],u&=~y}return vi=r,Ju(),o}function u_(s,r){Pe=null,B.H=nc,r===po||r===rh?(r=Ay(),et=3):r===Zf?(r=Ay(),et=4):et=r===Np?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Dn=r,Ue===null&&(vt=1,_h(s,Gn(r,s.current)))}function h_(){var s=On.current;return s===null?!0:(Be&4194048)===Be?Qn===null:(Be&62914560)===Be||(Be&536870912)!==0?s===Qn:!1}function d_(){var s=B.H;return B.H=nc,s===null?nc:s}function f_(){var s=B.A;return B.A=AA,s}function kh(){vt=4,tr||(Be&4194048)!==Be&&On.current!==null||(xo=!0),(nr&134217727)===0&&(ma&134217727)===0||at===null||rr(at,Be,Pn,!1)}function Qp(s,r,o){var u=Je;Je|=2;var p=d_(),y=f_();(at!==s||Be!==r)&&(Rh=null,So(s,r)),r=!1;var b=vt;e:do try{if(et!==0&&Ue!==null){var E=Ue,P=Dn;switch(et){case 8:Wp(),b=6;break e;case 3:case 2:case 9:case 6:On.current===null&&(r=!0);var W=et;if(et=0,Dn=null,Ao(s,E,P,W),o&&xo){b=0;break e}break;default:W=et,et=0,Dn=null,Ao(s,E,P,W)}}RA(),b=vt;break}catch(ne){u_(s,ne)}while(!0);return r&&s.shellSuspendCounter++,li=oa=null,Je=u,B.H=p,B.A=y,Ue===null&&(at=null,Be=0,Ju()),b}function RA(){for(;Ue!==null;)p_(Ue)}function IA(s,r){var o=Je;Je|=2;var u=d_(),p=f_();at!==s||Be!==r?(Rh=null,Ch=dn()+500,So(s,r)):xo=is(s,r);e:do try{if(et!==0&&Ue!==null){r=Ue;var y=Dn;t:switch(et){case 1:et=0,Dn=null,Ao(s,r,y,1);break;case 2:case 9:if(Ey(y)){et=0,Dn=null,g_(r);break}r=function(){et!==2&&et!==9||at!==s||(et=7),Fs(s)},y.then(r,r);break e;case 3:et=7;break e;case 4:et=5;break e;case 7:Ey(y)?(et=0,Dn=null,g_(r)):(et=0,Dn=null,Ao(s,r,y,7));break;case 5:var b=null;switch(Ue.tag){case 26:b=Ue.memoizedState;case 5:case 27:var E=Ue;if(b?eb(b):E.stateNode.complete){et=0,Dn=null;var P=E.sibling;if(P!==null)Ue=P;else{var W=E.return;W!==null?(Ue=W,Oh(W)):Ue=null}break t}}et=0,Dn=null,Ao(s,r,y,5);break;case 6:et=0,Dn=null,Ao(s,r,y,6);break;case 8:Wp(),vt=6;break e;default:throw Error(i(462))}}kA();break}catch(ne){u_(s,ne)}while(!0);return li=oa=null,B.H=u,B.A=p,Je=o,Ue!==null?0:(at=null,Be=0,Ju(),vt)}function kA(){for(;Ue!==null&&!Af();)p_(Ue)}function p_(s){var r=Uv(s.alternate,s,vi);s.memoizedProps=s.pendingProps,r===null?Oh(s):Ue=r}function g_(s){var r=s,o=r.alternate;switch(r.tag){case 15:case 0:r=Ov(o,r,r.pendingProps,r.type,void 0,Be);break;case 11:r=Ov(o,r,r.pendingProps,r.type.render,r.ref,Be);break;case 5:hp(r);default:Bv(o,r),r=Ue=fy(r,vi),r=Uv(o,r,vi)}s.memoizedProps=s.pendingProps,r===null?Oh(s):Ue=r}function Ao(s,r,o,u){li=oa=null,hp(r),go=null,Yl=0;var p=r.return;try{if(_A(s,p,r,o,Be)){vt=1,_h(s,Gn(o,s.current)),Ue=null;return}}catch(y){if(p!==null)throw Ue=p,y;vt=1,_h(s,Gn(o,s.current)),Ue=null;return}r.flags&32768?(Fe||u===1?s=!0:xo||(Be&536870912)!==0?s=!1:(tr=s=!0,(u===2||u===9||u===3||u===6)&&(u=On.current,u!==null&&u.tag===13&&(u.flags|=16384))),m_(r,s)):Oh(r)}function Oh(s){var r=s;do{if((r.flags&32768)!==0){m_(r,tr);return}s=r.return;var o=xA(r.alternate,r,vi);if(o!==null){Ue=o;return}if(r=r.sibling,r!==null){Ue=r;return}Ue=r=s}while(r!==null);vt===0&&(vt=5)}function m_(s,r){do{var o=TA(s.alternate,s);if(o!==null){o.flags&=32767,Ue=o;return}if(o=s.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!r&&(s=s.sibling,s!==null)){Ue=s;return}Ue=s=o}while(s!==null);vt=6,Ue=null}function y_(s,r,o,u,p,y,b,E,P){s.cancelPendingCommit=null;do jh();while(Bt!==0);if((Je&6)!==0)throw Error(i(327));if(r!==null){if(r===s.current)throw Error(i(177));if(y=r.lanes|r.childLanes,y|=Uf,Rf(s,o,y,b,E,P),s===at&&(Ue=at=null,Be=0),Eo=r,ir=s,_i=o,Gp=y,Kp=p,a_=u,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,PA(Pi,function(){return x_(),null})):(s.callbackNode=null,s.callbackPriority=0),u=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||u){u=B.T,B.T=null,p=se.p,se.p=2,b=Je,Je|=4;try{EA(s,r,o)}finally{Je=b,se.p=p,B.T=u}}Bt=1,v_(),__(),b_()}}function v_(){if(Bt===1){Bt=0;var s=ir,r=Eo,o=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||o){o=B.T,B.T=null;var u=se.p;se.p=2;var p=Je;Je|=4;try{Xv(r,s);var y=lg,b=iy(s.containerInfo),E=y.focusedElem,P=y.selectionRange;if(b!==E&&E&&E.ownerDocument&&sy(E.ownerDocument.documentElement,E)){if(P!==null&&jf(E)){var W=P.start,ne=P.end;if(ne===void 0&&(ne=W),"selectionStart"in E)E.selectionStart=W,E.selectionEnd=Math.min(ne,E.value.length);else{var re=E.ownerDocument||document,J=re&&re.defaultView||window;if(J.getSelection){var ee=J.getSelection(),_e=E.textContent.length,Ae=Math.min(P.start,_e),rt=P.end===void 0?Ae:Math.min(P.end,_e);!ee.extend&&Ae>rt&&(b=rt,rt=Ae,Ae=b);var G=ny(E,Ae),H=ny(E,rt);if(G&&H&&(ee.rangeCount!==1||ee.anchorNode!==G.node||ee.anchorOffset!==G.offset||ee.focusNode!==H.node||ee.focusOffset!==H.offset)){var Y=re.createRange();Y.setStart(G.node,G.offset),ee.removeAllRanges(),Ae>rt?(ee.addRange(Y),ee.extend(H.node,H.offset)):(Y.setEnd(H.node,H.offset),ee.addRange(Y))}}}}for(re=[],ee=E;ee=ee.parentNode;)ee.nodeType===1&&re.push({element:ee,left:ee.scrollLeft,top:ee.scrollTop});for(typeof E.focus=="function"&&E.focus(),E=0;E<re.length;E++){var ie=re[E];ie.element.scrollLeft=ie.left,ie.element.scrollTop=ie.top}}Fh=!!og,lg=og=null}finally{Je=p,se.p=u,B.T=o}}s.current=r,Bt=2}}function __(){if(Bt===2){Bt=0;var s=ir,r=Eo,o=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||o){o=B.T,B.T=null;var u=se.p;se.p=2;var p=Je;Je|=4;try{Kv(s,r.alternate,r)}finally{Je=p,se.p=u,B.T=o}}Bt=3}}function b_(){if(Bt===4||Bt===3){Bt=0,Tu();var s=ir,r=Eo,o=_i,u=a_;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Bt=5:(Bt=0,Eo=ir=null,w_(s,s.pendingLanes));var p=s.pendingLanes;if(p===0&&(sr=null),ni(o),r=r.stateNode,Yt&&typeof Yt.onCommitFiberRoot=="function")try{Yt.onCommitFiberRoot(ss,r,void 0,(r.current.flags&128)===128)}catch{}if(u!==null){r=B.T,p=se.p,se.p=2,B.T=null;try{for(var y=s.onRecoverableError,b=0;b<u.length;b++){var E=u[b];y(E.value,{componentStack:E.stack})}}finally{B.T=r,se.p=p}}(_i&3)!==0&&jh(),Fs(s),p=s.pendingLanes,(o&261930)!==0&&(p&42)!==0?s===Yp?hc++:(hc=0,Yp=s):hc=0,dc(0)}}function w_(s,r){(s.pooledCacheLanes&=r)===0&&(r=s.pooledCache,r!=null&&(s.pooledCache=null,Gl(r)))}function jh(){return v_(),__(),b_(),x_()}function x_(){if(Bt!==5)return!1;var s=ir,r=Gp;Gp=0;var o=ni(_i),u=B.T,p=se.p;try{se.p=32>o?32:o,B.T=null,o=Kp,Kp=null;var y=ir,b=_i;if(Bt=0,Eo=ir=null,_i=0,(Je&6)!==0)throw Error(i(331));var E=Je;if(Je|=4,s_(y.current),e_(y,y.current,b,o),Je=E,dc(0,!1),Yt&&typeof Yt.onPostCommitFiberRoot=="function")try{Yt.onPostCommitFiberRoot(ss,y)}catch{}return!0}finally{se.p=p,B.T=u,w_(s,r)}}function T_(s,r,o){r=Gn(o,r),r=Ap(s.stateNode,r,2),s=Ji(s,r,2),s!==null&&($r(s,2),Fs(s))}function tt(s,r,o){if(s.tag===3)T_(s,s,o);else for(;r!==null;){if(r.tag===3){T_(r,s,o);break}else if(r.tag===1){var u=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(sr===null||!sr.has(u))){s=Gn(o,s),o=Ev(2),u=Ji(r,o,2),u!==null&&(Sv(o,u,r,s),$r(u,2),Fs(u));break}}r=r.return}}function Jp(s,r,o){var u=s.pingCache;if(u===null){u=s.pingCache=new NA;var p=new Set;u.set(r,p)}else p=u.get(r),p===void 0&&(p=new Set,u.set(r,p));p.has(o)||(qp=!0,p.add(o),s=OA.bind(null,s,r,o),r.then(s,s))}function OA(s,r,o){var u=s.pingCache;u!==null&&u.delete(r),s.pingedLanes|=s.suspendedLanes&o,s.warmLanes&=~o,at===s&&(Be&o)===o&&(vt===4||vt===3&&(Be&62914560)===Be&&300>dn()-Nh?(Je&2)===0&&So(s,0):$p|=o,To===Be&&(To=0)),Fs(s)}function E_(s,r){r===0&&(r=Ru()),s=ia(s,r),s!==null&&($r(s,r),Fs(s))}function jA(s){var r=s.memoizedState,o=0;r!==null&&(o=r.retryLane),E_(s,o)}function DA(s,r){var o=0;switch(s.tag){case 31:case 13:var u=s.stateNode,p=s.memoizedState;p!==null&&(o=p.retryLane);break;case 19:u=s.stateNode;break;case 22:u=s.stateNode._retryCache;break;default:throw Error(i(314))}u!==null&&u.delete(r),E_(s,o)}function PA(s,r){return Vt(s,r)}var Dh=null,No=null,Xp=!1,Ph=!1,Zp=!1,ar=0;function Fs(s){s!==No&&s.next===null&&(No===null?Dh=No=s:No=No.next=s),Ph=!0,Xp||(Xp=!0,LA())}function dc(s,r){if(!Zp&&Ph){Zp=!0;do for(var o=!1,u=Dh;u!==null;){if(s!==0){var p=u.pendingLanes;if(p===0)var y=0;else{var b=u.suspendedLanes,E=u.pingedLanes;y=(1<<31-bt(42|s)+1)-1,y&=p&~(b&~E),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(o=!0,C_(u,y))}else y=Be,y=Ns(u,u===at?y:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(y&3)===0||is(u,y)||(o=!0,C_(u,y));u=u.next}while(o);Zp=!1}}function MA(){S_()}function S_(){Ph=Xp=!1;var s=0;ar!==0&&KA()&&(s=ar);for(var r=dn(),o=null,u=Dh;u!==null;){var p=u.next,y=A_(u,r);y===0?(u.next=null,o===null?Dh=p:o.next=p,p===null&&(No=o)):(o=u,(s!==0||(y&3)!==0)&&(Ph=!0)),u=p}Bt!==0&&Bt!==5||dc(s),ar!==0&&(ar=0)}function A_(s,r){for(var o=s.suspendedLanes,u=s.pingedLanes,p=s.expirationTimes,y=s.pendingLanes&-62914561;0<y;){var b=31-bt(y),E=1<<b,P=p[b];P===-1?((E&o)===0||(E&u)!==0)&&(p[b]=Cf(E,r)):P<=r&&(s.expiredLanes|=E),y&=~E}if(r=at,o=Be,o=Ns(s,s===r?o:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u=s.callbackNode,o===0||s===r&&(et===2||et===9)||s.cancelPendingCommit!==null)return u!==null&&u!==null&&Di(u),s.callbackNode=null,s.callbackPriority=0;if((o&3)===0||is(s,o)){if(r=o&-o,r===s.callbackPriority)return r;switch(u!==null&&Di(u),ni(o)){case 2:case 8:o=xl;break;case 32:o=Pi;break;case 268435456:o=Eu;break;default:o=Pi}return u=N_.bind(null,s),o=Vt(o,u),s.callbackPriority=r,s.callbackNode=o,r}return u!==null&&u!==null&&Di(u),s.callbackPriority=2,s.callbackNode=null,2}function N_(s,r){if(Bt!==0&&Bt!==5)return s.callbackNode=null,s.callbackPriority=0,null;var o=s.callbackNode;if(jh()&&s.callbackNode!==o)return null;var u=Be;return u=Ns(s,s===at?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u===0?null:(l_(s,u,r),A_(s,dn()),s.callbackNode!=null&&s.callbackNode===o?N_.bind(null,s):null)}function C_(s,r){if(jh())return null;l_(s,r,!0)}function LA(){WA(function(){(Je&6)!==0?Vt(wl,MA):S_()})}function eg(){if(ar===0){var s=ho;s===0&&(s=Ss,Ss<<=1,(Ss&261888)===0&&(Ss=256)),ar=s}return ar}function R_(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Qa(""+s)}function I_(s,r){var o=r.ownerDocument.createElement("input");return o.name=r.name,o.value=r.value,s.id&&o.setAttribute("form",s.id),r.parentNode.insertBefore(o,r),s=new FormData(s),o.parentNode.removeChild(o),s}function UA(s,r,o,u,p){if(r==="submit"&&o&&o.stateNode===p){var y=R_((p[$t]||null).action),b=u.submitter;b&&(r=(r=b[$t]||null)?R_(r.formAction):b.getAttribute("formAction"),r!==null&&(y=r,b=null));var E=new Us("action","action",null,u,p);s.push({event:E,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(ar!==0){var P=b?I_(p,b):new FormData(p);bp(o,{pending:!0,data:P,method:p.method,action:y},null,P)}}else typeof y=="function"&&(E.preventDefault(),P=b?I_(p,b):new FormData(p),bp(o,{pending:!0,data:P,method:p.method,action:y},y,P))},currentTarget:p}]})}}for(var tg=0;tg<Lf.length;tg++){var ng=Lf[tg],VA=ng.toLowerCase(),BA=ng[0].toUpperCase()+ng.slice(1);ds(VA,"on"+BA)}ds(oy,"onAnimationEnd"),ds(ly,"onAnimationIteration"),ds(cy,"onAnimationStart"),ds("dblclick","onDoubleClick"),ds("focusin","onFocus"),ds("focusout","onBlur"),ds(nA,"onTransitionRun"),ds(sA,"onTransitionStart"),ds(iA,"onTransitionCancel"),ds(uy,"onTransitionEnd"),Ds("onMouseEnter",["mouseout","mouseover"]),Ds("onMouseLeave",["mouseout","mouseover"]),Ds("onPointerEnter",["pointerout","pointerover"]),Ds("onPointerLeave",["pointerout","pointerover"]),js("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),js("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),js("onBeforeInput",["compositionend","keypress","textInput","paste"]),js("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),js("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),js("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(fc));function k_(s,r){r=(r&4)!==0;for(var o=0;o<s.length;o++){var u=s[o],p=u.event;u=u.listeners;e:{var y=void 0;if(r)for(var b=u.length-1;0<=b;b--){var E=u[b],P=E.instance,W=E.currentTarget;if(E=E.listener,P!==y&&p.isPropagationStopped())break e;y=E,p.currentTarget=W;try{y(p)}catch(ne){Qu(ne)}p.currentTarget=null,y=P}else for(b=0;b<u.length;b++){if(E=u[b],P=E.instance,W=E.currentTarget,E=E.listener,P!==y&&p.isPropagationStopped())break e;y=E,p.currentTarget=W;try{y(p)}catch(ne){Qu(ne)}p.currentTarget=null,y=P}}}}function Ve(s,r){var o=r[Fa];o===void 0&&(o=r[Fa]=new Set);var u=s+"__bubble";o.has(u)||(O_(r,s,2,!1),o.add(u))}function sg(s,r,o){var u=0;r&&(u|=4),O_(o,s,u,r)}var Mh="_reactListening"+Math.random().toString(36).slice(2);function ig(s){if(!s[Mh]){s[Mh]=!0,Sl.forEach(function(o){o!=="selectionchange"&&(zA.has(o)||sg(o,!1,s),sg(o,!0,s))});var r=s.nodeType===9?s:s.ownerDocument;r===null||r[Mh]||(r[Mh]=!0,sg("selectionchange",!1,r))}}function O_(s,r,o,u){switch(ob(r)){case 2:var p=g2;break;case 8:p=m2;break;default:p=_g}o=p.bind(null,r,o,s),p=void 0,!Qr||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(p=!0),u?p!==void 0?s.addEventListener(r,o,{capture:!0,passive:p}):s.addEventListener(r,o,!0):p!==void 0?s.addEventListener(r,o,{passive:p}):s.addEventListener(r,o,!1)}function rg(s,r,o,u,p){var y=u;if((r&1)===0&&(r&2)===0&&u!==null)e:for(;;){if(u===null)return;var b=u.tag;if(b===3||b===4){var E=u.stateNode.containerInfo;if(E===p)break;if(b===4)for(b=u.return;b!==null;){var P=b.tag;if((P===3||P===4)&&b.stateNode.containerInfo===p)return;b=b.return}for(;E!==null;){if(b=ks(E),b===null)return;if(P=b.tag,P===5||P===6||P===26||P===27){u=y=b;continue e}E=E.parentNode}}u=u.return}zi(function(){var W=y,ne=Hn(o),re=[];e:{var J=hy.get(s);if(J!==void 0){var ee=Us,_e=s;switch(s){case"keypress":if(Xr(o)===0)break e;case"keydown":case"keyup":ee=Ku;break;case"focusin":_e="focus",ee=ea;break;case"focusout":_e="blur",ee=ea;break;case"beforeblur":case"afterblur":ee=ea;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ee=Ul;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ee=Uu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ee=v;break;case oy:case ly:case cy:ee=Bu;break;case uy:ee=C;break;case"scroll":case"scrollend":ee=Ll;break;case"wheel":ee=Z;break;case"copy":case"cut":case"paste":ee=zu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ee=ri;break;case"toggle":case"beforetoggle":ee=De}var Ae=(r&4)!==0,rt=!Ae&&(s==="scroll"||s==="scrollend"),G=Ae?J!==null?J+"Capture":null:J;Ae=[];for(var H=W,Y;H!==null;){var ie=H;if(Y=ie.stateNode,ie=ie.tag,ie!==5&&ie!==26&&ie!==27||Y===null||G===null||(ie=ls(H,G),ie!=null&&Ae.push(pc(H,ie,Y))),rt)break;H=H.return}0<Ae.length&&(J=new ee(J,_e,null,o,ne),re.push({event:J,listeners:Ae}))}}if((r&7)===0){e:{if(J=s==="mouseover"||s==="pointerover",ee=s==="mouseout"||s==="pointerout",J&&o!==Dl&&(_e=o.relatedTarget||o.fromElement)&&(ks(_e)||_e[Rs]))break e;if((ee||J)&&(J=ne.window===ne?ne:(J=ne.ownerDocument)?J.defaultView||J.parentWindow:window,ee?(_e=o.relatedTarget||o.toElement,ee=W,_e=_e?ks(_e):null,_e!==null&&(rt=l(_e),Ae=_e.tag,_e!==rt||Ae!==5&&Ae!==27&&Ae!==6)&&(_e=null)):(ee=null,_e=W),ee!==_e)){if(Ae=Ul,ie="onMouseLeave",G="onMouseEnter",H="mouse",(s==="pointerout"||s==="pointerover")&&(Ae=ri,ie="onPointerLeave",G="onPointerEnter",H="pointer"),rt=ee==null?J:Cn(ee),Y=_e==null?J:Cn(_e),J=new Ae(ie,H+"leave",ee,o,ne),J.target=rt,J.relatedTarget=Y,ie=null,ks(ne)===W&&(Ae=new Ae(G,H+"enter",_e,o,ne),Ae.target=Y,Ae.relatedTarget=rt,ie=Ae),rt=ie,ee&&_e)t:{for(Ae=HA,G=ee,H=_e,Y=0,ie=G;ie;ie=Ae(ie))Y++;ie=0;for(var Te=H;Te;Te=Ae(Te))ie++;for(;0<Y-ie;)G=Ae(G),Y--;for(;0<ie-Y;)H=Ae(H),ie--;for(;Y--;){if(G===H||H!==null&&G===H.alternate){Ae=G;break t}G=Ae(G),H=Ae(H)}Ae=null}else Ae=null;ee!==null&&j_(re,J,ee,Ae,!1),_e!==null&&rt!==null&&j_(re,rt,_e,Ae,!0)}}e:{if(J=W?Cn(W):window,ee=J.nodeName&&J.nodeName.toLowerCase(),ee==="select"||ee==="input"&&J.type==="file")var Ye=Q0;else if(Y0(J))if(J0)Ye=ZS;else{Ye=JS;var we=QS}else ee=J.nodeName,!ee||ee.toLowerCase()!=="input"||J.type!=="checkbox"&&J.type!=="radio"?W&&Wa(W.elementType)&&(Ye=Q0):Ye=XS;if(Ye&&(Ye=Ye(s,W))){W0(re,Ye,o,ne);break e}we&&we(s,J,W),s==="focusout"&&W&&J.type==="number"&&W.memoizedProps.value!=null&&kl(J,"number",J.value)}switch(we=W?Cn(W):window,s){case"focusin":(Y0(we)||we.contentEditable==="true")&&(so=we,Df=W,ql=null);break;case"focusout":ql=Df=so=null;break;case"mousedown":Pf=!0;break;case"contextmenu":case"mouseup":case"dragend":Pf=!1,ry(re,o,ne);break;case"selectionchange":if(tA)break;case"keydown":case"keyup":ry(re,o,ne)}var Me;if(Qe)e:{switch(s){case"compositionstart":var ze="onCompositionStart";break e;case"compositionend":ze="onCompositionEnd";break e;case"compositionupdate":ze="onCompositionUpdate";break e}ze=void 0}else no?ta(s,o)&&(ze="onCompositionEnd"):s==="keydown"&&o.keyCode===229&&(ze="onCompositionStart");ze&&(zs&&o.locale!=="ko"&&(no||ze!=="onCompositionStart"?ze==="onCompositionEnd"&&no&&(Me=Ml()):(Ls=ne,Pl="value"in Ls?Ls.value:Ls.textContent,no=!0)),we=Lh(W,ze),0<we.length&&(ze=new Bs(ze,s,null,o,ne),re.push({event:ze,listeners:we}),Me?ze.data=Me:(Me=to(o),Me!==null&&(ze.data=Me)))),(Me=$n?GS(s,o):KS(s,o))&&(ze=Lh(W,"onBeforeInput"),0<ze.length&&(we=new Bs("onBeforeInput","beforeinput",null,o,ne),re.push({event:we,listeners:ze}),we.data=Me)),UA(re,s,W,o,ne)}k_(re,r)})}function pc(s,r,o){return{instance:s,listener:r,currentTarget:o}}function Lh(s,r){for(var o=r+"Capture",u=[];s!==null;){var p=s,y=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||y===null||(p=ls(s,o),p!=null&&u.unshift(pc(s,p,y)),p=ls(s,r),p!=null&&u.push(pc(s,p,y))),s.tag===3)return u;s=s.return}return[]}function HA(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function j_(s,r,o,u,p){for(var y=r._reactName,b=[];o!==null&&o!==u;){var E=o,P=E.alternate,W=E.stateNode;if(E=E.tag,P!==null&&P===u)break;E!==5&&E!==26&&E!==27||W===null||(P=W,p?(W=ls(o,y),W!=null&&b.unshift(pc(o,W,P))):p||(W=ls(o,y),W!=null&&b.push(pc(o,W,P)))),o=o.return}b.length!==0&&s.push({event:r,listeners:b})}var qA=/\r\n?/g,$A=/\u0000|\uFFFD/g;function D_(s){return(typeof s=="string"?s:""+s).replace(qA,`
`).replace($A,"")}function P_(s,r){return r=D_(r),D_(s)===r}function it(s,r,o,u,p,y){switch(o){case"children":typeof u=="string"?r==="body"||r==="textarea"&&u===""||yn(s,u):(typeof u=="number"||typeof u=="bigint")&&r!=="body"&&yn(s,""+u);break;case"className":Rn(s,"class",u);break;case"tabIndex":Rn(s,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Rn(s,o,u);break;case"style":jl(s,u,y);break;case"data":if(r!=="object"){Rn(s,"data",u);break}case"src":case"href":if(u===""&&(r!=="a"||o!=="href")){s.removeAttribute(o);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(o);break}u=Qa(""+u),s.setAttribute(o,u);break;case"action":case"formAction":if(typeof u=="function"){s.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(o==="formAction"?(r!=="input"&&it(s,r,"name",p.name,p,null),it(s,r,"formEncType",p.formEncType,p,null),it(s,r,"formMethod",p.formMethod,p,null),it(s,r,"formTarget",p.formTarget,p,null)):(it(s,r,"encType",p.encType,p,null),it(s,r,"method",p.method,p,null),it(s,r,"target",p.target,p,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(o);break}u=Qa(""+u),s.setAttribute(o,u);break;case"onClick":u!=null&&(s.onclick=os);break;case"onScroll":u!=null&&Ve("scroll",s);break;case"onScrollEnd":u!=null&&Ve("scrollend",s);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(o=u.__html,o!=null){if(p.children!=null)throw Error(i(60));s.innerHTML=o}}break;case"multiple":s.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":s.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){s.removeAttribute("xlink:href");break}o=Qa(""+u),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(o,""+u):s.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(o,""):s.removeAttribute(o);break;case"capture":case"download":u===!0?s.setAttribute(o,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(o,u):s.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?s.setAttribute(o,u):s.removeAttribute(o);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?s.removeAttribute(o):s.setAttribute(o,u);break;case"popover":Ve("beforetoggle",s),Ve("toggle",s),Ka(s,"popover",u);break;case"xlinkActuate":It(s,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":It(s,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":It(s,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":It(s,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":It(s,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":It(s,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":It(s,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":It(s,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":It(s,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Ka(s,"is",u);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Lu.get(o)||o,Ka(s,o,u))}}function ag(s,r,o,u,p,y){switch(o){case"style":jl(s,u,y);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(o=u.__html,o!=null){if(p.children!=null)throw Error(i(60));s.innerHTML=o}}break;case"children":typeof u=="string"?yn(s,u):(typeof u=="number"||typeof u=="bigint")&&yn(s,""+u);break;case"onScroll":u!=null&&Ve("scroll",s);break;case"onScrollEnd":u!=null&&Ve("scrollend",s);break;case"onClick":u!=null&&(s.onclick=os);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Al.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(p=o.endsWith("Capture"),r=o.slice(2,p?o.length-7:void 0),y=s[$t]||null,y=y!=null?y[o]:null,typeof y=="function"&&s.removeEventListener(r,y,p),typeof u=="function")){typeof y!="function"&&y!==null&&(o in s?s[o]=null:s.hasAttribute(o)&&s.removeAttribute(o)),s.addEventListener(r,u,p);break e}o in s?s[o]=u:u===!0?s.setAttribute(o,""):Ka(s,o,u)}}}function Zt(s,r,o){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ve("error",s),Ve("load",s);var u=!1,p=!1,y;for(y in o)if(o.hasOwnProperty(y)){var b=o[y];if(b!=null)switch(y){case"src":u=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:it(s,r,y,b,o,null)}}p&&it(s,r,"srcSet",o.srcSet,o,null),u&&it(s,r,"src",o.src,o,null);return;case"input":Ve("invalid",s);var E=y=b=p=null,P=null,W=null;for(u in o)if(o.hasOwnProperty(u)){var ne=o[u];if(ne!=null)switch(u){case"name":p=ne;break;case"type":b=ne;break;case"checked":P=ne;break;case"defaultChecked":W=ne;break;case"value":y=ne;break;case"defaultValue":E=ne;break;case"children":case"dangerouslySetInnerHTML":if(ne!=null)throw Error(i(137,r));break;default:it(s,r,u,ne,o,null)}}Du(s,y,E,P,W,b,p,!1);return;case"select":Ve("invalid",s),u=b=y=null;for(p in o)if(o.hasOwnProperty(p)&&(E=o[p],E!=null))switch(p){case"value":y=E;break;case"defaultValue":b=E;break;case"multiple":u=E;default:it(s,r,p,E,o,null)}r=y,o=b,s.multiple=!!u,r!=null?Li(s,!!u,r,!1):o!=null&&Li(s,!!u,o,!0);return;case"textarea":Ve("invalid",s),y=p=u=null;for(b in o)if(o.hasOwnProperty(b)&&(E=o[b],E!=null))switch(b){case"value":u=E;break;case"defaultValue":p=E;break;case"children":y=E;break;case"dangerouslySetInnerHTML":if(E!=null)throw Error(i(91));break;default:it(s,r,b,E,o,null)}Ui(s,u,p,y);return;case"option":for(P in o)if(o.hasOwnProperty(P)&&(u=o[P],u!=null))switch(P){case"selected":s.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:it(s,r,P,u,o,null)}return;case"dialog":Ve("beforetoggle",s),Ve("toggle",s),Ve("cancel",s),Ve("close",s);break;case"iframe":case"object":Ve("load",s);break;case"video":case"audio":for(u=0;u<fc.length;u++)Ve(fc[u],s);break;case"image":Ve("error",s),Ve("load",s);break;case"details":Ve("toggle",s);break;case"embed":case"source":case"link":Ve("error",s),Ve("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(W in o)if(o.hasOwnProperty(W)&&(u=o[W],u!=null))switch(W){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:it(s,r,W,u,o,null)}return;default:if(Wa(r)){for(ne in o)o.hasOwnProperty(ne)&&(u=o[ne],u!==void 0&&ag(s,r,ne,u,o,void 0));return}}for(E in o)o.hasOwnProperty(E)&&(u=o[E],u!=null&&it(s,r,E,u,o,null))}function FA(s,r,o,u){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,y=null,b=null,E=null,P=null,W=null,ne=null;for(ee in o){var re=o[ee];if(o.hasOwnProperty(ee)&&re!=null)switch(ee){case"checked":break;case"value":break;case"defaultValue":P=re;default:u.hasOwnProperty(ee)||it(s,r,ee,null,u,re)}}for(var J in u){var ee=u[J];if(re=o[J],u.hasOwnProperty(J)&&(ee!=null||re!=null))switch(J){case"type":y=ee;break;case"name":p=ee;break;case"checked":W=ee;break;case"defaultChecked":ne=ee;break;case"value":b=ee;break;case"defaultValue":E=ee;break;case"children":case"dangerouslySetInnerHTML":if(ee!=null)throw Error(i(137,r));break;default:ee!==re&&it(s,r,J,ee,u,re)}}Ya(s,b,E,P,W,ne,y,p);return;case"select":ee=b=E=J=null;for(y in o)if(P=o[y],o.hasOwnProperty(y)&&P!=null)switch(y){case"value":break;case"multiple":ee=P;default:u.hasOwnProperty(y)||it(s,r,y,null,u,P)}for(p in u)if(y=u[p],P=o[p],u.hasOwnProperty(p)&&(y!=null||P!=null))switch(p){case"value":J=y;break;case"defaultValue":E=y;break;case"multiple":b=y;default:y!==P&&it(s,r,p,y,u,P)}r=E,o=b,u=ee,J!=null?Li(s,!!o,J,!1):!!u!=!!o&&(r!=null?Li(s,!!o,r,!0):Li(s,!!o,o?[]:"",!1));return;case"textarea":ee=J=null;for(E in o)if(p=o[E],o.hasOwnProperty(E)&&p!=null&&!u.hasOwnProperty(E))switch(E){case"value":break;case"children":break;default:it(s,r,E,null,u,p)}for(b in u)if(p=u[b],y=o[b],u.hasOwnProperty(b)&&(p!=null||y!=null))switch(b){case"value":J=p;break;case"defaultValue":ee=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(i(91));break;default:p!==y&&it(s,r,b,p,u,y)}Pu(s,J,ee);return;case"option":for(var _e in o)if(J=o[_e],o.hasOwnProperty(_e)&&J!=null&&!u.hasOwnProperty(_e))switch(_e){case"selected":s.selected=!1;break;default:it(s,r,_e,null,u,J)}for(P in u)if(J=u[P],ee=o[P],u.hasOwnProperty(P)&&J!==ee&&(J!=null||ee!=null))switch(P){case"selected":s.selected=J&&typeof J!="function"&&typeof J!="symbol";break;default:it(s,r,P,J,u,ee)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ae in o)J=o[Ae],o.hasOwnProperty(Ae)&&J!=null&&!u.hasOwnProperty(Ae)&&it(s,r,Ae,null,u,J);for(W in u)if(J=u[W],ee=o[W],u.hasOwnProperty(W)&&J!==ee&&(J!=null||ee!=null))switch(W){case"children":case"dangerouslySetInnerHTML":if(J!=null)throw Error(i(137,r));break;default:it(s,r,W,J,u,ee)}return;default:if(Wa(r)){for(var rt in o)J=o[rt],o.hasOwnProperty(rt)&&J!==void 0&&!u.hasOwnProperty(rt)&&ag(s,r,rt,void 0,u,J);for(ne in u)J=u[ne],ee=o[ne],!u.hasOwnProperty(ne)||J===ee||J===void 0&&ee===void 0||ag(s,r,ne,J,u,ee);return}}for(var G in o)J=o[G],o.hasOwnProperty(G)&&J!=null&&!u.hasOwnProperty(G)&&it(s,r,G,null,u,J);for(re in u)J=u[re],ee=o[re],!u.hasOwnProperty(re)||J===ee||J==null&&ee==null||it(s,r,re,J,u,ee)}function M_(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function GA(){if(typeof performance.getEntriesByType=="function"){for(var s=0,r=0,o=performance.getEntriesByType("resource"),u=0;u<o.length;u++){var p=o[u],y=p.transferSize,b=p.initiatorType,E=p.duration;if(y&&E&&M_(b)){for(b=0,E=p.responseEnd,u+=1;u<o.length;u++){var P=o[u],W=P.startTime;if(W>E)break;var ne=P.transferSize,re=P.initiatorType;ne&&M_(re)&&(P=P.responseEnd,b+=ne*(P<E?1:(E-W)/(P-W)))}if(--u,r+=8*(y+b)/(p.duration/1e3),s++,10<s)break}}if(0<s)return r/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var og=null,lg=null;function Uh(s){return s.nodeType===9?s:s.ownerDocument}function L_(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function U_(s,r){if(s===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&r==="foreignObject"?0:s}function cg(s,r){return s==="textarea"||s==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var ug=null;function KA(){var s=window.event;return s&&s.type==="popstate"?s===ug?!1:(ug=s,!0):(ug=null,!1)}var V_=typeof setTimeout=="function"?setTimeout:void 0,YA=typeof clearTimeout=="function"?clearTimeout:void 0,B_=typeof Promise=="function"?Promise:void 0,WA=typeof queueMicrotask=="function"?queueMicrotask:typeof B_<"u"?function(s){return B_.resolve(null).then(s).catch(QA)}:V_;function QA(s){setTimeout(function(){throw s})}function or(s){return s==="head"}function z_(s,r){var o=r,u=0;do{var p=o.nextSibling;if(s.removeChild(o),p&&p.nodeType===8)if(o=p.data,o==="/$"||o==="/&"){if(u===0){s.removeChild(p),ko(r);return}u--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")u++;else if(o==="html")gc(s.ownerDocument.documentElement);else if(o==="head"){o=s.ownerDocument.head,gc(o);for(var y=o.firstChild;y;){var b=y.nextSibling,E=y.nodeName;y[Is]||E==="SCRIPT"||E==="STYLE"||E==="LINK"&&y.rel.toLowerCase()==="stylesheet"||o.removeChild(y),y=b}}else o==="body"&&gc(s.ownerDocument.body);o=p}while(o);ko(r)}function H_(s,r){var o=s;s=0;do{var u=o.nextSibling;if(o.nodeType===1?r?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(r?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),u&&u.nodeType===8)if(o=u.data,o==="/$"){if(s===0)break;s--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||s++;o=u}while(o)}function hg(s){var r=s.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var o=r;switch(r=r.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":hg(o),Ga(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}s.removeChild(o)}}function JA(s,r,o,u){for(;s.nodeType===1;){var p=o;if(s.nodeName.toLowerCase()!==r.toLowerCase()){if(!u&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(u){if(!s[Is])switch(r){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(y=s.getAttribute("rel"),y==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(y!==p.rel||s.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||s.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||s.getAttribute("title")!==(p.title==null?null:p.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(y=s.getAttribute("src"),(y!==(p.src==null?null:p.src)||s.getAttribute("type")!==(p.type==null?null:p.type)||s.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&y&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(r==="input"&&s.type==="hidden"){var y=p.name==null?null:""+p.name;if(p.type==="hidden"&&s.getAttribute("name")===y)return s}else return s;if(s=Jn(s.nextSibling),s===null)break}return null}function XA(s,r,o){if(r==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!o||(s=Jn(s.nextSibling),s===null))return null;return s}function q_(s,r){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!r||(s=Jn(s.nextSibling),s===null))return null;return s}function dg(s){return s.data==="$?"||s.data==="$~"}function fg(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function ZA(s,r){var o=s.ownerDocument;if(s.data==="$~")s._reactRetry=r;else if(s.data!=="$?"||o.readyState!=="loading")r();else{var u=function(){r(),o.removeEventListener("DOMContentLoaded",u)};o.addEventListener("DOMContentLoaded",u),s._reactRetry=u}}function Jn(s){for(;s!=null;s=s.nextSibling){var r=s.nodeType;if(r===1||r===3)break;if(r===8){if(r=s.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return s}var pg=null;function $_(s){s=s.nextSibling;for(var r=0;s;){if(s.nodeType===8){var o=s.data;if(o==="/$"||o==="/&"){if(r===0)return Jn(s.nextSibling);r--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||r++}s=s.nextSibling}return null}function F_(s){s=s.previousSibling;for(var r=0;s;){if(s.nodeType===8){var o=s.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(r===0)return s;r--}else o!=="/$"&&o!=="/&"||r++}s=s.previousSibling}return null}function G_(s,r,o){switch(r=Uh(o),s){case"html":if(s=r.documentElement,!s)throw Error(i(452));return s;case"head":if(s=r.head,!s)throw Error(i(453));return s;case"body":if(s=r.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function gc(s){for(var r=s.attributes;r.length;)s.removeAttributeNode(r[0]);Ga(s)}var Xn=new Map,K_=new Set;function Vh(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var bi=se.d;se.d={f:e2,r:t2,D:n2,C:s2,L:i2,m:r2,X:o2,S:a2,M:l2};function e2(){var s=bi.f(),r=Ih();return s||r}function t2(s){var r=zn(s);r!==null&&r.tag===5&&r.type==="form"?uv(r):bi.r(s)}var Co=typeof document>"u"?null:document;function Y_(s,r,o){var u=Co;if(u&&typeof r=="string"&&r){var p=mn(r);p='link[rel="'+s+'"][href="'+p+'"]',typeof o=="string"&&(p+='[crossorigin="'+o+'"]'),K_.has(p)||(K_.add(p),s={rel:s,crossOrigin:o,href:r},u.querySelector(p)===null&&(r=u.createElement("link"),Zt(r,"link",s),Rt(r),u.head.appendChild(r)))}}function n2(s){bi.D(s),Y_("dns-prefetch",s,null)}function s2(s,r){bi.C(s,r),Y_("preconnect",s,r)}function i2(s,r,o){bi.L(s,r,o);var u=Co;if(u&&s&&r){var p='link[rel="preload"][as="'+mn(r)+'"]';r==="image"&&o&&o.imageSrcSet?(p+='[imagesrcset="'+mn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(p+='[imagesizes="'+mn(o.imageSizes)+'"]')):p+='[href="'+mn(s)+'"]';var y=p;switch(r){case"style":y=Ro(s);break;case"script":y=Io(s)}Xn.has(y)||(s=w({rel:"preload",href:r==="image"&&o&&o.imageSrcSet?void 0:s,as:r},o),Xn.set(y,s),u.querySelector(p)!==null||r==="style"&&u.querySelector(mc(y))||r==="script"&&u.querySelector(yc(y))||(r=u.createElement("link"),Zt(r,"link",s),Rt(r),u.head.appendChild(r)))}}function r2(s,r){bi.m(s,r);var o=Co;if(o&&s){var u=r&&typeof r.as=="string"?r.as:"script",p='link[rel="modulepreload"][as="'+mn(u)+'"][href="'+mn(s)+'"]',y=p;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=Io(s)}if(!Xn.has(y)&&(s=w({rel:"modulepreload",href:s},r),Xn.set(y,s),o.querySelector(p)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(yc(y)))return}u=o.createElement("link"),Zt(u,"link",s),Rt(u),o.head.appendChild(u)}}}function a2(s,r,o){bi.S(s,r,o);var u=Co;if(u&&s){var p=Os(u).hoistableStyles,y=Ro(s);r=r||"default";var b=p.get(y);if(!b){var E={loading:0,preload:null};if(b=u.querySelector(mc(y)))E.loading=5;else{s=w({rel:"stylesheet",href:s,"data-precedence":r},o),(o=Xn.get(y))&&gg(s,o);var P=b=u.createElement("link");Rt(P),Zt(P,"link",s),P._p=new Promise(function(W,ne){P.onload=W,P.onerror=ne}),P.addEventListener("load",function(){E.loading|=1}),P.addEventListener("error",function(){E.loading|=2}),E.loading|=4,Bh(b,r,u)}b={type:"stylesheet",instance:b,count:1,state:E},p.set(y,b)}}}function o2(s,r){bi.X(s,r);var o=Co;if(o&&s){var u=Os(o).hoistableScripts,p=Io(s),y=u.get(p);y||(y=o.querySelector(yc(p)),y||(s=w({src:s,async:!0},r),(r=Xn.get(p))&&mg(s,r),y=o.createElement("script"),Rt(y),Zt(y,"link",s),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},u.set(p,y))}}function l2(s,r){bi.M(s,r);var o=Co;if(o&&s){var u=Os(o).hoistableScripts,p=Io(s),y=u.get(p);y||(y=o.querySelector(yc(p)),y||(s=w({src:s,async:!0,type:"module"},r),(r=Xn.get(p))&&mg(s,r),y=o.createElement("script"),Rt(y),Zt(y,"link",s),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},u.set(p,y))}}function W_(s,r,o,u){var p=(p=X.current)?Vh(p):null;if(!p)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(r=Ro(o.href),o=Os(p).hoistableStyles,u=o.get(r),u||(u={type:"style",instance:null,count:0,state:null},o.set(r,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){s=Ro(o.href);var y=Os(p).hoistableStyles,b=y.get(s);if(b||(p=p.ownerDocument||p,b={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(s,b),(y=p.querySelector(mc(s)))&&!y._p&&(b.instance=y,b.state.loading=5),Xn.has(s)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},Xn.set(s,o),y||c2(p,s,o,b.state))),r&&u===null)throw Error(i(528,""));return b}if(r&&u!==null)throw Error(i(529,""));return null;case"script":return r=o.async,o=o.src,typeof o=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=Io(o),o=Os(p).hoistableScripts,u=o.get(r),u||(u={type:"script",instance:null,count:0,state:null},o.set(r,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function Ro(s){return'href="'+mn(s)+'"'}function mc(s){return'link[rel="stylesheet"]['+s+"]"}function Q_(s){return w({},s,{"data-precedence":s.precedence,precedence:null})}function c2(s,r,o,u){s.querySelector('link[rel="preload"][as="style"]['+r+"]")?u.loading=1:(r=s.createElement("link"),u.preload=r,r.addEventListener("load",function(){return u.loading|=1}),r.addEventListener("error",function(){return u.loading|=2}),Zt(r,"link",o),Rt(r),s.head.appendChild(r))}function Io(s){return'[src="'+mn(s)+'"]'}function yc(s){return"script[async]"+s}function J_(s,r,o){if(r.count++,r.instance===null)switch(r.type){case"style":var u=s.querySelector('style[data-href~="'+mn(o.href)+'"]');if(u)return r.instance=u,Rt(u),u;var p=w({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return u=(s.ownerDocument||s).createElement("style"),Rt(u),Zt(u,"style",p),Bh(u,o.precedence,s),r.instance=u;case"stylesheet":p=Ro(o.href);var y=s.querySelector(mc(p));if(y)return r.state.loading|=4,r.instance=y,Rt(y),y;u=Q_(o),(p=Xn.get(p))&&gg(u,p),y=(s.ownerDocument||s).createElement("link"),Rt(y);var b=y;return b._p=new Promise(function(E,P){b.onload=E,b.onerror=P}),Zt(y,"link",u),r.state.loading|=4,Bh(y,o.precedence,s),r.instance=y;case"script":return y=Io(o.src),(p=s.querySelector(yc(y)))?(r.instance=p,Rt(p),p):(u=o,(p=Xn.get(y))&&(u=w({},o),mg(u,p)),s=s.ownerDocument||s,p=s.createElement("script"),Rt(p),Zt(p,"link",u),s.head.appendChild(p),r.instance=p);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(u=r.instance,r.state.loading|=4,Bh(u,o.precedence,s));return r.instance}function Bh(s,r,o){for(var u=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=u.length?u[u.length-1]:null,y=p,b=0;b<u.length;b++){var E=u[b];if(E.dataset.precedence===r)y=E;else if(y!==p)break}y?y.parentNode.insertBefore(s,y.nextSibling):(r=o.nodeType===9?o.head:o,r.insertBefore(s,r.firstChild))}function gg(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.title==null&&(s.title=r.title)}function mg(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.integrity==null&&(s.integrity=r.integrity)}var zh=null;function X_(s,r,o){if(zh===null){var u=new Map,p=zh=new Map;p.set(o,u)}else p=zh,u=p.get(o),u||(u=new Map,p.set(o,u));if(u.has(s))return u;for(u.set(s,null),o=o.getElementsByTagName(s),p=0;p<o.length;p++){var y=o[p];if(!(y[Is]||y[Ct]||s==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var b=y.getAttribute(r)||"";b=s+b;var E=u.get(b);E?E.push(y):u.set(b,[y])}}return u}function Z_(s,r,o){s=s.ownerDocument||s,s.head.insertBefore(o,r==="title"?s.querySelector("head > title"):null)}function u2(s,r,o){if(o===1||r.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;switch(r.rel){case"stylesheet":return s=r.disabled,typeof r.precedence=="string"&&s==null;default:return!0}case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function eb(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function h2(s,r,o,u){if(o.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var p=Ro(u.href),y=r.querySelector(mc(p));if(y){r=y._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(s.count++,s=Hh.bind(s),r.then(s,s)),o.state.loading|=4,o.instance=y,Rt(y);return}y=r.ownerDocument||r,u=Q_(u),(p=Xn.get(p))&&gg(u,p),y=y.createElement("link"),Rt(y);var b=y;b._p=new Promise(function(E,P){b.onload=E,b.onerror=P}),Zt(y,"link",u),o.instance=y}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(o,r),(r=o.state.preload)&&(o.state.loading&3)===0&&(s.count++,o=Hh.bind(s),r.addEventListener("load",o),r.addEventListener("error",o))}}var yg=0;function d2(s,r){return s.stylesheets&&s.count===0&&$h(s,s.stylesheets),0<s.count||0<s.imgCount?function(o){var u=setTimeout(function(){if(s.stylesheets&&$h(s,s.stylesheets),s.unsuspend){var y=s.unsuspend;s.unsuspend=null,y()}},6e4+r);0<s.imgBytes&&yg===0&&(yg=62500*GA());var p=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&$h(s,s.stylesheets),s.unsuspend)){var y=s.unsuspend;s.unsuspend=null,y()}},(s.imgBytes>yg?50:800)+r);return s.unsuspend=o,function(){s.unsuspend=null,clearTimeout(u),clearTimeout(p)}}:null}function Hh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)$h(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var qh=null;function $h(s,r){s.stylesheets=null,s.unsuspend!==null&&(s.count++,qh=new Map,r.forEach(f2,s),qh=null,Hh.call(s))}function f2(s,r){if(!(r.state.loading&4)){var o=qh.get(s);if(o)var u=o.get(null);else{o=new Map,qh.set(s,o);for(var p=s.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<p.length;y++){var b=p[y];(b.nodeName==="LINK"||b.getAttribute("media")!=="not all")&&(o.set(b.dataset.precedence,b),u=b)}u&&o.set(null,u)}p=r.instance,b=p.getAttribute("data-precedence"),y=o.get(b)||u,y===u&&o.set(null,p),o.set(b,p),this.count++,u=Hh.bind(this),p.addEventListener("load",u),p.addEventListener("error",u),y?y.parentNode.insertBefore(p,y.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(p,s.firstChild)),r.state.loading|=4}}var vc={$$typeof:z,Provider:null,Consumer:null,_currentValue:ge,_currentValue2:ge,_threadCount:0};function p2(s,r,o,u,p,y,b,E,P){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Cs(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Cs(0),this.hiddenUpdates=Cs(null),this.identifierPrefix=u,this.onUncaughtError=p,this.onCaughtError=y,this.onRecoverableError=b,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=P,this.incompleteTransitions=new Map}function tb(s,r,o,u,p,y,b,E,P,W,ne,re){return s=new p2(s,r,o,b,P,W,ne,re,E),r=1,y===!0&&(r|=24),y=kn(3,null,null,r),s.current=y,y.stateNode=s,r=Qf(),r.refCount++,s.pooledCache=r,r.refCount++,y.memoizedState={element:u,isDehydrated:o,cache:r},ep(y),s}function nb(s){return s?(s=ao,s):ao}function sb(s,r,o,u,p,y){p=nb(p),u.context===null?u.context=p:u.pendingContext=p,u=Qi(r),u.payload={element:o},y=y===void 0?null:y,y!==null&&(u.callback=y),o=Ji(s,u,r),o!==null&&(xn(o,s,r),Ql(o,s,r))}function ib(s,r){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var o=s.retryLane;s.retryLane=o!==0&&o<r?o:r}}function vg(s,r){ib(s,r),(s=s.alternate)&&ib(s,r)}function rb(s){if(s.tag===13||s.tag===31){var r=ia(s,67108864);r!==null&&xn(r,s,67108864),vg(s,67108864)}}function ab(s){if(s.tag===13||s.tag===31){var r=Mn();r=Gr(r);var o=ia(s,r);o!==null&&xn(o,s,r),vg(s,r)}}var Fh=!0;function g2(s,r,o,u){var p=B.T;B.T=null;var y=se.p;try{se.p=2,_g(s,r,o,u)}finally{se.p=y,B.T=p}}function m2(s,r,o,u){var p=B.T;B.T=null;var y=se.p;try{se.p=8,_g(s,r,o,u)}finally{se.p=y,B.T=p}}function _g(s,r,o,u){if(Fh){var p=bg(u);if(p===null)rg(s,r,u,Gh,o),lb(s,u);else if(v2(p,s,r,o,u))u.stopPropagation();else if(lb(s,u),r&4&&-1<y2.indexOf(s)){for(;p!==null;){var y=zn(p);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var b=As(y.pendingLanes);if(b!==0){var E=y;for(E.pendingLanes|=2,E.entangledLanes|=2;b;){var P=1<<31-bt(b);E.entanglements[1]|=P,b&=~P}Fs(y),(Je&6)===0&&(Ch=dn()+500,dc(0))}}break;case 31:case 13:E=ia(y,2),E!==null&&xn(E,y,2),Ih(),vg(y,2)}if(y=bg(u),y===null&&rg(s,r,u,Gh,o),y===p)break;p=y}p!==null&&u.stopPropagation()}else rg(s,r,u,null,o)}}function bg(s){return s=Hn(s),wg(s)}var Gh=null;function wg(s){if(Gh=null,s=ks(s),s!==null){var r=l(s);if(r===null)s=null;else{var o=r.tag;if(o===13){if(s=c(r),s!==null)return s;s=null}else if(o===31){if(s=d(r),s!==null)return s;s=null}else if(o===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;s=null}else r!==s&&(s=null)}}return Gh=s,null}function ob(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Hr()){case wl:return 2;case xl:return 8;case Pi:case Nf:return 32;case Eu:return 268435456;default:return 32}default:return 32}}var xg=!1,lr=null,cr=null,ur=null,_c=new Map,bc=new Map,hr=[],y2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function lb(s,r){switch(s){case"focusin":case"focusout":lr=null;break;case"dragenter":case"dragleave":cr=null;break;case"mouseover":case"mouseout":ur=null;break;case"pointerover":case"pointerout":_c.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":bc.delete(r.pointerId)}}function wc(s,r,o,u,p,y){return s===null||s.nativeEvent!==y?(s={blockedOn:r,domEventName:o,eventSystemFlags:u,nativeEvent:y,targetContainers:[p]},r!==null&&(r=zn(r),r!==null&&rb(r)),s):(s.eventSystemFlags|=u,r=s.targetContainers,p!==null&&r.indexOf(p)===-1&&r.push(p),s)}function v2(s,r,o,u,p){switch(r){case"focusin":return lr=wc(lr,s,r,o,u,p),!0;case"dragenter":return cr=wc(cr,s,r,o,u,p),!0;case"mouseover":return ur=wc(ur,s,r,o,u,p),!0;case"pointerover":var y=p.pointerId;return _c.set(y,wc(_c.get(y)||null,s,r,o,u,p)),!0;case"gotpointercapture":return y=p.pointerId,bc.set(y,wc(bc.get(y)||null,s,r,o,u,p)),!0}return!1}function cb(s){var r=ks(s.target);if(r!==null){var o=l(r);if(o!==null){if(r=o.tag,r===13){if(r=c(o),r!==null){s.blockedOn=r,rs(s.priority,function(){ab(o)});return}}else if(r===31){if(r=d(o),r!==null){s.blockedOn=r,rs(s.priority,function(){ab(o)});return}}else if(r===3&&o.stateNode.current.memoizedState.isDehydrated){s.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Kh(s){if(s.blockedOn!==null)return!1;for(var r=s.targetContainers;0<r.length;){var o=bg(s.nativeEvent);if(o===null){o=s.nativeEvent;var u=new o.constructor(o.type,o);Dl=u,o.target.dispatchEvent(u),Dl=null}else return r=zn(o),r!==null&&rb(r),s.blockedOn=o,!1;r.shift()}return!0}function ub(s,r,o){Kh(s)&&o.delete(r)}function _2(){xg=!1,lr!==null&&Kh(lr)&&(lr=null),cr!==null&&Kh(cr)&&(cr=null),ur!==null&&Kh(ur)&&(ur=null),_c.forEach(ub),bc.forEach(ub)}function Yh(s,r){s.blockedOn===r&&(s.blockedOn=null,xg||(xg=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,_2)))}var Wh=null;function hb(s){Wh!==s&&(Wh=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Wh===s&&(Wh=null);for(var r=0;r<s.length;r+=3){var o=s[r],u=s[r+1],p=s[r+2];if(typeof u!="function"){if(wg(u||o)===null)continue;break}var y=zn(o);y!==null&&(s.splice(r,3),r-=3,bp(y,{pending:!0,data:p,method:o.method,action:u},u,p))}}))}function ko(s){function r(P){return Yh(P,s)}lr!==null&&Yh(lr,s),cr!==null&&Yh(cr,s),ur!==null&&Yh(ur,s),_c.forEach(r),bc.forEach(r);for(var o=0;o<hr.length;o++){var u=hr[o];u.blockedOn===s&&(u.blockedOn=null)}for(;0<hr.length&&(o=hr[0],o.blockedOn===null);)cb(o),o.blockedOn===null&&hr.shift();if(o=(s.ownerDocument||s).$$reactFormReplay,o!=null)for(u=0;u<o.length;u+=3){var p=o[u],y=o[u+1],b=p[$t]||null;if(typeof y=="function")b||hb(o);else if(b){var E=null;if(y&&y.hasAttribute("formAction")){if(p=y,b=y[$t]||null)E=b.formAction;else if(wg(p)!==null)continue}else E=b.action;typeof E=="function"?o[u+1]=E:(o.splice(u,3),u-=3),hb(o)}}}function db(){function s(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(b){return p=b})},focusReset:"manual",scroll:"manual"})}function r(){p!==null&&(p(),p=null),u||setTimeout(o,20)}function o(){if(!u&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,p=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(o,100),function(){u=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),p!==null&&(p(),p=null)}}}function Tg(s){this._internalRoot=s}Qh.prototype.render=Tg.prototype.render=function(s){var r=this._internalRoot;if(r===null)throw Error(i(409));var o=r.current,u=Mn();sb(o,u,s,r,null,null)},Qh.prototype.unmount=Tg.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var r=s.containerInfo;sb(s.current,2,null,s,null,null),Ih(),r[Rs]=null}};function Qh(s){this._internalRoot=s}Qh.prototype.unstable_scheduleHydration=function(s){if(s){var r=Iu();s={blockedOn:null,target:s,priority:r};for(var o=0;o<hr.length&&r!==0&&r<hr[o].priority;o++);hr.splice(o,0,s),o===0&&cb(s)}};var fb=e.version;if(fb!=="19.2.3")throw Error(i(527,fb,"19.2.3"));se.findDOMNode=function(s){var r=s._reactInternals;if(r===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=m(r),s=s!==null?_(s):null,s=s===null?null:s.stateNode,s};var b2={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:B,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Jh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Jh.isDisabled&&Jh.supportsFiber)try{ss=Jh.inject(b2),Yt=Jh}catch{}}return Tc.createRoot=function(s,r){if(!a(s))throw Error(i(299));var o=!1,u="",p=bv,y=wv,b=xv;return r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(u=r.identifierPrefix),r.onUncaughtError!==void 0&&(p=r.onUncaughtError),r.onCaughtError!==void 0&&(y=r.onCaughtError),r.onRecoverableError!==void 0&&(b=r.onRecoverableError)),r=tb(s,1,!1,null,null,o,u,null,p,y,b,db),s[Rs]=r.current,ig(s),new Tg(r)},Tc.hydrateRoot=function(s,r,o){if(!a(s))throw Error(i(299));var u=!1,p="",y=bv,b=wv,E=xv,P=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(p=o.identifierPrefix),o.onUncaughtError!==void 0&&(y=o.onUncaughtError),o.onCaughtError!==void 0&&(b=o.onCaughtError),o.onRecoverableError!==void 0&&(E=o.onRecoverableError),o.formState!==void 0&&(P=o.formState)),r=tb(s,1,!0,r,o??null,u,p,P,y,b,E,db),r.context=nb(null),o=r.current,u=Mn(),u=Gr(u),p=Qi(u),p.callback=null,Ji(o,p,u),o=u,r.current.lanes=o,$r(r,o),Fs(r),s[Rs]=r.current,ig(s),new Qh(r)},Tc.version="19.2.3",Tc}var Tb;function I2(){if(Tb)return Ag.exports;Tb=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Ag.exports=R2(),Ag.exports}var k2=I2();const O2=hT(k2);var Gs;(function(n){n.STRING="string",n.NUMBER="number",n.INTEGER="integer",n.BOOLEAN="boolean",n.ARRAY="array",n.OBJECT="object"})(Gs||(Gs={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Eb;(function(n){n.LANGUAGE_UNSPECIFIED="language_unspecified",n.PYTHON="python"})(Eb||(Eb={}));var Sb;(function(n){n.OUTCOME_UNSPECIFIED="outcome_unspecified",n.OUTCOME_OK="outcome_ok",n.OUTCOME_FAILED="outcome_failed",n.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"})(Sb||(Sb={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ab=["user","model","function","system"];var Nb;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(Nb||(Nb={}));var Cb;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(Cb||(Cb={}));var Rb;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(Rb||(Rb={}));var Ib;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER"})(Ib||(Ib={}));var Pc;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.OTHER="OTHER"})(Pc||(Pc={}));var kb;(function(n){n.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",n.RETRIEVAL_QUERY="RETRIEVAL_QUERY",n.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",n.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",n.CLASSIFICATION="CLASSIFICATION",n.CLUSTERING="CLUSTERING"})(kb||(kb={}));var Ob;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE"})(Ob||(Ob={}));var jb;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(jb||(jb={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un extends Error{constructor(e){super(`[GoogleGenerativeAI Error]: ${e}`)}}class Oo extends un{constructor(e,t){super(e),this.response=t}}class dT extends un{constructor(e,t,i,a){super(e),this.status=t,this.statusText=i,this.errorDetails=a}}class xr extends un{}class fT extends un{}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j2="https://generativelanguage.googleapis.com",D2="v1beta",P2="0.24.1",M2="genai-js";var Ra;(function(n){n.GENERATE_CONTENT="generateContent",n.STREAM_GENERATE_CONTENT="streamGenerateContent",n.COUNT_TOKENS="countTokens",n.EMBED_CONTENT="embedContent",n.BATCH_EMBED_CONTENTS="batchEmbedContents"})(Ra||(Ra={}));class L2{constructor(e,t,i,a,l){this.model=e,this.task=t,this.apiKey=i,this.stream=a,this.requestOptions=l}toString(){var e,t;const i=((e=this.requestOptions)===null||e===void 0?void 0:e.apiVersion)||D2;let l=`${((t=this.requestOptions)===null||t===void 0?void 0:t.baseUrl)||j2}/${i}/${this.model}:${this.task}`;return this.stream&&(l+="?alt=sse"),l}}function U2(n){const e=[];return n!=null&&n.apiClient&&e.push(n.apiClient),e.push(`${M2}/${P2}`),e.join(" ")}async function V2(n){var e;const t=new Headers;t.append("Content-Type","application/json"),t.append("x-goog-api-client",U2(n.requestOptions)),t.append("x-goog-api-key",n.apiKey);let i=(e=n.requestOptions)===null||e===void 0?void 0:e.customHeaders;if(i){if(!(i instanceof Headers))try{i=new Headers(i)}catch(a){throw new xr(`unable to convert customHeaders value ${JSON.stringify(i)} to Headers: ${a.message}`)}for(const[a,l]of i.entries()){if(a==="x-goog-api-key")throw new xr(`Cannot set reserved header name ${a}`);if(a==="x-goog-api-client")throw new xr(`Header name ${a} can only be set using the apiClient field`);t.append(a,l)}}return t}async function B2(n,e,t,i,a,l){const c=new L2(n,e,t,i,l);return{url:c.toString(),fetchOptions:Object.assign(Object.assign({},$2(l)),{method:"POST",headers:await V2(c),body:a})}}async function ou(n,e,t,i,a,l={},c=fetch){const{url:d,fetchOptions:g}=await B2(n,e,t,i,a,l);return z2(d,g,c)}async function z2(n,e,t=fetch){let i;try{i=await t(n,e)}catch(a){H2(a,n)}return i.ok||await q2(i,n),i}function H2(n,e){let t=n;throw t.name==="AbortError"?(t=new fT(`Request aborted when fetching ${e.toString()}: ${n.message}`),t.stack=n.stack):n instanceof dT||n instanceof xr||(t=new un(`Error fetching from ${e.toString()}: ${n.message}`),t.stack=n.stack),t}async function q2(n,e){let t="",i;try{const a=await n.json();t=a.error.message,a.error.details&&(t+=` ${JSON.stringify(a.error.details)}`,i=a.error.details)}catch{}throw new dT(`Error fetching from ${e.toString()}: [${n.status} ${n.statusText}] ${t}`,n.status,n.statusText,i)}function $2(n){const e={};if((n==null?void 0:n.signal)!==void 0||(n==null?void 0:n.timeout)>=0){const t=new AbortController;(n==null?void 0:n.timeout)>=0&&setTimeout(()=>t.abort(),n.timeout),n!=null&&n.signal&&n.signal.addEventListener("abort",()=>{t.abort()}),e.signal=t.signal}return e}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Km(n){return n.text=()=>{if(n.candidates&&n.candidates.length>0){if(n.candidates.length>1&&console.warn(`This response had ${n.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),dd(n.candidates[0]))throw new Oo(`${pr(n)}`,n);return F2(n)}else if(n.promptFeedback)throw new Oo(`Text not available. ${pr(n)}`,n);return""},n.functionCall=()=>{if(n.candidates&&n.candidates.length>0){if(n.candidates.length>1&&console.warn(`This response had ${n.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),dd(n.candidates[0]))throw new Oo(`${pr(n)}`,n);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),Db(n)[0]}else if(n.promptFeedback)throw new Oo(`Function call not available. ${pr(n)}`,n)},n.functionCalls=()=>{if(n.candidates&&n.candidates.length>0){if(n.candidates.length>1&&console.warn(`This response had ${n.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),dd(n.candidates[0]))throw new Oo(`${pr(n)}`,n);return Db(n)}else if(n.promptFeedback)throw new Oo(`Function call not available. ${pr(n)}`,n)},n}function F2(n){var e,t,i,a;const l=[];if(!((t=(e=n.candidates)===null||e===void 0?void 0:e[0].content)===null||t===void 0)&&t.parts)for(const c of(a=(i=n.candidates)===null||i===void 0?void 0:i[0].content)===null||a===void 0?void 0:a.parts)c.text&&l.push(c.text),c.executableCode&&l.push("\n```"+c.executableCode.language+`
`+c.executableCode.code+"\n```\n"),c.codeExecutionResult&&l.push("\n```\n"+c.codeExecutionResult.output+"\n```\n");return l.length>0?l.join(""):""}function Db(n){var e,t,i,a;const l=[];if(!((t=(e=n.candidates)===null||e===void 0?void 0:e[0].content)===null||t===void 0)&&t.parts)for(const c of(a=(i=n.candidates)===null||i===void 0?void 0:i[0].content)===null||a===void 0?void 0:a.parts)c.functionCall&&l.push(c.functionCall);if(l.length>0)return l}const G2=[Pc.RECITATION,Pc.SAFETY,Pc.LANGUAGE];function dd(n){return!!n.finishReason&&G2.includes(n.finishReason)}function pr(n){var e,t,i;let a="";if((!n.candidates||n.candidates.length===0)&&n.promptFeedback)a+="Response was blocked",!((e=n.promptFeedback)===null||e===void 0)&&e.blockReason&&(a+=` due to ${n.promptFeedback.blockReason}`),!((t=n.promptFeedback)===null||t===void 0)&&t.blockReasonMessage&&(a+=`: ${n.promptFeedback.blockReasonMessage}`);else if(!((i=n.candidates)===null||i===void 0)&&i[0]){const l=n.candidates[0];dd(l)&&(a+=`Candidate was blocked due to ${l.finishReason}`,l.finishMessage&&(a+=`: ${l.finishMessage}`))}return a}function Fc(n){return this instanceof Fc?(this.v=n,this):new Fc(n)}function K2(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),a,l=[];return a={},c("next"),c("throw"),c("return"),a[Symbol.asyncIterator]=function(){return this},a;function c(x){i[x]&&(a[x]=function(S){return new Promise(function(A,D){l.push([x,S,A,D])>1||d(x,S)})})}function d(x,S){try{g(i[x](S))}catch(A){w(l[0][3],A)}}function g(x){x.value instanceof Fc?Promise.resolve(x.value.v).then(m,_):w(l[0][2],x)}function m(x){d("next",x)}function _(x){d("throw",x)}function w(x,S){x(S),l.shift(),l.length&&d(l[0][0],l[0][1])}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pb=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function Y2(n){const e=n.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),t=J2(e),[i,a]=t.tee();return{stream:Q2(i),response:W2(a)}}async function W2(n){const e=[],t=n.getReader();for(;;){const{done:i,value:a}=await t.read();if(i)return Km(X2(e));e.push(a)}}function Q2(n){return K2(this,arguments,function*(){const t=n.getReader();for(;;){const{value:i,done:a}=yield Fc(t.read());if(a)break;yield yield Fc(Km(i))}})}function J2(n){const e=n.getReader();return new ReadableStream({start(i){let a="";return l();function l(){return e.read().then(({value:c,done:d})=>{if(d){if(a.trim()){i.error(new un("Failed to parse stream"));return}i.close();return}a+=c;let g=a.match(Pb),m;for(;g;){try{m=JSON.parse(g[1])}catch{i.error(new un(`Error parsing JSON response: "${g[1]}"`));return}i.enqueue(m),a=a.substring(g[0].length),g=a.match(Pb)}return l()}).catch(c=>{let d=c;throw d.stack=c.stack,d.name==="AbortError"?d=new fT("Request aborted when reading from the stream"):d=new un("Error reading from the stream"),d})}}})}function X2(n){const e=n[n.length-1],t={promptFeedback:e==null?void 0:e.promptFeedback};for(const i of n){if(i.candidates){let a=0;for(const l of i.candidates)if(t.candidates||(t.candidates=[]),t.candidates[a]||(t.candidates[a]={index:a}),t.candidates[a].citationMetadata=l.citationMetadata,t.candidates[a].groundingMetadata=l.groundingMetadata,t.candidates[a].finishReason=l.finishReason,t.candidates[a].finishMessage=l.finishMessage,t.candidates[a].safetyRatings=l.safetyRatings,l.content&&l.content.parts){t.candidates[a].content||(t.candidates[a].content={role:l.content.role||"user",parts:[]});const c={};for(const d of l.content.parts)d.text&&(c.text=d.text),d.functionCall&&(c.functionCall=d.functionCall),d.executableCode&&(c.executableCode=d.executableCode),d.codeExecutionResult&&(c.codeExecutionResult=d.codeExecutionResult),Object.keys(c).length===0&&(c.text=""),t.candidates[a].content.parts.push(c)}a++}i.usageMetadata&&(t.usageMetadata=i.usageMetadata)}return t}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pT(n,e,t,i){const a=await ou(e,Ra.STREAM_GENERATE_CONTENT,n,!0,JSON.stringify(t),i);return Y2(a)}async function gT(n,e,t,i){const l=await(await ou(e,Ra.GENERATE_CONTENT,n,!1,JSON.stringify(t),i)).json();return{response:Km(l)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mT(n){if(n!=null){if(typeof n=="string")return{role:"system",parts:[{text:n}]};if(n.text)return{role:"system",parts:[n]};if(n.parts)return n.role?n:{role:"system",parts:n.parts}}}function Gc(n){let e=[];if(typeof n=="string")e=[{text:n}];else for(const t of n)typeof t=="string"?e.push({text:t}):e.push(t);return Z2(e)}function Z2(n){const e={role:"user",parts:[]},t={role:"function",parts:[]};let i=!1,a=!1;for(const l of n)"functionResponse"in l?(t.parts.push(l),a=!0):(e.parts.push(l),i=!0);if(i&&a)throw new un("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!i&&!a)throw new un("No content is provided for sending chat message.");return i?e:t}function eN(n,e){var t;let i={model:e==null?void 0:e.model,generationConfig:e==null?void 0:e.generationConfig,safetySettings:e==null?void 0:e.safetySettings,tools:e==null?void 0:e.tools,toolConfig:e==null?void 0:e.toolConfig,systemInstruction:e==null?void 0:e.systemInstruction,cachedContent:(t=e==null?void 0:e.cachedContent)===null||t===void 0?void 0:t.name,contents:[]};const a=n.generateContentRequest!=null;if(n.contents){if(a)throw new xr("CountTokensRequest must have one of contents or generateContentRequest, not both.");i.contents=n.contents}else if(a)i=Object.assign(Object.assign({},i),n.generateContentRequest);else{const l=Gc(n);i.contents=[l]}return{generateContentRequest:i}}function Mb(n){let e;return n.contents?e=n:e={contents:[Gc(n)]},n.systemInstruction&&(e.systemInstruction=mT(n.systemInstruction)),e}function tN(n){return typeof n=="string"||Array.isArray(n)?{content:Gc(n)}:n}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lb=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],nN={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function sN(n){let e=!1;for(const t of n){const{role:i,parts:a}=t;if(!e&&i!=="user")throw new un(`First content should be with role 'user', got ${i}`);if(!Ab.includes(i))throw new un(`Each item should include role field. Got ${i} but valid roles are: ${JSON.stringify(Ab)}`);if(!Array.isArray(a))throw new un("Content should have 'parts' property with an array of Parts");if(a.length===0)throw new un("Each Content should have at least one part");const l={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(const d of a)for(const g of Lb)g in d&&(l[g]+=1);const c=nN[i];for(const d of Lb)if(!c.includes(d)&&l[d]>0)throw new un(`Content with role '${i}' can't contain '${d}' part`);e=!0}}function Ub(n){var e;if(n.candidates===void 0||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;if(t===void 0||t.parts===void 0||t.parts.length===0)return!1;for(const i of t.parts)if(i===void 0||Object.keys(i).length===0||i.text!==void 0&&i.text==="")return!1;return!0}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vb="SILENT_ERROR";class iN{constructor(e,t,i,a={}){this.model=t,this.params=i,this._requestOptions=a,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=e,i!=null&&i.history&&(sN(i.history),this._history=i.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(e,t={}){var i,a,l,c,d,g;await this._sendPromise;const m=Gc(e),_={safetySettings:(i=this.params)===null||i===void 0?void 0:i.safetySettings,generationConfig:(a=this.params)===null||a===void 0?void 0:a.generationConfig,tools:(l=this.params)===null||l===void 0?void 0:l.tools,toolConfig:(c=this.params)===null||c===void 0?void 0:c.toolConfig,systemInstruction:(d=this.params)===null||d===void 0?void 0:d.systemInstruction,cachedContent:(g=this.params)===null||g===void 0?void 0:g.cachedContent,contents:[...this._history,m]},w=Object.assign(Object.assign({},this._requestOptions),t);let x;return this._sendPromise=this._sendPromise.then(()=>gT(this._apiKey,this.model,_,w)).then(S=>{var A;if(Ub(S.response)){this._history.push(m);const D=Object.assign({parts:[],role:"model"},(A=S.response.candidates)===null||A===void 0?void 0:A[0].content);this._history.push(D)}else{const D=pr(S.response);D&&console.warn(`sendMessage() was unsuccessful. ${D}. Inspect response object for details.`)}x=S}).catch(S=>{throw this._sendPromise=Promise.resolve(),S}),await this._sendPromise,x}async sendMessageStream(e,t={}){var i,a,l,c,d,g;await this._sendPromise;const m=Gc(e),_={safetySettings:(i=this.params)===null||i===void 0?void 0:i.safetySettings,generationConfig:(a=this.params)===null||a===void 0?void 0:a.generationConfig,tools:(l=this.params)===null||l===void 0?void 0:l.tools,toolConfig:(c=this.params)===null||c===void 0?void 0:c.toolConfig,systemInstruction:(d=this.params)===null||d===void 0?void 0:d.systemInstruction,cachedContent:(g=this.params)===null||g===void 0?void 0:g.cachedContent,contents:[...this._history,m]},w=Object.assign(Object.assign({},this._requestOptions),t),x=pT(this._apiKey,this.model,_,w);return this._sendPromise=this._sendPromise.then(()=>x).catch(S=>{throw new Error(Vb)}).then(S=>S.response).then(S=>{if(Ub(S)){this._history.push(m);const A=Object.assign({},S.candidates[0].content);A.role||(A.role="model"),this._history.push(A)}else{const A=pr(S);A&&console.warn(`sendMessageStream() was unsuccessful. ${A}. Inspect response object for details.`)}}).catch(S=>{S.message!==Vb&&console.error(S)}),x}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rN(n,e,t,i){return(await ou(e,Ra.COUNT_TOKENS,n,!1,JSON.stringify(t),i)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aN(n,e,t,i){return(await ou(e,Ra.EMBED_CONTENT,n,!1,JSON.stringify(t),i)).json()}async function oN(n,e,t,i){const a=t.requests.map(c=>Object.assign(Object.assign({},c),{model:e}));return(await ou(e,Ra.BATCH_EMBED_CONTENTS,n,!1,JSON.stringify({requests:a}),i)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bb{constructor(e,t,i={}){this.apiKey=e,this._requestOptions=i,t.model.includes("/")?this.model=t.model:this.model=`models/${t.model}`,this.generationConfig=t.generationConfig||{},this.safetySettings=t.safetySettings||[],this.tools=t.tools,this.toolConfig=t.toolConfig,this.systemInstruction=mT(t.systemInstruction),this.cachedContent=t.cachedContent}async generateContent(e,t={}){var i;const a=Mb(e),l=Object.assign(Object.assign({},this._requestOptions),t);return gT(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(i=this.cachedContent)===null||i===void 0?void 0:i.name},a),l)}async generateContentStream(e,t={}){var i;const a=Mb(e),l=Object.assign(Object.assign({},this._requestOptions),t);return pT(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(i=this.cachedContent)===null||i===void 0?void 0:i.name},a),l)}startChat(e){var t;return new iN(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(t=this.cachedContent)===null||t===void 0?void 0:t.name},e),this._requestOptions)}async countTokens(e,t={}){const i=eN(e,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),a=Object.assign(Object.assign({},this._requestOptions),t);return rN(this.apiKey,this.model,i,a)}async embedContent(e,t={}){const i=tN(e),a=Object.assign(Object.assign({},this._requestOptions),t);return aN(this.apiKey,this.model,i,a)}async batchEmbedContents(e,t={}){const i=Object.assign(Object.assign({},this._requestOptions),t);return oN(this.apiKey,this.model,e,i)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qd{constructor(e){this.apiKey=e}getGenerativeModel(e,t){if(!e.model)throw new un("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new Bb(this.apiKey,e,t)}getGenerativeModelFromCachedContent(e,t,i){if(!e.name)throw new xr("Cached content must contain a `name` field.");if(!e.model)throw new xr("Cached content must contain a `model` field.");const a=["model","systemInstruction"];for(const c of a)if(t!=null&&t[c]&&e[c]&&(t==null?void 0:t[c])!==e[c]){if(c==="model"){const d=t.model.startsWith("models/")?t.model.replace("models/",""):t.model,g=e.model.startsWith("models/")?e.model.replace("models/",""):e.model;if(d===g)continue}throw new xr(`Different value for "${c}" specified in modelParams (${t[c]}) and cachedContent (${e[c]})`)}const l=Object.assign(Object.assign({},t),{model:e.model,tools:e.tools,toolConfig:e.toolConfig,systemInstruction:e.systemInstruction,cachedContent:e});return new Bb(this.apiKey,l,i)}}const Ig={},lN=["gemini-flash-latest","gemini-1.5-flash","gemini-2.0-flash-lite-preview-02-05","gemini-2.5-flash","gemini-2.0-flash-lite-001","gemini-2.0-flash","gemini-2.5-pro"];let im=[];const rm=n=>{im=n.filter(e=>e.trim()!=="")},cN=n=>{let e=[];n&&(e=n.split(/[\n,]+/).map(i=>i.trim()).filter(i=>i));const t=Ig==null?void 0:Ig.VITE_GEMINI_API_KEY;if(t){const i=t.split(",").map(a=>a.trim()).filter(a=>a);e=[...e,...i]}return im.length>0&&(e=[...e,...im]),[...new Set(e)]},Ma=async(n,e)=>{const t=cN(n);if(t.length===0)throw new Error("No API Keys provided. Please configure VITE_GEMINI_API_KEY or enter a key.");let i;for(const a of t){const l=new Qd(a);for(const c of lN)try{const d=l.getGenerativeModel({model:c});return await e(d)}catch(d){console.warn(`Failed: Key(...${a.slice(-4)}) Model(${c}) error: ${d.message}`),i=d}}throw i||new Error("All keys and models failed to generate content.")},uN=async(n,e)=>Ma(e,async t=>{const i=`
        c ton b "Kch bn i th" sau v phn tch theo quy tc:
        Kch bn: """${n}"""

        Mc tiu: Rt ra khung xng cu trc cm xc (Hook, Build-up, Value/Twist, CTA).
        
        Yu cu:
        1. Xc nh ranh gii phn theo chc nng cm xc.
        2. Vi tng phn m t: Ni dung chnh, Cm xc ch o, Cch truyn ti cm xc, L do hiu qu.
        3. Rt ra: 3 yu t ct li, c im ngn ng & tit tu (5-8 im), 3 pattern cm xc.
        
        Rng buc: Khng thm nhn vt/bi cnh ngoi script. Khng nh gi cm tnh. 
        KT THC BNG MT ON RING BIT C TIU  "PHONG CCH I TH" lit k cc c im phong cch  bc sau s dng.
      `;return(await t.generateContent(i)).response.text()}),hN=async(n,e)=>Ma(e,async t=>{const i=`
        Da trn kt qu phn tch khung xng sau:
        """${n}"""
        
        Nhim v: Sng to ra 5  tng ni dung video mi, gi nguyn "linh hn cm xc" ca kch bn gc.
        
        Mi  tng gm:
        - Tiu  ngn
        - M t ni dung (3-5 cu)
        - Nhn vt/Bi cnh
        - Gi tr ni bt (Cm xc/Thc tin)
        - Kh nng lan truyn

        Response must be a valid JSON array matching the schema:
        [{ "id": number, "title": string, "description": string, "charactersContext": string, "highlightValue": string, "viralPotential": string }]
      `,a=await t.generateContent({contents:[{role:"user",parts:[{text:i}]}],generationConfig:{responseMimeType:"application/json"}});return JSON.parse(a.response.text())}),dN=async(n,e,t,i)=>Ma(i,async a=>{const l=`
        Xy dng dn  chi tit da trn:
        - Khung xng gc: """${n}"""
        -  tng chn: """${JSON.stringify(e)}"""
        - Tng s t mc tiu: ${t}

        Cu trc: Gi nguyn form gc (Hook -> Build-up -> Value/Twist -> CTA).
        Yu cu: Vi mi phn nu r: Mc tiu, Cm xc chnh, Ni dung trin khai, Lin kt trc-sau, S t phn b.
      `;return(await a.generateContent(l)).response.text()}),fN=async(n,e,t)=>Ma(t,async i=>{const a=`
        Vit li thoi kch bn hon chnh (voice-ready) da trn dn  v phong cch sau:
        - Dn : """${n}"""
        - Phong cch m phng: """${e}"""

        QUY TC NGHIM NGT:
        1. Ch tr v li thoi sch 100%. Khng tiu , khng ch thch, khng ngoc ( ), khng nhc nn.
        2. Vit lin mch theo th t Hook -> Build-up -> Value/Twist -> CTA.
      `;return(await i.generateContent(a)).response.text()}),pN=async(n,e,t)=>Ma(t,async i=>{const a=`
        Da trn kch bn video sau:
        """${n}"""
        
        Hy chn ra 1 phong cch hnh nh ph hp nht t danh sch sau:
        ${e.join(", ")}
        
        Ch tr v duy nht tn ID ca phong cch , khng gii thch g thm.
      `;return(await i.generateContent(a)).response.text().trim()}),gN=async(n,e,t)=>Ma(t,async i=>{const a=`
        Da trn kch bn sau v phong cch hnh nh [${e}]:
        Kch bn: """${n}"""
        
        Hy thit k chi tit cc nhn vt xut hin trong kch bn. Nu kch bn khng m t r, hy t sng to chi tit  m bo tnh thm m v ng b.
        
        QUY TC BT BUC: 
        1. Phn "bodyType" (Dng ngi): Ghi CC K NGN GN (v d: "Cao gy", "Mp mp", "Cn i", "Vm v").
        2. Phn "facialDetails" (c im khun mt): 
           - Nu kch bn thiu, hy t thm cho y  nhng phi M T GN GNG, KHNG LNG NHNG, KHNG VN HOA. 
           - CH C M T TRNG THI BNH THNG/TRUNG TNH (Neutral expression).
           - TUYT I KHNG a vo cm xc hay tnh hung c th (v d: KHNG ghi "ang khc", "mt lm lem", "ci nham him"). Ch m t cu trc vt l (mt, mi, ming, da, tc...).

        Tr v nh dng JSON mng cc i tng:
        - name: Tn nhn vt
        - gender: Gii tnh
        - country: Quc gia/Chng tc
        - age:  tui
        - bodyType: Dng ngi (ngn gn nht c th)
        - facialDetails: c im chi tit khun mt (cu trc vt l, gn gng, khng cm xc)
      `,l=await i.generateContent({contents:[{role:"user",parts:[{text:a}]}],generationConfig:{responseMimeType:"application/json"}});return JSON.parse(l.response.text())}),mN=async(n,e,t,i)=>Ma(i,async a=>{const l=t.map(g=>`[Nhn vt: ${g.name} | Gii tnh: ${g.gender} | Quc gia: ${g.country} | Tui: ${g.age} | Dng ngi: ${g.bodyType} | Khun mt: ${g.facialDetails}]`).join(`
`),c=`
        Bn l mt CHUYN GIA PHN TCH TNH HUNG v o din hnh nh i ti.
        Nhim v: Phn tch kch bn sau  trch xut cc hnh ng quay (Shot Action).

        Kch bn: """${n}"""
        
        THNG TIN NHN VT GC (BT BUC PHI SAO CHP CHNH XC KHI NHC N):
        ${l}

        NGUYN TC PHN TCH TNH HUNG (SITUATIONAL ANALYSIS):
        1. QUAN ST NG CNH: Da vo ni dung lin trc (nu c) v lin sau ca mi hnh ng, hy suy lun logic xem nhn vt no ANG C MT trong cnh .
        2. D ON NHN VT: Nu kch bn khng nhc tn nhng logic tnh hung cho thy nhn vt  phi   (v d: ang i thoi, ang ng cnh), BT BUC phi a h vo.
        3. HIN TH TRONG 'ACTION': Trong trng 'action' (M t ngn hnh ng), hy lit k tn cc nhn vt c mt u tin, sau  n m t hnh ng.

        QUY TC TO PROMPT (Strict Compliance - Rules Override All):

        1. [VISUAL STYLE]: Lun bt u bng phong cch: [${e}].

        2. [Bi cnh] (Context Memory):
           - Nu kch bn khng nu r, hy thm chi tit (bn gh,  vt, b cc...).
           - QUAN TRNG: Ghi nh bi cnh. Nu cha i cnh, DNG LI m t bi cnh c. Nu i cnh, thit lp bi cnh mi chi tit v ghi nh cho cc shot sau.

        3. [QUY TC] (Safety & Quality):
           - Lun thm vo prompt: [NO duplication, NO mutation, NO anatomical distortion, Any violation of anatomy rules is forbidden]

        4. [CAMERA]: Gc my, chuyn ng my (Cinematic wording).

        5. [ACTION] (Character Consistency):
           - Khi nhc n nhn vt no, BT BUC COPY NGUYN VN "c im nhn vt" (Gii tnh, Tui, Dng, Khun mt) t thng tin gc vo prompt.
           - TUYT I KHNG ghi tt, KHNG tm tt, KHNG dng "nh trn". Phi copy full.
           - Nu shot c nhn vt khc, cng copy full c im ca h vo.

        6. [Trang Phc] (Costume Memory):
           - Nu kch bn khng nu, t thm v ghi r mu sc.
           - QUAN TRNG: Gi nguyn trang phc xuyn sut cc shot nu cha i thi gian/cnh.

        7. [AUDIO/VOICE  LIP SYNC]:
           - Cu trc: [Tn nhn vt ni: "Li thoi trong Master Transcript"] (nu c thoi).
           - Nu khng thoi: b qua.

        8. [SPEECH SYNC]:
           - Nu c li thoi  mc trn, BT BUC ghi tag: [Chuyn ng ming nhn vt ng b vi li thoi].

        9. [TECHNICAL]: nh sng, mu sc (Lighting, Color).

        CU TRC PROMPT VIDEO (Video Motion Ai Prompt - Output String):
        [${e}], [Bi cnh chi tit], [NO duplication, NO mutation, NO anatomical distortion, Any violation of anatomy rules is forbidden], [CAMERA], [ACTION: Tn NV + (c im Full Copy) + Hnh ng. ${t.length===1?"The scene contains EXACTLY ONE character":"Check logic"}], [Trang phc], [AUDIO/VOICE  LIP SYNC], [SPEECH SYNC], [TECHNICAL]

        TR V JSON Array cc object:
        - action: [Tn cc NV c mt]: [M t hnh ng]
        - voiceText: Li thoi (nu c)
        - motionPrompt: Prompt video (Tun th cu trc trn)
      `,d=await a.generateContent({contents:[{role:"user",parts:[{text:c}]}],generationConfig:{responseMimeType:"application/json"}});return JSON.parse(d.response.text())}),yN=({userId:n})=>{const[e,t]=le.useState(!1),[i,a]=le.useState(!1),[l,c]=le.useState({gemini:"",chatgpt:"",openrouter:""}),[d,g]=le.useState(!1),m=I=>{try{return btoa(I)}catch{return I}},_=I=>{try{return atob(I)}catch{return I}},w=`app_api_keys_${n}`;le.useEffect(()=>{const I=localStorage.getItem(w);if(!I){c({gemini:"",chatgpt:"",openrouter:""}),rm([]);return}if(I)try{const U=JSON.parse(I),q={gemini:_(U.gemini||""),chatgpt:_(U.chatgpt||""),openrouter:_(U.openrouter||"")};c(q),q.gemini&&x(q.gemini)}catch(U){console.error("Failed to parse keys",U)}},[n]);const x=I=>{const U=I.split(`
`).map(q=>q.trim()).filter(q=>q!=="");rm(U)},S=()=>{if(!(l.gemini.trim()!==""||l.chatgpt.trim()!==""||l.openrouter.trim()!=="")){alert("Li: Bn phi nhp t nht 1 API Key vo mt trong 3 mc  tip tc!");return}const U={gemini:m(l.gemini),chatgpt:m(l.chatgpt),openrouter:m(l.openrouter)};localStorage.setItem(w,JSON.stringify(U)),l.gemini&&x(l.gemini),g(!0),setTimeout(()=>g(!1),3e3)},A=(I,U)=>{c(q=>({...q,[I]:U}))},D=()=>f.jsx("div",{className:"absolute inset-0 bg-slate-900/90 backdrop-blur-sm flex items-center justify-center cursor-pointer z-10 rounded-lg border border-slate-700/50",onClick:()=>a(!0),children:f.jsxs("span",{className:"text-slate-400 text-xs font-medium flex items-center gap-2",children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}),"Click to Show Keys"]})});return f.jsxs("div",{className:"w-full bg-[#0f172a] border-b border-white/10 relative z-[200]",children:[f.jsxs("div",{className:"px-6 py-2 flex items-center justify-between cursor-pointer hover:bg-white/5 transition-all text-xs font-bold uppercase tracking-widest text-slate-400",onClick:()=>t(!e),children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("svg",{className:`w-4 h-4 transition-transform ${e?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})}),f.jsxs("span",{children:["API Configuration Manager",f.jsxs("span",{className:"ml-2 text-indigo-400 normal-case tracking-normal opacity-70",children:["(User: ",n.replace("user_","Account ")," - ",i?"Visible":"Hidden",")"]}),d&&f.jsx("span",{className:"text-emerald-400 ml-4 animate-in fade-in slide-in-from-left-2 normal-case tracking-normal",children:" Saved!"})]})]}),f.jsxs("div",{className:"flex gap-4 items-center",children:[f.jsx("button",{onClick:I=>{I.stopPropagation(),a(!i)},className:"text-[10px] bg-slate-800 px-2 py-1 rounded hover:bg-slate-700 transition",children:i?"Hide Keys":"Show Keys"}),f.jsxs("div",{className:"flex gap-4 opacity-50",children:[f.jsxs("span",{children:["Gemini: ",l.gemini?l.gemini.split(`
`).filter(I=>I.trim()).length:0]}),f.jsx("span",{className:"opacity-30",children:"|"}),f.jsxs("span",{children:["GPT: ",l.chatgpt?l.chatgpt.split(`
`).filter(I=>I.trim()).length:0]}),f.jsx("span",{className:"opacity-30",children:"|"}),f.jsxs("span",{children:["OR: ",l.openrouter?l.openrouter.split(`
`).filter(I=>I.trim()).length:0]})]})]})]}),e&&f.jsxs("div",{className:"p-6 grid grid-cols-1 md:grid-cols-3 gap-6 animate-in slide-in-from-top-2 duration-300 bg-black/20",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"text-[10px] uppercase font-black text-indigo-400 tracking-widest",children:"Google Gemini Keys"}),f.jsxs("div",{className:"relative group",children:[!i&&f.jsx(D,{}),f.jsx("textarea",{value:l.gemini,onChange:I=>A("gemini",I.target.value),placeholder:`AIzaSy...
AIzaSy...`,rows:4,disabled:!i,className:`w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 text-white text-xs font-mono focus:border-indigo-500 focus:ring-1 outline-none transition-all resize-y ${i?"":"blur-sm select-none"}`})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"text-[10px] uppercase font-black text-emerald-400 tracking-widest",children:"ChatGPT Keys"}),f.jsxs("div",{className:"relative group",children:[!i&&f.jsx(D,{}),f.jsx("textarea",{value:l.chatgpt,onChange:I=>A("chatgpt",I.target.value),placeholder:`sk-...
sk-...`,rows:4,disabled:!i,className:`w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 text-white text-xs font-mono focus:border-emerald-500 focus:ring-1 outline-none transition-all resize-y ${i?"":"blur-sm select-none"}`})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"text-[10px] uppercase font-black text-rose-400 tracking-widest",children:"OpenRouter Keys"}),f.jsxs("div",{className:"relative group",children:[!i&&f.jsx(D,{}),f.jsx("textarea",{value:l.openrouter,onChange:I=>A("openrouter",I.target.value),placeholder:`sk-or-...
sk-or-...`,rows:4,disabled:!i,className:`w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 text-white text-xs font-mono focus:border-rose-500 focus:ring-1 outline-none transition-all resize-y ${i?"":"blur-sm select-none"}`})]})]}),f.jsxs("div",{className:"md:col-span-3 flex flex-col md:flex-row items-center justify-between mt-2 gap-4",children:[f.jsxs("p",{className:"text-[10px] text-slate-500 italic text-center md:text-left",children:["* Bo mt: Key lu ring cho ti khon ",f.jsx("b",{children:n}),". ",f.jsx("br",{}),"H thng t ng xoay vng key khi chy."]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:async()=>{const I=l.gemini.split(`
`).map(q=>q.trim()).filter(q=>q!=="");if(I.length===0){alert("Vui lng nhp v LU t nht 1 API Key Gemini trc khi test!");return}const U=I[0];try{const z=await(await fetch(`https://generativelanguage.googleapis.com/v1beta/models?key=${U}`)).json();if(z.error)alert(`Li: ${z.error.message}`);else if(z.models){const O=z.models.map($=>$.name.replace("models/","")).slice(0,10).join(", ");alert(`Kt ni OK! C ${z.models.length} models:
${O}`)}else alert("Phn hi l: "+JSON.stringify(z))}catch(q){alert("Li mng: "+q.message)}},className:"bg-blue-600/20 text-blue-400 font-bold uppercase text-xs px-6 py-3 rounded-xl hover:bg-blue-600/30 transition-all border border-blue-600/30",children:"Test Local"}),f.jsx("button",{onClick:S,className:"bg-white text-slate-900 font-black uppercase text-xs px-8 py-3 rounded-xl hover:bg-slate-200 active:scale-95 transition-all shadow-lg flex items-center gap-2",children:"Lu cu hnh (Save)"})]})]})]})]})},vN=()=>{};var zb={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yT=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let a=n.charCodeAt(i);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(a=65536+((a&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},_N=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const a=n[t++];if(a<128)e[i++]=String.fromCharCode(a);else if(a>191&&a<224){const l=n[t++];e[i++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=n[t++],c=n[t++],d=n[t++],g=((a&7)<<18|(l&63)<<12|(c&63)<<6|d&63)-65536;e[i++]=String.fromCharCode(55296+(g>>10)),e[i++]=String.fromCharCode(56320+(g&1023))}else{const l=n[t++],c=n[t++];e[i++]=String.fromCharCode((a&15)<<12|(l&63)<<6|c&63)}}return e.join("")},vT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let a=0;a<n.length;a+=3){const l=n[a],c=a+1<n.length,d=c?n[a+1]:0,g=a+2<n.length,m=g?n[a+2]:0,_=l>>2,w=(l&3)<<4|d>>4;let x=(d&15)<<2|m>>6,S=m&63;g||(S=64,c||(x=64)),i.push(t[_],t[w],t[x],t[S])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(yT(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):_N(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let a=0;a<n.length;){const l=t[n.charAt(a++)],d=a<n.length?t[n.charAt(a)]:0;++a;const m=a<n.length?t[n.charAt(a)]:64;++a;const w=a<n.length?t[n.charAt(a)]:64;if(++a,l==null||d==null||m==null||w==null)throw new bN;const x=l<<2|d>>4;if(i.push(x),m!==64){const S=d<<4&240|m>>2;if(i.push(S),w!==64){const A=m<<6&192|w;i.push(A)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class bN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const wN=function(n){const e=yT(n);return vT.encodeByteArray(e,!0)},Td=function(n){return wN(n).replace(/\./g,"")},_T=function(n){try{return vT.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TN=()=>xN().__FIREBASE_DEFAULTS__,EN=()=>{if(typeof process>"u"||typeof zb>"u")return;const n=zb.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},SN=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&_T(n[1]);return e&&JSON.parse(e)},Jd=()=>{try{return vN()||TN()||EN()||SN()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},bT=n=>{var e,t;return(t=(e=Jd())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},wT=n=>{const e=bT(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},xT=()=>{var n;return(n=Jd())==null?void 0:n.config},TT=n=>{var e;return(e=Jd())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let AN=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}};/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function La(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Ym(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ET(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",a=n.iat||0,l=n.sub||n.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c={iss:`https://securetoken.google.com/${i}`,aud:i,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Td(JSON.stringify(t)),Td(JSON.stringify(c)),""].join(".")}const Mc={};function NN(){const n={prod:[],emulator:[]};for(const e of Object.keys(Mc))Mc[e]?n.emulator.push(e):n.prod.push(e);return n}function CN(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Hb=!1;function Wm(n,e){if(typeof window>"u"||typeof document>"u"||!La(window.location.host)||Mc[n]===e||Mc[n]||Hb)return;Mc[n]=e;function t(x){return`__firebase__banner__${x}`}const i="__firebase__banner",l=NN().prod.length>0;function c(){const x=document.getElementById(i);x&&x.remove()}function d(x){x.style.display="flex",x.style.background="#7faaf0",x.style.position="fixed",x.style.bottom="5px",x.style.left="5px",x.style.padding=".5em",x.style.borderRadius="5px",x.style.alignItems="center"}function g(x,S){x.setAttribute("width","24"),x.setAttribute("id",S),x.setAttribute("height","24"),x.setAttribute("viewBox","0 0 24 24"),x.setAttribute("fill","none"),x.style.marginLeft="-6px"}function m(){const x=document.createElement("span");return x.style.cursor="pointer",x.style.marginLeft="16px",x.style.fontSize="24px",x.innerHTML=" &times;",x.onclick=()=>{Hb=!0,c()},x}function _(x,S){x.setAttribute("id",S),x.innerText="Learn more",x.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",x.setAttribute("target","__blank"),x.style.paddingLeft="5px",x.style.textDecoration="underline"}function w(){const x=CN(i),S=t("text"),A=document.getElementById(S)||document.createElement("span"),D=t("learnmore"),I=document.getElementById(D)||document.createElement("a"),U=t("preprendIcon"),q=document.getElementById(U)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(x.created){const z=x.element;d(z),_(I,D);const O=m();g(q,U),z.append(q,A,I,O),document.body.appendChild(z)}l?(A.innerText="Preview backend disconnected.",q.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(q.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,A.innerText="Preview backend running in this workspace."),A.setAttribute("id",S)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",w):w()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function RN(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(hn())}function IN(){var e;const n=(e=Jd())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function kN(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function ST(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function ON(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function jN(){const n=hn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function DN(){return!IN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function AT(){try{return typeof indexedDB=="object"}catch{return!1}}function NT(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(i);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{var l;e(((l=a.error)==null?void 0:l.message)||"")}}catch(t){e(t)}})}function PN(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MN="FirebaseError";class ns extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=MN,Object.setPrototypeOf(this,ns.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ua.prototype.create)}}class Ua{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},a=`${this.service}/${e}`,l=this.errors[e],c=l?LN(l,i):"Error",d=`${this.serviceName}: ${c} (${a}).`;return new ns(a,d,i)}}function LN(n,e){return n.replace(UN,(t,i)=>{const a=e[i];return a!=null?String(a):`<${i}?>`})}const UN=/\{\$([^}]+)}/g;function VN(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Cr(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const a of t){if(!i.includes(a))return!1;const l=n[a],c=e[a];if(qb(l)&&qb(c)){if(!Cr(l,c))return!1}else if(l!==c)return!1}for(const a of i)if(!t.includes(a))return!1;return!0}function qb(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lu(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(a=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Nc(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[a,l]=i.split("=");e[decodeURIComponent(a)]=decodeURIComponent(l)}}),e}function Cc(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function BN(n,e){const t=new zN(n,e);return t.subscribe.bind(t)}class zN{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let a;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");HN(e,["next","error","complete"])?a=e:a={next:e,error:t,complete:i},a.next===void 0&&(a.next=kg),a.error===void 0&&(a.error=kg),a.complete===void 0&&(a.complete=kg);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function HN(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function kg(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qN=1e3,$N=2,FN=14400*1e3,GN=.5;function $b(n,e=qN,t=$N){const i=e*Math.pow(t,n),a=Math.round(GN*i*(Math.random()-.5)*2);return Math.min(FN,i+a)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gt(n){return n&&n._delegate?n._delegate:n}class es{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _a="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KN{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new AN;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&i.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(a){if(i)return null;throw a}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(WN(e))try{this.getOrInitializeService({instanceIdentifier:_a})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:a});i.resolve(l)}catch{}}}}clearInstance(e=_a){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=_a){return this.instances.has(e)}getOptions(e=_a){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[l,c]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(l);i===d&&c.resolve(a)}return a}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),a=this.onInitCallbacks.get(i)??new Set;a.add(e),this.onInitCallbacks.set(i,a);const l=this.instances.get(i);return l&&e(l,i),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const a of i)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:YN(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=_a){return this.component?this.component.multipleInstances?e:_a:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function YN(n){return n===_a?void 0:n}function WN(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new KN(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var He;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(He||(He={}));const JN={debug:He.DEBUG,verbose:He.VERBOSE,info:He.INFO,warn:He.WARN,error:He.ERROR,silent:He.SILENT},XN=He.INFO,ZN={[He.DEBUG]:"log",[He.VERBOSE]:"log",[He.INFO]:"info",[He.WARN]:"warn",[He.ERROR]:"error"},eC=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),a=ZN[e];if(a)console[a](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Xd{constructor(e){this.name=e,this._logLevel=XN,this._logHandler=eC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in He))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?JN[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,He.DEBUG,...e),this._logHandler(this,He.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,He.VERBOSE,...e),this._logHandler(this,He.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,He.INFO,...e),this._logHandler(this,He.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,He.WARN,...e),this._logHandler(this,He.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,He.ERROR,...e),this._logHandler(this,He.ERROR,...e)}}const tC=(n,e)=>e.some(t=>n instanceof t);let Fb,Gb;function nC(){return Fb||(Fb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function sC(){return Gb||(Gb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const CT=new WeakMap,am=new WeakMap,RT=new WeakMap,Og=new WeakMap,Qm=new WeakMap;function iC(n){const e=new Promise((t,i)=>{const a=()=>{n.removeEventListener("success",l),n.removeEventListener("error",c)},l=()=>{t(Tr(n.result)),a()},c=()=>{i(n.error),a()};n.addEventListener("success",l),n.addEventListener("error",c)});return e.then(t=>{t instanceof IDBCursor&&CT.set(t,n)}).catch(()=>{}),Qm.set(e,n),e}function rC(n){if(am.has(n))return;const e=new Promise((t,i)=>{const a=()=>{n.removeEventListener("complete",l),n.removeEventListener("error",c),n.removeEventListener("abort",c)},l=()=>{t(),a()},c=()=>{i(n.error||new DOMException("AbortError","AbortError")),a()};n.addEventListener("complete",l),n.addEventListener("error",c),n.addEventListener("abort",c)});am.set(n,e)}let om={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return am.get(n);if(e==="objectStoreNames")return n.objectStoreNames||RT.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Tr(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function aC(n){om=n(om)}function oC(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(jg(this),e,...t);return RT.set(i,e.sort?e.sort():[e]),Tr(i)}:sC().includes(n)?function(...e){return n.apply(jg(this),e),Tr(CT.get(this))}:function(...e){return Tr(n.apply(jg(this),e))}}function lC(n){return typeof n=="function"?oC(n):(n instanceof IDBTransaction&&rC(n),tC(n,nC())?new Proxy(n,om):n)}function Tr(n){if(n instanceof IDBRequest)return iC(n);if(Og.has(n))return Og.get(n);const e=lC(n);return e!==n&&(Og.set(n,e),Qm.set(e,n)),e}const jg=n=>Qm.get(n);function IT(n,e,{blocked:t,upgrade:i,blocking:a,terminated:l}={}){const c=indexedDB.open(n,e),d=Tr(c);return i&&c.addEventListener("upgradeneeded",g=>{i(Tr(c.result),g.oldVersion,g.newVersion,Tr(c.transaction),g)}),t&&c.addEventListener("blocked",g=>t(g.oldVersion,g.newVersion,g)),d.then(g=>{l&&g.addEventListener("close",()=>l()),a&&g.addEventListener("versionchange",m=>a(m.oldVersion,m.newVersion,m))}).catch(()=>{}),d}const cC=["get","getKey","getAll","getAllKeys","count"],uC=["put","add","delete","clear"],Dg=new Map;function Kb(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Dg.get(e))return Dg.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,a=uC.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(a||cC.includes(t)))return;const l=async function(c,...d){const g=this.transaction(c,a?"readwrite":"readonly");let m=g.store;return i&&(m=m.index(d.shift())),(await Promise.all([m[t](...d),a&&g.done]))[0]};return Dg.set(e,l),l}aC(n=>({...n,get:(e,t,i)=>Kb(e,t)||n.get(e,t,i),has:(e,t)=>!!Kb(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hC{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(dC(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function dC(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const lm="@firebase/app",Yb="0.14.7";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ni=new Xd("@firebase/app"),fC="@firebase/app-compat",pC="@firebase/analytics-compat",gC="@firebase/analytics",mC="@firebase/app-check-compat",yC="@firebase/app-check",vC="@firebase/auth",_C="@firebase/auth-compat",bC="@firebase/database",wC="@firebase/data-connect",xC="@firebase/database-compat",TC="@firebase/functions",EC="@firebase/functions-compat",SC="@firebase/installations",AC="@firebase/installations-compat",NC="@firebase/messaging",CC="@firebase/messaging-compat",RC="@firebase/performance",IC="@firebase/performance-compat",kC="@firebase/remote-config",OC="@firebase/remote-config-compat",jC="@firebase/storage",DC="@firebase/storage-compat",PC="@firebase/firestore",MC="@firebase/ai",LC="@firebase/firestore-compat",UC="firebase",VC="12.8.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cm="[DEFAULT]",BC={[lm]:"fire-core",[fC]:"fire-core-compat",[gC]:"fire-analytics",[pC]:"fire-analytics-compat",[yC]:"fire-app-check",[mC]:"fire-app-check-compat",[vC]:"fire-auth",[_C]:"fire-auth-compat",[bC]:"fire-rtdb",[wC]:"fire-data-connect",[xC]:"fire-rtdb-compat",[TC]:"fire-fn",[EC]:"fire-fn-compat",[SC]:"fire-iid",[AC]:"fire-iid-compat",[NC]:"fire-fcm",[CC]:"fire-fcm-compat",[RC]:"fire-perf",[IC]:"fire-perf-compat",[kC]:"fire-rc",[OC]:"fire-rc-compat",[jC]:"fire-gcs",[DC]:"fire-gcs-compat",[PC]:"fire-fst",[LC]:"fire-fst-compat",[MC]:"fire-vertex","fire-js":"fire-js",[UC]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ed=new Map,zC=new Map,um=new Map;function Wb(n,e){try{n.container.addComponent(e)}catch(t){Ni.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ws(n){const e=n.name;if(um.has(e))return Ni.debug(`There were multiple attempts to register component ${e}.`),!1;um.set(e,n);for(const t of Ed.values())Wb(t,n);for(const t of zC.values())Wb(t,n);return!0}function Pr(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function En(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HC={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Er=new Ua("app","Firebase",HC);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qC{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new es("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Er.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Va=VC;function kT(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:cm,automaticDataCollectionEnabled:!0,...e},a=i.name;if(typeof a!="string"||!a)throw Er.create("bad-app-name",{appName:String(a)});if(t||(t=xT()),!t)throw Er.create("no-options");const l=Ed.get(a);if(l){if(Cr(t,l.options)&&Cr(i,l.config))return l;throw Er.create("duplicate-app",{appName:a})}const c=new QN(a);for(const g of um.values())c.addComponent(g);const d=new qC(t,i,c);return Ed.set(a,d),d}function Zd(n=cm){const e=Ed.get(n);if(!e&&n===cm&&xT())return kT();if(!e)throw Er.create("no-app",{appName:n});return e}function An(n,e,t){let i=BC[n]??n;t&&(i+=`-${t}`);const a=i.match(/\s|\//),l=e.match(/\s|\//);if(a||l){const c=[`Unable to register library "${i}" with version "${e}":`];a&&c.push(`library name "${i}" contains illegal characters (whitespace or "/")`),a&&l&&c.push("and"),l&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ni.warn(c.join(" "));return}ws(new es(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $C="firebase-heartbeat-database",FC=1,Kc="firebase-heartbeat-store";let Pg=null;function OT(){return Pg||(Pg=IT($C,FC,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Kc)}catch(t){console.warn(t)}}}}).catch(n=>{throw Er.create("idb-open",{originalErrorMessage:n.message})})),Pg}async function GC(n){try{const t=(await OT()).transaction(Kc),i=await t.objectStore(Kc).get(jT(n));return await t.done,i}catch(e){if(e instanceof ns)Ni.warn(e.message);else{const t=Er.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ni.warn(t.message)}}}async function Qb(n,e){try{const i=(await OT()).transaction(Kc,"readwrite");await i.objectStore(Kc).put(e,jT(n)),await i.done}catch(t){if(t instanceof ns)Ni.warn(t.message);else{const i=Er.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Ni.warn(i.message)}}}function jT(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KC=1024,YC=30;class WC{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new JC(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=Jb();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(c=>c.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:a}),this._heartbeatsCache.heartbeats.length>YC){const c=XC(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(c,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){Ni.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Jb(),{heartbeatsToSend:i,unsentEntries:a}=QC(this._heartbeatsCache.heartbeats),l=Td(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(t){return Ni.warn(t),""}}}function Jb(){return new Date().toISOString().substring(0,10)}function QC(n,e=KC){const t=[];let i=n.slice();for(const a of n){const l=t.find(c=>c.agent===a.agent);if(l){if(l.dates.push(a.date),Xb(t)>e){l.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),Xb(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class JC{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return AT()?NT().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await GC(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Qb(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Qb(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Xb(n){return Td(JSON.stringify({version:2,heartbeats:n})).length}function XC(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZC(n){ws(new es("platform-logger",e=>new hC(e),"PRIVATE")),ws(new es("heartbeat",e=>new WC(e),"PRIVATE")),An(lm,Yb,n),An(lm,Yb,"esm2020"),An("fire-js","")}ZC("");var eR="firebase",tR="12.8.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */An(eR,tR,"app");const DT="@firebase/installations",Jm="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PT=1e4,MT=`w:${Jm}`,LT="FIS_v2",nR="https://firebaseinstallations.googleapis.com/v1",sR=3600*1e3,iR="installations",rR="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aR={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Ia=new Ua(iR,rR,aR);function UT(n){return n instanceof ns&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VT({projectId:n}){return`${nR}/projects/${n}/installations`}function BT(n){return{token:n.token,requestStatus:2,expiresIn:lR(n.expiresIn),creationTime:Date.now()}}async function zT(n,e){const i=(await e.json()).error;return Ia.create("request-failed",{requestName:n,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function HT({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function oR(n,{refreshToken:e}){const t=HT(n);return t.append("Authorization",cR(e)),t}async function qT(n){const e=await n();return e.status>=500&&e.status<600?n():e}function lR(n){return Number(n.replace("s","000"))}function cR(n){return`${LT} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uR({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const i=VT(n),a=HT(n),l=e.getImmediate({optional:!0});if(l){const m=await l.getHeartbeatsHeader();m&&a.append("x-firebase-client",m)}const c={fid:t,authVersion:LT,appId:n.appId,sdkVersion:MT},d={method:"POST",headers:a,body:JSON.stringify(c)},g=await qT(()=>fetch(i,d));if(g.ok){const m=await g.json();return{fid:m.fid||t,registrationStatus:2,refreshToken:m.refreshToken,authToken:BT(m.authToken)}}else throw await zT("Create Installation",g)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $T(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hR(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dR=/^[cdef][\w-]{21}$/,hm="";function fR(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=pR(n);return dR.test(t)?t:hm}catch{return hm}}function pR(n){return hR(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ef(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FT=new Map;function GT(n,e){const t=ef(n);KT(t,e),gR(t,e)}function KT(n,e){const t=FT.get(n);if(t)for(const i of t)i(e)}function gR(n,e){const t=mR();t&&t.postMessage({key:n,fid:e}),yR()}let Ta=null;function mR(){return!Ta&&"BroadcastChannel"in self&&(Ta=new BroadcastChannel("[Firebase] FID Change"),Ta.onmessage=n=>{KT(n.data.key,n.data.fid)}),Ta}function yR(){FT.size===0&&Ta&&(Ta.close(),Ta=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vR="firebase-installations-database",_R=1,ka="firebase-installations-store";let Mg=null;function Xm(){return Mg||(Mg=IT(vR,_R,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(ka)}}})),Mg}async function Sd(n,e){const t=ef(n),a=(await Xm()).transaction(ka,"readwrite"),l=a.objectStore(ka),c=await l.get(t);return await l.put(e,t),await a.done,(!c||c.fid!==e.fid)&&GT(n,e.fid),e}async function YT(n){const e=ef(n),i=(await Xm()).transaction(ka,"readwrite");await i.objectStore(ka).delete(e),await i.done}async function tf(n,e){const t=ef(n),a=(await Xm()).transaction(ka,"readwrite"),l=a.objectStore(ka),c=await l.get(t),d=e(c);return d===void 0?await l.delete(t):await l.put(d,t),await a.done,d&&(!c||c.fid!==d.fid)&&GT(n,d.fid),d}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zm(n){let e;const t=await tf(n.appConfig,i=>{const a=bR(i),l=wR(n,a);return e=l.registrationPromise,l.installationEntry});return t.fid===hm?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function bR(n){const e=n||{fid:fR(),registrationStatus:0};return WT(e)}function wR(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const a=Promise.reject(Ia.create("app-offline"));return{installationEntry:e,registrationPromise:a}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=xR(n,t);return{installationEntry:t,registrationPromise:i}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:TR(n)}:{installationEntry:e}}async function xR(n,e){try{const t=await uR(n,e);return Sd(n.appConfig,t)}catch(t){throw UT(t)&&t.customData.serverCode===409?await YT(n.appConfig):await Sd(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function TR(n){let e=await Zb(n.appConfig);for(;e.registrationStatus===1;)await $T(100),e=await Zb(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:i}=await Zm(n);return i||t}return e}function Zb(n){return tf(n,e=>{if(!e)throw Ia.create("installation-not-found");return WT(e)})}function WT(n){return ER(n)?{fid:n.fid,registrationStatus:0}:n}function ER(n){return n.registrationStatus===1&&n.registrationTime+PT<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SR({appConfig:n,heartbeatServiceProvider:e},t){const i=AR(n,t),a=oR(n,t),l=e.getImmediate({optional:!0});if(l){const m=await l.getHeartbeatsHeader();m&&a.append("x-firebase-client",m)}const c={installation:{sdkVersion:MT,appId:n.appId}},d={method:"POST",headers:a,body:JSON.stringify(c)},g=await qT(()=>fetch(i,d));if(g.ok){const m=await g.json();return BT(m)}else throw await zT("Generate Auth Token",g)}function AR(n,{fid:e}){return`${VT(n)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e0(n,e=!1){let t;const i=await tf(n.appConfig,l=>{if(!QT(l))throw Ia.create("not-registered");const c=l.authToken;if(!e&&RR(c))return l;if(c.requestStatus===1)return t=NR(n,e),l;{if(!navigator.onLine)throw Ia.create("app-offline");const d=kR(l);return t=CR(n,d),d}});return t?await t:i.authToken}async function NR(n,e){let t=await ew(n.appConfig);for(;t.authToken.requestStatus===1;)await $T(100),t=await ew(n.appConfig);const i=t.authToken;return i.requestStatus===0?e0(n,e):i}function ew(n){return tf(n,e=>{if(!QT(e))throw Ia.create("not-registered");const t=e.authToken;return OR(t)?{...e,authToken:{requestStatus:0}}:e})}async function CR(n,e){try{const t=await SR(n,e),i={...e,authToken:t};return await Sd(n.appConfig,i),t}catch(t){if(UT(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await YT(n.appConfig);else{const i={...e,authToken:{requestStatus:0}};await Sd(n.appConfig,i)}throw t}}function QT(n){return n!==void 0&&n.registrationStatus===2}function RR(n){return n.requestStatus===2&&!IR(n)}function IR(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+sR}function kR(n){const e={requestStatus:1,requestTime:Date.now()};return{...n,authToken:e}}function OR(n){return n.requestStatus===1&&n.requestTime+PT<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jR(n){const e=n,{installationEntry:t,registrationPromise:i}=await Zm(e);return i?i.catch(console.error):e0(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DR(n,e=!1){const t=n;return await PR(t),(await e0(t,e)).token}async function PR(n){const{registrationPromise:e}=await Zm(n);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MR(n){if(!n||!n.options)throw Lg("App Configuration");if(!n.name)throw Lg("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw Lg(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function Lg(n){return Ia.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JT="installations",LR="installations-internal",UR=n=>{const e=n.getProvider("app").getImmediate(),t=MR(e),i=Pr(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},VR=n=>{const e=n.getProvider("app").getImmediate(),t=Pr(e,JT).getImmediate();return{getId:()=>jR(t),getToken:a=>DR(t,a)}};function BR(){ws(new es(JT,UR,"PUBLIC")),ws(new es(LR,VR,"PRIVATE"))}BR();An(DT,Jm);An(DT,Jm,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ad="analytics",zR="firebase_id",HR="origin",qR=60*1e3,$R="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",t0="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gn=new Xd("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FR={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Vn=new Ua("analytics","Analytics",FR);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GR(n){if(!n.startsWith(t0)){const e=Vn.create("invalid-gtag-resource",{gtagURL:n});return gn.warn(e.message),""}return n}function XT(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function KR(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function YR(n,e){const t=KR("firebase-js-sdk-policy",{createScriptURL:GR}),i=document.createElement("script"),a=`${t0}?l=${n}&id=${e}`;i.src=t?t==null?void 0:t.createScriptURL(a):a,i.async=!0,document.head.appendChild(i)}function WR(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}async function QR(n,e,t,i,a,l){const c=i[a];try{if(c)await e[c];else{const g=(await XT(t)).find(m=>m.measurementId===a);g&&await e[g.appId]}}catch(d){gn.error(d)}n("config",a,l)}async function JR(n,e,t,i,a){try{let l=[];if(a&&a.send_to){let c=a.send_to;Array.isArray(c)||(c=[c]);const d=await XT(t);for(const g of c){const m=d.find(w=>w.measurementId===g),_=m&&e[m.appId];if(_)l.push(_);else{l=[];break}}}l.length===0&&(l=Object.values(e)),await Promise.all(l),n("event",i,a||{})}catch(l){gn.error(l)}}function XR(n,e,t,i){async function a(l,...c){try{if(l==="event"){const[d,g]=c;await JR(n,e,t,d,g)}else if(l==="config"){const[d,g]=c;await QR(n,e,t,i,d,g)}else if(l==="consent"){const[d,g]=c;n("consent",d,g)}else if(l==="get"){const[d,g,m]=c;n("get",d,g,m)}else if(l==="set"){const[d]=c;n("set",d)}else n(l,...c)}catch(d){gn.error(d)}}return a}function ZR(n,e,t,i,a){let l=function(...c){window[i].push(arguments)};return window[a]&&typeof window[a]=="function"&&(l=window[a]),window[a]=XR(l,n,e,t),{gtagCore:l,wrappedGtag:window[a]}}function eI(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(t0)&&t.src.includes(n))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tI=30,nI=1e3;class sI{constructor(e={},t=nI){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const ZT=new sI;function iI(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}async function rI(n){var c;const{appId:e,apiKey:t}=n,i={method:"GET",headers:iI(t)},a=$R.replace("{app-id}",e),l=await fetch(a,i);if(l.status!==200&&l.status!==304){let d="";try{const g=await l.json();(c=g.error)!=null&&c.message&&(d=g.error.message)}catch{}throw Vn.create("config-fetch-failed",{httpStatus:l.status,responseMessage:d})}return l.json()}async function aI(n,e=ZT,t){const{appId:i,apiKey:a,measurementId:l}=n.options;if(!i)throw Vn.create("no-app-id");if(!a){if(l)return{measurementId:l,appId:i};throw Vn.create("no-api-key")}const c=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},d=new cI;return setTimeout(async()=>{d.abort()},qR),eE({appId:i,apiKey:a,measurementId:l},c,d,e)}async function eE(n,{throttleEndTimeMillis:e,backoffCount:t},i,a=ZT){var d;const{appId:l,measurementId:c}=n;try{await oI(i,e)}catch(g){if(c)return gn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${c} provided in the "measurementId" field in the local Firebase config. [${g==null?void 0:g.message}]`),{appId:l,measurementId:c};throw g}try{const g=await rI(n);return a.deleteThrottleMetadata(l),g}catch(g){const m=g;if(!lI(m)){if(a.deleteThrottleMetadata(l),c)return gn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${c} provided in the "measurementId" field in the local Firebase config. [${m==null?void 0:m.message}]`),{appId:l,measurementId:c};throw g}const _=Number((d=m==null?void 0:m.customData)==null?void 0:d.httpStatus)===503?$b(t,a.intervalMillis,tI):$b(t,a.intervalMillis),w={throttleEndTimeMillis:Date.now()+_,backoffCount:t+1};return a.setThrottleMetadata(l,w),gn.debug(`Calling attemptFetch again in ${_} millis`),eE(n,w,i,a)}}function oI(n,e){return new Promise((t,i)=>{const a=Math.max(e-Date.now(),0),l=setTimeout(t,a);n.addEventListener(()=>{clearTimeout(l),i(Vn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function lI(n){if(!(n instanceof ns)||!n.customData)return!1;const e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}class cI{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function uI(n,e,t,i,a){if(a&&a.global){n("event",t,i);return}else{const l=await e,c={...i,send_to:l};n("event",t,c)}}async function hI(n,e,t,i){if(i&&i.global){const a={};for(const l of Object.keys(t))a[`user_properties.${l}`]=t[l];return n("set",a),Promise.resolve()}else{const a=await e;n("config",a,{update:!0,user_properties:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dI(){if(AT())try{await NT()}catch(n){return gn.warn(Vn.create("indexeddb-unavailable",{errorInfo:n==null?void 0:n.toString()}).message),!1}else return gn.warn(Vn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function fI(n,e,t,i,a,l,c){const d=aI(n);d.then(x=>{t[x.measurementId]=x.appId,n.options.measurementId&&x.measurementId!==n.options.measurementId&&gn.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${x.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(x=>gn.error(x)),e.push(d);const g=dI().then(x=>{if(x)return i.getId()}),[m,_]=await Promise.all([d,g]);eI(l)||YR(l,m.measurementId),a("js",new Date);const w=(c==null?void 0:c.config)??{};return w[HR]="firebase",w.update=!0,_!=null&&(w[zR]=_),a("config",m.measurementId,w),m.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pI{constructor(e){this.app=e}_delete(){return delete Yo[this.app.options.appId],Promise.resolve()}}let Yo={},tw=[];const nw={};let Ug="dataLayer",gI="gtag",sw,n0,iw=!1;function mI(){const n=[];if(ST()&&n.push("This is a browser extension environment."),PN()||n.push("Cookies are not available."),n.length>0){const e=n.map((i,a)=>`(${a+1}) ${i}`).join(" "),t=Vn.create("invalid-analytics-context",{errorInfo:e});gn.warn(t.message)}}function yI(n,e,t){mI();const i=n.options.appId;if(!i)throw Vn.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)gn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Vn.create("no-api-key");if(Yo[i]!=null)throw Vn.create("already-exists",{id:i});if(!iw){WR(Ug);const{wrappedGtag:l,gtagCore:c}=ZR(Yo,tw,nw,Ug,gI);n0=l,sw=c,iw=!0}return Yo[i]=fI(n,tw,nw,e,sw,Ug,t),new pI(n)}function vI(n=Zd()){n=gt(n);const e=Pr(n,Ad);return e.isInitialized()?e.getImmediate():_I(n)}function _I(n,e={}){const t=Pr(n,Ad);if(t.isInitialized()){const a=t.getImmediate();if(Cr(e,t.getOptions()))return a;throw Vn.create("already-initialized")}return t.initialize({options:e})}function bI(n,e,t){n=gt(n),hI(n0,Yo[n.app.options.appId],e,t).catch(i=>gn.error(i))}function wI(n,e,t,i){n=gt(n),uI(n0,Yo[n.app.options.appId],e,t,i).catch(a=>gn.error(a))}const rw="@firebase/analytics",aw="0.10.19";function xI(){ws(new es(Ad,(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),a=e.getProvider("installations-internal").getImmediate();return yI(i,a,t)},"PUBLIC")),ws(new es("analytics-internal",n,"PRIVATE")),An(rw,aw),An(rw,aw,"esm2020");function n(e){try{const t=e.getProvider(Ad).getImmediate();return{logEvent:(i,a,l)=>wI(t,i,a,l),setUserProperties:(i,a)=>bI(t,i,a)}}catch(t){throw Vn.create("interop-component-reg-failed",{reason:t})}}}xI();function tE(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const TI=tE,nE=new Ua("auth","Firebase",tE());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nd=new Xd("@firebase/auth");function EI(n,...e){Nd.logLevel<=He.WARN&&Nd.warn(`Auth (${Va}): ${n}`,...e)}function fd(n,...e){Nd.logLevel<=He.ERROR&&Nd.error(`Auth (${Va}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ts(n,...e){throw i0(n,...e)}function _s(n,...e){return i0(n,...e)}function s0(n,e,t){const i={...TI(),[e]:t};return new Ua("auth","Firebase",i).create(e,{appName:n.name})}function Si(n){return s0(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function SI(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&ts(n,"argument-error"),s0(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function i0(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return nE.create(n,...e)}function Re(n,e,...t){if(!n)throw i0(e,...t)}function Ti(n){const e="INTERNAL ASSERTION FAILED: "+n;throw fd(e),new Error(e)}function Ci(n,e){n||Ti(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dm(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function AI(){return ow()==="http:"||ow()==="https:"}function ow(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NI(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(AI()||ST()||"connection"in navigator)?navigator.onLine:!0}function CI(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cu{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ci(t>e,"Short delay should be less than long delay!"),this.isMobile=RN()||ON()}get(){return NI()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r0(n,e){Ci(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sE{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ti("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ti("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ti("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RI={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const II=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],kI=new cu(3e4,6e4);function Mr(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Oi(n,e,t,i,a={}){return iE(n,a,async()=>{let l={},c={};i&&(e==="GET"?c=i:l={body:JSON.stringify(i)});const d=lu({key:n.config.apiKey,...c}).slice(1),g=await n._getAdditionalHeaders();g["Content-Type"]="application/json",n.languageCode&&(g["X-Firebase-Locale"]=n.languageCode);const m={method:e,headers:g,...l};return kN()||(m.referrerPolicy="no-referrer"),n.emulatorConfig&&La(n.emulatorConfig.host)&&(m.credentials="include"),sE.fetch()(await rE(n,n.config.apiHost,t,d),m)})}async function iE(n,e,t){n._canInitEmulator=!1;const i={...RI,...e};try{const a=new jI(n),l=await Promise.race([t(),a.promise]);a.clearNetworkTimeout();const c=await l.json();if("needConfirmation"in c)throw Xh(n,"account-exists-with-different-credential",c);if(l.ok&&!("errorMessage"in c))return c;{const d=l.ok?c.errorMessage:c.error.message,[g,m]=d.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw Xh(n,"credential-already-in-use",c);if(g==="EMAIL_EXISTS")throw Xh(n,"email-already-in-use",c);if(g==="USER_DISABLED")throw Xh(n,"user-disabled",c);const _=i[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw s0(n,_,m);ts(n,_)}}catch(a){if(a instanceof ns)throw a;ts(n,"network-request-failed",{message:String(a)})}}async function uu(n,e,t,i,a={}){const l=await Oi(n,e,t,i,a);return"mfaPendingCredential"in l&&ts(n,"multi-factor-auth-required",{_serverResponse:l}),l}async function rE(n,e,t,i){const a=`${e}${t}?${i}`,l=n,c=l.config.emulator?r0(n.config,a):`${n.config.apiScheme}://${a}`;return II.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(c).toString():c}function OI(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class jI{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(_s(this.auth,"network-request-failed")),kI.get())})}}function Xh(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const a=_s(n,e,i);return a.customData._tokenResponse=t,a}function lw(n){return n!==void 0&&n.enterprise!==void 0}class DI{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return OI(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function PI(n,e){return Oi(n,"GET","/v2/recaptchaConfig",Mr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MI(n,e){return Oi(n,"POST","/v1/accounts:delete",e)}async function Cd(n,e){return Oi(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lc(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function LI(n,e=!1){const t=gt(n),i=await t.getIdToken(e),a=a0(i);Re(a&&a.exp&&a.auth_time&&a.iat,t.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,c=l==null?void 0:l.sign_in_provider;return{claims:a,token:i,authTime:Lc(Vg(a.auth_time)),issuedAtTime:Lc(Vg(a.iat)),expirationTime:Lc(Vg(a.exp)),signInProvider:c||null,signInSecondFactor:(l==null?void 0:l.sign_in_second_factor)||null}}function Vg(n){return Number(n)*1e3}function a0(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return fd("JWT malformed, contained fewer than 3 sections"),null;try{const a=_T(t);return a?JSON.parse(a):(fd("Failed to decode base64 JWT payload"),null)}catch(a){return fd("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function cw(n){const e=a0(n);return Re(e,"internal-error"),Re(typeof e.exp<"u","internal-error"),Re(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nl(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof ns&&UI(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function UI({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VI{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fm{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Lc(this.lastLoginAt),this.creationTime=Lc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rd(n){var w;const e=n.auth,t=await n.getIdToken(),i=await nl(n,Cd(e,{idToken:t}));Re(i==null?void 0:i.users.length,e,"internal-error");const a=i.users[0];n._notifyReloadListener(a);const l=(w=a.providerUserInfo)!=null&&w.length?aE(a.providerUserInfo):[],c=zI(n.providerData,l),d=n.isAnonymous,g=!(n.email&&a.passwordHash)&&!(c!=null&&c.length),m=d?g:!1,_={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:c,metadata:new fm(a.createdAt,a.lastLoginAt),isAnonymous:m};Object.assign(n,_)}async function BI(n){const e=gt(n);await Rd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function zI(n,e){return[...n.filter(i=>!e.some(a=>a.providerId===i.providerId)),...e]}function aE(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HI(n,e){const t=await iE(n,{},async()=>{const i=lu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=n.config,c=await rE(n,a,"/v1/token",`key=${l}`),d=await n._getAdditionalHeaders();d["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:d,body:i};return n.emulatorConfig&&La(n.emulatorConfig.host)&&(g.credentials="include"),sE.fetch()(c,g)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function qI(n,e){return Oi(n,"POST","/v2/accounts:revokeToken",Mr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Re(e.idToken,"internal-error"),Re(typeof e.idToken<"u","internal-error"),Re(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):cw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Re(e.length!==0,"internal-error");const t=cw(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Re(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:a,expiresIn:l}=await HI(e,t);this.updateTokensAndExpiration(i,a,Number(l))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:a,expirationTime:l}=t,c=new Wo;return i&&(Re(typeof i=="string","internal-error",{appName:e}),c.refreshToken=i),a&&(Re(typeof a=="string","internal-error",{appName:e}),c.accessToken=a),l&&(Re(typeof l=="number","internal-error",{appName:e}),c.expirationTime=l),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Wo,this.toJSON())}_performRefresh(){return Ti("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fr(n,e){Re(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class ys{constructor({uid:e,auth:t,stsTokenManager:i,...a}){this.providerId="firebase",this.proactiveRefresh=new VI(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new fm(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const t=await nl(this,this.stsTokenManager.getToken(this.auth,e));return Re(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return LI(this,e)}reload(){return BI(this)}_assign(e){this!==e&&(Re(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ys({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Re(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Rd(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(En(this.auth.app))return Promise.reject(Si(this.auth));const e=await this.getIdToken();return await nl(this,MI(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,a=t.email??void 0,l=t.phoneNumber??void 0,c=t.photoURL??void 0,d=t.tenantId??void 0,g=t._redirectEventId??void 0,m=t.createdAt??void 0,_=t.lastLoginAt??void 0,{uid:w,emailVerified:x,isAnonymous:S,providerData:A,stsTokenManager:D}=t;Re(w&&D,e,"internal-error");const I=Wo.fromJSON(this.name,D);Re(typeof w=="string",e,"internal-error"),fr(i,e.name),fr(a,e.name),Re(typeof x=="boolean",e,"internal-error"),Re(typeof S=="boolean",e,"internal-error"),fr(l,e.name),fr(c,e.name),fr(d,e.name),fr(g,e.name),fr(m,e.name),fr(_,e.name);const U=new ys({uid:w,auth:e,email:a,emailVerified:x,displayName:i,isAnonymous:S,photoURL:c,phoneNumber:l,tenantId:d,stsTokenManager:I,createdAt:m,lastLoginAt:_});return A&&Array.isArray(A)&&(U.providerData=A.map(q=>({...q}))),g&&(U._redirectEventId=g),U}static async _fromIdTokenResponse(e,t,i=!1){const a=new Wo;a.updateFromServerResponse(t);const l=new ys({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:i});return await Rd(l),l}static async _fromGetAccountInfoResponse(e,t,i){const a=t.users[0];Re(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?aE(a.providerUserInfo):[],c=!(a.email&&a.passwordHash)&&!(l!=null&&l.length),d=new Wo;d.updateFromIdToken(i);const g=new ys({uid:a.localId,auth:e,stsTokenManager:d,isAnonymous:c}),m={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new fm(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(l!=null&&l.length)};return Object.assign(g,m),g}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uw=new Map;function Ei(n){Ci(n instanceof Function,"Expected a class definition");let e=uw.get(n);return e?(Ci(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,uw.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oE{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}oE.type="NONE";const hw=oE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pd(n,e,t){return`firebase:${n}:${e}:${t}`}class Qo{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:a,name:l}=this.auth;this.fullUserKey=pd(this.userKey,a.apiKey,l),this.fullPersistenceKey=pd("persistence",a.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Cd(this.auth,{idToken:e}).catch(()=>{});return t?ys._fromGetAccountInfoResponse(this.auth,t,e):null}return ys._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Qo(Ei(hw),e,i);const a=(await Promise.all(t.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let l=a[0]||Ei(hw);const c=pd(i,e.config.apiKey,e.name);let d=null;for(const m of t)try{const _=await m._get(c);if(_){let w;if(typeof _=="string"){const x=await Cd(e,{idToken:_}).catch(()=>{});if(!x)break;w=await ys._fromGetAccountInfoResponse(e,x,_)}else w=ys._fromJSON(e,_);m!==l&&(d=w),l=m;break}}catch{}const g=a.filter(m=>m._shouldAllowMigration);return!l._shouldAllowMigration||!g.length?new Qo(l,e,i):(l=g[0],d&&await l._set(c,d.toJSON()),await Promise.all(t.map(async m=>{if(m!==l)try{await m._remove(c)}catch{}})),new Qo(l,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dw(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(hE(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(lE(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(fE(e))return"Blackberry";if(pE(e))return"Webos";if(cE(e))return"Safari";if((e.includes("chrome/")||uE(e))&&!e.includes("edge/"))return"Chrome";if(dE(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function lE(n=hn()){return/firefox\//i.test(n)}function cE(n=hn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function uE(n=hn()){return/crios\//i.test(n)}function hE(n=hn()){return/iemobile/i.test(n)}function dE(n=hn()){return/android/i.test(n)}function fE(n=hn()){return/blackberry/i.test(n)}function pE(n=hn()){return/webos/i.test(n)}function o0(n=hn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function $I(n=hn()){var e;return o0(n)&&!!((e=window.navigator)!=null&&e.standalone)}function FI(){return jN()&&document.documentMode===10}function gE(n=hn()){return o0(n)||dE(n)||pE(n)||fE(n)||/windows phone/i.test(n)||hE(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mE(n,e=[]){let t;switch(n){case"Browser":t=dw(hn());break;case"Worker":t=`${dw(hn())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Va}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GI{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=l=>new Promise((c,d)=>{try{const g=e(l);c(g)}catch(g){d(g)}});i.onAbort=t,this.queue.push(i);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const a of t)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KI(n,e={}){return Oi(n,"GET","/v2/passwordPolicy",Mr(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YI=6;class WI{constructor(e){var i;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??YI,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((i=e.allowedNonAlphanumericCharacters)==null?void 0:i.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),a&&(t.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let a=0;a<e.length;a++)i=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QI{constructor(e,t,i,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new fw(this),this.idTokenSubscription=new fw(this),this.beforeStateQueue=new GI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=nE,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ei(t)),this._initializationPromise=this.queue(async()=>{var i,a,l;if(!this._deleted&&(this.persistenceManager=await Qo.create(this,e),(i=this._resolvePersistenceManagerAvailable)==null||i.call(this),!this._deleted)){if((a=this._popupRedirectResolver)!=null&&a._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((l=this.currentUser)==null?void 0:l.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Cd(this,{idToken:e}),i=await ys._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var l;if(En(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=(l=this.redirectUser)==null?void 0:l._redirectEventId,d=i==null?void 0:i._redirectEventId,g=await this.tryRedirectSignIn(e);(!c||c===d)&&(g!=null&&g.user)&&(i=g.user,a=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(i)}catch(c){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Re(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Rd(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=CI()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(En(this.app))return Promise.reject(Si(this));const t=e?gt(e):null;return t&&Re(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Re(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return En(this.app)?Promise.reject(Si(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return En(this.app)?Promise.reject(Si(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ei(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await KI(this),t=new WI(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ua("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await qI(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ei(e)||this._popupRedirectResolver;Re(t,this,"argument-error"),this.redirectPersistenceManager=await Qo.create(this,[Ei(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)==null?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,a){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let c=!1;const d=this._isInitialized?Promise.resolve():this._initializationPromise;if(Re(d,this,"internal-error"),d.then(()=>{c||l(this.currentUser)}),typeof t=="function"){const g=e.addObserver(t,i,a);return()=>{c=!0,g()}}else{const g=e.addObserver(t);return()=>{c=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Re(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=mE(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var a;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((a=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:a.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){var t;if(En(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&EI(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Lr(n){return gt(n)}class fw{constructor(e){this.auth=e,this.observer=null,this.addObserver=BN(t=>this.observer=t)}get next(){return Re(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function JI(n){nf=n}function yE(n){return nf.loadJS(n)}function XI(){return nf.recaptchaEnterpriseScript}function ZI(){return nf.gapiScript}function ek(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class tk{constructor(){this.enterprise=new nk}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class nk{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const sk="recaptcha-enterprise",vE="NO_RECAPTCHA";class ik{constructor(e){this.type=sk,this.auth=Lr(e)}async verify(e="verify",t=!1){async function i(l){if(!t){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(c,d)=>{PI(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)d(new Error("recaptcha Enterprise site key undefined"));else{const m=new DI(g);return l.tenantId==null?l._agentRecaptchaConfig=m:l._tenantRecaptchaConfigs[l.tenantId]=m,c(m.siteKey)}}).catch(g=>{d(g)})})}function a(l,c,d){const g=window.grecaptcha;lw(g)?g.enterprise.ready(()=>{g.enterprise.execute(l,{action:e}).then(m=>{c(m)}).catch(()=>{c(vE)})}):d(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new tk().execute("siteKey",{action:"verify"}):new Promise((l,c)=>{i(this.auth).then(d=>{if(!t&&lw(window.grecaptcha))a(d,l,c);else{if(typeof window>"u"){c(new Error("RecaptchaVerifier is only supported in browser"));return}let g=XI();g.length!==0&&(g+=d),yE(g).then(()=>{a(d,l,c)}).catch(m=>{c(m)})}}).catch(d=>{c(d)})})}}async function pw(n,e,t,i=!1,a=!1){const l=new ik(n);let c;if(a)c=vE;else try{c=await l.verify(t)}catch{c=await l.verify(t,!0)}const d={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in d){const g=d.phoneEnrollmentInfo.phoneNumber,m=d.phoneEnrollmentInfo.recaptchaToken;Object.assign(d,{phoneEnrollmentInfo:{phoneNumber:g,recaptchaToken:m,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in d){const g=d.phoneSignInInfo.recaptchaToken;Object.assign(d,{phoneSignInInfo:{recaptchaToken:g,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return d}return i?Object.assign(d,{captchaResp:c}):Object.assign(d,{captchaResponse:c}),Object.assign(d,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(d,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),d}async function pm(n,e,t,i,a){var l;if((l=n._getRecaptchaConfig())!=null&&l.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const c=await pw(n,e,t,t==="getOobCode");return i(n,c)}else return i(n,e).catch(async c=>{if(c.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await pw(n,e,t,t==="getOobCode");return i(n,d)}else return Promise.reject(c)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rk(n,e){const t=Pr(n,"auth");if(t.isInitialized()){const a=t.getImmediate(),l=t.getOptions();if(Cr(l,e??{}))return a;ts(a,"already-initialized")}return t.initialize({options:e})}function ak(n,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map(Ei);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function ok(n,e,t){const i=Lr(n);Re(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const a=!1,l=_E(e),{host:c,port:d}=lk(e),g=d===null?"":`:${d}`,m={url:`${l}//${c}${g}/`},_=Object.freeze({host:c,port:d,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!i._canInitEmulator){Re(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Re(Cr(m,i.config.emulator)&&Cr(_,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=m,i.emulatorConfig=_,i.settings.appVerificationDisabledForTesting=!0,La(c)?(Ym(`${l}//${c}${g}`),Wm("Auth",!0)):ck()}function _E(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function lk(n){const e=_E(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(i);if(a){const l=a[1];return{host:l,port:gw(i.substr(l.length+1))}}else{const[l,c]=i.split(":");return{host:l,port:gw(c)}}}function gw(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function ck(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l0{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ti("not implemented")}_getIdTokenResponse(e){return Ti("not implemented")}_linkToIdToken(e,t){return Ti("not implemented")}_getReauthenticationResolver(e){return Ti("not implemented")}}async function uk(n,e){return Oi(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hk(n,e){return uu(n,"POST","/v1/accounts:signInWithPassword",Mr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dk(n,e){return uu(n,"POST","/v1/accounts:signInWithEmailLink",Mr(n,e))}async function fk(n,e){return uu(n,"POST","/v1/accounts:signInWithEmailLink",Mr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yc extends l0{constructor(e,t,i,a=null){super("password",i),this._email=e,this._password=t,this._tenantId=a}static _fromEmailAndPassword(e,t){return new Yc(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new Yc(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return pm(e,t,"signInWithPassword",hk);case"emailLink":return dk(e,{email:this._email,oobCode:this._password});default:ts(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return pm(e,i,"signUpPassword",uk);case"emailLink":return fk(e,{idToken:t,email:this._email,oobCode:this._password});default:ts(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jo(n,e){return uu(n,"POST","/v1/accounts:signInWithIdp",Mr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pk="http://localhost";class Oa extends l0{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Oa(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ts("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:a,...l}=t;if(!i||!a)return null;const c=new Oa(i,a);return c.idToken=l.idToken||void 0,c.accessToken=l.accessToken||void 0,c.secret=l.secret,c.nonce=l.nonce,c.pendingToken=l.pendingToken||null,c}_getIdTokenResponse(e){const t=this.buildRequest();return Jo(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Jo(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Jo(e,t)}buildRequest(){const e={requestUri:pk,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=lu(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gk(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function mk(n){const e=Nc(Cc(n)).link,t=e?Nc(Cc(e)).deep_link_id:null,i=Nc(Cc(n)).deep_link_id;return(i?Nc(Cc(i)).link:null)||i||t||e||n}class c0{constructor(e){const t=Nc(Cc(e)),i=t.apiKey??null,a=t.oobCode??null,l=gk(t.mode??null);Re(i&&a&&l,"argument-error"),this.apiKey=i,this.operation=l,this.code=a,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=mk(e);try{return new c0(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ul{constructor(){this.providerId=ul.PROVIDER_ID}static credential(e,t){return Yc._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=c0.parseLink(t);return Re(i,"argument-error"),Yc._fromEmailAndCode(e,i.code,i.tenantId)}}ul.PROVIDER_ID="password";ul.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ul.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u0{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hu extends u0{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mr extends hu{constructor(){super("facebook.com")}static credential(e){return Oa._fromParams({providerId:mr.PROVIDER_ID,signInMethod:mr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return mr.credentialFromTaggedObject(e)}static credentialFromError(e){return mr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return mr.credential(e.oauthAccessToken)}catch{return null}}}mr.FACEBOOK_SIGN_IN_METHOD="facebook.com";mr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi extends hu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Oa._fromParams({providerId:xi.PROVIDER_ID,signInMethod:xi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return xi.credentialFromTaggedObject(e)}static credentialFromError(e){return xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return xi.credential(t,i)}catch{return null}}}xi.GOOGLE_SIGN_IN_METHOD="google.com";xi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yr extends hu{constructor(){super("github.com")}static credential(e){return Oa._fromParams({providerId:yr.PROVIDER_ID,signInMethod:yr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return yr.credentialFromTaggedObject(e)}static credentialFromError(e){return yr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return yr.credential(e.oauthAccessToken)}catch{return null}}}yr.GITHUB_SIGN_IN_METHOD="github.com";yr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vr extends hu{constructor(){super("twitter.com")}static credential(e,t){return Oa._fromParams({providerId:vr.PROVIDER_ID,signInMethod:vr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return vr.credentialFromTaggedObject(e)}static credentialFromError(e){return vr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return vr.credential(t,i)}catch{return null}}}vr.TWITTER_SIGN_IN_METHOD="twitter.com";vr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yk(n,e){return uu(n,"POST","/v1/accounts:signUp",Mr(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ja{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,a=!1){const l=await ys._fromIdTokenResponse(e,i,a),c=mw(i);return new ja({user:l,providerId:c,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const a=mw(i);return new ja({user:e,providerId:a,_tokenResponse:i,operationType:t})}}function mw(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Id extends ns{constructor(e,t,i,a){super(t.code,t.message),this.operationType=i,this.user=a,Object.setPrototypeOf(this,Id.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,a){return new Id(e,t,i,a)}}function bE(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?Id._fromErrorAndOperation(n,l,e,i):l})}async function vk(n,e,t=!1){const i=await nl(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return ja._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _k(n,e,t=!1){const{auth:i}=n;if(En(i.app))return Promise.reject(Si(i));const a="reauthenticate";try{const l=await nl(n,bE(i,a,e,n),t);Re(l.idToken,i,"internal-error");const c=a0(l.idToken);Re(c,i,"internal-error");const{sub:d}=c;return Re(n.uid===d,i,"user-mismatch"),ja._forOperation(n,a,l)}catch(l){throw(l==null?void 0:l.code)==="auth/user-not-found"&&ts(i,"user-mismatch"),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wE(n,e,t=!1){if(En(n.app))return Promise.reject(Si(n));const i="signIn",a=await bE(n,i,e),l=await ja._fromIdTokenResponse(n,i,a);return t||await n._updateCurrentUser(l.user),l}async function bk(n,e){return wE(Lr(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xE(n){const e=Lr(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function wk(n,e,t){if(En(n.app))return Promise.reject(Si(n));const i=Lr(n),c=await pm(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",yk).catch(g=>{throw g.code==="auth/password-does-not-meet-requirements"&&xE(n),g}),d=await ja._fromIdTokenResponse(i,"signIn",c);return await i._updateCurrentUser(d.user),d}function xk(n,e,t){return En(n.app)?Promise.reject(Si(n)):bk(gt(n),ul.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&xE(n),i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tk(n,e){return Oi(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ek(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const i=gt(n),l={idToken:await i.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},c=await nl(i,Tk(i.auth,l));i.displayName=c.displayName||null,i.photoURL=c.photoUrl||null;const d=i.providerData.find(({providerId:g})=>g==="password");d&&(d.displayName=i.displayName,d.photoURL=i.photoURL),await i._updateTokensIfNecessary(c)}function Sk(n,e,t,i){return gt(n).onIdTokenChanged(e,t,i)}function Ak(n,e,t){return gt(n).beforeAuthStateChanged(e,t)}function Nk(n,e,t,i){return gt(n).onAuthStateChanged(e,t,i)}function Ck(n){return gt(n).signOut()}const kd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TE{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(kd,"1"),this.storage.removeItem(kd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rk=1e3,Ik=10;class EE extends TE{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=gE(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),a=this.localCache[t];i!==a&&e(t,a,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((c,d,g)=>{this.notifyListeners(c,g)});return}const i=e.key;t?this.detachListener():this.stopPolling();const a=()=>{const c=this.storage.getItem(i);!t&&this.localCache[i]===c||this.notifyListeners(i,c)},l=this.storage.getItem(i);FI()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,Ik):a()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const a of Array.from(i))a(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},Rk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}EE.type="LOCAL";const kk=EE;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SE extends TE{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}SE.type="SESSION";const AE=SE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ok(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(a=>a.isListeningto(e));if(t)return t;const i=new sf(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:a,data:l}=t.data,c=this.handlersMap[a];if(!(c!=null&&c.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:a});const d=Array.from(c).map(async m=>m(t.origin,l)),g=await Ok(d);t.ports[0].postMessage({status:"done",eventId:i,eventType:a,response:g})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}sf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h0(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jk{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,c;return new Promise((d,g)=>{const m=h0("",20);a.port1.start();const _=setTimeout(()=>{g(new Error("unsupported_event"))},i);c={messageChannel:a,onMessage(w){const x=w;if(x.data.eventId===m)switch(x.data.status){case"ack":clearTimeout(_),l=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),d(x.data.response);break;default:clearTimeout(_),clearTimeout(l),g(new Error("invalid_response"));break}}},this.handlers.add(c),a.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:m,data:t},[a.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ws(){return window}function Dk(n){Ws().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NE(){return typeof Ws().WorkerGlobalScope<"u"&&typeof Ws().importScripts=="function"}async function Pk(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Mk(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function Lk(){return NE()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CE="firebaseLocalStorageDb",Uk=1,Od="firebaseLocalStorage",RE="fbase_key";class du{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function rf(n,e){return n.transaction([Od],e?"readwrite":"readonly").objectStore(Od)}function Vk(){const n=indexedDB.deleteDatabase(CE);return new du(n).toPromise()}function gm(){const n=indexedDB.open(CE,Uk);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Od,{keyPath:RE})}catch(a){t(a)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Od)?e(i):(i.close(),await Vk(),e(await gm()))})})}async function yw(n,e,t){const i=rf(n,!0).put({[RE]:e,value:t});return new du(i).toPromise()}async function Bk(n,e){const t=rf(n,!1).get(e),i=await new du(t).toPromise();return i===void 0?null:i.value}function vw(n,e){const t=rf(n,!0).delete(e);return new du(t).toPromise()}const zk=800,Hk=3;class IE{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await gm(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>Hk)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return NE()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=sf._getInstance(Lk()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,i;if(this.activeServiceWorker=await Pk(),!this.activeServiceWorker)return;this.sender=new jk(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(i=e[0])!=null&&i.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Mk()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await gm();return await yw(e,kd,"1"),await vw(e,kd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>yw(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>Bk(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>vw(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=rf(a,!1).getAll();return new du(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)i.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!i.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const a of Array.from(i))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),zk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}IE.type="LOCAL";const qk=IE;new cu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kE(n,e){return e?Ei(e):(Re(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d0 extends l0{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Jo(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Jo(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Jo(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function $k(n){return wE(n.auth,new d0(n),n.bypassAuthState)}function Fk(n){const{auth:e,user:t}=n;return Re(t,e,"internal-error"),_k(t,new d0(n),n.bypassAuthState)}async function Gk(n){const{auth:e,user:t}=n;return Re(t,e,"internal-error"),vk(t,new d0(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OE{constructor(e,t,i,a,l=!1){this.auth=e,this.resolver=i,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:a,tenantId:l,error:c,type:d}=e;if(c){this.reject(c);return}const g={auth:this.auth,requestUri:t,sessionId:i,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(d)(g))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return $k;case"linkViaPopup":case"linkViaRedirect":return Gk;case"reauthViaPopup":case"reauthViaRedirect":return Fk;default:ts(this.auth,"internal-error")}}resolve(e){Ci(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ci(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kk=new cu(2e3,1e4);async function Yk(n,e,t){if(En(n.app))return Promise.reject(_s(n,"operation-not-supported-in-this-environment"));const i=Lr(n);SI(n,e,u0);const a=kE(i,t);return new Ea(i,"signInViaPopup",e,a).executeNotNull()}class Ea extends OE{constructor(e,t,i,a,l){super(e,t,a,l),this.provider=i,this.authWindow=null,this.pollId=null,Ea.currentPopupAction&&Ea.currentPopupAction.cancel(),Ea.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Re(e,this.auth,"internal-error"),e}async onExecution(){Ci(this.filter.length===1,"Popup operations only handle one event");const e=h0();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(_s(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(_s(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ea.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if((i=(t=this.authWindow)==null?void 0:t.window)!=null&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_s(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Kk.get())};e()}}Ea.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wk="pendingRedirect",gd=new Map;class Qk extends OE{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=gd.get(this.auth._key());if(!e){try{const i=await Jk(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}gd.set(this.auth._key(),e)}return this.bypassAuthState||gd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Jk(n,e){const t=eO(e),i=Zk(n);if(!await i._isAvailable())return!1;const a=await i._get(t)==="true";return await i._remove(t),a}function Xk(n,e){gd.set(n._key(),e)}function Zk(n){return Ei(n._redirectPersistence)}function eO(n){return pd(Wk,n.config.apiKey,n.name)}async function tO(n,e,t=!1){if(En(n.app))return Promise.reject(Si(n));const i=Lr(n),a=kE(i,e),c=await new Qk(i,a,t).execute();return c&&!t&&(delete c.user._redirectEventId,await i._persistUserIfCurrent(c.user),await i._setRedirectUser(null,e)),c}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nO=600*1e3;class sO{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!iO(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!jE(e)){const a=((i=e.error.code)==null?void 0:i.split("auth/")[1])||"internal-error";t.onError(_s(this.auth,a))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=nO&&this.cachedEventUids.clear(),this.cachedEventUids.has(_w(e))}saveEventToCache(e){this.cachedEventUids.add(_w(e)),this.lastProcessedEventTime=Date.now()}}function _w(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function jE({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function iO(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return jE(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rO(n,e={}){return Oi(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aO=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,oO=/^https?/;async function lO(n){if(n.config.emulator)return;const{authorizedDomains:e}=await rO(n);for(const t of e)try{if(cO(t))return}catch{}ts(n,"unauthorized-domain")}function cO(n){const e=dm(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const c=new URL(n);return c.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&c.hostname===i}if(!oO.test(t))return!1;if(aO.test(n))return i===n;const a=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uO=new cu(3e4,6e4);function bw(){const n=Ws().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function hO(n){return new Promise((e,t)=>{var a,l,c;function i(){bw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{bw(),t(_s(n,"network-request-failed"))},timeout:uO.get()})}if((l=(a=Ws().gapi)==null?void 0:a.iframes)!=null&&l.Iframe)e(gapi.iframes.getContext());else if((c=Ws().gapi)!=null&&c.load)i();else{const d=ek("iframefcb");return Ws()[d]=()=>{gapi.load?i():t(_s(n,"network-request-failed"))},yE(`${ZI()}?onload=${d}`).catch(g=>t(g))}}).catch(e=>{throw md=null,e})}let md=null;function dO(n){return md=md||hO(n),md}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fO=new cu(5e3,15e3),pO="__/auth/iframe",gO="emulator/auth/iframe",mO={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},yO=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function vO(n){const e=n.config;Re(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?r0(e,gO):`https://${n.config.authDomain}/${pO}`,i={apiKey:e.apiKey,appName:n.name,v:Va},a=yO.get(n.config.apiHost);a&&(i.eid=a);const l=n._getFrameworks();return l.length&&(i.fw=l.join(",")),`${t}?${lu(i).slice(1)}`}async function _O(n){const e=await dO(n),t=Ws().gapi;return Re(t,n,"internal-error"),e.open({where:document.body,url:vO(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:mO,dontclear:!0},i=>new Promise(async(a,l)=>{await i.restyle({setHideOnLeave:!1});const c=_s(n,"network-request-failed"),d=Ws().setTimeout(()=>{l(c)},fO.get());function g(){Ws().clearTimeout(d),a(i)}i.ping(g).then(g,()=>{l(c)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bO={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},wO=500,xO=600,TO="_blank",EO="http://localhost";class ww{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function SO(n,e,t,i=wO,a=xO){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),c=Math.max((window.screen.availWidth-i)/2,0).toString();let d="";const g={...bO,width:i.toString(),height:a.toString(),top:l,left:c},m=hn().toLowerCase();t&&(d=uE(m)?TO:t),lE(m)&&(e=e||EO,g.scrollbars="yes");const _=Object.entries(g).reduce((x,[S,A])=>`${x}${S}=${A},`,"");if($I(m)&&d!=="_self")return AO(e||"",d),new ww(null);const w=window.open(e||"",d,_);Re(w,n,"popup-blocked");try{w.focus()}catch{}return new ww(w)}function AO(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NO="__/auth/handler",CO="emulator/auth/handler",RO=encodeURIComponent("fac");async function xw(n,e,t,i,a,l){Re(n.config.authDomain,n,"auth-domain-config-required"),Re(n.config.apiKey,n,"invalid-api-key");const c={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Va,eventId:a};if(e instanceof u0){e.setDefaultLanguage(n.languageCode),c.providerId=e.providerId||"",VN(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,w]of Object.entries({}))c[_]=w}if(e instanceof hu){const _=e.getScopes().filter(w=>w!=="");_.length>0&&(c.scopes=_.join(","))}n.tenantId&&(c.tid=n.tenantId);const d=c;for(const _ of Object.keys(d))d[_]===void 0&&delete d[_];const g=await n._getAppCheckToken(),m=g?`#${RO}=${encodeURIComponent(g)}`:"";return`${IO(n)}?${lu(d).slice(1)}${m}`}function IO({config:n}){return n.emulator?r0(n,CO):`https://${n.authDomain}/${NO}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bg="webStorageSupport";class kO{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=AE,this._completeRedirectFn=tO,this._overrideRedirectResult=Xk}async _openPopup(e,t,i,a){var c;Ci((c=this.eventManagers[e._key()])==null?void 0:c.manager,"_initialize() not called before _openPopup()");const l=await xw(e,t,i,dm(),a);return SO(e,l,h0())}async _openRedirect(e,t,i,a){await this._originValidation(e);const l=await xw(e,t,i,dm(),a);return Dk(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:a,promise:l}=this.eventManagers[t];return a?Promise.resolve(a):(Ci(l,"If manager is not set, promise should be"),l)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await _O(e),i=new sO(e);return t.register("authEvent",a=>(Re(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:i.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Bg,{type:Bg},a=>{var c;const l=(c=a==null?void 0:a[0])==null?void 0:c[Bg];l!==void 0&&t(!!l),ts(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=lO(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return gE()||cE()||o0()}}const OO=kO;var Tw="@firebase/auth",Ew="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jO{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Re(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DO(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function PO(n){ws(new es("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:c,authDomain:d}=i.options;Re(c&&!c.includes(":"),"invalid-api-key",{appName:i.name});const g={apiKey:c,authDomain:d,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:mE(n)},m=new QI(i,a,l,g);return ak(m,t),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),ws(new es("auth-internal",e=>{const t=Lr(e.getProvider("auth").getImmediate());return(i=>new jO(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),An(Tw,Ew,DO(n)),An(Tw,Ew,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MO=300,LO=TT("authIdTokenMaxAge")||MO;let Sw=null;const UO=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>LO)return;const a=t==null?void 0:t.token;Sw!==a&&(Sw=a,await fetch(n,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function VO(n=Zd()){const e=Pr(n,"auth");if(e.isInitialized())return e.getImmediate();const t=rk(n,{popupRedirectResolver:OO,persistence:[qk,kk,AE]}),i=TT("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(i,location.origin);if(location.origin===l.origin){const c=UO(l.toString());Ak(t,c,()=>c(t.currentUser)),Sk(t,d=>c(d))}}const a=bT("auth");return a&&ok(t,`http://${a}`),t}function BO(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}JI({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=a=>{const l=_s("internal-error");l.customData=a,t(l)},i.type="text/javascript",i.charset="UTF-8",BO().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});PO("Browser");var Aw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Sr,DE;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(R,N){function k(){}k.prototype=N.prototype,R.F=N.prototype,R.prototype=new k,R.prototype.constructor=R,R.D=function(M,L,F){for(var j=Array(arguments.length-2),ce=2;ce<arguments.length;ce++)j[ce-2]=arguments[ce];return N.prototype[L].apply(M,j)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(R,N,k){k||(k=0);const M=Array(16);if(typeof N=="string")for(var L=0;L<16;++L)M[L]=N.charCodeAt(k++)|N.charCodeAt(k++)<<8|N.charCodeAt(k++)<<16|N.charCodeAt(k++)<<24;else for(L=0;L<16;++L)M[L]=N[k++]|N[k++]<<8|N[k++]<<16|N[k++]<<24;N=R.g[0],k=R.g[1],L=R.g[2];let F=R.g[3],j;j=N+(F^k&(L^F))+M[0]+3614090360&4294967295,N=k+(j<<7&4294967295|j>>>25),j=F+(L^N&(k^L))+M[1]+3905402710&4294967295,F=N+(j<<12&4294967295|j>>>20),j=L+(k^F&(N^k))+M[2]+606105819&4294967295,L=F+(j<<17&4294967295|j>>>15),j=k+(N^L&(F^N))+M[3]+3250441966&4294967295,k=L+(j<<22&4294967295|j>>>10),j=N+(F^k&(L^F))+M[4]+4118548399&4294967295,N=k+(j<<7&4294967295|j>>>25),j=F+(L^N&(k^L))+M[5]+1200080426&4294967295,F=N+(j<<12&4294967295|j>>>20),j=L+(k^F&(N^k))+M[6]+2821735955&4294967295,L=F+(j<<17&4294967295|j>>>15),j=k+(N^L&(F^N))+M[7]+4249261313&4294967295,k=L+(j<<22&4294967295|j>>>10),j=N+(F^k&(L^F))+M[8]+1770035416&4294967295,N=k+(j<<7&4294967295|j>>>25),j=F+(L^N&(k^L))+M[9]+2336552879&4294967295,F=N+(j<<12&4294967295|j>>>20),j=L+(k^F&(N^k))+M[10]+4294925233&4294967295,L=F+(j<<17&4294967295|j>>>15),j=k+(N^L&(F^N))+M[11]+2304563134&4294967295,k=L+(j<<22&4294967295|j>>>10),j=N+(F^k&(L^F))+M[12]+1804603682&4294967295,N=k+(j<<7&4294967295|j>>>25),j=F+(L^N&(k^L))+M[13]+4254626195&4294967295,F=N+(j<<12&4294967295|j>>>20),j=L+(k^F&(N^k))+M[14]+2792965006&4294967295,L=F+(j<<17&4294967295|j>>>15),j=k+(N^L&(F^N))+M[15]+1236535329&4294967295,k=L+(j<<22&4294967295|j>>>10),j=N+(L^F&(k^L))+M[1]+4129170786&4294967295,N=k+(j<<5&4294967295|j>>>27),j=F+(k^L&(N^k))+M[6]+3225465664&4294967295,F=N+(j<<9&4294967295|j>>>23),j=L+(N^k&(F^N))+M[11]+643717713&4294967295,L=F+(j<<14&4294967295|j>>>18),j=k+(F^N&(L^F))+M[0]+3921069994&4294967295,k=L+(j<<20&4294967295|j>>>12),j=N+(L^F&(k^L))+M[5]+3593408605&4294967295,N=k+(j<<5&4294967295|j>>>27),j=F+(k^L&(N^k))+M[10]+38016083&4294967295,F=N+(j<<9&4294967295|j>>>23),j=L+(N^k&(F^N))+M[15]+3634488961&4294967295,L=F+(j<<14&4294967295|j>>>18),j=k+(F^N&(L^F))+M[4]+3889429448&4294967295,k=L+(j<<20&4294967295|j>>>12),j=N+(L^F&(k^L))+M[9]+568446438&4294967295,N=k+(j<<5&4294967295|j>>>27),j=F+(k^L&(N^k))+M[14]+3275163606&4294967295,F=N+(j<<9&4294967295|j>>>23),j=L+(N^k&(F^N))+M[3]+4107603335&4294967295,L=F+(j<<14&4294967295|j>>>18),j=k+(F^N&(L^F))+M[8]+1163531501&4294967295,k=L+(j<<20&4294967295|j>>>12),j=N+(L^F&(k^L))+M[13]+2850285829&4294967295,N=k+(j<<5&4294967295|j>>>27),j=F+(k^L&(N^k))+M[2]+4243563512&4294967295,F=N+(j<<9&4294967295|j>>>23),j=L+(N^k&(F^N))+M[7]+1735328473&4294967295,L=F+(j<<14&4294967295|j>>>18),j=k+(F^N&(L^F))+M[12]+2368359562&4294967295,k=L+(j<<20&4294967295|j>>>12),j=N+(k^L^F)+M[5]+4294588738&4294967295,N=k+(j<<4&4294967295|j>>>28),j=F+(N^k^L)+M[8]+2272392833&4294967295,F=N+(j<<11&4294967295|j>>>21),j=L+(F^N^k)+M[11]+1839030562&4294967295,L=F+(j<<16&4294967295|j>>>16),j=k+(L^F^N)+M[14]+4259657740&4294967295,k=L+(j<<23&4294967295|j>>>9),j=N+(k^L^F)+M[1]+2763975236&4294967295,N=k+(j<<4&4294967295|j>>>28),j=F+(N^k^L)+M[4]+1272893353&4294967295,F=N+(j<<11&4294967295|j>>>21),j=L+(F^N^k)+M[7]+4139469664&4294967295,L=F+(j<<16&4294967295|j>>>16),j=k+(L^F^N)+M[10]+3200236656&4294967295,k=L+(j<<23&4294967295|j>>>9),j=N+(k^L^F)+M[13]+681279174&4294967295,N=k+(j<<4&4294967295|j>>>28),j=F+(N^k^L)+M[0]+3936430074&4294967295,F=N+(j<<11&4294967295|j>>>21),j=L+(F^N^k)+M[3]+3572445317&4294967295,L=F+(j<<16&4294967295|j>>>16),j=k+(L^F^N)+M[6]+76029189&4294967295,k=L+(j<<23&4294967295|j>>>9),j=N+(k^L^F)+M[9]+3654602809&4294967295,N=k+(j<<4&4294967295|j>>>28),j=F+(N^k^L)+M[12]+3873151461&4294967295,F=N+(j<<11&4294967295|j>>>21),j=L+(F^N^k)+M[15]+530742520&4294967295,L=F+(j<<16&4294967295|j>>>16),j=k+(L^F^N)+M[2]+3299628645&4294967295,k=L+(j<<23&4294967295|j>>>9),j=N+(L^(k|~F))+M[0]+4096336452&4294967295,N=k+(j<<6&4294967295|j>>>26),j=F+(k^(N|~L))+M[7]+1126891415&4294967295,F=N+(j<<10&4294967295|j>>>22),j=L+(N^(F|~k))+M[14]+2878612391&4294967295,L=F+(j<<15&4294967295|j>>>17),j=k+(F^(L|~N))+M[5]+4237533241&4294967295,k=L+(j<<21&4294967295|j>>>11),j=N+(L^(k|~F))+M[12]+1700485571&4294967295,N=k+(j<<6&4294967295|j>>>26),j=F+(k^(N|~L))+M[3]+2399980690&4294967295,F=N+(j<<10&4294967295|j>>>22),j=L+(N^(F|~k))+M[10]+4293915773&4294967295,L=F+(j<<15&4294967295|j>>>17),j=k+(F^(L|~N))+M[1]+2240044497&4294967295,k=L+(j<<21&4294967295|j>>>11),j=N+(L^(k|~F))+M[8]+1873313359&4294967295,N=k+(j<<6&4294967295|j>>>26),j=F+(k^(N|~L))+M[15]+4264355552&4294967295,F=N+(j<<10&4294967295|j>>>22),j=L+(N^(F|~k))+M[6]+2734768916&4294967295,L=F+(j<<15&4294967295|j>>>17),j=k+(F^(L|~N))+M[13]+1309151649&4294967295,k=L+(j<<21&4294967295|j>>>11),j=N+(L^(k|~F))+M[4]+4149444226&4294967295,N=k+(j<<6&4294967295|j>>>26),j=F+(k^(N|~L))+M[11]+3174756917&4294967295,F=N+(j<<10&4294967295|j>>>22),j=L+(N^(F|~k))+M[2]+718787259&4294967295,L=F+(j<<15&4294967295|j>>>17),j=k+(F^(L|~N))+M[9]+3951481745&4294967295,R.g[0]=R.g[0]+N&4294967295,R.g[1]=R.g[1]+(L+(j<<21&4294967295|j>>>11))&4294967295,R.g[2]=R.g[2]+L&4294967295,R.g[3]=R.g[3]+F&4294967295}i.prototype.v=function(R,N){N===void 0&&(N=R.length);const k=N-this.blockSize,M=this.C;let L=this.h,F=0;for(;F<N;){if(L==0)for(;F<=k;)a(this,R,F),F+=this.blockSize;if(typeof R=="string"){for(;F<N;)if(M[L++]=R.charCodeAt(F++),L==this.blockSize){a(this,M),L=0;break}}else for(;F<N;)if(M[L++]=R[F++],L==this.blockSize){a(this,M),L=0;break}}this.h=L,this.o+=N},i.prototype.A=function(){var R=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);R[0]=128;for(var N=1;N<R.length-8;++N)R[N]=0;N=this.o*8;for(var k=R.length-8;k<R.length;++k)R[k]=N&255,N/=256;for(this.v(R),R=Array(16),N=0,k=0;k<4;++k)for(let M=0;M<32;M+=8)R[N++]=this.g[k]>>>M&255;return R};function l(R,N){var k=d;return Object.prototype.hasOwnProperty.call(k,R)?k[R]:k[R]=N(R)}function c(R,N){this.h=N;const k=[];let M=!0;for(let L=R.length-1;L>=0;L--){const F=R[L]|0;M&&F==N||(k[L]=F,M=!1)}this.g=k}var d={};function g(R){return-128<=R&&R<128?l(R,function(N){return new c([N|0],N<0?-1:0)}):new c([R|0],R<0?-1:0)}function m(R){if(isNaN(R)||!isFinite(R))return w;if(R<0)return I(m(-R));const N=[];let k=1;for(let M=0;R>=k;M++)N[M]=R/k|0,k*=4294967296;return new c(N,0)}function _(R,N){if(R.length==0)throw Error("number format error: empty string");if(N=N||10,N<2||36<N)throw Error("radix out of range: "+N);if(R.charAt(0)=="-")return I(_(R.substring(1),N));if(R.indexOf("-")>=0)throw Error('number format error: interior "-" character');const k=m(Math.pow(N,8));let M=w;for(let F=0;F<R.length;F+=8){var L=Math.min(8,R.length-F);const j=parseInt(R.substring(F,F+L),N);L<8?(L=m(Math.pow(N,L)),M=M.j(L).add(m(j))):(M=M.j(k),M=M.add(m(j)))}return M}var w=g(0),x=g(1),S=g(16777216);n=c.prototype,n.m=function(){if(D(this))return-I(this).m();let R=0,N=1;for(let k=0;k<this.g.length;k++){const M=this.i(k);R+=(M>=0?M:4294967296+M)*N,N*=4294967296}return R},n.toString=function(R){if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(A(this))return"0";if(D(this))return"-"+I(this).toString(R);const N=m(Math.pow(R,6));var k=this;let M="";for(;;){const L=O(k,N).g;k=U(k,L.j(N));let F=((k.g.length>0?k.g[0]:k.h)>>>0).toString(R);if(k=L,A(k))return F+M;for(;F.length<6;)F="0"+F;M=F+M}},n.i=function(R){return R<0?0:R<this.g.length?this.g[R]:this.h};function A(R){if(R.h!=0)return!1;for(let N=0;N<R.g.length;N++)if(R.g[N]!=0)return!1;return!0}function D(R){return R.h==-1}n.l=function(R){return R=U(this,R),D(R)?-1:A(R)?0:1};function I(R){const N=R.g.length,k=[];for(let M=0;M<N;M++)k[M]=~R.g[M];return new c(k,~R.h).add(x)}n.abs=function(){return D(this)?I(this):this},n.add=function(R){const N=Math.max(this.g.length,R.g.length),k=[];let M=0;for(let L=0;L<=N;L++){let F=M+(this.i(L)&65535)+(R.i(L)&65535),j=(F>>>16)+(this.i(L)>>>16)+(R.i(L)>>>16);M=j>>>16,F&=65535,j&=65535,k[L]=j<<16|F}return new c(k,k[k.length-1]&-2147483648?-1:0)};function U(R,N){return R.add(I(N))}n.j=function(R){if(A(this)||A(R))return w;if(D(this))return D(R)?I(this).j(I(R)):I(I(this).j(R));if(D(R))return I(this.j(I(R)));if(this.l(S)<0&&R.l(S)<0)return m(this.m()*R.m());const N=this.g.length+R.g.length,k=[];for(var M=0;M<2*N;M++)k[M]=0;for(M=0;M<this.g.length;M++)for(let L=0;L<R.g.length;L++){const F=this.i(M)>>>16,j=this.i(M)&65535,ce=R.i(L)>>>16,ue=R.i(L)&65535;k[2*M+2*L]+=j*ue,q(k,2*M+2*L),k[2*M+2*L+1]+=F*ue,q(k,2*M+2*L+1),k[2*M+2*L+1]+=j*ce,q(k,2*M+2*L+1),k[2*M+2*L+2]+=F*ce,q(k,2*M+2*L+2)}for(R=0;R<N;R++)k[R]=k[2*R+1]<<16|k[2*R];for(R=N;R<2*N;R++)k[R]=0;return new c(k,0)};function q(R,N){for(;(R[N]&65535)!=R[N];)R[N+1]+=R[N]>>>16,R[N]&=65535,N++}function z(R,N){this.g=R,this.h=N}function O(R,N){if(A(N))throw Error("division by zero");if(A(R))return new z(w,w);if(D(R))return N=O(I(R),N),new z(I(N.g),I(N.h));if(D(N))return N=O(R,I(N)),new z(I(N.g),N.h);if(R.g.length>30){if(D(R)||D(N))throw Error("slowDivide_ only works with positive integers.");for(var k=x,M=N;M.l(R)<=0;)k=$(k),M=$(M);var L=Q(k,1),F=Q(M,1);for(M=Q(M,2),k=Q(k,2);!A(M);){var j=F.add(M);j.l(R)<=0&&(L=L.add(k),F=j),M=Q(M,1),k=Q(k,1)}return N=U(R,L.j(N)),new z(L,N)}for(L=w;R.l(N)>=0;){for(k=Math.max(1,Math.floor(R.m()/N.m())),M=Math.ceil(Math.log(k)/Math.LN2),M=M<=48?1:Math.pow(2,M-48),F=m(k),j=F.j(N);D(j)||j.l(R)>0;)k-=M,F=m(k),j=F.j(N);A(F)&&(F=x),L=L.add(F),R=U(R,j)}return new z(L,R)}n.B=function(R){return O(this,R).h},n.and=function(R){const N=Math.max(this.g.length,R.g.length),k=[];for(let M=0;M<N;M++)k[M]=this.i(M)&R.i(M);return new c(k,this.h&R.h)},n.or=function(R){const N=Math.max(this.g.length,R.g.length),k=[];for(let M=0;M<N;M++)k[M]=this.i(M)|R.i(M);return new c(k,this.h|R.h)},n.xor=function(R){const N=Math.max(this.g.length,R.g.length),k=[];for(let M=0;M<N;M++)k[M]=this.i(M)^R.i(M);return new c(k,this.h^R.h)};function $(R){const N=R.g.length+1,k=[];for(let M=0;M<N;M++)k[M]=R.i(M)<<1|R.i(M-1)>>>31;return new c(k,R.h)}function Q(R,N){const k=N>>5;N%=32;const M=R.g.length-k,L=[];for(let F=0;F<M;F++)L[F]=N>0?R.i(F+k)>>>N|R.i(F+k+1)<<32-N:R.i(F+k);return new c(L,R.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,DE=i,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.B,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=m,c.fromString=_,Sr=c}).apply(typeof Aw<"u"?Aw:typeof self<"u"?self:typeof window<"u"?window:{});var Zh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var PE,Rc,ME,yd,mm,LE,UE,VE;(function(){var n,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Zh=="object"&&Zh];for(var v=0;v<h.length;++v){var T=h[v];if(T&&T.Math==Math)return T}throw Error("Cannot find global object")}var i=t(this);function a(h,v){if(v)e:{var T=i;h=h.split(".");for(var C=0;C<h.length-1;C++){var K=h[C];if(!(K in T))break e;T=T[K]}h=h[h.length-1],C=T[h],v=v(C),v!=C&&v!=null&&e(T,h,{configurable:!0,writable:!0,value:v})}}a("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(h){return h||function(v){var T=[],C;for(C in v)Object.prototype.hasOwnProperty.call(v,C)&&T.push([C,v[C]]);return T}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},c=this||self;function d(h){var v=typeof h;return v=="object"&&h!=null||v=="function"}function g(h,v,T){return h.call.apply(h.bind,arguments)}function m(h,v,T){return m=g,m.apply(null,arguments)}function _(h,v){var T=Array.prototype.slice.call(arguments,1);return function(){var C=T.slice();return C.push.apply(C,arguments),h.apply(this,C)}}function w(h,v){function T(){}T.prototype=v.prototype,h.Z=v.prototype,h.prototype=new T,h.prototype.constructor=h,h.Ob=function(C,K,Z){for(var fe=Array(arguments.length-2),De=2;De<arguments.length;De++)fe[De-2]=arguments[De];return v.prototype[K].apply(C,fe)}}var x=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function S(h){const v=h.length;if(v>0){const T=Array(v);for(let C=0;C<v;C++)T[C]=h[C];return T}return[]}function A(h,v){for(let C=1;C<arguments.length;C++){const K=arguments[C];var T=typeof K;if(T=T!="object"?T:K?Array.isArray(K)?"array":T:"null",T=="array"||T=="object"&&typeof K.length=="number"){T=h.length||0;const Z=K.length||0;h.length=T+Z;for(let fe=0;fe<Z;fe++)h[T+fe]=K[fe]}else h.push(K)}}class D{constructor(v,T){this.i=v,this.j=T,this.h=0,this.g=null}get(){let v;return this.h>0?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function I(h){c.setTimeout(()=>{throw h},0)}function U(){var h=R;let v=null;return h.g&&(v=h.g,h.g=h.g.next,h.g||(h.h=null),v.next=null),v}class q{constructor(){this.h=this.g=null}add(v,T){const C=z.get();C.set(v,T),this.h?this.h.next=C:this.g=C,this.h=C}}var z=new D(()=>new O,h=>h.reset());class O{constructor(){this.next=this.g=this.h=null}set(v,T){this.h=v,this.g=T,this.next=null}reset(){this.next=this.g=this.h=null}}let $,Q=!1,R=new q,N=()=>{const h=Promise.resolve(void 0);$=()=>{h.then(k)}};function k(){for(var h;h=U();){try{h.h.call(h.g)}catch(T){I(T)}var v=z;v.j(h),v.h<100&&(v.h++,h.next=v.g,v.g=h)}Q=!1}function M(){this.u=this.u,this.C=this.C}M.prototype.u=!1,M.prototype.dispose=function(){this.u||(this.u=!0,this.N())},M.prototype[Symbol.dispose]=function(){this.dispose()},M.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function L(h,v){this.type=h,this.g=this.target=v,this.defaultPrevented=!1}L.prototype.h=function(){this.defaultPrevented=!0};var F=(function(){if(!c.addEventListener||!Object.defineProperty)return!1;var h=!1,v=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const T=()=>{};c.addEventListener("test",T,v),c.removeEventListener("test",T,v)}catch{}return h})();function j(h){return/^[\s\xa0]*$/.test(h)}function ce(h,v){L.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,v)}w(ce,L),ce.prototype.init=function(h,v){const T=this.type=h.type,C=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=v,v=h.relatedTarget,v||(T=="mouseover"?v=h.fromElement:T=="mouseout"&&(v=h.toElement)),this.relatedTarget=v,C?(this.clientX=C.clientX!==void 0?C.clientX:C.pageX,this.clientY=C.clientY!==void 0?C.clientY:C.pageY,this.screenX=C.screenX||0,this.screenY=C.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&ce.Z.h.call(this)},ce.prototype.h=function(){ce.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var ue="closure_listenable_"+(Math.random()*1e6|0),B=0;function se(h,v,T,C,K){this.listener=h,this.proxy=null,this.src=v,this.type=T,this.capture=!!C,this.ha=K,this.key=++B,this.da=this.fa=!1}function ge(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function be(h,v,T){for(const C in h)v.call(T,h[C],C,h)}function Le(h,v){for(const T in h)v.call(void 0,h[T],T,h)}function V(h){const v={};for(const T in h)v[T]=h[T];return v}const te="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function de(h,v){let T,C;for(let K=1;K<arguments.length;K++){C=arguments[K];for(T in C)h[T]=C[T];for(let Z=0;Z<te.length;Z++)T=te[Z],Object.prototype.hasOwnProperty.call(C,T)&&(h[T]=C[T])}}function pe(h){this.src=h,this.g={},this.h=0}pe.prototype.add=function(h,v,T,C,K){const Z=h.toString();h=this.g[Z],h||(h=this.g[Z]=[],this.h++);const fe=X(h,v,C,K);return fe>-1?(v=h[fe],T||(v.fa=!1)):(v=new se(v,this.src,Z,!!C,K),v.fa=T,h.push(v)),v};function Se(h,v){const T=v.type;if(T in h.g){var C=h.g[T],K=Array.prototype.indexOf.call(C,v,void 0),Z;(Z=K>=0)&&Array.prototype.splice.call(C,K,1),Z&&(ge(v),h.g[T].length==0&&(delete h.g[T],h.h--))}}function X(h,v,T,C){for(let K=0;K<h.length;++K){const Z=h[K];if(!Z.da&&Z.listener==v&&Z.capture==!!T&&Z.ha==C)return K}return-1}var he="closure_lm_"+(Math.random()*1e6|0),ve={};function Ke(h,v,T,C,K){if(Array.isArray(v)){for(let Z=0;Z<v.length;Z++)Ke(h,v[Z],T,C,K);return null}return T=bl(T),h&&h[ue]?h.J(v,T,d(C)?!!C.capture:!1,K):qt(h,v,T,!1,C,K)}function qt(h,v,T,C,K,Z){if(!v)throw Error("Invalid event type");const fe=d(K)?!!K.capture:!!K;let De=zr(h);if(De||(h[he]=De=new pe(h)),T=De.add(v,T,C,fe,Z),T.proxy)return T;if(C=Ts(),T.proxy=C,C.src=h,C.listener=T,h.addEventListener)F||(K=fe),K===void 0&&(K=!1),h.addEventListener(v.toString(),C,K);else if(h.attachEvent)h.attachEvent(Es(v.toString()),C);else if(h.addListener&&h.removeListener)h.addListener(C);else throw Error("addEventListener and attachEvent are unavailable.");return T}function Ts(){function h(T){return v.call(h.src,h.listener,T)}const v=vl;return h}function Ha(h,v,T,C,K){if(Array.isArray(v))for(var Z=0;Z<v.length;Z++)Ha(h,v[Z],T,C,K);else C=d(C)?!!C.capture:!!C,T=bl(T),h&&h[ue]?(h=h.i,Z=String(v).toString(),Z in h.g&&(v=h.g[Z],T=X(v,T,C,K),T>-1&&(ge(v[T]),Array.prototype.splice.call(v,T,1),v.length==0&&(delete h.g[Z],h.h--)))):h&&(h=zr(h))&&(v=h.g[v.toString()],h=-1,v&&(h=X(v,T,C,K)),(T=h>-1?v[h]:null)&&qa(T))}function qa(h){if(typeof h!="number"&&h&&!h.da){var v=h.src;if(v&&v[ue])Se(v.i,h);else{var T=h.type,C=h.proxy;v.removeEventListener?v.removeEventListener(T,C,h.capture):v.detachEvent?v.detachEvent(Es(T),C):v.addListener&&v.removeListener&&v.removeListener(C),(T=zr(v))?(Se(T,h),T.h==0&&(T.src=null,v[he]=null)):ge(h)}}}function Es(h){return h in ve?ve[h]:ve[h]="on"+h}function vl(h,v){if(h.da)h=!0;else{v=new ce(v,this);const T=h.listener,C=h.ha||h.src;h.fa&&qa(h),h=T.call(C,v)}return h}function zr(h){return h=h[he],h instanceof pe?h:null}var _l="__closure_events_fn_"+(Math.random()*1e9>>>0);function bl(h){return typeof h=="function"?h:(h[_l]||(h[_l]=function(v){return h.handleEvent(v)}),h[_l])}function At(){M.call(this),this.i=new pe(this),this.M=this,this.G=null}w(At,M),At.prototype[ue]=!0,At.prototype.removeEventListener=function(h,v,T,C){Ha(this,h,v,T,C)};function Vt(h,v){var T,C=h.G;if(C)for(T=[];C;C=C.G)T.push(C);if(h=h.M,C=v.type||v,typeof v=="string")v=new L(v,h);else if(v instanceof L)v.target=v.target||h;else{var K=v;v=new L(C,h),de(v,K)}K=!0;let Z,fe;if(T)for(fe=T.length-1;fe>=0;fe--)Z=v.g=T[fe],K=Di(Z,C,!0,v)&&K;if(Z=v.g=h,K=Di(Z,C,!0,v)&&K,K=Di(Z,C,!1,v)&&K,T)for(fe=0;fe<T.length;fe++)Z=v.g=T[fe],K=Di(Z,C,!1,v)&&K}At.prototype.N=function(){if(At.Z.N.call(this),this.i){var h=this.i;for(const v in h.g){const T=h.g[v];for(let C=0;C<T.length;C++)ge(T[C]);delete h.g[v],h.h--}}this.G=null},At.prototype.J=function(h,v,T,C){return this.i.add(String(h),v,!1,T,C)},At.prototype.K=function(h,v,T,C){return this.i.add(String(h),v,!0,T,C)};function Di(h,v,T,C){if(v=h.i.g[String(v)],!v)return!0;v=v.concat();let K=!0;for(let Z=0;Z<v.length;++Z){const fe=v[Z];if(fe&&!fe.da&&fe.capture==T){const De=fe.listener,wt=fe.ha||fe.src;fe.fa&&Se(h.i,fe),K=De.call(wt,C)!==!1&&K}}return K&&!C.defaultPrevented}function Af(h,v){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=m(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(v)>2147483647?-1:c.setTimeout(h,v||0)}function Tu(h){h.g=Af(()=>{h.g=null,h.i&&(h.i=!1,Tu(h))},h.l);const v=h.h;h.h=null,h.m.apply(null,v)}class dn extends M{constructor(v,T){super(),this.m=v,this.l=T,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:Tu(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Hr(h){M.call(this),this.h=h,this.g={}}w(Hr,M);var wl=[];function xl(h){be(h.g,function(v,T){this.g.hasOwnProperty(T)&&qa(v)},h),h.g={}}Hr.prototype.N=function(){Hr.Z.N.call(this),xl(this)},Hr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Pi=c.JSON.stringify,Nf=c.JSON.parse,Eu=class{stringify(h){return c.JSON.stringify(h,void 0)}parse(h){return c.JSON.parse(h,void 0)}};function Su(){}function Au(){}var ss={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Yt(){L.call(this,"d")}w(Yt,L);function Bn(){L.call(this,"c")}w(Bn,L);var bt={},Nu=null;function $a(){return Nu=Nu||new At}bt.Ia="serverreachability";function Cu(h){L.call(this,bt.Ia,h)}w(Cu,L);function Ss(h){const v=$a();Vt(v,new Cu(v))}bt.STAT_EVENT="statevent";function qr(h,v){L.call(this,bt.STAT_EVENT,h),this.stat=v}w(qr,L);function Nt(h){const v=$a();Vt(v,new qr(v,h))}bt.Ja="timingevent";function As(h,v){L.call(this,bt.Ja,h),this.size=v}w(As,L);function Ns(h,v){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){h()},v)}function is(){this.g=!0}is.prototype.ua=function(){this.g=!1};function Cf(h,v,T,C,K,Z){h.info(function(){if(h.g)if(Z){var fe="",De=Z.split("&");for(let Qe=0;Qe<De.length;Qe++){var wt=De[Qe].split("=");if(wt.length>1){const dt=wt[0];wt=wt[1];const $n=dt.split("_");fe=$n.length>=2&&$n[1]=="type"?fe+(dt+"="+wt+"&"):fe+(dt+"=redacted&")}}}else fe=null;else fe=Z;return"XMLHTTP REQ ("+C+") [attempt "+K+"]: "+v+`
`+T+`
`+fe})}function Ru(h,v,T,C,K,Z,fe){h.info(function(){return"XMLHTTP RESP ("+C+") [ attempt "+K+"]: "+v+`
`+T+`
`+Z+" "+fe})}function Cs(h,v,T,C){h.info(function(){return"XMLHTTP TEXT ("+v+"): "+Rf(h,T)+(C?" "+C:"")})}function $r(h,v){h.info(function(){return"TIMEOUT: "+v})}is.prototype.info=function(){};function Rf(h,v){if(!h.g)return v;if(!v)return null;try{const Z=JSON.parse(v);if(Z){for(h=0;h<Z.length;h++)if(Array.isArray(Z[h])){var T=Z[h];if(!(T.length<2)){var C=T[1];if(Array.isArray(C)&&!(C.length<1)){var K=C[0];if(K!="noop"&&K!="stop"&&K!="close")for(let fe=1;fe<C.length;fe++)C[fe]=""}}}}return Pi(Z)}catch{return v}}var Fr={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Tl={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},El;function Gr(){}w(Gr,Su),Gr.prototype.g=function(){return new XMLHttpRequest},El=new Gr;function ni(h){return encodeURIComponent(String(h))}function Iu(h){var v=1;h=h.split(":");const T=[];for(;v>0&&h.length;)T.push(h.shift()),v--;return h.length&&T.push(h.join(":")),T}function rs(h,v,T,C){this.j=h,this.i=v,this.l=T,this.S=C||1,this.V=new Hr(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new as}function as(){this.i=null,this.g="",this.h=!1}var Ct={},$t={};function Rs(h,v,T){h.M=1,h.A=Kr(It(v)),h.u=T,h.R=!0,Fa(h,null)}function Fa(h,v){h.F=Date.now(),Is(h),h.B=It(h.A);var T=h.B,C=h.S;Array.isArray(C)||(C=[String(C)]),Wa(T.i,"t",C),h.C=0,T=h.j.L,h.h=new as,h.g=Fu(h.j,T?v:null,!h.u),h.P>0&&(h.O=new dn(m(h.Y,h,h.g),h.P)),v=h.V,T=h.g,C=h.ba;var K="readystatechange";Array.isArray(K)||(K&&(wl[0]=K.toString()),K=wl);for(let Z=0;Z<K.length;Z++){const fe=Ke(T,K[Z],C||v.handleEvent,!1,v.h||v);if(!fe)break;v.g[fe.key]=fe}v=h.J?V(h.J):{},h.u?(h.v||(h.v="POST"),v["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,v)):(h.v="GET",h.g.ea(h.B,h.v,null,v)),Ss(),Cf(h.i,h.v,h.B,h.l,h.S,h.u)}rs.prototype.ba=function(h){h=h.target;const v=this.O;v&&cs(h)==3?v.j():this.Y(h)},rs.prototype.Y=function(h){try{if(h==this.g)e:{const De=cs(this.g),wt=this.g.ya(),Qe=this.g.ca();if(!(De<3)&&(De!=3||this.g&&(this.h.h||this.g.la()||Wt(this.g)))){this.K||De!=4||wt==7||(wt==8||Qe<=0?Ss(3):Ss(2)),ks(this);var v=this.g.ca();this.X=v;var T=If(this);if(this.o=v==200,Ru(this.i,this.v,this.B,this.l,this.S,De,v),this.o){if(this.U&&!this.L){t:{if(this.g){var C,K=this.g;if((C=K.g?K.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(C)){var Z=C;break t}}Z=null}if(h=Z)Cs(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Os(this,h);else{this.o=!1,this.m=3,Nt(12),Cn(this),zn(this);break e}}if(this.R){h=!0;let dt;for(;!this.K&&this.C<T.length;)if(dt=Ou(this,T),dt==$t){De==4&&(this.m=4,Nt(14),h=!1),Cs(this.i,this.l,null,"[Incomplete Response]");break}else if(dt==Ct){this.m=4,Nt(15),Cs(this.i,this.l,T,"[Invalid Chunk]"),h=!1;break}else Cs(this.i,this.l,dt,null),Os(this,dt);if(ku(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),De!=4||T.length!=0||this.h.h||(this.m=1,Nt(16),h=!1),this.o=this.o&&h,!h)Cs(this.i,this.l,T,"[Invalid Chunked Response]"),Cn(this),zn(this);else if(T.length>0&&!this.W){this.W=!0;var fe=this.j;fe.g==this&&fe.aa&&!fe.P&&(fe.j.info("Great, no buffering proxy detected. Bytes received: "+T.length),Vl(fe),fe.P=!0,Nt(11))}}else Cs(this.i,this.l,T,null),Os(this,T);De==4&&Cn(this),this.o&&!this.K&&(De==4?zu(this.j,this):(this.o=!1,Is(this)))}else ii(this.g),v==400&&T.indexOf("Unknown SID")>0?(this.m=3,Nt(12)):(this.m=0,Nt(13)),Cn(this),zn(this)}}}catch{}finally{}};function If(h){if(!ku(h))return h.g.la();const v=Wt(h.g);if(v==="")return"";let T="";const C=v.length,K=cs(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return Cn(h),zn(h),"";h.h.i=new c.TextDecoder}for(let Z=0;Z<C;Z++)h.h.h=!0,T+=h.h.i.decode(v[Z],{stream:!(K&&Z==C-1)});return v.length=0,h.h.g+=T,h.C=0,h.h.g}function ku(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function Ou(h,v){var T=h.C,C=v.indexOf(`
`,T);return C==-1?$t:(T=Number(v.substring(T,C)),isNaN(T)?Ct:(C+=1,C+T>v.length?$t:(v=v.slice(C,C+T),h.C=C+T,v)))}rs.prototype.cancel=function(){this.K=!0,Cn(this)};function Is(h){h.T=Date.now()+h.H,Ga(h,h.H)}function Ga(h,v){if(h.D!=null)throw Error("WatchDog timer not null");h.D=Ns(m(h.aa,h),v)}function ks(h){h.D&&(c.clearTimeout(h.D),h.D=null)}rs.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?($r(this.i,this.B),this.M!=2&&(Ss(),Nt(17)),Cn(this),this.m=2,zn(this)):Ga(this,this.T-h)};function zn(h){h.j.I==0||h.K||zu(h.j,h)}function Cn(h){ks(h);var v=h.O;v&&typeof v.dispose=="function"&&v.dispose(),h.O=null,xl(h.V),h.g&&(v=h.g,h.g=null,v.abort(),v.dispose())}function Os(h,v){try{var T=h.j;if(T.I!=0&&(T.g==h||Ds(T.h,h))){if(!h.L&&Ds(T.h,h)&&T.I==3){try{var C=T.Ba.g.parse(v)}catch{C=null}if(Array.isArray(C)&&C.length==3){var K=C;if(K[0]==0){e:if(!T.v){if(T.g)if(T.g.F+3e3<h.F)eo(T),qi(T);else break e;ea(T),Nt(18)}}else T.xa=K[1],0<T.xa-T.K&&K[2]<37500&&T.F&&T.A==0&&!T.C&&(T.C=Ns(m(T.Va,T),6e3));js(T.h)<=1&&T.ta&&(T.ta=void 0)}else Bs(T,11)}else if((h.L||T.g==h)&&eo(T),!j(v))for(K=T.Ba.g.parse(v),v=0;v<K.length;v++){let Qe=K[v];const dt=Qe[0];if(!(dt<=T.K))if(T.K=dt,Qe=Qe[1],T.I==2)if(Qe[0]=="c"){T.M=Qe[1],T.ba=Qe[2];const $n=Qe[3];$n!=null&&(T.ka=$n,T.j.info("VER="+T.ka));const zs=Qe[4];zs!=null&&(T.za=zs,T.j.info("SVER="+T.za));const us=Qe[5];us!=null&&typeof us=="number"&&us>0&&(C=1.5*us,T.O=C,T.j.info("backChannelRequestTimeoutMs_="+C)),C=T;const hs=h.g;if(hs){const ta=hs.g?hs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ta){var Z=C.h;Z.g||ta.indexOf("spdy")==-1&&ta.indexOf("quic")==-1&&ta.indexOf("h2")==-1||(Z.j=Z.l,Z.g=new Set,Z.h&&(Nl(Z,Z.h),Z.h=null))}if(C.G){const to=hs.g?hs.g.getResponseHeader("X-HTTP-Session-Id"):null;to&&(C.wa=to,Ze(C.J,C.G,to))}}T.I=3,T.l&&T.l.ra(),T.aa&&(T.T=Date.now()-h.F,T.j.info("Handshake RTT: "+T.T+"ms")),C=T;var fe=h;if(C.na=$u(C,C.L?C.ba:null,C.W),fe.L){Cl(C.h,fe);var De=fe,wt=C.O;wt&&(De.H=wt),De.D&&(ks(De),Is(De)),C.g=fe}else Vu(C);T.i.length>0&&Vs(T)}else Qe[0]!="stop"&&Qe[0]!="close"||Bs(T,7);else T.I==3&&(Qe[0]=="stop"||Qe[0]=="close"?Qe[0]=="stop"?Bs(T,7):Ll(T):Qe[0]!="noop"&&T.l&&T.l.qa(Qe),T.A=0)}}Ss(4)}catch{}}var Rt=class{constructor(h,v){this.g=h,this.map=v}};function Sl(h){this.l=h||10,c.PerformanceNavigationTiming?(h=c.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Al(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function js(h){return h.h?1:h.g?h.g.size:0}function Ds(h,v){return h.h?h.h==v:h.g?h.g.has(v):!1}function Nl(h,v){h.g?h.g.add(v):h.h=v}function Cl(h,v){h.h&&h.h==v?h.h=null:h.g&&h.g.has(v)&&h.g.delete(v)}Sl.prototype.cancel=function(){if(this.i=Rl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Rl(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let v=h.i;for(const T of h.g.values())v=v.concat(T.G);return v}return S(h.i)}var ju=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ka(h,v){if(h){h=h.split("&");for(let T=0;T<h.length;T++){const C=h[T].indexOf("=");let K,Z=null;C>=0?(K=h[T].substring(0,C),Z=h[T].substring(C+1)):K=h[T],v(K,Z?decodeURIComponent(Z.replace(/\+/g," ")):"")}}}function Rn(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let v;h instanceof Rn?(this.l=h.l,Ft(this,h.j),this.o=h.o,this.g=h.g,Mi(this,h.u),this.h=h.h,Il(this,Lu(h.i)),this.m=h.m):h&&(v=String(h).match(ju))?(this.l=!1,Ft(this,v[1]||"",!0),this.o=Ps(v[2]||""),this.g=Ps(v[3]||"",!0),Mi(this,v[4]),this.h=Ps(v[5]||"",!0),Il(this,v[6]||"",!0),this.m=Ps(v[7]||"")):(this.l=!1,this.i=new Ui(null,this.l))}Rn.prototype.toString=function(){const h=[];var v=this.j;v&&h.push(Yr(v,Ya,!0),":");var T=this.g;return(T||v=="file")&&(h.push("//"),(v=this.o)&&h.push(Yr(v,Ya,!0),"@"),h.push(ni(T).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),T=this.u,T!=null&&h.push(":",String(T))),(T=this.h)&&(this.g&&T.charAt(0)!="/"&&h.push("/"),h.push(Yr(T,T.charAt(0)=="/"?kl:Du,!0))),(T=this.i.toString())&&h.push("?",T),(T=this.m)&&h.push("#",Yr(T,Pu)),h.join("")},Rn.prototype.resolve=function(h){const v=It(this);let T=!!h.j;T?Ft(v,h.j):T=!!h.o,T?v.o=h.o:T=!!h.g,T?v.g=h.g:T=h.u!=null;var C=h.h;if(T)Mi(v,h.u);else if(T=!!h.h){if(C.charAt(0)!="/")if(this.g&&!this.h)C="/"+C;else{var K=v.h.lastIndexOf("/");K!=-1&&(C=v.h.slice(0,K+1)+C)}if(K=C,K==".."||K==".")C="";else if(K.indexOf("./")!=-1||K.indexOf("/.")!=-1){C=K.lastIndexOf("/",0)==0,K=K.split("/");const Z=[];for(let fe=0;fe<K.length;){const De=K[fe++];De=="."?C&&fe==K.length&&Z.push(""):De==".."?((Z.length>1||Z.length==1&&Z[0]!="")&&Z.pop(),C&&fe==K.length&&Z.push("")):(Z.push(De),C=!0)}C=Z.join("/")}else C=K}return T?v.h=C:T=h.i.toString()!=="",T?Il(v,Lu(h.i)):T=!!h.m,T&&(v.m=h.m),v};function It(h){return new Rn(h)}function Ft(h,v,T){h.j=T?Ps(v,!0):v,h.j&&(h.j=h.j.replace(/:$/,""))}function Mi(h,v){if(v){if(v=Number(v),isNaN(v)||v<0)throw Error("Bad port number "+v);h.u=v}else h.u=null}function Il(h,v,T){v instanceof Ui?(h.i=v,Qa(h.i,h.l)):(T||(v=Yr(v,Li)),h.i=new Ui(v,h.l))}function Ze(h,v,T){h.i.set(v,T)}function Kr(h){return Ze(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function Ps(h,v){return h?v?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Yr(h,v,T){return typeof h=="string"?(h=encodeURI(h).replace(v,mn),T&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function mn(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Ya=/[#\/\?@]/g,Du=/[#\?:]/g,kl=/[#\?]/g,Li=/[#\?@]/g,Pu=/#/g;function Ui(h,v){this.h=this.g=null,this.i=h||null,this.j=!!v}function yn(h){h.g||(h.g=new Map,h.h=0,h.i&&Ka(h.i,function(v,T){h.add(decodeURIComponent(v.replace(/\+/g," ")),T)}))}n=Ui.prototype,n.add=function(h,v){yn(this),this.i=null,h=Vi(this,h);let T=this.g.get(h);return T||this.g.set(h,T=[]),T.push(v),this.h+=1,this};function Mu(h,v){yn(h),v=Vi(h,v),h.g.has(v)&&(h.i=null,h.h-=h.g.get(v).length,h.g.delete(v))}function Ol(h,v){return yn(h),v=Vi(h,v),h.g.has(v)}n.forEach=function(h,v){yn(this),this.g.forEach(function(T,C){T.forEach(function(K){h.call(v,K,C,this)},this)},this)};function jl(h,v){yn(h);let T=[];if(typeof v=="string")Ol(h,v)&&(T=T.concat(h.g.get(Vi(h,v))));else for(h=Array.from(h.g.values()),v=0;v<h.length;v++)T=T.concat(h[v]);return T}n.set=function(h,v){return yn(this),this.i=null,h=Vi(this,h),Ol(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[v]),this.h+=1,this},n.get=function(h,v){return h?(h=jl(this,h),h.length>0?String(h[0]):v):v};function Wa(h,v,T){Mu(h,v),T.length>0&&(h.i=null,h.g.set(Vi(h,v),S(T)),h.h+=T.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],v=Array.from(this.g.keys());for(let C=0;C<v.length;C++){var T=v[C];const K=ni(T);T=jl(this,T);for(let Z=0;Z<T.length;Z++){let fe=K;T[Z]!==""&&(fe+="="+ni(T[Z])),h.push(fe)}}return this.i=h.join("&")};function Lu(h){const v=new Ui;return v.i=h.i,h.g&&(v.g=new Map(h.g),v.h=h.h),v}function Vi(h,v){return v=String(v),h.j&&(v=v.toLowerCase()),v}function Qa(h,v){v&&!h.j&&(yn(h),h.i=null,h.g.forEach(function(T,C){const K=C.toLowerCase();C!=K&&(Mu(this,C),Wa(this,K,T))},h)),h.j=v}function os(h,v){const T=new is;if(c.Image){const C=new Image;C.onload=_(Hn,T,"TestLoadImage: loaded",!0,v,C),C.onerror=_(Hn,T,"TestLoadImage: error",!1,v,C),C.onabort=_(Hn,T,"TestLoadImage: abort",!1,v,C),C.ontimeout=_(Hn,T,"TestLoadImage: timeout",!1,v,C),c.setTimeout(function(){C.ontimeout&&C.ontimeout()},1e4),C.src=h}else v(!1)}function Dl(h,v){const T=new is,C=new AbortController,K=setTimeout(()=>{C.abort(),Hn(T,"TestPingServer: timeout",!1,v)},1e4);fetch(h,{signal:C.signal}).then(Z=>{clearTimeout(K),Z.ok?Hn(T,"TestPingServer: ok",!0,v):Hn(T,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(K),Hn(T,"TestPingServer: error",!1,v)})}function Hn(h,v,T,C,K){try{K&&(K.onload=null,K.onerror=null,K.onabort=null,K.ontimeout=null),C(T)}catch{}}function Bi(){this.g=new Eu}function Ms(h){this.i=h.Sb||null,this.h=h.ab||!1}w(Ms,Su),Ms.prototype.g=function(){return new Wr(this.i,this.h)};function Wr(h,v){At.call(this),this.H=h,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}w(Wr,At),n=Wr.prototype,n.open=function(h,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=v,this.readyState=1,ls(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const v={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(v.body=h),(this.H||c).fetch(new Request(this.D,v)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,zi(this)),this.readyState=0},n.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,ls(this)),this.g&&(this.readyState=3,ls(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ja(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function Ja(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}n.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var v=h.value?h.value:new Uint8Array(0);(v=this.B.decode(v,{stream:!h.done}))&&(this.response=this.responseText+=v)}h.done?zi(this):ls(this),this.readyState==3&&Ja(this)}},n.Oa=function(h){this.g&&(this.response=this.responseText=h,zi(this))},n.Na=function(h){this.g&&(this.response=h,zi(this))},n.ga=function(){this.g&&zi(this)};function zi(h){h.readyState=4,h.l=null,h.j=null,h.B=null,ls(h)}n.setRequestHeader=function(h,v){this.A.append(h,v)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],v=this.h.entries();for(var T=v.next();!T.done;)T=T.value,h.push(T[0]+": "+T[1]),T=v.next();return h.join(`\r
`)};function ls(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Wr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function qn(h){let v="";return be(h,function(T,C){v+=C,v+=":",v+=T,v+=`\r
`}),v}function Qr(h,v,T){e:{for(C in T){var C=!1;break e}C=!0}C||(T=qn(T),typeof h=="string"?T!=null&&ni(T):Ze(h,v,T))}function nt(h){At.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}w(nt,At);var Ls=/^https?$/i,Pl=["POST","PUT"];n=nt.prototype,n.Fa=function(h){this.H=h},n.ea=function(h,v,T,C){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);v=v?v.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():El.g(),this.g.onreadystatechange=x(m(this.Ca,this));try{this.B=!0,this.g.open(v,String(h),!0),this.B=!1}catch(Z){Jr(this,Z);return}if(h=T||"",T=new Map(this.headers),C)if(Object.getPrototypeOf(C)===Object.prototype)for(var K in C)T.set(K,C[K]);else if(typeof C.keys=="function"&&typeof C.get=="function")for(const Z of C.keys())T.set(Z,C.get(Z));else throw Error("Unknown input type for opt_headers: "+String(C));C=Array.from(T.keys()).find(Z=>Z.toLowerCase()=="content-type"),K=c.FormData&&h instanceof c.FormData,!(Array.prototype.indexOf.call(Pl,v,void 0)>=0)||C||K||T.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Z,fe]of T)this.g.setRequestHeader(Z,fe);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(Z){Jr(this,Z)}};function Jr(h,v){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=v,h.o=5,Ml(h),si(h)}function Ml(h){h.A||(h.A=!0,Vt(h,"complete"),Vt(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,Vt(this,"complete"),Vt(this,"abort"),si(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),si(this,!0)),nt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Xr(this):this.Xa())},n.Xa=function(){Xr(this)};function Xr(h){if(h.h&&typeof l<"u"){if(h.v&&cs(h)==4)setTimeout(h.Ca.bind(h),0);else if(Vt(h,"readystatechange"),cs(h)==4){h.h=!1;try{const Z=h.ca();e:switch(Z){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var T;if(!(T=v)){var C;if(C=Z===0){let fe=String(h.D).match(ju)[1]||null;!fe&&c.self&&c.self.location&&(fe=c.self.location.protocol.slice(0,-1)),C=!Ls.test(fe?fe.toLowerCase():"")}T=C}if(T)Vt(h,"complete"),Vt(h,"success");else{h.o=6;try{var K=cs(h)>2?h.g.statusText:""}catch{K=""}h.l=K+" ["+h.ca()+"]",Ml(h)}}finally{si(h)}}}}function si(h,v){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const T=h.g;h.g=null,v||Vt(h,"ready");try{T.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function cs(h){return h.g?h.g.readyState:0}n.ca=function(){try{return cs(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(h){if(this.g){var v=this.g.responseText;return h&&v.indexOf(h)==0&&(v=v.substring(h.length)),Nf(v)}};function Wt(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function ii(h){const v={};h=(h.g&&cs(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let C=0;C<h.length;C++){if(j(h[C]))continue;var T=Iu(h[C]);const K=T[0];if(T=T[1],typeof T!="string")continue;T=T.trim();const Z=v[K]||[];v[K]=Z,Z.push(T)}Le(v,function(C){return C.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Us(h,v,T){return T&&T.internalChannelParams&&T.internalChannelParams[h]||v}function Hi(h){this.za=0,this.i=[],this.j=new is,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Us("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Us("baseRetryDelayMs",5e3,h),this.Za=Us("retryDelaySeedMs",1e4,h),this.Ta=Us("forwardChannelMaxRetries",2,h),this.va=Us("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new Sl(h&&h.concurrentRequestLimit),this.Ba=new Bi,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Hi.prototype,n.ka=8,n.I=1,n.connect=function(h,v,T,C){Nt(0),this.W=h,this.H=v||{},T&&C!==void 0&&(this.H.OSID=T,this.H.OAID=C),this.F=this.X,this.J=$u(this,null,this.W),Vs(this)};function Ll(h){if(Xa(h),h.I==3){var v=h.V++,T=It(h.J);if(Ze(T,"SID",h.M),Ze(T,"RID",v),Ze(T,"TYPE","terminate"),Zr(h,T),v=new rs(h,h.j,v),v.M=2,v.A=Kr(It(T)),T=!1,c.navigator&&c.navigator.sendBeacon)try{T=c.navigator.sendBeacon(v.A.toString(),"")}catch{}!T&&c.Image&&(new Image().src=v.A,T=!0),T||(v.g=Fu(v.j,null),v.g.ea(v.A)),v.F=Date.now(),Is(v)}qu(h)}function qi(h){h.g&&(Vl(h),h.g.cancel(),h.g=null)}function Xa(h){qi(h),h.v&&(c.clearTimeout(h.v),h.v=null),eo(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&c.clearTimeout(h.m),h.m=null)}function Vs(h){if(!Al(h.h)&&!h.m){h.m=!0;var v=h.Ea;$||N(),Q||($(),Q=!0),R.add(v,h),h.D=0}}function Za(h,v){return js(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=v.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=Ns(m(h.Ea,h,v),Hu(h,h.D)),h.D++,!0)}n.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const K=new rs(this,this.j,h);let Z=this.o;if(this.U&&(Z?(Z=V(Z),de(Z,this.U)):Z=this.U),this.u!==null||this.R||(K.J=Z,Z=null),this.S)e:{for(var v=0,T=0;T<this.i.length;T++){t:{var C=this.i[T];if("__data__"in C.map&&(C=C.map.__data__,typeof C=="string")){C=C.length;break t}C=void 0}if(C===void 0)break;if(v+=C,v>4096){v=T;break e}if(v===4096||T===this.i.length-1){v=T+1;break e}}v=1e3}else v=1e3;v=Uu(this,K,v),T=It(this.J),Ze(T,"RID",h),Ze(T,"CVER",22),this.G&&Ze(T,"X-HTTP-Session-Id",this.G),Zr(this,T),Z&&(this.R?v="headers="+ni(qn(Z))+"&"+v:this.u&&Qr(T,this.u,Z)),Nl(this.h,K),this.Ra&&Ze(T,"TYPE","init"),this.S?(Ze(T,"$req",v),Ze(T,"SID","null"),K.U=!0,Rs(K,T,null)):Rs(K,T,v),this.I=2}}else this.I==3&&(h?Ul(this,h):this.i.length==0||Al(this.h)||Ul(this))};function Ul(h,v){var T;v?T=v.l:T=h.V++;const C=It(h.J);Ze(C,"SID",h.M),Ze(C,"RID",T),Ze(C,"AID",h.K),Zr(h,C),h.u&&h.o&&Qr(C,h.u,h.o),T=new rs(h,h.j,T,h.D+1),h.u===null&&(T.J=h.o),v&&(h.i=v.G.concat(h.i)),v=Uu(h,T,1e3),T.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),Nl(h.h,T),Rs(T,C,v)}function Zr(h,v){h.H&&be(h.H,function(T,C){Ze(v,C,T)}),h.l&&be({},function(T,C){Ze(v,C,T)})}function Uu(h,v,T){T=Math.min(h.i.length,T);const C=h.l?m(h.l.Ka,h.l,h):null;e:{var K=h.i;let De=-1;for(;;){const wt=["count="+T];De==-1?T>0?(De=K[0].g,wt.push("ofs="+De)):De=0:wt.push("ofs="+De);let Qe=!0;for(let dt=0;dt<T;dt++){var Z=K[dt].g;const $n=K[dt].map;if(Z-=De,Z<0)De=Math.max(0,K[dt].g-100),Qe=!1;else try{Z="req"+Z+"_"||"";try{var fe=$n instanceof Map?$n:Object.entries($n);for(const[zs,us]of fe){let hs=us;d(us)&&(hs=Pi(us)),wt.push(Z+zs+"="+encodeURIComponent(hs))}}catch(zs){throw wt.push(Z+"type="+encodeURIComponent("_badmap")),zs}}catch{C&&C($n)}}if(Qe){fe=wt.join("&");break e}}fe=void 0}return h=h.i.splice(0,T),v.G=h,fe}function Vu(h){if(!h.g&&!h.v){h.Y=1;var v=h.Da;$||N(),Q||($(),Q=!0),R.add(v,h),h.A=0}}function ea(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=Ns(m(h.Da,h),Hu(h,h.A)),h.A++,!0)}n.Da=function(){if(this.v=null,Bu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=Ns(m(this.Wa,this),h)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Nt(10),qi(this),Bu(this))};function Vl(h){h.B!=null&&(c.clearTimeout(h.B),h.B=null)}function Bu(h){h.g=new rs(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var v=It(h.na);Ze(v,"RID","rpc"),Ze(v,"SID",h.M),Ze(v,"AID",h.K),Ze(v,"CI",h.F?"0":"1"),!h.F&&h.ia&&Ze(v,"TO",h.ia),Ze(v,"TYPE","xmlhttp"),Zr(h,v),h.u&&h.o&&Qr(v,h.u,h.o),h.O&&(h.g.H=h.O);var T=h.g;h=h.ba,T.M=1,T.A=Kr(It(v)),T.u=null,T.R=!0,Fa(T,h)}n.Va=function(){this.C!=null&&(this.C=null,qi(this),ea(this),Nt(19))};function eo(h){h.C!=null&&(c.clearTimeout(h.C),h.C=null)}function zu(h,v){var T=null;if(h.g==v){eo(h),Vl(h),h.g=null;var C=2}else if(Ds(h.h,v))T=v.G,Cl(h.h,v),C=1;else return;if(h.I!=0){if(v.o)if(C==1){T=v.u?v.u.length:0,v=Date.now()-v.F;var K=h.D;C=$a(),Vt(C,new As(C,T)),Vs(h)}else Vu(h);else if(K=v.m,K==3||K==0&&v.X>0||!(C==1&&Za(h,v)||C==2&&ea(h)))switch(T&&T.length>0&&(v=h.h,v.i=v.i.concat(T)),K){case 1:Bs(h,5);break;case 4:Bs(h,10);break;case 3:Bs(h,6);break;default:Bs(h,2)}}}function Hu(h,v){let T=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(T*=2),T*v}function Bs(h,v){if(h.j.info("Error code "+v),v==2){var T=m(h.bb,h),C=h.Ua;const K=!C;C=new Rn(C||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||Ft(C,"https"),Kr(C),K?os(C.toString(),T):Dl(C.toString(),T)}else Nt(2);h.I=0,h.l&&h.l.pa(v),qu(h),Xa(h)}n.bb=function(h){h?(this.j.info("Successfully pinged google.com"),Nt(2)):(this.j.info("Failed to ping google.com"),Nt(1))};function qu(h){if(h.I=0,h.ja=[],h.l){const v=Rl(h.h);(v.length!=0||h.i.length!=0)&&(A(h.ja,v),A(h.ja,h.i),h.h.i.length=0,S(h.i),h.i.length=0),h.l.oa()}}function $u(h,v,T){var C=T instanceof Rn?It(T):new Rn(T);if(C.g!="")v&&(C.g=v+"."+C.g),Mi(C,C.u);else{var K=c.location;C=K.protocol,v=v?v+"."+K.hostname:K.hostname,K=+K.port;const Z=new Rn(null);C&&Ft(Z,C),v&&(Z.g=v),K&&Mi(Z,K),T&&(Z.h=T),C=Z}return T=h.G,v=h.wa,T&&v&&Ze(C,T,v),Ze(C,"VER",h.ka),Zr(h,C),C}function Fu(h,v,T){if(v&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return v=h.Aa&&!h.ma?new nt(new Ms({ab:T})):new nt(h.ma),v.Fa(h.L),v}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Gu(){}n=Gu.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function $i(){}$i.prototype.g=function(h,v){return new fn(h,v)};function fn(h,v){At.call(this),this.g=new Hi(v),this.l=h,this.h=v&&v.messageUrlParams||null,h=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(h?h["X-WebChannel-Content-Type"]=v.messageContentType:h={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.sa&&(h?h["X-WebChannel-Client-Profile"]=v.sa:h={"X-WebChannel-Client-Profile":v.sa}),this.g.U=h,(h=v&&v.Qb)&&!j(h)&&(this.g.u=h),this.A=v&&v.supportsCrossDomainXhr||!1,this.v=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!j(v)&&(this.g.G=v,h=this.h,h!==null&&v in h&&(h=this.h,v in h&&delete h[v])),this.j=new ri(this)}w(fn,At),fn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},fn.prototype.close=function(){Ll(this.g)},fn.prototype.o=function(h){var v=this.g;if(typeof h=="string"){var T={};T.__data__=h,h=T}else this.v&&(T={},T.__data__=Pi(h),h=T);v.i.push(new Rt(v.Ya++,h)),v.I==3&&Vs(v)},fn.prototype.N=function(){this.g.l=null,delete this.j,Ll(this.g),delete this.g,fn.Z.N.call(this)};function Ku(h){Yt.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var v=h.__sm__;if(v){e:{for(const T in v){h=T;break e}h=void 0}(this.i=h)&&(h=this.i,v=v!==null&&h in v?v[h]:void 0),this.data=v}else this.data=h}w(Ku,Yt);function Yu(){Bn.call(this),this.status=1}w(Yu,Bn);function ri(h){this.g=h}w(ri,Gu),ri.prototype.ra=function(){Vt(this.g,"a")},ri.prototype.qa=function(h){Vt(this.g,new Ku(h))},ri.prototype.pa=function(h){Vt(this.g,new Yu)},ri.prototype.oa=function(){Vt(this.g,"b")},$i.prototype.createWebChannel=$i.prototype.g,fn.prototype.send=fn.prototype.o,fn.prototype.open=fn.prototype.m,fn.prototype.close=fn.prototype.close,VE=function(){return new $i},UE=function(){return $a()},LE=bt,mm={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Fr.NO_ERROR=0,Fr.TIMEOUT=8,Fr.HTTP_ERROR=6,yd=Fr,Tl.COMPLETE="complete",ME=Tl,Au.EventType=ss,ss.OPEN="a",ss.CLOSE="b",ss.ERROR="c",ss.MESSAGE="d",At.prototype.listen=At.prototype.J,Rc=Au,nt.prototype.listenOnce=nt.prototype.K,nt.prototype.getLastError=nt.prototype.Ha,nt.prototype.getLastErrorCode=nt.prototype.ya,nt.prototype.getStatus=nt.prototype.ca,nt.prototype.getResponseJson=nt.prototype.La,nt.prototype.getResponseText=nt.prototype.la,nt.prototype.send=nt.prototype.ea,nt.prototype.setWithCredentials=nt.prototype.Fa,PE=nt}).apply(typeof Zh<"u"?Zh:typeof self<"u"?self:typeof window<"u"?window:{});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ln.UNAUTHENTICATED=new ln(null),ln.GOOGLE_CREDENTIALS=new ln("google-credentials-uid"),ln.FIRST_PARTY=new ln("first-party-uid"),ln.MOCK_USER=new ln("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hl="12.8.0";function zO(n){hl=n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Da=new Xd("@firebase/firestore");function Bo(){return Da.logLevel}function ye(n,...e){if(Da.logLevel<=He.DEBUG){const t=e.map(f0);Da.debug(`Firestore (${hl}): ${n}`,...t)}}function Ri(n,...e){if(Da.logLevel<=He.ERROR){const t=e.map(f0);Da.error(`Firestore (${hl}): ${n}`,...t)}}function sl(n,...e){if(Da.logLevel<=He.WARN){const t=e.map(f0);Da.warn(`Firestore (${hl}): ${n}`,...t)}}function f0(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ie(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,BE(n,i,t)}function BE(n,e,t){let i=`FIRESTORE (${hl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw Ri(i),new Error(i)}function Xe(n,e,t,i){let a="Unexpected state";typeof t=="string"?a=t:i=t,n||BE(e,a,i)}function je(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ae={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class me extends ns{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zE{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class HO{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(ln.UNAUTHENTICATED)))}shutdown(){}}class qO{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class $O{constructor(e){this.t=e,this.currentUser=ln.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Xe(this.o===void 0,42304);let i=this.i;const a=g=>this.i!==i?(i=this.i,t(g)):Promise.resolve();let l=new Ai;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new Ai,e.enqueueRetryable((()=>a(this.currentUser)))};const c=()=>{const g=l;e.enqueueRetryable((async()=>{await g.promise,await a(this.currentUser)}))},d=g=>{ye("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((g=>d(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?d(g):(ye("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new Ai)}}),0),c()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(ye("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Xe(typeof i.accessToken=="string",31837,{l:i}),new zE(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Xe(e===null||typeof e=="string",2055,{h:e}),new ln(e)}}class FO{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=ln.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class GO{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new FO(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(ln.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Nw{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class KO{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,En(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Xe(this.o===void 0,3512);const i=l=>{l.error!=null&&ye("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const c=l.token!==this.m;return this.m=l.token,ye("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>i(l)))};const a=l=>{ye("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):ye("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Nw(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Xe(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Nw(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YO(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const a=YO(40);for(let l=0;l<a.length;++l)i.length<20&&a[l]<t&&(i+=e.charAt(a[l]%62))}return i}}function qe(n,e){return n<e?-1:n>e?1:0}function ym(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const a=n.charAt(i),l=e.charAt(i);if(a!==l)return zg(a)===zg(l)?qe(a,l):zg(a)?1:-1}return qe(n.length,e.length)}const WO=55296,QO=57343;function zg(n){const e=n.charCodeAt(0);return e>=WO&&e<=QO}function il(n,e,t){return n.length===e.length&&n.every(((i,a)=>t(i,e[a])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cw="__name__";class Ks{constructor(e,t,i){t===void 0?t=0:t>e.length&&Ie(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Ie(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Ks.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ks?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let a=0;a<i;a++){const l=Ks.compareSegments(e.get(a),t.get(a));if(l!==0)return l}return qe(e.length,t.length)}static compareSegments(e,t){const i=Ks.isNumericId(e),a=Ks.isNumericId(t);return i&&!a?-1:!i&&a?1:i&&a?Ks.extractNumericId(e).compare(Ks.extractNumericId(t)):ym(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Sr.fromString(e.substring(4,e.length-2))}}class lt extends Ks{construct(e,t,i){return new lt(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new me(ae.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((a=>a.length>0)))}return new lt(t)}static emptyPath(){return new lt([])}}const JO=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class sn extends Ks{construct(e,t,i){return new sn(e,t,i)}static isValidIdentifier(e){return JO.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),sn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Cw}static keyField(){return new sn([Cw])}static fromServerFormat(e){const t=[];let i="",a=0;const l=()=>{if(i.length===0)throw new me(ae.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let c=!1;for(;a<e.length;){const d=e[a];if(d==="\\"){if(a+1===e.length)throw new me(ae.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[a+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new me(ae.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=g,a+=2}else d==="`"?(c=!c,a++):d!=="."||c?(i+=d,a++):(l(),a++)}if(l(),c)throw new me(ae.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new sn(t)}static emptyPath(){return new sn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ee{constructor(e){this.path=e}static fromPath(e){return new Ee(lt.fromString(e))}static fromName(e){return new Ee(lt.fromString(e).popFirst(5))}static empty(){return new Ee(lt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&lt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return lt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ee(new lt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HE(n,e,t){if(!t)throw new me(ae.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function XO(n,e,t,i){if(e===!0&&i===!0)throw new me(ae.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Rw(n){if(!Ee.isDocumentKey(n))throw new me(ae.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Iw(n){if(Ee.isDocumentKey(n))throw new me(ae.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function qE(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function af(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ie(12329,{type:typeof n})}function Ii(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new me(ae.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=af(n);throw new me(ae.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ut(n,e){const t={typeString:n};return e&&(t.value=e),t}function fu(n,e){if(!qE(n))throw new me(ae.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const a=e[i].typeString,l="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const c=n[i];if(a&&typeof c!==a){t=`JSON field '${i}' must be a ${a}.`;break}if(l!==void 0&&c!==l.value){t=`Expected '${i}' field to equal '${l.value}'`;break}}if(t)throw new me(ae.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kw=-62135596800,Ow=1e6;class ht{static now(){return ht.fromMillis(Date.now())}static fromDate(e){return ht.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*Ow);return new ht(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new me(ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new me(ae.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<kw)throw new me(ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new me(ae.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Ow}_compareTo(e){return this.seconds===e.seconds?qe(this.nanoseconds,e.nanoseconds):qe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ht._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(fu(e,ht._jsonSchema))return new ht(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-kw;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ht._jsonSchemaVersion="firestore/timestamp/1.0",ht._jsonSchema={type:Ut("string",ht._jsonSchemaVersion),seconds:Ut("number"),nanoseconds:Ut("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ke{static fromTimestamp(e){return new ke(e)}static min(){return new ke(new ht(0,0))}static max(){return new ke(new ht(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wc=-1;function ZO(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,a=ke.fromTimestamp(i===1e9?new ht(t+1,0):new ht(t,i));return new Rr(a,Ee.empty(),e)}function ej(n){return new Rr(n.readTime,n.key,Wc)}class Rr{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Rr(ke.min(),Ee.empty(),Wc)}static max(){return new Rr(ke.max(),Ee.empty(),Wc)}}function tj(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ee.comparator(n.documentKey,e.documentKey),t!==0?t:qe(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nj="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class sj{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dl(n){if(n.code!==ae.FAILED_PRECONDITION||n.message!==nj)throw n;ye("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ie(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new oe(((i,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(i,a)},this.catchCallback=l=>{this.wrapFailure(t,l).next(i,a)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof oe?t:oe.resolve(t)}catch(t){return oe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):oe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):oe.reject(t)}static resolve(e){return new oe(((t,i)=>{t(e)}))}static reject(e){return new oe(((t,i)=>{i(e)}))}static waitFor(e){return new oe(((t,i)=>{let a=0,l=0,c=!1;e.forEach((d=>{++a,d.next((()=>{++l,c&&l===a&&t()}),(g=>i(g)))})),c=!0,l===a&&t()}))}static or(e){let t=oe.resolve(!1);for(const i of e)t=t.next((a=>a?oe.resolve(a):i()));return t}static forEach(e,t){const i=[];return e.forEach(((a,l)=>{i.push(t.call(this,a,l))})),this.waitFor(i)}static mapArray(e,t){return new oe(((i,a)=>{const l=e.length,c=new Array(l);let d=0;for(let g=0;g<l;g++){const m=g;t(e[m]).next((_=>{c[m]=_,++d,d===l&&i(c)}),(_=>a(_)))}}))}static doWhile(e,t){return new oe(((i,a)=>{const l=()=>{e()===!0?t().next((()=>{l()}),a):i()};l()}))}}function ij(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function fl(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class of{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}of.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g0=-1;function lf(n){return n==null}function jd(n){return n===0&&1/n==-1/0}function rj(n){return typeof n=="number"&&Number.isInteger(n)&&!jd(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $E="";function aj(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=jw(e)),e=oj(n.get(t),e);return jw(e)}function oj(n,e){let t=e;const i=n.length;for(let a=0;a<i;a++){const l=n.charAt(a);switch(l){case"\0":t+="";break;case $E:t+="";break;default:t+=l}}return t}function jw(n){return n+$E+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dw(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ur(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function FE(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e,t){this.comparator=e,this.root=t||nn.EMPTY}insert(e,t){return new mt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,nn.BLACK,null,null))}remove(e){return new mt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,nn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const a=this.comparator(e,i.key);if(a===0)return t+i.left.size;a<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ed(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ed(this.root,e,this.comparator,!1)}getReverseIterator(){return new ed(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ed(this.root,e,this.comparator,!0)}}class ed{constructor(e,t,i,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?i(e.key,t):1,t&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class nn{constructor(e,t,i,a,l){this.key=e,this.value=t,this.color=i??nn.RED,this.left=a??nn.EMPTY,this.right=l??nn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,a,l){return new nn(e??this.key,t??this.value,i??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let a=this;const l=i(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,t,i),null):l===0?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,i)),a.fixUp()}removeMin(){if(this.left.isEmpty())return nn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),t(e,a.key)===0){if(a.right.isEmpty())return nn.EMPTY;i=a.right.min(),a=a.copy(i.key,i.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,nn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,nn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ie(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ie(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ie(27949);return e+(this.isRed()?0:1)}}nn.EMPTY=null,nn.RED=!0,nn.BLACK=!1;nn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ie(57766)}get value(){throw Ie(16141)}get color(){throw Ie(16727)}get left(){throw Ie(29726)}get right(){throw Ie(36894)}copy(e,t,i,a,l){return this}insert(e,t,i){return new nn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(e){this.comparator=e,this.data=new mt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const a=i.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Pw(this.data.getIterator())}getIteratorFrom(e){return new Pw(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Ht)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=i.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Ht(this.comparator);return t.data=e,t}}class Pw{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un{constructor(e){this.fields=e,e.sort(sn.comparator)}static empty(){return new Un([])}unionWith(e){let t=new Ht(sn.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Un(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return il(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GE extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new GE("Invalid base64 string: "+l):l}})(e);return new rn(t)}static fromUint8Array(e){const t=(function(a){let l="";for(let c=0;c<a.length;++c)l+=String.fromCharCode(a[c]);return l})(e);return new rn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let a=0;a<t.length;a++)i[a]=t.charCodeAt(a);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return qe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}rn.EMPTY_BYTE_STRING=new rn("");const lj=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ir(n){if(Xe(!!n,39018),typeof n=="string"){let e=0;const t=lj.exec(n);if(Xe(!!t,46558,{timestamp:n}),t[1]){let a=t[1];a=(a+"000000000").substr(0,9),e=Number(a)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Et(n.seconds),nanos:Et(n.nanos)}}function Et(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function kr(n){return typeof n=="string"?rn.fromBase64String(n):rn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KE="server_timestamp",YE="__type__",WE="__previous_value__",QE="__local_write_time__";function m0(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[YE])==null?void 0:i.stringValue)===KE}function cf(n){const e=n.mapValue.fields[WE];return m0(e)?cf(e):e}function Qc(n){const e=Ir(n.mapValue.fields[QE].timestampValue);return new ht(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cj{constructor(e,t,i,a,l,c,d,g,m,_,w){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=a,this.ssl=l,this.forceLongPolling=c,this.autoDetectLongPolling=d,this.longPollingOptions=g,this.useFetchStreams=m,this.isUsingEmulator=_,this.apiKey=w}}const Dd="(default)";class Jc{constructor(e,t){this.projectId=e,this.database=t||Dd}static empty(){return new Jc("","")}get isDefaultDatabase(){return this.database===Dd}isEqual(e){return e instanceof Jc&&e.projectId===this.projectId&&e.database===this.database}}function uj(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new me(ae.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Jc(n.options.projectId,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JE="__type__",hj="__max__",td={mapValue:{}},XE="__vector__",Pd="value";function Or(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?m0(n)?4:fj(n)?9007199254740991:dj(n)?10:11:Ie(28295,{value:n})}function ei(n,e){if(n===e)return!0;const t=Or(n);if(t!==Or(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Qc(n).isEqual(Qc(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const c=Ir(a.timestampValue),d=Ir(l.timestampValue);return c.seconds===d.seconds&&c.nanos===d.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(a,l){return kr(a.bytesValue).isEqual(kr(l.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(a,l){return Et(a.geoPointValue.latitude)===Et(l.geoPointValue.latitude)&&Et(a.geoPointValue.longitude)===Et(l.geoPointValue.longitude)})(n,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return Et(a.integerValue)===Et(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const c=Et(a.doubleValue),d=Et(l.doubleValue);return c===d?jd(c)===jd(d):isNaN(c)&&isNaN(d)}return!1})(n,e);case 9:return il(n.arrayValue.values||[],e.arrayValue.values||[],ei);case 10:case 11:return(function(a,l){const c=a.mapValue.fields||{},d=l.mapValue.fields||{};if(Dw(c)!==Dw(d))return!1;for(const g in c)if(c.hasOwnProperty(g)&&(d[g]===void 0||!ei(c[g],d[g])))return!1;return!0})(n,e);default:return Ie(52216,{left:n})}}function Xc(n,e){return(n.values||[]).find((t=>ei(t,e)))!==void 0}function rl(n,e){if(n===e)return 0;const t=Or(n),i=Or(e);if(t!==i)return qe(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return qe(n.booleanValue,e.booleanValue);case 2:return(function(l,c){const d=Et(l.integerValue||l.doubleValue),g=Et(c.integerValue||c.doubleValue);return d<g?-1:d>g?1:d===g?0:isNaN(d)?isNaN(g)?0:-1:1})(n,e);case 3:return Mw(n.timestampValue,e.timestampValue);case 4:return Mw(Qc(n),Qc(e));case 5:return ym(n.stringValue,e.stringValue);case 6:return(function(l,c){const d=kr(l),g=kr(c);return d.compareTo(g)})(n.bytesValue,e.bytesValue);case 7:return(function(l,c){const d=l.split("/"),g=c.split("/");for(let m=0;m<d.length&&m<g.length;m++){const _=qe(d[m],g[m]);if(_!==0)return _}return qe(d.length,g.length)})(n.referenceValue,e.referenceValue);case 8:return(function(l,c){const d=qe(Et(l.latitude),Et(c.latitude));return d!==0?d:qe(Et(l.longitude),Et(c.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Lw(n.arrayValue,e.arrayValue);case 10:return(function(l,c){var x,S,A,D;const d=l.fields||{},g=c.fields||{},m=(x=d[Pd])==null?void 0:x.arrayValue,_=(S=g[Pd])==null?void 0:S.arrayValue,w=qe(((A=m==null?void 0:m.values)==null?void 0:A.length)||0,((D=_==null?void 0:_.values)==null?void 0:D.length)||0);return w!==0?w:Lw(m,_)})(n.mapValue,e.mapValue);case 11:return(function(l,c){if(l===td.mapValue&&c===td.mapValue)return 0;if(l===td.mapValue)return 1;if(c===td.mapValue)return-1;const d=l.fields||{},g=Object.keys(d),m=c.fields||{},_=Object.keys(m);g.sort(),_.sort();for(let w=0;w<g.length&&w<_.length;++w){const x=ym(g[w],_[w]);if(x!==0)return x;const S=rl(d[g[w]],m[_[w]]);if(S!==0)return S}return qe(g.length,_.length)})(n.mapValue,e.mapValue);default:throw Ie(23264,{he:t})}}function Mw(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return qe(n,e);const t=Ir(n),i=Ir(e),a=qe(t.seconds,i.seconds);return a!==0?a:qe(t.nanos,i.nanos)}function Lw(n,e){const t=n.values||[],i=e.values||[];for(let a=0;a<t.length&&a<i.length;++a){const l=rl(t[a],i[a]);if(l)return l}return qe(t.length,i.length)}function al(n){return vm(n)}function vm(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=Ir(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return kr(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Ee.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",a=!0;for(const l of t.values||[])a?a=!1:i+=",",i+=vm(l);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let a="{",l=!0;for(const c of i)l?l=!1:a+=",",a+=`${c}:${vm(t.fields[c])}`;return a+"}"})(n.mapValue):Ie(61005,{value:n})}function vd(n){switch(Or(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=cf(n);return e?16+vd(e):16;case 5:return 2*n.stringValue.length;case 6:return kr(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((a,l)=>a+vd(l)),0)})(n.arrayValue);case 10:case 11:return(function(i){let a=0;return Ur(i.fields,((l,c)=>{a+=l.length+vd(c)})),a})(n.mapValue);default:throw Ie(13486,{value:n})}}function Uw(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function _m(n){return!!n&&"integerValue"in n}function y0(n){return!!n&&"arrayValue"in n}function Vw(n){return!!n&&"nullValue"in n}function Bw(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function _d(n){return!!n&&"mapValue"in n}function dj(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[JE])==null?void 0:i.stringValue)===XE}function Uc(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Ur(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=Uc(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Uc(n.arrayValue.values[t]);return e}return{...n}}function fj(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===hj}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sn{constructor(e){this.value=e}static empty(){return new Sn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!_d(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Uc(t)}setAll(e){let t=sn.emptyPath(),i={},a=[];e.forEach(((c,d)=>{if(!t.isImmediateParentOf(d)){const g=this.getFieldsMap(t);this.applyChanges(g,i,a),i={},a=[],t=d.popLast()}c?i[d.lastSegment()]=Uc(c):a.push(d.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,i,a)}delete(e){const t=this.field(e.popLast());_d(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ei(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let a=t.mapValue.fields[e.get(i)];_d(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,i){Ur(t,((a,l)=>e[a]=l));for(const a of i)delete e[a]}clone(){return new Sn(Uc(this.value))}}function ZE(n){const e=[];return Ur(n.fields,((t,i)=>{const a=new sn([t]);if(_d(i)){const l=ZE(i.mapValue).fields;if(l.length===0)e.push(a);else for(const c of l)e.push(a.child(c))}else e.push(a)})),new Un(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cn{constructor(e,t,i,a,l,c,d){this.key=e,this.documentType=t,this.version=i,this.readTime=a,this.createTime=l,this.data=c,this.documentState=d}static newInvalidDocument(e){return new cn(e,0,ke.min(),ke.min(),ke.min(),Sn.empty(),0)}static newFoundDocument(e,t,i,a){return new cn(e,1,t,ke.min(),i,a,0)}static newNoDocument(e,t){return new cn(e,2,t,ke.min(),ke.min(),Sn.empty(),0)}static newUnknownDocument(e,t){return new cn(e,3,t,ke.min(),ke.min(),Sn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ke.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Sn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Sn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ke.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof cn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new cn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Md{constructor(e,t){this.position=e,this.inclusive=t}}function zw(n,e,t){let i=0;for(let a=0;a<n.position.length;a++){const l=e[a],c=n.position[a];if(l.field.isKeyField()?i=Ee.comparator(Ee.fromName(c.referenceValue),t.key):i=rl(c,t.data.field(l.field)),l.dir==="desc"&&(i*=-1),i!==0)break}return i}function Hw(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ei(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ld{constructor(e,t="asc"){this.field=e,this.dir=t}}function pj(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e1{}class Lt extends e1{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new mj(e,t,i):t==="array-contains"?new _j(e,i):t==="in"?new bj(e,i):t==="not-in"?new wj(e,i):t==="array-contains-any"?new xj(e,i):new Lt(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new yj(e,i):new vj(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(rl(t,this.value)):t!==null&&Or(this.value)===Or(t)&&this.matchesComparison(rl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ie(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class xs extends e1{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new xs(e,t)}matches(e){return t1(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function t1(n){return n.op==="and"}function n1(n){return gj(n)&&t1(n)}function gj(n){for(const e of n.filters)if(e instanceof xs)return!1;return!0}function bm(n){if(n instanceof Lt)return n.field.canonicalString()+n.op.toString()+al(n.value);if(n1(n))return n.filters.map((e=>bm(e))).join(",");{const e=n.filters.map((t=>bm(t))).join(",");return`${n.op}(${e})`}}function s1(n,e){return n instanceof Lt?(function(i,a){return a instanceof Lt&&i.op===a.op&&i.field.isEqual(a.field)&&ei(i.value,a.value)})(n,e):n instanceof xs?(function(i,a){return a instanceof xs&&i.op===a.op&&i.filters.length===a.filters.length?i.filters.reduce(((l,c,d)=>l&&s1(c,a.filters[d])),!0):!1})(n,e):void Ie(19439)}function i1(n){return n instanceof Lt?(function(t){return`${t.field.canonicalString()} ${t.op} ${al(t.value)}`})(n):n instanceof xs?(function(t){return t.op.toString()+" {"+t.getFilters().map(i1).join(" ,")+"}"})(n):"Filter"}class mj extends Lt{constructor(e,t,i){super(e,t,i),this.key=Ee.fromName(i.referenceValue)}matches(e){const t=Ee.comparator(e.key,this.key);return this.matchesComparison(t)}}class yj extends Lt{constructor(e,t){super(e,"in",t),this.keys=r1("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class vj extends Lt{constructor(e,t){super(e,"not-in",t),this.keys=r1("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function r1(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((i=>Ee.fromName(i.referenceValue)))}class _j extends Lt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return y0(t)&&Xc(t.arrayValue,this.value)}}class bj extends Lt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Xc(this.value.arrayValue,t)}}class wj extends Lt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Xc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Xc(this.value.arrayValue,t)}}class xj extends Lt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!y0(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Xc(this.value.arrayValue,i)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tj{constructor(e,t=null,i=[],a=[],l=null,c=null,d=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=a,this.limit=l,this.startAt=c,this.endAt=d,this.Te=null}}function qw(n,e=null,t=[],i=[],a=null,l=null,c=null){return new Tj(n,e,t,i,a,l,c)}function v0(n){const e=je(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>bm(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(l){return l.field.canonicalString()+l.dir})(i))).join(","),lf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>al(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>al(i))).join(",")),e.Te=t}return e.Te}function _0(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!pj(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!s1(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Hw(n.startAt,e.startAt)&&Hw(n.endAt,e.endAt)}function wm(n){return Ee.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{constructor(e,t=null,i=[],a=[],l=null,c="F",d=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=a,this.limit=l,this.limitType=c,this.startAt=d,this.endAt=g,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function Ej(n,e,t,i,a,l,c,d){return new pu(n,e,t,i,a,l,c,d)}function b0(n){return new pu(n)}function $w(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Sj(n){return Ee.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function a1(n){return n.collectionGroup!==null}function Vc(n){const e=je(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),t.add(l.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let d=new Ht(sn.comparator);return c.filters.forEach((g=>{g.getFlattenedFilters().forEach((m=>{m.isInequality()&&(d=d.add(m.field))}))})),d})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new Ld(l,i))})),t.has(sn.keyField().canonicalString())||e.Ie.push(new Ld(sn.keyField(),i))}return e.Ie}function Qs(n){const e=je(n);return e.Ee||(e.Ee=Aj(e,Vc(n))),e.Ee}function Aj(n,e){if(n.limitType==="F")return qw(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new Ld(a.field,l)}));const t=n.endAt?new Md(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Md(n.startAt.position,n.startAt.inclusive):null;return qw(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function xm(n,e){const t=n.filters.concat([e]);return new pu(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Tm(n,e,t){return new pu(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function uf(n,e){return _0(Qs(n),Qs(e))&&n.limitType===e.limitType}function o1(n){return`${v0(Qs(n))}|lt:${n.limitType}`}function zo(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((a=>i1(a))).join(", ")}]`),lf(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((a=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(a))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((a=>al(a))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((a=>al(a))).join(",")),`Target(${i})`})(Qs(n))}; limitType=${n.limitType})`}function hf(n,e){return e.isFoundDocument()&&(function(i,a){const l=a.key.path;return i.collectionGroup!==null?a.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(l):Ee.isDocumentKey(i.path)?i.path.isEqual(l):i.path.isImmediateParentOf(l)})(n,e)&&(function(i,a){for(const l of Vc(i))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(n,e)&&(function(i,a){for(const l of i.filters)if(!l.matches(a))return!1;return!0})(n,e)&&(function(i,a){return!(i.startAt&&!(function(c,d,g){const m=zw(c,d,g);return c.inclusive?m<=0:m<0})(i.startAt,Vc(i),a)||i.endAt&&!(function(c,d,g){const m=zw(c,d,g);return c.inclusive?m>=0:m>0})(i.endAt,Vc(i),a))})(n,e)}function Nj(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function l1(n){return(e,t)=>{let i=!1;for(const a of Vc(n)){const l=Cj(a,e,t);if(l!==0)return l;i=i||a.field.isKeyField()}return 0}}function Cj(n,e,t){const i=n.field.isKeyField()?Ee.comparator(e.key,t.key):(function(l,c,d){const g=c.data.field(l),m=d.data.field(l);return g!==null&&m!==null?rl(g,m):Ie(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Ie(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ba{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[a,l]of i)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),a=this.inner[i];if(a===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return i.length===1?delete this.inner[t]:i.splice(a,1),this.innerSize--,!0;return!1}forEach(e){Ur(this.inner,((t,i)=>{for(const[a,l]of i)e(a,l)}))}isEmpty(){return FE(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rj=new mt(Ee.comparator);function ki(){return Rj}const c1=new mt(Ee.comparator);function Ic(...n){let e=c1;for(const t of n)e=e.insert(t.key,t);return e}function u1(n){let e=c1;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Sa(){return Bc()}function h1(){return Bc()}function Bc(){return new Ba((n=>n.toString()),((n,e)=>n.isEqual(e)))}const Ij=new mt(Ee.comparator),kj=new Ht(Ee.comparator);function $e(...n){let e=kj;for(const t of n)e=e.add(t);return e}const Oj=new Ht(qe);function jj(){return Oj}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w0(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:jd(e)?"-0":e}}function d1(n){return{integerValue:""+n}}function Dj(n,e){return rj(e)?d1(e):w0(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class df{constructor(){this._=void 0}}function Pj(n,e,t){return n instanceof Ud?(function(a,l){const c={fields:{[YE]:{stringValue:KE},[QE]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&m0(l)&&(l=cf(l)),l&&(c.fields[WE]=l),{mapValue:c}})(t,e):n instanceof Zc?p1(n,e):n instanceof eu?g1(n,e):(function(a,l){const c=f1(a,l),d=Fw(c)+Fw(a.Ae);return _m(c)&&_m(a.Ae)?d1(d):w0(a.serializer,d)})(n,e)}function Mj(n,e,t){return n instanceof Zc?p1(n,e):n instanceof eu?g1(n,e):t}function f1(n,e){return n instanceof Vd?(function(i){return _m(i)||(function(l){return!!l&&"doubleValue"in l})(i)})(e)?e:{integerValue:0}:null}class Ud extends df{}class Zc extends df{constructor(e){super(),this.elements=e}}function p1(n,e){const t=m1(e);for(const i of n.elements)t.some((a=>ei(a,i)))||t.push(i);return{arrayValue:{values:t}}}class eu extends df{constructor(e){super(),this.elements=e}}function g1(n,e){let t=m1(e);for(const i of n.elements)t=t.filter((a=>!ei(a,i)));return{arrayValue:{values:t}}}class Vd extends df{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Fw(n){return Et(n.integerValue||n.doubleValue)}function m1(n){return y0(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function Lj(n,e){return n.field.isEqual(e.field)&&(function(i,a){return i instanceof Zc&&a instanceof Zc||i instanceof eu&&a instanceof eu?il(i.elements,a.elements,ei):i instanceof Vd&&a instanceof Vd?ei(i.Ae,a.Ae):i instanceof Ud&&a instanceof Ud})(n.transform,e.transform)}class Uj{constructor(e,t){this.version=e,this.transformResults=t}}class Js{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Js}static exists(e){return new Js(void 0,e)}static updateTime(e){return new Js(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function bd(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class ff{}function y1(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new _1(n.key,Js.none()):new gu(n.key,n.data,Js.none());{const t=n.data,i=Sn.empty();let a=new Ht(sn.comparator);for(let l of e.fields)if(!a.has(l)){let c=t.field(l);c===null&&l.length>1&&(l=l.popLast(),c=t.field(l)),c===null?i.delete(l):i.set(l,c),a=a.add(l)}return new Vr(n.key,i,new Un(a.toArray()),Js.none())}}function Vj(n,e,t){n instanceof gu?(function(a,l,c){const d=a.value.clone(),g=Kw(a.fieldTransforms,l,c.transformResults);d.setAll(g),l.convertToFoundDocument(c.version,d).setHasCommittedMutations()})(n,e,t):n instanceof Vr?(function(a,l,c){if(!bd(a.precondition,l))return void l.convertToUnknownDocument(c.version);const d=Kw(a.fieldTransforms,l,c.transformResults),g=l.data;g.setAll(v1(a)),g.setAll(d),l.convertToFoundDocument(c.version,g).setHasCommittedMutations()})(n,e,t):(function(a,l,c){l.convertToNoDocument(c.version).setHasCommittedMutations()})(0,e,t)}function zc(n,e,t,i){return n instanceof gu?(function(l,c,d,g){if(!bd(l.precondition,c))return d;const m=l.value.clone(),_=Yw(l.fieldTransforms,g,c);return m.setAll(_),c.convertToFoundDocument(c.version,m).setHasLocalMutations(),null})(n,e,t,i):n instanceof Vr?(function(l,c,d,g){if(!bd(l.precondition,c))return d;const m=Yw(l.fieldTransforms,g,c),_=c.data;return _.setAll(v1(l)),_.setAll(m),c.convertToFoundDocument(c.version,_).setHasLocalMutations(),d===null?null:d.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((w=>w.field)))})(n,e,t,i):(function(l,c,d){return bd(l.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):d})(n,e,t)}function Bj(n,e){let t=null;for(const i of n.fieldTransforms){const a=e.data.field(i.field),l=f1(i.transform,a||null);l!=null&&(t===null&&(t=Sn.empty()),t.set(i.field,l))}return t||null}function Gw(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,a){return i===void 0&&a===void 0||!(!i||!a)&&il(i,a,((l,c)=>Lj(l,c)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class gu extends ff{constructor(e,t,i,a=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class Vr extends ff{constructor(e,t,i,a,l=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function v1(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function Kw(n,e,t){const i=new Map;Xe(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let a=0;a<t.length;a++){const l=n[a],c=l.transform,d=e.data.field(l.field);i.set(l.field,Mj(c,d,t[a]))}return i}function Yw(n,e,t){const i=new Map;for(const a of n){const l=a.transform,c=t.data.field(a.field);i.set(a.field,Pj(l,c,e))}return i}class _1 extends ff{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class zj extends ff{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hj{constructor(e,t,i,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=a}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&Vj(l,e,i[a])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=zc(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=zc(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=h1();return this.mutations.forEach((a=>{const l=e.get(a.key),c=l.overlayedDocument;let d=this.applyToLocalView(c,l.mutatedFields);d=t.has(a.key)?null:d;const g=y1(c,d);g!==null&&i.set(a.key,g),c.isValidDocument()||c.convertToNoDocument(ke.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),$e())}isEqual(e){return this.batchId===e.batchId&&il(this.mutations,e.mutations,((t,i)=>Gw(t,i)))&&il(this.baseMutations,e.baseMutations,((t,i)=>Gw(t,i)))}}class x0{constructor(e,t,i,a){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=a}static from(e,t,i){Xe(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let a=(function(){return Ij})();const l=e.mutations;for(let c=0;c<l.length;c++)a=a.insert(l[c].key,i[c].version);return new x0(e,t,i,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qj{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $j{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Pt,Ge;function Fj(n){switch(n){case ae.OK:return Ie(64938);case ae.CANCELLED:case ae.UNKNOWN:case ae.DEADLINE_EXCEEDED:case ae.RESOURCE_EXHAUSTED:case ae.INTERNAL:case ae.UNAVAILABLE:case ae.UNAUTHENTICATED:return!1;case ae.INVALID_ARGUMENT:case ae.NOT_FOUND:case ae.ALREADY_EXISTS:case ae.PERMISSION_DENIED:case ae.FAILED_PRECONDITION:case ae.ABORTED:case ae.OUT_OF_RANGE:case ae.UNIMPLEMENTED:case ae.DATA_LOSS:return!0;default:return Ie(15467,{code:n})}}function b1(n){if(n===void 0)return Ri("GRPC error has no .code"),ae.UNKNOWN;switch(n){case Pt.OK:return ae.OK;case Pt.CANCELLED:return ae.CANCELLED;case Pt.UNKNOWN:return ae.UNKNOWN;case Pt.DEADLINE_EXCEEDED:return ae.DEADLINE_EXCEEDED;case Pt.RESOURCE_EXHAUSTED:return ae.RESOURCE_EXHAUSTED;case Pt.INTERNAL:return ae.INTERNAL;case Pt.UNAVAILABLE:return ae.UNAVAILABLE;case Pt.UNAUTHENTICATED:return ae.UNAUTHENTICATED;case Pt.INVALID_ARGUMENT:return ae.INVALID_ARGUMENT;case Pt.NOT_FOUND:return ae.NOT_FOUND;case Pt.ALREADY_EXISTS:return ae.ALREADY_EXISTS;case Pt.PERMISSION_DENIED:return ae.PERMISSION_DENIED;case Pt.FAILED_PRECONDITION:return ae.FAILED_PRECONDITION;case Pt.ABORTED:return ae.ABORTED;case Pt.OUT_OF_RANGE:return ae.OUT_OF_RANGE;case Pt.UNIMPLEMENTED:return ae.UNIMPLEMENTED;case Pt.DATA_LOSS:return ae.DATA_LOSS;default:return Ie(39323,{code:n})}}(Ge=Pt||(Pt={}))[Ge.OK=0]="OK",Ge[Ge.CANCELLED=1]="CANCELLED",Ge[Ge.UNKNOWN=2]="UNKNOWN",Ge[Ge.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ge[Ge.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ge[Ge.NOT_FOUND=5]="NOT_FOUND",Ge[Ge.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ge[Ge.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ge[Ge.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ge[Ge.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ge[Ge.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ge[Ge.ABORTED=10]="ABORTED",Ge[Ge.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ge[Ge.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ge[Ge.INTERNAL=13]="INTERNAL",Ge[Ge.UNAVAILABLE=14]="UNAVAILABLE",Ge[Ge.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gj(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kj=new Sr([4294967295,4294967295],0);function Ww(n){const e=Gj().encode(n),t=new DE;return t.update(e),new Uint8Array(t.digest())}function Qw(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new Sr([t,i],0),new Sr([a,l],0)]}class T0{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new kc(`Invalid padding: ${t}`);if(i<0)throw new kc(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new kc(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new kc(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Sr.fromNumber(this.ge)}ye(e,t,i){let a=e.add(t.multiply(Sr.fromNumber(i)));return a.compare(Kj)===1&&(a=new Sr([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Ww(e),[i,a]=Qw(t);for(let l=0;l<this.hashCount;l++){const c=this.ye(i,a,l);if(!this.we(c))return!1}return!0}static create(e,t,i){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),c=new T0(l,a,t);return i.forEach((d=>c.insert(d))),c}insert(e){if(this.ge===0)return;const t=Ww(e),[i,a]=Qw(t);for(let l=0;l<this.hashCount;l++){const c=this.ye(i,a,l);this.be(c)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class kc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(e,t,i,a,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const a=new Map;return a.set(e,mu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new pf(ke.min(),a,new mt(qe),ki(),$e())}}class mu{constructor(e,t,i,a,l){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new mu(i,t,$e(),$e(),$e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wd{constructor(e,t,i,a){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=a}}class w1{constructor(e,t){this.targetId=e,this.Ce=t}}class x1{constructor(e,t,i=rn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=a}}class Jw{constructor(){this.ve=0,this.Fe=Xw(),this.Me=rn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=$e(),t=$e(),i=$e();return this.Fe.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:i=i.add(a);break;default:Ie(38017,{changeType:l})}})),new mu(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=Xw()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Xe(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class Yj{constructor(e){this.Ge=e,this.ze=new Map,this.je=ki(),this.He=nd(),this.Je=nd(),this.Ze=new mt(qe)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:Ie(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,a)=>{this.rt(a)&&t(a)}))}st(e){const t=e.targetId,i=e.Ce.count,a=this.ot(t);if(a){const l=a.target;if(wm(l))if(i===0){const c=new Ee(l.path);this.et(t,c,cn.newNoDocument(c,ke.min()))}else Xe(i===1,20013,{expectedCount:i});else{const c=this._t(t);if(c!==i){const d=this.ut(e),g=d?this.ct(d,e,c):1;if(g!==0){this.it(t);const m=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,m)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:a=0},hashCount:l=0}=t;let c,d;try{c=kr(i).toUint8Array()}catch(g){if(g instanceof GE)return sl("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{d=new T0(c,a,l)}catch(g){return sl(g instanceof kc?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return d.ge===0?null:d}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let a=0;return i.forEach((l=>{const c=this.Ge.ht(),d=`projects/${c.projectId}/databases/${c.database}/documents/${l.path.canonicalString()}`;e.mightContain(d)||(this.et(t,l,null),a++)})),a}Tt(e){const t=new Map;this.ze.forEach(((l,c)=>{const d=this.ot(c);if(d){if(l.current&&wm(d.target)){const g=new Ee(d.target.path);this.It(g).has(c)||this.Et(c,g)||this.et(c,g,cn.newNoDocument(g,e))}l.Be&&(t.set(c,l.ke()),l.Ke())}}));let i=$e();this.Je.forEach(((l,c)=>{let d=!0;c.forEachWhile((g=>{const m=this.ot(g);return!m||m.purpose==="TargetPurposeLimboResolution"||(d=!1,!1)})),d&&(i=i.add(l))})),this.je.forEach(((l,c)=>c.setReadTime(e)));const a=new pf(e,t,this.Ze,this.je,i);return this.je=ki(),this.He=nd(),this.Je=nd(),this.Ze=new mt(qe),a}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,t)?a.qe(t,1):a.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new Jw,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Ht(qe),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Ht(qe),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||ye("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Jw),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function nd(){return new mt(Ee.comparator)}function Xw(){return new mt(Ee.comparator)}const Wj={asc:"ASCENDING",desc:"DESCENDING"},Qj={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Jj={and:"AND",or:"OR"};class Xj{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Em(n,e){return n.useProto3Json||lf(e)?e:{value:e}}function Bd(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function T1(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Zj(n,e){return Bd(n,e.toTimestamp())}function Xs(n){return Xe(!!n,49232),ke.fromTimestamp((function(t){const i=Ir(t);return new ht(i.seconds,i.nanos)})(n))}function E0(n,e){return Sm(n,e).canonicalString()}function Sm(n,e){const t=(function(a){return new lt(["projects",a.projectId,"databases",a.database])})(n).child("documents");return e===void 0?t:t.child(e)}function E1(n){const e=lt.fromString(n);return Xe(R1(e),10190,{key:e.toString()}),e}function Am(n,e){return E0(n.databaseId,e.path)}function Hg(n,e){const t=E1(e);if(t.get(1)!==n.databaseId.projectId)throw new me(ae.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new me(ae.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ee(A1(t))}function S1(n,e){return E0(n.databaseId,e)}function e4(n){const e=E1(n);return e.length===4?lt.emptyPath():A1(e)}function Nm(n){return new lt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function A1(n){return Xe(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Zw(n,e,t){return{name:Am(n,e),fields:t.value.mapValue.fields}}function t4(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:Ie(39313,{state:m})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(m,_){return m.useProto3Json?(Xe(_===void 0||typeof _=="string",58123),rn.fromBase64String(_||"")):(Xe(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),rn.fromUint8Array(_||new Uint8Array))})(n,e.targetChange.resumeToken),c=e.targetChange.cause,d=c&&(function(m){const _=m.code===void 0?ae.UNKNOWN:b1(m.code);return new me(_,m.message||"")})(c);t=new x1(i,a,l,d||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const a=Hg(n,i.document.name),l=Xs(i.document.updateTime),c=i.document.createTime?Xs(i.document.createTime):ke.min(),d=new Sn({mapValue:{fields:i.document.fields}}),g=cn.newFoundDocument(a,l,c,d),m=i.targetIds||[],_=i.removedTargetIds||[];t=new wd(m,_,g.key,g)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const a=Hg(n,i.document),l=i.readTime?Xs(i.readTime):ke.min(),c=cn.newNoDocument(a,l),d=i.removedTargetIds||[];t=new wd([],d,c.key,c)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const a=Hg(n,i.document),l=i.removedTargetIds||[];t=new wd([],l,a,null)}else{if(!("filter"in e))return Ie(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:a=0,unchangedNames:l}=i,c=new $j(a,l),d=i.targetId;t=new w1(d,c)}}return t}function n4(n,e){let t;if(e instanceof gu)t={update:Zw(n,e.key,e.value)};else if(e instanceof _1)t={delete:Am(n,e.key)};else if(e instanceof Vr)t={update:Zw(n,e.key,e.data),updateMask:h4(e.fieldMask)};else{if(!(e instanceof zj))return Ie(16599,{dt:e.type});t={verify:Am(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(l,c){const d=c.transform;if(d instanceof Ud)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(d instanceof Zc)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:d.elements}};if(d instanceof eu)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:d.elements}};if(d instanceof Vd)return{fieldPath:c.field.canonicalString(),increment:d.Ae};throw Ie(20930,{transform:c.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:Zj(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:Ie(27497)})(n,e.precondition)),t}function s4(n,e){return n&&n.length>0?(Xe(e!==void 0,14353),n.map((t=>(function(a,l){let c=a.updateTime?Xs(a.updateTime):Xs(l);return c.isEqual(ke.min())&&(c=Xs(l)),new Uj(c,a.transformResults||[])})(t,e)))):[]}function i4(n,e){return{documents:[S1(n,e.path)]}}function r4(n,e){const t={structuredQuery:{}},i=e.path;let a;e.collectionGroup!==null?(a=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=S1(n,a);const l=(function(m){if(m.length!==0)return C1(xs.create(m,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const c=(function(m){if(m.length!==0)return m.map((_=>(function(x){return{field:Ho(x.field),direction:l4(x.dir)}})(_)))})(e.orderBy);c&&(t.structuredQuery.orderBy=c);const d=Em(n,e.limit);return d!==null&&(t.structuredQuery.limit=d),e.startAt&&(t.structuredQuery.startAt=(function(m){return{before:m.inclusive,values:m.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(m){return{before:!m.inclusive,values:m.position}})(e.endAt)),{ft:t,parent:a}}function a4(n){let e=e4(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let a=null;if(i>0){Xe(i===1,65062);const _=t.from[0];_.allDescendants?a=_.collectionId:e=e.child(_.collectionId)}let l=[];t.where&&(l=(function(w){const x=N1(w);return x instanceof xs&&n1(x)?x.getFilters():[x]})(t.where));let c=[];t.orderBy&&(c=(function(w){return w.map((x=>(function(A){return new Ld(qo(A.field),(function(I){switch(I){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(A.direction))})(x)))})(t.orderBy));let d=null;t.limit&&(d=(function(w){let x;return x=typeof w=="object"?w.value:w,lf(x)?null:x})(t.limit));let g=null;t.startAt&&(g=(function(w){const x=!!w.before,S=w.values||[];return new Md(S,x)})(t.startAt));let m=null;return t.endAt&&(m=(function(w){const x=!w.before,S=w.values||[];return new Md(S,x)})(t.endAt)),Ej(e,a,c,l,d,"F",g,m)}function o4(n,e){const t=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ie(28987,{purpose:a})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function N1(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=qo(t.unaryFilter.field);return Lt.create(i,"==",{doubleValue:NaN});case"IS_NULL":const a=qo(t.unaryFilter.field);return Lt.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=qo(t.unaryFilter.field);return Lt.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=qo(t.unaryFilter.field);return Lt.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ie(61313);default:return Ie(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Lt.create(qo(t.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ie(58110);default:return Ie(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return xs.create(t.compositeFilter.filters.map((i=>N1(i))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return Ie(1026)}})(t.compositeFilter.op))})(n):Ie(30097,{filter:n})}function l4(n){return Wj[n]}function c4(n){return Qj[n]}function u4(n){return Jj[n]}function Ho(n){return{fieldPath:n.canonicalString()}}function qo(n){return sn.fromServerFormat(n.fieldPath)}function C1(n){return n instanceof Lt?(function(t){if(t.op==="=="){if(Bw(t.value))return{unaryFilter:{field:Ho(t.field),op:"IS_NAN"}};if(Vw(t.value))return{unaryFilter:{field:Ho(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Bw(t.value))return{unaryFilter:{field:Ho(t.field),op:"IS_NOT_NAN"}};if(Vw(t.value))return{unaryFilter:{field:Ho(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ho(t.field),op:c4(t.op),value:t.value}}})(n):n instanceof xs?(function(t){const i=t.getFilters().map((a=>C1(a)));return i.length===1?i[0]:{compositeFilter:{op:u4(t.op),filters:i}}})(n):Ie(54877,{filter:n})}function h4(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function R1(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function I1(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br{constructor(e,t,i,a,l=ke.min(),c=ke.min(),d=rn.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=d,this.expectedCount=g}withSequenceNumber(e){return new br(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new br(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new br(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new br(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d4{constructor(e){this.yt=e}}function f4(n){const e=a4({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Tm(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p4{constructor(){this.Sn=new g4}addToCollectionParentIndex(e,t){return this.Sn.add(t),oe.resolve()}getCollectionParents(e,t){return oe.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return oe.resolve()}deleteFieldIndex(e,t){return oe.resolve()}deleteAllFieldIndexes(e){return oe.resolve()}createTargetIndexes(e,t){return oe.resolve()}getDocumentsMatchingTarget(e,t){return oe.resolve(null)}getIndexType(e,t){return oe.resolve(0)}getFieldIndexes(e,t){return oe.resolve([])}getNextCollectionGroupToUpdate(e){return oe.resolve(null)}getMinOffset(e,t){return oe.resolve(Rr.min())}getMinOffsetFromCollectionGroup(e,t){return oe.resolve(Rr.min())}updateCollectionGroup(e,t,i){return oe.resolve()}updateIndexEntries(e,t){return oe.resolve()}}class g4{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),a=this.index[t]||new Ht(lt.comparator),l=!a.has(i);return this.index[t]=a.add(i),l}has(e){const t=e.lastSegment(),i=e.popLast(),a=this.index[t];return a&&a.has(i)}getEntries(e){return(this.index[e]||new Ht(lt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ex={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},k1=41943040;class Tn{static withCacheSize(e){return new Tn(e,Tn.DEFAULT_COLLECTION_PERCENTILE,Tn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Tn.DEFAULT_COLLECTION_PERCENTILE=10,Tn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Tn.DEFAULT=new Tn(k1,Tn.DEFAULT_COLLECTION_PERCENTILE,Tn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Tn.DISABLED=new Tn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ol{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new ol(0)}static ar(){return new ol(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tx="LruGarbageCollector",m4=1048576;function nx([n,e],[t,i]){const a=qe(n,t);return a===0?qe(e,i):a}class y4{constructor(e){this.Pr=e,this.buffer=new Ht(nx),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();nx(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class v4{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){ye(tx,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){fl(t)?ye(tx,"Ignoring IndexedDB error during garbage collection: ",t):await dl(t)}await this.Ar(3e5)}))}}class _4{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return oe.resolve(of.ce);const i=new y4(t);return this.Vr.forEachTarget(e,(a=>i.Er(a.sequenceNumber))).next((()=>this.Vr.mr(e,(a=>i.Er(a))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ye("LruGarbageCollector","Garbage collection skipped; disabled"),oe.resolve(ex)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(ye("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),ex):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,a,l,c,d,g,m;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((w=>(w>this.params.maximumSequenceNumbersToCollect?(ye("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${w}`),a=this.params.maximumSequenceNumbersToCollect):a=w,c=Date.now(),this.nthSequenceNumber(e,a)))).next((w=>(i=w,d=Date.now(),this.removeTargets(e,i,t)))).next((w=>(l=w,g=Date.now(),this.removeOrphanedDocuments(e,i)))).next((w=>(m=Date.now(),Bo()<=He.DEBUG&&ye("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-_}ms
	Determined least recently used ${a} in `+(d-c)+`ms
	Removed ${l} targets in `+(g-d)+`ms
	Removed ${w} documents in `+(m-g)+`ms
Total Duration: ${m-_}ms`),oe.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:w}))))}}function b4(n,e){return new _4(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w4{constructor(){this.changes=new Ba((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,cn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?oe.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x4{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T4{constructor(e,t,i,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=a}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((a=>(i=a,this.remoteDocumentCache.getEntry(e,t)))).next((a=>(i!==null&&zc(i.mutation,a,Un.empty(),ht.now()),a)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,$e()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=$e()){const a=Sa();return this.populateOverlays(e,a,t).next((()=>this.computeViews(e,t,a,i).next((l=>{let c=Ic();return l.forEach(((d,g)=>{c=c.insert(d,g.overlayedDocument)})),c}))))}getOverlayedDocuments(e,t){const i=Sa();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,$e())))}populateOverlays(e,t,i){const a=[];return i.forEach((l=>{t.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((c,d)=>{t.set(c,d)}))}))}computeViews(e,t,i,a){let l=ki();const c=Bc(),d=(function(){return Bc()})();return t.forEach(((g,m)=>{const _=i.get(m.key);a.has(m.key)&&(_===void 0||_.mutation instanceof Vr)?l=l.insert(m.key,m):_!==void 0?(c.set(m.key,_.mutation.getFieldMask()),zc(_.mutation,m,_.mutation.getFieldMask(),ht.now())):c.set(m.key,Un.empty())})),this.recalculateAndSaveOverlays(e,l).next((g=>(g.forEach(((m,_)=>c.set(m,_))),t.forEach(((m,_)=>d.set(m,new x4(_,c.get(m)??null)))),d)))}recalculateAndSaveOverlays(e,t){const i=Bc();let a=new mt(((c,d)=>c-d)),l=$e();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((c=>{for(const d of c)d.keys().forEach((g=>{const m=t.get(g);if(m===null)return;let _=i.get(g)||Un.empty();_=d.applyToLocalView(m,_),i.set(g,_);const w=(a.get(d.batchId)||$e()).add(g);a=a.insert(d.batchId,w)}))})).next((()=>{const c=[],d=a.getReverseIterator();for(;d.hasNext();){const g=d.getNext(),m=g.key,_=g.value,w=h1();_.forEach((x=>{if(!l.has(x)){const S=y1(t.get(x),i.get(x));S!==null&&w.set(x,S),l=l.add(x)}})),c.push(this.documentOverlayCache.saveOverlays(e,m,w))}return oe.waitFor(c)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,a){return Sj(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):a1(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,a):this.getDocumentsMatchingCollectionQuery(e,t,i,a)}getNextDocuments(e,t,i,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,a).next((l=>{const c=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,a-l.size):oe.resolve(Sa());let d=Wc,g=l;return c.next((m=>oe.forEach(m,((_,w)=>(d<w.largestBatchId&&(d=w.largestBatchId),l.get(_)?oe.resolve():this.remoteDocumentCache.getEntry(e,_).next((x=>{g=g.insert(_,x)}))))).next((()=>this.populateOverlays(e,m,l))).next((()=>this.computeViews(e,g,m,$e()))).next((_=>({batchId:d,changes:u1(_)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ee(t)).next((i=>{let a=Ic();return i.isFoundDocument()&&(a=a.insert(i.key,i)),a}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,a){const l=t.collectionGroup;let c=Ic();return this.indexManager.getCollectionParents(e,l).next((d=>oe.forEach(d,(g=>{const m=(function(w,x){return new pu(x,null,w.explicitOrderBy.slice(),w.filters.slice(),w.limit,w.limitType,w.startAt,w.endAt)})(t,g.child(l));return this.getDocumentsMatchingCollectionQuery(e,m,i,a).next((_=>{_.forEach(((w,x)=>{c=c.insert(w,x)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(e,t,i,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((c=>(l=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,l,a)))).next((c=>{l.forEach(((g,m)=>{const _=m.getKey();c.get(_)===null&&(c=c.insert(_,cn.newInvalidDocument(_)))}));let d=Ic();return c.forEach(((g,m)=>{const _=l.get(g);_!==void 0&&zc(_.mutation,m,Un.empty(),ht.now()),hf(t,m)&&(d=d.insert(g,m))})),d}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E4{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return oe.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(a){return{id:a.id,version:a.version,createTime:Xs(a.createTime)}})(t)),oe.resolve()}getNamedQuery(e,t){return oe.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(a){return{name:a.name,query:f4(a.bundledQuery),readTime:Xs(a.readTime)}})(t)),oe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S4{constructor(){this.overlays=new mt(Ee.comparator),this.Lr=new Map}getOverlay(e,t){return oe.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Sa();return oe.forEach(t,(a=>this.getOverlay(e,a).next((l=>{l!==null&&i.set(a,l)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((a,l)=>{this.bt(e,t,l)})),oe.resolve()}removeOverlaysForBatchId(e,t,i){const a=this.Lr.get(i);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.Lr.delete(i)),oe.resolve()}getOverlaysForCollection(e,t,i){const a=Sa(),l=t.length+1,c=new Ee(t.child("")),d=this.overlays.getIteratorFrom(c);for(;d.hasNext();){const g=d.getNext().value,m=g.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===l&&g.largestBatchId>i&&a.set(g.getKey(),g)}return oe.resolve(a)}getOverlaysForCollectionGroup(e,t,i,a){let l=new mt(((m,_)=>m-_));const c=this.overlays.getIterator();for(;c.hasNext();){const m=c.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>i){let _=l.get(m.largestBatchId);_===null&&(_=Sa(),l=l.insert(m.largestBatchId,_)),_.set(m.getKey(),m)}}const d=Sa(),g=l.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((m,_)=>d.set(m,_))),!(d.size()>=a)););return oe.resolve(d)}bt(e,t,i){const a=this.overlays.get(i.key);if(a!==null){const c=this.Lr.get(a.largestBatchId).delete(i.key);this.Lr.set(a.largestBatchId,c)}this.overlays=this.overlays.insert(i.key,new qj(t,i));let l=this.Lr.get(t);l===void 0&&(l=$e(),this.Lr.set(t,l)),this.Lr.set(t,l.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A4{constructor(){this.sessionToken=rn.EMPTY_BYTE_STRING}getSessionToken(e){return oe.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,oe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S0{constructor(){this.kr=new Ht(Kt.Kr),this.qr=new Ht(Kt.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new Kt(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new Kt(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new Ee(new lt([])),i=new Kt(t,e),a=new Kt(t,e+1),l=[];return this.qr.forEachInRange([i,a],(c=>{this.Wr(c),l.push(c.key)})),l}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new Ee(new lt([])),i=new Kt(t,e),a=new Kt(t,e+1);let l=$e();return this.qr.forEachInRange([i,a],(c=>{l=l.add(c.key)})),l}containsKey(e){const t=new Kt(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Kt{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return Ee.comparator(e.key,t.key)||qe(e.Hr,t.Hr)}static Ur(e,t){return qe(e.Hr,t.Hr)||Ee.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N4{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Ht(Kt.Kr)}checkEmpty(e){return oe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,a){const l=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new Hj(l,t,i,a);this.mutationQueue.push(c);for(const d of a)this.Jr=this.Jr.add(new Kt(d.key,l)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return oe.resolve(c)}lookupMutationBatch(e,t){return oe.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,a=this.Xr(i),l=a<0?0:a;return oe.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return oe.resolve(this.mutationQueue.length===0?g0:this.Yn-1)}getAllMutationBatches(e){return oe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Kt(t,0),a=new Kt(t,Number.POSITIVE_INFINITY),l=[];return this.Jr.forEachInRange([i,a],(c=>{const d=this.Zr(c.Hr);l.push(d)})),oe.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Ht(qe);return t.forEach((a=>{const l=new Kt(a,0),c=new Kt(a,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([l,c],(d=>{i=i.add(d.Hr)}))})),oe.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,a=i.length+1;let l=i;Ee.isDocumentKey(l)||(l=l.child(""));const c=new Kt(new Ee(l),0);let d=new Ht(qe);return this.Jr.forEachWhile((g=>{const m=g.key.path;return!!i.isPrefixOf(m)&&(m.length===a&&(d=d.add(g.Hr)),!0)}),c),oe.resolve(this.Yr(d))}Yr(e){const t=[];return e.forEach((i=>{const a=this.Zr(i);a!==null&&t.push(a)})),t}removeMutationBatch(e,t){Xe(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return oe.forEach(t.mutations,(a=>{const l=new Kt(a.key,t.batchId);return i=i.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new Kt(t,0),a=this.Jr.firstAfterOrEqual(i);return oe.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,oe.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C4{constructor(e){this.ti=e,this.docs=(function(){return new mt(Ee.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,a=this.docs.get(i),l=a?a.size:0,c=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:c}),this.size+=c-l,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return oe.resolve(i?i.document.mutableCopy():cn.newInvalidDocument(t))}getEntries(e,t){let i=ki();return t.forEach((a=>{const l=this.docs.get(a);i=i.insert(a,l?l.document.mutableCopy():cn.newInvalidDocument(a))})),oe.resolve(i)}getDocumentsMatchingQuery(e,t,i,a){let l=ki();const c=t.path,d=new Ee(c.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(d);for(;g.hasNext();){const{key:m,value:{document:_}}=g.getNext();if(!c.isPrefixOf(m.path))break;m.path.length>c.length+1||tj(ej(_),i)<=0||(a.has(_.key)||hf(t,_))&&(l=l.insert(_.key,_.mutableCopy()))}return oe.resolve(l)}getAllFromCollectionGroup(e,t,i,a){Ie(9500)}ni(e,t){return oe.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new R4(this)}getSize(e){return oe.resolve(this.size)}}class R4 extends w4{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,a)=>{a.isValidDocument()?t.push(this.Mr.addEntry(e,a)):this.Mr.removeEntry(i)})),oe.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I4{constructor(e){this.persistence=e,this.ri=new Ba((t=>v0(t)),_0),this.lastRemoteSnapshotVersion=ke.min(),this.highestTargetId=0,this.ii=0,this.si=new S0,this.targetCount=0,this.oi=ol._r()}forEachTarget(e,t){return this.ri.forEach(((i,a)=>t(a))),oe.resolve()}getLastRemoteSnapshotVersion(e){return oe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return oe.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),oe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),oe.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new ol(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,oe.resolve()}updateTargetData(e,t){return this.lr(t),oe.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,oe.resolve()}removeTargets(e,t,i){let a=0;const l=[];return this.ri.forEach(((c,d)=>{d.sequenceNumber<=t&&i.get(d.targetId)===null&&(this.ri.delete(c),l.push(this.removeMatchingKeysForTargetId(e,d.targetId)),a++)})),oe.waitFor(l).next((()=>a))}getTargetCount(e){return oe.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return oe.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),oe.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const a=this.persistence.referenceDelegate,l=[];return a&&t.forEach((c=>{l.push(a.markPotentiallyOrphaned(e,c))})),oe.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),oe.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return oe.resolve(i)}containsKey(e,t){return oe.resolve(this.si.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O1{constructor(e,t){this._i={},this.overlays={},this.ai=new of(0),this.ui=!1,this.ui=!0,this.ci=new A4,this.referenceDelegate=e(this),this.li=new I4(this),this.indexManager=new p4,this.remoteDocumentCache=(function(a){return new C4(a)})((i=>this.referenceDelegate.hi(i))),this.serializer=new d4(t),this.Pi=new E4(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new S4,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new N4(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){ye("MemoryPersistence","Starting transaction:",e);const a=new k4(this.ai.next());return this.referenceDelegate.Ti(),i(a).next((l=>this.referenceDelegate.Ii(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ei(e,t){return oe.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class k4 extends sj{constructor(e){super(),this.currentSequenceNumber=e}}class A0{constructor(e){this.persistence=e,this.Ri=new S0,this.Ai=null}static Vi(e){return new A0(e)}get di(){if(this.Ai)return this.Ai;throw Ie(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),oe.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),oe.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),oe.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((a=>this.di.add(a.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((a=>{a.forEach((l=>this.di.add(l.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return oe.forEach(this.di,(i=>{const a=Ee.fromPath(i);return this.mi(e,a).next((l=>{l||t.removeEntry(a,ke.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return oe.or([()=>oe.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class zd{constructor(e,t){this.persistence=e,this.fi=new Ba((i=>aj(i.path)),((i,a)=>i.isEqual(a))),this.garbageCollector=b4(this,t)}static Vi(e,t){return new zd(e,t)}Ti(){}Ii(e){return oe.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((a=>i+a))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return oe.forEach(this.fi,((i,a)=>this.wr(e,i,a).next((l=>l?oe.resolve():t(a)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ni(e,(c=>this.wr(e,c,t).next((d=>{d||(i++,l.removeEntry(c,ke.min()))})))).next((()=>l.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),oe.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),oe.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),oe.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),oe.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=vd(e.data.value)),t}wr(e,t,i){return oe.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const a=this.fi.get(t);return oe.resolve(a!==void 0&&a>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N0{constructor(e,t,i,a){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=a}static Es(e,t){let i=$e(),a=$e();for(const l of t.docChanges)switch(l.type){case 0:i=i.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new N0(e,t.fromCache,i,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O4{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j4{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return DN()?8:ij(hn())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,a){const l={result:null};return this.gs(e,t).next((c=>{l.result=c})).next((()=>{if(!l.result)return this.ps(e,t,a,i).next((c=>{l.result=c}))})).next((()=>{if(l.result)return;const c=new O4;return this.ys(e,t,c).next((d=>{if(l.result=d,this.As)return this.ws(e,t,c,d.size)}))})).next((()=>l.result))}ws(e,t,i,a){return i.documentReadCount<this.Vs?(Bo()<=He.DEBUG&&ye("QueryEngine","SDK will not create cache indexes for query:",zo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),oe.resolve()):(Bo()<=He.DEBUG&&ye("QueryEngine","Query:",zo(t),"scans",i.documentReadCount,"local documents and returns",a,"documents as results."),i.documentReadCount>this.ds*a?(Bo()<=He.DEBUG&&ye("QueryEngine","The SDK decides to create cache indexes for query:",zo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Qs(t))):oe.resolve())}gs(e,t){if($w(t))return oe.resolve(null);let i=Qs(t);return this.indexManager.getIndexType(e,i).next((a=>a===0?null:(t.limit!==null&&a===1&&(t=Tm(t,null,"F"),i=Qs(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((l=>{const c=$e(...l);return this.fs.getDocuments(e,c).next((d=>this.indexManager.getMinOffset(e,i).next((g=>{const m=this.bs(t,d);return this.Ss(t,m,c,g.readTime)?this.gs(e,Tm(t,null,"F")):this.Ds(e,m,t,g)}))))})))))}ps(e,t,i,a){return $w(t)||a.isEqual(ke.min())?oe.resolve(null):this.fs.getDocuments(e,i).next((l=>{const c=this.bs(t,l);return this.Ss(t,c,i,a)?oe.resolve(null):(Bo()<=He.DEBUG&&ye("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),zo(t)),this.Ds(e,c,t,ZO(a,Wc)).next((d=>d)))}))}bs(e,t){let i=new Ht(l1(e));return t.forEach(((a,l)=>{hf(e,l)&&(i=i.add(l))})),i}Ss(e,t,i,a){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}ys(e,t,i){return Bo()<=He.DEBUG&&ye("QueryEngine","Using full collection scan to execute query:",zo(t)),this.fs.getDocumentsMatchingQuery(e,t,Rr.min(),i)}Ds(e,t,i,a){return this.fs.getDocumentsMatchingQuery(e,i,a).next((l=>(t.forEach((c=>{l=l.insert(c.key,c)})),l)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C0="LocalStore",D4=3e8;class P4{constructor(e,t,i,a){this.persistence=e,this.Cs=t,this.serializer=a,this.vs=new mt(qe),this.Fs=new Ba((l=>v0(l)),_0),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new T4(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function M4(n,e,t,i){return new P4(n,e,t,i)}async function j1(n,e){const t=je(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let a;return t.mutationQueue.getAllMutationBatches(i).next((l=>(a=l,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((l=>{const c=[],d=[];let g=$e();for(const m of a){c.push(m.batchId);for(const _ of m.mutations)g=g.add(_.key)}for(const m of l){d.push(m.batchId);for(const _ of m.mutations)g=g.add(_.key)}return t.localDocuments.getDocuments(i,g).next((m=>({Ns:m,removedBatchIds:c,addedBatchIds:d})))}))}))}function L4(n,e){const t=je(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const a=e.batch.keys(),l=t.xs.newChangeBuffer({trackRemovals:!0});return(function(d,g,m,_){const w=m.batch,x=w.keys();let S=oe.resolve();return x.forEach((A=>{S=S.next((()=>_.getEntry(g,A))).next((D=>{const I=m.docVersions.get(A);Xe(I!==null,48541),D.version.compareTo(I)<0&&(w.applyToRemoteDocument(D,m),D.isValidDocument()&&(D.setReadTime(m.commitVersion),_.addEntry(D)))}))})),S.next((()=>d.mutationQueue.removeMutationBatch(g,w)))})(t,i,e,l).next((()=>l.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,a,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(d){let g=$e();for(let m=0;m<d.mutationResults.length;++m)d.mutationResults[m].transformResults.length>0&&(g=g.add(d.batch.mutations[m].key));return g})(e)))).next((()=>t.localDocuments.getDocuments(i,a)))}))}function D1(n){const e=je(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function U4(n,e){const t=je(n),i=e.snapshotVersion;let a=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const c=t.xs.newChangeBuffer({trackRemovals:!0});a=t.vs;const d=[];e.targetChanges.forEach(((_,w)=>{const x=a.get(w);if(!x)return;d.push(t.li.removeMatchingKeys(l,_.removedDocuments,w).next((()=>t.li.addMatchingKeys(l,_.addedDocuments,w))));let S=x.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(w)!==null?S=S.withResumeToken(rn.EMPTY_BYTE_STRING,ke.min()).withLastLimboFreeSnapshotVersion(ke.min()):_.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(_.resumeToken,i)),a=a.insert(w,S),(function(D,I,U){return D.resumeToken.approximateByteSize()===0||I.snapshotVersion.toMicroseconds()-D.snapshotVersion.toMicroseconds()>=D4?!0:U.addedDocuments.size+U.modifiedDocuments.size+U.removedDocuments.size>0})(x,S,_)&&d.push(t.li.updateTargetData(l,S))}));let g=ki(),m=$e();if(e.documentUpdates.forEach((_=>{e.resolvedLimboDocuments.has(_)&&d.push(t.persistence.referenceDelegate.updateLimboDocument(l,_))})),d.push(V4(l,c,e.documentUpdates).next((_=>{g=_.Bs,m=_.Ls}))),!i.isEqual(ke.min())){const _=t.li.getLastRemoteSnapshotVersion(l).next((w=>t.li.setTargetsMetadata(l,l.currentSequenceNumber,i)));d.push(_)}return oe.waitFor(d).next((()=>c.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,g,m))).next((()=>g))})).then((l=>(t.vs=a,l)))}function V4(n,e,t){let i=$e(),a=$e();return t.forEach((l=>i=i.add(l))),e.getEntries(n,i).next((l=>{let c=ki();return t.forEach(((d,g)=>{const m=l.get(d);g.isFoundDocument()!==m.isFoundDocument()&&(a=a.add(d)),g.isNoDocument()&&g.version.isEqual(ke.min())?(e.removeEntry(d,g.readTime),c=c.insert(d,g)):!m.isValidDocument()||g.version.compareTo(m.version)>0||g.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(g),c=c.insert(d,g)):ye(C0,"Ignoring outdated watch update for ",d,". Current version:",m.version," Watch version:",g.version)})),{Bs:c,Ls:a}}))}function B4(n,e){const t=je(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=g0),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function z4(n,e){const t=je(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let a;return t.li.getTargetData(i,e).next((l=>l?(a=l,oe.resolve(a)):t.li.allocateTargetId(i).next((c=>(a=new br(e,c,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,a).next((()=>a)))))))})).then((i=>{const a=t.vs.get(i.targetId);return(a===null||i.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function Cm(n,e,t){const i=je(n),a=i.vs.get(e),l=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",l,(c=>i.persistence.referenceDelegate.removeTarget(c,a)))}catch(c){if(!fl(c))throw c;ye(C0,`Failed to update sequence numbers for target ${e}: ${c}`)}i.vs=i.vs.remove(e),i.Fs.delete(a.target)}function sx(n,e,t){const i=je(n);let a=ke.min(),l=$e();return i.persistence.runTransaction("Execute query","readwrite",(c=>(function(g,m,_){const w=je(g),x=w.Fs.get(_);return x!==void 0?oe.resolve(w.vs.get(x)):w.li.getTargetData(m,_)})(i,c,Qs(e)).next((d=>{if(d)return a=d.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(c,d.targetId).next((g=>{l=g}))})).next((()=>i.Cs.getDocumentsMatchingQuery(c,e,t?a:ke.min(),t?l:$e()))).next((d=>(H4(i,Nj(e),d),{documents:d,ks:l})))))}function H4(n,e,t){let i=n.Ms.get(e)||ke.min();t.forEach(((a,l)=>{l.readTime.compareTo(i)>0&&(i=l.readTime)})),n.Ms.set(e,i)}class ix{constructor(){this.activeTargetIds=jj()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class q4{constructor(){this.vo=new ix,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new ix,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $4{Mo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rx="ConnectivityMonitor";class ax{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){ye(rx,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){ye(rx,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sd=null;function Rm(){return sd===null?sd=(function(){return 268435456+Math.round(2147483648*Math.random())})():sd++,"0x"+sd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qg="RestConnection",F4={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class G4{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${a}`,this.$o=this.databaseId.database===Dd?`project_id=${i}`:`project_id=${i}&database_id=${a}`}Wo(e,t,i,a,l){const c=Rm(),d=this.Qo(e,t.toUriEncodedString());ye(qg,`Sending RPC '${e}' ${c}:`,d,i);const g={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(g,a,l);const{host:m}=new URL(d),_=La(m);return this.zo(e,d,g,i,_).then((w=>(ye(qg,`Received RPC '${e}' ${c}: `,w),w)),(w=>{throw sl(qg,`RPC '${e}' ${c} failed with error: `,w,"url: ",d,"request:",i),w}))}jo(e,t,i,a,l,c){return this.Wo(e,t,i,a,l)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+hl})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((a,l)=>e[l]=a)),i&&i.headers.forEach(((a,l)=>e[l]=a))}Qo(e,t){const i=F4[e];let a=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(a=`${a}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),a}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K4{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const on="WebChannelConnection",Ec=(n,e,t)=>{n.listen(e,(i=>{try{t(i)}catch(a){setTimeout((()=>{throw a}),0)}}))};class Xo extends G4{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Xo.c_){const e=UE();Ec(e,LE.STAT_EVENT,(t=>{t.stat===mm.PROXY?ye(on,"STAT_EVENT: detected buffering proxy"):t.stat===mm.NOPROXY&&ye(on,"STAT_EVENT: detected no buffering proxy")})),Xo.c_=!0}}zo(e,t,i,a,l){const c=Rm();return new Promise(((d,g)=>{const m=new PE;m.setWithCredentials(!0),m.listenOnce(ME.COMPLETE,(()=>{try{switch(m.getLastErrorCode()){case yd.NO_ERROR:const w=m.getResponseJson();ye(on,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(w)),d(w);break;case yd.TIMEOUT:ye(on,`RPC '${e}' ${c} timed out`),g(new me(ae.DEADLINE_EXCEEDED,"Request time out"));break;case yd.HTTP_ERROR:const x=m.getStatus();if(ye(on,`RPC '${e}' ${c} failed with status:`,x,"response text:",m.getResponseText()),x>0){let S=m.getResponseJson();Array.isArray(S)&&(S=S[0]);const A=S==null?void 0:S.error;if(A&&A.status&&A.message){const D=(function(U){const q=U.toLowerCase().replace(/_/g,"-");return Object.values(ae).indexOf(q)>=0?q:ae.UNKNOWN})(A.status);g(new me(D,A.message))}else g(new me(ae.UNKNOWN,"Server responded with status "+m.getStatus()))}else g(new me(ae.UNAVAILABLE,"Connection failed."));break;default:Ie(9055,{l_:e,streamId:c,h_:m.getLastErrorCode(),P_:m.getLastError()})}}finally{ye(on,`RPC '${e}' ${c} completed.`)}}));const _=JSON.stringify(a);ye(on,`RPC '${e}' ${c} sending request:`,a),m.send(t,"POST",_,i,15)}))}T_(e,t,i){const a=Rm(),l=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=this.createWebChannelTransport(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(d.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(d.useFetchStreams=!0),this.Go(d.initMessageHeaders,t,i),d.encodeInitMessageHeaders=!0;const m=l.join("");ye(on,`Creating RPC '${e}' stream ${a}: ${m}`,d);const _=c.createWebChannel(m,d);this.I_(_);let w=!1,x=!1;const S=new K4({Ho:A=>{x?ye(on,`Not sending because RPC '${e}' stream ${a} is closed:`,A):(w||(ye(on,`Opening RPC '${e}' stream ${a} transport.`),_.open(),w=!0),ye(on,`RPC '${e}' stream ${a} sending:`,A),_.send(A))},Jo:()=>_.close()});return Ec(_,Rc.EventType.OPEN,(()=>{x||(ye(on,`RPC '${e}' stream ${a} transport opened.`),S.i_())})),Ec(_,Rc.EventType.CLOSE,(()=>{x||(x=!0,ye(on,`RPC '${e}' stream ${a} transport closed`),S.o_(),this.E_(_))})),Ec(_,Rc.EventType.ERROR,(A=>{x||(x=!0,sl(on,`RPC '${e}' stream ${a} transport errored. Name:`,A.name,"Message:",A.message),S.o_(new me(ae.UNAVAILABLE,"The operation could not be completed")))})),Ec(_,Rc.EventType.MESSAGE,(A=>{var D;if(!x){const I=A.data[0];Xe(!!I,16349);const U=I,q=(U==null?void 0:U.error)||((D=U[0])==null?void 0:D.error);if(q){ye(on,`RPC '${e}' stream ${a} received error:`,q);const z=q.status;let O=(function(R){const N=Pt[R];if(N!==void 0)return b1(N)})(z),$=q.message;O===void 0&&(O=ae.INTERNAL,$="Unknown error status: "+z+" with message "+q.message),x=!0,S.o_(new me(O,$)),_.close()}else ye(on,`RPC '${e}' stream ${a} received:`,I),S.__(I)}})),Xo.u_(),setTimeout((()=>{S.s_()}),0),S}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return VE()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y4(n){return new Xo(n)}function $g(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gf(n){return new Xj(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Xo.c_=!1;class P1{constructor(e,t,i=1e3,a=1.5,l=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=a,this.V_=l,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),a=Math.max(0,t-i);a>0&&ye("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,a,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ox="PersistentStream";class M1{constructor(e,t,i,a,l,c,d,g){this.Ci=e,this.b_=i,this.S_=a,this.connection=l,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=d,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new P1(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ae.RESOURCE_EXHAUSTED?(Ri(t.toString()),Ri("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ae.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,a])=>{this.D_===t&&this.G_(i,a)}),(i=>{e((()=>{const a=new me(ae.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(a)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((a=>{i((()=>this.z_(a)))})),this.stream.onMessage((a=>{i((()=>++this.F_==1?this.H_(a):this.onNext(a)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ye(ox,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(ye(ox,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class W4 extends M1{constructor(e,t,i,a,l,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,a,c),this.serializer=l}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=t4(this.serializer,e),i=(function(l){if(!("targetChange"in l))return ke.min();const c=l.targetChange;return c.targetIds&&c.targetIds.length?ke.min():c.readTime?Xs(c.readTime):ke.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=Nm(this.serializer),t.addTarget=(function(l,c){let d;const g=c.target;if(d=wm(g)?{documents:i4(l,g)}:{query:r4(l,g).ft},d.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){d.resumeToken=T1(l,c.resumeToken);const m=Em(l,c.expectedCount);m!==null&&(d.expectedCount=m)}else if(c.snapshotVersion.compareTo(ke.min())>0){d.readTime=Bd(l,c.snapshotVersion.toTimestamp());const m=Em(l,c.expectedCount);m!==null&&(d.expectedCount=m)}return d})(this.serializer,e);const i=o4(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=Nm(this.serializer),t.removeTarget=e,this.K_(t)}}class Q4 extends M1{constructor(e,t,i,a,l,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,a,c),this.serializer=l}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return Xe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Xe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Xe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=s4(e.writeResults,e.commitTime),i=Xs(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=Nm(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>n4(this.serializer,i)))};this.K_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J4{}class X4 extends J4{constructor(e,t,i,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new me(ae.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,c])=>this.connection.Wo(e,Sm(t,i),a,l,c))).catch((l=>{throw l.name==="FirebaseError"?(l.code===ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new me(ae.UNKNOWN,l.toString())}))}jo(e,t,i,a,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,d])=>this.connection.jo(e,Sm(t,i),a,c,d,l))).catch((c=>{throw c.name==="FirebaseError"?(c.code===ae.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new me(ae.UNKNOWN,c.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function Z4(n,e,t,i){return new X4(n,e,t,i)}class eD{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ri(t),this.aa=!1):ye("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pa="RemoteStore";class tD{constructor(e,t,i,a,l){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=l,this.Aa.Mo((c=>{i.enqueueAndForget((async()=>{za(this)&&(ye(Pa,"Restarting streams for network reachability change."),await(async function(g){const m=je(g);m.Ea.add(4),await yu(m),m.Va.set("Unknown"),m.Ea.delete(4),await mf(m)})(this))}))})),this.Va=new eD(i,a)}}async function mf(n){if(za(n))for(const e of n.Ra)await e(!0)}async function yu(n){for(const e of n.Ra)await e(!1)}function L1(n,e){const t=je(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),O0(t)?k0(t):pl(t).O_()&&I0(t,e))}function R0(n,e){const t=je(n),i=pl(t);t.Ia.delete(e),i.O_()&&U1(t,e),t.Ia.size===0&&(i.O_()?i.L_():za(t)&&t.Va.set("Unknown"))}function I0(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ke.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}pl(n).Z_(e)}function U1(n,e){n.da.$e(e),pl(n).X_(e)}function k0(n){n.da=new Yj({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),pl(n).start(),n.Va.ua()}function O0(n){return za(n)&&!pl(n).x_()&&n.Ia.size>0}function za(n){return je(n).Ea.size===0}function V1(n){n.da=void 0}async function nD(n){n.Va.set("Online")}async function sD(n){n.Ia.forEach(((e,t)=>{I0(n,e)}))}async function iD(n,e){V1(n),O0(n)?(n.Va.ha(e),k0(n)):n.Va.set("Unknown")}async function rD(n,e,t){if(n.Va.set("Online"),e instanceof x1&&e.state===2&&e.cause)try{await(async function(a,l){const c=l.cause;for(const d of l.targetIds)a.Ia.has(d)&&(await a.remoteSyncer.rejectListen(d,c),a.Ia.delete(d),a.da.removeTarget(d))})(n,e)}catch(i){ye(Pa,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Hd(n,i)}else if(e instanceof wd?n.da.Xe(e):e instanceof w1?n.da.st(e):n.da.tt(e),!t.isEqual(ke.min()))try{const i=await D1(n.localStore);t.compareTo(i)>=0&&await(function(l,c){const d=l.da.Tt(c);return d.targetChanges.forEach(((g,m)=>{if(g.resumeToken.approximateByteSize()>0){const _=l.Ia.get(m);_&&l.Ia.set(m,_.withResumeToken(g.resumeToken,c))}})),d.targetMismatches.forEach(((g,m)=>{const _=l.Ia.get(g);if(!_)return;l.Ia.set(g,_.withResumeToken(rn.EMPTY_BYTE_STRING,_.snapshotVersion)),U1(l,g);const w=new br(_.target,g,m,_.sequenceNumber);I0(l,w)})),l.remoteSyncer.applyRemoteEvent(d)})(n,t)}catch(i){ye(Pa,"Failed to raise snapshot:",i),await Hd(n,i)}}async function Hd(n,e,t){if(!fl(e))throw e;n.Ea.add(1),await yu(n),n.Va.set("Offline"),t||(t=()=>D1(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{ye(Pa,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await mf(n)}))}function B1(n,e){return e().catch((t=>Hd(n,t,e)))}async function yf(n){const e=je(n),t=jr(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:g0;for(;aD(e);)try{const a=await B4(e.localStore,i);if(a===null){e.Ta.length===0&&t.L_();break}i=a.batchId,oD(e,a)}catch(a){await Hd(e,a)}z1(e)&&H1(e)}function aD(n){return za(n)&&n.Ta.length<10}function oD(n,e){n.Ta.push(e);const t=jr(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function z1(n){return za(n)&&!jr(n).x_()&&n.Ta.length>0}function H1(n){jr(n).start()}async function lD(n){jr(n).ra()}async function cD(n){const e=jr(n);for(const t of n.Ta)e.ea(t.mutations)}async function uD(n,e,t){const i=n.Ta.shift(),a=x0.from(i,e,t);await B1(n,(()=>n.remoteSyncer.applySuccessfulWrite(a))),await yf(n)}async function hD(n,e){e&&jr(n).Y_&&await(async function(i,a){if((function(c){return Fj(c)&&c!==ae.ABORTED})(a.code)){const l=i.Ta.shift();jr(i).B_(),await B1(i,(()=>i.remoteSyncer.rejectFailedWrite(l.batchId,a))),await yf(i)}})(n,e),z1(n)&&H1(n)}async function lx(n,e){const t=je(n);t.asyncQueue.verifyOperationInProgress(),ye(Pa,"RemoteStore received new credentials");const i=za(t);t.Ea.add(3),await yu(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await mf(t)}async function dD(n,e){const t=je(n);e?(t.Ea.delete(2),await mf(t)):e||(t.Ea.add(2),await yu(t),t.Va.set("Unknown"))}function pl(n){return n.ma||(n.ma=(function(t,i,a){const l=je(t);return l.sa(),new W4(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Zo:nD.bind(null,n),Yo:sD.bind(null,n),t_:iD.bind(null,n),J_:rD.bind(null,n)}),n.Ra.push((async e=>{e?(n.ma.B_(),O0(n)?k0(n):n.Va.set("Unknown")):(await n.ma.stop(),V1(n))}))),n.ma}function jr(n){return n.fa||(n.fa=(function(t,i,a){const l=je(t);return l.sa(),new Q4(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:lD.bind(null,n),t_:hD.bind(null,n),ta:cD.bind(null,n),na:uD.bind(null,n)}),n.Ra.push((async e=>{e?(n.fa.B_(),await yf(n)):(await n.fa.stop(),n.Ta.length>0&&(ye(Pa,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j0{constructor(e,t,i,a,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=a,this.removalCallback=l,this.deferred=new Ai,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,a,l){const c=Date.now()+i,d=new j0(e,t,c,a,l);return d.start(i),d}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new me(ae.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function D0(n,e){if(Ri("AsyncQueue",`${e}: ${n}`),fl(n))return new me(ae.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zo{static emptySet(e){return new Zo(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Ee.comparator(t.key,i.key):(t,i)=>Ee.comparator(t.key,i.key),this.keyedMap=Ic(),this.sortedSet=new mt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Zo)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=i.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Zo;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cx{constructor(){this.ga=new mt(Ee.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Ie(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class ll{constructor(e,t,i,a,l,c,d,g,m){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=a,this.mutatedKeys=l,this.fromCache=c,this.syncStateChanged=d,this.excludesMetadataChanges=g,this.hasCachedResults=m}static fromInitialDocuments(e,t,i,a,l){const c=[];return t.forEach((d=>{c.push({type:0,doc:d})})),new ll(e,t,Zo.emptySet(t),c,i,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&uf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==i[a].type||!t[a].doc.isEqual(i[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fD{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class pD{constructor(){this.queries=ux(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const a=je(t),l=a.queries;a.queries=ux(),l.forEach(((c,d)=>{for(const g of d.ba)g.onError(i)}))})(this,new me(ae.ABORTED,"Firestore shutting down"))}}function ux(){return new Ba((n=>o1(n)),uf)}async function q1(n,e){const t=je(n);let i=3;const a=e.query;let l=t.queries.get(a);l?!l.Sa()&&e.Da()&&(i=2):(l=new fD,i=e.Da()?0:1);try{switch(i){case 0:l.wa=await t.onListen(a,!0);break;case 1:l.wa=await t.onListen(a,!1);break;case 2:await t.onFirstRemoteStoreListen(a)}}catch(c){const d=D0(c,`Initialization of query '${zo(e.query)}' failed`);return void e.onError(d)}t.queries.set(a,l),l.ba.push(e),e.va(t.onlineState),l.wa&&e.Fa(l.wa)&&P0(t)}async function $1(n,e){const t=je(n),i=e.query;let a=3;const l=t.queries.get(i);if(l){const c=l.ba.indexOf(e);c>=0&&(l.ba.splice(c,1),l.ba.length===0?a=e.Da()?0:1:!l.Sa()&&e.Da()&&(a=2))}switch(a){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function gD(n,e){const t=je(n);let i=!1;for(const a of e){const l=a.query,c=t.queries.get(l);if(c){for(const d of c.ba)d.Fa(a)&&(i=!0);c.wa=a}}i&&P0(t)}function mD(n,e,t){const i=je(n),a=i.queries.get(e);if(a)for(const l of a.ba)l.onError(t);i.queries.delete(e)}function P0(n){n.Ca.forEach((e=>{e.next()}))}var Im,hx;(hx=Im||(Im={})).Ma="default",hx.Cache="cache";class F1{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const a of e.docChanges)a.type!==3&&i.push(a);e=new ll(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=ll.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Im.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G1{constructor(e){this.key=e}}class K1{constructor(e){this.key=e}}class yD{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=$e(),this.mutatedKeys=$e(),this.eu=l1(e),this.tu=new Zo(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new cx,a=t?t.tu:this.tu;let l=t?t.mutatedKeys:this.mutatedKeys,c=a,d=!1;const g=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,m=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((_,w)=>{const x=a.get(_),S=hf(this.query,w)?w:null,A=!!x&&this.mutatedKeys.has(x.key),D=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations);let I=!1;x&&S?x.data.isEqual(S.data)?A!==D&&(i.track({type:3,doc:S}),I=!0):this.su(x,S)||(i.track({type:2,doc:S}),I=!0,(g&&this.eu(S,g)>0||m&&this.eu(S,m)<0)&&(d=!0)):!x&&S?(i.track({type:0,doc:S}),I=!0):x&&!S&&(i.track({type:1,doc:x}),I=!0,(g||m)&&(d=!0)),I&&(S?(c=c.add(S),l=D?l.add(_):l.delete(_)):(c=c.delete(_),l=l.delete(_)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const _=this.query.limitType==="F"?c.last():c.first();c=c.delete(_.key),l=l.delete(_.key),i.track({type:1,doc:_})}return{tu:c,iu:i,Ss:d,mutatedKeys:l}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,a){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const c=e.iu.ya();c.sort(((_,w)=>(function(S,A){const D=I=>{switch(I){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ie(20277,{Vt:I})}};return D(S)-D(A)})(_.type,w.type)||this.eu(_.doc,w.doc))),this.ou(i),a=a??!1;const d=t&&!a?this._u():[],g=this.Ya.size===0&&this.current&&!a?1:0,m=g!==this.Xa;return this.Xa=g,c.length!==0||m?{snapshot:new ll(this.query,e.tu,l,c,e.mutatedKeys,g===0,m,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:d}:{au:d}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new cx,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=$e(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new K1(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new G1(i))})),t}cu(e){this.Za=e.ks,this.Ya=$e();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return ll.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const M0="SyncEngine";class vD{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class _D{constructor(e){this.key=e,this.hu=!1}}class bD{constructor(e,t,i,a,l,c){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=c,this.Pu={},this.Tu=new Ba((d=>o1(d)),uf),this.Iu=new Map,this.Eu=new Set,this.Ru=new mt(Ee.comparator),this.Au=new Map,this.Vu=new S0,this.du={},this.mu=new Map,this.fu=ol.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function wD(n,e,t=!0){const i=Z1(n);let a;const l=i.Tu.get(e);return l?(i.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.lu()):a=await Y1(i,e,t,!0),a}async function xD(n,e){const t=Z1(n);await Y1(t,e,!0,!1)}async function Y1(n,e,t,i){const a=await z4(n.localStore,Qs(e)),l=a.targetId,c=n.sharedClientState.addLocalQueryTarget(l,t);let d;return i&&(d=await TD(n,e,l,c==="current",a.resumeToken)),n.isPrimaryClient&&t&&L1(n.remoteStore,a),d}async function TD(n,e,t,i,a){n.pu=(w,x,S)=>(async function(D,I,U,q){let z=I.view.ru(U);z.Ss&&(z=await sx(D.localStore,I.query,!1).then((({documents:R})=>I.view.ru(R,z))));const O=q&&q.targetChanges.get(I.targetId),$=q&&q.targetMismatches.get(I.targetId)!=null,Q=I.view.applyChanges(z,D.isPrimaryClient,O,$);return fx(D,I.targetId,Q.au),Q.snapshot})(n,w,x,S);const l=await sx(n.localStore,e,!0),c=new yD(e,l.ks),d=c.ru(l.documents),g=mu.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",a),m=c.applyChanges(d,n.isPrimaryClient,g);fx(n,t,m.au);const _=new vD(e,t,c);return n.Tu.set(e,_),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),m.snapshot}async function ED(n,e,t){const i=je(n),a=i.Tu.get(e),l=i.Iu.get(a.targetId);if(l.length>1)return i.Iu.set(a.targetId,l.filter((c=>!uf(c,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(a.targetId),i.sharedClientState.isActiveQueryTarget(a.targetId)||await Cm(i.localStore,a.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(a.targetId),t&&R0(i.remoteStore,a.targetId),km(i,a.targetId)})).catch(dl)):(km(i,a.targetId),await Cm(i.localStore,a.targetId,!0))}async function SD(n,e){const t=je(n),i=t.Tu.get(e),a=t.Iu.get(i.targetId);t.isPrimaryClient&&a.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),R0(t.remoteStore,i.targetId))}async function AD(n,e,t){const i=jD(n);try{const a=await(function(c,d){const g=je(c),m=ht.now(),_=d.reduce(((S,A)=>S.add(A.key)),$e());let w,x;return g.persistence.runTransaction("Locally write mutations","readwrite",(S=>{let A=ki(),D=$e();return g.xs.getEntries(S,_).next((I=>{A=I,A.forEach(((U,q)=>{q.isValidDocument()||(D=D.add(U))}))})).next((()=>g.localDocuments.getOverlayedDocuments(S,A))).next((I=>{w=I;const U=[];for(const q of d){const z=Bj(q,w.get(q.key).overlayedDocument);z!=null&&U.push(new Vr(q.key,z,ZE(z.value.mapValue),Js.exists(!0)))}return g.mutationQueue.addMutationBatch(S,m,U,d)})).next((I=>{x=I;const U=I.applyToLocalDocumentSet(w,D);return g.documentOverlayCache.saveOverlays(S,I.batchId,U)}))})).then((()=>({batchId:x.batchId,changes:u1(w)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(a.batchId),(function(c,d,g){let m=c.du[c.currentUser.toKey()];m||(m=new mt(qe)),m=m.insert(d,g),c.du[c.currentUser.toKey()]=m})(i,a.batchId,t),await vu(i,a.changes),await yf(i.remoteStore)}catch(a){const l=D0(a,"Failed to persist write");t.reject(l)}}async function W1(n,e){const t=je(n);try{const i=await U4(t.localStore,e);e.targetChanges.forEach(((a,l)=>{const c=t.Au.get(l);c&&(Xe(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?c.hu=!0:a.modifiedDocuments.size>0?Xe(c.hu,14607):a.removedDocuments.size>0&&(Xe(c.hu,42227),c.hu=!1))})),await vu(t,i,e)}catch(i){await dl(i)}}function dx(n,e,t){const i=je(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const a=[];i.Tu.forEach(((l,c)=>{const d=c.view.va(e);d.snapshot&&a.push(d.snapshot)})),(function(c,d){const g=je(c);g.onlineState=d;let m=!1;g.queries.forEach(((_,w)=>{for(const x of w.ba)x.va(d)&&(m=!0)})),m&&P0(g)})(i.eventManager,e),a.length&&i.Pu.J_(a),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function ND(n,e,t){const i=je(n);i.sharedClientState.updateQueryState(e,"rejected",t);const a=i.Au.get(e),l=a&&a.key;if(l){let c=new mt(Ee.comparator);c=c.insert(l,cn.newNoDocument(l,ke.min()));const d=$e().add(l),g=new pf(ke.min(),new Map,new mt(qe),c,d);await W1(i,g),i.Ru=i.Ru.remove(l),i.Au.delete(e),L0(i)}else await Cm(i.localStore,e,!1).then((()=>km(i,e,t))).catch(dl)}async function CD(n,e){const t=je(n),i=e.batch.batchId;try{const a=await L4(t.localStore,e);J1(t,i,null),Q1(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await vu(t,a)}catch(a){await dl(a)}}async function RD(n,e,t){const i=je(n);try{const a=await(function(c,d){const g=je(c);return g.persistence.runTransaction("Reject batch","readwrite-primary",(m=>{let _;return g.mutationQueue.lookupMutationBatch(m,d).next((w=>(Xe(w!==null,37113),_=w.keys(),g.mutationQueue.removeMutationBatch(m,w)))).next((()=>g.mutationQueue.performConsistencyCheck(m))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(m,_,d))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,_))).next((()=>g.localDocuments.getDocuments(m,_)))}))})(i.localStore,e);J1(i,e,t),Q1(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await vu(i,a)}catch(a){await dl(a)}}function Q1(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function J1(n,e,t){const i=je(n);let a=i.du[i.currentUser.toKey()];if(a){const l=a.get(e);l&&(t?l.reject(t):l.resolve(),a=a.remove(e)),i.du[i.currentUser.toKey()]=a}}function km(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach((i=>{n.Vu.containsKey(i)||X1(n,i)}))}function X1(n,e){n.Eu.delete(e.path.canonicalString());const t=n.Ru.get(e);t!==null&&(R0(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),L0(n))}function fx(n,e,t){for(const i of t)i instanceof G1?(n.Vu.addReference(i.key,e),ID(n,i)):i instanceof K1?(ye(M0,"Document no longer in limbo: "+i.key),n.Vu.removeReference(i.key,e),n.Vu.containsKey(i.key)||X1(n,i.key)):Ie(19791,{wu:i})}function ID(n,e){const t=e.key,i=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(i)||(ye(M0,"New document in limbo: "+t),n.Eu.add(i),L0(n))}function L0(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Ee(lt.fromString(e)),i=n.fu.next();n.Au.set(i,new _D(t)),n.Ru=n.Ru.insert(t,i),L1(n.remoteStore,new br(Qs(b0(t.path)),i,"TargetPurposeLimboResolution",of.ce))}}async function vu(n,e,t){const i=je(n),a=[],l=[],c=[];i.Tu.isEmpty()||(i.Tu.forEach(((d,g)=>{c.push(i.pu(g,e,t).then((m=>{var _;if((m||t)&&i.isPrimaryClient){const w=m?!m.fromCache:(_=t==null?void 0:t.targetChanges.get(g.targetId))==null?void 0:_.current;i.sharedClientState.updateQueryState(g.targetId,w?"current":"not-current")}if(m){a.push(m);const w=N0.Es(g.targetId,m);l.push(w)}})))})),await Promise.all(c),i.Pu.J_(a),await(async function(g,m){const _=je(g);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",(w=>oe.forEach(m,(x=>oe.forEach(x.Ts,(S=>_.persistence.referenceDelegate.addReference(w,x.targetId,S))).next((()=>oe.forEach(x.Is,(S=>_.persistence.referenceDelegate.removeReference(w,x.targetId,S)))))))))}catch(w){if(!fl(w))throw w;ye(C0,"Failed to update sequence numbers: "+w)}for(const w of m){const x=w.targetId;if(!w.fromCache){const S=_.vs.get(x),A=S.snapshotVersion,D=S.withLastLimboFreeSnapshotVersion(A);_.vs=_.vs.insert(x,D)}}})(i.localStore,l))}async function kD(n,e){const t=je(n);if(!t.currentUser.isEqual(e)){ye(M0,"User change. New user:",e.toKey());const i=await j1(t.localStore,e);t.currentUser=e,(function(l,c){l.mu.forEach((d=>{d.forEach((g=>{g.reject(new me(ae.CANCELLED,c))}))})),l.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await vu(t,i.Ns)}}function OD(n,e){const t=je(n),i=t.Au.get(e);if(i&&i.hu)return $e().add(i.key);{let a=$e();const l=t.Iu.get(e);if(!l)return a;for(const c of l){const d=t.Tu.get(c);a=a.unionWith(d.view.nu)}return a}}function Z1(n){const e=je(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=W1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=OD.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=ND.bind(null,e),e.Pu.J_=gD.bind(null,e.eventManager),e.Pu.yu=mD.bind(null,e.eventManager),e}function jD(n){const e=je(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=CD.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=RD.bind(null,e),e}class qd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=gf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return M4(this.persistence,new j4,e.initialUser,this.serializer)}Cu(e){return new O1(A0.Vi,this.serializer)}Du(e){return new q4}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}qd.provider={build:()=>new qd};class DD extends qd{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Xe(this.persistence.referenceDelegate instanceof zd,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new v4(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Tn.withCacheSize(this.cacheSizeBytes):Tn.DEFAULT;return new O1((i=>zd.Vi(i,t)),this.serializer)}}class Om{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>dx(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=kD.bind(null,this.syncEngine),await dD(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new pD})()}createDatastore(e){const t=gf(e.databaseInfo.databaseId),i=Y4(e.databaseInfo);return Z4(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,a,l,c,d){return new tD(i,a,l,c,d)})(this.localStore,this.datastore,e.asyncQueue,(t=>dx(this.syncEngine,t,0)),(function(){return ax.v()?new ax:new $4})())}createSyncEngine(e,t){return(function(a,l,c,d,g,m,_){const w=new bD(a,l,c,d,g,m);return _&&(w.gu=!0),w})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(a){const l=je(a);ye(Pa,"RemoteStore shutting down."),l.Ea.add(5),await yu(l),l.Aa.shutdown(),l.Va.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}Om.provider={build:()=>new Om};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eS{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ri("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dr="FirestoreClient";class PD{constructor(e,t,i,a,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=a,this.user=ln.UNAUTHENTICATED,this.clientId=p0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(i,(async c=>{ye(Dr,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(i,(c=>(ye(Dr,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ai;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=D0(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Fg(n,e){n.asyncQueue.verifyOperationInProgress(),ye(Dr,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async a=>{i.isEqual(a)||(await j1(e.localStore,a),i=a)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function px(n,e){n.asyncQueue.verifyOperationInProgress();const t=await MD(n);ye(Dr,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>lx(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,a)=>lx(e.remoteStore,a))),n._onlineComponents=e}async function MD(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ye(Dr,"Using user provided OfflineComponentProvider");try{await Fg(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(a){return a.name==="FirebaseError"?a.code===ae.FAILED_PRECONDITION||a.code===ae.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(t))throw t;sl("Error using user provided cache. Falling back to memory cache: "+t),await Fg(n,new qd)}}else ye(Dr,"Using default OfflineComponentProvider"),await Fg(n,new DD(void 0));return n._offlineComponents}async function tS(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ye(Dr,"Using user provided OnlineComponentProvider"),await px(n,n._uninitializedComponentsProvider._online)):(ye(Dr,"Using default OnlineComponentProvider"),await px(n,new Om))),n._onlineComponents}function LD(n){return tS(n).then((e=>e.syncEngine))}async function nS(n){const e=await tS(n),t=e.eventManager;return t.onListen=wD.bind(null,e.syncEngine),t.onUnlisten=ED.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=xD.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=SD.bind(null,e.syncEngine),t}function UD(n,e,t={}){const i=new Ai;return n.asyncQueue.enqueueAndForget((async()=>(function(l,c,d,g,m){const _=new eS({next:x=>{_.Nu(),c.enqueueAndForget((()=>$1(l,w)));const S=x.docs.has(d);!S&&x.fromCache?m.reject(new me(ae.UNAVAILABLE,"Failed to get document because the client is offline.")):S&&x.fromCache&&g&&g.source==="server"?m.reject(new me(ae.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(x)},error:x=>m.reject(x)}),w=new F1(b0(d.path),_,{includeMetadataChanges:!0,Ka:!0});return q1(l,w)})(await nS(n),n.asyncQueue,e,t,i))),i.promise}function VD(n,e,t={}){const i=new Ai;return n.asyncQueue.enqueueAndForget((async()=>(function(l,c,d,g,m){const _=new eS({next:x=>{_.Nu(),c.enqueueAndForget((()=>$1(l,w))),x.fromCache&&g.source==="server"?m.reject(new me(ae.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(x)},error:x=>m.reject(x)}),w=new F1(d,_,{includeMetadataChanges:!0,Ka:!0});return q1(l,w)})(await nS(n),n.asyncQueue,e,t,i))),i.promise}function BD(n,e){const t=new Ai;return n.asyncQueue.enqueueAndForget((async()=>AD(await LD(n),e,t))),t.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sS(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zD="ComponentProvider",gx=new Map;function HD(n,e,t,i,a){return new cj(n,e,t,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,sS(a.experimentalLongPollingOptions),a.useFetchStreams,a.isUsingEmulator,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iS="firestore.googleapis.com",mx=!0;class yx{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new me(ae.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=iS,this.ssl=mx}else this.host=e.host,this.ssl=e.ssl??mx;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=k1;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<m4)throw new me(ae.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}XO("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=sS(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new me(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new me(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new me(ae.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,a){return i.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class vf{constructor(e,t,i,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new yx({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new me(ae.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new me(ae.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new yx(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new HO;switch(i.type){case"firstParty":return new GO(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new me(ae.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=gx.get(t);i&&(ye(zD,"Removing Datastore"),gx.delete(t),i.terminate())})(this),Promise.resolve()}}function qD(n,e,t,i={}){var m;n=Ii(n,vf);const a=La(e),l=n._getSettings(),c={...l,emulatorOptions:n._getEmulatorOptions()},d=`${e}:${t}`;a&&(Ym(`https://${d}`),Wm("Firestore",!0)),l.host!==iS&&l.host!==d&&sl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...l,host:d,ssl:a,emulatorOptions:i};if(!Cr(g,c)&&(n._setSettings(g),i.mockUserToken)){let _,w;if(typeof i.mockUserToken=="string")_=i.mockUserToken,w=ln.MOCK_USER;else{_=ET(i.mockUserToken,(m=n._app)==null?void 0:m.options.projectId);const x=i.mockUserToken.sub||i.mockUserToken.user_id;if(!x)throw new me(ae.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");w=new ln(x)}n._authCredentials=new qO(new zE(_,w))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gl{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new gl(this.firestore,e,this._query)}}class St{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ar(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new St(this.firestore,e,this._key)}toJSON(){return{type:St._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(fu(t,St._jsonSchema))return new St(e,i||null,new Ee(lt.fromString(t.referencePath)))}}St._jsonSchemaVersion="firestore/documentReference/1.0",St._jsonSchema={type:Ut("string",St._jsonSchemaVersion),referencePath:Ut("string")};class Ar extends gl{constructor(e,t,i){super(e,t,b0(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new St(this.firestore,null,new Ee(e))}withConverter(e){return new Ar(this.firestore,e,this._path)}}function rS(n,e,...t){if(n=gt(n),HE("collection","path",e),n instanceof vf){const i=lt.fromString(e,...t);return Iw(i),new Ar(n,null,i)}{if(!(n instanceof St||n instanceof Ar))throw new me(ae.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(lt.fromString(e,...t));return Iw(i),new Ar(n.firestore,null,i)}}function wr(n,e,...t){if(n=gt(n),arguments.length===1&&(e=p0.newId()),HE("doc","path",e),n instanceof vf){const i=lt.fromString(e,...t);return Rw(i),new St(n,null,new Ee(i))}{if(!(n instanceof St||n instanceof Ar))throw new me(ae.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(lt.fromString(e,...t));return Rw(i),new St(n.firestore,n instanceof Ar?n.converter:null,new Ee(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vx="AsyncQueue";class _x{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new P1(this,"async_queue_retry"),this._c=()=>{const i=$g();i&&ye(vx,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=$g();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=$g();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Ai;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!fl(e))throw e;ye(vx,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Ri("INTERNAL UNHANDLED ERROR: ",bx(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const a=j0.createAndSchedule(this,e,t,i,(l=>this.hc(l)));return this.tc.push(a),a}uc(){this.nc&&Ie(47125,{Pc:bx(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function bx(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class _u extends vf{constructor(e,t,i,a){super(e,t,i,a),this.type="firestore",this._queue=new _x,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new _x(e),this._firestoreClient=void 0,await e}}}function $D(n,e){const t=typeof n=="object"?n:Zd(),i=typeof n=="string"?n:Dd,a=Pr(t,"firestore").getImmediate({identifier:i});if(!a._initialized){const l=wT("firestore");l&&qD(a,...l)}return a}function U0(n){if(n._terminated)throw new me(ae.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||FD(n),n._firestoreClient}function FD(n){var i,a,l,c;const e=n._freezeSettings(),t=HD(n._databaseId,((i=n._app)==null?void 0:i.options.appId)||"",n._persistenceKey,(a=n._app)==null?void 0:a.options.apiKey,e);n._componentsProvider||(l=e.localCache)!=null&&l._offlineComponentProvider&&((c=e.localCache)!=null&&c._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new PD(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(g){const m=g==null?void 0:g._online.build();return{_offline:g==null?void 0:g._offline.build(m),_online:m}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Zn(rn.fromBase64String(e))}catch(t){throw new me(ae.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Zn(rn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Zn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(fu(e,Zn._jsonSchema))return Zn.fromBase64String(e.bytes)}}Zn._jsonSchemaVersion="firestore/bytes/1.0",Zn._jsonSchema={type:Ut("string",Zn._jsonSchemaVersion),bytes:Ut("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V0{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new me(ae.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new sn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B0{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zs{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new me(ae.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new me(ae.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return qe(this._lat,e._lat)||qe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Zs._jsonSchemaVersion}}static fromJSON(e){if(fu(e,Zs._jsonSchema))return new Zs(e.latitude,e.longitude)}}Zs._jsonSchemaVersion="firestore/geoPoint/1.0",Zs._jsonSchema={type:Ut("string",Zs._jsonSchemaVersion),latitude:Ut("number"),longitude:Ut("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,a){if(i.length!==a.length)return!1;for(let l=0;l<i.length;++l)if(i[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:bs._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(fu(e,bs._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new bs(e.vectorValues);throw new me(ae.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}bs._jsonSchemaVersion="firestore/vectorValue/1.0",bs._jsonSchema={type:Ut("string",bs._jsonSchemaVersion),vectorValues:Ut("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GD=/^__.*__$/;class KD{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Vr(e,this.data,this.fieldMask,t,this.fieldTransforms):new gu(e,this.data,t,this.fieldTransforms)}}class aS{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new Vr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function oS(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ie(40011,{dataSource:n})}}class z0{constructor(e,t,i,a,l,c){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=a,l===void 0&&this.validatePath(),this.fieldTransforms=l||[],this.fieldMask=c||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new z0({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){var a;const t=(a=this.path)==null?void 0:a.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){var a;const t=(a=this.path)==null?void 0:a.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return $d(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(oS(this.dataSource)&&GD.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class YD{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||gf(e)}createContext(e,t,i,a=!1){return new z0({dataSource:e,methodName:t,targetDoc:i,path:sn.emptyPath(),arrayElement:!1,hasConverter:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function H0(n){const e=n._freezeSettings(),t=gf(n._databaseId);return new YD(n._databaseId,!!e.ignoreUndefinedProperties,t)}function WD(n,e,t,i,a,l={}){const c=n.createContext(l.merge||l.mergeFields?2:0,e,t,a);q0("Data must be an object, but it was:",c,i);const d=lS(i,c);let g,m;if(l.merge)g=new Un(c.fieldMask),m=c.fieldTransforms;else if(l.mergeFields){const _=[];for(const w of l.mergeFields){const x=cl(e,w,t);if(!c.contains(x))throw new me(ae.INVALID_ARGUMENT,`Field '${x}' is specified in your field mask but missing from your input data.`);hS(_,x)||_.push(x)}g=new Un(_),m=c.fieldTransforms.filter((w=>g.covers(w.field)))}else g=null,m=c.fieldTransforms;return new KD(new Sn(d),g,m)}class _f extends B0{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof _f}}function QD(n,e,t,i){const a=n.createContext(1,e,t);q0("Data must be an object, but it was:",a,i);const l=[],c=Sn.empty();Ur(i,((g,m)=>{const _=uS(e,g,t);m=gt(m);const w=a.childContextForFieldPath(_);if(m instanceof _f)l.push(_);else{const x=bu(m,w);x!=null&&(l.push(_),c.set(_,x))}}));const d=new Un(l);return new aS(c,d,a.fieldTransforms)}function JD(n,e,t,i,a,l){const c=n.createContext(1,e,t),d=[cl(e,i,t)],g=[a];if(l.length%2!=0)throw new me(ae.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let x=0;x<l.length;x+=2)d.push(cl(e,l[x])),g.push(l[x+1]);const m=[],_=Sn.empty();for(let x=d.length-1;x>=0;--x)if(!hS(m,d[x])){const S=d[x];let A=g[x];A=gt(A);const D=c.childContextForFieldPath(S);if(A instanceof _f)m.push(S);else{const I=bu(A,D);I!=null&&(m.push(S),_.set(S,I))}}const w=new Un(m);return new aS(_,w,c.fieldTransforms)}function XD(n,e,t,i=!1){return bu(t,n.createContext(i?4:3,e))}function bu(n,e){if(cS(n=gt(n)))return q0("Unsupported field value:",e,n),lS(n,e);if(n instanceof B0)return(function(i,a){if(!oS(a.dataSource))throw a.createError(`${i._methodName}() can only be used with update() and set()`);if(!a.path)throw a.createError(`${i._methodName}() is not currently supported inside arrays`);const l=i._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,a){const l=[];let c=0;for(const d of i){let g=bu(d,a.childContextForArray(c));g==null&&(g={nullValue:"NULL_VALUE"}),l.push(g),c++}return{arrayValue:{values:l}}})(n,e)}return(function(i,a){if((i=gt(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return Dj(a.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const l=ht.fromDate(i);return{timestampValue:Bd(a.serializer,l)}}if(i instanceof ht){const l=new ht(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Bd(a.serializer,l)}}if(i instanceof Zs)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Zn)return{bytesValue:T1(a.serializer,i._byteString)};if(i instanceof St){const l=a.databaseId,c=i.firestore._databaseId;if(!c.isEqual(l))throw a.createError(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:E0(i.firestore._databaseId||a.databaseId,i._key.path)}}if(i instanceof bs)return(function(c,d){const g=c instanceof bs?c.toArray():c;return{mapValue:{fields:{[JE]:{stringValue:XE},[Pd]:{arrayValue:{values:g.map((_=>{if(typeof _!="number")throw d.createError("VectorValues must only contain numeric values.");return w0(d.serializer,_)}))}}}}}})(i,a);if(I1(i))return i._toProto(a.serializer);throw a.createError(`Unsupported field value: ${af(i)}`)})(n,e)}function lS(n,e){const t={};return FE(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ur(n,((i,a)=>{const l=bu(a,e.childContextForField(i));l!=null&&(t[i]=l)})),{mapValue:{fields:t}}}function cS(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ht||n instanceof Zs||n instanceof Zn||n instanceof St||n instanceof B0||n instanceof bs||I1(n))}function q0(n,e,t){if(!cS(t)||!qE(t)){const i=af(t);throw i==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+i)}}function cl(n,e,t){if((e=gt(e))instanceof V0)return e._internalPath;if(typeof e=="string")return uS(n,e);throw $d("Field path arguments must be of type string or ",n,!1,void 0,t)}const ZD=new RegExp("[~\\*/\\[\\]]");function uS(n,e,t){if(e.search(ZD)>=0)throw $d(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new V0(...e.split("."))._internalPath}catch{throw $d(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function $d(n,e,t,i,a){const l=i&&!i.isEmpty(),c=a!==void 0;let d=`Function ${e}() called with invalid data`;t&&(d+=" (via `toFirestore()`)"),d+=". ";let g="";return(l||c)&&(g+=" (found",l&&(g+=` in field ${i}`),c&&(g+=` in document ${a}`),g+=")"),new me(ae.INVALID_ARGUMENT,d+n+g)}function hS(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eP{convertValue(e,t="none"){switch(Or(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Et(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(kr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ie(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return Ur(e,((a,l)=>{i[a]=this.convertValue(l,t)})),i}convertVectorValue(e){var i,a,l;const t=(l=(a=(i=e.fields)==null?void 0:i[Pd].arrayValue)==null?void 0:a.values)==null?void 0:l.map((c=>Et(c.doubleValue)));return new bs(t)}convertGeoPoint(e){return new Zs(Et(e.latitude),Et(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=cf(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Qc(e));default:return null}}convertTimestamp(e){const t=Ir(e);return new ht(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=lt.fromString(e);Xe(R1(i),9688,{name:e});const a=new Jc(i.get(1),i.get(3)),l=new Ee(i.popFirst(5));return a.isEqual(t)||Ri(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dS extends eP{constructor(e){super(),this.firestore=e}convertBytes(e){return new Zn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new St(this.firestore,null,t)}}const wx="@firebase/firestore",xx="4.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fS{constructor(e,t,i,a,l){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new St(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new tP(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){var e;return((e=this._document)==null?void 0:e.data.clone().value.mapValue.fields)??void 0}get(e){if(this._document){const t=this._document.data.field(cl("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class tP extends fS{data(){return super.data()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nP(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new me(ae.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class $0{}class sP extends $0{}function Tx(n,e,...t){let i=[];e instanceof $0&&i.push(e),i=i.concat(t),(function(l){const c=l.filter((g=>g instanceof F0)).length,d=l.filter((g=>g instanceof bf)).length;if(c>1||c>0&&d>0)throw new me(ae.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const a of i)n=a._apply(n);return n}class bf extends sP{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new bf(e,t,i)}_apply(e){const t=this._parse(e);return pS(e._query,t),new gl(e.firestore,e.converter,xm(e._query,t))}_parse(e){const t=H0(e.firestore);return(function(l,c,d,g,m,_,w){let x;if(m.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new me(ae.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){Ax(w,_);const A=[];for(const D of w)A.push(Sx(g,l,D));x={arrayValue:{values:A}}}else x=Sx(g,l,w)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||Ax(w,_),x=XD(d,c,w,_==="in"||_==="not-in");return Lt.create(m,_,x)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Ex(n,e,t){const i=e,a=cl("where",n);return bf._create(a,i,t)}class F0 extends $0{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new F0(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:xs.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(a,l){let c=a;const d=l.getFlattenedFilters();for(const g of d)pS(c,g),c=xm(c,g)})(e._query,t),new gl(e.firestore,e.converter,xm(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Sx(n,e,t){if(typeof(t=gt(t))=="string"){if(t==="")throw new me(ae.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!a1(e)&&t.indexOf("/")!==-1)throw new me(ae.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(lt.fromString(t));if(!Ee.isDocumentKey(i))throw new me(ae.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Uw(n,new Ee(i))}if(t instanceof St)return Uw(n,t._key);throw new me(ae.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${af(t)}.`)}function Ax(n,e){if(!Array.isArray(n)||n.length===0)throw new me(ae.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function pS(n,e){const t=(function(a,l){for(const c of a)for(const d of c.getFlattenedFilters())if(l.indexOf(d.op)>=0)return d.op;return null})(n.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new me(ae.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new me(ae.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function iP(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class Oc{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ca extends fS{constructor(e,t,i,a,l,c){super(e,t,i,a,c),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new xd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(cl("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new me(ae.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Ca._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Ca._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ca._jsonSchema={type:Ut("string",Ca._jsonSchemaVersion),bundleSource:Ut("string","DocumentSnapshot"),bundleName:Ut("string"),bundle:Ut("string")};class xd extends Ca{data(e={}){return super.data(e)}}class el{constructor(e,t,i,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new Oc(a.hasPendingWrites,a.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new xd(this._firestore,this._userDataWriter,i.key,i,new Oc(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new me(ae.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let c=0;return a._snapshot.docChanges.map((d=>{const g=new xd(a._firestore,a._userDataWriter,d.doc.key,d.doc,new Oc(a._snapshot.mutatedKeys.has(d.doc.key),a._snapshot.fromCache),a.query.converter);return d.doc,{type:"added",doc:g,oldIndex:-1,newIndex:c++}}))}{let c=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((d=>l||d.type!==3)).map((d=>{const g=new xd(a._firestore,a._userDataWriter,d.doc.key,d.doc,new Oc(a._snapshot.mutatedKeys.has(d.doc.key),a._snapshot.fromCache),a.query.converter);let m=-1,_=-1;return d.type!==0&&(m=c.indexOf(d.doc.key),c=c.delete(d.doc.key)),d.type!==1&&(c=c.add(d.doc),_=c.indexOf(d.doc.key)),{type:rP(d.type),doc:g,oldIndex:m,newIndex:_}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new me(ae.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=el._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=p0.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),i.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function rP(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ie(61501,{type:n})}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */el._jsonSchemaVersion="firestore/querySnapshot/1.0",el._jsonSchema={type:Ut("string",el._jsonSchemaVersion),bundleSource:Ut("string","QuerySnapshot"),bundleName:Ut("string"),bundle:Ut("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gS(n){n=Ii(n,St);const e=Ii(n.firestore,_u),t=U0(e);return UD(t,n._key).then((i=>aP(e,n,i)))}function jm(n){n=Ii(n,gl);const e=Ii(n.firestore,_u),t=U0(e),i=new dS(e);return nP(n._query),VD(t,n._query).then((a=>new el(e,i,n,a)))}function Dm(n,e,t){n=Ii(n,St);const i=Ii(n.firestore,_u),a=iP(n.converter,e,t),l=H0(i);return mS(i,[WD(l,"setDoc",n._key,a,n.converter!==null,t).toMutation(n._key,Js.none())])}function Pm(n,e,t,...i){n=Ii(n,St);const a=Ii(n.firestore,_u),l=H0(a);let c;return c=typeof(e=gt(e))=="string"||e instanceof V0?JD(l,"updateDoc",n._key,e,t,i):QD(l,"updateDoc",n._key,e),mS(a,[c.toMutation(n._key,Js.exists(!0))])}function mS(n,e){const t=U0(n);return BD(t,e)}function aP(n,e,t){const i=t.docs.get(e._key),a=new dS(n);return new Ca(n,a,e._key,i,new Oc(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){zO(Va),ws(new es("firestore",((i,{instanceIdentifier:a,options:l})=>{const c=i.getProvider("app").getImmediate(),d=new _u(new $O(i.getProvider("auth-internal")),new KO(c,i.getProvider("app-check-internal")),uj(c,a),c);return l={useFetchStreams:t,...l},d._setSettings(l),d}),"PUBLIC").setMultipleInstances(!0)),An(wx,xx,e),An(wx,xx,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yS="firebasestorage.googleapis.com",oP="storageBucket",lP=120*1e3,cP=600*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Br=class vS extends ns{constructor(e,t,i=0){super(Gg(e),`Firebase Storage: ${t} (${Gg(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,vS.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Gg(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}};var ti;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ti||(ti={}));function Gg(n){return"storage/"+n}function uP(){const n="An unknown error occurred, please check the error payload for server response.";return new Br(ti.UNKNOWN,n)}function hP(){return new Br(ti.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function dP(){return new Br(ti.CANCELED,"User canceled the upload/download.")}function fP(n){return new Br(ti.INVALID_URL,"Invalid URL '"+n+"'.")}function pP(n){return new Br(ti.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function Nx(n){return new Br(ti.INVALID_ARGUMENT,n)}function _S(){return new Br(ti.APP_DELETED,"The Firebase app was deleted.")}function gP(n){return new Br(ti.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=vs.makeFromUrl(e,t)}catch{return new vs(e,"")}if(i.path==="")return i;throw pP(e)}static makeFromUrl(e,t){let i=null;const a="([A-Za-z0-9.\\-_]+)";function l(O){O.path.charAt(O.path.length-1)==="/"&&(O.path_=O.path_.slice(0,-1))}const c="(/(.*))?$",d=new RegExp("^gs://"+a+c,"i"),g={bucket:1,path:3};function m(O){O.path_=decodeURIComponent(O.path)}const _="v[A-Za-z0-9_]+",w=t.replace(/[.]/g,"\\."),x="(/([^?#]*).*)?$",S=new RegExp(`^https?://${w}/${_}/b/${a}/o${x}`,"i"),A={bucket:1,path:3},D=t===yS?"(?:storage.googleapis.com|storage.cloud.google.com)":t,I="([^?#]*)",U=new RegExp(`^https?://${D}/${a}/${I}`,"i"),z=[{regex:d,indices:g,postModify:l},{regex:S,indices:A,postModify:m},{regex:U,indices:{bucket:1,path:2},postModify:m}];for(let O=0;O<z.length;O++){const $=z[O],Q=$.regex.exec(e);if(Q){const R=Q[$.indices.bucket];let N=Q[$.indices.path];N||(N=""),i=new vs(R,N),$.postModify(i);break}}if(i==null)throw fP(e);return i}}class mP{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yP(n,e,t){let i=1,a=null,l=null,c=!1,d=0;function g(){return d===2}let m=!1;function _(...I){m||(m=!0,e.apply(null,I))}function w(I){a=setTimeout(()=>{a=null,n(S,g())},I)}function x(){l&&clearTimeout(l)}function S(I,...U){if(m){x();return}if(I){x(),_.call(null,I,...U);return}if(g()||c){x(),_.call(null,I,...U);return}i<64&&(i*=2);let z;d===1?(d=2,z=0):z=(i+Math.random())*1e3,w(z)}let A=!1;function D(I){A||(A=!0,x(),!m&&(a!==null?(I||(d=2),clearTimeout(a),w(0)):I||(d=1)))}return w(0),l=setTimeout(()=>{c=!0,D(!0)},t),D}function vP(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _P(n){return n!==void 0}function Cx(n,e,t,i){if(i<e)throw Nx(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw Nx(`Invalid value for '${n}'. Expected ${t} or less.`)}function bP(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const a=e(i)+"="+e(n[i]);t=t+a+"&"}return t=t.slice(0,-1),t}var Fd;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Fd||(Fd={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wP(n,e){const t=n>=500&&n<600,a=[408,429].indexOf(n)!==-1,l=e.indexOf(n)!==-1;return t||a||l}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xP{constructor(e,t,i,a,l,c,d,g,m,_,w,x=!0,S=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=a,this.successCodes_=l,this.additionalRetryCodes_=c,this.callback_=d,this.errorCallback_=g,this.timeout_=m,this.progressCallback_=_,this.connectionFactory_=w,this.retry=x,this.isUsingEmulator=S,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((A,D)=>{this.resolve_=A,this.reject_=D,this.start_()})}start_(){const e=(i,a)=>{if(a){i(!1,new id(!1,null,!0));return}const l=this.connectionFactory_();this.pendingConnection_=l;const c=d=>{const g=d.loaded,m=d.lengthComputable?d.total:-1;this.progressCallback_!==null&&this.progressCallback_(g,m)};this.progressCallback_!==null&&l.addUploadProgressListener(c),l.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&l.removeUploadProgressListener(c),this.pendingConnection_=null;const d=l.getErrorCode()===Fd.NO_ERROR,g=l.getStatus();if(!d||wP(g,this.additionalRetryCodes_)&&this.retry){const _=l.getErrorCode()===Fd.ABORT;i(!1,new id(!1,null,_));return}const m=this.successCodes_.indexOf(g)!==-1;i(!0,new id(m,l))})},t=(i,a)=>{const l=this.resolve_,c=this.reject_,d=a.connection;if(a.wasSuccessCode)try{const g=this.callback_(d,d.getResponse());_P(g)?l(g):l()}catch(g){c(g)}else if(d!==null){const g=uP();g.serverResponse=d.getErrorText(),this.errorCallback_?c(this.errorCallback_(d,g)):c(g)}else if(a.canceled){const g=this.appDelete_?_S():dP();c(g)}else{const g=hP();c(g)}};this.canceled_?t(!1,new id(!1,null,!0)):this.backoffId_=yP(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&vP(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class id{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function TP(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function EP(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function SP(n,e){e&&(n["X-Firebase-GMPID"]=e)}function AP(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function NP(n,e,t,i,a,l,c=!0,d=!1){const g=bP(n.urlParams),m=n.url+g,_=Object.assign({},n.headers);return SP(_,e),TP(_,t),EP(_,l),AP(_,i),new xP(m,n.method,_,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,a,c,d)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CP(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function RP(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gd{constructor(e,t){this._service=e,t instanceof vs?this._location=t:this._location=vs.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Gd(e,t)}get root(){const e=new vs(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return RP(this._location.path)}get storage(){return this._service}get parent(){const e=CP(this._location.path);if(e===null)return null;const t=new vs(this._location.bucket,e);return new Gd(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw gP(e)}}function Rx(n,e){const t=e==null?void 0:e[oP];return t==null?null:vs.makeFromBucketSpec(t,n)}function IP(n,e,t,i={}){n.host=`${e}:${t}`;const a=La(e);a&&(Ym(`https://${n.host}/b`),Wm("Storage",!0)),n._isUsingEmulator=!0,n._protocol=a?"https":"http";const{mockUserToken:l}=i;l&&(n._overrideAuthToken=typeof l=="string"?l:ET(l,n.app.options.projectId))}class kP{constructor(e,t,i,a,l,c=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=a,this._firebaseVersion=l,this._isUsingEmulator=c,this._bucket=null,this._host=yS,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=lP,this._maxUploadRetryTime=cP,this._requests=new Set,a!=null?this._bucket=vs.makeFromBucketSpec(a,this._host):this._bucket=Rx(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=vs.makeFromBucketSpec(this._url,e):this._bucket=Rx(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Cx("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Cx("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(En(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Gd(this,e)}_makeRequest(e,t,i,a,l=!0){if(this._deleted)return new mP(_S());{const c=NP(e,this._appId,i,a,t,this._firebaseVersion,l,this._isUsingEmulator);return this._requests.add(c),c.getPromise().then(()=>this._requests.delete(c),()=>this._requests.delete(c)),c}}async makeRequestWithTokens(e,t){const[i,a]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,a).getPromise()}}const Ix="@firebase/storage",kx="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bS="storage";function OP(n=Zd(),e){n=gt(n);const i=Pr(n,bS).getImmediate({identifier:e}),a=wT("storage");return a&&jP(i,...a),i}function jP(n,e,t,i={}){IP(n,e,t,i)}function DP(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),a=n.getProvider("app-check-internal");return new kP(t,i,a,e,Va)}function PP(){ws(new es(bS,DP,"PUBLIC").setMultipleInstances(!0)),An(Ix,kx,""),An(Ix,kx,"esm2020")}PP();const MP={apiKey:"AIzaSyAGphhC3qC1qLA_ErvpWk9QAaHc0N3ovQM",authDomain:"appaistudio-55b77.firebaseapp.com",projectId:"appaistudio-55b77",storageBucket:"appaistudio-55b77.firebasestorage.app",messagingSenderId:"98616437820",appId:"1:98616437820:web:10b78e2f4718d35b3ee739",measurementId:"G-Q8Q00T026N"},wf=kT(MP);vI(wf);const jc=VO(wf),Ys=$D(wf);OP(wf);const Nr={registerUser:async(n,e,t,i,a="user")=>{try{const l=rS(Ys,"users"),c=Tx(l,Ex("username","==",t));if(!(await jm(c)).empty)throw new Error("Tn hin th  tn ti. Vui lng chn tn khc.");const g=Tx(l,Ex("phone","==",i));if(!(await jm(g)).empty)throw new Error("S in thoi  c ng k bi ti khon khc.");const w=(await wk(jc,n,e)).user;await Ek(w,{displayName:t});let x="user";a==="admin"&&(x=a);let S=["video-viral","image-script","zenshot-ai","translation"];const A={id:w.uid,username:t,email:n,phone:i,role:x,allowedApps:S,createdAt:Date.now()};return await Dm(wr(Ys,"users",w.uid),A),A}catch(l){throw console.error("Firebase Registration Error:",l),l.code==="auth/email-already-in-use"?new Error("Email ny  c ng k."):l}},loginUser:async(n,e)=>{try{const i=(await xk(jc,n,e)).user,a=await Nr.getUserProfile(i.uid);return a||{id:i.uid,username:i.displayName||n.split("@")[0],email:n,phone:"",role:"user",allowedApps:[],createdAt:Date.now()}}catch(t){throw console.error("Firebase Login Error:",t),t}},loginWithGoogle:async()=>{var n;try{const e=new xi,i=(await Yk(jc,e)).user;let a=await Nr.getUserProfile(i.uid);return a||(a={id:i.uid,username:i.displayName||((n=i.email)==null?void 0:n.split("@")[0])||"Google User",email:i.email||"",phone:i.phoneNumber||"",role:"user",allowedApps:["video-viral","image-script","zenshot-ai","translation"],createdAt:Date.now()},await Dm(wr(Ys,"users",i.uid),a)),a}catch(e){throw console.error("Google Login Error:",e),e}},getUserProfile:async n=>{try{const e=wr(Ys,"users",n),t=await gS(e);return t.exists()?t.data():(console.warn("No such document!"),null)}catch(e){return console.error("Error getting user profile:",e),null}},logoutUser:async()=>{try{await Ck(jc)}catch(n){throw console.error("Logout Error:",n),n}},updateProfile:async(n,e)=>{try{const t=wr(Ys,"users",n);await Pm(t,e)}catch(t){throw console.error("Update Profile Error:",t),t}}},LP=({onLogin:n})=>{const[e,t]=le.useState(!1),[i,a]=le.useState(""),[l,c]=le.useState(""),[d,g]=le.useState(""),[m,_]=le.useState(""),[w,x]=le.useState(""),[S,A]=le.useState(""),[D,I]=le.useState(!1),U=$c.useRef(!0);$c.useEffect(()=>(U.current=!0,()=>{U.current=!1}),[]);const q=async()=>{if(A(""),I(!0),!m||!l){A("Vui lng nhp Email v Mt khu"),I(!1);return}try{console.log("Starting Auth...");const z=new Promise(($,Q)=>setTimeout(()=>Q(new Error("Request timed out (15s)")),15e3));let O;if(e){if(!i||!w){A("Vui lng nhp y  Tn v ST"),I(!1);return}if(l!==d){A("Mt khu nhp li khng khp"),I(!1);return}O=await Promise.race([Nr.registerUser(m,l,i,w),z])}else O=await Promise.race([Nr.loginUser(m,l),z]);console.log("Auth Success:",O),n(O)}catch(z){if(console.error(z),z.message.includes("timed out"))A("Mng qu chm hoc b chn. Vui lng th li!"),alert("Li: Qu thi gian ch (Timeout). Kim tra kt ni mng.");else if(z.code==="auth/email-already-in-use")A("Email ny  c ng k. Vui lng s dng Email khc hoc ng nhp.");else if(z.message.includes("Tn hin th  tn ti"))A("Tn hin th ny  tn ti. Vui lng chn tn khc.");else if(z.message.includes("S in thoi  c ng k"))A("S in thoi ny  c ng k. Vui lng s dng s khc.");else if(z.code==="auth/invalid-email")A("a ch Email khng hp l (V d: ten@gmail.com).");else if(z.code==="auth/wrong-password"||z.code==="auth/user-not-found")A("Ti khon hoc mt khu khng chnh xc.");else if(z.code==="auth/too-many-requests")A("Qu nhiu ln th ng nhp sai. Vui lng th li sau t pht.");else if(z.code==="auth/network-request-failed")A("Li kt ni mng. Vui lng kim tra ng truyn.");else if(z.code==="auth/unauthorized-domain")A("Tn min trang web cha c cp php trong Firebase Auth (Authorized Domains).");else{let O=z.message||"Li khng xc nh";O.includes("Missing or insufficient permissions")?O="Li quyn truy cp h thng (Firestore). Vui lng bo Admin kim tra Security Rules.":O.includes("quota")?O="H thng qu ti (Quota Exceeded).":O.includes("internal")&&(O="Li ni b h thng (Internal Error)."),A("Li: "+O),!O.includes(" c ngi dng")&&!O.includes("Email ny  c s dng")&&alert("Thng bo t h thng: "+O)}}finally{U.current&&I(!1)}};return f.jsx("div",{className:"min-h-screen bg-[#020617] flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-[#1e293b] p-8 rounded-2xl shadow-xl w-full max-w-md border border-white/10",children:[f.jsx("h2",{className:"text-2xl font-bold text-white mb-6 text-center",children:e?"ng K Ti Khon":"ng Nhp"}),f.jsxs("div",{className:"space-y-4",children:[e&&f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400 mb-2",children:"Tn hin th"}),f.jsx("input",{type:"text",value:i,onChange:z=>a(z.target.value),className:"w-full bg-[#0f172a] border border-slate-700 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 outline-none"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400 mb-2",children:"Email"}),f.jsx("input",{type:"email",value:m,onChange:z=>_(z.target.value),className:"w-full bg-[#0f172a] border border-slate-700 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 outline-none"})]}),e&&f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400 mb-2",children:"S in thoi"}),f.jsx("input",{type:"tel",value:w,onChange:z=>x(z.target.value),className:"w-full bg-[#0f172a] border border-slate-700 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 outline-none"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400 mb-2",children:"Mt khu"}),f.jsx("input",{type:"password",value:l,onChange:z=>c(z.target.value),className:"w-full bg-[#0f172a] border border-slate-700 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 outline-none"})]}),e&&f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400 mb-2",children:"Nhp li mt khu"}),f.jsx("input",{type:"password",value:d,onChange:z=>g(z.target.value),className:"w-full bg-[#0f172a] border border-slate-700 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 outline-none"})]}),S&&f.jsx("p",{className:"text-red-400 text-sm text-center",children:S}),f.jsx("button",{onClick:q,disabled:D,className:`w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 rounded-lg transition-colors mt-4 ${D?"opacity-50 cursor-not-allowed":""}`,children:D?"ang x l...":e?"ng K":"ng Nhp"}),f.jsxs("div",{className:"relative flex py-2 items-center",children:[f.jsx("div",{className:"flex-grow border-t border-white/10"}),f.jsx("span",{className:"flex-shrink-0 mx-4 text-slate-500 text-xs uppercase",children:"Hoc"}),f.jsx("div",{className:"flex-grow border-t border-white/10"})]}),f.jsxs("button",{onClick:async()=>{A(""),I(!0);try{const z=await Nr.loginWithGoogle();n(z)}catch(z){console.error(z),z.code==="auth/popup-closed-by-user"?A("Bn  hy ng nhp Google."):A("Li ng nhp Google: "+z.message)}finally{U.current&&I(!1)}},disabled:D,className:"w-full bg-white text-slate-900 hover:bg-slate-100 font-bold py-3 rounded-lg transition-colors flex items-center justify-center gap-2",children:[f.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[f.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),f.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),f.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),f.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Tip tc vi Google"]}),f.jsx("p",{className:"text-center text-slate-400 text-sm mt-4 cursor-pointer hover:text-white",onClick:()=>t(!e),children:e?" c ti khon? ng nhp ngay":"Cha c ti khon? ng k mi"}),f.jsx("div",{className:"mt-6 pt-4 border-t border-white/5 text-center",children:f.jsx("span",{className:"text-[10px] uppercase font-black tracking-widest text-orange-500/50",children:"System: Firebase V2 (Fast) + Supabase Storage"})})]}),f.jsxs("div",{className:"mt-8 pt-6 border-t border-white/10 text-center",children:[f.jsx("p",{className:"text-slate-500 text-xs mb-3",children:"Gp s c ng nhp?"}),f.jsx("button",{onClick:()=>{window.confirm("Thao tc ny s xa ton b d liu tm (Cache/Storage) v ti li trang. Bn c chc chn?")&&(localStorage.clear(),sessionStorage.clear(),window.location.reload())},className:"text-xs font-bold text-slate-400 hover:text-red-400 uppercase tracking-wider underline decoration-slate-700 hover:decoration-red-400 underline-offset-4 transition-all",children:"Xa Cache & Ti Li App"}),f.jsx("div",{className:"mt-2 text-[10px] text-slate-600",children:'S dng khi b li "Timeout" hoc treo logo'})]})]})})},rd=[{id:"Cinematic Realistic",label:"Cinematic High-End Realistic (in nh thc t cao cp)"},{id:"3D Pixar Animation",label:"3D Pixar/Disney Style Animation (Hot hnh 3D Pixar/Disney)"},{id:"Japanese Anime 90s",label:"Classic 90s Japanese Anime (Hot hnh Nht Bn thp nin 90)"},{id:"Modern Makoto Shinkai",label:"Makoto Shinkai Cinematic Style (Phong cch Makoto Shinkai hin i)"},{id:"Studio Ghibli Aesthetic",label:"Studio Ghibli Hand-painted Aesthetic (Phong cch v tay Ghibli)"},{id:"Cyberpunk Neon 2077",label:"Cyberpunk Neon / Sci-Fi Futurism (Tng lai vin tng Neon)"},{id:"Hyper-realistic 8K Photo",label:"Hyper-realistic 8K RAW Photography (Nhip nh siu thc 8K)"},{id:"Spider-Verse Vibrant Comic",label:"Into the Spider-Verse Vibrant Comic (Truyn tranh phong cch Spider-Verse)"},{id:"Vintage 16mm Film",label:"Vintage 16mm Grainy Film Style (Phim nha 16mm c in)"},{id:"Noir Black and White",label:"Classic Film Noir / Moody Black & White (Phim en trng Noir su lng)"},{id:"Oil Painting Impressionism",label:"Classic Oil Painting / Impressionist Art (Tranh sn du n tng)"},{id:"Lo-fi Aesthetic Retro",label:"Lo-fi / Vaporwave Retro Aesthetic (Phong cch Lo-fi c in)"},{id:"Claymation Stop Motion",label:"Claymation Claymation Style (Hot hnh t st)"},{id:"Minimalist Vector Art",label:"Clean Minimalist Vector Illustration (Minh ha Vector ti gin)"},{id:"Dark Fantasy Gothic",label:"Dark Fantasy / Gothic Horror Style (Gi tng en ti / Gothic)"},{id:"Ukiyo-e Woodblock",label:"Traditional Japanese Ukiyo-e Woodblock (Tranh khc g Nht Bn)"},{id:"Surrealist Dreamscape",label:"Surrealist / Dreamlike Visual Art (Ngh thut siu thc o mng)"},{id:"Paper Cutout Collage",label:"Hand-crafted Paper Cutout Collage (Ct dn giy th cng)"},{id:"Sketch Graphite Art",label:"Detailed Graphite Pencil Sketch (Phc tho bt ch chi tit)"},{id:"Glitch Art Digital",label:"Experimental Glitch Art / Digital Distortion (Ngh thut li k thut s)"}];let UP=class extends le.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("ErrorBoundary caught error:",e,t)}render(){var e;return this.state.hasError?f.jsxs("div",{className:"p-8 m-8 bg-slate-900 border border-slate-700 rounded-3xl space-y-4 text-center text-white",children:[f.jsx("h2",{className:"text-xl font-bold text-rose-500",children:" xy ra li hin th"}),f.jsx("p",{className:"text-slate-300",children:(e=this.state.error)==null?void 0:e.message}),f.jsx("button",{onClick:()=>this.setState({hasError:!1}),className:"px-6 py-3 bg-white text-slate-900 font-bold rounded-xl hover:bg-slate-200 transition-all",children:"Th li"}),f.jsx("p",{className:"text-xs text-slate-500",children:"D liu vn c lu trong b nh tm."})]}):this.props.children}};const VP=({userId:n})=>{const[e,t]=le.useState({opponentScript:"",skeleton:null,ideas:[],selectedIdeaIndex:null,outlines:{},finalScripts:{},selectedStyle:rd[0].id,characters:[],tags:{},showCharacterSection:!1,loading:{analysis:!1,ideas:!1,outline:!1,script:!1,characters:!1}}),[i,a]=le.useState("");le.useEffect(()=>{if(!n)return;const O=`app_api_keys_${n}`,$=localStorage.getItem(O);if($)try{const Q=JSON.parse($),N=atob(Q.gemini||"").split(`
`).map(k=>k.trim()).filter(k=>k);N.length>0&&(a(N.join(`
`)),rm(N))}catch(Q){console.error("Failed to load Gemini keys",Q)}},[n]);const[l,c]=le.useState(null),d=(O,$="info")=>{c({message:O,type:$}),setTimeout(()=>c(null),5e3)},g=le.useRef(null),m=O=>/[\u3040-\u30ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff\uff66-\uff9f\uac00-\ud7af]/.test(O)?O.replace(/\s/g,"").length:O.trim().split(/\s+/).filter(Boolean).length,_=async()=>{if(e.opponentScript.trim()){t(O=>({...O,loading:{...O.loading,analysis:!0}}));try{const O=await uN(e.opponentScript,i),$=m(e.opponentScript),Q=O.split(/PHONG CCH I TH/i),R=Q.length>1?Q[1].trim():"T nhin, viral";t(N=>({...N,skeleton:{content:O,wordCount:$,style:R},loading:{...N.loading,analysis:!1}}))}catch(O){console.error(O),d("Li Phn tch: "+(O instanceof Error?O.message:String(O)),"error"),t($=>({...$,loading:{...$.loading,analysis:!1}}))}}},w=async()=>{if(e.skeleton){t(O=>({...O,loading:{...O.loading,ideas:!0}}));try{const O=await hN(e.skeleton.content,i);t($=>({...$,ideas:O,loading:{...$.loading,ideas:!1}}))}catch(O){console.error(O),d("Li Sinh  tng: "+(O instanceof Error?O.message:String(O)),"error"),t($=>({...$,loading:{...$.loading,ideas:!1}}))}}},x=async O=>{if(!(!e.skeleton||!e.ideas[O])){t($=>({...$,selectedIdeaIndex:O,loading:{...$.loading,outline:!0}}));try{const $=await dN(e.skeleton.content,e.ideas[O],e.skeleton.wordCount,i);t(Q=>({...Q,outlines:{...Q.outlines,[O]:$},loading:{...Q.loading,outline:!1}}))}catch($){console.error($),d("Li Lp dn : "+($ instanceof Error?$.message:String($)),"error"),t(Q=>({...Q,loading:{...Q.loading,outline:!1}}))}}},S=async O=>{if(!(!e.outlines[O]||!e.skeleton)){t($=>({...$,loading:{...$.loading,script:!0}}));try{const $=await fN(e.outlines[O],e.skeleton.style,i);t(Q=>({...Q,finalScripts:{...Q.finalScripts,[O]:$},loading:{...Q.loading,script:!1}}))}catch($){console.error($),d("Li Vit kch bn: "+($ instanceof Error?$.message:String($)),"error"),t(Q=>({...Q,loading:{...Q.loading,script:!1}}))}}},A=async()=>{const O=e.selectedIdeaIndex,$=O!==null?e.finalScripts[O]:null;if(t(Q=>({...Q,showCharacterSection:!0})),setTimeout(()=>{var Q;(Q=g.current)==null||Q.scrollIntoView({behavior:"smooth",block:"start"})},100),$)try{const Q=await pN($,rd.map(N=>N.id),i),R=rd.find(N=>N.id===Q||Q.includes(N.id));R&&t(N=>({...N,selectedStyle:R.id}))}catch(Q){console.error("Style recommendation failed",Q)}},D=async()=>{const O=e.selectedIdeaIndex;if(!(O===null||!e.finalScripts[O])){t($=>({...$,loading:{...$.loading,characters:!0}}));try{const $=await gN(e.finalScripts[O],e.selectedStyle,i);t(Q=>({...Q,characters:$,loading:{...Q.loading,characters:!1}}))}catch($){console.error($),d("Li Thit k NV: "+($ instanceof Error?$.message:String($)),"error"),t(Q=>({...Q,loading:{...Q.loading,characters:!1}}))}}},I=O=>{const $=e.finalScripts[O];if(!$)return;const Q=2e3;let R=[];if($.length<=Q)R=[$];else{let k=$;for(;k.length>0;){let M=k.lastIndexOf(`
`,Q);(M===-1||M<500)&&(M=Q),R.push(k.substring(0,M).trim()),k=k.substring(M).trim()}}const N=R.map(k=>({content:k,actions:[],isAnalyzing:!1}));t(k=>({...k,tags:{...k.tags,[O]:N}}))},U=async(O,$)=>{var R;const Q=(R=e.tags[O])==null?void 0:R[$];if(!Q||!e.characters.length){d("Vui lng thc hin bc 'Thit k Nhn Vt' trc khi phn tch hnh ng.","info");return}t(N=>{const k={...N.tags},M=[...k[O]||[]];return M[$]&&(M[$]={...M[$],isAnalyzing:!0}),k[O]=M,{...N,tags:k}});try{const N=await mN(Q.content,e.selectedStyle,e.characters,i);t(k=>{const M={...k.tags},L=[...M[O]||[]];return L[$]&&(L[$]={...L[$],actions:N,isAnalyzing:!1}),M[O]=L,{...k,tags:M}})}catch(N){console.error(N),d("Li Phn tch Tag: "+(N instanceof Error?N.message:String(N)),"error"),t(k=>{const M={...k.tags},L=[...M[O]||[]];return L[$]&&(L[$]={...L[$],isAnalyzing:!1}),M[O]=L,{...k,tags:M}})}},q=O=>{navigator.clipboard.writeText(O),d(" sao chp prompt!","success")},z=O=>{const $=O.map(Q=>Q.motionPrompt).join(`
`);navigator.clipboard.writeText($),d(" sao chp tt c prompt video!","success")};return f.jsx(UP,{children:f.jsxs($c.Fragment,{children:[l&&f.jsx("div",{className:"fixed top-4 right-4 z-50 animate-in slide-in-from-right fade-in duration-300",children:f.jsxs("div",{className:`px-6 py-4 rounded-2xl shadow-2xl flex items-center gap-3 font-bold text-sm ${l.type==="error"?"bg-rose-50 text-rose-600 border border-rose-100":l.type==="success"?"bg-emerald-50 text-emerald-600 border border-emerald-100":"bg-white text-slate-700 border border-slate-100"}`,children:[l.type==="success"&&f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),l.type==="error"&&f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),l.message]})}),f.jsxs("main",{className:"w-full grid grid-cols-1 md:grid-cols-10 gap-8 p-4 md:p-10",children:[f.jsxs("div",{className:"md:col-span-3 space-y-10",children:[f.jsxs("section",{className:"bg-white rounded-3xl shadow-xl shadow-slate-200/50 border border-slate-100 p-8 group transition-all",children:[f.jsxs("h2",{className:"text-xl font-black text-slate-800 uppercase tracking-tighter mb-6 flex items-center gap-3",children:[f.jsx("span",{className:"w-2 h-6 bg-indigo-600 rounded-full"}),"Kch bn i th"]}),f.jsx("textarea",{className:"w-full h-80 p-6 bg-slate-50 border border-slate-100 rounded-2xl focus:ring-8 focus:ring-indigo-600/5 focus:border-indigo-600/20 focus:bg-white outline-none transition-all text-sm leading-relaxed placeholder:text-slate-300 font-medium custom-scrollbar mb-6",placeholder:"Dn kch bn i th vo y...",value:e.opponentScript,onChange:O=>t($=>({...$,opponentScript:O.target.value}))}),f.jsx("button",{onClick:_,disabled:e.loading.analysis||!e.opponentScript,className:"w-full bg-[#020617] hover:bg-indigo-700 disabled:bg-slate-100 disabled:text-slate-300 text-white font-black py-6 rounded-2xl transition-all shadow-2xl hover:scale-[1.02] active:scale-95 flex justify-center items-center gap-4 text-sm uppercase tracking-widest",children:e.loading.analysis?"ang x l...":"Phn tch Cu trc & Phong cch"})]}),e.skeleton&&f.jsxs("div",{className:"space-y-8 animate-in slide-in-from-left-8 duration-700",children:[f.jsxs("div",{className:"bg-gradient-to-br from-indigo-600 to-indigo-800 rounded-3xl p-8 text-white shadow-2xl relative overflow-hidden",children:[f.jsx("h3",{className:"text-[10px] font-black uppercase opacity-60 mb-2 tracking-[0.3em]",children:"Quantitative Data"}),f.jsxs("div",{className:"text-5xl font-black italic tracking-tighter",children:[e.skeleton.wordCount," ",f.jsx("span",{className:"text-xs font-bold uppercase opacity-60",children:"Units"})]})]}),f.jsxs("section",{className:"bg-white rounded-3xl shadow-xl border border-slate-100 p-8",children:[f.jsx("h2",{className:"text-lg font-black text-slate-800 uppercase tracking-tighter mb-6",children:"Khung xng Logic"}),f.jsx("div",{className:"max-h-96 overflow-y-auto pr-4 text-sm text-slate-600 leading-relaxed whitespace-pre-wrap font-medium custom-scrollbar",children:e.skeleton.content}),f.jsx("button",{onClick:w,disabled:e.loading.ideas,className:"w-full mt-8 bg-rose-500 hover:bg-rose-600 disabled:bg-slate-100 text-white font-black py-6 rounded-2xl transition-all shadow-xl hover:scale-[1.02] active:scale-95 uppercase tracking-widest text-xs",children:"SINH 5  TNG LIN QUAN"})]})]}),e.showCharacterSection&&f.jsxs("div",{ref:g,className:"animate-in fade-in slide-in-from-bottom-12 duration-1000 space-y-8",children:[f.jsxs("section",{className:"bg-white rounded-3xl shadow-xl border border-slate-100 p-8",children:[f.jsx("h2",{className:"text-lg font-black text-slate-800 uppercase tracking-tighter mb-6",children:"B lc Phong cch"}),f.jsxs("div",{className:"space-y-6 mb-8",children:[f.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400 tracking-widest px-1",children:"Visual Architecture"}),f.jsx("select",{value:e.selectedStyle,onChange:O=>t($=>({...$,selectedStyle:O.target.value})),className:"w-full p-5 bg-slate-50 border border-slate-200 rounded-xl focus:ring-4 focus:ring-amber-500/10 outline-none text-sm font-bold text-slate-800 transition-all cursor-pointer",children:rd.map(O=>f.jsx("option",{value:O.id,children:O.label},O.id))})]}),f.jsx("button",{onClick:D,disabled:e.loading.characters,className:"w-full bg-amber-500 hover:bg-amber-600 disabled:bg-slate-100 text-white font-black py-6 rounded-2xl shadow-xl transition-all hover:scale-[1.02] active:scale-95 uppercase tracking-widest text-xs",children:"Thit k Nhn Vt"})]}),e.characters.length>0&&f.jsx("div",{className:"space-y-6",children:e.characters.map((O,$)=>f.jsxs("div",{className:"bg-[#020617] text-white p-8 rounded-[2rem] border-l-[10px] border-amber-500 shadow-3xl",children:[f.jsx("input",{className:"bg-transparent border-none text-2xl font-black text-white tracking-tighter mb-1 w-full focus:ring-0 placeholder-white/30",value:O.name,onChange:Q=>{const R=[...e.characters];R[$].name=Q.target.value,t(N=>({...N,characters:R}))},placeholder:"Tn nhn vt"}),f.jsx("div",{className:"text-[10px] font-bold text-amber-500/60 uppercase tracking-widest mb-4",children:"Neural Casting Profile"}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 text-[11px] mb-4",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"opacity-40 uppercase whitespace-nowrap",children:"G.Tnh:"}),f.jsx("input",{className:"bg-white/10 rounded px-2 py-1 w-full border-none focus:ring-1 focus:ring-amber-500 text-white",value:O.gender,onChange:Q=>{const R=[...e.characters];R[$].gender=Q.target.value,t(N=>({...N,characters:R}))}})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"opacity-40 uppercase whitespace-nowrap",children:"Tui:"}),f.jsx("input",{className:"bg-white/10 rounded px-2 py-1 w-full border-none focus:ring-1 focus:ring-amber-500 text-white",value:O.age,onChange:Q=>{const R=[...e.characters];R[$].age=Q.target.value,t(N=>({...N,characters:R}))}})]}),f.jsxs("div",{className:"flex items-center gap-2 col-span-2",children:[f.jsx("span",{className:"opacity-40 uppercase whitespace-nowrap",children:"Quc tch:"}),f.jsx("input",{className:"bg-white/10 rounded px-2 py-1 w-full border-none focus:ring-1 focus:ring-amber-500 text-white",value:O.country,onChange:Q=>{const R=[...e.characters];R[$].country=Q.target.value,t(N=>({...N,characters:R}))}})]}),f.jsxs("div",{className:"flex items-center gap-2 col-span-2",children:[f.jsx("span",{className:"opacity-40 uppercase whitespace-nowrap",children:"Dng ngi:"}),f.jsx("input",{className:"bg-white/10 rounded px-2 py-1 w-full border-none focus:ring-1 focus:ring-amber-500 text-white",value:O.bodyType,onChange:Q=>{const R=[...e.characters];R[$].bodyType=Q.target.value,t(N=>({...N,characters:R}))}})]})]}),f.jsxs("div",{className:"mt-4 pt-4 border-t border-white/10",children:[f.jsx("label",{className:"text-[10px] text-slate-400 uppercase tracking-widest block mb-1",children:"c im khun mt (Trung tnh)"}),f.jsx("textarea",{className:"w-full bg-white/5 rounded-xl p-3 text-xs text-slate-300 italic leading-relaxed border border-white/10 focus:ring-1 focus:ring-amber-500 outline-none resize-none h-24",value:O.facialDetails,onChange:Q=>{const R=[...e.characters];R[$].facialDetails=Q.target.value,t(N=>({...N,characters:R}))}})]})]},$))})]})]}),f.jsx("div",{className:"md:col-span-7 space-y-12",children:e.ideas.length>0?f.jsxs("div",{className:"space-y-16 animate-in fade-in zoom-in-95 duration-1000",children:[f.jsx("div",{className:"flex items-center justify-between border-b-4 border-slate-100 pb-8",children:f.jsxs("div",{className:"flex items-center gap-6",children:[f.jsx("div",{className:"bg-[#020617] text-white w-14 h-14 rounded-2xl flex items-center justify-center text-3xl font-black shadow-2xl",children:"#"}),f.jsx("h2",{className:"text-4xl font-black text-slate-900 tracking-tighter uppercase",children:"Production Suite"})]})}),e.ideas.map((O,$)=>f.jsxs("div",{className:"bg-white rounded-[3rem] shadow-2xl border border-slate-100 p-10 md:p-16 space-y-12 transition-all hover:border-indigo-200",children:[f.jsxs("div",{className:"space-y-8",children:[f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsxs("span",{className:"bg-indigo-600 text-white text-[11px] font-black px-6 py-2 rounded-full uppercase",children:["Module ",$+1]}),f.jsx("span",{className:"text-rose-500 text-xs font-black uppercase tracking-widest",children:O.highlightValue})]}),f.jsx("h3",{className:"text-5xl font-black text-slate-900 tracking-tighter leading-none",children:O.title}),f.jsx("p",{className:"text-xl text-slate-500 leading-relaxed font-medium",children:O.description}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 pt-4",children:[f.jsxs("div",{className:"bg-slate-50 p-8 rounded-3xl border border-slate-100",children:[f.jsx("div",{className:"text-[10px] font-black text-slate-400 uppercase mb-2 tracking-widest",children:"Environment Context"}),f.jsx("p",{className:"font-bold text-slate-700",children:O.charactersContext})]}),f.jsxs("div",{className:"bg-slate-50 p-8 rounded-3xl border border-slate-100",children:[f.jsx("div",{className:"text-[10px] font-black text-slate-400 uppercase mb-2 tracking-widest",children:"Growth Potential"}),f.jsx("p",{className:"font-bold text-slate-700",children:O.viralPotential})]})]})]}),f.jsx("div",{className:"pt-12 border-t-2 border-slate-50 space-y-12",children:e.outlines[$]?f.jsxs("div",{className:"space-y-16",children:[f.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-[2.5rem] p-12 shadow-inner",children:[f.jsxs("h4",{className:"text-slate-900 font-black mb-8 uppercase tracking-[0.4em] text-[10px] flex items-center gap-3",children:[f.jsx("span",{className:"w-2 h-2 bg-indigo-500 rounded-full animate-ping"})," Structural Protocol"]}),f.jsx("div",{className:"whitespace-pre-wrap text-base text-slate-600 leading-[2] font-medium opacity-80 max-h-[500px] overflow-y-auto pr-8 custom-scrollbar",children:e.outlines[$]}),!e.finalScripts[$]&&f.jsx("button",{onClick:()=>S($),disabled:e.loading.script,className:`mt-12 bg-emerald-600 hover:bg-emerald-700 text-white font-black px-12 py-8 rounded-2xl shadow-2xl transition-all uppercase tracking-widest text-xs ${e.loading.script?"opacity-30 cursor-not-allowed":"hover:scale-[1.02] active:scale-95"}`,children:e.loading.script?"ang vit...":"Vit kch bn hon chnh"})]}),e.finalScripts[$]&&f.jsxs("div",{className:"space-y-12 animate-in zoom-in-95 duration-[1200ms]",children:[f.jsxs("div",{className:"bg-[#020617] text-white rounded-[3.5rem] p-16 lg:p-24 shadow-[0_50px_100px_-20px_rgba(0,0,0,0.5)]",children:[f.jsx("h4",{className:"text-indigo-400 font-black uppercase text-xs tracking-[0.5em] border-b border-white/5 pb-8 mb-12",children:"Final Master Copy"}),f.jsx("div",{className:"whitespace-pre-wrap text-lg lg:text-xl font-bold tracking-tight leading-relaxed text-slate-100",children:e.finalScripts[$]})]}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-8",children:[f.jsxs("button",{onClick:A,className:"bg-amber-500 hover:bg-amber-600 text-white font-black px-12 py-10 rounded-3xl shadow-2xl transition-all hover:scale-[1.03] active:scale-95 flex flex-col items-center gap-4 text-center group",children:[f.jsx("svg",{className:"w-8 h-8 group-hover:rotate-45 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})}),f.jsxs("div",{children:[f.jsx("div",{className:"text-xl",children:"Thit lp Styles & NV"}),f.jsx("div",{className:"text-[10px] opacity-60 mt-2 uppercase tracking-widest",children:"Tip tc thit k hnh nh"})]})]}),f.jsxs("button",{onClick:()=>I($),className:"bg-indigo-600 hover:bg-indigo-700 text-white font-black px-12 py-10 rounded-3xl shadow-2xl transition-all hover:scale-[1.03] active:scale-95 flex flex-col items-center gap-4 text-center group",children:[f.jsx("svg",{className:"w-8 h-8 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),f.jsxs("div",{children:[f.jsx("div",{className:"text-xl",children:"Bt u Chia TAGS"}),f.jsx("div",{className:"text-[10px] opacity-60 mt-2 uppercase tracking-widest",children:"Shot Decomposition"})]})]})]}),e.tags[$]&&f.jsxs("div",{className:"space-y-16 pt-24 border-t-8 border-slate-100",children:[f.jsx("h3",{className:"text-5xl font-black text-slate-900 tracking-tighter italic",children:"Alpha Production Tags"}),e.tags[$].map((Q,R)=>f.jsxs("div",{className:"bg-white border-4 border-slate-50 rounded-[4rem] p-12 md:p-16 space-y-12 shadow-sm transition-all animate-in slide-in-from-bottom-16 duration-700",children:[f.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-8",children:[f.jsxs("div",{className:"flex items-center gap-6",children:[f.jsxs("div",{className:"bg-[#020617] text-white px-6 py-2 rounded-xl text-xs font-black uppercase tracking-widest",children:["TAG #",R+1]}),f.jsxs("div",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest",children:[m(Q.content)," units identified"]})]}),f.jsxs("div",{className:"flex gap-4",children:[f.jsx("button",{onClick:()=>z(Q.actions),disabled:Q.actions.length===0,className:"bg-indigo-50 hover:bg-indigo-100 text-indigo-600 px-6 py-3 rounded-xl text-xs font-black uppercase tracking-widest transition-all shadow-sm border border-indigo-100 disabled:opacity-30",children:"Copy All Video"}),f.jsx("button",{onClick:()=>U($,R),disabled:Q.isAnalyzing,className:"bg-indigo-600 hover:bg-indigo-700 disabled:bg-slate-100 text-white font-black px-10 py-4 rounded-xl text-xs transition-all shadow-xl uppercase tracking-widest",children:Q.isAnalyzing?"Processing...":"To Motion Prompts"})]})]}),f.jsx("div",{className:"p-10 bg-slate-50 rounded-[2.5rem] text-slate-500 text-lg italic font-medium leading-relaxed border-2 border-slate-100",children:Q.content}),Q.actions.length>0&&f.jsx("div",{className:"grid grid-cols-1 gap-12 mt-12",children:Q.actions.map((N,k)=>f.jsxs("div",{className:"space-y-8 animate-in slide-in-from-bottom-12 duration-1000",children:[f.jsxs("div",{className:"flex items-center gap-6",children:[f.jsx("div",{className:"w-10 h-10 bg-slate-900 text-white rounded-lg flex items-center justify-center font-black text-sm",children:k+1}),f.jsx("div",{className:"h-px flex-1 bg-slate-100"})]}),f.jsxs("div",{className:"grid grid-cols-1 gap-8",children:[f.jsxs("div",{className:"bg-[#020617] text-white p-10 rounded-[2.5rem] shadow-3xl",children:[f.jsx("div",{className:"text-[10px] font-black uppercase text-indigo-400 mb-4 tracking-widest",children:"Shot Execution"}),f.jsx("div",{className:"text-xl font-bold leading-relaxed",children:N.action})]}),f.jsxs("div",{className:"bg-indigo-50 border-l-[10px] border-indigo-400 p-10 rounded-[2.5rem] shadow-inner",children:[f.jsx("div",{className:"text-[10px] font-black text-indigo-400 uppercase tracking-widest mb-4",children:"Master Transcript"}),f.jsx("div",{className:"text-xl font-bold text-indigo-900 italic font-serif",children:N.voiceText?`"${N.voiceText}"`:"--- Instrumental Segment ---"})]}),f.jsxs("div",{className:"bg-[#FFF1F2] border-l-[10px] border-rose-400 p-10 rounded-[2.5rem] relative group shadow-lg",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx("div",{className:"text-[10px] font-black text-rose-400 uppercase tracking-[0.3em]",children:"Video Motion AI Prompt"}),f.jsx("button",{onClick:()=>q(N.motionPrompt),className:"bg-white/80 hover:bg-white p-2 rounded-lg text-rose-500 shadow-sm transition-all active:scale-90",children:f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"})})})]}),f.jsx("div",{className:"text-sm font-bold text-rose-950 leading-relaxed italic bg-white/40 p-6 rounded-2xl border border-rose-200",children:N.motionPrompt})]})]})]},k))})]},R))]})]})]}):f.jsx("button",{onClick:()=>x($),disabled:e.loading.outline,className:"bg-[#020617] text-white px-12 py-8 rounded-2xl font-black shadow-2xl hover:bg-indigo-700 hover:scale-[1.02] active:scale-95 transition-all text-sm uppercase tracking-widest",children:e.loading.outline&&e.selectedIdeaIndex===$?"Kin trc...":"Chn & Lp dn "})})]},$))]}):f.jsxs("div",{className:"h-full min-h-[900px] flex flex-col items-center justify-center text-slate-200 space-y-16 border-8 border-dashed border-slate-100 rounded-[6rem] bg-white/50 backdrop-blur-3xl group hover:border-indigo-100 transition-all duration-[2000ms]",children:[f.jsx("div",{className:"relative",children:f.jsx("div",{className:"w-56 h-56 bg-white rounded-[4.5rem] flex items-center justify-center shadow-3xl group-hover:rotate-12 transition-all",children:f.jsx("svg",{className:"w-24 h-24 text-slate-100",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})})})}),f.jsxs("div",{className:"text-center space-y-6",children:[f.jsx("h3",{className:"text-4xl font-black italic uppercase tracking-[0.5em] text-slate-300",children:"Quang Huy Production"}),f.jsx("p",{className:"text-sm font-bold text-slate-400 uppercase tracking-widest opacity-40 italic",children:"Waiting for initial data analysis to start production sequence..."})]})]})})]}),f.jsxs("footer",{className:"w-full p-20 text-center border-t border-slate-100 bg-white mt-40",children:[f.jsxs("h4",{className:"text-2xl font-black tracking-tighter uppercase text-[#020617]",children:["QUANG HUY ",f.jsx("span",{className:"text-indigo-600",children:"VIDEO"})]}),f.jsx("p",{className:"text-[10px] font-black uppercase tracking-[0.5em] text-slate-400 mt-4",children:"AI Viral Content Engine  2024"})]})]})})},Kg={},BP=n=>{let e=[];if(n&&(e=n.split(`
`).map(t=>t.trim()).filter(t=>t)),e.length===0){const t=Kg==null?void 0:Kg.VITE_GEMINI_API_KEY;t&&e.push(t)}return e},zP=["gemini-2.0-flash-lite-preview-02-05","gemini-2.5-flash","gemini-2.0-flash-lite-001","gemini-2.0-flash-exp","gemini-2.0-flash-001","gemini-2.0-flash","gemini-2.5-pro","gemini-flash-latest"],wu=async(n,e)=>{const t=BP(n);if(t.length===0)throw new Error("No API Keys provided.");let i;for(const a of t){const l=new Qd(a);for(const c of zP)try{const d=l.getGenerativeModel({model:c});return await e(d)}catch(d){console.warn(`Failed: Key(...${a.slice(-4)}) Model(${c}) error: ${d.message}`),i=d}}throw i||new Error("All keys and models failed to generate content.")},HP=async(n,e)=>wu(e,async t=>(await t.generateContent([{inlineData:{mimeType:"image/jpeg",data:n}},{text:"Hy phn tch chi tit phong cch hnh nh trong bc nh ny: nh sng, mu sc, gc my, cht liu ngh thut (medium), tm trng v cc c im hnh nh c trng khc. Tr v m t ngn gn nhng sc tch bng ting Vit."}])).response.text()||"Khng th phn tch phong cch."),qP=async(n,e)=>wu(e,async t=>{const i=`Nhim v: c kch bn di y v chia tch thnh cc phn cnh hnh nh tiu biu (Scene Breakdown). Mi phn on phi i din cho mt thng ip hoc giai on cm xc. Sau  hy m tng s phn on.
      
      Kch bn: "${n}"
      
      Tr v JSON: { "breakdown": string, "count": number }`,a={responseMimeType:"application/json"},l=await t.generateContent({contents:[{role:"user",parts:[{text:i}]}],generationConfig:a}),c=JSON.parse(l.response.text()||"{}");let d=c.breakdown||"";return typeof d!="string"&&(d=JSON.stringify(d)),{breakdown:d,count:Number(c.count)||0}}),$P=async(n,e,t,i)=>wu(i,async a=>{const l=`Da vo phn tch phn cnh: "${e}" v s lng ${t} phn on. Hy chia ni dung kch bn gc di y thnh ng ${t} hng tng ng vi cc phn on.
        
        QUY TC CC K QUAN TRNG:
        - KHNG C XO B BT C K T NO ca kch bn gc.
        - Ch c thm xung dng  phn tch cc on.
        - Tr v danh sch cc chui tng ng vi mi phn cnh.
        
        Kch bn gc: "${n}"`,c=await a.generateContent({contents:[{role:"user",parts:[{text:l}]}],generationConfig:{responseMimeType:"application/json"}}),d=JSON.parse(c.response.text()||"[]");return Array.isArray(d)?d.map(g=>typeof g=="string"?g:typeof g=="object"&&g!==null?g.content||g.text||g.description||g.script_content||g.row||JSON.stringify(g):String(g)):[]}),FP=async(n,e,t)=>wu(t,async i=>{const a=`Hy to ra Image Prompts cho Midjourney/Stable Diffusion da trn cc on kch bn sau v phong cch hnh nh c cung cp.
        
        Phong cch (Style): ${e}
        
        Cu trc Prompt (Ting Anh): [Subject], [Action], [Environment], [Lighting/Atmosphere], [Camera Angle/Lens], [Style].
        
        Cc on kch bn cn to prompt:
        ${n.map((c,d)=>`${d+1}. ${c}`).join(`
`)}
        
        Tr v mng JSON cha cc prompt tng ng theo th t (mng string).`,l=await i.generateContent({contents:[{role:"user",parts:[{text:a}]}],generationConfig:{responseMimeType:"application/json"}});return JSON.parse(l.response.text()||"[]")}),GP=async(n,e,t)=>wu(t,async i=>{const a=`Da vo ni dung kch bn v cc prompt nh  c, hy to ra cc "Video Motion Prompts" (Prompt chuyn ng cho video) tng ng.
        
        Yu cu:
        - Mi prompt video phi m t chuyn ng ca ch th v my nh (Camera motion, subject action, dynamic transitions).
        - Ngn ng: Ting Anh.
        - Kt qu phi l mt mng chui, mi chui tng ng vi mt hng kch bn.
        
        Kch bn & Prompt nh:
        ${n.map((c,d)=>`Hng ${d+1}: [Kch bn: ${c}] [Prompt nh: ${e[d]||"N/A"}]`).join(`
`)}
        
        Tr v mng JSON (mng string).`,l=await i.generateContent({contents:[{role:"user",parts:[{text:a}]}],generationConfig:{responseMimeType:"application/json"}});return JSON.parse(l.response.text()||"[]")});let wS=class extends $c.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("ErrorBoundary caught error:",e,t)}render(){var e;return this.state.hasError?f.jsxs("div",{className:"p-8 m-8 bg-red-50 border border-red-200 rounded-xl space-y-4 text-center",children:[f.jsx("h2",{className:"text-xl font-bold text-red-700",children:" xy ra li hin th"}),f.jsx("p",{className:"text-red-600",children:(e=this.state.error)==null?void 0:e.message}),f.jsx("button",{onClick:()=>this.setState({hasError:!1}),className:"px-4 py-2 bg-white border border-red-200 text-red-600 rounded-lg hover:bg-red-50",children:"Th li"}),f.jsx("p",{className:"text-xs text-slate-500",children:"D liu vn c lu trong b nh tm."})]}):this.props.children}};const KP=le.forwardRef(({tag:n,style:e,index:t,apiKey:i,onNotify:a},l)=>{const[c,d]=le.useState(n),g=le.useRef(c);le.useEffect(()=>{g.current=c},[c]);const[m,_]=le.useState({}),w=U=>new Promise(q=>setTimeout(q,U)),x=async()=>{_(U=>({...U,analyze:!0}));try{const U=await qP(c.content,i);return d(q=>({...q,analysis:U.breakdown,sceneCount:U.count})),U}catch(U){throw console.error(U),a("Li khi phn tch phn cnh","error"),U}finally{_(U=>({...U,analyze:!1}))}},S=async(U,q)=>{const z=U||c.analysis,O=q||c.sceneCount;if(!z||!O){a("Cn phn tch phn cnh trc","info");return}_($=>({...$,split:!0}));try{const $=await $P(c.content,z,O,i);return d(Q=>({...Q,rows:$})),$}catch($){throw console.error($),a("Li khi chia hng","error"),$}finally{_($=>({...$,split:!1}))}},A=async U=>{const q=U||c.rows;if(!q||q.length===0){a("Cn chia hng trc","info");return}_(z=>({...z,prompt:!0}));try{const z=await FP(q,e,i);return d(O=>({...O,prompts:z})),z}catch(z){throw console.error(z),a("Li khi to prompt","error"),z}finally{_(z=>({...z,prompt:!1}))}},D=async()=>{if(!c.rows||c.rows.length===0){a("Cn chia hng trc","info");return}_(U=>({...U,videoPrompt:!0}));try{const U=await GP(c.rows,c.prompts||[],i);d(q=>({...q,videoPrompts:U}))}catch(U){console.error(U),a("Li khi to prompt video","error")}finally{_(U=>({...U,videoPrompt:!1}))}},I=U=>{if(!U||U.length===0)return;const q=U.map(z=>z.trim()).filter(z=>z.length>0).map(z=>z.replace(/\r?\n|\r/g," ")).map(z=>z.replace(/^["']+|["']+$/g,"")).join(`
`);navigator.clipboard.writeText(q),a(" sao chp ni dung chnh xc theo tng hng!","success")};return le.useImperativeHandle(l,()=>({runAutoSequence:async()=>{const U=await x();await w(5e3);const q=await S(U.breakdown,U.count);await w(5e3),await A(q)},getRows:()=>g.current.rows||[],getPrompts:()=>g.current.prompts||[]}),[]),f.jsxs("div",{className:`bg-white rounded-2xl shadow-sm border p-6 space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500 transition-colors ${Object.values(m).some(U=>U)?"border-indigo-300 ring-1 ring-indigo-100":"border-gray-100"}`,children:[f.jsxs("div",{className:"flex items-center justify-between border-b border-gray-50 pb-4",children:[f.jsxs("h3",{className:"font-bold text-gray-800 flex items-center gap-2",children:[f.jsxs("span",{className:"w-10 h-10 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center text-xs font-bold",children:["TAG ",t+1]}),"Phn kch bn"]}),c.sceneCount!==void 0&&f.jsxs("span",{className:"px-3 py-1 bg-green-100 text-green-700 rounded-full text-xs font-bold",children:[c.sceneCount," Phn on"]})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"space-y-1",children:[f.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Ni dung kch bn"}),f.jsx("div",{className:"p-4 bg-gray-50 rounded-xl border border-gray-100 text-sm text-gray-700 max-h-48 overflow-y-auto whitespace-pre-wrap leading-relaxed",children:c.content})]}),f.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[f.jsx("button",{onClick:()=>x(),disabled:m.analyze,className:`py-2.5 px-3 rounded-xl text-xs font-semibold transition-all flex items-center justify-center gap-2 ${m.analyze?"bg-gray-100 text-gray-400":"bg-blue-50 text-blue-700 hover:bg-blue-100 active:scale-95"}`,children:m.analyze?"...":"Phn Tch"}),f.jsx("button",{onClick:()=>S(),disabled:m.split||!c.analysis,className:`py-2.5 px-3 rounded-xl text-xs font-semibold transition-all flex items-center justify-center gap-2 ${m.split||!c.analysis?"bg-gray-100 text-gray-400":"bg-teal-50 text-teal-700 hover:bg-teal-100 active:scale-95"}`,children:m.split?"...":"Chia hng"}),f.jsx("button",{onClick:()=>A(),disabled:m.prompt||!c.rows,className:`py-2.5 px-3 rounded-xl text-xs font-semibold transition-all flex items-center justify-center gap-2 ${m.prompt||!c.rows?"bg-gray-100 text-gray-400":"bg-purple-50 text-purple-700 hover:bg-purple-100 active:scale-95"}`,children:m.prompt?"...":"Prompt nh"}),f.jsx("button",{onClick:()=>D(),disabled:m.videoPrompt||!c.rows,className:`py-2.5 px-3 rounded-xl text-xs font-semibold transition-all flex items-center justify-center gap-2 ${m.videoPrompt||!c.rows?"bg-gray-100 text-gray-400":"bg-rose-50 text-rose-700 hover:bg-rose-100 active:scale-95"}`,children:m.videoPrompt?"...":"Prompt Video"})]}),c.analysis&&f.jsxs("div",{className:"p-4 bg-indigo-50 border border-indigo-100 rounded-xl space-y-2",children:[f.jsx("h4",{className:"text-xs font-bold text-indigo-700 uppercase",children:"Phn tch phn cnh"}),f.jsx("p",{className:"text-sm text-indigo-900 leading-relaxed whitespace-pre-wrap",children:c.analysis})]}),c.rows&&c.rows.length>0&&f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:["Kch bn  chia hng (",c.rows.length,")"]}),f.jsx("button",{onClick:()=>I(c.rows||[]),className:"text-[10px] font-bold text-indigo-500 hover:text-indigo-700 uppercase flex items-center gap-1",children:"Copy All"})]}),f.jsx("div",{className:"space-y-2",children:c.rows.map((U,q)=>f.jsxs("div",{className:"p-3 bg-white border border-gray-100 rounded-lg text-sm flex gap-3",children:[f.jsx("span",{className:"text-indigo-300 font-mono text-xs",children:q+1}),f.jsxs("span",{className:"text-gray-700 italic",children:['"',U,'"']})]},q))})]}),c.prompts&&c.prompts.length>0&&f.jsxs("div",{className:"space-y-3 pt-4 border-t border-gray-50",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h4",{className:"text-xs font-bold text-purple-700 uppercase tracking-wider",children:"Image Prompts"}),f.jsx("button",{onClick:()=>I(c.prompts||[]),className:"text-[10px] font-bold text-purple-500 hover:text-purple-700 uppercase flex items-center gap-1",children:"Copy All"})]}),f.jsx("div",{className:"space-y-3",children:c.prompts.map((U,q)=>f.jsxs("div",{className:"p-4 bg-purple-50 border border-purple-100 rounded-xl text-sm font-mono text-purple-900 leading-relaxed",children:[f.jsxs("div",{className:"text-[10px] font-bold text-purple-400 mb-1",children:["PROMPT #",q+1]}),U]},q))})]})]})]})}),YP=({onStyleChange:n,onSplitScript:e,apiKey:t})=>{const[i,a]=le.useState(null),[l,c]=le.useState(""),[d,g]=le.useState(""),[m,_]=le.useState(!1),w=async S=>{var I;const A=(I=S.target.files)==null?void 0:I[0];if(!A)return;const D=new FileReader;D.onloadend=async()=>{const U=D.result.split(",")[1];a(D.result),_(!0);try{const q=await HP(U,t);c(q),n(q)}catch(q){console.error(q),alert("Li khi phn tch nh: "+(q instanceof Error?q.message:String(q)))}finally{_(!1)}},D.readAsDataURL(A)},x=()=>{d.trim()&&e(d)};return f.jsxs("div",{className:"flex flex-col h-full space-y-6 p-6 border-r border-gray-200 bg-white",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx("h2",{className:"text-xl font-bold text-indigo-700",children:"HOT AI Visual Director"}),f.jsx("p",{className:"text-xs text-gray-500 italic",children:"Professional image direction & analysis"})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Ti nh phong cch"}),f.jsxs("div",{className:"relative group",children:[f.jsxs("div",{className:`border-2 border-dashed rounded-xl p-4 transition-all duration-300 flex flex-col items-center justify-center cursor-pointer ${i?"border-indigo-400 bg-indigo-50":"border-gray-300 hover:border-indigo-500 hover:bg-gray-50"}`,children:[f.jsx("input",{type:"file",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",onChange:w,accept:"image/*"}),i?f.jsx("img",{src:i,alt:"Reference",className:"w-full h-32 object-cover rounded-lg shadow-sm"}):f.jsxs("div",{className:"text-center",children:[f.jsx("svg",{className:"mx-auto h-10 w-10 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),f.jsx("span",{className:"mt-2 block text-xs font-medium text-gray-600",children:"Click hoc ko th nh vo y"})]})]}),m&&f.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-70 flex items-center justify-center rounded-xl",children:f.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Phong cch phn tch"}),f.jsx("textarea",{value:l,onChange:S=>{c(S.target.value),n(S.target.value)},className:"w-full h-32 p-3 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent resize-none bg-gray-50",placeholder:"c im phong cch s hin  y..."})]}),f.jsxs("div",{className:"flex-grow flex flex-col space-y-2",children:[f.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Nhp kch bn"}),f.jsx("textarea",{value:d,onChange:S=>g(S.target.value),className:"flex-grow w-full p-3 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent resize-none",placeholder:"Dn kch bn ca bn vo y..."})]}),f.jsx("button",{onClick:x,className:"w-full py-3 px-4 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-xl shadow-lg transform transition-all active:scale-95 focus:outline-none focus:ring-4 focus:ring-indigo-200",children:"Chia Kch Bn"}),f.jsx("div",{className:"text-[10px] text-gray-400 text-center uppercase tracking-widest",children:" 2024 HOT AI Studio"})]})},WP=({tags:n,style:e,apiKey:t,onNotify:i})=>{const a=le.useRef([]),[l,c]=le.useState(!1),[d,g]=le.useState(""),m=async()=>{if(n.length!==0){c(!0),g("ang x l...");try{for(let x=0;x<a.current.length;x++){const S=a.current[x];S&&(g(`ang x l Tag ${x+1}/${n.length}...`),console.log(`Auto processing tag ${x+1}/${n.length}...`),await S.runAutoSequence())}g("Hon tt!")}catch(x){console.error(x),g("C li xy ra!"),i("Qu trnh t ng b gin on do li.","error")}finally{c(!1),setTimeout(()=>g(""),5e3)}}},_=()=>{const x=[];if(a.current.forEach(S=>{if(S){const D=S.getRows().map(I=>I.trim()).filter(I=>I.length>0).map(I=>I.replace(/\r?\n|\r/g," ")).map(I=>I.replace(/^["']+|["']+$/g,""));x.push(...D)}}),x.length===0){i("Khng c kch bn  chia hng  copy!","info");return}navigator.clipboard.writeText(x.join(`
`)),i(` copy chnh xc ${x.length} hng kch bn!`,"success")},w=()=>{const x=[];if(a.current.forEach(S=>{if(S){const D=S.getPrompts().map(I=>I.trim()).filter(I=>I.length>0).map(I=>I.replace(/\r?\n|\r/g," ")).map(I=>I.replace(/^["']+|["']+$/g,""));x.push(...D)}}),x.length===0){i("Khng c prompt  copy!","info");return}navigator.clipboard.writeText(x.join(`
`)),i(` copy chnh xc ${x.length} prompt!`,"success")};return n.length===0?f.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-gray-400 space-y-4 p-12 bg-white rounded-3xl border border-gray-100 border-dashed",children:[f.jsx("svg",{className:"w-16 h-16 opacity-20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),f.jsx("p",{className:"text-lg font-medium",children:"Cha c kch bn c chia"}),f.jsx("p",{className:"text-sm",children:'Vui lng nhp kch bn v nhn "Chia Kch Bn"  ct tri'})]}):(a.current.length!==n.length&&(a.current=new Array(n.length).fill(null)),f.jsxs("div",{className:"space-y-8 pb-12",children:[f.jsxs("div",{className:"flex flex-wrap items-center gap-3 p-4 bg-gray-100 rounded-2xl sticky top-4 z-10 shadow-sm border border-gray-200",children:[f.jsx("button",{onClick:m,disabled:l,className:`px-6 py-2.5 rounded-xl font-bold text-sm transition-all flex items-center gap-2 ${l?"bg-gray-400 text-white cursor-not-allowed":"bg-gradient-to-r from-indigo-600 to-blue-600 hover:from-indigo-700 hover:to-blue-700 text-white shadow-md active:scale-95"}`,children:l?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"ang T ng..."]}):f.jsxs(f.Fragment,{children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"T ng Hon Ton"]})}),f.jsxs("button",{onClick:_,className:"px-5 py-2.5 bg-white border border-gray-200 text-gray-700 rounded-xl font-bold text-sm hover:bg-gray-50 transition-all shadow-sm active:scale-95 flex items-center gap-2",children:[f.jsx("svg",{className:"w-4 h-4 text-teal-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),"Copy All Kch Bn"]}),f.jsxs("button",{onClick:w,className:"px-5 py-2.5 bg-white border border-gray-200 text-gray-700 rounded-xl font-bold text-sm hover:bg-gray-50 transition-all shadow-sm active:scale-95 flex items-center gap-2",children:[f.jsx("svg",{className:"w-4 h-4 text-purple-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Copy All Prompt Anh"]})]}),d&&f.jsxs("div",{className:`mx-4 mt-2 p-3 rounded-xl text-sm font-bold flex items-center gap-2 ${d==="C li xy ra!"?"bg-red-50 text-red-600":"bg-green-50 text-green-700 border border-green-200"}`,children:[d==="Hon tt!"?f.jsx("svg",{className:"w-5 h-5 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}):f.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-current border-t-transparent animate-spin"}),d]}),f.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[f.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Bng iu Khin Tags"}),f.jsx("div",{className:"h-px flex-grow bg-gray-100"}),f.jsxs("span",{className:"text-sm font-medium text-gray-400",children:[n.length," TAGS SN SNG"]})]}),f.jsx("div",{className:"space-y-8",children:n.map((x,S)=>f.jsx(KP,{tag:x,style:e,index:S,apiKey:t,ref:A=>{a.current[S]=A},onNotify:i},x.id))})]}))},QP=({userId:n})=>{const[e,t]=le.useState(""),[i,a]=le.useState([]),[l,c]=le.useState(""),[d,g]=le.useState(null),m=(x,S="info")=>{g({message:x,type:S}),setTimeout(()=>g(null),5e3)};le.useEffect(()=>{if(n)try{const x=`app_api_keys_${n}`,S=localStorage.getItem(x);if(S){const A=JSON.parse(S),I=atob(A.gemini||"").split(`
`).map(U=>U.trim()).filter(U=>U);c(I.join(`
`))}}catch(x){console.error("Failed to load API key",x)}},[n]);const _=le.useCallback(x=>{const S=/[\u3040-\u30ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff\uff66-\uff9f]/.test(x);let A=[];if(S)for(let I=0;I<x.length;I+=2e3)A.push(x.substring(I,I+2e3));else{const I=x.split(/\s+/),U=1400;for(let q=0;q<I.length;q+=U)A.push(I.slice(q,q+U).join(" "))}const D=A.map((I,U)=>({id:crypto.randomUUID(),content:I}));a(D)},[]),w=x=>{t(x)};return f.jsxs("div",{className:"flex h-screen w-full overflow-hidden bg-gray-50",children:[f.jsx("aside",{className:"w-[30%] min-w-[320px] max-w-[450px] flex-shrink-0 h-full",children:f.jsx(YP,{onStyleChange:w,onSplitScript:_,apiKey:l})}),f.jsx("main",{className:"flex-grow h-full overflow-y-auto p-8 lg:p-12 scroll-smooth",children:f.jsxs("div",{className:"max-w-4xl mx-auto",children:[f.jsxs("header",{className:"mb-12",children:[f.jsxs("h1",{className:"text-4xl font-extrabold text-gray-900 tracking-tight",children:["HOT ",f.jsx("span",{className:"text-indigo-600",children:"AI"})]}),f.jsx("p",{className:"mt-2 text-gray-500 font-medium",children:"H thng sn xut Visual Prompts chuyn nghip"})]}),f.jsx(wS,{children:f.jsxs("div",{className:"relative",children:[d&&f.jsx("div",{className:"fixed top-4 right-4 z-50 animate-in slide-in-from-right fade-in duration-300",children:f.jsxs("div",{className:`px-6 py-4 rounded-2xl shadow-2xl flex items-center gap-3 font-bold text-sm ${d.type==="error"?"bg-rose-50 text-rose-600 border border-rose-100":d.type==="success"?"bg-emerald-50 text-emerald-600 border border-emerald-100":"bg-white text-slate-700 border border-slate-100"}`,children:[d.type==="success"&&f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),d.type==="error"&&f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),d.message]})}),f.jsx(WP,{tags:i,style:e,apiKey:l,onNotify:m})]})})]})})]})};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JP=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),XP=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),Ox=n=>{const e=XP(n);return e.charAt(0).toUpperCase()+e.slice(1)},xS=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim(),ZP=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var eM={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tM=le.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:a="",children:l,iconNode:c,...d},g)=>le.createElement("svg",{ref:g,...eM,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:xS("lucide",a),...!l&&!ZP(d)&&{"aria-hidden":"true"},...d},[...c.map(([m,_])=>le.createElement(m,_)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nn=(n,e)=>{const t=le.forwardRef(({className:i,...a},l)=>le.createElement(tM,{ref:l,iconNode:e,className:xS(`lucide-${JP(Ox(n))}`,`lucide-${n}`,i),...a}));return t.displayName=Ox(n),t};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nM=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],sM=Nn("activity",nM);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iM=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],rM=Nn("camera",iM);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aM=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],TS=Nn("circle-check",aM);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oM=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],lM=Nn("clipboard-list",oM);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cM=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],ES=Nn("copy",cM);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uM=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],jx=Nn("image",uM);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hM=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],dM=Nn("layers",hM);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fM=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Aa=Nn("loader-circle",fM);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pM=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],SS=Nn("play",pM);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gM=[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]],AS=Nn("scissors",gM);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mM=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],NS=Nn("trash-2",mM);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yM=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Dx=Nn("upload",yM);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vM=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],_M=Nn("video",vM);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bM=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Px=Nn("zap",bM),Yg={},wM=n=>{let e=[];if(n&&(e=n.split(`
`).map(t=>t.trim()).filter(t=>t)),e.length===0){const t=Yg==null?void 0:Yg.VITE_GEMINI_API_KEY;t&&e.push(t)}return e},xM=["gemini-2.0-flash-lite-preview-02-05","gemini-2.5-flash","gemini-2.0-flash-lite-001","gemini-2.0-flash-exp","gemini-2.0-flash-001","gemini-2.0-flash","gemini-2.5-pro","gemini-flash-latest"],ml=async(n,e)=>{const t=wM(n);if(t.length===0)throw new Error("No API Keys provided.");let i;for(const a of t){const l=new Qd(a);for(const c of xM)try{const d=l.getGenerativeModel({model:c});return await e(d)}catch(d){console.warn(`Failed: Key(...${a.slice(-4)}) Model(${c}) error: ${d.message}`),i=d}}throw i||new Error("All keys and models failed to generate content.")},TM=async(n,e)=>ml(e,async t=>(await t.generateContent([{inlineData:{mimeType:"image/jpeg",data:n}},{text:"Analyze this image and describe its visual style in detail (lighting, color palette, texture, composition, atmosphere). Provide a concise but comprehensive paragraph suitable for an image generation prompt style reference."}])).response.text()||"No analysis found."),EM=async(n,e)=>ml(e,async t=>{const i={type:Gs.ARRAY,items:{type:Gs.OBJECT,properties:{name:{type:Gs.STRING},gender:{type:Gs.STRING},country:{type:Gs.STRING},age:{type:Gs.STRING},physique:{type:Gs.STRING},features:{type:Gs.STRING}},required:["name","gender","country","age","physique","features"]}},a=`Analyze the following script and extract/create characters. For each character, provide: Name, Gender, Country, Age, Physique, and Detailed Facial Features. 
        
        CRITICAL RULES:
        1. If details are missing in the script (Gender, Country, Age, Physique, or Face), you MUST creatively generate them to make the character visually distinct.
        2. Focus HEAVILY on specific facial features: eye shape/color, nose shape, skin texture, wrinkles, hair style/texture/color, and any unique facial markings.
        3. ABSOLUTELY NO clothing, NO personality traits, and NO equipment.
        4. Format the 'features' field as descriptive sentences about the face and hair only.
        
        Example structure: "Mi tc en bng mt vi nhng si bc thanh lch c bi cht thnh kiu tc truyn thng gn gng. Ln da mn mng. i mt nu sm hnh qu hnh m p, np nhn nh quanh khe mt, chic mi nh nhn, thanh t."
        
        Output in JSON format as an array of objects. Script: ${n}`,l=await t.generateContent({contents:[{role:"user",parts:[{text:a}]}],generationConfig:{responseMimeType:"application/json",responseSchema:i}});return JSON.parse(l.response.text()||"[]")}),SM=async(n,e)=>ml(e,async t=>{var c;const i=`Bn l chuyn gia phn tch kch bn. Hy m s lng "hnh ng th gic" (visual actions) chnh trong kch bn di y.
        
        QUY TC:
        1. Ch m cc hnh ng c th c th dng thnh hnh nh (v d: "chy", "cm bento", "nhn xa xm").
        2. B qua cc li dn truyn (narration) mang tnh suy tng v cc suy ngh ni tm khng th hin qua hnh ng/biu cm.
        3. Tr v DUY NHT mt con s.
        
        KCH BN:
        ${n}`,a=await t.generateContent(i),l=parseInt(((c=a.response.text())==null?void 0:c.trim())||"0");return isNaN(l)?0:l}),AM=async(n,e,t)=>ml(t,async i=>{const a=`Bn l mt cng c chia kch bn chuyn nghip. Hy chia kch bn di y thnh ng ${e} hng.
        
        CC QUY TC TI THNG:
        1. CH TR V CC HNG KCH BN. Khng c bt k cu dn nhp no.
        2. GI NGUYN 100% VN BN GC. Tuyt i khng xa b, khng chnh sa, khng thm bt bt k k t no.
        3. Tr v ng ${e} dng, mi dng l mt phn on logic.
        
        KCH BN:
        ${n}`;return((await i.generateContent(a)).response.text()||"").trim().split(`
`).filter(d=>d.trim().length>0)}),NM=async(n,e,t,i,a)=>ml(a,async l=>{const d=`Bn l ZenShot AI - Mt Visual Director k lut st . Nhim v ca bn l chuyn i kch bn thnh Image Prompts cho Midjourney.
    
    QUY TC CT LI (BT BUC TUN TH 100%):
    1. NH DNG: Mi prompt phi nm trn MT HNG DUY NHT (Single line). Khng xung dng bn trong mt prompt.
    2. KHNG TM TT: Copy-paste NGUYN VN m t nhn vt t d liu bn di.
    3. B NH TRNG THI:
       - Nu c thng tin cnh trc (Previous Context), hy k tha trang phc v bi cnh t  tr khi kch bn thay i.
       - Lun duy tr tnh nht qun v qun o v bi cnh cho cc phn on lin tip.
    4. CU TRC PROMPT (Vit lin thnh 1 on vn): 
       [Phong cch/Gc my] + [Hnh ng/Biu cm] + [Tn nhn vt: M t chi tit nguyn vn] + [Trang phc hin ti] + [Bi cnh chi tit] + --ar 16:9
    
    D LIU NHN VT:
    ${t.map(_=>`${_.name}: ${_.gender}, ${_.country}, ${_.age}, ${_.physique}. ${_.features}`).join(`
`)}
    
    PHONG CCH VISUAL:
    ${e}
    
    BI CNH/TRANG PHC CA CC TAG TRC (NU C):
    ${i||"Khng c cnh trc."}
    
    HY TO PROMPT CHO CC PHN ON SAU (Mi prompt 1 hng):
    ${n.map((_,w)=>`Row ${w+1}: ${_}`).join(`
`)}
    
    Ch tr v danh sch cc prompt. Mi prompt l 1 hng.`;return{prompts:((await l.generateContent(d)).response.text()||"").split(`
`).filter(_=>_.trim().length>0)}}),CM=async(n,e,t,i,a)=>ml(a,async l=>{const d=`Bn l o din hnh nh (Visual Director) chuyn v Video/Cinematic. Nhim v ca bn l phn tch ni dung on "Hook" v to Video Prompts (din t chuyn ng).
    
    YU CU CHI TIT:
    1. PHN TCH HNH NG: Mi hnh ng c th trong on Hook phi c mt prompt ring bit.
    2. NG B NHN VT: Copy-paste NGUYN VN m t nhn vt t d liu bn di khi nhn vt  xut hin trong hnh ng.
    3. CHUYN NG (MOTION): M t r loi chuyn ng (v d: "Slo-mo walking", "Cinematic drone shot following", "Close-up of facial expression change").
    4. BI CNH/TRANG PHC: K tha t thng tin bi cnh  cung cp.
    5. NH DNG: Mi prompt l 1 hng duy nht.
    
    CU TRC PROMPT:
    [Loi chuyn ng/Gc my] + [Hnh ng nhn vt] + [M t nhn vt chi tit] + [Trang phc & Bi cnh]
    
    D LIU NHN VT:
    ${t.map(m=>`${m.name}: ${m.gender}, ${m.country}, ${m.age}, ${m.physique}. ${m.features}`).join(`
`)}
    
    PHONG CCH VISUAL:
    ${e}
    
    BI CNH/TRANG PHC K THA:
    ${i||"T do sng to da trn khng kh chung."}
    
    NI DUNG ON HOOK CN X L:
    ${n}
    
    Ch tr v danh sch cc prompt video, mi prompt mt hng.`;return((await l.generateContent(d)).response.text()||"").split(`
`).filter(m=>m.trim().length>0)});class RM extends le.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("ErrorBoundary caught error:",e,t)}render(){var e;return this.state.hasError?f.jsxs("div",{className:"p-8 m-8 bg-slate-900 border border-slate-700 rounded-3xl space-y-4 text-center text-white",children:[f.jsx("h2",{className:"text-xl font-bold text-rose-500",children:" xy ra li hin th"}),f.jsx("p",{className:"text-slate-300",children:(e=this.state.error)==null?void 0:e.message}),f.jsx("button",{onClick:()=>this.setState({hasError:!1}),className:"px-6 py-3 bg-white text-slate-900 font-bold rounded-xl hover:bg-slate-200 transition-all",children:"Th li"}),f.jsx("p",{className:"text-xs text-slate-500",children:"D liu vn c lu trong b nh tm."})]}):this.props.children}}const IM=({userId:n})=>{const[e,t]=le.useState({visualStyle:"",script:"",characters:[],tags:[],hook:"",hookPrompts:[],isAnalyzing:!1,isProcessingScript:!1,isGeneratingHook:!1}),[i,a]=le.useState(!1),[l,c]=le.useState(!1),[d,g]=le.useState(""),[m,_]=le.useState(null),[w,x]=le.useState(null),S=(ce,ue="info")=>{x({message:ce,type:ue}),setTimeout(()=>x(null),5e3)};le.useEffect(()=>{if(n)try{const ce=`app_api_keys_${n}`,ue=localStorage.getItem(ce);if(ue){const B=JSON.parse(ue),ge=atob(B.gemini||"").split(`
`).map(be=>be.trim()).filter(be=>be);g(ge.join(`
`))}}catch(ce){console.error("Failed to load API key",ce)}},[n]);const A=le.useRef(e.tags);le.useEffect(()=>{A.current=e.tags},[e.tags]);const D=ce=>new Promise(ue=>setTimeout(ue,ce)),I=async ce=>{var se;const ue=(se=ce.target.files)==null?void 0:se[0];if(!ue)return;a(!0);const B=new FileReader;B.onload=async ge=>{var V;const be=(V=ge.target)==null?void 0:V.result;_(be);const Le=be.split(",")[1];try{const te=await TM(Le,d);t(de=>({...de,visualStyle:te}))}catch(te){S(`Li phn tch style: ${te.message||te}`,"error")}finally{a(!1)}},B.readAsDataURL(ue)},U=async()=>{if(e.script){t(ce=>({...ce,isProcessingScript:!0}));try{const ce=await EM(e.script,d);t(ue=>({...ue,characters:ce,isProcessingScript:!1}))}catch(ce){S(`Li x l kch bn: ${ce.message||ce}`,"error"),t(ue=>({...ue,isProcessingScript:!1}))}}},q=ce=>{const ue=/[\u3000-\u303f\u3040-\u309f\u30a0-\u30ff\uff00-\uff9f\u4e00-\u9faf\u3400-\u4dbf\uac00-\ud7af]/.test(ce),B=[];let se=ce;const ge=ue?1800:1200,be=ue?2e3:1500,Le=ue?[`
`,"","","",".","!","?"]:[`
`,".","!","?"];for(;se.length>0;)if(ue){if(se.length<=be){B.push(se);break}let V=se.slice(ge,be),te=-1;for(const de of Le){const pe=V.lastIndexOf(de);pe>te&&(te=pe)}if(te!==-1){const de=ge+te+1;B.push(se.slice(0,de)),se=se.slice(de)}else B.push(se.slice(0,be)),se=se.slice(be)}else{const V=se.split(/(\s+)/);let te=0,de=0,pe=-1,Se=!1;for(let X=0;X<V.length;X++){const he=V[X];/\S/.test(he)&&te++;const Ke=de;if(de+=he.length,te>=ge&&te<=be&&Le.some(qt=>he.includes(qt))&&(pe=de),te>be){const qt=pe!==-1?pe:Ke;B.push(se.slice(0,qt)),se=se.slice(qt),Se=!0;break}}if(!Se){B.push(se);break}}return B},z=()=>{if(!e.script)return;const ue=q(e.script).map((B,se)=>({id:`tag-${Date.now()}-${se}`,originalContent:B,rows:[B],imageCount:10,prompts:[],status:"idle"}));t(B=>({...B,tags:ue}))},O=(ce,ue)=>{t(B=>({...B,tags:B.tags.map(se=>se.id===ce?{...se,...ue}:se)}))},$=(ce,ue)=>{t(B=>({...B,characters:B.characters.map((se,ge)=>ge===ce?{...se,...ue}:se)}))},Q=async ce=>{const ue=A.current.find(B=>B.id===ce);if(!ue)return!1;O(ce,{status:"splitting"});try{const B=await AM(ue.originalContent,ue.imageCount,d);return O(ce,{rows:B,status:"ready"}),!0}catch(B){return console.error(`Error splitting rows for TAG: ${ce}`,B),S(`Li chia hng: ${B.message||B}`,"error"),O(ce,{status:"idle"}),!1}},R=async ce=>{const ue=A.current,B=ue.findIndex(be=>be.id===ce);if(B===-1)return!1;const se=ue[B];let ge="";if(B>0){const be=ue[B-1];be&&be.prompts.length>0&&(ge=`y l prompt cui ca Tag trc  bn k tha bi cnh v trang phc: ${be.prompts[be.prompts.length-1]}`)}O(ce,{status:"generating"});try{const be=await NM(se.rows,e.visualStyle,e.characters,ge,d);if(!be.prompts||be.prompts.length===0)throw new Error("Empty prompts generated");return O(ce,{prompts:be.prompts,status:"ready"}),!0}catch(be){return console.error(`Error generating prompts for TAG: ${ce}`,be),O(ce,{status:"ready"}),!1}},N=async()=>{if(!e.hook||e.characters.length===0){S("Vui lng nhp ni dung Hook v m bo  phn tch nhn vt.","info");return}t(B=>({...B,isGeneratingHook:!0}));let ce="";const ue=e.tags[e.tags.length-1];ue&&ue.prompts.length>0&&(ce=`K tha bi cnh t prompt ny: ${ue.prompts[ue.prompts.length-1]}`);try{const B=await CM(e.hook,e.visualStyle,e.characters,ce,d);t(se=>({...se,hookPrompts:B,isGeneratingHook:!1}))}catch(B){S(`Li to Prompt Video Hook: ${B.message||B}`,"error"),t(se=>({...se,isGeneratingHook:!1}))}},k=async ce=>{const ue=e.tags.find(B=>B.id===ce);if(ue){O(ce,{status:"analyzing"});try{const B=await SM(ue.originalContent,d);O(ce,{actionCount:B,status:"idle"})}catch(B){S(`Li phn tch hnh ng: ${B.message||B}`,"error"),O(ce,{status:"idle"})}}},M=async()=>{if(e.tags.length===0)return;c(!0);const ce=e.tags.map(ue=>ue.id);for(const ue of ce){if(!await Q(ue)&&!await Q(ue))break;await D(1e4);let se=await R(ue);if(se||(await D(1e4),se=await R(ue)),!se&&!confirm(`TAG ${ue} khng th to prompt sau 2 ln th. Bn c mun tip tc cc TAG sau khng?`))break;await D(1e4)}c(!1),S("Hon thnh quy trnh t ng cho tt c cc TAG!","success")},L=()=>{const ue=e.tags.flatMap(B=>(B.status==="ready"||B.status==="generating"?B.rows.join(`
`):B.originalContent).split(`
`).map(ge=>ge.trim()).filter(ge=>ge.length>0)).join(`
`);navigator.clipboard.writeText(ue),S(" copy ton b kch bn ca tt c cc TAG!","success")},F=()=>{const ce=e.tags.flatMap(ue=>ue.prompts).map(ue=>ue.trim()).filter(ue=>ue.length>0).join(`
`);navigator.clipboard.writeText(ce),S(" copy ton b Prompt ca tt c cc TAG!","success")},j=()=>{const ce=e.hookPrompts.join(`
`);navigator.clipboard.writeText(ce),S(" copy Prompt Video cho Hook!","success")};return f.jsx(RM,{children:f.jsxs("div",{className:"flex h-screen bg-slate-50 overflow-hidden text-slate-900 w-full relative",children:[w&&f.jsx("div",{className:"absolute top-4 right-4 z-50 animate-in slide-in-from-right fade-in duration-300",children:f.jsxs("div",{className:`px-6 py-4 rounded-2xl shadow-2xl flex items-center gap-3 font-bold text-sm ${w.type==="error"?"bg-rose-50 text-rose-600 border border-rose-100":w.type==="success"?"bg-emerald-50 text-emerald-600 border border-emerald-100":"bg-white text-slate-700 border border-slate-100"}`,children:[w.type==="success"&&f.jsx(TS,{className:"w-5 h-5"}),w.type==="error"&&f.jsx(NS,{className:"w-5 h-5"}),w.message]})}),f.jsxs("aside",{className:"w-[30%] bg-white border-r border-slate-200 overflow-y-auto p-6 space-y-8 flex flex-col shrink-0",children:[f.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[f.jsx("div",{className:"bg-indigo-600 p-2 rounded-lg",children:f.jsx(rM,{className:"text-white w-6 h-6"})}),f.jsx("h1",{className:"text-xl font-black text-slate-800 tracking-tight uppercase",children:"ZenShot AI"})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("label",{className:"flex items-center gap-2 text-xs font-bold text-slate-500 uppercase tracking-widest",children:[f.jsx(jx,{className:"w-3.5 h-3.5"})," Phong cch hnh nh"]}),f.jsxs("div",{className:`border-2 border-dashed border-slate-200 rounded-xl p-4 transition hover:border-indigo-400 bg-slate-50/50 relative group overflow-hidden ${m?"border-none p-0":""}`,children:[f.jsx("input",{type:"file",accept:"image/*",onChange:I,className:"hidden",id:"image-upload"}),f.jsx("label",{htmlFor:"image-upload",className:`cursor-pointer flex flex-col items-center justify-center gap-2 py-2 w-full h-full ${m?"p-0":""}`,children:i?f.jsxs("div",{className:"py-8 flex flex-col items-center",children:[f.jsx(Aa,{className:"animate-spin text-indigo-500 w-8 h-8"}),f.jsx("span",{className:"text-[10px] text-indigo-500 font-bold mt-2 uppercase tracking-wider",children:"ang phn tch..."})]}):m?f.jsxs("div",{className:"relative w-full h-48",children:[f.jsx("img",{src:m,alt:"Style Reference",className:"w-full h-full object-cover rounded-lg shadow-sm"}),f.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity rounded-lg",children:f.jsxs("div",{className:"flex items-center gap-2 text-white text-xs font-bold uppercase tracking-widest bg-black/50 px-3 py-2 rounded-full backdrop-blur-sm border border-white/20",children:[f.jsx(Dx,{className:"w-3 h-3"})," Thay i nh"]})})]}):f.jsxs(f.Fragment,{children:[f.jsx(Dx,{className:"text-slate-400 w-6 h-6"}),f.jsx("span",{className:"text-[10px] text-slate-400 font-bold uppercase tracking-tighter",children:"Phn tch phong cch qua nh"})]})})]}),f.jsx("textarea",{className:"w-full h-24 p-3 text-sm bg-white border border-slate-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none transition placeholder:italic",placeholder:"Phong cch chi tit s hin  y...",value:e.visualStyle,onChange:ce=>t(ue=>({...ue,visualStyle:ce.target.value}))})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsx("label",{className:"flex items-center gap-2 text-xs font-bold text-slate-500 uppercase tracking-widest",children:"Nhp kch bn chnh"}),f.jsx("textarea",{className:"w-full h-40 p-3 text-sm border border-slate-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none transition leading-relaxed",placeholder:"Dn kch bn ca bn vo y...",value:e.script,onChange:ce=>t(ue=>({...ue,script:ce.target.value}))}),f.jsxs("button",{onClick:U,disabled:e.isProcessingScript||!e.script,className:"w-full flex items-center justify-center gap-2 bg-indigo-600 hover:bg-indigo-700 disabled:bg-slate-300 text-white font-bold py-3.5 px-4 rounded-xl transition shadow-lg shadow-indigo-100 uppercase text-xs tracking-widest",children:[e.isProcessingScript?f.jsx(Aa,{className:"animate-spin w-4 h-4"}):f.jsx(SS,{className:"w-4 h-4 fill-current"}),"Bt u phn tch kch bn"]})]}),e.characters.length>0&&f.jsxs("div",{className:"space-y-4 pt-4 border-t border-slate-100",children:[f.jsx("label",{className:"flex items-center gap-2 text-xs font-bold text-slate-500 uppercase tracking-widest",children:"Thng tin nhn vt (C th chnh sa)"}),f.jsx("div",{className:"space-y-4 max-h-[500px] overflow-y-auto pr-1",children:e.characters.map((ce,ue)=>f.jsxs("div",{className:"p-4 bg-white rounded-xl border border-slate-200 shadow-sm relative overflow-hidden transition hover:border-indigo-300 group",children:[f.jsx("div",{className:"absolute top-0 left-0 w-1 h-full bg-indigo-500"}),f.jsxs("div",{className:"flex flex-col gap-2",children:[f.jsx("input",{className:"font-black text-slate-800 text-[11px] uppercase bg-transparent border-none p-0 focus:ring-0",value:ce.name,onChange:B=>$(ue,{name:B.target.value})}),f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsx("input",{className:"text-[10px] bg-slate-50 border border-slate-100 rounded px-2 py-1 focus:ring-1 focus:ring-indigo-400",value:ce.gender,placeholder:"Gender",onChange:B=>$(ue,{gender:B.target.value})}),f.jsx("input",{className:"text-[10px] bg-slate-50 border border-slate-100 rounded px-2 py-1 focus:ring-1 focus:ring-indigo-400",value:ce.age,placeholder:"Age",onChange:B=>$(ue,{age:B.target.value})})]}),f.jsx("textarea",{className:"text-[10px] text-slate-700 leading-relaxed font-medium bg-slate-50 border border-slate-100 rounded p-2 focus:ring-1 focus:ring-indigo-400 resize-none h-20",value:ce.features,onChange:B=>$(ue,{features:B.target.value})})]})]},ue))})]}),f.jsx("div",{className:"mt-auto pt-6",children:f.jsxs("button",{onClick:z,disabled:!e.script,className:"w-full flex items-center justify-center gap-2 bg-slate-800 hover:bg-slate-900 text-white font-bold py-3.5 px-4 rounded-xl transition uppercase text-xs tracking-widest",children:[f.jsx(AS,{className:"w-4 h-4"}),"Chia kch bn sang TAG"]})})]}),f.jsxs("main",{className:"flex-1 overflow-y-auto bg-slate-50 scroll-smooth flex flex-col",children:[e.tags.length>0&&f.jsxs("div",{className:"sticky top-0 z-10 bg-white/80 backdrop-blur-md border-b border-slate-200 px-8 py-4 flex items-center justify-between shadow-sm",children:[f.jsx("div",{className:"flex items-center gap-3",children:f.jsxs("button",{onClick:M,disabled:l,className:"flex items-center gap-2 bg-indigo-600 hover:bg-indigo-700 disabled:bg-indigo-300 text-white px-5 py-2.5 rounded-xl font-black text-[11px] uppercase tracking-widest shadow-lg shadow-indigo-100 transition-all active:scale-95",children:[l?f.jsx(Aa,{className:"animate-spin w-4 h-4"}):f.jsx(Px,{className:"w-4 h-4 fill-amber-400 text-amber-400"}),"T ng Hon Ton"]})}),f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsxs("button",{onClick:L,className:"flex items-center gap-2 bg-slate-800 hover:bg-slate-900 text-white px-5 py-2.5 rounded-xl font-black text-[11px] uppercase tracking-widest transition-all active:scale-95",children:[f.jsx(lM,{className:"w-4 h-4"}),"Copy All Kch Bn"]}),f.jsxs("button",{onClick:F,className:"flex items-center gap-2 bg-slate-800 hover:bg-slate-900 text-white px-5 py-2.5 rounded-xl font-black text-[11px] uppercase tracking-widest transition-all active:scale-95",children:[f.jsx(dM,{className:"w-4 h-4"}),"Copy All Prompt nh"]})]})]}),f.jsx("div",{className:"max-w-4xl mx-auto space-y-8 p-8 w-full",children:e.tags.length===0?f.jsxs("div",{className:"h-[70vh] flex flex-col items-center justify-center text-slate-300 space-y-6",children:[f.jsx("div",{className:"w-24 h-24 bg-white rounded-full flex items-center justify-center shadow-sm border border-slate-100",children:f.jsx(jx,{className:"w-10 h-10 opacity-40"})}),f.jsxs("div",{className:"text-center",children:[f.jsx("p",{className:"text-xl font-bold text-slate-400",children:"ZenShot Visual Director"}),f.jsx("p",{className:"text-sm text-slate-400 mt-1 uppercase tracking-widest font-bold opacity-60",children:"Split script and start generating prompts"})]})]}):f.jsxs(f.Fragment,{children:[e.tags.map((ce,ue)=>f.jsx(kM,{tag:ce,index:ue,onSplit:()=>Q(ce.id),onAnalyze:()=>k(ce.id),onGenerate:()=>R(ce.id),onUpdateCount:B=>O(ce.id,{imageCount:B}),onCopy:()=>{const B=ce.prompts.map(se=>se.trim()).join(`
`);navigator.clipboard.writeText(B),S("Copied prompts for this TAG!","success")},onUpdateContent:B=>O(ce.id,{originalContent:B}),onDelete:()=>t(B=>({...B,tags:B.tags.filter(se=>se.id!==ce.id)}))},ce.id)),f.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden transition hover:shadow-lg mt-12 mb-20 p-8 space-y-6",children:[f.jsxs("div",{className:"flex items-center justify-between border-b border-slate-50 pb-4",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("span",{className:"bg-amber-500 text-white text-[10px] font-black px-3 py-1 rounded-full uppercase tracking-widest",children:"VIDEO HOOK"}),f.jsx("h2",{className:"text-sm font-black text-slate-800 uppercase tracking-widest",children:"Phn tch chuyn ng"})]}),f.jsx(_M,{className:"w-5 h-5 text-slate-300"})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Ni dung on Hook"}),f.jsx("textarea",{className:"w-full h-40 p-4 text-sm bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:outline-none resize-none leading-relaxed transition font-medium",placeholder:"Nhp ni dung on Hook kch bn ti y...",value:e.hook,onChange:ce=>t(ue=>({...ue,hook:ce.target.value}))})]}),e.hookPrompts.length>0&&f.jsxs("div",{className:"space-y-4 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Prompts Video Chuyn ng"}),f.jsxs("button",{onClick:j,className:"flex items-center gap-1.5 text-amber-600 hover:text-amber-700 text-[10px] font-black px-4 py-2 bg-amber-50 rounded-xl transition uppercase tracking-widest shadow-sm shadow-amber-50",children:[f.jsx(ES,{className:"w-3.5 h-3.5"})," Copy Hook Prompts"]})]}),f.jsx("div",{className:"space-y-4",children:e.hookPrompts.map((ce,ue)=>f.jsxs("div",{className:"p-4 bg-slate-900 rounded-xl border border-slate-800 relative group transition hover:border-amber-500 shadow-lg",children:[f.jsx("div",{className:"absolute -left-3 top-4 w-7 h-7 bg-amber-500 text-white flex items-center justify-center text-[10px] font-black rounded-full border-2 border-slate-50 shadow-md",children:ue+1}),f.jsx("p",{className:"text-slate-300 text-[11px] font-mono break-words leading-relaxed pl-4",children:ce})]},ue))})]}),f.jsxs("button",{onClick:N,disabled:e.isGeneratingHook||!e.hook,className:"w-full flex items-center justify-center gap-2 bg-slate-800 hover:bg-slate-900 disabled:bg-slate-300 text-white font-black py-4.5 rounded-2xl transition shadow-xl shadow-slate-200 uppercase text-xs tracking-[0.2em]",children:[e.isGeneratingHook?f.jsx(Aa,{className:"animate-spin w-5 h-5"}):f.jsx(Px,{className:"w-5 h-5 fill-amber-400 text-amber-400"}),"To Prompt Video"]})]})]})})]})]})})},kM=({tag:n,index:e,onSplit:t,onAnalyze:i,onGenerate:a,onUpdateCount:l,onCopy:c,onUpdateContent:d,onDelete:g})=>f.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden transition hover:shadow-lg",children:[f.jsxs("div",{className:"px-6 py-4 bg-slate-50/80 border-b border-slate-100 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsxs("span",{className:"bg-slate-800 text-white text-[10px] font-black px-3 py-1 rounded-full uppercase tracking-widest",children:["TAG ",e+1]}),f.jsxs("span",{className:"text-[10px] text-slate-400 font-black uppercase tracking-widest",children:[n.originalContent.length," k t"]})]}),f.jsx("button",{onClick:g,className:"text-slate-300 hover:text-red-500 transition p-1",children:f.jsx(NS,{className:"w-4 h-4"})})]}),f.jsxs("div",{className:"p-6 space-y-6",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Kch bn phn on"}),f.jsxs("div",{className:"relative group",children:[f.jsx("textarea",{className:"w-full h-40 p-4 text-sm bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:outline-none resize-none leading-relaxed transition font-medium",value:n.status==="ready"||n.status==="generating"?n.rows.join(`
`):n.originalContent,readOnly:n.status==="ready"||n.status==="generating",onChange:m=>d(m.target.value)}),(n.status==="ready"||n.status==="generating")&&n.rows.length>1&&f.jsxs("div",{className:"absolute top-2 right-2 flex items-center gap-1.5 bg-white text-emerald-600 px-3 py-1.5 rounded-lg text-[10px] font-black border border-emerald-100 shadow-sm uppercase",children:[f.jsx(TS,{className:"w-3 h-3"})," Chia hng xong"]})]})]}),f.jsxs("div",{className:"flex flex-wrap gap-6 items-end border-y border-slate-50 py-4",children:[f.jsxs("div",{className:"flex-1 space-y-2",children:[f.jsxs("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest flex items-center gap-2",children:[f.jsx(sM,{className:"w-3 h-3"})," Phn tch hnh ng"]}),f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("button",{onClick:i,disabled:n.status==="analyzing",className:"flex items-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-800 text-[10px] font-black rounded-lg transition uppercase tracking-widest",children:n.status==="analyzing"?f.jsx(Aa,{className:"animate-spin w-3 h-3"}):"Phn tch"}),n.actionCount!==void 0&&f.jsxs("div",{className:"flex items-center gap-1.5 text-indigo-600 font-black text-sm",children:[f.jsx("span",{className:"text-[10px] text-slate-400 font-bold",children:"S hnh ng:"})," ",n.actionCount]})]})]}),f.jsxs("div",{className:"w-40 space-y-2",children:[f.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"S lng nh"}),f.jsxs("div",{className:"relative flex items-center",children:[f.jsx("button",{onClick:()=>l(Math.max(1,n.imageCount-1)),className:"absolute left-1 w-7 h-7 flex items-center justify-center bg-slate-100 hover:bg-slate-200 text-slate-600 rounded-lg font-bold",children:"-"}),f.jsx("input",{type:"number",min:"1",max:"100",className:"w-full h-10 px-8 text-center border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:outline-none font-bold text-slate-700",value:n.imageCount,onChange:m=>l(parseInt(m.target.value)||1)}),f.jsx("button",{onClick:()=>l(n.imageCount+1),className:"absolute right-1 w-7 h-7 flex items-center justify-center bg-slate-100 hover:bg-slate-200 text-slate-600 rounded-lg font-bold",children:"+"})]})]}),f.jsxs("button",{onClick:t,disabled:n.status==="splitting",className:"h-10 px-6 flex items-center justify-center gap-2 bg-slate-800 hover:bg-slate-900 text-white font-bold rounded-xl transition uppercase text-[10px] tracking-widest shadow-sm",children:[n.status==="splitting"?f.jsx(Aa,{className:"animate-spin w-3 h-3"}):f.jsx(AS,{className:"w-3 h-3"}),"Chia hng"]})]}),n.prompts.length>0&&f.jsxs("div",{className:"space-y-4 pt-6",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Prompts Midjourney"}),f.jsxs("button",{onClick:c,className:"flex items-center gap-1.5 text-indigo-600 hover:text-indigo-700 text-[10px] font-black px-4 py-2 bg-indigo-50 rounded-xl transition uppercase tracking-widest shadow-sm shadow-indigo-50",children:[f.jsx(ES,{className:"w-3.5 h-3.5"})," Sao chp Tag ny"]})]}),f.jsx("div",{className:"space-y-4 max-h-[600px] overflow-y-auto pr-2 custom-scrollbar",children:n.prompts.map((m,_)=>f.jsxs("div",{className:"p-4 bg-slate-900 rounded-xl border border-slate-800 relative group transition hover:border-indigo-500 shadow-lg",children:[f.jsx("div",{className:"absolute -left-3 top-4 w-7 h-7 bg-indigo-600 text-white flex items-center justify-center text-[10px] font-black rounded-full border-2 border-slate-50 shadow-md",children:_+1}),f.jsx("p",{className:"text-slate-300 text-[11px] font-mono break-words leading-relaxed pl-4",children:m})]},_))})]}),f.jsxs("button",{onClick:a,disabled:n.status==="generating",className:"w-full flex items-center justify-center gap-2 bg-indigo-600 hover:bg-indigo-700 disabled:bg-indigo-300 text-white font-black py-4.5 rounded-2xl transition shadow-xl shadow-indigo-200 uppercase text-xs tracking-[0.2em]",children:[n.status==="generating"?f.jsx(Aa,{className:"animate-spin w-5 h-5"}):f.jsx(SS,{className:"w-5 h-5 fill-current"}),"To Prompt nh"]})]})]});function xf(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(n);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(n,i[a])&&(t[i[a]]=n[i[a]]);return t}function OM(n,e,t,i){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function d(_){try{m(i.next(_))}catch(w){c(w)}}function g(_){try{m(i.throw(_))}catch(w){c(w)}}function m(_){_.done?l(_.value):a(_.value).then(d,g)}m((i=i.apply(n,e||[])).next())})}const jM=n=>n?(...e)=>n(...e):(...e)=>fetch(...e);class G0 extends Error{constructor(e,t="FunctionsError",i){super(e),this.name=t,this.context=i}}class DM extends G0{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Mx extends G0{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Lx extends G0{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Mm;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(Mm||(Mm={}));class PM{constructor(e,{headers:t={},customFetch:i,region:a=Mm.Any}={}){this.url=e,this.headers=t,this.region=a,this.fetch=jM(i)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return OM(this,arguments,void 0,function*(t,i={}){var a;let l,c;try{const{headers:d,method:g,body:m,signal:_,timeout:w}=i;let x={},{region:S}=i;S||(S=this.region);const A=new URL(`${this.url}/${t}`);S&&S!=="any"&&(x["x-region"]=S,A.searchParams.set("forceFunctionRegion",S));let D;m&&(d&&!Object.prototype.hasOwnProperty.call(d,"Content-Type")||!d)?typeof Blob<"u"&&m instanceof Blob||m instanceof ArrayBuffer?(x["Content-Type"]="application/octet-stream",D=m):typeof m=="string"?(x["Content-Type"]="text/plain",D=m):typeof FormData<"u"&&m instanceof FormData?D=m:(x["Content-Type"]="application/json",D=JSON.stringify(m)):m&&typeof m!="string"&&!(typeof Blob<"u"&&m instanceof Blob)&&!(m instanceof ArrayBuffer)&&!(typeof FormData<"u"&&m instanceof FormData)?D=JSON.stringify(m):D=m;let I=_;w&&(c=new AbortController,l=setTimeout(()=>c.abort(),w),_?(I=c.signal,_.addEventListener("abort",()=>c.abort())):I=c.signal);const U=yield this.fetch(A.toString(),{method:g||"POST",headers:Object.assign(Object.assign(Object.assign({},x),this.headers),d),body:D,signal:I}).catch($=>{throw new DM($)}),q=U.headers.get("x-relay-error");if(q&&q==="true")throw new Mx(U);if(!U.ok)throw new Lx(U);let z=((a=U.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),O;return z==="application/json"?O=yield U.json():z==="application/octet-stream"||z==="application/pdf"?O=yield U.blob():z==="text/event-stream"?O=U:z==="multipart/form-data"?O=yield U.formData():O=yield U.text(),{data:O,error:null,response:U}}catch(d){return{data:null,error:d,response:d instanceof Lx||d instanceof Mx?d.context:void 0}}finally{l&&clearTimeout(l)}})}}var MM=class extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}},LM=class{constructor(n){var e,t;this.shouldThrowOnError=!1,this.method=n.method,this.url=n.url,this.headers=new Headers(n.headers),this.schema=n.schema,this.body=n.body,this.shouldThrowOnError=(e=n.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=n.signal,this.isMaybeSingle=(t=n.isMaybeSingle)!==null&&t!==void 0?t:!1,n.fetch?this.fetch=n.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(n,e){return this.headers=new Headers(this.headers),this.headers.set(n,e),this}then(n,e){var t=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const i=this.fetch;let a=i(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async l=>{let c=null,d=null,g=null,m=l.status,_=l.statusText;if(l.ok){var w,x;if(t.method!=="HEAD"){var S;const U=await l.text();U===""||(t.headers.get("Accept")==="text/csv"||t.headers.get("Accept")&&(!((S=t.headers.get("Accept"))===null||S===void 0)&&S.includes("application/vnd.pgrst.plan+text"))?d=U:d=JSON.parse(U))}const D=(w=t.headers.get("Prefer"))===null||w===void 0?void 0:w.match(/count=(exact|planned|estimated)/),I=(x=l.headers.get("content-range"))===null||x===void 0?void 0:x.split("/");D&&I&&I.length>1&&(g=parseInt(I[1])),t.isMaybeSingle&&t.method==="GET"&&Array.isArray(d)&&(d.length>1?(c={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,g=null,m=406,_="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{var A;const D=await l.text();try{c=JSON.parse(D),Array.isArray(c)&&l.status===404&&(d=[],c=null,m=200,_="OK")}catch{l.status===404&&D===""?(m=204,_="No Content"):c={message:D}}if(c&&t.isMaybeSingle&&(!(c==null||(A=c.details)===null||A===void 0)&&A.includes("0 rows"))&&(c=null,m=200,_="OK"),c&&t.shouldThrowOnError)throw new MM(c)}return{error:c,data:d,count:g,status:m,statusText:_}});return this.shouldThrowOnError||(a=a.catch(l=>{var c;let d="";const g=l==null?void 0:l.cause;if(g){var m,_,w,x;const A=(m=g==null?void 0:g.message)!==null&&m!==void 0?m:"",D=(_=g==null?void 0:g.code)!==null&&_!==void 0?_:"";d=`${(w=l==null?void 0:l.name)!==null&&w!==void 0?w:"FetchError"}: ${l==null?void 0:l.message}`,d+=`

Caused by: ${(x=g==null?void 0:g.name)!==null&&x!==void 0?x:"Error"}: ${A}`,D&&(d+=` (${D})`),g!=null&&g.stack&&(d+=`
${g.stack}`)}else{var S;d=(S=l==null?void 0:l.stack)!==null&&S!==void 0?S:""}return{error:{message:`${(c=l==null?void 0:l.name)!==null&&c!==void 0?c:"FetchError"}: ${l==null?void 0:l.message}`,details:d,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),a.then(n,e)}returns(){return this}overrideTypes(){return this}},UM=class extends LM{select(n){let e=!1;const t=(n??"*").split("").map(i=>/\s/.test(i)&&!e?"":(i==='"'&&(e=!e),i)).join("");return this.url.searchParams.set("select",t),this.headers.append("Prefer","return=representation"),this}order(n,{ascending:e=!0,nullsFirst:t,foreignTable:i,referencedTable:a=i}={}){const l=a?`${a}.order`:"order",c=this.url.searchParams.get(l);return this.url.searchParams.set(l,`${c?`${c},`:""}${n}.${e?"asc":"desc"}${t===void 0?"":t?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:e,referencedTable:t=e}={}){const i=typeof t>"u"?"limit":`${t}.limit`;return this.url.searchParams.set(i,`${n}`),this}range(n,e,{foreignTable:t,referencedTable:i=t}={}){const a=typeof i>"u"?"offset":`${i}.offset`,l=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(a,`${n}`),this.url.searchParams.set(l,`${e-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:n=!1,verbose:e=!1,settings:t=!1,buffers:i=!1,wal:a=!1,format:l="text"}={}){var c;const d=[n?"analyze":null,e?"verbose":null,t?"settings":null,i?"buffers":null,a?"wal":null].filter(Boolean).join("|"),g=(c=this.headers.get("Accept"))!==null&&c!==void 0?c:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${l}; for="${g}"; options=${d};`),l==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(n){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${n}`),this}};const Ux=new RegExp("[,()]");var $o=class extends UM{eq(n,e){return this.url.searchParams.append(n,`eq.${e}`),this}neq(n,e){return this.url.searchParams.append(n,`neq.${e}`),this}gt(n,e){return this.url.searchParams.append(n,`gt.${e}`),this}gte(n,e){return this.url.searchParams.append(n,`gte.${e}`),this}lt(n,e){return this.url.searchParams.append(n,`lt.${e}`),this}lte(n,e){return this.url.searchParams.append(n,`lte.${e}`),this}like(n,e){return this.url.searchParams.append(n,`like.${e}`),this}likeAllOf(n,e){return this.url.searchParams.append(n,`like(all).{${e.join(",")}}`),this}likeAnyOf(n,e){return this.url.searchParams.append(n,`like(any).{${e.join(",")}}`),this}ilike(n,e){return this.url.searchParams.append(n,`ilike.${e}`),this}ilikeAllOf(n,e){return this.url.searchParams.append(n,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(n,e){return this.url.searchParams.append(n,`ilike(any).{${e.join(",")}}`),this}regexMatch(n,e){return this.url.searchParams.append(n,`match.${e}`),this}regexIMatch(n,e){return this.url.searchParams.append(n,`imatch.${e}`),this}is(n,e){return this.url.searchParams.append(n,`is.${e}`),this}isDistinct(n,e){return this.url.searchParams.append(n,`isdistinct.${e}`),this}in(n,e){const t=Array.from(new Set(e)).map(i=>typeof i=="string"&&Ux.test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(n,`in.(${t})`),this}notIn(n,e){const t=Array.from(new Set(e)).map(i=>typeof i=="string"&&Ux.test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(n,`not.in.(${t})`),this}contains(n,e){return typeof e=="string"?this.url.searchParams.append(n,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(n,`cs.{${e.join(",")}}`):this.url.searchParams.append(n,`cs.${JSON.stringify(e)}`),this}containedBy(n,e){return typeof e=="string"?this.url.searchParams.append(n,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(n,`cd.{${e.join(",")}}`):this.url.searchParams.append(n,`cd.${JSON.stringify(e)}`),this}rangeGt(n,e){return this.url.searchParams.append(n,`sr.${e}`),this}rangeGte(n,e){return this.url.searchParams.append(n,`nxl.${e}`),this}rangeLt(n,e){return this.url.searchParams.append(n,`sl.${e}`),this}rangeLte(n,e){return this.url.searchParams.append(n,`nxr.${e}`),this}rangeAdjacent(n,e){return this.url.searchParams.append(n,`adj.${e}`),this}overlaps(n,e){return typeof e=="string"?this.url.searchParams.append(n,`ov.${e}`):this.url.searchParams.append(n,`ov.{${e.join(",")}}`),this}textSearch(n,e,{config:t,type:i}={}){let a="";i==="plain"?a="pl":i==="phrase"?a="ph":i==="websearch"&&(a="w");const l=t===void 0?"":`(${t})`;return this.url.searchParams.append(n,`${a}fts${l}.${e}`),this}match(n){return Object.entries(n).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(n,e,t){return this.url.searchParams.append(n,`not.${e}.${t}`),this}or(n,{foreignTable:e,referencedTable:t=e}={}){const i=t?`${t}.or`:"or";return this.url.searchParams.append(i,`(${n})`),this}filter(n,e,t){return this.url.searchParams.append(n,`${e}.${t}`),this}},VM=class{constructor(n,{headers:e={},schema:t,fetch:i}){this.url=n,this.headers=new Headers(e),this.schema=t,this.fetch=i}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(n,e){const{head:t=!1,count:i}=e??{},a=t?"HEAD":"GET";let l=!1;const c=(n??"*").split("").map(m=>/\s/.test(m)&&!l?"":(m==='"'&&(l=!l),m)).join(""),{url:d,headers:g}=this.cloneRequestState();return d.searchParams.set("select",c),i&&g.append("Prefer",`count=${i}`),new $o({method:a,url:d,headers:g,schema:this.schema,fetch:this.fetch})}insert(n,{count:e,defaultToNull:t=!0}={}){var i;const a="POST",{url:l,headers:c}=this.cloneRequestState();if(e&&c.append("Prefer",`count=${e}`),t||c.append("Prefer","missing=default"),Array.isArray(n)){const d=n.reduce((g,m)=>g.concat(Object.keys(m)),[]);if(d.length>0){const g=[...new Set(d)].map(m=>`"${m}"`);l.searchParams.set("columns",g.join(","))}}return new $o({method:a,url:l,headers:c,schema:this.schema,body:n,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}upsert(n,{onConflict:e,ignoreDuplicates:t=!1,count:i,defaultToNull:a=!0}={}){var l;const c="POST",{url:d,headers:g}=this.cloneRequestState();if(g.append("Prefer",`resolution=${t?"ignore":"merge"}-duplicates`),e!==void 0&&d.searchParams.set("on_conflict",e),i&&g.append("Prefer",`count=${i}`),a||g.append("Prefer","missing=default"),Array.isArray(n)){const m=n.reduce((_,w)=>_.concat(Object.keys(w)),[]);if(m.length>0){const _=[...new Set(m)].map(w=>`"${w}"`);d.searchParams.set("columns",_.join(","))}}return new $o({method:c,url:d,headers:g,schema:this.schema,body:n,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}update(n,{count:e}={}){var t;const i="PATCH",{url:a,headers:l}=this.cloneRequestState();return e&&l.append("Prefer",`count=${e}`),new $o({method:i,url:a,headers:l,schema:this.schema,body:n,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}delete({count:n}={}){var e;const t="DELETE",{url:i,headers:a}=this.cloneRequestState();return n&&a.append("Prefer",`count=${n}`),new $o({method:t,url:i,headers:a,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}},BM=class CS{constructor(e,{headers:t={},schema:i,fetch:a}={}){this.url=e,this.headers=new Headers(t),this.schemaName=i,this.fetch=a}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new VM(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new CS(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:i=!1,get:a=!1,count:l}={}){var c;let d;const g=new URL(`${this.url}/rpc/${e}`);let m;const _=S=>S!==null&&typeof S=="object"&&(!Array.isArray(S)||S.some(_)),w=i&&Object.values(t).some(_);w?(d="POST",m=t):i||a?(d=i?"HEAD":"GET",Object.entries(t).filter(([S,A])=>A!==void 0).map(([S,A])=>[S,Array.isArray(A)?`{${A.join(",")}}`:`${A}`]).forEach(([S,A])=>{g.searchParams.append(S,A)})):(d="POST",m=t);const x=new Headers(this.headers);return w?x.set("Prefer",l?`count=${l},return=minimal`:"return=minimal"):l&&x.set("Prefer",`count=${l}`),new $o({method:d,url:g,headers:x,schema:this.schemaName,body:m,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}};class zM{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const t=globalThis.process;if(t){const i=t.versions;if(i&&i.node){const a=i.node,l=parseInt(a.replace(/^v/,"").split(".")[0]);return l>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${l} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${l} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const i=this.getWebSocketConstructor();return new i(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const HM="2.93.2",qM=`realtime-js/${HM}`,$M="1.0.0",RS="2.0.0",Vx=RS,Lm=1e4,FM=1e3,GM=100;var gr;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(gr||(gr={}));var zt;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(zt||(zt={}));var ms;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(ms||(ms={}));var Um;(function(n){n.websocket="websocket"})(Um||(Um={}));var wa;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(wa||(wa={}));class KM{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,t){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return t(this._binaryEncodeUserBroadcastPush(e));let i=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(i))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer((t=e.payload)===null||t===void 0?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,i;const a=(i=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&i!==void 0?i:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,a)}_encodeJsonUserBroadcastPush(e){var t,i;const a=(i=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&i!==void 0?i:{},c=new TextEncoder().encode(JSON.stringify(a)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,c)}_encodeUserBroadcastPush(e,t,i){var a,l;const c=e.topic,d=(a=e.ref)!==null&&a!==void 0?a:"",g=(l=e.join_ref)!==null&&l!==void 0?l:"",m=e.payload.event,_=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},w=Object.keys(_).length===0?"":JSON.stringify(_);if(g.length>255)throw new Error(`joinRef length ${g.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`ref length ${d.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`topic length ${c.length} exceeds maximum of 255`);if(m.length>255)throw new Error(`userEvent length ${m.length} exceeds maximum of 255`);if(w.length>255)throw new Error(`metadata length ${w.length} exceeds maximum of 255`);const x=this.USER_BROADCAST_PUSH_META_LENGTH+g.length+d.length+c.length+m.length+w.length,S=new ArrayBuffer(this.HEADER_LENGTH+x);let A=new DataView(S),D=0;A.setUint8(D++,this.KINDS.userBroadcastPush),A.setUint8(D++,g.length),A.setUint8(D++,d.length),A.setUint8(D++,c.length),A.setUint8(D++,m.length),A.setUint8(D++,w.length),A.setUint8(D++,t),Array.from(g,U=>A.setUint8(D++,U.charCodeAt(0))),Array.from(d,U=>A.setUint8(D++,U.charCodeAt(0))),Array.from(c,U=>A.setUint8(D++,U.charCodeAt(0))),Array.from(m,U=>A.setUint8(D++,U.charCodeAt(0))),Array.from(w,U=>A.setUint8(D++,U.charCodeAt(0)));var I=new Uint8Array(S.byteLength+i.byteLength);return I.set(new Uint8Array(S),0),I.set(new Uint8Array(i),S.byteLength),I.buffer}decode(e,t){if(this._isArrayBuffer(e)){let i=this._binaryDecode(e);return t(i)}if(typeof e=="string"){const i=JSON.parse(e),[a,l,c,d,g]=i;return t({join_ref:a,ref:l,topic:c,event:d,payload:g})}return t({})}_binaryDecode(e){const t=new DataView(e),i=t.getUint8(0),a=new TextDecoder;switch(i){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,t,a)}}_decodeUserBroadcast(e,t,i){const a=t.getUint8(1),l=t.getUint8(2),c=t.getUint8(3),d=t.getUint8(4);let g=this.HEADER_LENGTH+4;const m=i.decode(e.slice(g,g+a));g=g+a;const _=i.decode(e.slice(g,g+l));g=g+l;const w=i.decode(e.slice(g,g+c));g=g+c;const x=e.slice(g,e.byteLength),S=d===this.JSON_ENCODING?JSON.parse(i.decode(x)):x,A={type:this.BROADCAST_EVENT,event:_,payload:S};return c>0&&(A.meta=JSON.parse(w)),{join_ref:null,ref:null,topic:m,event:this.BROADCAST_EVENT,payload:A}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||((t=e==null?void 0:e.constructor)===null||t===void 0?void 0:t.name)==="ArrayBuffer"}_pick(e,t){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([i])=>t.includes(i)))}}class IS{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ot;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(ot||(ot={}));const Bx=(n,e,t={})=>{var i;const a=(i=t.skipTypes)!==null&&i!==void 0?i:[];return e?Object.keys(e).reduce((l,c)=>(l[c]=YM(c,n,e,a),l),{}):{}},YM=(n,e,t,i)=>{const a=e.find(d=>d.name===n),l=a==null?void 0:a.type,c=t[n];return l&&!i.includes(l)?kS(l,c):Vm(c)},kS=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return XM(e,t)}switch(n){case ot.bool:return WM(e);case ot.float4:case ot.float8:case ot.int2:case ot.int4:case ot.int8:case ot.numeric:case ot.oid:return QM(e);case ot.json:case ot.jsonb:return JM(e);case ot.timestamp:return ZM(e);case ot.abstime:case ot.date:case ot.daterange:case ot.int4range:case ot.int8range:case ot.money:case ot.reltime:case ot.text:case ot.time:case ot.timestamptz:case ot.timetz:case ot.tsrange:case ot.tstzrange:return Vm(e);default:return Vm(e)}},Vm=n=>n,WM=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},QM=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},JM=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch{return n}return n},XM=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,i=n[t];if(n[0]==="{"&&i==="}"){let l;const c=n.slice(1,t);try{l=JSON.parse("["+c+"]")}catch{l=c?c.split(","):[]}return l.map(d=>kS(e,d))}return n},ZM=n=>typeof n=="string"?n.replace(" ","T"):n,OS=n=>{const e=new URL(n);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Wg{constructor(e,t,i={},a=Lm){this.channel=e,this.event=t,this.payload=i,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var i;return this._hasReceived(e)&&t((i=this.receivedResp)===null||i===void 0?void 0:i.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(i=>i.status===e).forEach(i=>i.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var zx;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(zx||(zx={}));class Hc{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const i=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},a=>{const{onJoin:l,onLeave:c,onSync:d}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Hc.syncState(this.state,a,l,c),this.pendingDiffs.forEach(g=>{this.state=Hc.syncDiff(this.state,g,l,c)}),this.pendingDiffs=[],d()}),this.channel._on(i.diff,{},a=>{const{onJoin:l,onLeave:c,onSync:d}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=Hc.syncDiff(this.state,a,l,c),d())}),this.onJoin((a,l,c)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:l,newPresences:c})}),this.onLeave((a,l,c)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:l,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,i,a){const l=this.cloneDeep(e),c=this.transformState(t),d={},g={};return this.map(l,(m,_)=>{c[m]||(g[m]=_)}),this.map(c,(m,_)=>{const w=l[m];if(w){const x=_.map(I=>I.presence_ref),S=w.map(I=>I.presence_ref),A=_.filter(I=>S.indexOf(I.presence_ref)<0),D=w.filter(I=>x.indexOf(I.presence_ref)<0);A.length>0&&(d[m]=A),D.length>0&&(g[m]=D)}else d[m]=_}),this.syncDiff(l,{joins:d,leaves:g},i,a)}static syncDiff(e,t,i,a){const{joins:l,leaves:c}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return i||(i=()=>{}),a||(a=()=>{}),this.map(l,(d,g)=>{var m;const _=(m=e[d])!==null&&m!==void 0?m:[];if(e[d]=this.cloneDeep(g),_.length>0){const w=e[d].map(S=>S.presence_ref),x=_.filter(S=>w.indexOf(S.presence_ref)<0);e[d].unshift(...x)}i(d,_,g)}),this.map(c,(d,g)=>{let m=e[d];if(!m)return;const _=g.map(w=>w.presence_ref);m=m.filter(w=>_.indexOf(w.presence_ref)<0),e[d]=m,a(d,m,g),m.length===0&&delete e[d]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(i=>t(i,e[i]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,i)=>{const a=e[i];return"metas"in a?t[i]=a.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):t[i]=a,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Hx;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(Hx||(Hx={}));var qc;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(qc||(qc={}));var wi;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(wi||(wi={}));class Ko{constructor(e,t={config:{}},i){var a,l;if(this.topic=e,this.params=t,this.socket=i,this.bindings={},this.state=zt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Wg(this,ms.join,this.params,this.timeout),this.rejoinTimer=new IS(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=zt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(c=>c.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=zt.closed,this.socket._remove(this)}),this._onError(c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=zt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=zt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=zt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ms.reply,{},(c,d)=>{this._trigger(this._replyEventName(d),c)}),this.presence=new Hc(this),this.broadcastEndpointURL=OS(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((l=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var i,a,l;if(this.socket.isConnected()||this.socket.connect(),this.state==zt.closed){const{config:{broadcast:c,presence:d,private:g}}=this.params,m=(a=(i=this.bindings.postgres_changes)===null||i===void 0?void 0:i.map(S=>S.filter))!==null&&a!==void 0?a:[],_=!!this.bindings[qc.PRESENCE]&&this.bindings[qc.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,w={},x={broadcast:c,presence:Object.assign(Object.assign({},d),{enabled:_}),postgres_changes:m,private:g};this.socket.accessTokenValue&&(w.access_token=this.socket.accessTokenValue),this._onError(S=>e==null?void 0:e(wi.CHANNEL_ERROR,S)),this._onClose(()=>e==null?void 0:e(wi.CLOSED)),this.updateJoinPayload(Object.assign({config:x},w)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:S})=>{var A;if(this.socket._isManualToken()||this.socket.setAuth(),S===void 0){e==null||e(wi.SUBSCRIBED);return}else{const D=this.bindings.postgres_changes,I=(A=D==null?void 0:D.length)!==null&&A!==void 0?A:0,U=[];for(let q=0;q<I;q++){const z=D[q],{filter:{event:O,schema:$,table:Q,filter:R}}=z,N=S&&S[q];if(N&&N.event===O&&Ko.isFilterValueEqual(N.schema,$)&&Ko.isFilterValueEqual(N.table,Q)&&Ko.isFilterValueEqual(N.filter,R))U.push(Object.assign(Object.assign({},z),{id:N.id}));else{this.unsubscribe(),this.state=zt.errored,e==null||e(wi.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=U,e&&e(wi.SUBSCRIBED);return}}).receive("error",S=>{this.state=zt.errored,e==null||e(wi.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(S).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(wi.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,i){return this.state===zt.joined&&e===qc.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,t,i)}async httpSend(e,t,i={}){var a;if(t==null)return Promise.reject("Payload is required for httpSend()");const l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const c={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(a=i.timeout)!==null&&a!==void 0?a:this.timeout);if(d.status===202)return{success:!0};let g=d.statusText;try{const m=await d.json();g=m.error||m.message||g}catch{}return Promise.reject(new Error(g))}async send(e,t={}){var i,a;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:l,payload:c}=e,d={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(d.Authorization=`Bearer ${this.socket.accessTokenValue}`);const g={method:"POST",headers:d,body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:c,private:this.private}]})};try{const m=await this._fetchWithTimeout(this.broadcastEndpointURL,g,(i=t.timeout)!==null&&i!==void 0?i:this.timeout);return await((a=m.body)===null||a===void 0?void 0:a.cancel()),m.ok?"ok":"error"}catch(m){return m.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var c,d,g;const m=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((g=(d=(c=this.params)===null||c===void 0?void 0:c.config)===null||d===void 0?void 0:d.broadcast)===null||g===void 0)&&g.ack)&&l("ok"),m.receive("ok",()=>l("ok")),m.receive("error",()=>l("error")),m.receive("timeout",()=>l("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=zt.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ms.close,"leave",this._joinRef())};this.joinPush.destroy();let i=null;return new Promise(a=>{i=new Wg(this,ms.leave,{},e),i.receive("ok",()=>{t(),a("ok")}).receive("timeout",()=>{t(),a("timed out")}).receive("error",()=>{a("error")}),i.send(),this._canPush()||i.trigger("ok",{})}).finally(()=>{i==null||i.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=zt.closed,this.bindings={}}async _fetchWithTimeout(e,t,i){const a=new AbortController,l=setTimeout(()=>a.abort(),i),c=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:a.signal}));return clearTimeout(l),c}_push(e,t,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Wg(this,e,t,i);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>GM){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,i){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,i){var a,l;const c=e.toLocaleLowerCase(),{close:d,error:g,leave:m,join:_}=ms;if(i&&[d,g,m,_].indexOf(c)>=0&&i!==this._joinRef())return;let x=this._onMessage(c,t,i);if(t&&!x)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(S=>{var A,D,I;return((A=S.filter)===null||A===void 0?void 0:A.event)==="*"||((I=(D=S.filter)===null||D===void 0?void 0:D.event)===null||I===void 0?void 0:I.toLocaleLowerCase())===c}).map(S=>S.callback(x,i)):(l=this.bindings[c])===null||l===void 0||l.filter(S=>{var A,D,I,U,q,z;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in S){const O=S.id,$=(A=S.filter)===null||A===void 0?void 0:A.event;return O&&((D=t.ids)===null||D===void 0?void 0:D.includes(O))&&($==="*"||($==null?void 0:$.toLocaleLowerCase())===((I=t.data)===null||I===void 0?void 0:I.type.toLocaleLowerCase()))}else{const O=(q=(U=S==null?void 0:S.filter)===null||U===void 0?void 0:U.event)===null||q===void 0?void 0:q.toLocaleLowerCase();return O==="*"||O===((z=t==null?void 0:t.event)===null||z===void 0?void 0:z.toLocaleLowerCase())}else return S.type.toLocaleLowerCase()===c}).map(S=>{if(typeof x=="object"&&"ids"in x){const A=x.data,{schema:D,table:I,commit_timestamp:U,type:q,errors:z}=A;x=Object.assign(Object.assign({},{schema:D,table:I,commit_timestamp:U,eventType:q,new:{},old:{},errors:z}),this._getPayloadRecords(A))}S.callback(x,i)})}_isClosed(){return this.state===zt.closed}_isJoined(){return this.state===zt.joined}_isJoining(){return this.state===zt.joining}_isLeaving(){return this.state===zt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,i){const a=e.toLocaleLowerCase(),l={type:a,filter:t,callback:i};return this.bindings[a]?this.bindings[a].push(l):this.bindings[a]=[l],this}_off(e,t){const i=e.toLocaleLowerCase();return this.bindings[i]&&(this.bindings[i]=this.bindings[i].filter(a=>{var l;return!(((l=a.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===i&&Ko.isEqual(a.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(e[i]!==t[i])return!1;return!0}static isFilterValueEqual(e,t){return(e??void 0)===(t??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(ms.close,{},e)}_onError(e){this._on(ms.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=zt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Bx(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Bx(e.columns,e.old_record)),t}}const Qg=()=>{},ad={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},e6=[1e3,2e3,5e3,1e4],t6=1e4,n6=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class s6{constructor(e,t){var i;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Lm,this.transport=null,this.heartbeatIntervalMs=ad.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Qg,this.ref=0,this.reconnectTimer=null,this.vsn=Vx,this.logger=Qg,this.conn=null,this.sendBuffer=[],this.serializer=new KM,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=a=>a?(...l)=>a(...l):(...l)=>fetch(...l),!(!((i=t==null?void 0:t.params)===null||i===void 0)&&i.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${Um.websocket}`,this.httpEndpoint=OS(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=zM.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const i=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(i),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,t??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,i){this.logger(e,t,i)}connectionState(){switch(this.conn&&this.conn.readyState){case gr.connecting:return wa.Connecting;case gr.open:return wa.Open;case gr.closing:return wa.Closing;default:return wa.Closed}}isConnected(){return this.connectionState()===wa.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const i=`realtime:${e}`,a=this.getChannels().find(l=>l.topic===i);if(a)return a;{const l=new Ko(`realtime:${e}`,t,this);return this.channels.push(l),l}}push(e){const{topic:t,event:i,payload:a,ref:l}=e,c=()=>{this.encode(e,d=>{var g;(g=this.conn)===null||g===void 0||g.send(d)})};this.log("push",`${t} ${i} (${l})`,a),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(FM,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},ad.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(i=>i.topic===e&&(i._isJoined()||i._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply"&&t.ref&&t.ref===this.pendingHeartbeatRef){const m=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error",m)}catch(_){this.log("error","error in heartbeat callback",_)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:i,event:a,payload:l,ref:c}=t,d=c?`(${c})`:"",g=l.status||"";this.log("receive",`${g} ${i} ${a} ${d}`.trim(),l),this.channels.filter(m=>m._isMember(i)).forEach(m=>m._trigger(a,l,c)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===gr.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===gr.open||this.conn.readyState===gr.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(t=>{this.log("error","error waiting for auth on connect",t),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this._terminateWorker()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e);try{this.heartbeatCallback("error")}catch(t){this.log("error","error in heartbeat callback",t)}}_triggerChanError(){this.channels.forEach(e=>e._trigger(ms.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const i=e.match(/\?/)?"&":"?",a=new URLSearchParams(t);return`${e}${i}${a}`}_workerObjectUrl(e){let t;if(e)t=e;else{const i=new Blob([n6],{type:"application/javascript"});t=URL.createObjectURL(i)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t,i=!1;if(e)t=e,i=!0;else if(this.accessToken)try{t=await this.accessToken()}catch(a){this.log("error","Error fetching access token from callback",a),t=this.accessTokenValue}else t=this.accessTokenValue;i?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(a=>{const l={access_token:t,version:qM};t&&a.updateJoinPayload(l),a.joinedOnce&&a._isJoined()&&a._push(ms.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(t=>{this.log("error",`Error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(i=>{try{i(t)}catch(a){this.log("error",`error in ${e} callback`,a)}})}catch(i){this.log("error",`error triggering ${e} callbacks`,i)}}_setupReconnectionTimer(){this.reconnectTimer=new IS(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},ad.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,i,a,l,c,d,g,m,_,w,x,S;switch(this.transport=(t=e==null?void 0:e.transport)!==null&&t!==void 0?t:null,this.timeout=(i=e==null?void 0:e.timeout)!==null&&i!==void 0?i:Lm,this.heartbeatIntervalMs=(a=e==null?void 0:e.heartbeatIntervalMs)!==null&&a!==void 0?a:ad.HEARTBEAT_INTERVAL,this.worker=(l=e==null?void 0:e.worker)!==null&&l!==void 0?l:!1,this.accessToken=(c=e==null?void 0:e.accessToken)!==null&&c!==void 0?c:null,this.heartbeatCallback=(d=e==null?void 0:e.heartbeatCallback)!==null&&d!==void 0?d:Qg,this.vsn=(g=e==null?void 0:e.vsn)!==null&&g!==void 0?g:Vx,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(m=e==null?void 0:e.reconnectAfterMs)!==null&&m!==void 0?m:(A=>e6[A-1]||t6),this.vsn){case $M:this.encode=(_=e==null?void 0:e.encode)!==null&&_!==void 0?_:((A,D)=>D(JSON.stringify(A))),this.decode=(w=e==null?void 0:e.decode)!==null&&w!==void 0?w:((A,D)=>D(JSON.parse(A)));break;case RS:this.encode=(x=e==null?void 0:e.encode)!==null&&x!==void 0?x:this.serializer.encode.bind(this.serializer),this.decode=(S=e==null?void 0:e.decode)!==null&&S!==void 0?S:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}var tu=class extends Error{constructor(n,e){var t;super(n),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&((t=e.icebergType)==null?void 0:t.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function i6(n,e,t){const i=new URL(e,n);if(t)for(const[a,l]of Object.entries(t))l!==void 0&&i.searchParams.set(a,l);return i.toString()}async function r6(n){return!n||n.type==="none"?{}:n.type==="bearer"?{Authorization:`Bearer ${n.token}`}:n.type==="header"?{[n.name]:n.value}:n.type==="custom"?await n.getHeaders():{}}function a6(n){const e=n.fetchImpl??globalThis.fetch;return{async request({method:t,path:i,query:a,body:l,headers:c}){const d=i6(n.baseUrl,i,a),g=await r6(n.auth),m=await e(d,{method:t,headers:{...l?{"Content-Type":"application/json"}:{},...g,...c},body:l?JSON.stringify(l):void 0}),_=await m.text(),w=(m.headers.get("content-type")||"").includes("application/json"),x=w&&_?JSON.parse(_):_;if(!m.ok){const S=w?x:void 0,A=S==null?void 0:S.error;throw new tu((A==null?void 0:A.message)??`Request failed with status ${m.status}`,{status:m.status,icebergType:A==null?void 0:A.type,icebergCode:A==null?void 0:A.code,details:S})}return{status:m.status,headers:m.headers,data:x}}}}function od(n){return n.join("")}var o6=class{constructor(n,e=""){this.client=n,this.prefix=e}async listNamespaces(n){const e=n?{parent:od(n.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(i=>({namespace:i}))}async createNamespace(n,e){const t={namespace:n.namespace,properties:e==null?void 0:e.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:t})).data}async dropNamespace(n){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${od(n.namespace)}`})}async loadNamespaceMetadata(n){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${od(n.namespace)}`})).data.properties}}async namespaceExists(n){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${od(n.namespace)}`}),!0}catch(e){if(e instanceof tu&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(n,e){try{return await this.createNamespace(n,e)}catch(t){if(t instanceof tu&&t.status===409)return;throw t}}};function jo(n){return n.join("")}var l6=class{constructor(n,e="",t){this.client=n,this.prefix=e,this.accessDelegation=t}async listTables(n){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${jo(n.namespace)}/tables`})).data.identifiers}async createTable(n,e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${jo(n.namespace)}/tables`,body:e,headers:t})).data.metadata}async updateTable(n,e){const t=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${jo(n.namespace)}/tables/${n.name}`,body:e});return{"metadata-location":t.data["metadata-location"],metadata:t.data.metadata}}async dropTable(n,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${jo(n.namespace)}/tables/${n.name}`,query:{purgeRequested:String((e==null?void 0:e.purge)??!1)}})}async loadTable(n){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${jo(n.namespace)}/tables/${n.name}`,headers:e})).data.metadata}async tableExists(n){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${jo(n.namespace)}/tables/${n.name}`,headers:e}),!0}catch(t){if(t instanceof tu&&t.status===404)return!1;throw t}}async createTableIfNotExists(n,e){try{return await this.createTable(n,e)}catch(t){if(t instanceof tu&&t.status===409)return await this.loadTable({namespace:n.namespace,name:e.name});throw t}}},c6=class{constructor(n){var i;let e="v1";n.catalogName&&(e+=`/${n.catalogName}`);const t=n.baseUrl.endsWith("/")?n.baseUrl:`${n.baseUrl}/`;this.client=a6({baseUrl:t,auth:n.auth,fetchImpl:n.fetch}),this.accessDelegation=(i=n.accessDelegation)==null?void 0:i.join(","),this.namespaceOps=new o6(this.client,e),this.tableOps=new l6(this.client,e,this.accessDelegation)}async listNamespaces(n){return this.namespaceOps.listNamespaces(n)}async createNamespace(n,e){return this.namespaceOps.createNamespace(n,e)}async dropNamespace(n){await this.namespaceOps.dropNamespace(n)}async loadNamespaceMetadata(n){return this.namespaceOps.loadNamespaceMetadata(n)}async listTables(n){return this.tableOps.listTables(n)}async createTable(n,e){return this.tableOps.createTable(n,e)}async updateTable(n,e){return this.tableOps.updateTable(n,e)}async dropTable(n,e){await this.tableOps.dropTable(n,e)}async loadTable(n){return this.tableOps.loadTable(n)}async namespaceExists(n){return this.namespaceOps.namespaceExists(n)}async tableExists(n){return this.tableOps.tableExists(n)}async createNamespaceIfNotExists(n,e){return this.namespaceOps.createNamespaceIfNotExists(n,e)}async createTableIfNotExists(n,e){return this.tableOps.createTableIfNotExists(n,e)}},Tf=class extends Error{constructor(n,e="storage",t,i){super(n),this.__isStorageError=!0,this.namespace=e,this.name=e==="vectors"?"StorageVectorsError":"StorageError",this.status=t,this.statusCode=i}};function Ef(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}var ld=class extends Tf{constructor(n,e,t,i="storage"){super(n,i,e,t),this.name=i==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=e,this.statusCode=t}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},jS=class extends Tf{constructor(n,e,t="storage"){super(n,t),this.name=t==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=e}};const u6=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),h6=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},Bm=n=>{if(Array.isArray(n))return n.map(t=>Bm(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,i])=>{const a=t.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));e[a]=Bm(i)}),e},d6=n=>!n||typeof n!="string"||n.length===0||n.length>100||n.trim()!==n||n.includes("/")||n.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(n);function nu(n){"@babel/helpers - typeof";return nu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nu(n)}function f6(n,e){if(nu(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(nu(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function p6(n){var e=f6(n,"string");return nu(e)=="symbol"?e:e+""}function g6(n,e,t){return(e=p6(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function qx(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,i)}return t}function Ce(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?qx(Object(t),!0).forEach(function(i){g6(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):qx(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}const $x=n=>{var e;return n.msg||n.message||n.error_description||(typeof n.error=="string"?n.error:(e=n.error)===null||e===void 0?void 0:e.message)||JSON.stringify(n)},m6=async(n,e,t,i)=>{if(n&&typeof n=="object"&&"status"in n&&"ok"in n&&typeof n.status=="number"&&!(t!=null&&t.noResolveJson)){const a=n,l=a.status||500;if(typeof a.json=="function")a.json().then(c=>{const d=(c==null?void 0:c.statusCode)||(c==null?void 0:c.code)||l+"";e(new ld($x(c),l,d,i))}).catch(()=>{if(i==="vectors"){const c=l+"";e(new ld(a.statusText||`HTTP ${l} error`,l,c,i))}else{const c=l+"";e(new ld(a.statusText||`HTTP ${l} error`,l,c,i))}});else{const c=l+"";e(new ld(a.statusText||`HTTP ${l} error`,l,c,i))}}else e(new jS($x(n),n,i))},y6=(n,e,t,i)=>{const a={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"||n==="HEAD"||!i?Ce(Ce({},a),t):(h6(i)?(a.headers=Ce({"Content-Type":"application/json"},e==null?void 0:e.headers),a.body=JSON.stringify(i)):a.body=i,e!=null&&e.duplex&&(a.duplex=e.duplex),Ce(Ce({},a),t))};async function Sc(n,e,t,i,a,l,c){return new Promise((d,g)=>{n(t,y6(e,i,a,l)).then(m=>{if(!m.ok)throw m;if(i!=null&&i.noResolveJson)return m;if(c==="vectors"){const _=m.headers.get("content-type");if(!_||!_.includes("application/json"))return{}}return m.json()}).then(m=>d(m)).catch(m=>m6(m,g,i,c))})}function v6(n="storage"){return{get:async(e,t,i,a)=>Sc(e,"GET",t,i,a,void 0,n),post:async(e,t,i,a,l)=>Sc(e,"POST",t,a,l,i,n),put:async(e,t,i,a,l)=>Sc(e,"PUT",t,a,l,i,n),head:async(e,t,i,a)=>Sc(e,"HEAD",t,Ce(Ce({},i),{},{noResolveJson:!0}),a,void 0,n),remove:async(e,t,i,a,l)=>Sc(e,"DELETE",t,a,l,i,n)}}const _6=v6("storage"),{get:su,post:pt,put:zm,head:b6,remove:K0}=_6;var yl=class{constructor(n,e={},t,i="storage"){this.shouldThrowOnError=!1,this.url=n,this.headers=e,this.fetch=u6(t),this.namespace=i}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(n){var e=this;try{return{data:await n(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ef(t))return{data:null,error:t};throw t}}},w6=class{constructor(n,e){this.downloadFn=n,this.shouldThrowOnError=e}then(n,e){return this.execute().then(n,e)}async execute(){var n=this;try{return{data:(await n.downloadFn()).body,error:null}}catch(e){if(n.shouldThrowOnError)throw e;if(Ef(e))return{data:null,error:e};throw e}}};let DS;DS=Symbol.toStringTag;var x6=class{constructor(n,e){this.downloadFn=n,this.shouldThrowOnError=e,this[DS]="BlobDownloadBuilder",this.promise=null}asStream(){return new w6(this.downloadFn,this.shouldThrowOnError)}then(n,e){return this.getPromise().then(n,e)}catch(n){return this.getPromise().catch(n)}finally(n){return this.getPromise().finally(n)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var n=this;try{return{data:await(await n.downloadFn()).blob(),error:null}}catch(e){if(n.shouldThrowOnError)throw e;if(Ef(e))return{data:null,error:e};throw e}}};const T6={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Fx={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var E6=class extends yl{constructor(n,e={},t,i){super(n,e,i,"storage"),this.bucketId=t}async uploadOrUpdate(n,e,t,i){var a=this;return a.handleOperation(async()=>{let l;const c=Ce(Ce({},Fx),i);let d=Ce(Ce({},a.headers),n==="POST"&&{"x-upsert":String(c.upsert)});const g=c.metadata;typeof Blob<"u"&&t instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),g&&l.append("metadata",a.encodeMetadata(g)),l.append("",t)):typeof FormData<"u"&&t instanceof FormData?(l=t,l.has("cacheControl")||l.append("cacheControl",c.cacheControl),g&&!l.has("metadata")&&l.append("metadata",a.encodeMetadata(g))):(l=t,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType,g&&(d["x-metadata"]=a.toBase64(a.encodeMetadata(g))),(typeof ReadableStream<"u"&&l instanceof ReadableStream||l&&typeof l=="object"&&"pipe"in l&&typeof l.pipe=="function")&&!c.duplex&&(c.duplex="half")),i!=null&&i.headers&&(d=Ce(Ce({},d),i.headers));const m=a._removeEmptyFolders(e),_=a._getFinalPath(m),w=await(n=="PUT"?zm:pt)(a.fetch,`${a.url}/object/${_}`,l,Ce({headers:d},c!=null&&c.duplex?{duplex:c.duplex}:{}));return{path:m,id:w.Id,fullPath:w.Key}})}async upload(n,e,t){return this.uploadOrUpdate("POST",n,e,t)}async uploadToSignedUrl(n,e,t,i){var a=this;const l=a._removeEmptyFolders(n),c=a._getFinalPath(l),d=new URL(a.url+`/object/upload/sign/${c}`);return d.searchParams.set("token",e),a.handleOperation(async()=>{let g;const m=Ce({upsert:Fx.upsert},i),_=Ce(Ce({},a.headers),{"x-upsert":String(m.upsert)});return typeof Blob<"u"&&t instanceof Blob?(g=new FormData,g.append("cacheControl",m.cacheControl),g.append("",t)):typeof FormData<"u"&&t instanceof FormData?(g=t,g.append("cacheControl",m.cacheControl)):(g=t,_["cache-control"]=`max-age=${m.cacheControl}`,_["content-type"]=m.contentType),{path:l,fullPath:(await zm(a.fetch,d.toString(),g,{headers:_})).Key}})}async createSignedUploadUrl(n,e){var t=this;return t.handleOperation(async()=>{let i=t._getFinalPath(n);const a=Ce({},t.headers);e!=null&&e.upsert&&(a["x-upsert"]="true");const l=await pt(t.fetch,`${t.url}/object/upload/sign/${i}`,{},{headers:a}),c=new URL(t.url+l.url),d=c.searchParams.get("token");if(!d)throw new Tf("No token returned by API");return{signedUrl:c.toString(),path:n,token:d}})}async update(n,e,t){return this.uploadOrUpdate("PUT",n,e,t)}async move(n,e,t){var i=this;return i.handleOperation(async()=>await pt(i.fetch,`${i.url}/object/move`,{bucketId:i.bucketId,sourceKey:n,destinationKey:e,destinationBucket:t==null?void 0:t.destinationBucket},{headers:i.headers}))}async copy(n,e,t){var i=this;return i.handleOperation(async()=>({path:(await pt(i.fetch,`${i.url}/object/copy`,{bucketId:i.bucketId,sourceKey:n,destinationKey:e,destinationBucket:t==null?void 0:t.destinationBucket},{headers:i.headers})).Key}))}async createSignedUrl(n,e,t){var i=this;return i.handleOperation(async()=>{let a=i._getFinalPath(n),l=await pt(i.fetch,`${i.url}/object/sign/${a}`,Ce({expiresIn:e},t!=null&&t.transform?{transform:t.transform}:{}),{headers:i.headers});const c=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return{signedUrl:encodeURI(`${i.url}${l.signedURL}${c}`)}})}async createSignedUrls(n,e,t){var i=this;return i.handleOperation(async()=>{const a=await pt(i.fetch,`${i.url}/object/sign/${i.bucketId}`,{expiresIn:e,paths:n},{headers:i.headers}),l=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return a.map(c=>Ce(Ce({},c),{},{signedUrl:c.signedURL?encodeURI(`${i.url}${c.signedURL}${l}`):null}))})}download(n,e){const t=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),a=i?`?${i}`:"",l=this._getFinalPath(n),c=()=>su(this.fetch,`${this.url}/${t}/${l}${a}`,{headers:this.headers,noResolveJson:!0});return new x6(c,this.shouldThrowOnError)}async info(n){var e=this;const t=e._getFinalPath(n);return e.handleOperation(async()=>Bm(await su(e.fetch,`${e.url}/object/info/${t}`,{headers:e.headers})))}async exists(n){var e=this;const t=e._getFinalPath(n);try{return await b6(e.fetch,`${e.url}/object/${t}`,{headers:e.headers}),{data:!0,error:null}}catch(i){if(e.shouldThrowOnError)throw i;if(Ef(i)&&i instanceof jS){const a=i.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:i}}throw i}}getPublicUrl(n,e){const t=this._getFinalPath(n),i=[],a=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";a!==""&&i.push(a);const l=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});c!==""&&i.push(c);let d=i.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${t}${d}`)}}}async remove(n){var e=this;return e.handleOperation(async()=>await K0(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:n},{headers:e.headers}))}async list(n,e,t){var i=this;return i.handleOperation(async()=>{const a=Ce(Ce(Ce({},T6),e),{},{prefix:n||""});return await pt(i.fetch,`${i.url}/object/list/${i.bucketId}`,a,{headers:i.headers},t)})}async listV2(n,e){var t=this;return t.handleOperation(async()=>{const i=Ce({},n);return await pt(t.fetch,`${t.url}/object/list-v2/${t.bucketId}`,i,{headers:t.headers},e)})}encodeMetadata(n){return JSON.stringify(n)}toBase64(n){return typeof Buffer<"u"?Buffer.from(n).toString("base64"):btoa(n)}_getFinalPath(n){return`${this.bucketId}/${n.replace(/^\/+/,"")}`}_removeEmptyFolders(n){return n.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(n){const e=[];return n.width&&e.push(`width=${n.width}`),n.height&&e.push(`height=${n.height}`),n.resize&&e.push(`resize=${n.resize}`),n.format&&e.push(`format=${n.format}`),n.quality&&e.push(`quality=${n.quality}`),e.join("&")}};const S6="2.93.2",xu={"X-Client-Info":`storage-js/${S6}`};var A6=class extends yl{constructor(n,e={},t,i){const a=new URL(n);i!=null&&i.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase."));const l=a.href.replace(/\/$/,""),c=Ce(Ce({},xu),e);super(l,c,t,"storage")}async listBuckets(n){var e=this;return e.handleOperation(async()=>{const t=e.listBucketOptionsToQueryString(n);return await su(e.fetch,`${e.url}/bucket${t}`,{headers:e.headers})})}async getBucket(n){var e=this;return e.handleOperation(async()=>await su(e.fetch,`${e.url}/bucket/${n}`,{headers:e.headers}))}async createBucket(n,e={public:!1}){var t=this;return t.handleOperation(async()=>await pt(t.fetch,`${t.url}/bucket`,{id:n,name:n,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}))}async updateBucket(n,e){var t=this;return t.handleOperation(async()=>await zm(t.fetch,`${t.url}/bucket/${n}`,{id:n,name:n,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}))}async emptyBucket(n){var e=this;return e.handleOperation(async()=>await pt(e.fetch,`${e.url}/bucket/${n}/empty`,{},{headers:e.headers}))}async deleteBucket(n){var e=this;return e.handleOperation(async()=>await K0(e.fetch,`${e.url}/bucket/${n}`,{},{headers:e.headers}))}listBucketOptionsToQueryString(n){const e={};return n&&("limit"in n&&(e.limit=String(n.limit)),"offset"in n&&(e.offset=String(n.offset)),n.search&&(e.search=n.search),n.sortColumn&&(e.sortColumn=n.sortColumn),n.sortOrder&&(e.sortOrder=n.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},N6=class extends yl{constructor(n,e={},t){const i=n.replace(/\/$/,""),a=Ce(Ce({},xu),e);super(i,a,t,"storage")}async createBucket(n){var e=this;return e.handleOperation(async()=>await pt(e.fetch,`${e.url}/bucket`,{name:n},{headers:e.headers}))}async listBuckets(n){var e=this;return e.handleOperation(async()=>{const t=new URLSearchParams;(n==null?void 0:n.limit)!==void 0&&t.set("limit",n.limit.toString()),(n==null?void 0:n.offset)!==void 0&&t.set("offset",n.offset.toString()),n!=null&&n.sortColumn&&t.set("sortColumn",n.sortColumn),n!=null&&n.sortOrder&&t.set("sortOrder",n.sortOrder),n!=null&&n.search&&t.set("search",n.search);const i=t.toString(),a=i?`${e.url}/bucket?${i}`:`${e.url}/bucket`;return await su(e.fetch,a,{headers:e.headers})})}async deleteBucket(n){var e=this;return e.handleOperation(async()=>await K0(e.fetch,`${e.url}/bucket/${n}`,{},{headers:e.headers}))}from(n){var e=this;if(!d6(n))throw new Tf("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const t=new c6({baseUrl:this.url,catalogName:n,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),i=this.shouldThrowOnError;return new Proxy(t,{get(a,l){const c=a[l];return typeof c!="function"?c:async(...d)=>{try{return{data:await c.apply(a,d),error:null}}catch(g){if(i)throw g;return{data:null,error:g}}}}})}},C6=class extends yl{constructor(n,e={},t){const i=n.replace(/\/$/,""),a=Ce(Ce({},xu),{},{"Content-Type":"application/json"},e);super(i,a,t,"vectors")}async createIndex(n){var e=this;return e.handleOperation(async()=>await pt(e.fetch,`${e.url}/CreateIndex`,n,{headers:e.headers})||{})}async getIndex(n,e){var t=this;return t.handleOperation(async()=>await pt(t.fetch,`${t.url}/GetIndex`,{vectorBucketName:n,indexName:e},{headers:t.headers}))}async listIndexes(n){var e=this;return e.handleOperation(async()=>await pt(e.fetch,`${e.url}/ListIndexes`,n,{headers:e.headers}))}async deleteIndex(n,e){var t=this;return t.handleOperation(async()=>await pt(t.fetch,`${t.url}/DeleteIndex`,{vectorBucketName:n,indexName:e},{headers:t.headers})||{})}},R6=class extends yl{constructor(n,e={},t){const i=n.replace(/\/$/,""),a=Ce(Ce({},xu),{},{"Content-Type":"application/json"},e);super(i,a,t,"vectors")}async putVectors(n){var e=this;if(n.vectors.length<1||n.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return e.handleOperation(async()=>await pt(e.fetch,`${e.url}/PutVectors`,n,{headers:e.headers})||{})}async getVectors(n){var e=this;return e.handleOperation(async()=>await pt(e.fetch,`${e.url}/GetVectors`,n,{headers:e.headers}))}async listVectors(n){var e=this;if(n.segmentCount!==void 0){if(n.segmentCount<1||n.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(n.segmentIndex!==void 0&&(n.segmentIndex<0||n.segmentIndex>=n.segmentCount))throw new Error(`segmentIndex must be between 0 and ${n.segmentCount-1}`)}return e.handleOperation(async()=>await pt(e.fetch,`${e.url}/ListVectors`,n,{headers:e.headers}))}async queryVectors(n){var e=this;return e.handleOperation(async()=>await pt(e.fetch,`${e.url}/QueryVectors`,n,{headers:e.headers}))}async deleteVectors(n){var e=this;if(n.keys.length<1||n.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return e.handleOperation(async()=>await pt(e.fetch,`${e.url}/DeleteVectors`,n,{headers:e.headers})||{})}},I6=class extends yl{constructor(n,e={},t){const i=n.replace(/\/$/,""),a=Ce(Ce({},xu),{},{"Content-Type":"application/json"},e);super(i,a,t,"vectors")}async createBucket(n){var e=this;return e.handleOperation(async()=>await pt(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:n},{headers:e.headers})||{})}async getBucket(n){var e=this;return e.handleOperation(async()=>await pt(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:n},{headers:e.headers}))}async listBuckets(n={}){var e=this;return e.handleOperation(async()=>await pt(e.fetch,`${e.url}/ListVectorBuckets`,n,{headers:e.headers}))}async deleteBucket(n){var e=this;return e.handleOperation(async()=>await pt(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:n},{headers:e.headers})||{})}},k6=class extends I6{constructor(n,e={}){super(n,e.headers||{},e.fetch)}from(n){return new O6(this.url,this.headers,n,this.fetch)}async createBucket(n){var e=()=>super.createBucket,t=this;return e().call(t,n)}async getBucket(n){var e=()=>super.getBucket,t=this;return e().call(t,n)}async listBuckets(n={}){var e=()=>super.listBuckets,t=this;return e().call(t,n)}async deleteBucket(n){var e=()=>super.deleteBucket,t=this;return e().call(t,n)}},O6=class extends C6{constructor(n,e,t,i){super(n,e,i),this.vectorBucketName=t}async createIndex(n){var e=()=>super.createIndex,t=this;return e().call(t,Ce(Ce({},n),{},{vectorBucketName:t.vectorBucketName}))}async listIndexes(n={}){var e=()=>super.listIndexes,t=this;return e().call(t,Ce(Ce({},n),{},{vectorBucketName:t.vectorBucketName}))}async getIndex(n){var e=()=>super.getIndex,t=this;return e().call(t,t.vectorBucketName,n)}async deleteIndex(n){var e=()=>super.deleteIndex,t=this;return e().call(t,t.vectorBucketName,n)}index(n){return new j6(this.url,this.headers,this.vectorBucketName,n,this.fetch)}},j6=class extends R6{constructor(n,e,t,i,a){super(n,e,a),this.vectorBucketName=t,this.indexName=i}async putVectors(n){var e=()=>super.putVectors,t=this;return e().call(t,Ce(Ce({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async getVectors(n){var e=()=>super.getVectors,t=this;return e().call(t,Ce(Ce({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async listVectors(n={}){var e=()=>super.listVectors,t=this;return e().call(t,Ce(Ce({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async queryVectors(n){var e=()=>super.queryVectors,t=this;return e().call(t,Ce(Ce({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async deleteVectors(n){var e=()=>super.deleteVectors,t=this;return e().call(t,Ce(Ce({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}},D6=class extends A6{constructor(n,e={},t,i){super(n,e,t,i)}from(n){return new E6(this.url,this.headers,n,this.fetch)}get vectors(){return new k6(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new N6(this.url+"/iceberg",this.headers,this.fetch)}};const PS="2.93.2",Fo=30*1e3,Hm=3,Jg=Hm*Fo,P6="http://localhost:9999",M6="supabase.auth.token",L6={"X-Client-Info":`gotrue-js/${PS}`},qm="X-Supabase-Api-Version",MS={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},U6=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,V6=600*1e3;class iu extends Error{constructor(e,t,i){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=i}}function xe(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class B6 extends iu{constructor(e,t,i){super(e,t,i),this.name="AuthApiError",this.status=t,this.code=i}}function z6(n){return xe(n)&&n.name==="AuthApiError"}class xa extends iu{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class ji extends iu{constructor(e,t,i,a){super(e,i,a),this.name=t,this.status=i}}class Ln extends ji{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Xg(n){return xe(n)&&n.name==="AuthSessionMissingError"}class Do extends ji{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class cd extends ji{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class ud extends ji{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function H6(n){return xe(n)&&n.name==="AuthImplicitGrantRedirectError"}class Gx extends ji{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class q6 extends ji{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class $m extends ji{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Zg(n){return xe(n)&&n.name==="AuthRetryableFetchError"}class Kx extends ji{constructor(e,t,i){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=i}}class Fm extends ji{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Kd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Yx=` 	
\r=`.split(""),$6=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<Yx.length;e+=1)n[Yx[e].charCodeAt(0)]=-2;for(let e=0;e<Kd.length;e+=1)n[Kd[e].charCodeAt(0)]=e;return n})();function Wx(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;t(Kd[i]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;t(Kd[i]),e.queuedBits-=6}}function LS(n,e,t){const i=$6[n];if(i>-1)for(e.queue=e.queue<<6|i,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(i===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function Qx(n){const e=[],t=c=>{e.push(String.fromCodePoint(c))},i={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},l=c=>{K6(c,i,t)};for(let c=0;c<n.length;c+=1)LS(n.charCodeAt(c),a,l);return e.join("")}function F6(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function G6(n,e){for(let t=0;t<n.length;t+=1){let i=n.charCodeAt(t);if(i>55295&&i<=56319){const a=(i-55296)*1024&65535;i=(n.charCodeAt(t+1)-56320&65535|a)+65536,t+=1}F6(i,e)}}function K6(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let i=1;i<6;i+=1)if((n>>7-i&1)===0){e.utf8seq=i;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function tl(n){const e=[],t={queue:0,queuedBits:0},i=a=>{e.push(a)};for(let a=0;a<n.length;a+=1)LS(n.charCodeAt(a),t,i);return new Uint8Array(e)}function Y6(n){const e=[];return G6(n,t=>e.push(t)),new Uint8Array(e)}function Na(n){const e=[],t={queue:0,queuedBits:0},i=a=>{e.push(a)};return n.forEach(a=>Wx(a,t,i)),Wx(null,t,i),e.join("")}function W6(n){return Math.round(Date.now()/1e3)+n}function Q6(){return Symbol("auth-callback")}const tn=()=>typeof window<"u"&&typeof document<"u",ya={tested:!1,writable:!1},US=()=>{if(!tn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ya.tested)return ya.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),ya.tested=!0,ya.writable=!0}catch{ya.tested=!0,ya.writable=!1}return ya.writable};function J6(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((a,l)=>{e[l]=a})}catch{}return t.searchParams.forEach((i,a)=>{e[a]=i}),e}const VS=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),X6=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",Go=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},va=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},en=async(n,e)=>{await n.removeItem(e)};class Sf{constructor(){this.promise=new Sf.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Sf.promiseConstructor=Promise;function hd(n){const e=n.split(".");if(e.length!==3)throw new Fm("Invalid JWT structure");for(let i=0;i<e.length;i++)if(!U6.test(e[i]))throw new Fm("JWT not in base64url format");return{header:JSON.parse(Qx(e[0])),payload:JSON.parse(Qx(e[1])),signature:tl(e[2]),raw:{header:e[0],payload:e[1]}}}async function Z6(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function e3(n,e){return new Promise((i,a)=>{(async()=>{for(let l=0;l<1/0;l++)try{const c=await n(l);if(!e(l,null,c)){i(c);return}}catch(c){if(!e(l,c)){a(c);return}}})()})}function t3(n){return("0"+n.toString(16)).substr(-2)}function n3(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",i=t.length;let a="";for(let l=0;l<56;l++)a+=t.charAt(Math.floor(Math.random()*i));return a}return crypto.getRandomValues(e),Array.from(e,t3).join("")}async function s3(n){const t=new TextEncoder().encode(n),i=await crypto.subtle.digest("SHA-256",t),a=new Uint8Array(i);return Array.from(a).map(l=>String.fromCharCode(l)).join("")}async function i3(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await s3(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Po(n,e,t=!1){const i=n3();let a=i;t&&(a+="/PASSWORD_RECOVERY"),await Go(n,`${e}-code-verifier`,a);const l=await i3(i);return[l,i===l?"plain":"s256"]}const r3=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function a3(n){const e=n.headers.get(qm);if(!e||!e.match(r3))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function o3(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function l3(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const c3=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Mo(n){if(!c3.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function em(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const i=t.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function u3(n,e){return new Proxy(n,{get:(t,i,a)=>{if(i==="__isInsecureUserWarningProxy")return!0;if(typeof i=="symbol"){const l=i.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)"||l==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,i,a)}return!e.value&&typeof i=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(t,i,a)}})}function Jx(n){return JSON.parse(JSON.stringify(n))}const ba=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),h3=[502,503,504];async function Xx(n){var e;if(!X6(n))throw new $m(ba(n),0);if(h3.includes(n.status))throw new $m(ba(n),n.status);let t;try{t=await n.json()}catch(l){throw new xa(ba(l),l)}let i;const a=a3(n);if(a&&a.getTime()>=MS["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?i=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(i=t.error_code),i){if(i==="weak_password")throw new Kx(ba(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(i==="session_not_found")throw new Ln}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((l,c)=>l&&typeof c=="string",!0))throw new Kx(ba(t),n.status,t.weak_password.reasons);throw new B6(ba(t),n.status||500,i)}const d3=(n,e,t,i)=>{const a={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),a.body=JSON.stringify(i),Object.assign(Object.assign({},a),t))};async function Ne(n,e,t,i){var a;const l=Object.assign({},i==null?void 0:i.headers);l[qm]||(l[qm]=MS["2024-01-01"].name),i!=null&&i.jwt&&(l.Authorization=`Bearer ${i.jwt}`);const c=(a=i==null?void 0:i.query)!==null&&a!==void 0?a:{};i!=null&&i.redirectTo&&(c.redirect_to=i.redirectTo);const d=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",g=await f3(n,e,t+d,{headers:l,noResolveJson:i==null?void 0:i.noResolveJson},{},i==null?void 0:i.body);return i!=null&&i.xform?i==null?void 0:i.xform(g):{data:Object.assign({},g),error:null}}async function f3(n,e,t,i,a,l){const c=d3(e,i,a,l);let d;try{d=await n(t,Object.assign({},c))}catch(g){throw console.error(g),new $m(ba(g),0)}if(d.ok||await Xx(d),i!=null&&i.noResolveJson)return d;try{return await d.json()}catch(g){await Xx(g)}}function gs(n){var e;let t=null;m3(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=W6(n.expires_in)));const i=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:i},error:null}}function Zx(n){const e=gs(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,i)=>t&&typeof i=="string",!0)&&(e.data.weak_password=n.weak_password),e}function _r(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function p3(n){return{data:n,error:null}}function g3(n){const{action_link:e,email_otp:t,hashed_token:i,redirect_to:a,verification_type:l}=n,c=xf(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),d={action_link:e,email_otp:t,hashed_token:i,redirect_to:a,verification_type:l},g=Object.assign({},c);return{data:{properties:d,user:g},error:null}}function eT(n){return n}function m3(n){return n.access_token&&n.refresh_token&&n.expires_in}const tm=["global","local","others"];class y3{constructor({url:e="",headers:t={},fetch:i}){this.url=e,this.headers=t,this.fetch=VS(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=tm[0]){if(tm.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${tm.join(", ")}`);try{return await Ne(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(i){if(xe(i))return{data:null,error:i};throw i}}async inviteUserByEmail(e,t={}){try{return await Ne(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:_r})}catch(i){if(xe(i))return{data:{user:null},error:i};throw i}}async generateLink(e){try{const{options:t}=e,i=xf(e,["options"]),a=Object.assign(Object.assign({},i),t);return"newEmail"in i&&(a.new_email=i==null?void 0:i.newEmail,delete a.newEmail),await Ne(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:g3,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(xe(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Ne(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:_r})}catch(t){if(xe(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,i,a,l,c,d,g;try{const m={nextPage:null,lastPage:0,total:0},_=await Ne(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:"",per_page:(l=(a=e==null?void 0:e.perPage)===null||a===void 0?void 0:a.toString())!==null&&l!==void 0?l:""},xform:eT});if(_.error)throw _.error;const w=await _.json(),x=(c=_.headers.get("x-total-count"))!==null&&c!==void 0?c:0,S=(g=(d=_.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&g!==void 0?g:[];return S.length>0&&(S.forEach(A=>{const D=parseInt(A.split(";")[0].split("=")[1].substring(0,1)),I=JSON.parse(A.split(";")[1].split("=")[1]);m[`${I}Page`]=D}),m.total=parseInt(x)),{data:Object.assign(Object.assign({},w),m),error:null}}catch(m){if(xe(m))return{data:{users:[]},error:m};throw m}}async getUserById(e){Mo(e);try{return await Ne(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:_r})}catch(t){if(xe(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Mo(e);try{return await Ne(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:_r})}catch(i){if(xe(i))return{data:{user:null},error:i};throw i}}async deleteUser(e,t=!1){Mo(e);try{return await Ne(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:_r})}catch(i){if(xe(i))return{data:{user:null},error:i};throw i}}async _listFactors(e){Mo(e.userId);try{const{data:t,error:i}=await Ne(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:t,error:i}}catch(t){if(xe(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Mo(e.userId),Mo(e.id);try{return{data:await Ne(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(xe(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,i,a,l,c,d,g;try{const m={nextPage:null,lastPage:0,total:0},_=await Ne(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:"",per_page:(l=(a=e==null?void 0:e.perPage)===null||a===void 0?void 0:a.toString())!==null&&l!==void 0?l:""},xform:eT});if(_.error)throw _.error;const w=await _.json(),x=(c=_.headers.get("x-total-count"))!==null&&c!==void 0?c:0,S=(g=(d=_.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&g!==void 0?g:[];return S.length>0&&(S.forEach(A=>{const D=parseInt(A.split(";")[0].split("=")[1].substring(0,1)),I=JSON.parse(A.split(";")[1].split("=")[1]);m[`${I}Page`]=D}),m.total=parseInt(x)),{data:Object.assign(Object.assign({},w),m),error:null}}catch(m){if(xe(m))return{data:{clients:[]},error:m};throw m}}async _createOAuthClient(e){try{return await Ne(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(xe(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await Ne(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(xe(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await Ne(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:i=>({data:i,error:null})})}catch(i){if(xe(i))return{data:null,error:i};throw i}}async _deleteOAuthClient(e){try{return await Ne(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(xe(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await Ne(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(xe(t))return{data:null,error:t};throw t}}}function tT(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}const Lo={debug:!!(globalThis&&US()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class BS extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class v3 extends BS{}async function _3(n,e,t){Lo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const i=new globalThis.AbortController;return e>0&&setTimeout(()=>{i.abort(),Lo.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},async a=>{if(a){Lo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,a.name);try{return await t()}finally{Lo.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,a.name)}}else{if(e===0)throw Lo.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new v3(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(Lo.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}function b3(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function zS(n){if(!/^0x[a-fA-F0-9]{40}$/.test(n))throw new Error(`@supabase/auth-js: Address "${n}" is invalid.`);return n.toLowerCase()}function w3(n){return parseInt(n,16)}function x3(n){const e=new TextEncoder().encode(n);return"0x"+Array.from(e,i=>i.toString(16).padStart(2,"0")).join("")}function T3(n){var e;const{chainId:t,domain:i,expirationTime:a,issuedAt:l=new Date,nonce:c,notBefore:d,requestId:g,resources:m,scheme:_,uri:w,version:x}=n;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!i)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(c&&c.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${c}`);if(!w)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(x!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${x}`);if(!((e=n.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${n.statement}`)}const S=zS(n.address),A=_?`${_}://${i}`:i,D=n.statement?`${n.statement}
`:"",I=`${A} wants you to sign in with your Ethereum account:
${S}

${D}`;let U=`URI: ${w}
Version: ${x}
Chain ID: ${t}${c?`
Nonce: ${c}`:""}
Issued At: ${l.toISOString()}`;if(a&&(U+=`
Expiration Time: ${a.toISOString()}`),d&&(U+=`
Not Before: ${d.toISOString()}`),g&&(U+=`
Request ID: ${g}`),m){let q=`
Resources:`;for(const z of m){if(!z||typeof z!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${z}`);q+=`
- ${z}`}U+=q}return`${I}
${U}`}class Mt extends Error{constructor({message:e,code:t,cause:i,name:a}){var l;super(e,{cause:i}),this.__isWebAuthnError=!0,this.name=(l=a??(i instanceof Error?i.name:void 0))!==null&&l!==void 0?l:"Unknown Error",this.code=t}}class Yd extends Mt{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function E3({error:n,options:e}){var t,i,a;const{publicKey:l}=e;if(!l)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Mt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else if(n.name==="ConstraintError"){if(((t=l.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new Mt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:n});if(e.mediation==="conditional"&&((i=l.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new Mt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:n});if(((a=l.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new Mt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:n})}else{if(n.name==="InvalidStateError")return new Mt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:n});if(n.name==="NotAllowedError")return new Mt({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="NotSupportedError")return l.pubKeyCredParams.filter(d=>d.type==="public-key").length===0?new Mt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:n}):new Mt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:n});if(n.name==="SecurityError"){const c=window.location.hostname;if(HS(c)){if(l.rp.id!==c)return new Mt({message:`The RP ID "${l.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new Mt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="TypeError"){if(l.user.id.byteLength<1||l.user.id.byteLength>64)return new Mt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:n})}else if(n.name==="UnknownError")return new Mt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new Mt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}function S3({error:n,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Mt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else{if(n.name==="NotAllowedError")return new Mt({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="SecurityError"){const i=window.location.hostname;if(HS(i)){if(t.rpId!==i)return new Mt({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new Mt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="UnknownError")return new Mt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new Mt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}class A3{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const N3=new A3;function C3(n){if(!n)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(n);const{challenge:e,user:t,excludeCredentials:i}=n,a=xf(n,["challenge","user","excludeCredentials"]),l=tl(e).buffer,c=Object.assign(Object.assign({},t),{id:tl(t.id).buffer}),d=Object.assign(Object.assign({},a),{challenge:l,user:c});if(i&&i.length>0){d.excludeCredentials=new Array(i.length);for(let g=0;g<i.length;g++){const m=i[g];d.excludeCredentials[g]=Object.assign(Object.assign({},m),{id:tl(m.id).buffer,type:m.type||"public-key",transports:m.transports})}}return d}function R3(n){if(!n)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(n);const{challenge:e,allowCredentials:t}=n,i=xf(n,["challenge","allowCredentials"]),a=tl(e).buffer,l=Object.assign(Object.assign({},i),{challenge:a});if(t&&t.length>0){l.allowCredentials=new Array(t.length);for(let c=0;c<t.length;c++){const d=t[c];l.allowCredentials[c]=Object.assign(Object.assign({},d),{id:tl(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function I3(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n;return{id:n.id,rawId:n.id,response:{attestationObject:Na(new Uint8Array(n.response.attestationObject)),clientDataJSON:Na(new Uint8Array(n.response.clientDataJSON))},type:"public-key",clientExtensionResults:n.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function k3(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n,i=n.getClientExtensionResults(),a=n.response;return{id:n.id,rawId:n.id,response:{authenticatorData:Na(new Uint8Array(a.authenticatorData)),clientDataJSON:Na(new Uint8Array(a.clientDataJSON)),signature:Na(new Uint8Array(a.signature)),userHandle:a.userHandle?Na(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:i,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function HS(n){return n==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(n)}function nT(){var n,e;return!!(tn()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((n=navigator==null?void 0:navigator.credentials)===null||n===void 0?void 0:n.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function O3(n){try{const e=await navigator.credentials.create(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Yd("Browser returned unexpected credential type",e)}:{data:null,error:new Yd("Empty credential response",e)}}catch(e){return{data:null,error:E3({error:e,options:n})}}}async function j3(n){try{const e=await navigator.credentials.get(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Yd("Browser returned unexpected credential type",e)}:{data:null,error:new Yd("Empty credential response",e)}}catch(e){return{data:null,error:S3({error:e,options:n})}}}const D3={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},P3={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Wd(...n){const e=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),t=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),i={};for(const a of n)if(a)for(const l in a){const c=a[l];if(c!==void 0)if(Array.isArray(c))i[l]=c;else if(t(c))i[l]=c;else if(e(c)){const d=i[l];e(d)?i[l]=Wd(d,c):i[l]=Wd(c)}else i[l]=c}return i}function M3(n,e){return Wd(D3,n,e||{})}function L3(n,e){return Wd(P3,n,e||{})}class U3{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:i,signal:a},l){try{const{data:c,error:d}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!c)return{data:null,error:d};const g=a??N3.createNewAbortSignal();if(c.webauthn.type==="create"){const{user:m}=c.webauthn.credential_options.publicKey;m.name||(m.name=`${m.id}:${i}`),m.displayName||(m.displayName=m.name)}switch(c.webauthn.type){case"create":{const m=M3(c.webauthn.credential_options.publicKey,l==null?void 0:l.create),{data:_,error:w}=await O3({publicKey:m,signal:g});return _?{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:_}},error:null}:{data:null,error:w}}case"request":{const m=L3(c.webauthn.credential_options.publicKey,l==null?void 0:l.request),{data:_,error:w}=await j3(Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:m,signal:g}));return _?{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:_}},error:null}:{data:null,error:w}}}}catch(c){return xe(c)?{data:null,error:c}:{data:null,error:new xa("Unexpected error in challenge",c)}}}async _verify({challengeId:e,factorId:t,webauthn:i}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:i})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},l){if(!t)return{data:null,error:new iu("rpId is required for WebAuthn authentication")};try{if(!nT())return{data:null,error:new xa("Browser does not support WebAuthn",null)};const{data:c,error:d}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:i},signal:a},{request:l});if(!c)return{data:null,error:d};const{webauthn:g}=c;return this._verify({factorId:e,challengeId:c.challengeId,webauthn:{type:g.type,rpId:t,rpOrigins:i,credential_response:g.credential_response}})}catch(c){return xe(c)?{data:null,error:c}:{data:null,error:new xa("Unexpected error in authenticate",c)}}}async _register({friendlyName:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},l){if(!t)return{data:null,error:new iu("rpId is required for WebAuthn registration")};try{if(!nT())return{data:null,error:new xa("Browser does not support WebAuthn",null)};const{data:c,error:d}=await this._enroll({friendlyName:e});if(!c)return await this.client.mfa.listFactors().then(_=>{var w;return(w=_.data)===null||w===void 0?void 0:w.all.find(x=>x.factor_type==="webauthn"&&x.friendly_name===e&&x.status!=="unverified")}).then(_=>_?this.client.mfa.unenroll({factorId:_==null?void 0:_.id}):void 0),{data:null,error:d};const{data:g,error:m}=await this._challenge({factorId:c.id,friendlyName:c.friendly_name,webauthn:{rpId:t,rpOrigins:i},signal:a},{create:l});return g?this._verify({factorId:c.id,challengeId:g.challengeId,webauthn:{rpId:t,rpOrigins:i,type:g.webauthn.type,credential_response:g.webauthn.credential_response}}):{data:null,error:m}}catch(c){return xe(c)?{data:null,error:c}:{data:null,error:new xa("Unexpected error in register",c)}}}}b3();const V3={url:P6,storageKey:M6,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:L6,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function sT(n,e,t){return await t()}const Uo={};class ru{get jwks(){var e,t;return(t=(e=Uo[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Uo[this.storageKey]=Object.assign(Object.assign({},Uo[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Uo[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Uo[this.storageKey]=Object.assign(Object.assign({},Uo[this.storageKey]),{cachedAt:e})}constructor(e){var t,i,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const l=Object.assign(Object.assign({},V3),e);if(this.storageKey=l.storageKey,this.instanceID=(t=ru.nextInstanceID[this.storageKey])!==null&&t!==void 0?t:0,ru.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!l.debug,typeof l.debug=="function"&&(this.logger=l.debug),this.instanceID>0&&tn()){const c=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(c),this.logDebugMessages&&console.trace(c)}if(this.persistSession=l.persistSession,this.autoRefreshToken=l.autoRefreshToken,this.admin=new y3({url:l.url,headers:l.headers,fetch:l.fetch}),this.url=l.url,this.headers=l.headers,this.fetch=VS(l.fetch),this.lock=l.lock||sT,this.detectSessionInUrl=l.detectSessionInUrl,this.flowType=l.flowType,this.hasCustomAuthorizationHeader=l.hasCustomAuthorizationHeader,this.throwOnError=l.throwOnError,this.lockAcquireTimeout=l.lockAcquireTimeout,l.lock?this.lock=l.lock:this.persistSession&&tn()&&(!((i=globalThis==null?void 0:globalThis.navigator)===null||i===void 0)&&i.locks)?this.lock=_3:this.lock=sT,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new U3(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(l.storage?this.storage=l.storage:US()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=tT(this.memoryStorage)),l.userStorage&&(this.userStorage=l.userStorage)):(this.memoryStorage={},this.storage=tT(this.memoryStorage)),tn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(c){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",c)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async c=>{this._debug("received broadcast notification from other tab or client",c);try{await this._notifyAllSubscribers(c.data.event,c.data.session,!1)}catch(d){this._debug("#broadcastChannel","error",d)}})}this.initialize().catch(c=>{this._debug("#initialize()","error",c)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${PS}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let t={},i="none";if(tn()&&(t=J6(window.location.href),this._isImplicitGrantCallback(t)?i="implicit":await this._isPKCECallback(t)&&(i="pkce")),tn()&&this.detectSessionInUrl&&i!=="none"){const{data:a,error:l}=await this._getSessionFromURL(t,i);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),H6(l)){const g=(e=l.details)===null||e===void 0?void 0:e.code;if(g==="identity_already_exists"||g==="identity_not_found"||g==="single_identity_not_deletable")return{error:l}}return{error:l}}const{session:c,redirectType:d}=a;return this._debug("#_initialize()","detected session in URL",c,"redirect type",d),await this._saveSession(c),setTimeout(async()=>{d==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return xe(t)?this._returnResult({error:t}):this._returnResult({error:new xa("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,i,a;try{const l=await Ne(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(i=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:(a=e==null?void 0:e.options)===null||a===void 0?void 0:a.captchaToken}},xform:gs}),{data:c,error:d}=l;if(d||!c)return this._returnResult({data:{user:null,session:null},error:d});const g=c.session,m=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",g)),this._returnResult({data:{user:m,session:g},error:null})}catch(l){if(xe(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signUp(e){var t,i,a;try{let l;if("email"in e){const{email:_,password:w,options:x}=e;let S=null,A=null;this.flowType==="pkce"&&([S,A]=await Po(this.storage,this.storageKey)),l=await Ne(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:x==null?void 0:x.emailRedirectTo,body:{email:_,password:w,data:(t=x==null?void 0:x.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:x==null?void 0:x.captchaToken},code_challenge:S,code_challenge_method:A},xform:gs})}else if("phone"in e){const{phone:_,password:w,options:x}=e;l=await Ne(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:_,password:w,data:(i=x==null?void 0:x.data)!==null&&i!==void 0?i:{},channel:(a=x==null?void 0:x.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:x==null?void 0:x.captchaToken}},xform:gs})}else throw new cd("You must provide either an email or phone number and a password");const{data:c,error:d}=l;if(d||!c)return await en(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:d});const g=c.session,m=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",g)),this._returnResult({data:{user:m,session:g},error:null})}catch(l){if(await en(this.storage,`${this.storageKey}-code-verifier`),xe(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signInWithPassword(e){try{let t;if("email"in e){const{email:l,password:c,options:d}=e;t=await Ne(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:c,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:Zx})}else if("phone"in e){const{phone:l,password:c,options:d}=e;t=await Ne(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:c,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:Zx})}else throw new cd("You must provide either an email or phone number and a password");const{data:i,error:a}=t;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!i||!i.session||!i.user){const l=new Do;return this._returnResult({data:{user:null,session:null},error:l})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:a})}catch(t){if(xe(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,i,a,l;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(i=e.options)===null||i===void 0?void 0:i.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(l=e.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,i,a,l,c,d,g,m,_,w,x;let S,A;if("message"in e)S=e.message,A=e.signature;else{const{chain:D,wallet:I,statement:U,options:q}=e;let z;if(tn())if(typeof I=="object")z=I;else{const k=window;if("ethereum"in k&&typeof k.ethereum=="object"&&"request"in k.ethereum&&typeof k.ethereum.request=="function")z=k.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof I!="object"||!(q!=null&&q.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");z=I}const O=new URL((t=q==null?void 0:q.url)!==null&&t!==void 0?t:window.location.href),$=await z.request({method:"eth_requestAccounts"}).then(k=>k).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!$||$.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const Q=zS($[0]);let R=(i=q==null?void 0:q.signInWithEthereum)===null||i===void 0?void 0:i.chainId;if(!R){const k=await z.request({method:"eth_chainId"});R=w3(k)}const N={domain:O.host,address:Q,statement:U,uri:O.href,version:"1",chainId:R,nonce:(a=q==null?void 0:q.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(c=(l=q==null?void 0:q.signInWithEthereum)===null||l===void 0?void 0:l.issuedAt)!==null&&c!==void 0?c:new Date,expirationTime:(d=q==null?void 0:q.signInWithEthereum)===null||d===void 0?void 0:d.expirationTime,notBefore:(g=q==null?void 0:q.signInWithEthereum)===null||g===void 0?void 0:g.notBefore,requestId:(m=q==null?void 0:q.signInWithEthereum)===null||m===void 0?void 0:m.requestId,resources:(_=q==null?void 0:q.signInWithEthereum)===null||_===void 0?void 0:_.resources};S=T3(N),A=await z.request({method:"personal_sign",params:[x3(S),Q]})}try{const{data:D,error:I}=await Ne(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:S,signature:A},!((w=e.options)===null||w===void 0)&&w.captchaToken?{gotrue_meta_security:{captcha_token:(x=e.options)===null||x===void 0?void 0:x.captchaToken}}:null),xform:gs});if(I)throw I;if(!D||!D.session||!D.user){const U=new Do;return this._returnResult({data:{user:null,session:null},error:U})}return D.session&&(await this._saveSession(D.session),await this._notifyAllSubscribers("SIGNED_IN",D.session)),this._returnResult({data:Object.assign({},D),error:I})}catch(D){if(xe(D))return this._returnResult({data:{user:null,session:null},error:D});throw D}}async signInWithSolana(e){var t,i,a,l,c,d,g,m,_,w,x,S;let A,D;if("message"in e)A=e.message,D=e.signature;else{const{chain:I,wallet:U,statement:q,options:z}=e;let O;if(tn())if(typeof U=="object")O=U;else{const Q=window;if("solana"in Q&&typeof Q.solana=="object"&&("signIn"in Q.solana&&typeof Q.solana.signIn=="function"||"signMessage"in Q.solana&&typeof Q.solana.signMessage=="function"))O=Q.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof U!="object"||!(z!=null&&z.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");O=U}const $=new URL((t=z==null?void 0:z.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in O&&O.signIn){const Q=await O.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},z==null?void 0:z.signInWithSolana),{version:"1",domain:$.host,uri:$.href}),q?{statement:q}:null));let R;if(Array.isArray(Q)&&Q[0]&&typeof Q[0]=="object")R=Q[0];else if(Q&&typeof Q=="object"&&"signedMessage"in Q&&"signature"in Q)R=Q;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in R&&"signature"in R&&(typeof R.signedMessage=="string"||R.signedMessage instanceof Uint8Array)&&R.signature instanceof Uint8Array)A=typeof R.signedMessage=="string"?R.signedMessage:new TextDecoder().decode(R.signedMessage),D=R.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in O)||typeof O.signMessage!="function"||!("publicKey"in O)||typeof O!="object"||!O.publicKey||!("toBase58"in O.publicKey)||typeof O.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");A=[`${$.host} wants you to sign in with your Solana account:`,O.publicKey.toBase58(),...q?["",q,""]:[""],"Version: 1",`URI: ${$.href}`,`Issued At: ${(a=(i=z==null?void 0:z.signInWithSolana)===null||i===void 0?void 0:i.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((l=z==null?void 0:z.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${z.signInWithSolana.notBefore}`]:[],...!((c=z==null?void 0:z.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${z.signInWithSolana.expirationTime}`]:[],...!((d=z==null?void 0:z.signInWithSolana)===null||d===void 0)&&d.chainId?[`Chain ID: ${z.signInWithSolana.chainId}`]:[],...!((g=z==null?void 0:z.signInWithSolana)===null||g===void 0)&&g.nonce?[`Nonce: ${z.signInWithSolana.nonce}`]:[],...!((m=z==null?void 0:z.signInWithSolana)===null||m===void 0)&&m.requestId?[`Request ID: ${z.signInWithSolana.requestId}`]:[],...!((w=(_=z==null?void 0:z.signInWithSolana)===null||_===void 0?void 0:_.resources)===null||w===void 0)&&w.length?["Resources",...z.signInWithSolana.resources.map(R=>`- ${R}`)]:[]].join(`
`);const Q=await O.signMessage(new TextEncoder().encode(A),"utf8");if(!Q||!(Q instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");D=Q}}try{const{data:I,error:U}=await Ne(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:A,signature:Na(D)},!((x=e.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(S=e.options)===null||S===void 0?void 0:S.captchaToken}}:null),xform:gs});if(U)throw U;if(!I||!I.session||!I.user){const q=new Do;return this._returnResult({data:{user:null,session:null},error:q})}return I.session&&(await this._saveSession(I.session),await this._notifyAllSubscribers("SIGNED_IN",I.session)),this._returnResult({data:Object.assign({},I),error:U})}catch(I){if(xe(I))return this._returnResult({data:{user:null,session:null},error:I});throw I}}async _exchangeCodeForSession(e){const t=await va(this.storage,`${this.storageKey}-code-verifier`),[i,a]=(t??"").split("/");try{if(!i&&this.flowType==="pkce")throw new q6;const{data:l,error:c}=await Ne(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:i},xform:gs});if(await en(this.storage,`${this.storageKey}-code-verifier`),c)throw c;if(!l||!l.session||!l.user){const d=new Do;return this._returnResult({data:{user:null,session:null,redirectType:null},error:d})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign(Object.assign({},l),{redirectType:a??null}),error:c})}catch(l){if(await en(this.storage,`${this.storageKey}-code-verifier`),xe(l))return this._returnResult({data:{user:null,session:null,redirectType:null},error:l});throw l}}async signInWithIdToken(e){try{const{options:t,provider:i,token:a,access_token:l,nonce:c}=e,d=await Ne(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:a,access_token:l,nonce:c,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:gs}),{data:g,error:m}=d;if(m)return this._returnResult({data:{user:null,session:null},error:m});if(!g||!g.session||!g.user){const _=new Do;return this._returnResult({data:{user:null,session:null},error:_})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:g,error:m})}catch(t){if(xe(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,i,a,l,c;try{if("email"in e){const{email:d,options:g}=e;let m=null,_=null;this.flowType==="pkce"&&([m,_]=await Po(this.storage,this.storageKey));const{error:w}=await Ne(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:d,data:(t=g==null?void 0:g.data)!==null&&t!==void 0?t:{},create_user:(i=g==null?void 0:g.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},code_challenge:m,code_challenge_method:_},redirectTo:g==null?void 0:g.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:w})}if("phone"in e){const{phone:d,options:g}=e,{data:m,error:_}=await Ne(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:d,data:(a=g==null?void 0:g.data)!==null&&a!==void 0?a:{},create_user:(l=g==null?void 0:g.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},channel:(c=g==null?void 0:g.channel)!==null&&c!==void 0?c:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:m==null?void 0:m.message_id},error:_})}throw new cd("You must provide either an email or phone number.")}catch(d){if(await en(this.storage,`${this.storageKey}-code-verifier`),xe(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async verifyOtp(e){var t,i;try{let a,l;"options"in e&&(a=(t=e.options)===null||t===void 0?void 0:t.redirectTo,l=(i=e.options)===null||i===void 0?void 0:i.captchaToken);const{data:c,error:d}=await Ne(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:l}}),redirectTo:a,xform:gs});if(d)throw d;if(!c)throw new Error("An error occurred on token verification.");const g=c.session,m=c.user;return g!=null&&g.access_token&&(await this._saveSession(g),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",g)),this._returnResult({data:{user:m,session:g},error:null})}catch(a){if(xe(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(e){var t,i,a,l,c;try{let d=null,g=null;this.flowType==="pkce"&&([d,g]=await Po(this.storage,this.storageKey));const m=await Ne(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(i=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&i!==void 0?i:void 0}),!((a=e==null?void 0:e.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:d,code_challenge_method:g}),headers:this.headers,xform:p3});return!((l=m.data)===null||l===void 0)&&l.url&&tn()&&!(!((c=e.options)===null||c===void 0)&&c.skipBrowserRedirect)&&window.location.assign(m.data.url),this._returnResult(m)}catch(d){if(await en(this.storage,`${this.storageKey}-code-verifier`),xe(d))return this._returnResult({data:null,error:d});throw d}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:i}=e;if(i)throw i;if(!t)throw new Ln;const{error:a}=await Ne(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(e){if(xe(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:i,type:a,options:l}=e,{error:c}=await Ne(this.fetch,"POST",t,{headers:this.headers,body:{email:i,type:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},redirectTo:l==null?void 0:l.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:c})}else if("phone"in e){const{phone:i,type:a,options:l}=e,{data:c,error:d}=await Ne(this.fetch,"POST",t,{headers:this.headers,body:{phone:i,type:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:d})}throw new cd("You must provide either an email or phone number and a type")}catch(t){if(xe(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const i=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await i,await t()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const i=t();for(this.pendingInLock.push((async()=>{try{await i}catch{}})()),await i;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await i}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await va(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const i=e.expires_at?e.expires_at*1e3-Date.now()<Jg:!1;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",e.expires_at),!i){if(this.userStorage){const c=await va(this.userStorage,this.storageKey+"-user");c!=null&&c.user?e.user=c.user:e.user=em()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const c={value:this.suppressGetSessionWarning};e.user=u3(e.user,c),c.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:a,error:l}=await this._callRefreshToken(e.refresh_token);return l?this._returnResult({data:{session:null},error:l}):this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const t=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(e){try{return e?await Ne(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:_r}):await this._useSession(async t=>{var i,a,l;const{data:c,error:d}=t;if(d)throw d;return!(!((i=c.session)===null||i===void 0)&&i.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ln}:await Ne(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(a=c.session)===null||a===void 0?void 0:a.access_token)!==null&&l!==void 0?l:void 0,xform:_r})})}catch(t){if(xe(t))return Xg(t)&&(await this._removeSession(),await en(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async i=>{const{data:a,error:l}=i;if(l)throw l;if(!a.session)throw new Ln;const c=a.session;let d=null,g=null;this.flowType==="pkce"&&e.email!=null&&([d,g]=await Po(this.storage,this.storageKey));const{data:m,error:_}=await Ne(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:d,code_challenge_method:g}),jwt:c.access_token,xform:_r});if(_)throw _;return c.user=m.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),this._returnResult({data:{user:c.user},error:null})})}catch(i){if(await en(this.storage,`${this.storageKey}-code-verifier`),xe(i))return this._returnResult({data:{user:null},error:i});throw i}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ln;const t=Date.now()/1e3;let i=t,a=!0,l=null;const{payload:c}=hd(e.access_token);if(c.exp&&(i=c.exp,a=i<=t),a){const{data:d,error:g}=await this._callRefreshToken(e.refresh_token);if(g)return this._returnResult({data:{user:null,session:null},error:g});if(!d)return{data:{user:null,session:null},error:null};l=d}else{const{data:d,error:g}=await this._getUser(e.access_token);if(g)return this._returnResult({data:{user:null,session:null},error:g});l={access_token:e.access_token,refresh_token:e.refresh_token,user:d.user,token_type:"bearer",expires_in:i-t,expires_at:i},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return this._returnResult({data:{user:l.user,session:l},error:null})}catch(t){if(xe(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var i;if(!e){const{data:c,error:d}=t;if(d)throw d;e=(i=c.session)!==null&&i!==void 0?i:void 0}if(!(e!=null&&e.refresh_token))throw new Ln;const{data:a,error:l}=await this._callRefreshToken(e.refresh_token);return l?this._returnResult({data:{user:null,session:null},error:l}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(xe(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!tn())throw new ud("No browser detected.");if(e.error||e.error_description||e.error_code)throw new ud(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Gx("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ud("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Gx("No code detected.");const{data:q,error:z}=await this._exchangeCodeForSession(e.code);if(z)throw z;const O=new URL(window.location.href);return O.searchParams.delete("code"),window.history.replaceState(window.history.state,"",O.toString()),{data:{session:q.session,redirectType:null},error:null}}const{provider_token:i,provider_refresh_token:a,access_token:l,refresh_token:c,expires_in:d,expires_at:g,token_type:m}=e;if(!l||!d||!c||!m)throw new ud("No session defined in URL");const _=Math.round(Date.now()/1e3),w=parseInt(d);let x=_+w;g&&(x=parseInt(g));const S=x-_;S*1e3<=Fo&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${S}s, should have been closer to ${w}s`);const A=x-w;_-A>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",A,x,_):_-A<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",A,x,_);const{data:D,error:I}=await this._getUser(l);if(I)throw I;const U={provider_token:i,provider_refresh_token:a,access_token:l,expires_in:w,expires_at:x,refresh_token:c,token_type:m,user:D.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:U,redirectType:e.type},error:null})}catch(i){if(xe(i))return this._returnResult({data:{session:null,redirectType:null},error:i});throw i}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await va(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var i;const{data:a,error:l}=t;if(l&&!Xg(l))return this._returnResult({error:l});const c=(i=a.session)===null||i===void 0?void 0:i.access_token;if(c){const{error:d}=await this.admin.signOut(c,e);if(d&&!(z6(d)&&(d.status===404||d.status===401||d.status===403)||Xg(d)))return this._returnResult({error:d})}return e!=="others"&&(await this._removeSession(),await en(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=Q6(),i={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,i),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:i}}}async _emitInitialSession(e){return await this._useSession(async t=>{var i,a;try{const{data:{session:l},error:c}=t;if(c)throw c;await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",e,"session",l)}catch(l){await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",l),console.error(l)}})}async resetPasswordForEmail(e,t={}){let i=null,a=null;this.flowType==="pkce"&&([i,a]=await Po(this.storage,this.storageKey,!0));try{return await Ne(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:i,code_challenge_method:a,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(l){if(await en(this.storage,`${this.storageKey}-code-verifier`),xe(l))return this._returnResult({data:null,error:l});throw l}}async getUserIdentities(){var e;try{const{data:t,error:i}=await this.getUser();if(i)throw i;return this._returnResult({data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(t){if(xe(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:i,error:a}=await this._useSession(async l=>{var c,d,g,m,_;const{data:w,error:x}=l;if(x)throw x;const S=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(c=e.options)===null||c===void 0?void 0:c.redirectTo,scopes:(d=e.options)===null||d===void 0?void 0:d.scopes,queryParams:(g=e.options)===null||g===void 0?void 0:g.queryParams,skipBrowserRedirect:!0});return await Ne(this.fetch,"GET",S,{headers:this.headers,jwt:(_=(m=w.session)===null||m===void 0?void 0:m.access_token)!==null&&_!==void 0?_:void 0})});if(a)throw a;return tn()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(i==null?void 0:i.url),this._returnResult({data:{provider:e.provider,url:i==null?void 0:i.url},error:null})}catch(i){if(xe(i))return this._returnResult({data:{provider:e.provider,url:null},error:i});throw i}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var i;try{const{error:a,data:{session:l}}=t;if(a)throw a;const{options:c,provider:d,token:g,access_token:m,nonce:_}=e,w=await Ne(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(i=l==null?void 0:l.access_token)!==null&&i!==void 0?i:void 0,body:{provider:d,id_token:g,access_token:m,nonce:_,link_identity:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:gs}),{data:x,error:S}=w;return S?this._returnResult({data:{user:null,session:null},error:S}):!x||!x.session||!x.user?this._returnResult({data:{user:null,session:null},error:new Do}):(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("USER_UPDATED",x.session)),this._returnResult({data:x,error:S}))}catch(a){if(await en(this.storage,`${this.storageKey}-code-verifier`),xe(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var i,a;const{data:l,error:c}=t;if(c)throw c;return await Ne(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(a=(i=l.session)===null||i===void 0?void 0:i.access_token)!==null&&a!==void 0?a:void 0})})}catch(t){if(xe(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const i=Date.now();return await e3(async a=>(a>0&&await Z6(200*Math.pow(2,a-1)),this._debug(t,"refreshing attempt",a),await Ne(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:gs})),(a,l)=>{const c=200*Math.pow(2,a);return l&&Zg(l)&&Date.now()+c-i<Fo})}catch(i){if(this._debug(t,"error",i),xe(i))return this._returnResult({data:{session:null,user:null},error:i});throw i}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const i=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",i),tn()&&!t.skipBrowserRedirect&&window.location.assign(i),{data:{provider:e,url:i},error:null}}async _recoverAndRefresh(){var e,t;const i="#_recoverAndRefresh()";this._debug(i,"begin");try{const a=await va(this.storage,this.storageKey);if(a&&this.userStorage){let c=await va(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:a.user},await Go(this.userStorage,this.storageKey+"-user",c)),a.user=(e=c==null?void 0:c.user)!==null&&e!==void 0?e:em()}else if(a&&!a.user&&!a.user){const c=await va(this.storage,this.storageKey+"-user");c&&(c!=null&&c.user)?(a.user=c.user,await en(this.storage,this.storageKey+"-user"),await Go(this.storage,this.storageKey,a)):a.user=em()}if(this._debug(i,"session from storage",a),!this._isValidSession(a)){this._debug(i,"session is not valid"),a!==null&&await this._removeSession();return}const l=((t=a.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Jg;if(this._debug(i,`session has${l?"":" not"} expired with margin of ${Jg}s`),l){if(this.autoRefreshToken&&a.refresh_token){const{error:c}=await this._callRefreshToken(a.refresh_token);c&&(console.error(c),Zg(c)||(this._debug(i,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:d}=await this._getUser(a.access_token);!d&&(c!=null&&c.user)?(a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(i,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(i,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(i,"error",a),console.error(a);return}finally{this._debug(i,"end")}}async _callRefreshToken(e){var t,i;if(!e)throw new Ln;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Sf;const{data:l,error:c}=await this._refreshAccessToken(e);if(c)throw c;if(!l.session)throw new Ln;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const d={data:l.session,error:null};return this.refreshingDeferred.resolve(d),d}catch(l){if(this._debug(a,"error",l),xe(l)){const c={data:null,error:l};return Zg(l)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(c),c}throw(i=this.refreshingDeferred)===null||i===void 0||i.reject(l),l}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,t,i=!0){const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",t,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:e,session:t});const l=[],c=Array.from(this.stateChangeEmitters.values()).map(async d=>{try{await d.callback(e,t)}catch(g){l.push(g)}});if(await Promise.all(c),l.length>0){for(let d=0;d<l.length;d+=1)console.error(l[d]);throw l[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await en(this.storage,`${this.storageKey}-code-verifier`);const t=Object.assign({},e),i=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!i&&t.user&&await Go(this.userStorage,this.storageKey+"-user",{user:t.user});const a=Object.assign({},t);delete a.user;const l=Jx(a);await Go(this.storage,this.storageKey,l)}else{const a=Jx(t);await Go(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await en(this.storage,this.storageKey),await en(this.storage,this.storageKey+"-code-verifier"),await en(this.storage,this.storageKey+"-user"),this.userStorage&&await en(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&tn()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Fo);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e);const t=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const t=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,t&&clearTimeout(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:i}}=t;if(!i||!i.refresh_token||!i.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((i.expires_at*1e3-e)/Fo);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Fo}ms, refresh threshold is ${Hm} ticks`),a<=Hm&&await this._callRefreshToken(i.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof BS)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!tn()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(e){this._debug("#visibilityChangedCallback","error",e)}},window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,i){const a=[`provider=${encodeURIComponent(t)}`];if(i!=null&&i.redirectTo&&a.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),i!=null&&i.scopes&&a.push(`scopes=${encodeURIComponent(i.scopes)}`),this.flowType==="pkce"){const[l,c]=await Po(this.storage,this.storageKey),d=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(c)}`});a.push(d.toString())}if(i!=null&&i.queryParams){const l=new URLSearchParams(i.queryParams);a.push(l.toString())}return i!=null&&i.skipBrowserRedirect&&a.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var i;const{data:a,error:l}=t;return l?this._returnResult({data:null,error:l}):await Ne(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(i=a==null?void 0:a.session)===null||i===void 0?void 0:i.access_token})})}catch(t){if(xe(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var i,a;const{data:l,error:c}=t;if(c)return this._returnResult({data:null,error:c});const d=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:g,error:m}=await Ne(this.fetch,"POST",`${this.url}/factors`,{body:d,headers:this.headers,jwt:(i=l==null?void 0:l.session)===null||i===void 0?void 0:i.access_token});return m?this._returnResult({data:null,error:m}):(e.factorType==="totp"&&g.type==="totp"&&(!((a=g==null?void 0:g.totp)===null||a===void 0)&&a.qr_code)&&(g.totp.qr_code=`data:image/svg+xml;utf-8,${g.totp.qr_code}`),this._returnResult({data:g,error:null}))})}catch(t){if(xe(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var i;const{data:a,error:l}=t;if(l)return this._returnResult({data:null,error:l});const c=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?I3(e.webauthn.credential_response):k3(e.webauthn.credential_response)})}:{code:e.code}),{data:d,error:g}=await Ne(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:c,headers:this.headers,jwt:(i=a==null?void 0:a.session)===null||i===void 0?void 0:i.access_token});return g?this._returnResult({data:null,error:g}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+d.expires_in},d)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",d),this._returnResult({data:d,error:g}))})}catch(t){if(xe(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var i;const{data:a,error:l}=t;if(l)return this._returnResult({data:null,error:l});const c=await Ne(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(i=a==null?void 0:a.session)===null||i===void 0?void 0:i.access_token});if(c.error)return c;const{data:d}=c;if(d.type!=="webauthn")return{data:d,error:null};switch(d.webauthn.type){case"create":return{data:Object.assign(Object.assign({},d),{webauthn:Object.assign(Object.assign({},d.webauthn),{credential_options:Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:C3(d.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},d),{webauthn:Object.assign(Object.assign({},d.webauthn),{credential_options:Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:R3(d.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(xe(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:i}=await this._challenge({factorId:e.factorId});return i?this._returnResult({data:null,error:i}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:i}=await this.getUser();if(i)return{data:null,error:i};const a={all:[],phone:[],totp:[],webauthn:[]};for(const l of(e=t==null?void 0:t.factors)!==null&&e!==void 0?e:[])a.all.push(l),l.status==="verified"&&a[l.factor_type].push(l);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(e){var t,i,a,l;if(e)try{const{payload:S}=hd(e);let A=null;S.aal&&(A=S.aal);let D=A;const{data:{user:I},error:U}=await this.getUser(e);if(U)return this._returnResult({data:null,error:U});((i=(t=I==null?void 0:I.factors)===null||t===void 0?void 0:t.filter(O=>O.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(D="aal2");const z=S.amr||[];return{data:{currentLevel:A,nextLevel:D,currentAuthenticationMethods:z},error:null}}catch(S){if(xe(S))return this._returnResult({data:null,error:S});throw S}const{data:{session:c},error:d}=await this.getSession();if(d)return this._returnResult({data:null,error:d});if(!c)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:g}=hd(c.access_token);let m=null;g.aal&&(m=g.aal);let _=m;((l=(a=c.user.factors)===null||a===void 0?void 0:a.filter(S=>S.status==="verified"))!==null&&l!==void 0?l:[]).length>0&&(_="aal2");const x=g.amr||[];return{data:{currentLevel:m,nextLevel:_,currentAuthenticationMethods:x},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:i},error:a}=t;return a?this._returnResult({data:null,error:a}):i?await Ne(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:i.access_token,xform:l=>({data:l,error:null})}):this._returnResult({data:null,error:new Ln})})}catch(t){if(xe(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async i=>{const{data:{session:a},error:l}=i;if(l)return this._returnResult({data:null,error:l});if(!a)return this._returnResult({data:null,error:new Ln});const c=await Ne(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:d=>({data:d,error:null})});return c.data&&c.data.redirect_url&&tn()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(c.data.redirect_url),c})}catch(i){if(xe(i))return this._returnResult({data:null,error:i});throw i}}async _denyAuthorization(e,t){try{return await this._useSession(async i=>{const{data:{session:a},error:l}=i;if(l)return this._returnResult({data:null,error:l});if(!a)return this._returnResult({data:null,error:new Ln});const c=await Ne(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:d=>({data:d,error:null})});return c.data&&c.data.redirect_url&&tn()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(c.data.redirect_url),c})}catch(i){if(xe(i))return this._returnResult({data:null,error:i});throw i}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:t},error:i}=e;return i?this._returnResult({data:null,error:i}):t?await Ne(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new Ln})})}catch(e){if(xe(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{const{data:{session:i},error:a}=t;return a?this._returnResult({data:null,error:a}):i?(await Ne(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:i.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Ln})})}catch(t){if(xe(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(e,t={keys:[]}){let i=t.keys.find(d=>d.kid===e);if(i)return i;const a=Date.now();if(i=this.jwks.keys.find(d=>d.kid===e),i&&this.jwks_cached_at+V6>a)return i;const{data:l,error:c}=await Ne(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=a,i=l.keys.find(d=>d.kid===e),!i)?null:i}async getClaims(e,t={}){try{let i=e;if(!i){const{data:S,error:A}=await this.getSession();if(A||!S.session)return this._returnResult({data:null,error:A});i=S.session.access_token}const{header:a,payload:l,signature:c,raw:{header:d,payload:g}}=hd(i);t!=null&&t.allowExpired||o3(l.exp);const m=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,t!=null&&t.keys?{keys:t.keys}:t==null?void 0:t.jwks);if(!m){const{error:S}=await this.getUser(i);if(S)throw S;return{data:{claims:l,header:a,signature:c},error:null}}const _=l3(a.alg),w=await crypto.subtle.importKey("jwk",m,_,!0,["verify"]);if(!await crypto.subtle.verify(_,w,c,Y6(`${d}.${g}`)))throw new Fm("Invalid JWT signature");return{data:{claims:l,header:a,signature:c},error:null}}catch(i){if(xe(i))return this._returnResult({data:null,error:i});throw i}}}ru.nextInstanceID={};const B3=ru,z3="2.93.2";let Dc="";typeof Deno<"u"?Dc="deno":typeof document<"u"?Dc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Dc="react-native":Dc="node";const H3={"X-Client-Info":`supabase-js-${Dc}/${z3}`},q3={headers:H3},$3={schema:"public"},F3={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},G3={};function au(n){"@babel/helpers - typeof";return au=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},au(n)}function K3(n,e){if(au(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(au(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Y3(n){var e=K3(n,"string");return au(e)=="symbol"?e:e+""}function W3(n,e,t){return(e=Y3(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function iT(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,i)}return t}function _t(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?iT(Object(t),!0).forEach(function(i){W3(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):iT(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}const Q3=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),J3=()=>Headers,X3=(n,e,t)=>{const i=Q3(t),a=J3();return async(l,c)=>{var d;const g=(d=await e())!==null&&d!==void 0?d:n;let m=new a(c==null?void 0:c.headers);return m.has("apikey")||m.set("apikey",n),m.has("Authorization")||m.set("Authorization",`Bearer ${g}`),i(l,_t(_t({},c),{},{headers:m}))}};function Z3(n){return n.endsWith("/")?n:n+"/"}function e5(n,e){var t,i;const{db:a,auth:l,realtime:c,global:d}=n,{db:g,auth:m,realtime:_,global:w}=e,x={db:_t(_t({},g),a),auth:_t(_t({},m),l),realtime:_t(_t({},_),c),storage:{},global:_t(_t(_t({},w),d),{},{headers:_t(_t({},(t=w==null?void 0:w.headers)!==null&&t!==void 0?t:{}),(i=d==null?void 0:d.headers)!==null&&i!==void 0?i:{})}),accessToken:async()=>""};return n.accessToken?x.accessToken=n.accessToken:delete x.accessToken,x}function t5(n){const e=n==null?void 0:n.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Z3(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var n5=class extends B3{constructor(n){super(n)}},s5=class{constructor(n,e,t){var i,a;this.supabaseUrl=n,this.supabaseKey=e;const l=t5(n);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:$3,realtime:G3,auth:_t(_t({},F3),{},{storageKey:c}),global:q3},g=e5(t??{},d);if(this.storageKey=(i=g.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(a=g.global.headers)!==null&&a!==void 0?a:{},g.accessToken)this.accessToken=g.accessToken,this.auth=new Proxy({},{get:(_,w)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(w)} is not possible`)}});else{var m;this.auth=this._initSupabaseAuthClient((m=g.auth)!==null&&m!==void 0?m:{},this.headers,g.global.fetch)}this.fetch=X3(e,this._getAccessToken.bind(this),g.global.fetch),this.realtime=this._initRealtimeClient(_t({headers:this.headers,accessToken:this._getAccessToken.bind(this)},g.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(_=>this.realtime.setAuth(_)).catch(_=>console.warn("Failed to set initial Realtime auth token:",_)),this.rest=new BM(new URL("rest/v1",l).href,{headers:this.headers,schema:g.db.schema,fetch:this.fetch}),this.storage=new D6(this.storageUrl.href,this.headers,this.fetch,t==null?void 0:t.storage),g.accessToken||this._listenForAuthEvents()}get functions(){return new PM(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(n){return this.rest.from(n)}schema(n){return this.rest.schema(n)}rpc(n,e={},t={head:!1,get:!1,count:void 0}){return this.rest.rpc(n,e,t)}channel(n,e={config:{}}){return this.realtime.channel(n,e)}getChannels(){return this.realtime.getChannels()}removeChannel(n){return this.realtime.removeChannel(n)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var n=this,e,t;if(n.accessToken)return await n.accessToken();const{data:i}=await n.auth.getSession();return(e=(t=i.session)===null||t===void 0?void 0:t.access_token)!==null&&e!==void 0?e:n.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:n,persistSession:e,detectSessionInUrl:t,storage:i,userStorage:a,storageKey:l,flowType:c,lock:d,debug:g,throwOnError:m},_,w){const x={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new n5({url:this.authUrl.href,headers:_t(_t({},x),_),storageKey:l,autoRefreshToken:n,persistSession:e,detectSessionInUrl:t,storage:i,userStorage:a,flowType:c,lock:d,debug:g,throwOnError:m,fetch:w,hasCustomAuthorizationHeader:Object.keys(this.headers).some(S=>S.toLowerCase()==="authorization")})}_initRealtimeClient(n){return new s6(this.realtimeUrl.href,_t(_t({},n),{},{params:_t(_t({},{apikey:this.supabaseKey}),n==null?void 0:n.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,e)=>{this._handleTokenChanged(n,"CLIENT",e==null?void 0:e.access_token)})}_handleTokenChanged(n,e,t){(n==="TOKEN_REFRESHED"||n==="SIGNED_IN")&&this.changedAccessToken!==t?(this.changedAccessToken=t,this.realtime.setAuth(t)):n==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const i5=(n,e,t)=>new s5(n,e,t);function r5(){if(typeof window<"u")return!1;const n=globalThis.process;if(!n)return!1;const e=n.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}r5()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const a5="https://prrldyvdefoyloqtrhfw.supabase.co",o5="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBycmxkeXZkZWZveWxvcXRyaGZ3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk1OTQ5NzUsImV4cCI6MjA4NTE3MDk3NX0.ANRkpfrxGKefAW3-2-WXfB7RRmQbTFIYd2VcW24OeWk",rT=i5(a5,o5),qS=async(n,e="images")=>{try{const t=n.name.split(".").pop(),a=`${`${Date.now()}_${Math.random().toString(36).substring(2)}.${t}`}`,{data:l,error:c}=await rT.storage.from(e).upload(a,n,{cacheControl:"3600",upsert:!1});if(c)throw c;const{data:d}=rT.storage.from(e).getPublicUrl(a);return d.publicUrl}catch(t){throw console.error("Supabase Upload Error:",t),new Error(t.message||"Upload failed")}},aT=le.forwardRef(({value:n,onChange:e,className:t=""},i)=>{const a=le.useRef(null),l=le.useRef(null),c=le.useRef(null),[d,g]=le.useState(!1);le.useEffect(()=>{a.current&&a.current.innerHTML!==n&&(n===""&&a.current.innerHTML!==""?a.current.innerHTML="":a.current.innerHTML===""&&n&&(a.current.innerHTML=n))},[n]),le.useImperativeHandle(i,()=>({insertText:A=>{document.activeElement===a.current||_(),document.execCommand("insertText",!1,A),x()},insertHtml:A=>{document.activeElement===a.current||_(),document.execCommand("insertHTML",!1,A),x()}}));const m=()=>{const A=window.getSelection();A&&A.rangeCount>0&&a.current&&a.current.contains(A.anchorNode)&&(l.current=A.getRangeAt(0))},_=()=>{var D;const A=window.getSelection();if(A&&!(A.rangeCount>0&&a.current&&a.current.contains(A.anchorNode))){if(l.current&&((D=a.current)!=null&&D.contains(l.current.commonAncestorContainer)))A.removeAllRanges(),A.addRange(l.current);else if(a.current){a.current.focus();const I=document.createRange();I.selectNodeContents(a.current),I.collapse(!1),A.removeAllRanges(),A.addRange(I),l.current=I}}},w=(A,D=void 0)=>{document.activeElement!==a.current&&_(),document.execCommand(A,!1,D),x()},x=()=>{a.current&&e(a.current.innerHTML),m()},S=async A=>{if(A.target.files&&A.target.files[0]){const D=A.target.files[0];g(!0);try{m();const I=await qS(D,"images");_(),document.execCommand("insertHTML",!1,`<img src="${I}" style="max-width:100%; border-radius: 8px;" />`),x()}catch(I){alert("Upload fail: "+I.message)}finally{g(!1),c.current&&(c.current.value="")}}};return f.jsxs("div",{className:`border border-slate-700 rounded-lg overflow-hidden flex flex-col ${t}`,children:[f.jsxs("div",{className:"bg-slate-800 border-b border-slate-700 p-2 flex gap-1 flex-wrap items-center",children:[f.jsx("button",{onMouseDown:A=>{A.preventDefault(),w("bold")},className:"p-1 px-2 text-slate-300 hover:bg-white/10 rounded font-bold",type:"button",title:"Bold",children:"B"}),f.jsx("button",{onMouseDown:A=>{A.preventDefault(),w("italic")},className:"p-1 px-2 text-slate-300 hover:bg-white/10 rounded italic",type:"button",title:"Italic",children:"I"}),f.jsx("button",{onMouseDown:A=>{A.preventDefault(),w("underline")},className:"p-1 px-2 text-slate-300 hover:bg-white/10 rounded underline",type:"button",title:"Underline",children:"U"}),f.jsx("div",{className:"w-px h-6 bg-slate-600 mx-1 self-center"}),f.jsx("button",{onMouseDown:A=>{A.preventDefault(),w("justifyLeft")},className:"p-1 px-2 text-slate-300 hover:bg-white/10 rounded",type:"button",title:"Align Left",children:""}),f.jsx("button",{onMouseDown:A=>{A.preventDefault(),w("justifyCenter")},className:"p-1 px-2 text-slate-300 hover:bg-white/10 rounded",type:"button",title:"Align Center",children:""}),f.jsx("button",{onMouseDown:A=>{A.preventDefault(),w("justifyRight")},className:"p-1 px-2 text-slate-300 hover:bg-white/10 rounded",type:"button",title:"Align Right",children:""}),f.jsx("div",{className:"w-px h-6 bg-slate-600 mx-1 self-center"}),f.jsx("button",{onMouseDown:A=>{A.preventDefault();const D=prompt("Nhp ng dn URL:");D&&w("createLink",D)},className:"p-1 px-2 text-slate-300 hover:bg-white/10 rounded text-blue-400",type:"button",title:"Chn Link",children:"Link"}),f.jsx("button",{onMouseDown:A=>{var D;A.preventDefault(),(D=c.current)==null||D.click()},className:"p-1 px-2 text-slate-300 hover:bg-white/10 rounded text-emerald-400 flex items-center gap-1",type:"button",title:"Upload nh (Chn ngay)",children:d?"...":f.jsxs(f.Fragment,{children:["Img",f.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})})]})}),f.jsx("input",{type:"file",ref:c,onChange:S,className:"hidden",accept:"image/*"}),f.jsxs("select",{onChange:A=>w("formatBlock",A.target.value),className:"bg-slate-700 text-white text-xs rounded px-2 py-1 outline-none border border-slate-600 ml-2",children:[f.jsx("option",{value:"p",children:"Normal"}),f.jsx("option",{value:"h3",children:"Heading 1"}),f.jsx("option",{value:"h4",children:"Heading 2"}),f.jsx("option",{value:"blockquote",children:"Quote"})]})]}),f.jsx("div",{ref:a,contentEditable:!0,onInput:x,onBlur:m,onMouseUp:m,onKeyUp:m,className:"flex-grow bg-slate-900 text-white p-4 outline-none min-h-[150px] overflow-auto prose prose-invert prose-sm max-w-none"})]})}),l5=({currentImage:n,onImageUploaded:e,onClear:t})=>{const[i,a]=le.useState(n||null),[l,c]=le.useState(!1),[d,g]=le.useState(null),m=le.useRef(null),_=le.useRef(null);le.useEffect(()=>{a(n||null)},[n]),le.useEffect(()=>{const I=U=>{if(U.clipboardData&&U.clipboardData.items){const q=U.clipboardData.items;for(let z=0;z<q.length;z++)if(q[z].type.indexOf("image")!==-1){const O=q[z].getAsFile();O&&x(O);break}}};return window.addEventListener("paste",I),()=>window.removeEventListener("paste",I)},[]);const w=I=>I.type.startsWith("image/")?I.size>5*1024*1024?(g("Dung lng hnh nh phi di 5MB."),!1):!0:(g("Ch chp nhn file hnh nh (JPG, PNG, GIF, WEBP)."),!1),x=async I=>{if(g(null),!w(I))return;const U=URL.createObjectURL(I);a(U),c(!0);try{const q=await qS(I,"images");e(q),c(!1)}catch(q){console.error("Upload error:",q);let z="C li xy ra khi ti nh ln.";q.message&&(z=q.message),g(z),c(!1)}},S=I=>{I.target.files&&I.target.files[0]&&x(I.target.files[0])},A=I=>{I.preventDefault(),I.stopPropagation(),I.dataTransfer.files&&I.dataTransfer.files[0]&&x(I.dataTransfer.files[0])},D=I=>{I.preventDefault(),I.stopPropagation()};return f.jsxs("div",{className:"space-y-3",children:[f.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400",children:"Hnh nh i din (Ti a 5MB)"}),i?f.jsxs("div",{className:"relative group rounded-xl overflow-hidden border border-slate-700 bg-slate-900",children:[f.jsx("img",{src:i,alt:"Preview",className:"w-full h-48 object-cover opacity-80 group-hover:opacity-100 transition-opacity"}),f.jsxs("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-3",children:[f.jsx("button",{onClick:()=>{var I;return(I=m.current)==null?void 0:I.click()},className:"bg-indigo-600 hover:bg-indigo-700 text-white px-3 py-1.5 rounded text-xs font-bold",children:"Thay i"}),f.jsx("button",{onClick:()=>{a(null),t()},className:"bg-red-600 hover:bg-red-700 text-white px-3 py-1.5 rounded text-xs font-bold",children:"Xa"})]}),l&&f.jsxs("div",{className:"absolute inset-0 bg-black/70 flex flex-col items-center justify-center z-10",children:[f.jsx("div",{className:"w-12 h-12 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin mb-2"}),f.jsx("span",{className:"text-white text-xs font-bold mb-2",children:"ang ti ln Supabase..."})]})]}):f.jsxs("div",{ref:_,onDrop:A,onDragOver:D,className:"border-2 border-dashed border-slate-700 hover:border-indigo-500 bg-slate-800/50 hover:bg-slate-800 rounded-xl p-8 text-center cursor-pointer transition-all flex flex-col items-center justify-center gap-2 group",onClick:()=>{var I;return(I=m.current)==null?void 0:I.click()},tabIndex:0,children:[f.jsx("svg",{className:"w-8 h-8 text-slate-500 group-hover:text-indigo-400 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),f.jsxs("div",{children:[f.jsx("span",{className:"text-indigo-400 font-bold text-sm",children:"Upload File"}),f.jsx("span",{className:"text-slate-500 text-sm",children:" hoc ko th vo y"})]}),f.jsx("div",{className:"text-[10px] text-slate-500 uppercase font-bold tracking-widest mt-1",children:"H tr Paste (Ctrl+V)"})]}),d&&f.jsx("div",{className:"text-red-400 text-xs font-bold bg-red-400/10 p-2 rounded",children:d}),f.jsx("input",{type:"file",ref:m,onChange:S,accept:"image/*",className:"hidden"})]})},c5=({news:n,formatDate:e,onImageClick:t})=>{const[i,a]=le.useState(!1),d=(m=>{const _=document.createElement("DIV");return _.innerHTML=m,_.textContent||_.innerText||""})(n.content).split(/\s+/).filter(m=>m.length>0),g=d.length>50;return f.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-shadow",children:[f.jsx("h3",{className:"text-xl font-bold text-indigo-700 mb-2",children:n.title}),f.jsxs("div",{className:"text-xs text-gray-400 mb-4",children:[e(n.date)," | Bi ",n.author]}),n.imageUrl&&f.jsx("div",{className:"mb-4 rounded-xl overflow-hidden cursor-zoom-in shadow-sm hover:shadow-md transition-all",children:f.jsx("img",{src:n.imageUrl,alt:n.title,className:"w-full h-auto object-cover hover:scale-105 transition-transform duration-500",onClick:m=>{m.stopPropagation(),t(n.imageUrl)}})}),f.jsx("div",{className:`prose prose-slate max-w-none ${!i&&g?"line-clamp-3":""}`,onClick:m=>{const _=m.target;_.tagName==="IMG"&&(m.stopPropagation(),t(_.src))},children:i||!g?f.jsx("div",{dangerouslySetInnerHTML:{__html:n.content},className:"[&_img]:cursor-zoom-in [&_img]:rounded-lg [&_img]:shadow-sm hover:[&_img]:shadow-md [&_img]:transition-all"}):f.jsx("div",{children:f.jsxs("p",{children:[d.slice(0,50).join(" "),"..."]})})}),g&&f.jsx("button",{onClick:()=>a(!i),className:"mt-3 text-sm font-bold text-indigo-600 hover:text-indigo-800 underline decoration-2 underline-offset-4",children:i?"Thu gn":"Xem thm"})]})},u5=({user:n,onNavigate:e})=>{var V,te,de,pe,Se;const[t,i]=le.useState({layout:"modern",news:[],welcomeTitle:"",welcomeMessage:"",statusTitle:"",statusMessage:""}),[a,l]=le.useState(!1),[c,d]=le.useState({}),[g,m]=le.useState(!1),_=le.useRef(null),[w,x]=le.useState(null),[S,A]=le.useState(null),[D,I]=le.useState(null),[U,q]=le.useState("news"),[z,O]=le.useState(null);le.useEffect(()=>{const X=localStorage.getItem("app_settings");if(X)i(JSON.parse(X));else{const he=[{id:"1",title:"Cho mng n vi Quang Huy Studio",content:"<p>H thng <b>Multi-App Engine</b>  chnh thc vn hnh. Hy chn ng dng  bt u!</p>",date:Date.now(),author:"System"}];i({layout:"modern",news:he,welcomeTitle:"Cho mng, {username}!",welcomeMessage:"H thng AI Studio cung cp cc cng c ti tn nht  t ng ha quy trnh sng to ni dung ca bn.",statusTitle:"Stable",statusMessage:"Tt c dch v API ang hot ng bnh thng.",zaloPhone:"0987654321",sidebarWidgets:[{id:"w1",type:"status",title:"Trng thi",order:0},{id:"w2",type:"shortcuts",title:"Li tt",order:1}]})}},[]),le.useEffect(()=>{a&&x(t)},[a,t]);const $=X=>{i(X),localStorage.setItem("app_settings",JSON.stringify(X))},Q=()=>{w&&($(w),alert(" lu cu hnh thnh cng!"))},R=(X,he)=>{w&&x({...w,[X]:he})},N=()=>{if(!c.title||!c.content)return;const X={id:c.id||crypto.randomUUID(),title:c.title,content:c.content,imageUrl:c.imageUrl,date:c.date||Date.now(),author:n.username};let he=[...t.news];c.id?he=he.map(ve=>ve.id===c.id?X:ve):he=[X,...he],$({...t,news:he}),m(!1),d({})},k=X=>{if(confirm("Bn c chc mun xa tin tc ny?")){const he=t.news.filter(ve=>ve.id!==X);$({...t,news:he})}},M=X=>new Date(X).toLocaleDateString("vi-VN",{year:"numeric",month:"long",day:"numeric"}),L=X=>X?X.replace("{username}",n.username||"User"):"",F=(X,he)=>{if(!w)return;const ve=[...w.sidebarWidgets||[]];he==="up"&&X>0?[ve[X],ve[X-1]]=[ve[X-1],ve[X]]:he==="down"&&X<ve.length-1&&([ve[X],ve[X+1]]=[ve[X+1],ve[X]]),R("sidebarWidgets",ve)},j=()=>{var he;if(!w)return;const X={id:crypto.randomUUID(),type:"custom",title:"Tiu  mi",content:"<p>Ni dung ty chnh...</p>",order:((he=w.sidebarWidgets)==null?void 0:he.length)||0};R("sidebarWidgets",[...w.sidebarWidgets||[],X])},ce=X=>{var he;if(w&&confirm("Xa widget ny?")){const ve=((he=w.sidebarWidgets)==null?void 0:he.filter(Ke=>Ke.id!==X))||[];R("sidebarWidgets",ve)}},ue=(X,he,ve)=>{var qt;if(!w)return;const Ke=((qt=w.sidebarWidgets)==null?void 0:qt.map(Ts=>Ts.id===X?{...Ts,[he]:ve}:Ts))||[];R("sidebarWidgets",Ke)},B=X=>{q("widget"),O(X.id)},se=()=>{q("news"),O(null)},ge=(X,he)=>{const ve=[...t.news];he==="up"&&X>0?[ve[X],ve[X-1]]=[ve[X-1],ve[X]]:he==="down"&&X<ve.length-1&&([ve[X],ve[X+1]]=[ve[X+1],ve[X]]),$({...t,news:ve})},be=()=>f.jsx("div",{className:"flex flex-col h-full overflow-y-auto",children:D?f.jsxs("div",{className:"max-w-5xl mx-auto w-full px-6 py-12 animate-in fade-in slide-in-from-right-8",children:[f.jsxs("button",{onClick:()=>I(null),className:"mb-8 flex items-center gap-2 text-indigo-600 font-bold hover:underline",children:[f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Quay li Trang ch"]}),f.jsxs("div",{className:"bg-white rounded-3xl p-10 shadow-xl border border-indigo-100",children:[f.jsx("h1",{className:"text-4xl font-black text-gray-900 mb-8 border-b pb-4",children:D.title}),f.jsx("div",{className:"prose prose-lg max-w-none text-gray-600 [&_img]:rounded-xl [&_img]:shadow-lg [&_a]:text-blue-600 [&_a]:underline hover:[&_a]:text-blue-800",children:D.type==="custom"?f.jsx("div",{dangerouslySetInnerHTML:{__html:D.content||""}}):f.jsx("div",{children:"This widget content is dynamic."})})]})]}):f.jsxs(f.Fragment,{children:[t.zaloPhone&&f.jsxs("a",{href:`https://zalo.me/${t.zaloPhone}`,target:"_blank",rel:"noreferrer",className:"fixed bottom-24 right-6 z-40 bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-full shadow-lg flex items-center gap-2 animate-bounce transition-transform hover:scale-110",title:"Chat Zalo",children:[f.jsx("svg",{className:"w-6 h-6",viewBox:"0 0 24 24",fill:"currentColor",children:f.jsx("path",{d:"M12 2C6.48 2 2 5.92 2 10.5c0 2.37 1.17 4.54 3.12 6.13-.15.86-.54 1.95-1.42 2.62-.23.18-.08.57.21.57 2.39 0 4.19-1.29 4.88-1.93.7.13 1.43.21 2.21.21 5.52 0 10-3.92 10-8.5S17.52 2 12 2zm0 15c-.71 0-1.39-.07-2.04-.2-.27-.05-.54.04-.73.23-.74.72-2.12 1.58-3.73 1.66.44-.8 1.05-2.22 1.05-2.22.06-.16.03-.35-.09-.48C4.94 14.54 4 12.63 4 10.5 4 7.02 7.7 4 12 4s8 3.02 8 6.5-3.7 6.5-8 6.5z"})}),f.jsx("span",{className:"font-bold text-xs",children:t.zaloPhone})]}),f.jsxs("div",{className:"relative py-24 px-6 md:px-12 text-center overflow-hidden",children:[f.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-900 via-[#0f172a] to-slate-900 z-0"}),f.jsx("div",{className:"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-20 z-0"}),f.jsxs("div",{className:"relative z-10 space-y-6 max-w-4xl mx-auto",children:[f.jsx("span",{className:"inline-block py-1 px-3 rounded-full bg-indigo-500/20 border border-indigo-400/30 text-indigo-300 text-xs font-bold uppercase tracking-widest animate-in fade-in slide-in-from-bottom-4",children:"H thng iu hnh AI tp trung"}),f.jsx("h1",{className:"text-5xl md:text-7xl font-black text-transparent bg-clip-text bg-gradient-to-r from-white via-indigo-200 to-indigo-400 leading-tight drop-shadow-2xl animate-in zoom-in-95 duration-700",children:t.welcomeTitle?L(t.welcomeTitle):"QUANG HUY AI STUDIO"}),f.jsx("p",{className:"text-lg md:text-xl text-slate-400 font-light max-w-2xl mx-auto leading-relaxed animate-in fade-in slide-in-from-bottom-6 delay-200",children:t.welcomeMessage||"Nn tng tch hp a cng c mnh m, gip bn ti u ha quy trnh sng to Video v Hnh nh Viral ch vi mt c click."}),f.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-4 pt-8 animate-in fade-in slide-in-from-bottom-8 delay-300",children:[f.jsxs("button",{onClick:()=>e("video-viral"),className:"group relative px-8 py-4 bg-indigo-600 hover:bg-indigo-500 text-white font-bold rounded-2xl shadow-xl shadow-indigo-600/20 transition-all hover:-translate-y-1 active:scale-95 overflow-hidden",children:[f.jsx("div",{className:"absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform duration-300 transform skew-y-12"}),"VIDEO VIRAL ENGINE"]}),f.jsx("button",{onClick:()=>e("image-script"),className:"px-8 py-4 bg-slate-800 hover:bg-slate-700 border border-slate-700 text-white font-bold rounded-2xl shadow-xl transition-all hover:-translate-y-1 active:scale-95",children:"VISUAL SCRIPT ENGINE"})]})]})]}),f.jsxs("div",{className:"max-w-5xl mx-auto w-full px-6 py-16 space-y-12",children:[f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("h2",{className:"text-2xl font-bold text-gray-800 border-l-4 border-indigo-600 pl-4 uppercase tracking-wider",children:"Tin Tc Mi Nht"}),f.jsx("div",{className:"h-px bg-gray-200 flex-grow"})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[t.news.map(X=>f.jsxs("div",{className:"group bg-white rounded-2xl p-6 shadow-lg border border-gray-100 hover:shadow-2xl hover:border-indigo-100 transition-all",children:[f.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-400 mb-4 font-bold uppercase tracking-wider",children:[f.jsx("span",{children:M(X.date)}),f.jsx("span",{className:"text-indigo-500",children:X.author})]}),X.imageUrl&&f.jsx("div",{className:"mb-3 rounded-lg overflow-hidden h-40 w-full relative",children:f.jsx("img",{src:X.imageUrl,alt:X.title,className:"absolute inset-0 w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-500 cursor-zoom-in",onClick:()=>A(X.imageUrl)})}),f.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-3 group-hover:text-indigo-600 transition-colors line-clamp-2",children:X.title}),f.jsx("div",{className:"prose prose-sm text-gray-500 line-clamp-4 [&_img]:cursor-zoom-in",dangerouslySetInnerHTML:{__html:X.content},onClick:he=>{const ve=he.target;ve.tagName==="IMG"&&(he.stopPropagation(),A(ve.src))}}),f.jsxs("button",{className:"mt-6 text-sm font-bold text-indigo-600 hover:text-indigo-800 flex items-center gap-2 group/btn",children:["Xem chi tit",f.jsx("svg",{className:"w-4 h-4 group-hover/btn:translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 8l4 4m0 0l-4 4m4-4H3"})})]})]},X.id)),t.news.length===0&&f.jsx("p",{className:"text-gray-400 italic",children:"Cha c tin tc no."})]})]})]})}),Le=()=>{var X;return f.jsxs("div",{className:"h-full overflow-y-auto bg-gray-50",children:[t.zaloPhone&&f.jsxs("a",{href:`https://zalo.me/${t.zaloPhone}`,target:"_blank",rel:"noreferrer",className:"fixed bottom-24 right-6 z-40 bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-full shadow-lg flex items-center gap-2 animate-bounce transition-transform hover:scale-110",title:"Chat Zalo",children:[f.jsx("svg",{className:"w-6 h-6",viewBox:"0 0 24 24",fill:"currentColor",children:f.jsx("path",{d:"M12 2C6.48 2 2 5.92 2 10.5c0 2.37 1.17 4.54 3.12 6.13-.15.86-.54 1.95-1.42 2.62-.23.18-.08.57.21.57 2.39 0 4.19-1.29 4.88-1.93.7.13 1.43.21 2.21.21 5.52 0 10-3.92 10-8.5S17.52 2 12 2zm0 15c-.71 0-1.39-.07-2.04-.2-.27-.05-.54.04-.73.23-.74.72-2.12 1.58-3.73 1.66.44-.8 1.05-2.22 1.05-2.22.06-.16.03-.35-.09-.48C4.94 14.54 4 12.63 4 10.5 4 7.02 7.7 4 12 4s8 3.02 8 6.5-3.7 6.5-8 6.5z"})}),f.jsxs("span",{className:"font-bold text-sm",children:["H tr: ",t.zaloPhone]})]}),f.jsx("div",{className:"max-w-6xl mx-auto px-6 py-12",children:f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-12",children:[f.jsx("div",{className:"lg:col-span-2 space-y-8",children:D?f.jsxs("div",{className:"bg-white rounded-3xl p-10 shadow-xl border border-gray-100 animate-in fade-in slide-in-from-bottom-4",children:[f.jsx("button",{onClick:()=>I(null),className:"mb-6 text-sm text-slate-500 font-bold uppercase tracking-wider hover:text-indigo-600 flex items-center gap-2",children:" Quay li"}),f.jsx("h1",{className:"text-3xl font-black text-gray-900 mb-6",children:D.title}),f.jsx("div",{className:"prose max-w-none text-gray-600 [&_a]:text-blue-600 [&_a]:underline hover:[&_a]:text-blue-800",dangerouslySetInnerHTML:{__html:D.content||""}})]}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"bg-white rounded-3xl p-10 shadow-xl border border-gray-100 relative overflow-hidden",children:[f.jsx("div",{className:"absolute top-0 right-0 p-8 w-64 opacity-10",children:f.jsx("svg",{fill:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5zm0 9l2.5-1.25L12 8.5l-2.5 1.25L12 11zm0 2.5l-5-2.5-5 2.5L12 22l10-8.5-5-2.5-5 2.5z"})})}),f.jsx("h1",{className:"text-4xl font-black text-gray-900 mb-6",children:L(t.welcomeTitle)||`Cho mng, ${n.username}!`}),f.jsx("p",{className:"text-lg text-gray-600 mb-8 leading-relaxed",children:t.welcomeMessage||"H thng AI Studio cung cp cc cng c ti tn nht  t ng ha quy trnh sng to ni dung ca bn."}),f.jsx("div",{className:"flex flex-wrap gap-4"})]}),f.jsxs("div",{className:"space-y-6",children:[f.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Cp nht h thng"}),t.news.map(he=>f.jsx(c5,{news:he,formatDate:M,onImageClick:A},he.id))]})]})}),f.jsx("div",{className:"space-y-6",children:(X=t.sidebarWidgets)==null?void 0:X.map(he=>f.jsxs("div",{className:`${he.type==="status"?"bg-gradient-to-br from-indigo-500 to-purple-600 text-white":"bg-white text-gray-800 border-gray-100"} rounded-3xl p-8 shadow-xl border transition-all cursor-pointer hover:scale-[1.02] hover:shadow-2xl active:scale-95`,onClick:ve=>{if(he.type!=="custom")return;const qt=ve.target.closest("a");if(qt){ve.preventDefault(),ve.stopPropagation(),window.open(qt.href,"_blank");return}I(he)},children:[f.jsxs("div",{className:"flex justify-between items-center mb-4 opacity-80",children:[f.jsx("h3",{className:"text-lg font-bold uppercase tracking-widest",children:he.title}),he.type==="custom"&&f.jsx("span",{className:"text-xs bg-black/10 px-2 py-1 rounded",children:"M xem"})]}),he.type==="status"&&f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"text-4xl font-black mb-4",children:t.statusTitle||"Stable"}),f.jsx("p",{className:"text-sm opacity-90",children:t.statusMessage||"Tt c dch v API ang hot ng bnh thng."})]}),he.type==="shortcuts"&&f.jsxs("ul",{className:"space-y-3 text-sm text-gray-600",children:[f.jsxs("li",{className:"flex items-center gap-2 cursor-pointer hover:text-indigo-600",children:[f.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500"})," User Guide"]}),f.jsxs("li",{className:"flex items-center gap-2 cursor-pointer hover:text-indigo-600",children:[f.jsx("span",{className:"w-2 h-2 rounded-full bg-blue-500"})," API Docs"]}),f.jsxs("li",{className:"flex items-center gap-2 cursor-pointer hover:text-indigo-600",children:[f.jsx("span",{className:"w-2 h-2 rounded-full bg-orange-500"})," Support"]})]}),he.type==="custom"&&he.content&&f.jsx("div",{className:"prose prose-sm max-w-none line-clamp-3 [&_a]:text-blue-600 [&_a]:underline hover:[&_a]:text-blue-800 relative z-10",dangerouslySetInnerHTML:{__html:he.content}})]},he.id))})]})})]})};return f.jsxs("div",{className:"relative h-full w-full bg-slate-50",children:[t.layout==="modern"&&f.jsx(be,{}),t.layout==="classic"&&f.jsx(Le,{}),t.layout==="news-focus"&&f.jsx(Le,{})," ",n.role==="admin"&&f.jsx("div",{className:"fixed bottom-6 right-6 z-50",children:f.jsx("button",{onClick:()=>l(!0),className:"w-14 h-14 bg-red-600 hover:bg-red-700 text-white rounded-full shadow-2xl flex items-center justify-center transition-transform hover:scale-110 active:scale-95",title:"Qun tr trang ch",children:f.jsxs("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})})}),S&&f.jsx("div",{className:"fixed inset-0 z-[300] bg-black/95 backdrop-blur-md flex items-center justify-center p-4 md:p-10 animate-in fade-in duration-300",onClick:()=>A(null),children:f.jsxs("div",{className:"relative max-w-full max-h-full flex flex-col items-center",children:[f.jsx("img",{src:S,alt:"Full View",className:"max-w-full max-h-[85vh] object-contain rounded-lg shadow-2xl",onClick:X=>X.stopPropagation()}),f.jsxs("button",{onClick:()=>A(null),className:"mt-6 bg-white/10 hover:bg-white/20 text-white px-6 py-2 rounded-full backdrop-blur-md border border-white/20 font-bold transition-all hover:scale-105 active:scale-95 flex items-center gap-2",children:[f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),"ng hnh nh"]})]})}),a&&f.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-[200] flex items-center justify-center p-6",children:f.jsxs("div",{className:"bg-[#1e293b] w-full max-w-4xl h-[90vh] rounded-2xl border border-white/10 shadow-2xl flex flex-col animate-in zoom-in-95",children:[f.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-white/10",children:[f.jsx("h2",{className:"text-xl font-bold text-white uppercase tracking-widest",children:"Cu hnh Trang Ch"}),f.jsx("button",{onClick:()=>l(!1),className:"text-slate-400 hover:text-white",children:f.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),f.jsxs("div",{className:"flex-grow flex overflow-hidden",children:[f.jsxs("div",{className:"w-1/3 bg-black/20 p-6 border-r border-white/5 space-y-8 overflow-y-auto flex flex-col",children:[f.jsxs("div",{className:"flex-grow space-y-8",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400 mb-3",children:"Chn B Cc (Layout)"}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{onClick:()=>R("layout","modern"),className:`p-4 rounded-xl border-2 cursor-pointer transition-all ${(w==null?void 0:w.layout)==="modern"?"border-indigo-500 bg-indigo-500/10":"border-slate-700 hover:border-slate-500"}`,children:[f.jsx("div",{className:"font-bold text-white text-sm mb-1",children:"Modern Visual (Default)"}),f.jsx("div",{className:"text-xs text-slate-400",children:"Hero ln, nn ng, card trong sut."})]}),f.jsxs("div",{onClick:()=>R("layout","classic"),className:`p-4 rounded-xl border-2 cursor-pointer transition-all ${(w==null?void 0:w.layout)==="classic"?"border-indigo-500 bg-indigo-500/10":"border-slate-700 hover:border-slate-500"}`,children:[f.jsx("div",{className:"font-bold text-white text-sm mb-1",children:"Classic Dashboard"}),f.jsx("div",{className:"text-xs text-slate-400",children:"Gn gng, tp trung thng tin."})]})]})]}),f.jsx("hr",{className:"border-white/10"}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400 mb-3",children:"Thng tin Zalo (0 n)"}),f.jsx("input",{type:"text",value:(w==null?void 0:w.zaloPhone)||"",onChange:X=>R("zaloPhone",X.target.value),placeholder:"ST Zalo (V d: 0987654321)",className:"w-full bg-slate-800 border-slate-700 text-white p-2 rounded text-sm"})]}),f.jsx("hr",{className:"border-white/10"}),f.jsxs("div",{children:[f.jsxs("div",{className:"flex justify-between items-center mb-3",children:[f.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400",children:"Qun l Ct Bn Phi"}),f.jsx("button",{onClick:j,className:"text-xs bg-indigo-600 px-2 py-1 rounded text-white hover:bg-indigo-700",children:"+ Thm Ct"})]}),f.jsx("div",{className:"space-y-3",children:(V=w==null?void 0:w.sidebarWidgets)==null?void 0:V.map((X,he)=>{var ve;return f.jsxs("div",{className:"bg-slate-800 p-3 rounded-lg border border-slate-700",children:[f.jsxs("div",{className:"flex justify-between items-center mb-2",children:[f.jsxs("span",{className:"text-xs font-bold text-slate-300",children:["#",he+1," - ",X.type==="custom"?"Ty chnh":X.title]}),f.jsxs("div",{className:"flex gap-1",children:[f.jsx("button",{onClick:()=>F(he,"up"),disabled:he===0,className:"p-1 text-slate-400 hover:text-white disabled:opacity-30",children:""}),f.jsx("button",{onClick:()=>F(he,"down"),disabled:he===(((ve=w.sidebarWidgets)==null?void 0:ve.length)||0)-1,className:"p-1 text-slate-400 hover:text-white disabled:opacity-30",children:""}),f.jsx("button",{onClick:()=>ce(X.id),className:"p-1 text-red-400 hover:text-red-300",children:""})]})]}),f.jsx("input",{type:"text",value:X.title,onChange:Ke=>ue(X.id,"title",Ke.target.value),className:"w-full bg-slate-900 border border-slate-700 text-white p-1 rounded text-xs mb-2",placeholder:"Tiu  widget..."}),X.type==="custom"&&f.jsx("button",{onClick:()=>B(X),className:"w-full mt-2 bg-indigo-600/50 hover:bg-indigo-600 text-white text-xs py-2 rounded border border-indigo-500/50",children:"Chnh sa ni dung (Full Editor)"})]},X.id)})})]}),f.jsx("hr",{className:"border-white/10"}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400 mb-3",children:"Ni dung Cho mng"}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsxs("label",{className:"text-xs text-slate-500 block mb-1",children:["Tiu  (dng ","{username}","  chn tn)"]}),f.jsx("input",{type:"text",value:(w==null?void 0:w.welcomeTitle)||"",onChange:X=>R("welcomeTitle",X.target.value),placeholder:"Cho mng, {username}!",className:"w-full bg-slate-800 border-slate-700 text-white p-2 rounded text-sm"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-slate-500 block mb-1",children:"M t"}),f.jsx("textarea",{value:(w==null?void 0:w.welcomeMessage)||"",onChange:X=>R("welcomeMessage",X.target.value),placeholder:"M t ngn...",className:"w-full bg-slate-800 border-slate-700 text-white p-2 rounded text-sm h-20"})]})]})]})]}),f.jsx("div",{className:"pt-6 border-t border-white/10",children:f.jsx("button",{onClick:Q,className:"w-full py-3 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-xl shadow-lg transition-all",children:"Lu Cu Hnh"})})]}),U==="news"?f.jsxs("div",{className:"w-2/3 p-6 flex flex-col bg-[#0f172a]",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsx("h3",{className:"font-bold text-white",children:"Qun l Tin Tc"}),f.jsx("button",{onClick:()=>{m(!0),d({})},className:"bg-indigo-600 hover:bg-indigo-700 text-white text-xs font-bold px-4 py-2 rounded-lg",children:"+ Thm Tin Mi"})]}),g?f.jsxs("div",{className:"flex-grow flex flex-col min-h-0",children:[f.jsxs("div",{className:"flex-grow overflow-y-auto pr-2 space-y-4",children:[f.jsx("input",{type:"text",placeholder:"Tiu  bi vit...",value:c.title||"",onChange:X=>d({...c,title:X.target.value}),className:"bg-slate-800 border-slate-700 text-white p-3 rounded-lg outline-none focus:border-indigo-500 w-full"}),f.jsx("div",{className:"flex flex-col min-h-[300px]",children:f.jsx(aT,{ref:_,value:c.content||"",onChange:X=>d({...c,content:X}),className:"flex-grow h-full"})}),f.jsxs("div",{className:"flex gap-2 flex-wrap pt-2 pb-2",children:[["","","","","","","","","","","","","","Ok",""].map(X=>f.jsx("button",{type:"button",onMouseDown:he=>{var ve;he.preventDefault(),(ve=_.current)==null||ve.insertText(X)},className:"bg-slate-700 hover:bg-slate-600 text-white px-2 py-1 rounded text-sm transition-colors",title:"Chn vo ni dung",children:X},X)),f.jsx("span",{className:"text-[10px] text-slate-500 self-center ml-2 uppercase font-bold tracking-wider opacity-60",children:"Click  chn vo ni dung"})]}),f.jsx("div",{className:"pt-2",children:f.jsx(l5,{currentImage:c.imageUrl,onImageUploaded:X=>d({...c,imageUrl:X}),onClear:()=>d({...c,imageUrl:void 0})})})]}),f.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-700 mt-2 flex-shrink-0 bg-[#0f172a]",children:[f.jsx("button",{onClick:()=>m(!1),className:"px-4 py-2 text-slate-400 hover:text-white",children:"Hy"}),f.jsx("button",{onClick:N,className:"px-6 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-bold",children:"Lu Tin"})]})]}):f.jsx("div",{className:"flex-grow overflow-y-auto space-y-3 pr-2",children:t.news.map((X,he)=>f.jsxs("div",{className:"bg-slate-800 p-4 rounded-xl border border-slate-700 flex justify-between items-start group",children:[f.jsxs("div",{children:[f.jsx("h4",{className:"font-bold text-white text-sm",children:X.title}),f.jsxs("div",{className:"text-[10px] text-slate-400 mt-1",children:[M(X.date)," - ",X.author]})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsxs("div",{className:"flex flex-col gap-1 mr-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[f.jsx("button",{onClick:()=>ge(he,"up"),disabled:he===0,className:"text-slate-500 hover:text-white disabled:opacity-20",children:""}),f.jsx("button",{onClick:()=>ge(he,"down"),disabled:he===t.news.length-1,className:"text-slate-500 hover:text-white disabled:opacity-20",children:""})]}),f.jsxs("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity items-center",children:[f.jsx("button",{onClick:()=>{d(X),m(!0)},className:"p-1 text-blue-400 hover:bg-blue-400/10 rounded",children:"Sa"}),f.jsx("button",{onClick:()=>k(X.id),className:"p-1 text-red-400 hover:bg-red-400/10 rounded",children:"Xa"})]})]})]},X.id))})]}):f.jsxs("div",{className:"w-2/3 p-6 flex flex-col bg-[#0f172a]",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsxs("h3",{className:"font-bold text-white uppercase",children:["Chnh sa Widget: ",f.jsx("span",{className:"text-indigo-400",children:(de=(te=w==null?void 0:w.sidebarWidgets)==null?void 0:te.find(X=>X.id===z))==null?void 0:de.title})]}),f.jsx("button",{onClick:se,className:"bg-indigo-600 hover:bg-indigo-700 text-white text-xs font-bold px-4 py-2 rounded-lg",children:"Xong"})]}),f.jsxs("div",{className:"flex-grow flex flex-col min-h-0 pb-4",children:[f.jsx("label",{className:"text-xs text-slate-400 font-bold uppercase mb-2",children:"Ni dung (HTML Supported)"}),f.jsx("div",{className:"flex-grow bg-white rounded-lg overflow-hidden flex flex-col",children:f.jsx(aT,{ref:_,value:((Se=(pe=w==null?void 0:w.sidebarWidgets)==null?void 0:pe.find(X=>X.id===z))==null?void 0:Se.content)||"",onChange:X=>{z&&ue(z,"content",X)},className:"flex-grow h-full text-black"})}),f.jsx("div",{className:"flex gap-2 flex-wrap pt-4",children:["","","","","","","","","","","","","","Ok",""].map(X=>f.jsx("button",{type:"button",onMouseDown:he=>{var ve;he.preventDefault(),(ve=_.current)==null||ve.insertText(X)},className:"bg-slate-700 hover:bg-slate-600 text-white px-2 py-1 rounded text-sm transition-colors",title:"Chn vo ni dung",children:X},X))})]})]})]})]})})]})},oT=[{id:"CHINESE",name:"Ting Trung",icon:""},{id:"JAPANESE",name:"Ting Nht",icon:""},{id:"KOREAN",name:"Ting Hn",icon:""}],lT={CHINESE:{batchSize:50,delaySeconds:1,customPrompt:"Dch sang ting Vit phong cch kim hip, xng h huynh-, vn phong c trang, gi nguyn cc danh xng c th.",removeSourceText:!0,autoFixFormat:!0},JAPANESE:{batchSize:40,delaySeconds:1.5,customPrompt:"Dch sang ting Vit phong cch Anime/Manga, gi nguyn cc hu t nh -san, -kun, -sama nu cn thit, dch st ngha nhng t nhin.",removeSourceText:!0,autoFixFormat:!0},KOREAN:{batchSize:45,delaySeconds:1,customPrompt:"Dch sang ting Vit phong cch phim truyn hnh Hn Quc (K-Drama), xng h Oppa/Unnie/Noona ph hp ng cnh, vn phong gn gi.",removeSourceText:!0,autoFixFormat:!0}},h5=n=>(n=n.replace(/\r\n/g,`
`),n.trim().split(/\n\s*\n/).map(t=>{const i=t.split(`
`);if(i.length<3)return{index:"",timecode:"",text:""};const a=i[0].trim(),l=i[1].trim(),c=i.slice(2).join(`
`).trim();return{index:a,timecode:l,text:c}}).filter(t=>t.index!=="")),d5=n=>n.map(e=>`${e.index}
${e.timecode}
${e.text}
`).join(`
`),f5=(n,e)=>{const t=new Uint8Array([239,187,191]),i=new Blob([t,e],{type:"text/srt;charset=utf-8"}),a=URL.createObjectURL(i),l=document.createElement("a");l.href=a,l.download=n.replace(/\.(srt|txt)$/i,"")+"_VIET.srt",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(a)},p5=(n,e)=>{let t;switch(e){case"CHINESE":t=/[\u4e00-\u9fa5]/g;break;case"JAPANESE":t=/[\u3040-\u30ff\u4e00-\u9faf]/g;break;case"KOREAN":t=/[\uac00-\ud7af]/g;break;default:t=/$/}return n.replace(t,"").trim()},g5=n=>{const e=(n==null?void 0:n.message)||(n==null?void 0:n.toString())||"";throw e.includes("429")||e.includes("Quota")||e.includes("quota")||e.includes("Resource has been exhausted")?e.includes("quota")||e.includes("Exceeded")?new Error("Ht API key, bn hy nhp thm API key  tip tc cng vic"):new Error("Hy thao tc chm li v api key ca bn khng p ng  x l nhanh"):e.includes("Network")||e.includes("fetch")?new Error("Li kt ni mng. Vui lng kim tra ng truyn."):new Error(`Li h thng: ${e}`)};class m5{constructor(e){this.apiKeys=e}getModel(){if(this.apiKeys.length===0)throw new Error("No API Keys provided");const e=this.apiKeys[Math.floor(Math.random()*this.apiKeys.length)];return new Qd(e).getGenerativeModel({model:"gemini-flash-latest"})}async translateBatch(e,t,i,a){const l=`
Bn l mt chuyn gia dch thut phim nh cao cp t ${t==="CHINESE"?"Ting Trung":t==="JAPANESE"?"Ting Nht":"Ting Hn"} sang Ting Vit.
Nhim v: Dch ni dung cc ph  di y sang Ting Vit.

Yu cu c th:
1. ${i}
2. Gi nguyn nh dng ca tng mc (Index, Timecode).
3. CH tr v bn dch Ting Vit cho phn text ca ph . Khng c bao gm ngn ng gc.
4. KHNG gii thch, KHNG thm li dn.
5. m bo cu trc SRT chnh xc:
Index
Timecode
Ni dung dch

D liu u vo:
${e.map(c=>`${c.index}
${c.timecode}
${c.text}`).join(`

`)}
    `;try{const _=((await(await this.getModel().generateContent({contents:[{role:"user",parts:[{text:l}]}],generationConfig:{temperature:.3,topP:.8}})).response).text()||"").trim().split(/\n\s*\n/);return e.map((w,x)=>{const S=_[x];if(!S)return{...w,text:"[Li dch]"};const A=S.split(`
`),D=A.length>=3?A.slice(2).join(`
`).trim():A.join(`
`).trim();return{...w,text:D||w.text}})}catch(c){console.error("Translation error:",c),g5(c)}}}const cT=({className:n="w-6 h-6",size:e=24})=>f.jsx("svg",{width:e,height:e,className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})}),y5=({className:n="w-6 h-6",size:e=24})=>f.jsx("svg",{width:e,height:e,className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),v5=({className:n="w-6 h-6",size:e=24})=>f.jsx("svg",{width:e,height:e,className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),Ac=({className:n="w-6 h-6",size:e=24})=>f.jsx("svg",{width:e,height:e,className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),_5=({className:n="w-6 h-6",size:e=24})=>f.jsxs("svg",{width:e,height:e,className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]}),uT=({className:n="w-6 h-6",size:e=24})=>f.jsx("svg",{width:e,height:e,className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),b5=({className:n="w-6 h-6",size:e=24})=>f.jsx("svg",{width:e,height:e,className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),w5=({className:n="w-6 h-6",size:e=24})=>f.jsx("svg",{width:e,height:e,className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),x5=({className:n="w-6 h-6",size:e=24})=>f.jsxs("svg",{width:e,height:e,className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),T5=({className:n="w-6 h-6",size:e=24})=>f.jsx("svg",{width:e,height:e,className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),nm=({className:n="w-6 h-6",size:e=24})=>f.jsx("svg",{width:e,height:e,className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),E5=({className:n="w-6 h-6",size:e=24})=>f.jsx("svg",{width:e,height:e,className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),S5=({userId:n})=>{var z;const[e,t]=le.useState(null),[i,a]=le.useState(""),[l,c]=le.useState("CHINESE"),[d,g]=le.useState(!1),[m,_]=le.useState(lT.CHINESE),[w,x]=le.useState({isProcessing:!1,progress:0,currentBatch:0,totalBatches:0}),[S,A]=le.useState(""),D=le.useRef(null);le.useEffect(()=>{const O=localStorage.getItem(`app_api_keys_${n}`);if(O)try{const $=JSON.parse(O),R=atob($.gemini||"").split(`
`).map(N=>N.trim()).filter(N=>N!=="");R.length>0&&A(R[0])}catch($){console.error("Failed to load keys",$)}},[n]);const I=O=>{var Q;const $=(Q=O.target.files)==null?void 0:Q[0];if($){t($);const R=new FileReader;R.onload=N=>{var k;a(((k=N.target)==null?void 0:k.result)||"")},R.readAsText($),x(N=>({...N,result:void 0,error:void 0}))}},U=()=>{e&&(g(!0),_(lT[l]))},q=async()=>{if(!i)return;if(!S){x(k=>({...k,isProcessing:!1,error:"Cha c API Key. Vui lng cu hnh  trang ch."}));return}const O=h5(i),$=m.batchSize,Q=Math.ceil(O.length/$);x({isProcessing:!0,progress:0,currentBatch:0,totalBatches:Q,error:void 0});const R=new m5([S]);let N=[];try{for(let M=0;M<Q;M++){const L=M*$,F=Math.min(L+$,O.length),j=O.slice(L,F);x(B=>({...B,currentBatch:M+1,progress:Math.round(M/Q*100)}));const ue=(await R.translateBatch(j,l,m.customPrompt,m.autoFixFormat)).map(B=>({...B,text:m.removeSourceText?p5(B.text,l):B.text}));N=[...N,...ue],M<Q-1&&await new Promise(B=>setTimeout(B,m.delaySeconds*1e3))}const k=d5(N);x(M=>({...M,isProcessing:!1,progress:100,result:k}))}catch(k){x(M=>({...M,isProcessing:!1,error:" xy ra li trong qu trnh dch: "+(k.message||"Unknown error")}))}};return S?f.jsx(wS,{children:f.jsxs("div",{className:"min-h-full p-4 md:p-8 flex flex-col items-center bg-transparent",children:[f.jsxs("header",{className:"w-full max-w-4xl text-center mb-12",children:[f.jsx("div",{className:"inline-flex items-center justify-center p-3 bg-indigo-600 rounded-2xl mb-4 text-white shadow-lg",children:f.jsx(cT,{size:32})}),f.jsx("h1",{className:"text-4xl font-extrabold text-slate-900 mb-2",children:"Dch Thut Chuyn Gia"}),f.jsx("p",{className:"text-slate-500",children:"Nng tm bn dch ph  ca bn vi sc mnh ca AI"})]}),f.jsxs("main",{className:"w-full max-w-4xl bg-white rounded-3xl shadow-xl shadow-slate-200/50 border border-slate-100 overflow-hidden",children:[w.isProcessing&&f.jsx("div",{className:"h-1.5 w-full bg-slate-100 relative",children:f.jsx("div",{className:"absolute top-0 left-0 h-full bg-indigo-600 transition-all duration-500 ease-out",style:{width:`${w.progress}%`}})}),f.jsxs("div",{className:"p-8",children:[!d&&!w.isProcessing&&!w.result&&f.jsxs("div",{className:"space-y-8",children:[f.jsxs("section",{children:[f.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-3",children:"Ti ln file ngun (.srt, .txt)"}),f.jsxs("div",{onClick:()=>{var O;return(O=D.current)==null?void 0:O.click()},className:`border-2 border-dashed rounded-2xl p-10 flex flex-col items-center justify-center cursor-pointer transition-all ${e?"border-indigo-500 bg-indigo-50/30":"border-slate-200 hover:border-indigo-400 hover:bg-slate-50"}`,children:[f.jsx("input",{type:"file",ref:D,onChange:I,accept:".srt,.txt",className:"hidden"}),e?f.jsxs(f.Fragment,{children:[f.jsx(v5,{className:"text-indigo-600 mb-4 w-12 h-12",size:48}),f.jsx("p",{className:"text-indigo-900 font-medium",children:e.name}),f.jsxs("p",{className:"text-slate-500 text-sm mt-1",children:[(e.size/1024).toFixed(2)," KB"]})]}):f.jsxs(f.Fragment,{children:[f.jsx(y5,{className:"text-slate-400 mb-4 w-12 h-12",size:48}),f.jsx("p",{className:"text-slate-600 font-medium text-lg",children:"Ko th hoc nhp  chn file"}),f.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"Ch h tr nh dng .srt v .txt"})]})]})]}),e&&f.jsxs("section",{className:"animate-in fade-in slide-in-from-bottom-4 duration-500",children:[f.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-3",children:"Chn ngn ng ngun"}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:oT.map(O=>f.jsxs("button",{onClick:()=>c(O.id),className:`flex items-center gap-3 p-4 rounded-xl border-2 transition-all ${l===O.id?"border-indigo-600 bg-indigo-50 text-indigo-700":"border-slate-100 hover:border-slate-200"}`,children:[f.jsx("span",{className:"text-2xl",children:O.icon}),f.jsx("span",{className:"font-semibold",children:O.name}),l===O.id&&f.jsx(Ac,{size:20,className:"ml-auto"})]},O.id))})]}),e&&f.jsxs("button",{onClick:U,className:"w-full py-4 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl font-bold text-lg shadow-lg shadow-indigo-200 transition-all flex items-center justify-center gap-2",children:[f.jsx(_5,{size:20}),"Bt u thit lp"]})]}),d&&!w.isProcessing&&!w.result&&f.jsxs("div",{className:"space-y-8 animate-in zoom-in-95 duration-300",children:[f.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[f.jsx("button",{onClick:()=>g(!1),className:"p-2 hover:bg-slate-100 rounded-lg text-slate-500",children:f.jsx(uT,{size:20})}),f.jsxs("h2",{className:"text-xl font-bold text-slate-800",children:["Cu hnh chuyn gia cho ",(z=oT.find(O=>O.id===l))==null?void 0:z.name]})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700",children:[f.jsx(b5,{size:16,className:"text-indigo-500"}),"S ph  mi gi (Batch Size)"]}),f.jsx("input",{type:"number",value:m.batchSize,onChange:O=>_({...m,batchSize:parseInt(O.target.value)||1}),className:"w-full p-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none transition-all"}),f.jsx("p",{className:"text-xs text-slate-400",children:"Gom nhiu dng gip AI hiu ng cnh tt hn v trnh b ngt qung."})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700",children:[f.jsx(w5,{size:16,className:"text-indigo-500"}),"Thi gian ngh (s)"]}),f.jsx("input",{type:"number",step:"0.5",value:m.delaySeconds,onChange:O=>_({...m,delaySeconds:parseFloat(O.target.value)||.1}),className:"w-full p-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none transition-all"}),f.jsx("p",{className:"text-xs text-slate-400",children:"Thi gian ch gia cc ln gi API  trnh b gii hn bng thng."})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700",children:[f.jsx(x5,{size:16,className:"text-indigo-500"}),"Kim sot cht lng dch (Prompt ty chnh)"]}),f.jsx("textarea",{rows:4,value:m.customPrompt,onChange:O=>_({...m,customPrompt:O.target.value}),className:"w-full p-4 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none transition-all resize-none",placeholder:"V d: Dch phong cch kim hip, xng h huynh-..."})]}),f.jsxs("div",{className:"bg-slate-50 p-6 rounded-2xl space-y-4",children:[f.jsx("h3",{className:"font-bold text-slate-800 text-sm uppercase tracking-wider",children:"Hu k chuyn su"}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[f.jsxs("div",{className:"relative",children:[f.jsx("input",{type:"checkbox",checked:m.removeSourceText,onChange:O=>_({...m,removeSourceText:O.target.checked}),className:"sr-only peer"}),f.jsx("div",{className:"w-10 h-6 bg-slate-200 rounded-full peer peer-checked:bg-indigo-600 transition-all"}),f.jsx("div",{className:"absolute left-1 top-1 w-4 h-4 bg-white rounded-full peer-checked:translate-x-4 transition-all"})]}),f.jsxs("div",{className:"flex flex-col",children:[f.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Loi b k t tha (Regex)"}),f.jsx("span",{className:"text-xs text-slate-400",children:"T ng xa cc k t tng hnh cn st li sau khi dch."})]})]}),f.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[f.jsxs("div",{className:"relative",children:[f.jsx("input",{type:"checkbox",checked:m.autoFixFormat,onChange:O=>_({...m,autoFixFormat:O.target.checked}),className:"sr-only peer"}),f.jsx("div",{className:"w-10 h-6 bg-slate-200 rounded-full peer peer-checked:bg-indigo-600 transition-all"}),f.jsx("div",{className:"absolute left-1 top-1 w-4 h-4 bg-white rounded-full peer-checked:translate-x-4 transition-all"})]}),f.jsxs("div",{className:"flex flex-col",children:[f.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Kim tra & Sa cha nh dng SRT"}),f.jsx("span",{className:"text-xs text-slate-400",children:"m bo m thi gian v s th t chun xc 100%."})]})]})]})]}),f.jsxs("button",{onClick:q,className:"w-full py-4 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl font-bold text-lg shadow-lg shadow-indigo-200 transition-all flex items-center justify-center gap-2",children:[f.jsx(cT,{size:20}),"Tin hnh dch ngay"]})]}),w.isProcessing&&f.jsxs("div",{className:"py-12 flex flex-col items-center justify-center space-y-6",children:[f.jsxs("div",{className:"relative",children:[f.jsx(E5,{size:64,className:"text-indigo-600 animate-spin w-16 h-16"}),f.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:f.jsxs("span",{className:"text-sm font-bold text-indigo-700",children:[w.progress,"%"]})})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"ang x l d liu..."}),f.jsxs("p",{className:"text-slate-500 mt-1",children:["ang dch gi ",w.currentBatch," / ",w.totalBatches]}),f.jsxs("div",{className:"mt-6 p-4 bg-amber-50 rounded-xl border border-amber-100 flex items-center gap-3 text-amber-800 text-sm max-w-md",children:[f.jsx(nm,{size:18}),"Vui lng khng ng trnh duyt cho n khi qu trnh hon tt."]})]})]}),w.result&&f.jsxs("div",{className:"py-8 flex flex-col items-center space-y-6 animate-in fade-in duration-500",children:[f.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center text-green-600 mb-2",children:f.jsx(Ac,{size:40,className:"w-10 h-10"})}),f.jsxs("div",{className:"text-center",children:[f.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Dch thnh cng!"}),f.jsx("p",{className:"text-slate-500 mt-2",children:"File ca bn  c ti u ha v sn sng s dng."})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 w-full max-w-lg",children:[f.jsxs("button",{onClick:()=>f5((e==null?void 0:e.name)||"translated.srt",w.result),className:"flex items-center justify-center gap-3 p-4 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl font-bold shadow-lg shadow-indigo-200 transition-all",children:[f.jsx(T5,{size:20}),"Ti file (.srt)"]}),f.jsxs("button",{onClick:()=>{t(null),x({isProcessing:!1,progress:0,currentBatch:0,totalBatches:0}),g(!1)},className:"flex items-center justify-center gap-3 p-4 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-bold transition-all",children:[f.jsx(uT,{size:20}),"Dch file khc"]})]}),f.jsxs("div",{className:"w-full mt-6 space-y-2",children:[f.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest ml-1",children:"Xem trc ni dung"}),f.jsx("div",{className:"w-full h-48 bg-slate-950 rounded-2xl p-4 font-mono text-xs text-slate-300 overflow-y-auto border border-slate-800",children:f.jsxs("pre",{className:"whitespace-pre-wrap",children:[w.result.slice(0,1e3),"..."]})})]})]}),w.error&&f.jsxs("div",{className:"mt-8 p-6 bg-rose-50 border border-rose-100 rounded-2xl flex items-start gap-4 text-rose-800",children:[f.jsx(nm,{size:24,className:"flex-shrink-0"}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-bold",children:"Li x l"}),f.jsx("p",{className:"text-sm mt-1",children:w.error}),f.jsx("button",{onClick:()=>x(O=>({...O,error:void 0})),className:"mt-3 text-sm font-bold underline hover:no-underline",children:"Th li"})]})]})]})]}),f.jsxs("footer",{className:"mt-12 text-slate-400 text-sm flex flex-col items-center gap-4",children:[f.jsxs("div",{className:"flex items-center gap-6",children:[f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx(Ac,{size:14})," UTF-8 with BOM"]}),f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx(Ac,{size:14})," Ti u ng cnh"]}),f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx(Ac,{size:14})," T ng sa li"]})]}),f.jsx("p",{children:" 2024 Dch Thut Chuyn Gia  Bn quyn thuc v AI Studio"})]})]})}):f.jsx("div",{className:"flex flex-col items-center justify-center p-10 h-full",children:f.jsxs("div",{className:"bg-red-50 text-red-600 p-6 rounded-xl border border-red-200 text-center shadow-sm",children:[f.jsx(nm,{className:"w-12 h-12 mx-auto mb-2 text-red-500"}),f.jsx("h3",{className:"font-bold text-lg mb-2",children:"Cha cu hnh API Key"}),f.jsx("p",{children:"Vui lng nhp Gemini API Key  phn qun l Key pha trn trc khi s dng ng dng ny."})]})})},A5=()=>f.jsxs("div",{className:"w-full h-full min-h-[500px] flex flex-col items-center justify-center p-10 bg-white rounded-3xl shadow-xl border border-dashed border-slate-300",children:[f.jsx("div",{className:"w-20 h-20 bg-indigo-50 rounded-full flex items-center justify-center mb-6",children:f.jsx("svg",{className:"w-10 h-10 text-indigo-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),f.jsx("h2",{className:"text-2xl font-black text-slate-800 uppercase tracking-tighter mb-2",children:"New Application"}),f.jsxs("p",{className:"text-slate-500 text-center max-w-md",children:["This is a placeholder for your future application. ",f.jsx("br",{}),"You can start building your new features here within the ",f.jsx("code",{children:"apps/NewToolApp.tsx"})," file."]}),f.jsx("button",{className:"mt-8 px-6 py-3 bg-indigo-600 text-white font-bold rounded-xl hover:bg-indigo-700 transition-all",children:"Initialize Project"})]}),N5=[{id:"video-viral",label:"Video Viral"},{id:"image-script",label:"Visual Script"},{id:"zenshot-ai",label:"ZenShot AI"},{id:"translation",label:"Translation"},{id:"new-tool",label:"New Tool"}],C5=({onClose:n})=>{const[e,t]=le.useState({}),[i,a]=le.useState(""),l=async()=>{const m=await jm(rS(Ys,"users")),_={};m.forEach(w=>{const x=w.data();_[x.username]={id:x.id,username:x.username,email:x.email,phone:x.phone,role:x.role,allowedApps:x.allowedApps,createdAt:x.createdAt}}),t(_)};le.useEffect(()=>{l()},[]);const c=async(m,_)=>{const w=e[m];if(!w)return;let x=w.allowedApps?[...w.allowedApps]:[];x.includes(_)?x=x.filter(A=>A!==_):x.push(_),t(A=>({...A,[m]:{...A[m],allowedApps:x}}));const S=wr(Ys,"users",w.id);await Pm(S,{allowedApps:x})},d=async m=>{const _=e[m];if(!_)return;const w=_.role==="admin"?"user":"admin";t(S=>({...S,[m]:{...S[m],role:w}}));const x=wr(Ys,"users",_.id);await Pm(x,{role:w})},g=Object.values(e).filter(m=>m.username.toLowerCase().includes(i.toLowerCase())||m.email&&m.email.toLowerCase().includes(i.toLowerCase()));return f.jsx("div",{className:"fixed inset-0 bg-slate-900/90 backdrop-blur-md flex items-center justify-center z-[400] p-6",children:f.jsxs("div",{className:"bg-white w-full max-w-5xl rounded-3xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh] animate-in zoom-in-95 duration-300",children:[f.jsxs("div",{className:"bg-[#020617] text-white p-8 flex justify-between items-center shrink-0 gap-4",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("h2",{className:"text-2xl font-black uppercase tracking-tighter",children:"Admin Control Panel (v1.2)"}),f.jsx("p",{className:"text-xs text-indigo-400 font-bold uppercase tracking-[0.3em] mt-1",children:"User & Access Management"})]}),f.jsxs("button",{onClick:l,className:"bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg font-bold text-xs uppercase tracking-widest shadow-lg transition-all flex items-center gap-2",children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Force Refresh"]}),f.jsx("button",{onClick:n,className:"bg-white/10 hover:bg-white/20 p-3 rounded-xl transition-all",children:f.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),f.jsx("div",{className:"p-6 border-b border-slate-100 bg-slate-50 flex items-center gap-4 shrink-0 justify-between",children:f.jsx("div",{className:"flex items-center gap-4 flex-1",children:f.jsxs("div",{className:"relative flex-1 max-w-md",children:[f.jsx("svg",{className:"w-5 h-5 absolute left-4 top-1/2 -translate-y-1/2 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),f.jsx("input",{type:"text",placeholder:"Search users...",className:"w-full pl-12 pr-4 py-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-indigo-500 outline-none font-medium",value:i,onChange:m=>a(m.target.value)})]})})}),f.jsx("div",{className:"overflow-y-auto flex-1 p-6 bg-slate-100",children:f.jsx("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden",children:f.jsxs("table",{className:"w-full text-left border-collapse",children:[f.jsx("thead",{children:f.jsxs("tr",{className:"bg-slate-50 border-b border-slate-200 text-xs font-black text-slate-500 uppercase tracking-wider",children:[f.jsx("th",{className:"p-4 pl-6",children:"User Identity"}),f.jsx("th",{className:"p-4",children:"Role"}),f.jsx("th",{className:"p-4 text-center",children:"Video Viral"}),f.jsx("th",{className:"p-4 text-center",children:"Visual Script"}),f.jsx("th",{className:"p-4 text-center",children:"ZenShot New"}),f.jsx("th",{className:"p-4 text-center",children:"Translation"}),f.jsx("th",{className:"p-4 text-center",children:"New App"})]})}),f.jsx("tbody",{className:"divide-y divide-slate-100",children:g.map(m=>f.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[f.jsxs("td",{className:"p-4 pl-6",children:[f.jsx("div",{className:"font-bold text-slate-800",children:m.username}),f.jsx("div",{className:"text-xs text-slate-400 font-medium",children:m.email||"No email"})]}),f.jsx("td",{className:"p-4",children:f.jsx("button",{onClick:()=>d(m.username),className:`px-3 py-1 rounded-lg text-[10px] font-black uppercase tracking-widest transition-all ${m.role==="admin"?"bg-indigo-100 text-indigo-700 hover:bg-indigo-200":"bg-slate-100 text-slate-500 hover:bg-slate-200"}`,children:m.role})}),N5.map(_=>{var x;const w=(x=m.allowedApps)==null?void 0:x.includes(_.id);return f.jsx("td",{className:"p-4 text-center",children:f.jsxs("label",{className:"inline-flex items-center cursor-pointer relative",children:[f.jsx("input",{type:"checkbox",className:"peer sr-only",checked:w,onChange:()=>c(m.username,_.id)}),f.jsx("div",{className:"w-11 h-6 bg-slate-200 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-emerald-500"})]})},_.id)})]},m.id))})]})})}),f.jsxs("div",{className:"p-4 bg-black text-xs font-mono text-green-400 overflow-auto h-32 border-t border-slate-700 shrink-0",children:[f.jsx("p",{className:"font-bold text-white mb-2",children:"DEBUG RAW DATA (Search here for username):"}),f.jsx("pre",{className:"whitespace-pre-wrap",children:JSON.stringify(e,null,2)})]})]})})},$S={async getAppNames(){try{const n=wr(Ys,"system_config","app_names"),e=await gS(n);return e.exists()?e.data().names||{}:{}}catch(n){return console.warn("App Config Fetch Error:",n),{}}},async saveAppConfig(n){try{const e=wr(Ys,"system_config","app_names");await Dm(e,{names:n},{merge:!0})}catch(e){throw console.error("Error saving app config:",e),e}}},sm={"video-viral":"Video Viral Engine","image-script":"Visual Script Engine","zenshot-ai":"ZenShot AI (New)",translation:"Translation AI","new-tool":"New Application"},R5=({currentNames:n,onClose:e,onUpdate:t})=>{const[i,a]=le.useState(n),[l,c]=le.useState(!1);le.useEffect(()=>{a({...sm,...n})},[n]);const d=(m,_)=>{a(w=>({...w,[m]:_}))},g=async()=>{c(!0);try{await $S.saveAppConfig(i),t(),e()}catch(m){console.error("Failed to save app names",m),alert("Failed to save changes. Please try again.")}finally{c(!1)}};return f.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[200]",children:f.jsxs("div",{className:"bg-slate-900 rounded-3xl border border-indigo-500/20 shadow-2xl w-full max-w-lg overflow-hidden",children:[f.jsxs("div",{className:"p-6 border-b border-indigo-500/10 bg-indigo-500/5",children:[f.jsxs("h2",{className:"text-xl font-black text-white uppercase tracking-wider flex items-center gap-3",children:[f.jsx("span",{className:"p-2 bg-indigo-500/10 rounded-lg text-indigo-400",children:f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),"Manage App Names"]}),f.jsx("p",{className:"text-slate-400 text-xs mt-2 ml-14",children:"Customize how application names appear in the navigation bar."})]}),f.jsx("div",{className:"p-6 max-h-[60vh] overflow-y-auto space-y-4 custom-scrollbar",children:Object.keys(sm).map(m=>f.jsxs("div",{className:"group",children:[f.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2 group-hover:text-indigo-400 transition-colors",children:m.replace("-"," ")}),f.jsx("input",{type:"text",value:i[m]||"",onChange:_=>d(m,_.target.value),className:"w-full bg-slate-800/50 border border-slate-700 rounded-xl px-4 py-3 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-500 outline-none transition-all placeholder:text-slate-600",placeholder:sm[m]})]},m))}),f.jsxs("div",{className:"p-6 border-t border-indigo-500/10 bg-slate-800/20 flex justify-end gap-3",children:[f.jsx("button",{onClick:e,className:"px-5 py-2.5 rounded-xl text-slate-400 font-bold text-xs uppercase tracking-wider hover:text-white hover:bg-white/5 transition-all",children:"Cancel"}),f.jsx("button",{onClick:g,disabled:l,className:"px-6 py-2.5 rounded-xl bg-indigo-600 text-white font-bold text-xs uppercase tracking-wider hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg shadow-indigo-500/20 transition-all flex items-center gap-2",children:l?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"w-3 h-3 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Saving..."]}):"Save Changes"})]})]})})},I5=({user:n,onUpdateUser:e,onClose:t,appNames:i={},onUpdateAppNames:a=()=>{}})=>{const[l,c]=le.useState(n.email||""),[d,g]=le.useState(n.phone||""),[m,_]=le.useState(""),[w,x]=le.useState(""),[S,A]=le.useState(!1),[D,I]=le.useState(!1),U=async()=>{try{await Nr.updateProfile(n.id,{email:l,phone:d}),e({...n,email:l,phone:d}),x("Cp nht thnh cng!"),setTimeout(()=>x(""),3e3)}catch(q){console.error(q),x("Li khi cp nht!")}};return S?f.jsx(C5,{onClose:()=>A(!1)}):D?f.jsx(R5,{currentNames:i,onClose:()=>I(!1),onUpdate:a}):f.jsx("div",{className:"fixed inset-0 bg-slate-900/80 backdrop-blur-sm flex items-center justify-center z-[300] p-4",children:f.jsxs("div",{className:"bg-[#1e293b] w-full max-w-lg rounded-2xl border border-white/10 shadow-2xl p-6 md:p-8 animate-in zoom-in-95 duration-200",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6 border-b border-white/5 pb-4",children:[f.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[f.jsx("svg",{className:"w-5 h-5 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Qun l ti khon"]}),f.jsx("button",{onClick:t,className:"text-slate-400 hover:text-white transition-colors",children:f.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-xl border border-white/5 flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-[10px] text-slate-400 uppercase font-bold tracking-widest",children:"Tn ng nhp"}),f.jsx("p",{className:"text-lg font-bold text-white",children:n.username})]}),f.jsxs("div",{className:"text-right",children:[f.jsx("p",{className:"text-[10px] text-slate-400 uppercase font-bold tracking-widest",children:"Vai tr"}),f.jsx("span",{className:`inline-block px-2 py-1 rounded text-xs font-bold uppercase ${n.role==="admin"?"bg-indigo-500/20 text-indigo-400":"bg-slate-700 text-slate-300"}`,children:n.role})]})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400 mb-2",children:"Email"}),f.jsx("input",{type:"email",value:l,onChange:q=>c(q.target.value),className:"w-full bg-[#0f172a] border border-slate-700 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 outline-none text-sm"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400 mb-2",children:"S in thoi"}),f.jsx("input",{type:"tel",value:d,onChange:q=>g(q.target.value),className:"w-full bg-[#0f172a] border border-slate-700 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 outline-none text-sm"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs uppercase font-bold text-slate-400 mb-2",children:"i mt khu mi (Nu cn)"}),f.jsx("input",{type:"password",value:m,onChange:q=>_(q.target.value),placeholder:" trng nu khng i",className:"w-full bg-[#0f172a] border border-slate-700 rounded-lg px-4 py-3 text-white focus:ring-2 focus:ring-indigo-500 outline-none text-sm placeholder-slate-600"})]}),w&&f.jsx("div",{className:"p-3 bg-emerald-500/10 text-emerald-400 text-sm font-bold rounded-lg text-center animate-in fade-in slide-in-from-top-2",children:w}),f.jsxs("div",{className:"pt-4 border-t border-white/5 flex justify-between gap-3 items-center",children:[n.role==="admin"?f.jsxs("div",{className:"flex gap-2",children:[f.jsxs("button",{onClick:()=>A(!0),className:"px-4 py-2 rounded-lg text-sm font-bold bg-amber-500/10 text-amber-500 hover:bg-amber-500/20 transition-all uppercase tracking-wider flex items-center gap-2",children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})}),"Admin Panel"]}),f.jsxs("button",{onClick:()=>I(!0),className:"px-4 py-2 rounded-lg text-sm font-bold bg-indigo-500/10 text-indigo-400 hover:bg-indigo-500/20 transition-all uppercase tracking-wider flex items-center gap-2",children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Manage App Names"]})]}):f.jsx("div",{}),f.jsxs("div",{className:"flex gap-3",children:[f.jsx("button",{onClick:t,className:"px-4 py-2 rounded-lg text-sm font-bold text-slate-400 hover:text-white hover:bg-white/5 transition-all",children:"ng"}),f.jsx("button",{onClick:U,className:"px-6 py-2 rounded-lg text-sm font-bold bg-indigo-600 text-white hover:bg-indigo-500 transition-all shadow-lg active:scale-95",children:"Lu Thay i"})]})]})]})]})})},Vo=(n,e)=>n?n.role==="admin"?{allowed:!0}:n.allowedApps&&n.allowedApps.includes(e)?{allowed:!0}:{allowed:!1,reason:"disabled"}:{allowed:!1,reason:"guest"},k5=()=>{const[n,e]=le.useState(null),[t,i]=le.useState("home"),[a,l]=le.useState(!1),[c,d]=le.useState(!0),[g,m]=le.useState({}),[_,w]=le.useState(!1),x=async()=>{const U=await $S.getAppNames();m(U)};le.useEffect(()=>{x()},[]),le.useEffect(()=>{const U=Nk(jc,async q=>{var z;try{if(q){const O=await Nr.getUserProfile(q.uid);e(O||{id:q.uid,username:q.displayName||((z=q.email)==null?void 0:z.split("@")[0])||"User",email:q.email||"",role:"user",allowedApps:["video-viral","image-script","zenshot-ai","translation"],createdAt:Date.now()}),w(!1)}else e(null)}catch(O){console.error("Firebase Auth State Error:",O),e(null)}finally{d(!1)}});return()=>U()},[]);const S=U=>{e(U),w(!1)},A=async()=>{await Nr.logoutUser(),i("home")},D=U=>{if(U==="home"){i("home");return}if(n){const O=localStorage.getItem(`app_api_keys_${n.id}`);let $=!1;if(O)try{const Q=JSON.parse(O),N=(k=>{try{return atob(k)}catch{return k}})(Q.gemini||"");N&&N.trim().length>0&&($=!0)}catch(Q){console.error("Error checking keys",Q)}if(!$){alert("Hy nhp nhiu API key Gemini vo  s dng");return}}const{allowed:q,reason:z}=Vo(n,U);q?i(U):z==="guest"?(alert("App ny ch dnh cho thnh vin, hy ng k."),w(!0)):z==="disabled"&&alert("Bn cha c cp quyn truy cp ng dng ny. Vui lng lin h Admin.")},I=U=>{e(U)};return c?f.jsxs("div",{className:"min-h-screen bg-[#020617] flex items-center justify-center flex-col gap-4",children:[f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-500"}),f.jsx("p",{className:"text-slate-400 text-xs animate-pulse",children:"Loading App Engine..."})]}):_&&!n?f.jsxs("div",{className:"relative z-50",children:[f.jsx("button",{onClick:()=>w(!1),className:"fixed top-4 right-4 z-[60] text-white bg-slate-800/50 hover:bg-slate-700 p-2 rounded-full",children:" Close"}),f.jsx(LP,{onLogin:S})]}):f.jsxs("div",{className:"min-h-screen bg-slate-50 flex flex-col items-center relative",children:[n&&f.jsx(yN,{userId:n.id}),f.jsxs("nav",{className:"w-full bg-[#020617] text-white border-b border-white/5 sticky top-0 z-[100] px-6 md:px-12 py-4 backdrop-blur-2xl bg-opacity-95 shadow-2xl flex flex-col md:flex-row items-center justify-between gap-4",children:[f.jsxs("div",{className:"flex items-center gap-6 cursor-pointer",onClick:()=>D("home"),children:[f.jsx("div",{className:"bg-gradient-to-tr from-indigo-500 via-indigo-600 to-violet-600 p-3 rounded-2xl shadow-2xl shadow-indigo-500/30 ring-4 ring-indigo-500/10",children:f.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2.5",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),f.jsxs("div",{className:"flex flex-col",children:[f.jsxs("h1",{className:"text-2xl font-black tracking-tighter uppercase leading-none",children:["QUANG HUY ",f.jsx("span",{className:"text-indigo-400",children:"STUDIO"})]}),f.jsx("span",{className:"text-[10px] font-black text-indigo-400/70 uppercase tracking-[0.4em] mt-1",children:"Multi-App Engine"})]})]}),f.jsx("div",{className:"flex items-center bg-white/5 rounded-2xl p-1 border border-white/10 overflow-x-auto max-w-full",children:[{id:"video-viral",defaultName:"Video Viral Engine"},{id:"image-script",defaultName:"Visual Script Engine"},{id:"zenshot-ai",defaultName:"ZenShot AI (New)"},{id:"translation",defaultName:"Translation AI"},{id:"new-tool",defaultName:"New Application"}].map(U=>f.jsx("button",{onClick:()=>D(U.id),className:`px-4 md:px-6 py-2 rounded-xl text-xs font-black uppercase tracking-widest transition-all whitespace-nowrap ${t===U.id?"bg-indigo-600 text-white shadow-lg":"text-slate-400 hover:text-white hover:bg-white/5"}`,children:g[U.id]||U.defaultName},U.id))}),f.jsx("div",{className:"flex items-center gap-6",children:n?f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"text-right hidden md:block",children:[f.jsxs("div",{className:"text-xs font-black uppercase text-indigo-400",children:["Hello, ",n.username]}),f.jsx("button",{onClick:A,className:"text-[10px] uppercase font-bold text-slate-500 hover:text-white transition-colors",children:"Logout"})]}),f.jsx("div",{className:"w-10 h-10 bg-indigo-600 rounded-full flex items-center justify-center font-black text-sm shadow-lg ring-2 ring-indigo-400/20 cursor-pointer hover:ring-indigo-400 hover:scale-105 transition-all",onClick:()=>l(!0),children:n.username.charAt(0).toUpperCase()})]}):f.jsx("button",{onClick:()=>w(!0),className:"bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2 rounded-xl font-bold text-xs uppercase tracking-widest transition-all shadow-lg shadow-indigo-500/20",children:"ng Nhp"})})]}),f.jsxs("div",{className:"w-full h-[calc(100vh-140px)]",children:[t==="home"&&f.jsx(u5,{user:n||{id:"guest",username:"Guest",role:"user",createdAt:0},onNavigate:D},(n==null?void 0:n.id)||"guest"),n&&Vo(n,"video-viral").allowed&&t==="video-viral"&&f.jsx(VP,{userId:n.id},n.id),n&&Vo(n,"image-script").allowed&&t==="image-script"&&f.jsx(QP,{userId:n.id},n.id),n&&Vo(n,"zenshot-ai").allowed&&t==="zenshot-ai"&&f.jsx(IM,{userId:n.id},n.id),n&&Vo(n,"translation").allowed&&t==="translation"&&f.jsx(S5,{userId:n.id},n.id),n&&Vo(n,"new-tool").allowed&&t==="new-tool"&&f.jsx(A5,{},n.id)]}),a&&n&&f.jsx(I5,{user:n,onUpdateUser:I,onClose:()=>l(!1),appNames:g,onUpdateAppNames:x})]})},FS=document.getElementById("root");if(!FS)throw new Error("Could not find root element to mount to");const O5=O2.createRoot(FS);O5.render(f.jsx($c.StrictMode,{children:f.jsx(k5,{})}));
